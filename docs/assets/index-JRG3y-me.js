var I_=Object.defineProperty;var T_=(t,e,n)=>e in t?I_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var pn=(t,e,n)=>(T_(t,typeof e!="symbol"?e+"":e,n),n);function E_(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const o=Object.getOwnPropertyDescriptor(r,s);o&&Object.defineProperty(t,s,o.get?o:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();var Ca=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function $m(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function N_(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var s=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return t[r]}})}),n}var H2={exports:{}},Cm={},j2={exports:{}},Me={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var id=Symbol.for("react.element"),R_=Symbol.for("react.portal"),D_=Symbol.for("react.fragment"),A_=Symbol.for("react.strict_mode"),F_=Symbol.for("react.profiler"),P_=Symbol.for("react.provider"),O_=Symbol.for("react.context"),L_=Symbol.for("react.forward_ref"),M_=Symbol.for("react.suspense"),__=Symbol.for("react.memo"),z_=Symbol.for("react.lazy"),EC=Symbol.iterator;function V_(t){return t===null||typeof t!="object"?null:(t=EC&&t[EC]||t["@@iterator"],typeof t=="function"?t:null)}var K2={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},X2=Object.assign,q2={};function Jl(t,e,n){this.props=t,this.context=e,this.refs=q2,this.updater=n||K2}Jl.prototype.isReactComponent={};Jl.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Jl.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Y2(){}Y2.prototype=Jl.prototype;function ey(t,e,n){this.props=t,this.context=e,this.refs=q2,this.updater=n||K2}var ty=ey.prototype=new Y2;ty.constructor=ey;X2(ty,Jl.prototype);ty.isPureReactComponent=!0;var NC=Array.isArray,Q2=Object.prototype.hasOwnProperty,ny={current:null},Z2={key:!0,ref:!0,__self:!0,__source:!0};function J2(t,e,n){var r,s={},o=null,i=null;if(e!=null)for(r in e.ref!==void 0&&(i=e.ref),e.key!==void 0&&(o=""+e.key),e)Q2.call(e,r)&&!Z2.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];s.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:id,type:t,key:o,ref:i,props:s,_owner:ny.current}}function B_(t,e){return{$$typeof:id,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function ry(t){return typeof t=="object"&&t!==null&&t.$$typeof===id}function W_(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var RC=/\/+/g;function R0(t,e){return typeof t=="object"&&t!==null&&t.key!=null?W_(""+t.key):e.toString(36)}function Oh(t,e,n,r,s){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var i=!1;if(t===null)i=!0;else switch(o){case"string":case"number":i=!0;break;case"object":switch(t.$$typeof){case id:case R_:i=!0}}if(i)return i=t,s=s(i),t=r===""?"."+R0(i,0):r,NC(s)?(n="",t!=null&&(n=t.replace(RC,"$&/")+"/"),Oh(s,e,n,"",function(u){return u})):s!=null&&(ry(s)&&(s=B_(s,n+(!s.key||i&&i.key===s.key?"":(""+s.key).replace(RC,"$&/")+"/")+t)),e.push(s)),1;if(i=0,r=r===""?".":r+":",NC(t))for(var a=0;a<t.length;a++){o=t[a];var l=r+R0(o,a);i+=Oh(o,e,n,l,s)}else if(l=V_(t),typeof l=="function")for(t=l.call(t),a=0;!(o=t.next()).done;)o=o.value,l=r+R0(o,a++),i+=Oh(o,e,n,l,s);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return i}function Bf(t,e,n){if(t==null)return t;var r=[],s=0;return Oh(t,r,"","",function(o){return e.call(n,o,s++)}),r}function U_(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var jn={current:null},Lh={transition:null},G_={ReactCurrentDispatcher:jn,ReactCurrentBatchConfig:Lh,ReactCurrentOwner:ny};function eT(){throw Error("act(...) is not supported in production builds of React.")}Me.Children={map:Bf,forEach:function(t,e,n){Bf(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Bf(t,function(){e++}),e},toArray:function(t){return Bf(t,function(e){return e})||[]},only:function(t){if(!ry(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Me.Component=Jl;Me.Fragment=D_;Me.Profiler=F_;Me.PureComponent=ey;Me.StrictMode=A_;Me.Suspense=M_;Me.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=G_;Me.act=eT;Me.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=X2({},t.props),s=t.key,o=t.ref,i=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,i=ny.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)Q2.call(e,l)&&!Z2.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:id,type:t.type,key:s,ref:o,props:r,_owner:i}};Me.createContext=function(t){return t={$$typeof:O_,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:P_,_context:t},t.Consumer=t};Me.createElement=J2;Me.createFactory=function(t){var e=J2.bind(null,t);return e.type=t,e};Me.createRef=function(){return{current:null}};Me.forwardRef=function(t){return{$$typeof:L_,render:t}};Me.isValidElement=ry;Me.lazy=function(t){return{$$typeof:z_,_payload:{_status:-1,_result:t},_init:U_}};Me.memo=function(t,e){return{$$typeof:__,type:t,compare:e===void 0?null:e}};Me.startTransition=function(t){var e=Lh.transition;Lh.transition={};try{t()}finally{Lh.transition=e}};Me.unstable_act=eT;Me.useCallback=function(t,e){return jn.current.useCallback(t,e)};Me.useContext=function(t){return jn.current.useContext(t)};Me.useDebugValue=function(){};Me.useDeferredValue=function(t){return jn.current.useDeferredValue(t)};Me.useEffect=function(t,e){return jn.current.useEffect(t,e)};Me.useId=function(){return jn.current.useId()};Me.useImperativeHandle=function(t,e,n){return jn.current.useImperativeHandle(t,e,n)};Me.useInsertionEffect=function(t,e){return jn.current.useInsertionEffect(t,e)};Me.useLayoutEffect=function(t,e){return jn.current.useLayoutEffect(t,e)};Me.useMemo=function(t,e){return jn.current.useMemo(t,e)};Me.useReducer=function(t,e,n){return jn.current.useReducer(t,e,n)};Me.useRef=function(t){return jn.current.useRef(t)};Me.useState=function(t){return jn.current.useState(t)};Me.useSyncExternalStore=function(t,e,n){return jn.current.useSyncExternalStore(t,e,n)};Me.useTransition=function(){return jn.current.useTransition()};Me.version="18.3.1";j2.exports=Me;var A=j2.exports;const Ze=$m(A);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var H_=A,j_=Symbol.for("react.element"),K_=Symbol.for("react.fragment"),X_=Object.prototype.hasOwnProperty,q_=H_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Y_={key:!0,ref:!0,__self:!0,__source:!0};function tT(t,e,n){var r,s={},o=null,i=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(i=e.ref);for(r in e)X_.call(e,r)&&!Y_.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:j_,type:t,key:o,ref:i,props:s,_owner:q_.current}}Cm.Fragment=K_;Cm.jsx=tT;Cm.jsxs=tT;H2.exports=Cm;var Y=H2.exports,zv={},nT={exports:{}},xr={},rT={exports:{}},sT={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(P,z){var U=P.length;P.push(z);e:for(;0<U;){var K=U-1>>>1,Q=P[K];if(0<s(Q,z))P[K]=z,P[U]=Q,U=K;else break e}}function n(P){return P.length===0?null:P[0]}function r(P){if(P.length===0)return null;var z=P[0],U=P.pop();if(U!==z){P[0]=U;e:for(var K=0,Q=P.length,Z=Q>>>1;K<Z;){var te=2*(K+1)-1,J=P[te],re=te+1,le=P[re];if(0>s(J,U))re<Q&&0>s(le,J)?(P[K]=le,P[re]=U,K=re):(P[K]=J,P[te]=U,K=te);else if(re<Q&&0>s(le,U))P[K]=le,P[re]=U,K=re;else break e}}return z}function s(P,z){var U=P.sortIndex-z.sortIndex;return U!==0?U:P.id-z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var i=Date,a=i.now();t.unstable_now=function(){return i.now()-a}}var l=[],u=[],c=1,d=null,f=3,h=!1,p=!1,g=!1,v=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(P){for(var z=n(u);z!==null;){if(z.callback===null)r(u);else if(z.startTime<=P)r(u),z.sortIndex=z.expirationTime,e(l,z);else break;z=n(u)}}function y(P){if(g=!1,x(P),!p)if(n(l)!==null)p=!0,L($);else{var z=n(u);z!==null&&G(y,z.startTime-P)}}function $(P,z){p=!1,g&&(g=!1,m(w),w=-1),h=!0;var U=f;try{for(x(z),d=n(l);d!==null&&(!(d.expirationTime>z)||P&&!E());){var K=d.callback;if(typeof K=="function"){d.callback=null,f=d.priorityLevel;var Q=K(d.expirationTime<=z);z=t.unstable_now(),typeof Q=="function"?d.callback=Q:d===n(l)&&r(l),x(z)}else r(l);d=n(l)}if(d!==null)var Z=!0;else{var te=n(u);te!==null&&G(y,te.startTime-z),Z=!1}return Z}finally{d=null,f=U,h=!1}}var C=!1,k=null,w=-1,I=5,N=-1;function E(){return!(t.unstable_now()-N<I)}function R(){if(k!==null){var P=t.unstable_now();N=P;var z=!0;try{z=k(!0,P)}finally{z?S():(C=!1,k=null)}}else C=!1}var S;if(typeof b=="function")S=function(){b(R)};else if(typeof MessageChannel<"u"){var T=new MessageChannel,F=T.port2;T.port1.onmessage=R,S=function(){F.postMessage(null)}}else S=function(){v(R,0)};function L(P){k=P,C||(C=!0,S())}function G(P,z){w=v(function(){P(t.unstable_now())},z)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(P){P.callback=null},t.unstable_continueExecution=function(){p||h||(p=!0,L($))},t.unstable_forceFrameRate=function(P){0>P||125<P?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<P?Math.floor(1e3/P):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(P){switch(f){case 1:case 2:case 3:var z=3;break;default:z=f}var U=f;f=z;try{return P()}finally{f=U}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(P,z){switch(P){case 1:case 2:case 3:case 4:case 5:break;default:P=3}var U=f;f=P;try{return z()}finally{f=U}},t.unstable_scheduleCallback=function(P,z,U){var K=t.unstable_now();switch(typeof U=="object"&&U!==null?(U=U.delay,U=typeof U=="number"&&0<U?K+U:K):U=K,P){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=U+Q,P={id:c++,callback:z,priorityLevel:P,startTime:U,expirationTime:Q,sortIndex:-1},U>K?(P.sortIndex=U,e(u,P),n(l)===null&&P===n(u)&&(g?(m(w),w=-1):g=!0,G(y,U-K))):(P.sortIndex=Q,e(l,P),p||h||(p=!0,L($))),P},t.unstable_shouldYield=E,t.unstable_wrapCallback=function(P){var z=f;return function(){var U=f;f=z;try{return P.apply(this,arguments)}finally{f=U}}}})(sT);rT.exports=sT;var Q_=rT.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Z_=A,vr=Q_;function se(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var oT=new Set,Sc={};function ka(t,e){Al(t,e),Al(t+"Capture",e)}function Al(t,e){for(Sc[t]=e,t=0;t<e.length;t++)oT.add(e[t])}var fo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Vv=Object.prototype.hasOwnProperty,J_=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,DC={},AC={};function e4(t){return Vv.call(AC,t)?!0:Vv.call(DC,t)?!1:J_.test(t)?AC[t]=!0:(DC[t]=!0,!1)}function t4(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function n4(t,e,n,r){if(e===null||typeof e>"u"||t4(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Kn(t,e,n,r,s,o,i){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=i}var vn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){vn[t]=new Kn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];vn[e]=new Kn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){vn[t]=new Kn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){vn[t]=new Kn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){vn[t]=new Kn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){vn[t]=new Kn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){vn[t]=new Kn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){vn[t]=new Kn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){vn[t]=new Kn(t,5,!1,t.toLowerCase(),null,!1,!1)});var sy=/[\-:]([a-z])/g;function oy(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(sy,oy);vn[e]=new Kn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(sy,oy);vn[e]=new Kn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(sy,oy);vn[e]=new Kn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){vn[t]=new Kn(t,1,!1,t.toLowerCase(),null,!1,!1)});vn.xlinkHref=new Kn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){vn[t]=new Kn(t,1,!1,t.toLowerCase(),null,!0,!0)});function iy(t,e,n,r){var s=vn.hasOwnProperty(e)?vn[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(n4(e,n,s,r)&&(n=null),r||s===null?e4(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var yo=Z_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Wf=Symbol.for("react.element"),nl=Symbol.for("react.portal"),rl=Symbol.for("react.fragment"),ay=Symbol.for("react.strict_mode"),Bv=Symbol.for("react.profiler"),iT=Symbol.for("react.provider"),aT=Symbol.for("react.context"),ly=Symbol.for("react.forward_ref"),Wv=Symbol.for("react.suspense"),Uv=Symbol.for("react.suspense_list"),uy=Symbol.for("react.memo"),Ro=Symbol.for("react.lazy"),lT=Symbol.for("react.offscreen"),FC=Symbol.iterator;function Su(t){return t===null||typeof t!="object"?null:(t=FC&&t[FC]||t["@@iterator"],typeof t=="function"?t:null)}var Rt=Object.assign,D0;function Gu(t){if(D0===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);D0=e&&e[1]||""}return`
`+D0+t}var A0=!1;function F0(t,e){if(!t||A0)return"";A0=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),o=r.stack.split(`
`),i=s.length-1,a=o.length-1;1<=i&&0<=a&&s[i]!==o[a];)a--;for(;1<=i&&0<=a;i--,a--)if(s[i]!==o[a]){if(i!==1||a!==1)do if(i--,a--,0>a||s[i]!==o[a]){var l=`
`+s[i].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=i&&0<=a);break}}}finally{A0=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Gu(t):""}function r4(t){switch(t.tag){case 5:return Gu(t.type);case 16:return Gu("Lazy");case 13:return Gu("Suspense");case 19:return Gu("SuspenseList");case 0:case 2:case 15:return t=F0(t.type,!1),t;case 11:return t=F0(t.type.render,!1),t;case 1:return t=F0(t.type,!0),t;default:return""}}function Gv(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case rl:return"Fragment";case nl:return"Portal";case Bv:return"Profiler";case ay:return"StrictMode";case Wv:return"Suspense";case Uv:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case aT:return(t.displayName||"Context")+".Consumer";case iT:return(t._context.displayName||"Context")+".Provider";case ly:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case uy:return e=t.displayName||null,e!==null?e:Gv(t.type)||"Memo";case Ro:e=t._payload,t=t._init;try{return Gv(t(e))}catch{}}return null}function s4(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Gv(e);case 8:return e===ay?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ti(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function uT(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function o4(t){var e=uT(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(i){r=""+i,o.call(this,i)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(i){r=""+i},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Uf(t){t._valueTracker||(t._valueTracker=o4(t))}function cT(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=uT(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Jh(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Hv(t,e){var n=e.checked;return Rt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function PC(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=ti(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function dT(t,e){e=e.checked,e!=null&&iy(t,"checked",e,!1)}function jv(t,e){dT(t,e);var n=ti(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Kv(t,e.type,n):e.hasOwnProperty("defaultValue")&&Kv(t,e.type,ti(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function OC(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Kv(t,e,n){(e!=="number"||Jh(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Hu=Array.isArray;function xl(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+ti(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Xv(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(se(91));return Rt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function LC(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(se(92));if(Hu(n)){if(1<n.length)throw Error(se(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:ti(n)}}function fT(t,e){var n=ti(e.value),r=ti(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function MC(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function hT(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function qv(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?hT(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Gf,pT=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Gf=Gf||document.createElement("div"),Gf.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Gf.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Ic(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var rc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},i4=["Webkit","ms","Moz","O"];Object.keys(rc).forEach(function(t){i4.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),rc[e]=rc[t]})});function mT(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||rc.hasOwnProperty(t)&&rc[t]?(""+e).trim():e+"px"}function gT(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=mT(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var a4=Rt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Yv(t,e){if(e){if(a4[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(se(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(se(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(se(61))}if(e.style!=null&&typeof e.style!="object")throw Error(se(62))}}function Qv(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Zv=null;function cy(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Jv=null,yl=null,wl=null;function _C(t){if(t=ud(t)){if(typeof Jv!="function")throw Error(se(280));var e=t.stateNode;e&&(e=Em(e),Jv(t.stateNode,t.type,e))}}function vT(t){yl?wl?wl.push(t):wl=[t]:yl=t}function bT(){if(yl){var t=yl,e=wl;if(wl=yl=null,_C(t),e)for(t=0;t<e.length;t++)_C(e[t])}}function xT(t,e){return t(e)}function yT(){}var P0=!1;function wT(t,e,n){if(P0)return t(e,n);P0=!0;try{return xT(t,e,n)}finally{P0=!1,(yl!==null||wl!==null)&&(yT(),bT())}}function Tc(t,e){var n=t.stateNode;if(n===null)return null;var r=Em(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(se(231,e,typeof n));return n}var eb=!1;if(fo)try{var Iu={};Object.defineProperty(Iu,"passive",{get:function(){eb=!0}}),window.addEventListener("test",Iu,Iu),window.removeEventListener("test",Iu,Iu)}catch{eb=!1}function l4(t,e,n,r,s,o,i,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(c){this.onError(c)}}var sc=!1,ep=null,tp=!1,tb=null,u4={onError:function(t){sc=!0,ep=t}};function c4(t,e,n,r,s,o,i,a,l){sc=!1,ep=null,l4.apply(u4,arguments)}function d4(t,e,n,r,s,o,i,a,l){if(c4.apply(this,arguments),sc){if(sc){var u=ep;sc=!1,ep=null}else throw Error(se(198));tp||(tp=!0,tb=u)}}function Sa(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function $T(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function zC(t){if(Sa(t)!==t)throw Error(se(188))}function f4(t){var e=t.alternate;if(!e){if(e=Sa(t),e===null)throw Error(se(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var o=s.alternate;if(o===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===o.child){for(o=s.child;o;){if(o===n)return zC(s),t;if(o===r)return zC(s),e;o=o.sibling}throw Error(se(188))}if(n.return!==r.return)n=s,r=o;else{for(var i=!1,a=s.child;a;){if(a===n){i=!0,n=s,r=o;break}if(a===r){i=!0,r=s,n=o;break}a=a.sibling}if(!i){for(a=o.child;a;){if(a===n){i=!0,n=o,r=s;break}if(a===r){i=!0,r=o,n=s;break}a=a.sibling}if(!i)throw Error(se(189))}}if(n.alternate!==r)throw Error(se(190))}if(n.tag!==3)throw Error(se(188));return n.stateNode.current===n?t:e}function CT(t){return t=f4(t),t!==null?kT(t):null}function kT(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=kT(t);if(e!==null)return e;t=t.sibling}return null}var ST=vr.unstable_scheduleCallback,VC=vr.unstable_cancelCallback,h4=vr.unstable_shouldYield,p4=vr.unstable_requestPaint,_t=vr.unstable_now,m4=vr.unstable_getCurrentPriorityLevel,dy=vr.unstable_ImmediatePriority,IT=vr.unstable_UserBlockingPriority,np=vr.unstable_NormalPriority,g4=vr.unstable_LowPriority,TT=vr.unstable_IdlePriority,km=null,Os=null;function v4(t){if(Os&&typeof Os.onCommitFiberRoot=="function")try{Os.onCommitFiberRoot(km,t,void 0,(t.current.flags&128)===128)}catch{}}var fs=Math.clz32?Math.clz32:y4,b4=Math.log,x4=Math.LN2;function y4(t){return t>>>=0,t===0?32:31-(b4(t)/x4|0)|0}var Hf=64,jf=4194304;function ju(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function rp(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,o=t.pingedLanes,i=n&268435455;if(i!==0){var a=i&~s;a!==0?r=ju(a):(o&=i,o!==0&&(r=ju(o)))}else i=n&~s,i!==0?r=ju(i):o!==0&&(r=ju(o));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,o=e&-e,s>=o||s===16&&(o&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-fs(e),s=1<<n,r|=t[n],e&=~s;return r}function w4(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function $4(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,o=t.pendingLanes;0<o;){var i=31-fs(o),a=1<<i,l=s[i];l===-1?(!(a&n)||a&r)&&(s[i]=w4(a,e)):l<=e&&(t.expiredLanes|=a),o&=~a}}function nb(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function ET(){var t=Hf;return Hf<<=1,!(Hf&4194240)&&(Hf=64),t}function O0(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function ad(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-fs(e),t[e]=n}function C4(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-fs(n),o=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~o}}function fy(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-fs(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var rt=0;function NT(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var RT,hy,DT,AT,FT,rb=!1,Kf=[],Bo=null,Wo=null,Uo=null,Ec=new Map,Nc=new Map,Fo=[],k4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function BC(t,e){switch(t){case"focusin":case"focusout":Bo=null;break;case"dragenter":case"dragleave":Wo=null;break;case"mouseover":case"mouseout":Uo=null;break;case"pointerover":case"pointerout":Ec.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Nc.delete(e.pointerId)}}function Tu(t,e,n,r,s,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[s]},e!==null&&(e=ud(e),e!==null&&hy(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function S4(t,e,n,r,s){switch(e){case"focusin":return Bo=Tu(Bo,t,e,n,r,s),!0;case"dragenter":return Wo=Tu(Wo,t,e,n,r,s),!0;case"mouseover":return Uo=Tu(Uo,t,e,n,r,s),!0;case"pointerover":var o=s.pointerId;return Ec.set(o,Tu(Ec.get(o)||null,t,e,n,r,s)),!0;case"gotpointercapture":return o=s.pointerId,Nc.set(o,Tu(Nc.get(o)||null,t,e,n,r,s)),!0}return!1}function PT(t){var e=Ai(t.target);if(e!==null){var n=Sa(e);if(n!==null){if(e=n.tag,e===13){if(e=$T(n),e!==null){t.blockedOn=e,FT(t.priority,function(){DT(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Mh(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=sb(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Zv=r,n.target.dispatchEvent(r),Zv=null}else return e=ud(n),e!==null&&hy(e),t.blockedOn=n,!1;e.shift()}return!0}function WC(t,e,n){Mh(t)&&n.delete(e)}function I4(){rb=!1,Bo!==null&&Mh(Bo)&&(Bo=null),Wo!==null&&Mh(Wo)&&(Wo=null),Uo!==null&&Mh(Uo)&&(Uo=null),Ec.forEach(WC),Nc.forEach(WC)}function Eu(t,e){t.blockedOn===e&&(t.blockedOn=null,rb||(rb=!0,vr.unstable_scheduleCallback(vr.unstable_NormalPriority,I4)))}function Rc(t){function e(s){return Eu(s,t)}if(0<Kf.length){Eu(Kf[0],t);for(var n=1;n<Kf.length;n++){var r=Kf[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Bo!==null&&Eu(Bo,t),Wo!==null&&Eu(Wo,t),Uo!==null&&Eu(Uo,t),Ec.forEach(e),Nc.forEach(e),n=0;n<Fo.length;n++)r=Fo[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Fo.length&&(n=Fo[0],n.blockedOn===null);)PT(n),n.blockedOn===null&&Fo.shift()}var $l=yo.ReactCurrentBatchConfig,sp=!0;function T4(t,e,n,r){var s=rt,o=$l.transition;$l.transition=null;try{rt=1,py(t,e,n,r)}finally{rt=s,$l.transition=o}}function E4(t,e,n,r){var s=rt,o=$l.transition;$l.transition=null;try{rt=4,py(t,e,n,r)}finally{rt=s,$l.transition=o}}function py(t,e,n,r){if(sp){var s=sb(t,e,n,r);if(s===null)H0(t,e,r,op,n),BC(t,r);else if(S4(s,t,e,n,r))r.stopPropagation();else if(BC(t,r),e&4&&-1<k4.indexOf(t)){for(;s!==null;){var o=ud(s);if(o!==null&&RT(o),o=sb(t,e,n,r),o===null&&H0(t,e,r,op,n),o===s)break;s=o}s!==null&&r.stopPropagation()}else H0(t,e,r,null,n)}}var op=null;function sb(t,e,n,r){if(op=null,t=cy(r),t=Ai(t),t!==null)if(e=Sa(t),e===null)t=null;else if(n=e.tag,n===13){if(t=$T(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return op=t,null}function OT(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(m4()){case dy:return 1;case IT:return 4;case np:case g4:return 16;case TT:return 536870912;default:return 16}default:return 16}}var Oo=null,my=null,_h=null;function LT(){if(_h)return _h;var t,e=my,n=e.length,r,s="value"in Oo?Oo.value:Oo.textContent,o=s.length;for(t=0;t<n&&e[t]===s[t];t++);var i=n-t;for(r=1;r<=i&&e[n-r]===s[o-r];r++);return _h=s.slice(t,1<r?1-r:void 0)}function zh(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Xf(){return!0}function UC(){return!1}function yr(t){function e(n,r,s,o,i){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=o,this.target=i,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(o):o[a]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?Xf:UC,this.isPropagationStopped=UC,this}return Rt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Xf)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Xf)},persist:function(){},isPersistent:Xf}),e}var eu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},gy=yr(eu),ld=Rt({},eu,{view:0,detail:0}),N4=yr(ld),L0,M0,Nu,Sm=Rt({},ld,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:vy,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Nu&&(Nu&&t.type==="mousemove"?(L0=t.screenX-Nu.screenX,M0=t.screenY-Nu.screenY):M0=L0=0,Nu=t),L0)},movementY:function(t){return"movementY"in t?t.movementY:M0}}),GC=yr(Sm),R4=Rt({},Sm,{dataTransfer:0}),D4=yr(R4),A4=Rt({},ld,{relatedTarget:0}),_0=yr(A4),F4=Rt({},eu,{animationName:0,elapsedTime:0,pseudoElement:0}),P4=yr(F4),O4=Rt({},eu,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),L4=yr(O4),M4=Rt({},eu,{data:0}),HC=yr(M4),_4={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},z4={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},V4={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function B4(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=V4[t])?!!e[t]:!1}function vy(){return B4}var W4=Rt({},ld,{key:function(t){if(t.key){var e=_4[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=zh(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?z4[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:vy,charCode:function(t){return t.type==="keypress"?zh(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?zh(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),U4=yr(W4),G4=Rt({},Sm,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),jC=yr(G4),H4=Rt({},ld,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:vy}),j4=yr(H4),K4=Rt({},eu,{propertyName:0,elapsedTime:0,pseudoElement:0}),X4=yr(K4),q4=Rt({},Sm,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Y4=yr(q4),Q4=[9,13,27,32],by=fo&&"CompositionEvent"in window,oc=null;fo&&"documentMode"in document&&(oc=document.documentMode);var Z4=fo&&"TextEvent"in window&&!oc,MT=fo&&(!by||oc&&8<oc&&11>=oc),KC=" ",XC=!1;function _T(t,e){switch(t){case"keyup":return Q4.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zT(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var sl=!1;function J4(t,e){switch(t){case"compositionend":return zT(e);case"keypress":return e.which!==32?null:(XC=!0,KC);case"textInput":return t=e.data,t===KC&&XC?null:t;default:return null}}function ez(t,e){if(sl)return t==="compositionend"||!by&&_T(t,e)?(t=LT(),_h=my=Oo=null,sl=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return MT&&e.locale!=="ko"?null:e.data;default:return null}}var tz={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qC(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!tz[t.type]:e==="textarea"}function VT(t,e,n,r){vT(r),e=ip(e,"onChange"),0<e.length&&(n=new gy("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var ic=null,Dc=null;function nz(t){QT(t,0)}function Im(t){var e=al(t);if(cT(e))return t}function rz(t,e){if(t==="change")return e}var BT=!1;if(fo){var z0;if(fo){var V0="oninput"in document;if(!V0){var YC=document.createElement("div");YC.setAttribute("oninput","return;"),V0=typeof YC.oninput=="function"}z0=V0}else z0=!1;BT=z0&&(!document.documentMode||9<document.documentMode)}function QC(){ic&&(ic.detachEvent("onpropertychange",WT),Dc=ic=null)}function WT(t){if(t.propertyName==="value"&&Im(Dc)){var e=[];VT(e,Dc,t,cy(t)),wT(nz,e)}}function sz(t,e,n){t==="focusin"?(QC(),ic=e,Dc=n,ic.attachEvent("onpropertychange",WT)):t==="focusout"&&QC()}function oz(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Im(Dc)}function iz(t,e){if(t==="click")return Im(e)}function az(t,e){if(t==="input"||t==="change")return Im(e)}function lz(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var vs=typeof Object.is=="function"?Object.is:lz;function Ac(t,e){if(vs(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Vv.call(e,s)||!vs(t[s],e[s]))return!1}return!0}function ZC(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function JC(t,e){var n=ZC(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=ZC(n)}}function UT(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?UT(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function GT(){for(var t=window,e=Jh();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Jh(t.document)}return e}function xy(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function uz(t){var e=GT(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&UT(n.ownerDocument.documentElement,n)){if(r!==null&&xy(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,o=Math.min(r.start,s);r=r.end===void 0?o:Math.min(r.end,s),!t.extend&&o>r&&(s=r,r=o,o=s),s=JC(n,o);var i=JC(n,r);s&&i&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==i.node||t.focusOffset!==i.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),o>r?(t.addRange(e),t.extend(i.node,i.offset)):(e.setEnd(i.node,i.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var cz=fo&&"documentMode"in document&&11>=document.documentMode,ol=null,ob=null,ac=null,ib=!1;function ek(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;ib||ol==null||ol!==Jh(r)||(r=ol,"selectionStart"in r&&xy(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ac&&Ac(ac,r)||(ac=r,r=ip(ob,"onSelect"),0<r.length&&(e=new gy("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=ol)))}function qf(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var il={animationend:qf("Animation","AnimationEnd"),animationiteration:qf("Animation","AnimationIteration"),animationstart:qf("Animation","AnimationStart"),transitionend:qf("Transition","TransitionEnd")},B0={},HT={};fo&&(HT=document.createElement("div").style,"AnimationEvent"in window||(delete il.animationend.animation,delete il.animationiteration.animation,delete il.animationstart.animation),"TransitionEvent"in window||delete il.transitionend.transition);function Tm(t){if(B0[t])return B0[t];if(!il[t])return t;var e=il[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in HT)return B0[t]=e[n];return t}var jT=Tm("animationend"),KT=Tm("animationiteration"),XT=Tm("animationstart"),qT=Tm("transitionend"),YT=new Map,tk="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ui(t,e){YT.set(t,e),ka(e,[t])}for(var W0=0;W0<tk.length;W0++){var U0=tk[W0],dz=U0.toLowerCase(),fz=U0[0].toUpperCase()+U0.slice(1);ui(dz,"on"+fz)}ui(jT,"onAnimationEnd");ui(KT,"onAnimationIteration");ui(XT,"onAnimationStart");ui("dblclick","onDoubleClick");ui("focusin","onFocus");ui("focusout","onBlur");ui(qT,"onTransitionEnd");Al("onMouseEnter",["mouseout","mouseover"]);Al("onMouseLeave",["mouseout","mouseover"]);Al("onPointerEnter",["pointerout","pointerover"]);Al("onPointerLeave",["pointerout","pointerover"]);ka("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ka("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ka("onBeforeInput",["compositionend","keypress","textInput","paste"]);ka("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ka("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ka("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ku="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),hz=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ku));function nk(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,d4(r,e,void 0,t),t.currentTarget=null}function QT(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var o=void 0;if(e)for(var i=r.length-1;0<=i;i--){var a=r[i],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==o&&s.isPropagationStopped())break e;nk(s,a,u),o=l}else for(i=0;i<r.length;i++){if(a=r[i],l=a.instance,u=a.currentTarget,a=a.listener,l!==o&&s.isPropagationStopped())break e;nk(s,a,u),o=l}}}if(tp)throw t=tb,tp=!1,tb=null,t}function mt(t,e){var n=e[db];n===void 0&&(n=e[db]=new Set);var r=t+"__bubble";n.has(r)||(ZT(e,t,2,!1),n.add(r))}function G0(t,e,n){var r=0;e&&(r|=4),ZT(n,t,r,e)}var Yf="_reactListening"+Math.random().toString(36).slice(2);function Fc(t){if(!t[Yf]){t[Yf]=!0,oT.forEach(function(n){n!=="selectionchange"&&(hz.has(n)||G0(n,!1,t),G0(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Yf]||(e[Yf]=!0,G0("selectionchange",!1,e))}}function ZT(t,e,n,r){switch(OT(e)){case 1:var s=T4;break;case 4:s=E4;break;default:s=py}n=s.bind(null,e,n,t),s=void 0,!eb||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function H0(t,e,n,r,s){var o=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var i=r.tag;if(i===3||i===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(i===4)for(i=r.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;i=i.return}for(;a!==null;){if(i=Ai(a),i===null)return;if(l=i.tag,l===5||l===6){r=o=i;continue e}a=a.parentNode}}r=r.return}wT(function(){var u=o,c=cy(n),d=[];e:{var f=YT.get(t);if(f!==void 0){var h=gy,p=t;switch(t){case"keypress":if(zh(n)===0)break e;case"keydown":case"keyup":h=U4;break;case"focusin":p="focus",h=_0;break;case"focusout":p="blur",h=_0;break;case"beforeblur":case"afterblur":h=_0;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=GC;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=D4;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=j4;break;case jT:case KT:case XT:h=P4;break;case qT:h=X4;break;case"scroll":h=N4;break;case"wheel":h=Y4;break;case"copy":case"cut":case"paste":h=L4;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=jC}var g=(e&4)!==0,v=!g&&t==="scroll",m=g?f!==null?f+"Capture":null:f;g=[];for(var b=u,x;b!==null;){x=b;var y=x.stateNode;if(x.tag===5&&y!==null&&(x=y,m!==null&&(y=Tc(b,m),y!=null&&g.push(Pc(b,y,x)))),v)break;b=b.return}0<g.length&&(f=new h(f,p,null,n,c),d.push({event:f,listeners:g}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",h=t==="mouseout"||t==="pointerout",f&&n!==Zv&&(p=n.relatedTarget||n.fromElement)&&(Ai(p)||p[ho]))break e;if((h||f)&&(f=c.window===c?c:(f=c.ownerDocument)?f.defaultView||f.parentWindow:window,h?(p=n.relatedTarget||n.toElement,h=u,p=p?Ai(p):null,p!==null&&(v=Sa(p),p!==v||p.tag!==5&&p.tag!==6)&&(p=null)):(h=null,p=u),h!==p)){if(g=GC,y="onMouseLeave",m="onMouseEnter",b="mouse",(t==="pointerout"||t==="pointerover")&&(g=jC,y="onPointerLeave",m="onPointerEnter",b="pointer"),v=h==null?f:al(h),x=p==null?f:al(p),f=new g(y,b+"leave",h,n,c),f.target=v,f.relatedTarget=x,y=null,Ai(c)===u&&(g=new g(m,b+"enter",p,n,c),g.target=x,g.relatedTarget=v,y=g),v=y,h&&p)t:{for(g=h,m=p,b=0,x=g;x;x=Ga(x))b++;for(x=0,y=m;y;y=Ga(y))x++;for(;0<b-x;)g=Ga(g),b--;for(;0<x-b;)m=Ga(m),x--;for(;b--;){if(g===m||m!==null&&g===m.alternate)break t;g=Ga(g),m=Ga(m)}g=null}else g=null;h!==null&&rk(d,f,h,g,!1),p!==null&&v!==null&&rk(d,v,p,g,!0)}}e:{if(f=u?al(u):window,h=f.nodeName&&f.nodeName.toLowerCase(),h==="select"||h==="input"&&f.type==="file")var $=rz;else if(qC(f))if(BT)$=az;else{$=oz;var C=sz}else(h=f.nodeName)&&h.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&($=iz);if($&&($=$(t,u))){VT(d,$,n,c);break e}C&&C(t,f,u),t==="focusout"&&(C=f._wrapperState)&&C.controlled&&f.type==="number"&&Kv(f,"number",f.value)}switch(C=u?al(u):window,t){case"focusin":(qC(C)||C.contentEditable==="true")&&(ol=C,ob=u,ac=null);break;case"focusout":ac=ob=ol=null;break;case"mousedown":ib=!0;break;case"contextmenu":case"mouseup":case"dragend":ib=!1,ek(d,n,c);break;case"selectionchange":if(cz)break;case"keydown":case"keyup":ek(d,n,c)}var k;if(by)e:{switch(t){case"compositionstart":var w="onCompositionStart";break e;case"compositionend":w="onCompositionEnd";break e;case"compositionupdate":w="onCompositionUpdate";break e}w=void 0}else sl?_T(t,n)&&(w="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(w="onCompositionStart");w&&(MT&&n.locale!=="ko"&&(sl||w!=="onCompositionStart"?w==="onCompositionEnd"&&sl&&(k=LT()):(Oo=c,my="value"in Oo?Oo.value:Oo.textContent,sl=!0)),C=ip(u,w),0<C.length&&(w=new HC(w,t,null,n,c),d.push({event:w,listeners:C}),k?w.data=k:(k=zT(n),k!==null&&(w.data=k)))),(k=Z4?J4(t,n):ez(t,n))&&(u=ip(u,"onBeforeInput"),0<u.length&&(c=new HC("onBeforeInput","beforeinput",null,n,c),d.push({event:c,listeners:u}),c.data=k))}QT(d,e)})}function Pc(t,e,n){return{instance:t,listener:e,currentTarget:n}}function ip(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,o=s.stateNode;s.tag===5&&o!==null&&(s=o,o=Tc(t,n),o!=null&&r.unshift(Pc(t,o,s)),o=Tc(t,e),o!=null&&r.push(Pc(t,o,s))),t=t.return}return r}function Ga(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function rk(t,e,n,r,s){for(var o=e._reactName,i=[];n!==null&&n!==r;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&u!==null&&(a=u,s?(l=Tc(n,o),l!=null&&i.unshift(Pc(n,l,a))):s||(l=Tc(n,o),l!=null&&i.push(Pc(n,l,a)))),n=n.return}i.length!==0&&t.push({event:e,listeners:i})}var pz=/\r\n?/g,mz=/\u0000|\uFFFD/g;function sk(t){return(typeof t=="string"?t:""+t).replace(pz,`
`).replace(mz,"")}function Qf(t,e,n){if(e=sk(e),sk(t)!==e&&n)throw Error(se(425))}function ap(){}var ab=null,lb=null;function ub(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var cb=typeof setTimeout=="function"?setTimeout:void 0,gz=typeof clearTimeout=="function"?clearTimeout:void 0,ok=typeof Promise=="function"?Promise:void 0,vz=typeof queueMicrotask=="function"?queueMicrotask:typeof ok<"u"?function(t){return ok.resolve(null).then(t).catch(bz)}:cb;function bz(t){setTimeout(function(){throw t})}function j0(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Rc(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Rc(e)}function Go(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function ik(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var tu=Math.random().toString(36).slice(2),Fs="__reactFiber$"+tu,Oc="__reactProps$"+tu,ho="__reactContainer$"+tu,db="__reactEvents$"+tu,xz="__reactListeners$"+tu,yz="__reactHandles$"+tu;function Ai(t){var e=t[Fs];if(e)return e;for(var n=t.parentNode;n;){if(e=n[ho]||n[Fs]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=ik(t);t!==null;){if(n=t[Fs])return n;t=ik(t)}return e}t=n,n=t.parentNode}return null}function ud(t){return t=t[Fs]||t[ho],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function al(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(se(33))}function Em(t){return t[Oc]||null}var fb=[],ll=-1;function ci(t){return{current:t}}function gt(t){0>ll||(t.current=fb[ll],fb[ll]=null,ll--)}function ct(t,e){ll++,fb[ll]=t.current,t.current=e}var ni={},Pn=ci(ni),tr=ci(!1),Yi=ni;function Fl(t,e){var n=t.type.contextTypes;if(!n)return ni;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},o;for(o in n)s[o]=e[o];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function nr(t){return t=t.childContextTypes,t!=null}function lp(){gt(tr),gt(Pn)}function ak(t,e,n){if(Pn.current!==ni)throw Error(se(168));ct(Pn,e),ct(tr,n)}function JT(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(se(108,s4(t)||"Unknown",s));return Rt({},n,r)}function up(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ni,Yi=Pn.current,ct(Pn,t),ct(tr,tr.current),!0}function lk(t,e,n){var r=t.stateNode;if(!r)throw Error(se(169));n?(t=JT(t,e,Yi),r.__reactInternalMemoizedMergedChildContext=t,gt(tr),gt(Pn),ct(Pn,t)):gt(tr),ct(tr,n)}var eo=null,Nm=!1,K0=!1;function eE(t){eo===null?eo=[t]:eo.push(t)}function wz(t){Nm=!0,eE(t)}function di(){if(!K0&&eo!==null){K0=!0;var t=0,e=rt;try{var n=eo;for(rt=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}eo=null,Nm=!1}catch(s){throw eo!==null&&(eo=eo.slice(t+1)),ST(dy,di),s}finally{rt=e,K0=!1}}return null}var ul=[],cl=0,cp=null,dp=0,Rr=[],Dr=0,Qi=null,so=1,oo="";function Si(t,e){ul[cl++]=dp,ul[cl++]=cp,cp=t,dp=e}function tE(t,e,n){Rr[Dr++]=so,Rr[Dr++]=oo,Rr[Dr++]=Qi,Qi=t;var r=so;t=oo;var s=32-fs(r)-1;r&=~(1<<s),n+=1;var o=32-fs(e)+s;if(30<o){var i=s-s%5;o=(r&(1<<i)-1).toString(32),r>>=i,s-=i,so=1<<32-fs(e)+s|n<<s|r,oo=o+t}else so=1<<o|n<<s|r,oo=t}function yy(t){t.return!==null&&(Si(t,1),tE(t,1,0))}function wy(t){for(;t===cp;)cp=ul[--cl],ul[cl]=null,dp=ul[--cl],ul[cl]=null;for(;t===Qi;)Qi=Rr[--Dr],Rr[Dr]=null,oo=Rr[--Dr],Rr[Dr]=null,so=Rr[--Dr],Rr[Dr]=null}var mr=null,hr=null,$t=!1,ls=null;function nE(t,e){var n=Vr(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function uk(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,mr=t,hr=Go(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,mr=t,hr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Qi!==null?{id:so,overflow:oo}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Vr(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,mr=t,hr=null,!0):!1;default:return!1}}function hb(t){return(t.mode&1)!==0&&(t.flags&128)===0}function pb(t){if($t){var e=hr;if(e){var n=e;if(!uk(t,e)){if(hb(t))throw Error(se(418));e=Go(n.nextSibling);var r=mr;e&&uk(t,e)?nE(r,n):(t.flags=t.flags&-4097|2,$t=!1,mr=t)}}else{if(hb(t))throw Error(se(418));t.flags=t.flags&-4097|2,$t=!1,mr=t}}}function ck(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;mr=t}function Zf(t){if(t!==mr)return!1;if(!$t)return ck(t),$t=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!ub(t.type,t.memoizedProps)),e&&(e=hr)){if(hb(t))throw rE(),Error(se(418));for(;e;)nE(t,e),e=Go(e.nextSibling)}if(ck(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(se(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){hr=Go(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}hr=null}}else hr=mr?Go(t.stateNode.nextSibling):null;return!0}function rE(){for(var t=hr;t;)t=Go(t.nextSibling)}function Pl(){hr=mr=null,$t=!1}function $y(t){ls===null?ls=[t]:ls.push(t)}var $z=yo.ReactCurrentBatchConfig;function Ru(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(se(309));var r=n.stateNode}if(!r)throw Error(se(147,t));var s=r,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(i){var a=s.refs;i===null?delete a[o]:a[o]=i},e._stringRef=o,e)}if(typeof t!="string")throw Error(se(284));if(!n._owner)throw Error(se(290,t))}return t}function Jf(t,e){throw t=Object.prototype.toString.call(e),Error(se(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function dk(t){var e=t._init;return e(t._payload)}function sE(t){function e(m,b){if(t){var x=m.deletions;x===null?(m.deletions=[b],m.flags|=16):x.push(b)}}function n(m,b){if(!t)return null;for(;b!==null;)e(m,b),b=b.sibling;return null}function r(m,b){for(m=new Map;b!==null;)b.key!==null?m.set(b.key,b):m.set(b.index,b),b=b.sibling;return m}function s(m,b){return m=Xo(m,b),m.index=0,m.sibling=null,m}function o(m,b,x){return m.index=x,t?(x=m.alternate,x!==null?(x=x.index,x<b?(m.flags|=2,b):x):(m.flags|=2,b)):(m.flags|=1048576,b)}function i(m){return t&&m.alternate===null&&(m.flags|=2),m}function a(m,b,x,y){return b===null||b.tag!==6?(b=ev(x,m.mode,y),b.return=m,b):(b=s(b,x),b.return=m,b)}function l(m,b,x,y){var $=x.type;return $===rl?c(m,b,x.props.children,y,x.key):b!==null&&(b.elementType===$||typeof $=="object"&&$!==null&&$.$$typeof===Ro&&dk($)===b.type)?(y=s(b,x.props),y.ref=Ru(m,b,x),y.return=m,y):(y=jh(x.type,x.key,x.props,null,m.mode,y),y.ref=Ru(m,b,x),y.return=m,y)}function u(m,b,x,y){return b===null||b.tag!==4||b.stateNode.containerInfo!==x.containerInfo||b.stateNode.implementation!==x.implementation?(b=tv(x,m.mode,y),b.return=m,b):(b=s(b,x.children||[]),b.return=m,b)}function c(m,b,x,y,$){return b===null||b.tag!==7?(b=Gi(x,m.mode,y,$),b.return=m,b):(b=s(b,x),b.return=m,b)}function d(m,b,x){if(typeof b=="string"&&b!==""||typeof b=="number")return b=ev(""+b,m.mode,x),b.return=m,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Wf:return x=jh(b.type,b.key,b.props,null,m.mode,x),x.ref=Ru(m,null,b),x.return=m,x;case nl:return b=tv(b,m.mode,x),b.return=m,b;case Ro:var y=b._init;return d(m,y(b._payload),x)}if(Hu(b)||Su(b))return b=Gi(b,m.mode,x,null),b.return=m,b;Jf(m,b)}return null}function f(m,b,x,y){var $=b!==null?b.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return $!==null?null:a(m,b,""+x,y);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Wf:return x.key===$?l(m,b,x,y):null;case nl:return x.key===$?u(m,b,x,y):null;case Ro:return $=x._init,f(m,b,$(x._payload),y)}if(Hu(x)||Su(x))return $!==null?null:c(m,b,x,y,null);Jf(m,x)}return null}function h(m,b,x,y,$){if(typeof y=="string"&&y!==""||typeof y=="number")return m=m.get(x)||null,a(b,m,""+y,$);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Wf:return m=m.get(y.key===null?x:y.key)||null,l(b,m,y,$);case nl:return m=m.get(y.key===null?x:y.key)||null,u(b,m,y,$);case Ro:var C=y._init;return h(m,b,x,C(y._payload),$)}if(Hu(y)||Su(y))return m=m.get(x)||null,c(b,m,y,$,null);Jf(b,y)}return null}function p(m,b,x,y){for(var $=null,C=null,k=b,w=b=0,I=null;k!==null&&w<x.length;w++){k.index>w?(I=k,k=null):I=k.sibling;var N=f(m,k,x[w],y);if(N===null){k===null&&(k=I);break}t&&k&&N.alternate===null&&e(m,k),b=o(N,b,w),C===null?$=N:C.sibling=N,C=N,k=I}if(w===x.length)return n(m,k),$t&&Si(m,w),$;if(k===null){for(;w<x.length;w++)k=d(m,x[w],y),k!==null&&(b=o(k,b,w),C===null?$=k:C.sibling=k,C=k);return $t&&Si(m,w),$}for(k=r(m,k);w<x.length;w++)I=h(k,m,w,x[w],y),I!==null&&(t&&I.alternate!==null&&k.delete(I.key===null?w:I.key),b=o(I,b,w),C===null?$=I:C.sibling=I,C=I);return t&&k.forEach(function(E){return e(m,E)}),$t&&Si(m,w),$}function g(m,b,x,y){var $=Su(x);if(typeof $!="function")throw Error(se(150));if(x=$.call(x),x==null)throw Error(se(151));for(var C=$=null,k=b,w=b=0,I=null,N=x.next();k!==null&&!N.done;w++,N=x.next()){k.index>w?(I=k,k=null):I=k.sibling;var E=f(m,k,N.value,y);if(E===null){k===null&&(k=I);break}t&&k&&E.alternate===null&&e(m,k),b=o(E,b,w),C===null?$=E:C.sibling=E,C=E,k=I}if(N.done)return n(m,k),$t&&Si(m,w),$;if(k===null){for(;!N.done;w++,N=x.next())N=d(m,N.value,y),N!==null&&(b=o(N,b,w),C===null?$=N:C.sibling=N,C=N);return $t&&Si(m,w),$}for(k=r(m,k);!N.done;w++,N=x.next())N=h(k,m,w,N.value,y),N!==null&&(t&&N.alternate!==null&&k.delete(N.key===null?w:N.key),b=o(N,b,w),C===null?$=N:C.sibling=N,C=N);return t&&k.forEach(function(R){return e(m,R)}),$t&&Si(m,w),$}function v(m,b,x,y){if(typeof x=="object"&&x!==null&&x.type===rl&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case Wf:e:{for(var $=x.key,C=b;C!==null;){if(C.key===$){if($=x.type,$===rl){if(C.tag===7){n(m,C.sibling),b=s(C,x.props.children),b.return=m,m=b;break e}}else if(C.elementType===$||typeof $=="object"&&$!==null&&$.$$typeof===Ro&&dk($)===C.type){n(m,C.sibling),b=s(C,x.props),b.ref=Ru(m,C,x),b.return=m,m=b;break e}n(m,C);break}else e(m,C);C=C.sibling}x.type===rl?(b=Gi(x.props.children,m.mode,y,x.key),b.return=m,m=b):(y=jh(x.type,x.key,x.props,null,m.mode,y),y.ref=Ru(m,b,x),y.return=m,m=y)}return i(m);case nl:e:{for(C=x.key;b!==null;){if(b.key===C)if(b.tag===4&&b.stateNode.containerInfo===x.containerInfo&&b.stateNode.implementation===x.implementation){n(m,b.sibling),b=s(b,x.children||[]),b.return=m,m=b;break e}else{n(m,b);break}else e(m,b);b=b.sibling}b=tv(x,m.mode,y),b.return=m,m=b}return i(m);case Ro:return C=x._init,v(m,b,C(x._payload),y)}if(Hu(x))return p(m,b,x,y);if(Su(x))return g(m,b,x,y);Jf(m,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,b!==null&&b.tag===6?(n(m,b.sibling),b=s(b,x),b.return=m,m=b):(n(m,b),b=ev(x,m.mode,y),b.return=m,m=b),i(m)):n(m,b)}return v}var Ol=sE(!0),oE=sE(!1),fp=ci(null),hp=null,dl=null,Cy=null;function ky(){Cy=dl=hp=null}function Sy(t){var e=fp.current;gt(fp),t._currentValue=e}function mb(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Cl(t,e){hp=t,Cy=dl=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Zn=!0),t.firstContext=null)}function Kr(t){var e=t._currentValue;if(Cy!==t)if(t={context:t,memoizedValue:e,next:null},dl===null){if(hp===null)throw Error(se(308));dl=t,hp.dependencies={lanes:0,firstContext:t}}else dl=dl.next=t;return e}var Fi=null;function Iy(t){Fi===null?Fi=[t]:Fi.push(t)}function iE(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Iy(e)):(n.next=s.next,s.next=n),e.interleaved=n,po(t,r)}function po(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Do=!1;function Ty(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function aE(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function uo(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Ho(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,He&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,po(t,n)}return s=r.interleaved,s===null?(e.next=e,Iy(r)):(e.next=s.next,s.next=e),r.interleaved=e,po(t,n)}function Vh(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,fy(t,n)}}function fk(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?s=o=i:o=o.next=i,n=n.next}while(n!==null);o===null?s=o=e:o=o.next=e}else s=o=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:o,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function pp(t,e,n,r){var s=t.updateQueue;Do=!1;var o=s.firstBaseUpdate,i=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var l=a,u=l.next;l.next=null,i===null?o=u:i.next=u,i=l;var c=t.alternate;c!==null&&(c=c.updateQueue,a=c.lastBaseUpdate,a!==i&&(a===null?c.firstBaseUpdate=u:a.next=u,c.lastBaseUpdate=l))}if(o!==null){var d=s.baseState;i=0,c=u=l=null,a=o;do{var f=a.lane,h=a.eventTime;if((r&f)===f){c!==null&&(c=c.next={eventTime:h,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=t,g=a;switch(f=e,h=n,g.tag){case 1:if(p=g.payload,typeof p=="function"){d=p.call(h,d,f);break e}d=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=g.payload,f=typeof p=="function"?p.call(h,d,f):p,f==null)break e;d=Rt({},d,f);break e;case 2:Do=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,f=s.effects,f===null?s.effects=[a]:f.push(a))}else h={eventTime:h,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},c===null?(u=c=h,l=d):c=c.next=h,i|=f;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;f=a,a=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(!0);if(c===null&&(l=d),s.baseState=l,s.firstBaseUpdate=u,s.lastBaseUpdate=c,e=s.shared.interleaved,e!==null){s=e;do i|=s.lane,s=s.next;while(s!==e)}else o===null&&(s.shared.lanes=0);Ji|=i,t.lanes=i,t.memoizedState=d}}function hk(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(se(191,s));s.call(r)}}}var cd={},Ls=ci(cd),Lc=ci(cd),Mc=ci(cd);function Pi(t){if(t===cd)throw Error(se(174));return t}function Ey(t,e){switch(ct(Mc,e),ct(Lc,t),ct(Ls,cd),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:qv(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=qv(e,t)}gt(Ls),ct(Ls,e)}function Ll(){gt(Ls),gt(Lc),gt(Mc)}function lE(t){Pi(Mc.current);var e=Pi(Ls.current),n=qv(e,t.type);e!==n&&(ct(Lc,t),ct(Ls,n))}function Ny(t){Lc.current===t&&(gt(Ls),gt(Lc))}var Et=ci(0);function mp(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var X0=[];function Ry(){for(var t=0;t<X0.length;t++)X0[t]._workInProgressVersionPrimary=null;X0.length=0}var Bh=yo.ReactCurrentDispatcher,q0=yo.ReactCurrentBatchConfig,Zi=0,Nt=null,Zt=null,an=null,gp=!1,lc=!1,_c=0,Cz=0;function kn(){throw Error(se(321))}function Dy(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!vs(t[n],e[n]))return!1;return!0}function Ay(t,e,n,r,s,o){if(Zi=o,Nt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Bh.current=t===null||t.memoizedState===null?Tz:Ez,t=n(r,s),lc){o=0;do{if(lc=!1,_c=0,25<=o)throw Error(se(301));o+=1,an=Zt=null,e.updateQueue=null,Bh.current=Nz,t=n(r,s)}while(lc)}if(Bh.current=vp,e=Zt!==null&&Zt.next!==null,Zi=0,an=Zt=Nt=null,gp=!1,e)throw Error(se(300));return t}function Fy(){var t=_c!==0;return _c=0,t}function Ts(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return an===null?Nt.memoizedState=an=t:an=an.next=t,an}function Xr(){if(Zt===null){var t=Nt.alternate;t=t!==null?t.memoizedState:null}else t=Zt.next;var e=an===null?Nt.memoizedState:an.next;if(e!==null)an=e,Zt=t;else{if(t===null)throw Error(se(310));Zt=t,t={memoizedState:Zt.memoizedState,baseState:Zt.baseState,baseQueue:Zt.baseQueue,queue:Zt.queue,next:null},an===null?Nt.memoizedState=an=t:an=an.next=t}return an}function zc(t,e){return typeof e=="function"?e(t):e}function Y0(t){var e=Xr(),n=e.queue;if(n===null)throw Error(se(311));n.lastRenderedReducer=t;var r=Zt,s=r.baseQueue,o=n.pending;if(o!==null){if(s!==null){var i=s.next;s.next=o.next,o.next=i}r.baseQueue=s=o,n.pending=null}if(s!==null){o=s.next,r=r.baseState;var a=i=null,l=null,u=o;do{var c=u.lane;if((Zi&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var d={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=d,i=r):l=l.next=d,Nt.lanes|=c,Ji|=c}u=u.next}while(u!==null&&u!==o);l===null?i=r:l.next=a,vs(r,e.memoizedState)||(Zn=!0),e.memoizedState=r,e.baseState=i,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do o=s.lane,Nt.lanes|=o,Ji|=o,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Q0(t){var e=Xr(),n=e.queue;if(n===null)throw Error(se(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,o=e.memoizedState;if(s!==null){n.pending=null;var i=s=s.next;do o=t(o,i.action),i=i.next;while(i!==s);vs(o,e.memoizedState)||(Zn=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),n.lastRenderedState=o}return[o,r]}function uE(){}function cE(t,e){var n=Nt,r=Xr(),s=e(),o=!vs(r.memoizedState,s);if(o&&(r.memoizedState=s,Zn=!0),r=r.queue,Py(hE.bind(null,n,r,t),[t]),r.getSnapshot!==e||o||an!==null&&an.memoizedState.tag&1){if(n.flags|=2048,Vc(9,fE.bind(null,n,r,s,e),void 0,null),un===null)throw Error(se(349));Zi&30||dE(n,e,s)}return s}function dE(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Nt.updateQueue,e===null?(e={lastEffect:null,stores:null},Nt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function fE(t,e,n,r){e.value=n,e.getSnapshot=r,pE(e)&&mE(t)}function hE(t,e,n){return n(function(){pE(e)&&mE(t)})}function pE(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!vs(t,n)}catch{return!0}}function mE(t){var e=po(t,1);e!==null&&hs(e,t,1,-1)}function pk(t){var e=Ts();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:zc,lastRenderedState:t},e.queue=t,t=t.dispatch=Iz.bind(null,Nt,t),[e.memoizedState,t]}function Vc(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Nt.updateQueue,e===null?(e={lastEffect:null,stores:null},Nt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function gE(){return Xr().memoizedState}function Wh(t,e,n,r){var s=Ts();Nt.flags|=t,s.memoizedState=Vc(1|e,n,void 0,r===void 0?null:r)}function Rm(t,e,n,r){var s=Xr();r=r===void 0?null:r;var o=void 0;if(Zt!==null){var i=Zt.memoizedState;if(o=i.destroy,r!==null&&Dy(r,i.deps)){s.memoizedState=Vc(e,n,o,r);return}}Nt.flags|=t,s.memoizedState=Vc(1|e,n,o,r)}function mk(t,e){return Wh(8390656,8,t,e)}function Py(t,e){return Rm(2048,8,t,e)}function vE(t,e){return Rm(4,2,t,e)}function bE(t,e){return Rm(4,4,t,e)}function xE(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function yE(t,e,n){return n=n!=null?n.concat([t]):null,Rm(4,4,xE.bind(null,e,t),n)}function Oy(){}function wE(t,e){var n=Xr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Dy(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function $E(t,e){var n=Xr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Dy(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function CE(t,e,n){return Zi&21?(vs(n,e)||(n=ET(),Nt.lanes|=n,Ji|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Zn=!0),t.memoizedState=n)}function kz(t,e){var n=rt;rt=n!==0&&4>n?n:4,t(!0);var r=q0.transition;q0.transition={};try{t(!1),e()}finally{rt=n,q0.transition=r}}function kE(){return Xr().memoizedState}function Sz(t,e,n){var r=Ko(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},SE(t))IE(e,n);else if(n=iE(t,e,n,r),n!==null){var s=Wn();hs(n,t,r,s),TE(n,e,r)}}function Iz(t,e,n){var r=Ko(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(SE(t))IE(e,s);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var i=e.lastRenderedState,a=o(i,n);if(s.hasEagerState=!0,s.eagerState=a,vs(a,i)){var l=e.interleaved;l===null?(s.next=s,Iy(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}n=iE(t,e,s,r),n!==null&&(s=Wn(),hs(n,t,r,s),TE(n,e,r))}}function SE(t){var e=t.alternate;return t===Nt||e!==null&&e===Nt}function IE(t,e){lc=gp=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function TE(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,fy(t,n)}}var vp={readContext:Kr,useCallback:kn,useContext:kn,useEffect:kn,useImperativeHandle:kn,useInsertionEffect:kn,useLayoutEffect:kn,useMemo:kn,useReducer:kn,useRef:kn,useState:kn,useDebugValue:kn,useDeferredValue:kn,useTransition:kn,useMutableSource:kn,useSyncExternalStore:kn,useId:kn,unstable_isNewReconciler:!1},Tz={readContext:Kr,useCallback:function(t,e){return Ts().memoizedState=[t,e===void 0?null:e],t},useContext:Kr,useEffect:mk,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Wh(4194308,4,xE.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Wh(4194308,4,t,e)},useInsertionEffect:function(t,e){return Wh(4,2,t,e)},useMemo:function(t,e){var n=Ts();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Ts();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=Sz.bind(null,Nt,t),[r.memoizedState,t]},useRef:function(t){var e=Ts();return t={current:t},e.memoizedState=t},useState:pk,useDebugValue:Oy,useDeferredValue:function(t){return Ts().memoizedState=t},useTransition:function(){var t=pk(!1),e=t[0];return t=kz.bind(null,t[1]),Ts().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Nt,s=Ts();if($t){if(n===void 0)throw Error(se(407));n=n()}else{if(n=e(),un===null)throw Error(se(349));Zi&30||dE(r,e,n)}s.memoizedState=n;var o={value:n,getSnapshot:e};return s.queue=o,mk(hE.bind(null,r,o,t),[t]),r.flags|=2048,Vc(9,fE.bind(null,r,o,n,e),void 0,null),n},useId:function(){var t=Ts(),e=un.identifierPrefix;if($t){var n=oo,r=so;n=(r&~(1<<32-fs(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=_c++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=Cz++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Ez={readContext:Kr,useCallback:wE,useContext:Kr,useEffect:Py,useImperativeHandle:yE,useInsertionEffect:vE,useLayoutEffect:bE,useMemo:$E,useReducer:Y0,useRef:gE,useState:function(){return Y0(zc)},useDebugValue:Oy,useDeferredValue:function(t){var e=Xr();return CE(e,Zt.memoizedState,t)},useTransition:function(){var t=Y0(zc)[0],e=Xr().memoizedState;return[t,e]},useMutableSource:uE,useSyncExternalStore:cE,useId:kE,unstable_isNewReconciler:!1},Nz={readContext:Kr,useCallback:wE,useContext:Kr,useEffect:Py,useImperativeHandle:yE,useInsertionEffect:vE,useLayoutEffect:bE,useMemo:$E,useReducer:Q0,useRef:gE,useState:function(){return Q0(zc)},useDebugValue:Oy,useDeferredValue:function(t){var e=Xr();return Zt===null?e.memoizedState=t:CE(e,Zt.memoizedState,t)},useTransition:function(){var t=Q0(zc)[0],e=Xr().memoizedState;return[t,e]},useMutableSource:uE,useSyncExternalStore:cE,useId:kE,unstable_isNewReconciler:!1};function is(t,e){if(t&&t.defaultProps){e=Rt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function gb(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Rt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Dm={isMounted:function(t){return(t=t._reactInternals)?Sa(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Wn(),s=Ko(t),o=uo(r,s);o.payload=e,n!=null&&(o.callback=n),e=Ho(t,o,s),e!==null&&(hs(e,t,s,r),Vh(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Wn(),s=Ko(t),o=uo(r,s);o.tag=1,o.payload=e,n!=null&&(o.callback=n),e=Ho(t,o,s),e!==null&&(hs(e,t,s,r),Vh(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Wn(),r=Ko(t),s=uo(n,r);s.tag=2,e!=null&&(s.callback=e),e=Ho(t,s,r),e!==null&&(hs(e,t,r,n),Vh(e,t,r))}};function gk(t,e,n,r,s,o,i){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,o,i):e.prototype&&e.prototype.isPureReactComponent?!Ac(n,r)||!Ac(s,o):!0}function EE(t,e,n){var r=!1,s=ni,o=e.contextType;return typeof o=="object"&&o!==null?o=Kr(o):(s=nr(e)?Yi:Pn.current,r=e.contextTypes,o=(r=r!=null)?Fl(t,s):ni),e=new e(n,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Dm,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=o),e}function vk(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Dm.enqueueReplaceState(e,e.state,null)}function vb(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},Ty(t);var o=e.contextType;typeof o=="object"&&o!==null?s.context=Kr(o):(o=nr(e)?Yi:Pn.current,s.context=Fl(t,o)),s.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(gb(t,e,o,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Dm.enqueueReplaceState(s,s.state,null),pp(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Ml(t,e){try{var n="",r=e;do n+=r4(r),r=r.return;while(r);var s=n}catch(o){s=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:s,digest:null}}function Z0(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function bb(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var Rz=typeof WeakMap=="function"?WeakMap:Map;function NE(t,e,n){n=uo(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){xp||(xp=!0,Eb=r),bb(t,e)},n}function RE(t,e,n){n=uo(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){bb(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){bb(t,e),typeof r!="function"&&(jo===null?jo=new Set([this]):jo.add(this));var i=e.stack;this.componentDidCatch(e.value,{componentStack:i!==null?i:""})}),n}function bk(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new Rz;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=Gz.bind(null,t,e,n),e.then(t,t))}function xk(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function yk(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=uo(-1,1),e.tag=2,Ho(n,e,1))),n.lanes|=1),t)}var Dz=yo.ReactCurrentOwner,Zn=!1;function Mn(t,e,n,r){e.child=t===null?oE(e,null,n,r):Ol(e,t.child,n,r)}function wk(t,e,n,r,s){n=n.render;var o=e.ref;return Cl(e,s),r=Ay(t,e,n,r,o,s),n=Fy(),t!==null&&!Zn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,mo(t,e,s)):($t&&n&&yy(e),e.flags|=1,Mn(t,e,r,s),e.child)}function $k(t,e,n,r,s){if(t===null){var o=n.type;return typeof o=="function"&&!Uy(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=o,DE(t,e,o,r,s)):(t=jh(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&s)){var i=o.memoizedProps;if(n=n.compare,n=n!==null?n:Ac,n(i,r)&&t.ref===e.ref)return mo(t,e,s)}return e.flags|=1,t=Xo(o,r),t.ref=e.ref,t.return=e,e.child=t}function DE(t,e,n,r,s){if(t!==null){var o=t.memoizedProps;if(Ac(o,r)&&t.ref===e.ref)if(Zn=!1,e.pendingProps=r=o,(t.lanes&s)!==0)t.flags&131072&&(Zn=!0);else return e.lanes=t.lanes,mo(t,e,s)}return xb(t,e,n,r,s)}function AE(t,e,n){var r=e.pendingProps,s=r.children,o=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ct(hl,dr),dr|=n;else{if(!(n&1073741824))return t=o!==null?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ct(hl,dr),dr|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,ct(hl,dr),dr|=r}else o!==null?(r=o.baseLanes|n,e.memoizedState=null):r=n,ct(hl,dr),dr|=r;return Mn(t,e,s,n),e.child}function FE(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function xb(t,e,n,r,s){var o=nr(n)?Yi:Pn.current;return o=Fl(e,o),Cl(e,s),n=Ay(t,e,n,r,o,s),r=Fy(),t!==null&&!Zn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,mo(t,e,s)):($t&&r&&yy(e),e.flags|=1,Mn(t,e,n,s),e.child)}function Ck(t,e,n,r,s){if(nr(n)){var o=!0;up(e)}else o=!1;if(Cl(e,s),e.stateNode===null)Uh(t,e),EE(e,n,r),vb(e,n,r,s),r=!0;else if(t===null){var i=e.stateNode,a=e.memoizedProps;i.props=a;var l=i.context,u=n.contextType;typeof u=="object"&&u!==null?u=Kr(u):(u=nr(n)?Yi:Pn.current,u=Fl(e,u));var c=n.getDerivedStateFromProps,d=typeof c=="function"||typeof i.getSnapshotBeforeUpdate=="function";d||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(a!==r||l!==u)&&vk(e,i,r,u),Do=!1;var f=e.memoizedState;i.state=f,pp(e,r,i,s),l=e.memoizedState,a!==r||f!==l||tr.current||Do?(typeof c=="function"&&(gb(e,n,c,r),l=e.memoizedState),(a=Do||gk(e,n,a,r,f,l,u))?(d||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(e.flags|=4194308)):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),i.props=r,i.state=l,i.context=u,r=a):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{i=e.stateNode,aE(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:is(e.type,a),i.props=u,d=e.pendingProps,f=i.context,l=n.contextType,typeof l=="object"&&l!==null?l=Kr(l):(l=nr(n)?Yi:Pn.current,l=Fl(e,l));var h=n.getDerivedStateFromProps;(c=typeof h=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(a!==d||f!==l)&&vk(e,i,r,l),Do=!1,f=e.memoizedState,i.state=f,pp(e,r,i,s);var p=e.memoizedState;a!==d||f!==p||tr.current||Do?(typeof h=="function"&&(gb(e,n,h,r),p=e.memoizedState),(u=Do||gk(e,n,u,r,f,p,l)||!1)?(c||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(r,p,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(r,p,l)),typeof i.componentDidUpdate=="function"&&(e.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof i.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=p),i.props=r,i.state=p,i.context=l,r=u):(typeof i.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return yb(t,e,n,r,o,s)}function yb(t,e,n,r,s,o){FE(t,e);var i=(e.flags&128)!==0;if(!r&&!i)return s&&lk(e,n,!1),mo(t,e,o);r=e.stateNode,Dz.current=e;var a=i&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&i?(e.child=Ol(e,t.child,null,o),e.child=Ol(e,null,a,o)):Mn(t,e,a,o),e.memoizedState=r.state,s&&lk(e,n,!0),e.child}function PE(t){var e=t.stateNode;e.pendingContext?ak(t,e.pendingContext,e.pendingContext!==e.context):e.context&&ak(t,e.context,!1),Ey(t,e.containerInfo)}function kk(t,e,n,r,s){return Pl(),$y(s),e.flags|=256,Mn(t,e,n,r),e.child}var wb={dehydrated:null,treeContext:null,retryLane:0};function $b(t){return{baseLanes:t,cachePool:null,transitions:null}}function OE(t,e,n){var r=e.pendingProps,s=Et.current,o=!1,i=(e.flags&128)!==0,a;if((a=i)||(a=t!==null&&t.memoizedState===null?!1:(s&2)!==0),a?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),ct(Et,s&1),t===null)return pb(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(i=r.children,t=r.fallback,o?(r=e.mode,o=e.child,i={mode:"hidden",children:i},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=i):o=Pm(i,r,0,null),t=Gi(t,r,n,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=$b(n),e.memoizedState=wb,t):Ly(e,i));if(s=t.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return Az(t,e,i,r,a,s,n);if(o){o=r.fallback,i=e.mode,s=t.child,a=s.sibling;var l={mode:"hidden",children:r.children};return!(i&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Xo(s,l),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?o=Xo(a,o):(o=Gi(o,i,n,null),o.flags|=2),o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,i=t.child.memoizedState,i=i===null?$b(n):{baseLanes:i.baseLanes|n,cachePool:null,transitions:i.transitions},o.memoizedState=i,o.childLanes=t.childLanes&~n,e.memoizedState=wb,r}return o=t.child,t=o.sibling,r=Xo(o,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Ly(t,e){return e=Pm({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function eh(t,e,n,r){return r!==null&&$y(r),Ol(e,t.child,null,n),t=Ly(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Az(t,e,n,r,s,o,i){if(n)return e.flags&256?(e.flags&=-257,r=Z0(Error(se(422))),eh(t,e,i,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=r.fallback,s=e.mode,r=Pm({mode:"visible",children:r.children},s,0,null),o=Gi(o,s,i,null),o.flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,e.mode&1&&Ol(e,t.child,null,i),e.child.memoizedState=$b(i),e.memoizedState=wb,o);if(!(e.mode&1))return eh(t,e,i,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,o=Error(se(419)),r=Z0(o,r,void 0),eh(t,e,i,r)}if(a=(i&t.childLanes)!==0,Zn||a){if(r=un,r!==null){switch(i&-i){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|i)?0:s,s!==0&&s!==o.retryLane&&(o.retryLane=s,po(t,s),hs(r,t,s,-1))}return Wy(),r=Z0(Error(se(421))),eh(t,e,i,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=Hz.bind(null,t),s._reactRetry=e,null):(t=o.treeContext,hr=Go(s.nextSibling),mr=e,$t=!0,ls=null,t!==null&&(Rr[Dr++]=so,Rr[Dr++]=oo,Rr[Dr++]=Qi,so=t.id,oo=t.overflow,Qi=e),e=Ly(e,r.children),e.flags|=4096,e)}function Sk(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),mb(t.return,e,n)}function J0(t,e,n,r,s){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=s)}function LE(t,e,n){var r=e.pendingProps,s=r.revealOrder,o=r.tail;if(Mn(t,e,r.children,n),r=Et.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Sk(t,n,e);else if(t.tag===19)Sk(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(ct(Et,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&mp(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),J0(e,!1,s,n,o);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&mp(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}J0(e,!0,n,null,o);break;case"together":J0(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Uh(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function mo(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Ji|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(se(153));if(e.child!==null){for(t=e.child,n=Xo(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Xo(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function Fz(t,e,n){switch(e.tag){case 3:PE(e),Pl();break;case 5:lE(e);break;case 1:nr(e.type)&&up(e);break;case 4:Ey(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;ct(fp,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(ct(Et,Et.current&1),e.flags|=128,null):n&e.child.childLanes?OE(t,e,n):(ct(Et,Et.current&1),t=mo(t,e,n),t!==null?t.sibling:null);ct(Et,Et.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return LE(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),ct(Et,Et.current),r)break;return null;case 22:case 23:return e.lanes=0,AE(t,e,n)}return mo(t,e,n)}var ME,Cb,_E,zE;ME=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Cb=function(){};_E=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,Pi(Ls.current);var o=null;switch(n){case"input":s=Hv(t,s),r=Hv(t,r),o=[];break;case"select":s=Rt({},s,{value:void 0}),r=Rt({},r,{value:void 0}),o=[];break;case"textarea":s=Xv(t,s),r=Xv(t,r),o=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=ap)}Yv(n,r);var i;n=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var a=s[u];for(i in a)a.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Sc.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in r){var l=r[u];if(a=s!=null?s[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(i in a)!a.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in l)l.hasOwnProperty(i)&&a[i]!==l[i]&&(n||(n={}),n[i]=l[i])}else n||(o||(o=[]),o.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(o=o||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(o=o||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Sc.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&mt("scroll",t),o||a===l||(o=[])):(o=o||[]).push(u,l))}n&&(o=o||[]).push("style",n);var u=o;(e.updateQueue=u)&&(e.flags|=4)}};zE=function(t,e,n,r){n!==r&&(e.flags|=4)};function Du(t,e){if(!$t)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Sn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function Pz(t,e,n){var r=e.pendingProps;switch(wy(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Sn(e),null;case 1:return nr(e.type)&&lp(),Sn(e),null;case 3:return r=e.stateNode,Ll(),gt(tr),gt(Pn),Ry(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Zf(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ls!==null&&(Db(ls),ls=null))),Cb(t,e),Sn(e),null;case 5:Ny(e);var s=Pi(Mc.current);if(n=e.type,t!==null&&e.stateNode!=null)_E(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(se(166));return Sn(e),null}if(t=Pi(Ls.current),Zf(e)){r=e.stateNode,n=e.type;var o=e.memoizedProps;switch(r[Fs]=e,r[Oc]=o,t=(e.mode&1)!==0,n){case"dialog":mt("cancel",r),mt("close",r);break;case"iframe":case"object":case"embed":mt("load",r);break;case"video":case"audio":for(s=0;s<Ku.length;s++)mt(Ku[s],r);break;case"source":mt("error",r);break;case"img":case"image":case"link":mt("error",r),mt("load",r);break;case"details":mt("toggle",r);break;case"input":PC(r,o),mt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},mt("invalid",r);break;case"textarea":LC(r,o),mt("invalid",r)}Yv(n,o),s=null;for(var i in o)if(o.hasOwnProperty(i)){var a=o[i];i==="children"?typeof a=="string"?r.textContent!==a&&(o.suppressHydrationWarning!==!0&&Qf(r.textContent,a,t),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(o.suppressHydrationWarning!==!0&&Qf(r.textContent,a,t),s=["children",""+a]):Sc.hasOwnProperty(i)&&a!=null&&i==="onScroll"&&mt("scroll",r)}switch(n){case"input":Uf(r),OC(r,o,!0);break;case"textarea":Uf(r),MC(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=ap)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{i=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=hT(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=i.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=i.createElement(n,{is:r.is}):(t=i.createElement(n),n==="select"&&(i=t,r.multiple?i.multiple=!0:r.size&&(i.size=r.size))):t=i.createElementNS(t,n),t[Fs]=e,t[Oc]=r,ME(t,e,!1,!1),e.stateNode=t;e:{switch(i=Qv(n,r),n){case"dialog":mt("cancel",t),mt("close",t),s=r;break;case"iframe":case"object":case"embed":mt("load",t),s=r;break;case"video":case"audio":for(s=0;s<Ku.length;s++)mt(Ku[s],t);s=r;break;case"source":mt("error",t),s=r;break;case"img":case"image":case"link":mt("error",t),mt("load",t),s=r;break;case"details":mt("toggle",t),s=r;break;case"input":PC(t,r),s=Hv(t,r),mt("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Rt({},r,{value:void 0}),mt("invalid",t);break;case"textarea":LC(t,r),s=Xv(t,r),mt("invalid",t);break;default:s=r}Yv(n,s),a=s;for(o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="style"?gT(t,l):o==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&pT(t,l)):o==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Ic(t,l):typeof l=="number"&&Ic(t,""+l):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(Sc.hasOwnProperty(o)?l!=null&&o==="onScroll"&&mt("scroll",t):l!=null&&iy(t,o,l,i))}switch(n){case"input":Uf(t),OC(t,r,!1);break;case"textarea":Uf(t),MC(t);break;case"option":r.value!=null&&t.setAttribute("value",""+ti(r.value));break;case"select":t.multiple=!!r.multiple,o=r.value,o!=null?xl(t,!!r.multiple,o,!1):r.defaultValue!=null&&xl(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=ap)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Sn(e),null;case 6:if(t&&e.stateNode!=null)zE(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(se(166));if(n=Pi(Mc.current),Pi(Ls.current),Zf(e)){if(r=e.stateNode,n=e.memoizedProps,r[Fs]=e,(o=r.nodeValue!==n)&&(t=mr,t!==null))switch(t.tag){case 3:Qf(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Qf(r.nodeValue,n,(t.mode&1)!==0)}o&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Fs]=e,e.stateNode=r}return Sn(e),null;case 13:if(gt(Et),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if($t&&hr!==null&&e.mode&1&&!(e.flags&128))rE(),Pl(),e.flags|=98560,o=!1;else if(o=Zf(e),r!==null&&r.dehydrated!==null){if(t===null){if(!o)throw Error(se(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(se(317));o[Fs]=e}else Pl(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Sn(e),o=!1}else ls!==null&&(Db(ls),ls=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Et.current&1?en===0&&(en=3):Wy())),e.updateQueue!==null&&(e.flags|=4),Sn(e),null);case 4:return Ll(),Cb(t,e),t===null&&Fc(e.stateNode.containerInfo),Sn(e),null;case 10:return Sy(e.type._context),Sn(e),null;case 17:return nr(e.type)&&lp(),Sn(e),null;case 19:if(gt(Et),o=e.memoizedState,o===null)return Sn(e),null;if(r=(e.flags&128)!==0,i=o.rendering,i===null)if(r)Du(o,!1);else{if(en!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(i=mp(t),i!==null){for(e.flags|=128,Du(o,!1),r=i.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)o=n,t=r,o.flags&=14680066,i=o.alternate,i===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=i.childLanes,o.lanes=i.lanes,o.child=i.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=i.memoizedProps,o.memoizedState=i.memoizedState,o.updateQueue=i.updateQueue,o.type=i.type,t=i.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return ct(Et,Et.current&1|2),e.child}t=t.sibling}o.tail!==null&&_t()>_l&&(e.flags|=128,r=!0,Du(o,!1),e.lanes=4194304)}else{if(!r)if(t=mp(i),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Du(o,!0),o.tail===null&&o.tailMode==="hidden"&&!i.alternate&&!$t)return Sn(e),null}else 2*_t()-o.renderingStartTime>_l&&n!==1073741824&&(e.flags|=128,r=!0,Du(o,!1),e.lanes=4194304);o.isBackwards?(i.sibling=e.child,e.child=i):(n=o.last,n!==null?n.sibling=i:e.child=i,o.last=i)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=_t(),e.sibling=null,n=Et.current,ct(Et,r?n&1|2:n&1),e):(Sn(e),null);case 22:case 23:return By(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?dr&1073741824&&(Sn(e),e.subtreeFlags&6&&(e.flags|=8192)):Sn(e),null;case 24:return null;case 25:return null}throw Error(se(156,e.tag))}function Oz(t,e){switch(wy(e),e.tag){case 1:return nr(e.type)&&lp(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Ll(),gt(tr),gt(Pn),Ry(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Ny(e),null;case 13:if(gt(Et),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(se(340));Pl()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return gt(Et),null;case 4:return Ll(),null;case 10:return Sy(e.type._context),null;case 22:case 23:return By(),null;case 24:return null;default:return null}}var th=!1,Nn=!1,Lz=typeof WeakSet=="function"?WeakSet:Set,de=null;function fl(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Dt(t,e,r)}else n.current=null}function kb(t,e,n){try{n()}catch(r){Dt(t,e,r)}}var Ik=!1;function Mz(t,e){if(ab=sp,t=GT(),xy(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var i=0,a=-1,l=-1,u=0,c=0,d=t,f=null;t:for(;;){for(var h;d!==n||s!==0&&d.nodeType!==3||(a=i+s),d!==o||r!==0&&d.nodeType!==3||(l=i+r),d.nodeType===3&&(i+=d.nodeValue.length),(h=d.firstChild)!==null;)f=d,d=h;for(;;){if(d===t)break t;if(f===n&&++u===s&&(a=i),f===o&&++c===r&&(l=i),(h=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=h}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(lb={focusedElem:t,selectionRange:n},sp=!1,de=e;de!==null;)if(e=de,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,de=t;else for(;de!==null;){e=de;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var g=p.memoizedProps,v=p.memoizedState,m=e.stateNode,b=m.getSnapshotBeforeUpdate(e.elementType===e.type?g:is(e.type,g),v);m.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var x=e.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(se(163))}}catch(y){Dt(e,e.return,y)}if(t=e.sibling,t!==null){t.return=e.return,de=t;break}de=e.return}return p=Ik,Ik=!1,p}function uc(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var o=s.destroy;s.destroy=void 0,o!==void 0&&kb(e,n,o)}s=s.next}while(s!==r)}}function Am(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Sb(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function VE(t){var e=t.alternate;e!==null&&(t.alternate=null,VE(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Fs],delete e[Oc],delete e[db],delete e[xz],delete e[yz])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function BE(t){return t.tag===5||t.tag===3||t.tag===4}function Tk(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||BE(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Ib(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=ap));else if(r!==4&&(t=t.child,t!==null))for(Ib(t,e,n),t=t.sibling;t!==null;)Ib(t,e,n),t=t.sibling}function Tb(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Tb(t,e,n),t=t.sibling;t!==null;)Tb(t,e,n),t=t.sibling}var mn=null,as=!1;function To(t,e,n){for(n=n.child;n!==null;)WE(t,e,n),n=n.sibling}function WE(t,e,n){if(Os&&typeof Os.onCommitFiberUnmount=="function")try{Os.onCommitFiberUnmount(km,n)}catch{}switch(n.tag){case 5:Nn||fl(n,e);case 6:var r=mn,s=as;mn=null,To(t,e,n),mn=r,as=s,mn!==null&&(as?(t=mn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):mn.removeChild(n.stateNode));break;case 18:mn!==null&&(as?(t=mn,n=n.stateNode,t.nodeType===8?j0(t.parentNode,n):t.nodeType===1&&j0(t,n),Rc(t)):j0(mn,n.stateNode));break;case 4:r=mn,s=as,mn=n.stateNode.containerInfo,as=!0,To(t,e,n),mn=r,as=s;break;case 0:case 11:case 14:case 15:if(!Nn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var o=s,i=o.destroy;o=o.tag,i!==void 0&&(o&2||o&4)&&kb(n,e,i),s=s.next}while(s!==r)}To(t,e,n);break;case 1:if(!Nn&&(fl(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Dt(n,e,a)}To(t,e,n);break;case 21:To(t,e,n);break;case 22:n.mode&1?(Nn=(r=Nn)||n.memoizedState!==null,To(t,e,n),Nn=r):To(t,e,n);break;default:To(t,e,n)}}function Ek(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new Lz),e.forEach(function(r){var s=jz.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function ns(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var o=t,i=e,a=i;e:for(;a!==null;){switch(a.tag){case 5:mn=a.stateNode,as=!1;break e;case 3:mn=a.stateNode.containerInfo,as=!0;break e;case 4:mn=a.stateNode.containerInfo,as=!0;break e}a=a.return}if(mn===null)throw Error(se(160));WE(o,i,s),mn=null,as=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(u){Dt(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)UE(e,t),e=e.sibling}function UE(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ns(e,t),Is(t),r&4){try{uc(3,t,t.return),Am(3,t)}catch(g){Dt(t,t.return,g)}try{uc(5,t,t.return)}catch(g){Dt(t,t.return,g)}}break;case 1:ns(e,t),Is(t),r&512&&n!==null&&fl(n,n.return);break;case 5:if(ns(e,t),Is(t),r&512&&n!==null&&fl(n,n.return),t.flags&32){var s=t.stateNode;try{Ic(s,"")}catch(g){Dt(t,t.return,g)}}if(r&4&&(s=t.stateNode,s!=null)){var o=t.memoizedProps,i=n!==null?n.memoizedProps:o,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&o.type==="radio"&&o.name!=null&&dT(s,o),Qv(a,i);var u=Qv(a,o);for(i=0;i<l.length;i+=2){var c=l[i],d=l[i+1];c==="style"?gT(s,d):c==="dangerouslySetInnerHTML"?pT(s,d):c==="children"?Ic(s,d):iy(s,c,d,u)}switch(a){case"input":jv(s,o);break;case"textarea":fT(s,o);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!o.multiple;var h=o.value;h!=null?xl(s,!!o.multiple,h,!1):f!==!!o.multiple&&(o.defaultValue!=null?xl(s,!!o.multiple,o.defaultValue,!0):xl(s,!!o.multiple,o.multiple?[]:"",!1))}s[Oc]=o}catch(g){Dt(t,t.return,g)}}break;case 6:if(ns(e,t),Is(t),r&4){if(t.stateNode===null)throw Error(se(162));s=t.stateNode,o=t.memoizedProps;try{s.nodeValue=o}catch(g){Dt(t,t.return,g)}}break;case 3:if(ns(e,t),Is(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Rc(e.containerInfo)}catch(g){Dt(t,t.return,g)}break;case 4:ns(e,t),Is(t);break;case 13:ns(e,t),Is(t),s=t.child,s.flags&8192&&(o=s.memoizedState!==null,s.stateNode.isHidden=o,!o||s.alternate!==null&&s.alternate.memoizedState!==null||(zy=_t())),r&4&&Ek(t);break;case 22:if(c=n!==null&&n.memoizedState!==null,t.mode&1?(Nn=(u=Nn)||c,ns(e,t),Nn=u):ns(e,t),Is(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!c&&t.mode&1)for(de=t,c=t.child;c!==null;){for(d=de=c;de!==null;){switch(f=de,h=f.child,f.tag){case 0:case 11:case 14:case 15:uc(4,f,f.return);break;case 1:fl(f,f.return);var p=f.stateNode;if(typeof p.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(g){Dt(r,n,g)}}break;case 5:fl(f,f.return);break;case 22:if(f.memoizedState!==null){Rk(d);continue}}h!==null?(h.return=f,de=h):Rk(d)}c=c.sibling}e:for(c=null,d=t;;){if(d.tag===5){if(c===null){c=d;try{s=d.stateNode,u?(o=s.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(a=d.stateNode,l=d.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=mT("display",i))}catch(g){Dt(t,t.return,g)}}}else if(d.tag===6){if(c===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(g){Dt(t,t.return,g)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;c===d&&(c=null),d=d.return}c===d&&(c=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:ns(e,t),Is(t),r&4&&Ek(t);break;case 21:break;default:ns(e,t),Is(t)}}function Is(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(BE(n)){var r=n;break e}n=n.return}throw Error(se(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Ic(s,""),r.flags&=-33);var o=Tk(t);Tb(t,o,s);break;case 3:case 4:var i=r.stateNode.containerInfo,a=Tk(t);Ib(t,a,i);break;default:throw Error(se(161))}}catch(l){Dt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function _z(t,e,n){de=t,GE(t)}function GE(t,e,n){for(var r=(t.mode&1)!==0;de!==null;){var s=de,o=s.child;if(s.tag===22&&r){var i=s.memoizedState!==null||th;if(!i){var a=s.alternate,l=a!==null&&a.memoizedState!==null||Nn;a=th;var u=Nn;if(th=i,(Nn=l)&&!u)for(de=s;de!==null;)i=de,l=i.child,i.tag===22&&i.memoizedState!==null?Dk(s):l!==null?(l.return=i,de=l):Dk(s);for(;o!==null;)de=o,GE(o),o=o.sibling;de=s,th=a,Nn=u}Nk(t)}else s.subtreeFlags&8772&&o!==null?(o.return=s,de=o):Nk(t)}}function Nk(t){for(;de!==null;){var e=de;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Nn||Am(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Nn)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:is(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&hk(e,o,r);break;case 3:var i=e.updateQueue;if(i!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}hk(e,i,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var d=c.dehydrated;d!==null&&Rc(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(se(163))}Nn||e.flags&512&&Sb(e)}catch(f){Dt(e,e.return,f)}}if(e===t){de=null;break}if(n=e.sibling,n!==null){n.return=e.return,de=n;break}de=e.return}}function Rk(t){for(;de!==null;){var e=de;if(e===t){de=null;break}var n=e.sibling;if(n!==null){n.return=e.return,de=n;break}de=e.return}}function Dk(t){for(;de!==null;){var e=de;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Am(4,e)}catch(l){Dt(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(l){Dt(e,s,l)}}var o=e.return;try{Sb(e)}catch(l){Dt(e,o,l)}break;case 5:var i=e.return;try{Sb(e)}catch(l){Dt(e,i,l)}}}catch(l){Dt(e,e.return,l)}if(e===t){de=null;break}var a=e.sibling;if(a!==null){a.return=e.return,de=a;break}de=e.return}}var zz=Math.ceil,bp=yo.ReactCurrentDispatcher,My=yo.ReactCurrentOwner,jr=yo.ReactCurrentBatchConfig,He=0,un=null,Ht=null,gn=0,dr=0,hl=ci(0),en=0,Bc=null,Ji=0,Fm=0,_y=0,cc=null,Yn=null,zy=0,_l=1/0,Js=null,xp=!1,Eb=null,jo=null,nh=!1,Lo=null,yp=0,dc=0,Nb=null,Gh=-1,Hh=0;function Wn(){return He&6?_t():Gh!==-1?Gh:Gh=_t()}function Ko(t){return t.mode&1?He&2&&gn!==0?gn&-gn:$z.transition!==null?(Hh===0&&(Hh=ET()),Hh):(t=rt,t!==0||(t=window.event,t=t===void 0?16:OT(t.type)),t):1}function hs(t,e,n,r){if(50<dc)throw dc=0,Nb=null,Error(se(185));ad(t,n,r),(!(He&2)||t!==un)&&(t===un&&(!(He&2)&&(Fm|=n),en===4&&Po(t,gn)),rr(t,r),n===1&&He===0&&!(e.mode&1)&&(_l=_t()+500,Nm&&di()))}function rr(t,e){var n=t.callbackNode;$4(t,e);var r=rp(t,t===un?gn:0);if(r===0)n!==null&&VC(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&VC(n),e===1)t.tag===0?wz(Ak.bind(null,t)):eE(Ak.bind(null,t)),vz(function(){!(He&6)&&di()}),n=null;else{switch(NT(r)){case 1:n=dy;break;case 4:n=IT;break;case 16:n=np;break;case 536870912:n=TT;break;default:n=np}n=ZE(n,HE.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function HE(t,e){if(Gh=-1,Hh=0,He&6)throw Error(se(327));var n=t.callbackNode;if(kl()&&t.callbackNode!==n)return null;var r=rp(t,t===un?gn:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=wp(t,r);else{e=r;var s=He;He|=2;var o=KE();(un!==t||gn!==e)&&(Js=null,_l=_t()+500,Ui(t,e));do try{Wz();break}catch(a){jE(t,a)}while(!0);ky(),bp.current=o,He=s,Ht!==null?e=0:(un=null,gn=0,e=en)}if(e!==0){if(e===2&&(s=nb(t),s!==0&&(r=s,e=Rb(t,s))),e===1)throw n=Bc,Ui(t,0),Po(t,r),rr(t,_t()),n;if(e===6)Po(t,r);else{if(s=t.current.alternate,!(r&30)&&!Vz(s)&&(e=wp(t,r),e===2&&(o=nb(t),o!==0&&(r=o,e=Rb(t,o))),e===1))throw n=Bc,Ui(t,0),Po(t,r),rr(t,_t()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(se(345));case 2:Ii(t,Yn,Js);break;case 3:if(Po(t,r),(r&130023424)===r&&(e=zy+500-_t(),10<e)){if(rp(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Wn(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=cb(Ii.bind(null,t,Yn,Js),e);break}Ii(t,Yn,Js);break;case 4:if(Po(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var i=31-fs(r);o=1<<i,i=e[i],i>s&&(s=i),r&=~o}if(r=s,r=_t()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*zz(r/1960))-r,10<r){t.timeoutHandle=cb(Ii.bind(null,t,Yn,Js),r);break}Ii(t,Yn,Js);break;case 5:Ii(t,Yn,Js);break;default:throw Error(se(329))}}}return rr(t,_t()),t.callbackNode===n?HE.bind(null,t):null}function Rb(t,e){var n=cc;return t.current.memoizedState.isDehydrated&&(Ui(t,e).flags|=256),t=wp(t,e),t!==2&&(e=Yn,Yn=n,e!==null&&Db(e)),t}function Db(t){Yn===null?Yn=t:Yn.push.apply(Yn,t)}function Vz(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],o=s.getSnapshot;s=s.value;try{if(!vs(o(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Po(t,e){for(e&=~_y,e&=~Fm,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-fs(e),r=1<<n;t[n]=-1,e&=~r}}function Ak(t){if(He&6)throw Error(se(327));kl();var e=rp(t,0);if(!(e&1))return rr(t,_t()),null;var n=wp(t,e);if(t.tag!==0&&n===2){var r=nb(t);r!==0&&(e=r,n=Rb(t,r))}if(n===1)throw n=Bc,Ui(t,0),Po(t,e),rr(t,_t()),n;if(n===6)throw Error(se(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ii(t,Yn,Js),rr(t,_t()),null}function Vy(t,e){var n=He;He|=1;try{return t(e)}finally{He=n,He===0&&(_l=_t()+500,Nm&&di())}}function ea(t){Lo!==null&&Lo.tag===0&&!(He&6)&&kl();var e=He;He|=1;var n=jr.transition,r=rt;try{if(jr.transition=null,rt=1,t)return t()}finally{rt=r,jr.transition=n,He=e,!(He&6)&&di()}}function By(){dr=hl.current,gt(hl)}function Ui(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,gz(n)),Ht!==null)for(n=Ht.return;n!==null;){var r=n;switch(wy(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&lp();break;case 3:Ll(),gt(tr),gt(Pn),Ry();break;case 5:Ny(r);break;case 4:Ll();break;case 13:gt(Et);break;case 19:gt(Et);break;case 10:Sy(r.type._context);break;case 22:case 23:By()}n=n.return}if(un=t,Ht=t=Xo(t.current,null),gn=dr=e,en=0,Bc=null,_y=Fm=Ji=0,Yn=cc=null,Fi!==null){for(e=0;e<Fi.length;e++)if(n=Fi[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,o=n.pending;if(o!==null){var i=o.next;o.next=s,r.next=i}n.pending=r}Fi=null}return t}function jE(t,e){do{var n=Ht;try{if(ky(),Bh.current=vp,gp){for(var r=Nt.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}gp=!1}if(Zi=0,an=Zt=Nt=null,lc=!1,_c=0,My.current=null,n===null||n.return===null){en=1,Bc=e,Ht=null;break}e:{var o=t,i=n.return,a=n,l=e;if(e=gn,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=a,d=c.tag;if(!(c.mode&1)&&(d===0||d===11||d===15)){var f=c.alternate;f?(c.updateQueue=f.updateQueue,c.memoizedState=f.memoizedState,c.lanes=f.lanes):(c.updateQueue=null,c.memoizedState=null)}var h=xk(i);if(h!==null){h.flags&=-257,yk(h,i,a,o,e),h.mode&1&&bk(o,u,e),e=h,l=u;var p=e.updateQueue;if(p===null){var g=new Set;g.add(l),e.updateQueue=g}else p.add(l);break e}else{if(!(e&1)){bk(o,u,e),Wy();break e}l=Error(se(426))}}else if($t&&a.mode&1){var v=xk(i);if(v!==null){!(v.flags&65536)&&(v.flags|=256),yk(v,i,a,o,e),$y(Ml(l,a));break e}}o=l=Ml(l,a),en!==4&&(en=2),cc===null?cc=[o]:cc.push(o),o=i;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var m=NE(o,l,e);fk(o,m);break e;case 1:a=l;var b=o.type,x=o.stateNode;if(!(o.flags&128)&&(typeof b.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(jo===null||!jo.has(x)))){o.flags|=65536,e&=-e,o.lanes|=e;var y=RE(o,a,e);fk(o,y);break e}}o=o.return}while(o!==null)}qE(n)}catch($){e=$,Ht===n&&n!==null&&(Ht=n=n.return);continue}break}while(!0)}function KE(){var t=bp.current;return bp.current=vp,t===null?vp:t}function Wy(){(en===0||en===3||en===2)&&(en=4),un===null||!(Ji&268435455)&&!(Fm&268435455)||Po(un,gn)}function wp(t,e){var n=He;He|=2;var r=KE();(un!==t||gn!==e)&&(Js=null,Ui(t,e));do try{Bz();break}catch(s){jE(t,s)}while(!0);if(ky(),He=n,bp.current=r,Ht!==null)throw Error(se(261));return un=null,gn=0,en}function Bz(){for(;Ht!==null;)XE(Ht)}function Wz(){for(;Ht!==null&&!h4();)XE(Ht)}function XE(t){var e=QE(t.alternate,t,dr);t.memoizedProps=t.pendingProps,e===null?qE(t):Ht=e,My.current=null}function qE(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=Oz(n,e),n!==null){n.flags&=32767,Ht=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{en=6,Ht=null;return}}else if(n=Pz(n,e,dr),n!==null){Ht=n;return}if(e=e.sibling,e!==null){Ht=e;return}Ht=e=t}while(e!==null);en===0&&(en=5)}function Ii(t,e,n){var r=rt,s=jr.transition;try{jr.transition=null,rt=1,Uz(t,e,n,r)}finally{jr.transition=s,rt=r}return null}function Uz(t,e,n,r){do kl();while(Lo!==null);if(He&6)throw Error(se(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(se(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if(C4(t,o),t===un&&(Ht=un=null,gn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||nh||(nh=!0,ZE(np,function(){return kl(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=jr.transition,jr.transition=null;var i=rt;rt=1;var a=He;He|=4,My.current=null,Mz(t,n),UE(n,t),uz(lb),sp=!!ab,lb=ab=null,t.current=n,_z(n),p4(),He=a,rt=i,jr.transition=o}else t.current=n;if(nh&&(nh=!1,Lo=t,yp=s),o=t.pendingLanes,o===0&&(jo=null),v4(n.stateNode),rr(t,_t()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(xp)throw xp=!1,t=Eb,Eb=null,t;return yp&1&&t.tag!==0&&kl(),o=t.pendingLanes,o&1?t===Nb?dc++:(dc=0,Nb=t):dc=0,di(),null}function kl(){if(Lo!==null){var t=NT(yp),e=jr.transition,n=rt;try{if(jr.transition=null,rt=16>t?16:t,Lo===null)var r=!1;else{if(t=Lo,Lo=null,yp=0,He&6)throw Error(se(331));var s=He;for(He|=4,de=t.current;de!==null;){var o=de,i=o.child;if(de.flags&16){var a=o.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(de=u;de!==null;){var c=de;switch(c.tag){case 0:case 11:case 15:uc(8,c,o)}var d=c.child;if(d!==null)d.return=c,de=d;else for(;de!==null;){c=de;var f=c.sibling,h=c.return;if(VE(c),c===u){de=null;break}if(f!==null){f.return=h,de=f;break}de=h}}}var p=o.alternate;if(p!==null){var g=p.child;if(g!==null){p.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(g!==null)}}de=o}}if(o.subtreeFlags&2064&&i!==null)i.return=o,de=i;else e:for(;de!==null;){if(o=de,o.flags&2048)switch(o.tag){case 0:case 11:case 15:uc(9,o,o.return)}var m=o.sibling;if(m!==null){m.return=o.return,de=m;break e}de=o.return}}var b=t.current;for(de=b;de!==null;){i=de;var x=i.child;if(i.subtreeFlags&2064&&x!==null)x.return=i,de=x;else e:for(i=b;de!==null;){if(a=de,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Am(9,a)}}catch($){Dt(a,a.return,$)}if(a===i){de=null;break e}var y=a.sibling;if(y!==null){y.return=a.return,de=y;break e}de=a.return}}if(He=s,di(),Os&&typeof Os.onPostCommitFiberRoot=="function")try{Os.onPostCommitFiberRoot(km,t)}catch{}r=!0}return r}finally{rt=n,jr.transition=e}}return!1}function Fk(t,e,n){e=Ml(n,e),e=NE(t,e,1),t=Ho(t,e,1),e=Wn(),t!==null&&(ad(t,1,e),rr(t,e))}function Dt(t,e,n){if(t.tag===3)Fk(t,t,n);else for(;e!==null;){if(e.tag===3){Fk(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(jo===null||!jo.has(r))){t=Ml(n,t),t=RE(e,t,1),e=Ho(e,t,1),t=Wn(),e!==null&&(ad(e,1,t),rr(e,t));break}}e=e.return}}function Gz(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Wn(),t.pingedLanes|=t.suspendedLanes&n,un===t&&(gn&n)===n&&(en===4||en===3&&(gn&130023424)===gn&&500>_t()-zy?Ui(t,0):_y|=n),rr(t,e)}function YE(t,e){e===0&&(t.mode&1?(e=jf,jf<<=1,!(jf&130023424)&&(jf=4194304)):e=1);var n=Wn();t=po(t,e),t!==null&&(ad(t,e,n),rr(t,n))}function Hz(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),YE(t,n)}function jz(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(se(314))}r!==null&&r.delete(e),YE(t,n)}var QE;QE=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||tr.current)Zn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Zn=!1,Fz(t,e,n);Zn=!!(t.flags&131072)}else Zn=!1,$t&&e.flags&1048576&&tE(e,dp,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Uh(t,e),t=e.pendingProps;var s=Fl(e,Pn.current);Cl(e,n),s=Ay(null,e,r,t,s,n);var o=Fy();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,nr(r)?(o=!0,up(e)):o=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Ty(e),s.updater=Dm,e.stateNode=s,s._reactInternals=e,vb(e,r,t,n),e=yb(null,e,r,!0,o,n)):(e.tag=0,$t&&o&&yy(e),Mn(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Uh(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=Xz(r),t=is(r,t),s){case 0:e=xb(null,e,r,t,n);break e;case 1:e=Ck(null,e,r,t,n);break e;case 11:e=wk(null,e,r,t,n);break e;case 14:e=$k(null,e,r,is(r.type,t),n);break e}throw Error(se(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:is(r,s),xb(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:is(r,s),Ck(t,e,r,s,n);case 3:e:{if(PE(e),t===null)throw Error(se(387));r=e.pendingProps,o=e.memoizedState,s=o.element,aE(t,e),pp(e,r,null,n);var i=e.memoizedState;if(r=i.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){s=Ml(Error(se(423)),e),e=kk(t,e,r,n,s);break e}else if(r!==s){s=Ml(Error(se(424)),e),e=kk(t,e,r,n,s);break e}else for(hr=Go(e.stateNode.containerInfo.firstChild),mr=e,$t=!0,ls=null,n=oE(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Pl(),r===s){e=mo(t,e,n);break e}Mn(t,e,r,n)}e=e.child}return e;case 5:return lE(e),t===null&&pb(e),r=e.type,s=e.pendingProps,o=t!==null?t.memoizedProps:null,i=s.children,ub(r,s)?i=null:o!==null&&ub(r,o)&&(e.flags|=32),FE(t,e),Mn(t,e,i,n),e.child;case 6:return t===null&&pb(e),null;case 13:return OE(t,e,n);case 4:return Ey(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Ol(e,null,r,n):Mn(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:is(r,s),wk(t,e,r,s,n);case 7:return Mn(t,e,e.pendingProps,n),e.child;case 8:return Mn(t,e,e.pendingProps.children,n),e.child;case 12:return Mn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,o=e.memoizedProps,i=s.value,ct(fp,r._currentValue),r._currentValue=i,o!==null)if(vs(o.value,i)){if(o.children===s.children&&!tr.current){e=mo(t,e,n);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var a=o.dependencies;if(a!==null){i=o.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(o.tag===1){l=uo(-1,n&-n),l.tag=2;var u=o.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),mb(o.return,n,e),a.lanes|=n;break}l=l.next}}else if(o.tag===10)i=o.type===e.type?null:o.child;else if(o.tag===18){if(i=o.return,i===null)throw Error(se(341));i.lanes|=n,a=i.alternate,a!==null&&(a.lanes|=n),mb(i,n,e),i=o.sibling}else i=o.child;if(i!==null)i.return=o;else for(i=o;i!==null;){if(i===e){i=null;break}if(o=i.sibling,o!==null){o.return=i.return,i=o;break}i=i.return}o=i}Mn(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Cl(e,n),s=Kr(s),r=r(s),e.flags|=1,Mn(t,e,r,n),e.child;case 14:return r=e.type,s=is(r,e.pendingProps),s=is(r.type,s),$k(t,e,r,s,n);case 15:return DE(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:is(r,s),Uh(t,e),e.tag=1,nr(r)?(t=!0,up(e)):t=!1,Cl(e,n),EE(e,r,s),vb(e,r,s,n),yb(null,e,r,!0,t,n);case 19:return LE(t,e,n);case 22:return AE(t,e,n)}throw Error(se(156,e.tag))};function ZE(t,e){return ST(t,e)}function Kz(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Vr(t,e,n,r){return new Kz(t,e,n,r)}function Uy(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Xz(t){if(typeof t=="function")return Uy(t)?1:0;if(t!=null){if(t=t.$$typeof,t===ly)return 11;if(t===uy)return 14}return 2}function Xo(t,e){var n=t.alternate;return n===null?(n=Vr(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function jh(t,e,n,r,s,o){var i=2;if(r=t,typeof t=="function")Uy(t)&&(i=1);else if(typeof t=="string")i=5;else e:switch(t){case rl:return Gi(n.children,s,o,e);case ay:i=8,s|=8;break;case Bv:return t=Vr(12,n,e,s|2),t.elementType=Bv,t.lanes=o,t;case Wv:return t=Vr(13,n,e,s),t.elementType=Wv,t.lanes=o,t;case Uv:return t=Vr(19,n,e,s),t.elementType=Uv,t.lanes=o,t;case lT:return Pm(n,s,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case iT:i=10;break e;case aT:i=9;break e;case ly:i=11;break e;case uy:i=14;break e;case Ro:i=16,r=null;break e}throw Error(se(130,t==null?t:typeof t,""))}return e=Vr(i,n,e,s),e.elementType=t,e.type=r,e.lanes=o,e}function Gi(t,e,n,r){return t=Vr(7,t,r,e),t.lanes=n,t}function Pm(t,e,n,r){return t=Vr(22,t,r,e),t.elementType=lT,t.lanes=n,t.stateNode={isHidden:!1},t}function ev(t,e,n){return t=Vr(6,t,null,e),t.lanes=n,t}function tv(t,e,n){return e=Vr(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function qz(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=O0(0),this.expirationTimes=O0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=O0(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Gy(t,e,n,r,s,o,i,a,l){return t=new qz(t,e,n,a,l),e===1?(e=1,o===!0&&(e|=8)):e=0,o=Vr(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ty(o),t}function Yz(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:nl,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function JE(t){if(!t)return ni;t=t._reactInternals;e:{if(Sa(t)!==t||t.tag!==1)throw Error(se(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(nr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(se(171))}if(t.tag===1){var n=t.type;if(nr(n))return JT(t,n,e)}return e}function eN(t,e,n,r,s,o,i,a,l){return t=Gy(n,r,!0,t,s,o,i,a,l),t.context=JE(null),n=t.current,r=Wn(),s=Ko(n),o=uo(r,s),o.callback=e??null,Ho(n,o,s),t.current.lanes=s,ad(t,s,r),rr(t,r),t}function Om(t,e,n,r){var s=e.current,o=Wn(),i=Ko(s);return n=JE(n),e.context===null?e.context=n:e.pendingContext=n,e=uo(o,i),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Ho(s,e,i),t!==null&&(hs(t,s,i,o),Vh(t,s,i)),i}function $p(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Pk(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Hy(t,e){Pk(t,e),(t=t.alternate)&&Pk(t,e)}function Qz(){return null}var tN=typeof reportError=="function"?reportError:function(t){console.error(t)};function jy(t){this._internalRoot=t}Lm.prototype.render=jy.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(se(409));Om(t,e,null,null)};Lm.prototype.unmount=jy.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;ea(function(){Om(null,t,null,null)}),e[ho]=null}};function Lm(t){this._internalRoot=t}Lm.prototype.unstable_scheduleHydration=function(t){if(t){var e=AT();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Fo.length&&e!==0&&e<Fo[n].priority;n++);Fo.splice(n,0,t),n===0&&PT(t)}};function Ky(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Mm(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Ok(){}function Zz(t,e,n,r,s){if(s){if(typeof r=="function"){var o=r;r=function(){var u=$p(i);o.call(u)}}var i=eN(e,r,t,0,null,!1,!1,"",Ok);return t._reactRootContainer=i,t[ho]=i.current,Fc(t.nodeType===8?t.parentNode:t),ea(),i}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var u=$p(l);a.call(u)}}var l=Gy(t,0,!1,null,null,!1,!1,"",Ok);return t._reactRootContainer=l,t[ho]=l.current,Fc(t.nodeType===8?t.parentNode:t),ea(function(){Om(e,l,n,r)}),l}function _m(t,e,n,r,s){var o=n._reactRootContainer;if(o){var i=o;if(typeof s=="function"){var a=s;s=function(){var l=$p(i);a.call(l)}}Om(e,i,t,s)}else i=Zz(n,e,t,s,r);return $p(i)}RT=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=ju(e.pendingLanes);n!==0&&(fy(e,n|1),rr(e,_t()),!(He&6)&&(_l=_t()+500,di()))}break;case 13:ea(function(){var r=po(t,1);if(r!==null){var s=Wn();hs(r,t,1,s)}}),Hy(t,1)}};hy=function(t){if(t.tag===13){var e=po(t,134217728);if(e!==null){var n=Wn();hs(e,t,134217728,n)}Hy(t,134217728)}};DT=function(t){if(t.tag===13){var e=Ko(t),n=po(t,e);if(n!==null){var r=Wn();hs(n,t,e,r)}Hy(t,e)}};AT=function(){return rt};FT=function(t,e){var n=rt;try{return rt=t,e()}finally{rt=n}};Jv=function(t,e,n){switch(e){case"input":if(jv(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Em(r);if(!s)throw Error(se(90));cT(r),jv(r,s)}}}break;case"textarea":fT(t,n);break;case"select":e=n.value,e!=null&&xl(t,!!n.multiple,e,!1)}};xT=Vy;yT=ea;var Jz={usingClientEntryPoint:!1,Events:[ud,al,Em,vT,bT,Vy]},Au={findFiberByHostInstance:Ai,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},eV={bundleType:Au.bundleType,version:Au.version,rendererPackageName:Au.rendererPackageName,rendererConfig:Au.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:yo.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=CT(t),t===null?null:t.stateNode},findFiberByHostInstance:Au.findFiberByHostInstance||Qz,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var rh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!rh.isDisabled&&rh.supportsFiber)try{km=rh.inject(eV),Os=rh}catch{}}xr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Jz;xr.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ky(e))throw Error(se(200));return Yz(t,e,null,n)};xr.createRoot=function(t,e){if(!Ky(t))throw Error(se(299));var n=!1,r="",s=tN;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Gy(t,1,!1,null,null,n,!1,r,s),t[ho]=e.current,Fc(t.nodeType===8?t.parentNode:t),new jy(e)};xr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(se(188)):(t=Object.keys(t).join(","),Error(se(268,t)));return t=CT(e),t=t===null?null:t.stateNode,t};xr.flushSync=function(t){return ea(t)};xr.hydrate=function(t,e,n){if(!Mm(e))throw Error(se(200));return _m(null,t,e,!0,n)};xr.hydrateRoot=function(t,e,n){if(!Ky(t))throw Error(se(405));var r=n!=null&&n.hydratedSources||null,s=!1,o="",i=tN;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(i=n.onRecoverableError)),e=eN(e,null,t,1,n??null,s,!1,o,i),t[ho]=e.current,Fc(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Lm(e)};xr.render=function(t,e,n){if(!Mm(e))throw Error(se(200));return _m(null,t,e,!1,n)};xr.unmountComponentAtNode=function(t){if(!Mm(t))throw Error(se(40));return t._reactRootContainer?(ea(function(){_m(null,null,t,!1,function(){t._reactRootContainer=null,t[ho]=null})}),!0):!1};xr.unstable_batchedUpdates=Vy;xr.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Mm(n))throw Error(se(200));if(t==null||t._reactInternals===void 0)throw Error(se(38));return _m(t,e,n,!1,r)};xr.version="18.3.1-next-f1338f8080-20240426";function nN(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(nN)}catch(t){console.error(t)}}nN(),nT.exports=xr;var rN=nT.exports;const tV=$m(rN);var Lk=rN;zv.createRoot=Lk.createRoot,zv.hydrateRoot=Lk.hydrateRoot;var sN={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(t){(function(){var e={}.hasOwnProperty;function n(){for(var o="",i=0;i<arguments.length;i++){var a=arguments[i];a&&(o=s(o,r(a)))}return o}function r(o){if(typeof o=="string"||typeof o=="number")return o;if(typeof o!="object")return"";if(Array.isArray(o))return n.apply(null,o);if(o.toString!==Object.prototype.toString&&!o.toString.toString().includes("[native code]"))return o.toString();var i="";for(var a in o)e.call(o,a)&&o[a]&&(i=s(i,a));return i}function s(o,i){return i?o?o+" "+i:o+i:o}t.exports?(n.default=n,t.exports=n):window.classNames=n})()})(sN);var nV=sN.exports;const sh=$m(nV);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rV=1e-7,sV=1e-4;class oN{constructor(e,n){this.backend=e,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,n){this.dataIdsCount++,this.data.set(e,n)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class Xy{refCount(e){return qn("refCount")}incRef(e){return qn("incRef")}timerAvailable(){return!0}time(e){return qn("time")}read(e){return qn("read")}readSync(e){return qn("readSync")}readToGPU(e,n){return qn("readToGPU")}numDataIds(){return qn("numDataIds")}disposeData(e,n){return qn("disposeData")}write(e,n,r){return qn("write")}move(e,n,r,s,o){return qn("move")}createTensorFromGPUData(e,n,r){return qn("createTensorFromGPUData")}memory(){return qn("memory")}floatPrecision(){return qn("floatPrecision")}epsilon(){return this.floatPrecision()===32?rV:sV}dispose(){return qn("dispose")}}function qn(t){throw new Error(`'${t}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oV(t){let e=t.length,n=0;for(;e>0;)n=Math.random()*e|0,e--,Za(t,e,n)}function ta(t,e,n){return Math.max(t,Math.min(e,n))}function qy(t){return t%2===0?t:t+1}function Za(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function iV(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];return e}function D(t,e){if(!t)throw new Error(typeof e=="string"?e:e())}function Yy(t,e,n=""){D(Ye(t,e),()=>n+` Shapes ${t} and ${e} must match`)}function iN(t){D(t!=null,()=>"The input to the tensor constructor must be a non-null value.")}function q(t){if(t.length===0)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}function Ye(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function zl(t){return t%1===0}function Ab(t){const e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function Sl(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function Mk(t,e=s=>0,n,r){return new Promise((s,o)=>{let i=0;const a=()=>{if(t()){s();return}i++;const l=e(i);if(n!=null&&i>=n){o();return}r!=null?r(a,l):setTimeout(a,l)};a()})}function aN(t,e){let n=1,r=-1;for(let o=0;o<t.length;++o)if(t[o]>=0)n*=t[o];else if(t[o]===-1){if(r!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${o}`);r=o}else if(t[o]<0)throw Error(`Shapes can not be < 0. Found ${t[o]} at dim ${o}`);if(r===-1){if(e>0&&e!==n)throw Error(`Size(${e}) must match the product of shape ${t}`);return t}if(n===0)throw Error(`Cannot infer the missing size in [${t}] when there are 0 elements`);if(e%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${n}`);const s=t.slice();return s[r]=e/n,s}function De(t,e){const n=e.length;return t=t==null?e.map((r,s)=>s):[].concat(t),D(t.every(r=>r>=-n&&r<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${t}`),D(t.every(r=>zl(r)),()=>`All values in axis param must be integers but got axis ${t}`),t.map(r=>r<0?n+r:r)}function fi(t,e){const n=[],r=[],s=e!=null&&Array.isArray(e)&&e.length===0,o=e==null||s?null:De(e,t).sort();let i=0;for(let a=0;a<t.length;++a){if(o!=null){if(o[i]===a&&t[a]!==1)throw new Error(`Can't squeeze axis ${a} since its dim '${t[a]}' is not 1`);(o[i]==null||o[i]>a)&&t[a]===1&&(n.push(t[a]),r.push(a)),o[i]<=a&&i++}t[a]!==1&&(n.push(t[a]),r.push(a))}return{newShape:n,keptDims:r}}function bn(t,e){return At(t,e)}function At(t,e){let n=null;if(t==null||t==="float32")n=new Float32Array(e);else if(t==="int32")n=new Int32Array(e);else if(t==="bool")n=new Uint8Array(e);else if(t==="string")n=new Array(e);else throw new Error(`Unknown data type ${t}`);return n}function aV(t,e){for(let n=0;n<t.length;n++){const r=t[n];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${e} being uploaded contains ${r}.`)}}function lV(t){return t==="bool"||t==="complex64"||t==="float32"||t==="int32"||t==="string"}function lN(t,e){return!(e==="complex64"||e==="float32"&&t!=="complex64"||e==="int32"&&t!=="float32"&&t!=="complex64"||e==="bool"&&t==="bool")}function Cp(t){if(t==="float32"||t==="int32")return 4;if(t==="complex64")return 8;if(t==="bool")return 1;throw new Error(`Unknown dtype ${t}`)}function uV(t){if(t==null)return 0;let e=0;return t.forEach(n=>e+=n.length),e}function dd(t){return typeof t=="string"||t instanceof String}function cV(t){return typeof t=="boolean"}function Fb(t){return typeof t=="number"}function nu(t){return Array.isArray(t)?nu(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray?"int32":Fb(t)?"float32":dd(t)?"string":cV(t)?"bool":"float32"}function Pb(t){return!!(t&&t.constructor&&t.call&&t.apply)}function Ob(t,e){for(let n=e;n<t;++n)if(t%n===0)return n;return t}function me(t){const e=t.length;if(e<2)return[];const n=new Array(e-1);n[e-2]=t[e-1];for(let r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n}function uN(t,e,n,r=!1){const s=new Array;if(e.length===1){const o=e[0]*(r?2:1);for(let i=0;i<o;i++)s[i]=n[t+i]}else{const o=e[0],i=e.slice(1),a=i.reduce((l,u)=>l*u)*(r?2:1);for(let l=0;l<o;l++)s[l]=uN(t+l*a,i,n,r)}return s}function ps(t,e,n=!1){if(t.length===0)return e[0];const r=t.reduce((s,o)=>s*o)*(n?2:1);if(r===0)return[];if(r!==e.length)throw new Error(`[${t}] does not match the input size ${e.length}${n?" for a complex tensor":""}.`);return uN(0,t,e,n)}function dV(t,e){if(Array.isArray(t))return t;if(e==="float32")return t instanceof Float32Array?t:new Float32Array(t);if(e==="int32")return t instanceof Int32Array?t:new Int32Array(t);if(e==="bool"||e==="string")return Uint8Array.from(new Int32Array(t));throw new Error(`Unknown dtype ${e}`)}function Qy(t,e){const n=xn(t,e);for(let r=0;r<n.length;r++)n[r]=1;return n}function xn(t,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool")return new Uint8Array(t);throw new Error(`Unknown data type ${e}`)}function cN(t,e){const n=t.reduce((r,s)=>r*s,1);if(e==null||e==="float32")return ps(t,new Float32Array(n));if(e==="int32")return ps(t,new Int32Array(n));if(e==="bool")return ps(t,new Uint8Array(n));throw new Error(`Unknown data type ${e}`)}function wo(t){t.forEach(e=>{D(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${t}].`)})}function Ms(t,e,n){if(e===0)return 0;if(e===1)return t[0];let r=t[t.length-1];for(let s=0;s<t.length-1;++s)r+=n[s]*t[s];return r}function ru(t,e,n){if(e===0)return[];if(e===1)return[t];const r=new Array(e);for(let s=0;s<r.length-1;++s)r[s]=Math.floor(t/n[s]),t-=r[s]*n[s];return r[r.length-1]=t,r}function Zy(t){return t&&t.then&&typeof t.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _k="tfjsflags";class fV{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=hV,this.populateURLFlags()}setPlatform(e,n){this.platform!=null&&(j().getBool("IS_TEST")||j().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=n}registerFlag(e,n,r){if(this.flagRegistry[e]={evaluationFn:n,setHook:r},this.urlFlags[e]!=null){const s=this.urlFlags[e];j().getBool("IS_TEST")||j().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${s}.`),this.set(e,s)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const n=this.evaluateFlag(e);if(Zy(n))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=n,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,n){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=n,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(n)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);_k in e&&e[_k].split(",").forEach(r=>{const[s,o]=r.split(":");this.urlFlags[s]=mV(s,o)})}}function hV(t){const e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...r)=>(pV(e,r[0],r[1]),r.join("="))),e}function pV(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}function mV(t,e){const n=e.toLowerCase();return n==="true"||n==="false"?n==="true":`${+n}`===n?+n:e}function j(){return dN}let dN=null;function gV(t){dN=t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let nv;function fN(){if(nv==null){let t;if(typeof window<"u")t=window;else if(typeof global<"u")t=global;else if(typeof process<"u")t=process;else if(typeof self<"u")t=self;else throw new Error("Could not find a global object");nv=t}return nv}function vV(){const t=fN();return t._tfGlobals==null&&(t._tfGlobals=new Map),t._tfGlobals}function Jy(t,e){const n=vV();if(n.has(t))return n.get(t);{const r=e();return n.set(t,r),n.get(t)}}const zm="Abs",fd="Acos",hd="Acosh",su="Add",e1="AddN",t1="All",n1="Any",Vm="ArgMax",Bm="ArgMin",pd="Asin",md="Asinh",gd="Atan",vd="Atanh",bd="Atan2",Wm="AvgPool",r1="AvgPoolGrad",Um="AvgPool3D",s1="AvgPool3DGrad",Gm="BatchMatMul",Hm="BatchToSpaceND",o1="Bincount",i1="BitwiseAnd",bV="BroadcastTo",hN="BroadcastArgs",xd="Cast",yd="Ceil",wd="ClipByValue",a1="Complex",jm="ComplexAbs",Km="Concat",Xm="Conv2D",l1="Conv2DBackpropFilter",qm="Conv2DBackpropInput",Ym="Conv3D",u1="Conv3DBackpropFilterV2",c1="Conv3DBackpropInputV2",$d="Cos",Cd="Cosh",d1="Cumprod",Qm="Cumsum",f1="CropAndResize",h1="DenseBincount",p1="DepthToSpace",Zm="DepthwiseConv2dNative",m1="DepthwiseConv2dNativeBackpropFilter",g1="DepthwiseConv2dNativeBackpropInput",pN="Diag",Jm="Dilation2D",Lb="Dilation2DBackpropInput",Mb="Dilation2DBackpropFilter",xV="Draw",kd="RealDiv",v1="Einsum",Sd="Elu",b1="EluGrad",Id="Erf",eg="Equal",Td="Exp",tg="ExpandDims",Ed="Expm1",x1="FFT",y1="Fill",w1="FlipLeftRight",Nd="Floor",Rd="FloorDiv",ng="FusedBatchNorm",rg="GatherV2",mN="GatherNd",sg="Greater",Dd="GreaterEqual",Ad="Identity",$1="IFFT",C1="Imag",Fd="IsFinite",Pd="IsInf",Od="IsNan",og="LeakyRelu",ig="Less",ag="LessEqual",gN="LinSpace",Ld="Log",Md="Log1p",lg="LogicalAnd",ug="LogicalNot",cg="LogicalOr",yV="LogSoftmax",dg="LRN",k1="LRNGrad",fg="Max",_d="Maximum",hg="MaxPool",S1="MaxPoolGrad",pg="MaxPool3D",I1="MaxPool3DGrad",vN="MaxPoolWithArgmax",mg="Mean",gg="Min",zd="Minimum",vg="MirrorPad",Vd="Mod",bN="Multinomial",Bd="Multiply",bg="Neg",xg="NotEqual",T1="NonMaxSuppressionV3",E1="NonMaxSuppressionV4",N1="NonMaxSuppressionV5",yg="OnesLike",wg="OneHot",$g="Pack",Cg="PadV2",Wd="Pow",kg="Prelu",Sg="Prod",xN="RaggedGather",yN="RaggedRange",wN="RaggedTensorToTensor",R1="Range",D1="Real",Ud="Reciprocal",Gd="Relu",Ig="Reshape",Tg="ResizeNearestNeighbor",A1="ResizeNearestNeighborGrad",Eg="ResizeBilinear",F1="ResizeBilinearGrad",Hd="Relu6",Ng="Reverse",jd="Round",Kd="Rsqrt",$N="ScatterNd",CN="TensorScatterUpdate",kN="SearchSorted",Rg="Select",Xd="Selu",Dg="Slice",qd="Sin",Yd="Sinh",Qd="Sign",Zd="Sigmoid",Jd="Softplus",ef="Sqrt",Ag="Sum",Fg="SpaceToBatchND",Pg="SplitV",Og="Softmax",SN="SparseFillEmptyRows",IN="SparseReshape",TN="SparseSegmentMean",EN="SparseSegmentSum",NN="SparseToDense",tf="SquaredDifference",P1="Square",O1="StaticRegexReplace",L1="StridedSlice",RN="StringNGrams",DN="StringSplit",AN="StringToHashBucketFast",nf="Sub",rf="Tan",sf="Tanh",of="Tile",M1="TopK",_1="Transform",Il="Transpose",z1="Unique",Lg="Unpack",Mg="UnsortedSegmentSum",_g="ZerosLike",af="Step",wV="FromPixels",V1="RotateWithOffset",kp="_FusedMatMul",Sp="FusedConv2D",FN="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fr(...t){j().getBool("IS_TEST")||j().getBool("PROD")||console.warn(...t)}function $V(...t){j().getBool("IS_TEST")||j().getBool("PROD")||console.log(...t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ip=Jy("kernelRegistry",()=>new Map),_b=Jy("gradRegistry",()=>new Map);function zk(t,e){const n=ON(t,e);return Ip.get(n)}function Vk(t){return _b.get(t)}function Bk(t){const e=Ip.entries(),n=[];for(;;){const{done:r,value:s}=e.next();if(r)break;const[o,i]=s,[a]=o.split("_");a===t&&n.push(i)}return n}function PN(t){const{kernelName:e,backendName:n}=t,r=ON(e,n);Ip.has(r)&&fr(`The kernel '${e}' for backend '${n}' is already registered`),Ip.set(r,t)}function CV(t){const{kernelName:e}=t;_b.has(e)&&j().getBool("DEBUG")&&fr(`Overriding the gradient for '${e}'`),_b.set(e,t)}function ON(t,e){return`${e}_${t}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LN(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray}var MN=ft,Br=null;try{Br=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function ft(t,e,n){this.low=t|0,this.high=e|0,this.unsigned=!!n}ft.prototype.__isLong__;Object.defineProperty(ft.prototype,"__isLong__",{value:!0});function ar(t){return(t&&t.__isLong__)===!0}ft.isLong=ar;var Wk={},Uk={};function Ia(t,e){var n,r,s;return e?(t>>>=0,(s=0<=t&&t<256)&&(r=Uk[t],r)?r:(n=ht(t,(t|0)<0?-1:0,!0),s&&(Uk[t]=n),n)):(t|=0,(s=-128<=t&&t<128)&&(r=Wk[t],r)?r:(n=ht(t,t<0?-1:0,!1),s&&(Wk[t]=n),n))}ft.fromInt=Ia;function Wr(t,e){if(isNaN(t))return e?Oi:Ur;if(e){if(t<0)return Oi;if(t>=_N)return BN}else{if(t<=-Hk)return Jn;if(t+1>=Hk)return VN}return t<0?Wr(-t,e).neg():ht(t%Vl|0,t/Vl|0,e)}ft.fromNumber=Wr;function ht(t,e,n){return new ft(t,e,n)}ft.fromBits=ht;var Tp=Math.pow;function B1(t,e,n){if(t.length===0)throw Error("empty string");if(t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return Ur;if(typeof e=="number"?(n=e,e=!1):e=!!e,n=n||10,n<2||36<n)throw RangeError("radix");var r;if((r=t.indexOf("-"))>0)throw Error("interior hyphen");if(r===0)return B1(t.substring(1),e,n).neg();for(var s=Wr(Tp(n,8)),o=Ur,i=0;i<t.length;i+=8){var a=Math.min(8,t.length-i),l=parseInt(t.substring(i,i+a),n);if(a<8){var u=Wr(Tp(n,a));o=o.mul(u).add(Wr(l))}else o=o.mul(s),o=o.add(Wr(l))}return o.unsigned=e,o}ft.fromString=B1;function Cs(t,e){return typeof t=="number"?Wr(t,e):typeof t=="string"?B1(t,e):ht(t.low,t.high,typeof e=="boolean"?e:t.unsigned)}ft.fromValue=Cs;var Gk=65536,kV=1<<24,Vl=Gk*Gk,_N=Vl*Vl,Hk=_N/2,jk=Ia(kV),Ur=Ia(0);ft.ZERO=Ur;var Oi=Ia(0,!0);ft.UZERO=Oi;var pl=Ia(1);ft.ONE=pl;var zN=Ia(1,!0);ft.UONE=zN;var zb=Ia(-1);ft.NEG_ONE=zb;var VN=ht(-1,2147483647,!1);ft.MAX_VALUE=VN;var BN=ht(-1,-1,!0);ft.MAX_UNSIGNED_VALUE=BN;var Jn=ht(0,-2147483648,!1);ft.MIN_VALUE=Jn;var ae=ft.prototype;ae.toInt=function(){return this.unsigned?this.low>>>0:this.low};ae.toNumber=function(){return this.unsigned?(this.high>>>0)*Vl+(this.low>>>0):this.high*Vl+(this.low>>>0)};ae.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(Jn)){var n=Wr(e),r=this.div(n),s=r.mul(n).sub(this);return r.toString(e)+s.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var o=Wr(Tp(e,6),this.unsigned),i=this,a="";;){var l=i.div(o),u=i.sub(l.mul(o)).toInt()>>>0,c=u.toString(e);if(i=l,i.isZero())return c+a;for(;c.length<6;)c="0"+c;a=""+c+a}};ae.getHighBits=function(){return this.high};ae.getHighBitsUnsigned=function(){return this.high>>>0};ae.getLowBits=function(){return this.low};ae.getLowBitsUnsigned=function(){return this.low>>>0};ae.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Jn)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,n=31;n>0&&!(e&1<<n);n--);return this.high!=0?n+33:n+1};ae.isZero=function(){return this.high===0&&this.low===0};ae.eqz=ae.isZero;ae.isNegative=function(){return!this.unsigned&&this.high<0};ae.isPositive=function(){return this.unsigned||this.high>=0};ae.isOdd=function(){return(this.low&1)===1};ae.isEven=function(){return(this.low&1)===0};ae.equals=function(e){return ar(e)||(e=Cs(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};ae.eq=ae.equals;ae.notEquals=function(e){return!this.eq(e)};ae.neq=ae.notEquals;ae.ne=ae.notEquals;ae.lessThan=function(e){return this.comp(e)<0};ae.lt=ae.lessThan;ae.lessThanOrEqual=function(e){return this.comp(e)<=0};ae.lte=ae.lessThanOrEqual;ae.le=ae.lessThanOrEqual;ae.greaterThan=function(e){return this.comp(e)>0};ae.gt=ae.greaterThan;ae.greaterThanOrEqual=function(e){return this.comp(e)>=0};ae.gte=ae.greaterThanOrEqual;ae.ge=ae.greaterThanOrEqual;ae.compare=function(e){if(ar(e)||(e=Cs(e)),this.eq(e))return 0;var n=this.isNegative(),r=e.isNegative();return n&&!r?-1:!n&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};ae.comp=ae.compare;ae.negate=function(){return!this.unsigned&&this.eq(Jn)?Jn:this.not().add(pl)};ae.neg=ae.negate;ae.add=function(e){ar(e)||(e=Cs(e));var n=this.high>>>16,r=this.high&65535,s=this.low>>>16,o=this.low&65535,i=e.high>>>16,a=e.high&65535,l=e.low>>>16,u=e.low&65535,c=0,d=0,f=0,h=0;return h+=o+u,f+=h>>>16,h&=65535,f+=s+l,d+=f>>>16,f&=65535,d+=r+a,c+=d>>>16,d&=65535,c+=n+i,c&=65535,ht(f<<16|h,c<<16|d,this.unsigned)};ae.subtract=function(e){return ar(e)||(e=Cs(e)),this.add(e.neg())};ae.sub=ae.subtract;ae.multiply=function(e){if(this.isZero())return Ur;if(ar(e)||(e=Cs(e)),Br){var n=Br.mul(this.low,this.high,e.low,e.high);return ht(n,Br.get_high(),this.unsigned)}if(e.isZero())return Ur;if(this.eq(Jn))return e.isOdd()?Jn:Ur;if(e.eq(Jn))return this.isOdd()?Jn:Ur;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(jk)&&e.lt(jk))return Wr(this.toNumber()*e.toNumber(),this.unsigned);var r=this.high>>>16,s=this.high&65535,o=this.low>>>16,i=this.low&65535,a=e.high>>>16,l=e.high&65535,u=e.low>>>16,c=e.low&65535,d=0,f=0,h=0,p=0;return p+=i*c,h+=p>>>16,p&=65535,h+=o*c,f+=h>>>16,h&=65535,h+=i*u,f+=h>>>16,h&=65535,f+=s*c,d+=f>>>16,f&=65535,f+=o*u,d+=f>>>16,f&=65535,f+=i*l,d+=f>>>16,f&=65535,d+=r*c+s*u+o*l+i*a,d&=65535,ht(h<<16|p,d<<16|f,this.unsigned)};ae.mul=ae.multiply;ae.divide=function(e){if(ar(e)||(e=Cs(e)),e.isZero())throw Error("division by zero");if(Br){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var n=(this.unsigned?Br.div_u:Br.div_s)(this.low,this.high,e.low,e.high);return ht(n,Br.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?Oi:Ur;var r,s,o;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return Oi;if(e.gt(this.shru(1)))return zN;o=Oi}else{if(this.eq(Jn)){if(e.eq(pl)||e.eq(zb))return Jn;if(e.eq(Jn))return pl;var i=this.shr(1);return r=i.div(e).shl(1),r.eq(Ur)?e.isNegative()?pl:zb:(s=this.sub(e.mul(r)),o=r.add(s.div(e)),o)}else if(e.eq(Jn))return this.unsigned?Oi:Ur;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();o=Ur}for(s=this;s.gte(e);){r=Math.max(1,Math.floor(s.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(r)/Math.LN2),l=a<=48?1:Tp(2,a-48),u=Wr(r),c=u.mul(e);c.isNegative()||c.gt(s);)r-=l,u=Wr(r,this.unsigned),c=u.mul(e);u.isZero()&&(u=pl),o=o.add(u),s=s.sub(c)}return o};ae.div=ae.divide;ae.modulo=function(e){if(ar(e)||(e=Cs(e)),Br){var n=(this.unsigned?Br.rem_u:Br.rem_s)(this.low,this.high,e.low,e.high);return ht(n,Br.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};ae.mod=ae.modulo;ae.rem=ae.modulo;ae.not=function(){return ht(~this.low,~this.high,this.unsigned)};ae.and=function(e){return ar(e)||(e=Cs(e)),ht(this.low&e.low,this.high&e.high,this.unsigned)};ae.or=function(e){return ar(e)||(e=Cs(e)),ht(this.low|e.low,this.high|e.high,this.unsigned)};ae.xor=function(e){return ar(e)||(e=Cs(e)),ht(this.low^e.low,this.high^e.high,this.unsigned)};ae.shiftLeft=function(e){return ar(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?ht(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):ht(0,this.low<<e-32,this.unsigned)};ae.shl=ae.shiftLeft;ae.shiftRight=function(e){return ar(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?ht(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):ht(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};ae.shr=ae.shiftRight;ae.shiftRightUnsigned=function(e){if(ar(e)&&(e=e.toInt()),e&=63,e===0)return this;var n=this.high;if(e<32){var r=this.low;return ht(r>>>e|n<<32-e,n>>>e,this.unsigned)}else return e===32?ht(n,0,this.unsigned):ht(n>>>e-32,0,this.unsigned)};ae.shru=ae.shiftRightUnsigned;ae.shr_u=ae.shiftRightUnsigned;ae.toSigned=function(){return this.unsigned?ht(this.low,this.high,!1):this};ae.toUnsigned=function(){return this.unsigned?this:ht(this.low,this.high,!0)};ae.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};ae.toBytesLE=function(){var e=this.high,n=this.low;return[n&255,n>>>8&255,n>>>16&255,n>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};ae.toBytesBE=function(){var e=this.high,n=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,n>>>24,n>>>16&255,n>>>8&255,n&255]};ft.fromBytes=function(e,n,r){return r?ft.fromBytesLE(e,n):ft.fromBytesBE(e,n)};ft.fromBytesLE=function(e,n){return new ft(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,n)};ft.fromBytesBE=function(e,n){return new ft(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],n)};const WN=$m(MN),SV=E_({__proto__:null,default:WN},[MN]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ni=WN||SV;function zg(t){return Ni.fromString(t,!0,16)}const UN=zg("c3a5c85c97cb3127"),Ti=zg("b492b66fbe98f273"),Rn=zg("9ae16a3b2f90404f");function Vb(t){return t.xor(t.shru(47))}function GN(t,e,n){const r=t.slice(e,e+n);return Ni.fromBytes(Array.from(r),!0,!0)}function it(t,e){return GN(t,e,8)}function Kk(t,e){return GN(t,e,4)}function Jt(t,e){return e===0?t:t.shru(e).or(t.shl(64-e))}function qo(t,e,n=zg("9ddfea08eb382d69")){let r=t.xor(e).mul(n);r=r.xor(r.shru(47));let s=e.xor(r).mul(n);return s=s.xor(s.shru(47)),s=s.mul(n),s}function IV(t,e,n,r,s,o){s=s.add(t),o=Jt(o.add(s).add(r),21);const i=s;return s=s.add(e),s=s.add(n),o=o.add(Jt(s,44)),[s.add(r),o.add(i)]}function oh(t,e,n,r){return IV(it(t,e),it(t,e+8),it(t,e+16),it(t,e+24),n,r)}function TV(t,e=t.length){if(e>=8){const n=Rn.add(e*2),r=it(t,0).add(Rn),s=it(t,e-8),o=Jt(s,37).mul(n).add(r),i=Jt(r,25).add(s).mul(n);return qo(o,i,n)}if(e>=4){const n=Rn.add(e*2),r=Kk(t,0);return qo(r.shl(3).add(e),Kk(t,e-4),n)}if(e>0){const n=t[0],r=t[e>>1],s=t[e-1],o=n+(r<<8),i=e+(s<<2);return Vb(Rn.mul(o).xor(UN.mul(i))).mul(Rn)}return Rn}function EV(t,e=t.length){const n=Rn.add(e*2),r=it(t,0).mul(Ti),s=it(t,8),o=it(t,e-8).mul(n),i=it(t,e-16).mul(Rn);return qo(Jt(r.add(s),43).add(Jt(o,30)).add(i),r.add(Jt(s.add(Rn),18)).add(o),n)}function NV(t,e=t.length){const n=Rn.add(e*2),r=it(t,0).mul(Rn),s=it(t,8),o=it(t,e-8).mul(n),i=it(t,e-16).mul(Rn),a=Jt(r.add(s),43).add(Jt(o,30)).add(i),l=qo(a,r.add(Jt(s.add(Rn),18)).add(o),n),u=it(t,16).mul(n),c=it(t,24),d=a.add(it(t,e-32)).mul(n),f=l.add(it(t,e-24)).mul(n);return qo(Jt(u.add(c),43).add(Jt(d,30)).add(f),u.add(Jt(c.add(r),18)).add(d),n)}function RV(t,e=t.length){const n=Ni.fromNumber(81,!0);if(e<=32)return e<=16?TV(t,e):EV(t,e);if(e<=64)return NV(t,e);let r=n,s=n.mul(Ti).add(113),o=Vb(s.mul(Rn).add(113)).mul(Rn),i=[Ni.UZERO,Ni.UZERO],a=[Ni.UZERO,Ni.UZERO];r=r.mul(Rn).add(it(t,0));let l=0;const u=(e-1>>6)*64,c=u+(e-1&63)-63;do r=Jt(r.add(s).add(i[0]).add(it(t,l+8)),37).mul(Ti),s=Jt(s.add(i[1]).add(it(t,l+48)),42).mul(Ti),r=r.xor(a[1]),s=s.add(i[0]).add(it(t,l+40)),o=Jt(o.add(a[0]),33).mul(Ti),i=oh(t,l,i[1].mul(Ti),r.add(a[0])),a=oh(t,l+32,o.add(a[1]),s.add(it(t,l+16))),[o,r]=[r,o],l+=64;while(l!==u);const d=Ti.add(o.and(255).shl(1));return l=c,a[0]=a[0].add(e-1&63),i[0]=i[0].add(a[0]),a[0]=a[0].add(i[0]),r=Jt(r.add(s).add(i[0]).add(it(t,l+8)),37).mul(d),s=Jt(s.add(i[1]).add(it(t,l+48)),42).mul(d),r=r.xor(a[1].mul(9)),s=s.add(i[0].mul(9).add(it(t,l+40))),o=Jt(o.add(a[0]),33).mul(d),i=oh(t,l,i[1].mul(d),r.add(a[0])),a=oh(t,l+32,o.add(a[1]),s.add(it(t,l+16))),[o,r]=[r,o],qo(qo(i[0],a[0],d).add(Vb(s).mul(UN)).add(o),qo(i[1],a[1],d).add(r),d)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hi(t,e){return e==="string"?Yo(t):Ta([t],e)}function DV(t,e){return t instanceof Float32Array&&e==="float32"||t instanceof Int32Array&&e==="int32"||t instanceof Uint8Array&&e==="bool"}function Ta(t,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=na(t)),j().getBool("DEBUG")&&aV(t,e),DV(t,e))return t;if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool"){const n=new Uint8Array(t.length);for(let r=0;r<n.length;++r)Math.round(t[r])!==0&&(n[r]=1);return n}else throw new Error(`Unknown data type ${e}`)}function _n(){return j().platform.now()}function Yo(t,e="utf-8"){return e=e||"utf-8",j().platform.encode(t,e)}function ri(t,e="utf-8"){return e=e||"utf-8",j().platform.decode(t,e)}function qr(t){return j().platform.isTypedArray!=null?j().platform.isTypedArray(t):LN(t)}function na(t,e=[],n=!1){if(e==null&&(e=[]),typeof t=="boolean"||typeof t=="number"||typeof t=="string"||Zy(t)||t==null||qr(t)&&n)e.push(t);else if(Array.isArray(t)||qr(t))for(let r=0;r<t.length;++r)na(t[r],e,n);else{let r=-1;for(const s of Object.keys(t))/^([1-9]+[0-9]*|0)$/.test(s)&&(r=Math.max(r,Number(s)));for(let s=0;s<=r;s++)na(t[s],e,n)}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class AV{constructor(e,n){this.backendTimer=e,this.logger=n,n==null&&(this.logger=new PV)}profileKernel(e,n,r){let s;const o=()=>{s=r()};let i;const a=_n();if(this.backendTimer.timerAvailable())i=this.backendTimer.time(o);else{o();for(const u of s)u.dataSync();i=Promise.resolve({kernelMs:_n()-a})}if(j().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let u=0;u<s.length;u++){const c=s[u];c.data().then(d=>{FV(d,c.dtype,e)})}return{kernelName:e,outputs:s,inputs:n,timeMs:i.then(u=>u.kernelMs),extraInfo:i.then(u=>u.getExtraProfileInfo!=null?u.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:n,outputs:r,timeMs:s,inputs:o,extraInfo:i}=e;r.forEach(a=>{Promise.all([a.data(),s,i]).then(l=>{this.logger.logKernelProfile(n,a,l[0],l[1],o,l[2])})})}}function FV(t,e,n){if(e!=="float32")return!1;for(let r=0;r<t.length;r++){const s=t[r];if(isNaN(s)||!isFinite(s))return console.warn(`Found ${s} in the result of '${n}'`),!0}return!1}class PV{logKernelProfile(e,n,r,s,o,i){const a=typeof s=="number"?Sl(`${s}ms`,9):s.error,l=Sl(e,25),u=n.rank,c=n.size,d=Sl(n.shape.toString(),14);let f="";for(const h in o){const p=o[h];if(p!=null){const g=p.shape||n.shape,v=g.length;f+=`${h}: ${v}D ${v>0?g:""} `}}console.log(`%c${l}	%c${a}	%c${u}D ${d}	%c${c}	%c${f}	%c${i}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OV(t,e,n){const r={},s={};for(let l=0;l<e.length;l++)r[e[l].id]=!0;for(let l=0;l<t.length;l++){const u=t[l],c=u.inputs;for(const d in c){const f=c[d];let h=!1;for(let p=0;p<e.length;p++)if(r[f.id]){u.outputs.forEach(g=>r[g.id]=!0),h=!0,s[u.id]=!0;break}if(h)break}}const o={};o[n.id]=!0;const i={};for(let l=t.length-1;l>=0;l--){const u=t[l],c=u.inputs;for(let d=0;d<u.outputs.length;d++)if(o[u.outputs[d].id]){for(const f in c)o[c[f].id]=!0,i[u.id]=!0;break}}const a=[];for(let l=0;l<t.length;l++){const u=t[l];if(s[u.id]&&i[u.id]){const c={};for(const f in u.inputs){const h=u.inputs[f];r[h.id]&&(c[f]=h)}const d=Object.assign({},u);d.inputs=c,d.outputs=u.outputs,a.push(d)}}return a}function LV(t,e,n,r){for(let s=e.length-1;s>=0;s--){const o=e[s],i=[];if(o.outputs.forEach(l=>{const u=t[l.id];u!=null?i.push(u):i.push(null)}),o.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${o.kernelName}.`);const a=o.gradient(i);for(const l in o.inputs){if(!(l in a))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(a)}.`);const u=n(()=>a[l]());if(u.dtype!=="float32")throw new Error(`Error in gradient for op ${o.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${u.dtype}'`);const c=o.inputs[l];if(!Ye(u.shape,c.shape))throw new Error(`Error in gradient for op ${o.kernelName}. The gradient of input '${l}' has shape '${u.shape}', which does not match the shape of the input '${c.shape}'`);if(t[c.id]==null)t[c.id]=u;else{const d=t[c.id];t[c.id]=r(d,u),d.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xk=20,Fu=3,rv=7;function MV(t,e,n,r){const s=me(e),o=_V(t,e,n,s),i=e.length,a=Kh(t,e,n,s,o),l=["Tensor"];return r&&(l.push(`  dtype: ${n}`),l.push(`  rank: ${i}`),l.push(`  shape: [${e}]`),l.push("  values:")),l.push(a.map(u=>"    "+u).join(`
`)),l.join(`
`)}function _V(t,e,n,r){const s=q(e),o=r[r.length-1],i=new Array(o).fill(0),a=e.length,l=n==="complex64"?qu(t):t;if(a>1)for(let u=0;u<s/o;u++){const c=u*o;for(let d=0;d<o;d++)i[d]=Math.max(i[d],Xu(l[c+d],0,n).length)}return i}function Xu(t,e,n){let r;return Array.isArray(t)?r=`${parseFloat(t[0].toFixed(rv))} + ${parseFloat(t[1].toFixed(rv))}j`:dd(t)?r=`'${t}'`:n==="bool"?r=HN(t):r=parseFloat(t.toFixed(rv)).toString(),Sl(r,e)}function HN(t){return t===0?"false":"true"}function Kh(t,e,n,r,s,o=!0){const i=n==="complex64"?2:1,a=e[0],l=e.length;if(l===0){if(n==="complex64"){const g=qu(t);return[Xu(g[0],0,n)]}return n==="bool"?[HN(t[0])]:[t[0].toString()]}if(l===1){if(a>Xk){const v=Fu*i;let m=Array.from(t.slice(0,v)),b=Array.from(t.slice((a-Fu)*i,a*i));return n==="complex64"&&(m=qu(m),b=qu(b)),["["+m.map((x,y)=>Xu(x,s[y],n)).join(", ")+", ..., "+b.map((x,y)=>Xu(x,s[a-Fu+y],n)).join(", ")+"]"]}return["["+(n==="complex64"?qu(t):Array.from(t)).map((v,m)=>Xu(v,s[m],n)).join(", ")+"]"]}const u=e.slice(1),c=r.slice(1),d=r[0]*i,f=[];if(a>Xk){for(let g=0;g<Fu;g++){const v=g*d,m=v+d;f.push(...Kh(t.slice(v,m),u,n,c,s,!1))}f.push("...");for(let g=a-Fu;g<a;g++){const v=g*d,m=v+d;f.push(...Kh(t.slice(v,m),u,n,c,s,g===a-1))}}else for(let g=0;g<a;g++){const v=g*d,m=v+d;f.push(...Kh(t.slice(v,m),u,n,c,s,g===a-1))}const h=l===2?",":"";f[0]="["+(a>0?f[0]+h:"");for(let g=1;g<f.length-1;g++)f[g]=" "+f[g]+h;let p=`,
`;for(let g=2;g<l;g++)p+=`
`;return f[f.length-1]=" "+f[f.length-1]+"]"+(o?"":p),f}function qu(t){const e=[];for(let n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cn{constructor(e,n,r){if(this.dtype=n,this.shape=e.slice(),this.size=q(e),r!=null){const s=r.length;D(s===this.size,()=>`Length of values '${s}' does not match the size inferred by the shape '${this.size}'.`)}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||At(n,this.size),this.strides=me(e)}set(e,...n){n.length===0&&(n=[0]),D(n.length===this.rank,()=>`The number of provided coordinates (${n.length}) must match the rank (${this.rank})`);const r=this.locToIndex(n);this.values[r]=e}get(...e){e.length===0&&(e=[0]);let n=0;for(const s of e){if(s<0||s>=this.shape[n]){const o=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(o)}n++}let r=e[e.length-1];for(let s=0;s<e.length-1;++s)r+=this.strides[s]*e[s];return this.values[r]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let n=e[e.length-1];for(let r=0;r<e.length-1;++r)n+=this.strides[r]*e[r];return n}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const n=new Array(this.shape.length);for(let r=0;r<n.length-1;++r)n[r]=Math.floor(e/this.strides[r]),e-=n[r]*this.strides[r];return n[n.length-1]=e,n}get rank(){return this.shape.length}toTensor(){return us().makeTensor(this.values,this.shape,this.dtype)}}let us=null,Ja=null;function zV(t){us=t}function VV(t){Ja=t}class Gt{constructor(e,n,r,s){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=n||"float32",this.size=q(e),this.strides=me(e),this.dataId=r,this.id=s,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return Ja.buffer(this.shape,this.dtype,e)}bufferSync(){return Ja.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return ps(this.shape,e,this.dtype==="complex64")}arraySync(){return ps(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=us().read(this.dataId);if(this.dtype==="string"){const n=await e;try{return n.map(r=>ri(r))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),us().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=us().readSync(this.dataId);if(this.dtype==="string")try{return e.map(n=>ri(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await us().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),us().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return Ja.print(this,e)}clone(){return this.throwIfDisposed(),Ja.clone(this)}toString(e=!1){const n=this.dataSync();return MV(n,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),Ja.cast(this,e)}variable(e=!0,n,r){return this.throwIfDisposed(),us().makeVariable(this,e,n,r)}}Object.defineProperty(Gt,Symbol.hasInstance,{value:t=>!!t&&t.data!=null&&t.dataSync!=null&&t.throwIfDisposed!=null});function X(){return Jy("Tensor",()=>Gt)}X();class Ep extends Gt{constructor(e,n,r,s){super(e.shape,e.dtype,e.dataId,s),this.trainable=n,this.name=r}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!Ye(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);us().disposeTensor(this),this.dataId=e.dataId,us().incRef(this,null)}dispose(){us().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(Ep,Symbol.hasInstance,{value:t=>t instanceof Gt&&t.assign!=null&&t.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var qk;(function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"})(qk||(qk={}));var Bb;(function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"})(Bb||(Bb={}));var Wb;(function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"})(Wb||(Wb={}));var Ub;(function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"})(Ub||(Ub={}));var Gb;(function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"})(Gb||(Gb={}));const BV={float32:Ub,int32:Bb,bool:Wb,complex64:Gb};function sr(t,e){if(t==="string"||e==="string"){if(t==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${t} with ${e}`)}return BV[t][e]}function W1(t){return sr(t,"int32")}function jN(t){return t!=null&&typeof t=="object"&&"texture"in t&&t.texture instanceof WebGLTexture}function KN(t){return typeof GPUBuffer<"u"&&t!=null&&typeof t=="object"&&"buffer"in t&&t.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pt(t,e){if(t.dtype===e.dtype)return[t,e];const n=sr(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function XN(t){const e=[];return qN(t,e,new Set),e}function qN(t,e,n){if(t==null)return;if(t instanceof Gt){e.push(t);return}if(!WV(t))return;const r=t;for(const s in r){const o=r[s];n.has(o)||(n.add(o),qN(o,e,n))}}function WV(t){return Array.isArray(t)||typeof t=="object"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sv(t){return t.kernelName!=null}class Yk{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class Bl{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new Yk}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const r=e[n];if(await this.initializeBackend(r).success){await this.setBackend(r);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:n}=this.initializeBackendsAndReturnBest();if(n)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:n}=this.initializeBackend(e);if(n)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,n,r=1){return e in this.registryFactory?(fr(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:n,priority:r},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:n,asyncInit:r}=this.initializeBackend(e);if(!(r?await n:n))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new AV(this.backendInstance),!0}setupRegisteredKernels(){Bk(this.backendName).forEach(n=>{n.setupFunc!=null&&n.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){Bk(e).forEach(r=>{r.disposeFunc!=null&&r.disposeFunc(this.registry[e])})}initializeBackend(e){const n=this.registryFactory[e];if(n==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const r=n.factory();if(r&&!(r instanceof Xy)&&typeof r.then=="function"){const s=++this.pendingBackendInitId,o=r.then(i=>s<this.pendingBackendInitId?!1:(this.registry[e]=i,this.pendingBackendInit=null,!0)).catch(i=>(s<this.pendingBackendInitId||(this.pendingBackendInit=null,fr(`Initialization of backend ${e} failed`),fr(i.stack||i.message)),!1));return this.pendingBackendInit=o,{success:o,asyncInit:!0}}else return this.registry[e]=r,{success:!0,asyncInit:!1}}catch(r){return fr(`Initialization of backend ${e} failed`),fr(r.stack||r.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,n)=>this.registryFactory[n].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const r=e[n],{success:s,asyncInit:o}=this.initializeBackend(r);if(o||s)return{name:r,asyncInit:o}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,n){const r=this.state.tensorInfo.get(n),s=r.backend,o=this.readSync(n),i=s.refCount(n);s.disposeData(n,!0),r.backend=e,e.move(n,o,r.shape,r.dtype,i),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,n){let r=null;if(n==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");n=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=e}let s;return this.scopedRun(()=>this.startScope(r),()=>this.endScope(s),()=>(s=n(),s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),s))}scopedRun(e,n,r){e();try{const s=r();return n(),s}catch(s){throw n(),s}}nextTensorId(){return Bl.nextTensorId++}nextVariableId(){return Bl.nextVariableId++}clone(e){const n=V.runKernel(Ad,{x:e}),r={x:e},s=i=>({x:()=>{const a="float32",l={x:i},u={dtype:a};return V.runKernel(xd,l,u)}}),o=[];return this.addTapeNode(this.state.activeScope.name,r,[n],s,o,{}),n}runKernel(e,n,r){if(this.backendName==null&&this.backend,!(zk(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:n,attrs:r})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,n,r){const s=this.backend.numDataIds();let o=0;r.forEach(l=>{o+=l.dtype==="complex64"?3:1});const i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],a=s-n-o-i;if(a>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${a} data ids) after running '${e}'`)}runKernelFunc(e){let n,r=[];const s=this.isTapeOn(),o=this.state.numBytes,i=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let a;this.backendName==null&&this.backend;let l;const u=sv(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(sv(e)){const{kernelName:p,inputs:g,attrs:v}=e;this.backendName==null&&this.backend;const m=zk(p,this.backendName);D(m!=null,()=>`Cannot find registered kernel '${p}' for backend '${this.backendName}'`),a=()=>{const b=this.backend.numDataIds();l=m.kernelFunc({inputs:g,attrs:v,backend:this.backend});const x=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(p,b,x);const y=x.map($=>$.rank!=null?$:this.makeTensorFromTensorInfo($));if(s){const $=this.getTensorsForGradient(p,g,y);r=this.saveTensorsForBackwardMode($)}return y}}else{const{forwardFunc:p}=e,g=v=>{s&&(r=v.map(m=>this.keep(this.clone(m))))};a=()=>{const v=this.backend.numDataIds();l=this.tidy(()=>p(this.backend,g));const m=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(u,v,m),m}}const{inputs:c,attrs:d}=e,f=sv(e)?null:e.backwardsFunc;let h;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?n=a():(h=this.profiler.profileKernel(u,c,()=>a()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(h),n=h.outputs)}),s&&this.addTapeNode(u,c,n,f,r,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:u,bytesAdded:this.state.numBytes-o,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-i,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(c).map(p=>c[p]!=null?c[p].shape:null),outputShapes:n.map(p=>p.shape),kernelTimeMs:h.timeMs,extraInfo:h.extraInfo}),Array.isArray(l)?n:n[0]}saveTensorsForBackwardMode(e){return e.map(r=>this.keep(this.clone(r)))}getTensorsForGradient(e,n,r){const s=Vk(e);if(s!=null){const o=s.inputsToSave||[],i=s.outputsToSave||[];let a;s.saveAllInputs?(D(Array.isArray(n),()=>"saveAllInputs is true, expected inputs to be an array."),a=Object.keys(n).map(u=>n[u])):a=o.map(u=>n[u]);const l=r.filter((u,c)=>i[c]);return a.concat(l)}return[]}makeTensor(e,n,r,s){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",s=s||this.backend;let o=e;r==="string"&&dd(e[0])&&(o=e.map(l=>Yo(l)));const i=s.write(o,n,r),a=new Gt(n,r,i,this.nextTensorId());if(this.trackTensor(a,s),r==="string"){const l=this.state.tensorInfo.get(i),u=uV(o);this.state.numBytes+=u-l.bytes,l.bytes=u}return a}makeTensorFromDataId(e,n,r,s){r=r||"float32";const o={dataId:e,shape:n,dtype:r};return this.makeTensorFromTensorInfo(o,s)}makeTensorFromTensorInfo(e,n){const{dataId:r,shape:s,dtype:o}=e,i=new Gt(s,o,r,this.nextTensorId());return this.trackTensor(i,n),i}makeVariable(e,n=!0,r,s){r=r||this.nextVariableId().toString(),s!=null&&s!==e.dtype&&(e=e.cast(s));const o=new Ep(e,n,r,this.nextTensorId());if(this.state.registeredVariables[o.name]!=null)throw new Error(`Variable with name ${o.name} was already registered`);return this.state.registeredVariables[o.name]=o,this.incRef(o,this.backend),o}trackTensor(e,n){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let r=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(r=e.size*Cp(e.dtype)),this.state.numBytes+=r,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:n||this.backend,dtype:e.dtype,shape:e.shape,bytes:r})),e instanceof Ep||this.track(e)}incRef(e,n){this.trackTensor(e,n),this.backend.incRef(e.dataId)}removeDataId(e,n){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===n&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const n=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=n.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const r=e.size*Cp(e.dtype);this.state.numBytes-=r}n.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,n.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const n=this.state.registeredVariables[e];this.disposeVariable(n)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const n=this.state.numBytes,r=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(s=>s.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r;for(const s of this.state.activeProfile.kernels)s.kernelTimeMs=await s.kernelTimeMs,s.extraInfo=await s.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,n,r,s,o,i){const a={id:this.state.nextTapeNodeId++,kernelName:e,inputs:n,outputs:r,saved:o},l=Vk(e);l!=null&&(s=l.gradFunc),s!=null&&(a.gradient=u=>(u=u.map((c,d)=>{if(c==null){const f=r[d],h=xn(f.size,f.dtype);return this.makeTensor(h,f.shape,f.dtype)}return c}),s(u.length>1?u:u[0],o,i))),this.state.activeTape.push(a)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(n.name=e),this.state.scopeStack.push(n),this.state.activeScope=n}endScope(e){const n=XN(e),r=new Set(n.map(o=>o.id));for(let o=0;o<this.state.activeScope.track.length;o++){const i=this.state.activeScope.track[o];!i.kept&&!r.has(i.id)&&i.dispose()}const s=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(o=>{!o.kept&&o.scopeId===s.id&&this.track(o)})}gradients(e,n,r,s=!1){if(D(n.length>0,()=>"gradients() received an empty list of xs."),r!=null&&r.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${r.dtype}'`);const o=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));D(o instanceof Gt,()=>"The result y returned by f() must be a tensor.");const i=OV(this.state.activeTape,n,o);if(!s&&i.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const a={};a[o.id]=r??UV(o.shape),LV(a,i,u=>this.tidy(u),GV);const l=n.map(u=>a[u.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(u=>{for(const c of u.saved)c.dispose()}),this.state.activeTape=null),{value:o,grads:l}})}customGrad(e){return D(Pb(e),()=>"The f passed in customGrad(f) must be a function."),(...n)=>{D(n.every(a=>a instanceof Gt),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let r;const s={};n.forEach((a,l)=>{s[l]=a});const o=(a,l)=>(r=e(...n,l),D(r.value instanceof Gt,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),D(Pb(r.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),r.value),i=(a,l)=>{const u=r.gradFunc(a,l),c=Array.isArray(u)?u:[u];D(c.length===n.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),D(c.every(f=>f instanceof Gt),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const d={};return c.forEach((f,h)=>{d[h]=()=>f}),d};return this.runKernelFunc({forwardFunc:o,backwardsFunc:i,inputs:s})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,n){return this.state.tensorInfo.get(e).backend.readToGPU(e,n)}async time(e){const n=_n(),r=await this.backend.time(e);return r.wallMs=_n()-n,r}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new Yk;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}Bl.nextTensorId=0;Bl.nextVariableId=0;function UV(t){const e=Qy(q(t),"float32");return V.makeTensor(e,t,"float32")}function YN(){const t=fN();if(t._tfengine==null){const e=new fV(t);t._tfengine=new Bl(e)}return gV(t._tfengine.ENV),zV(()=>t._tfengine),t._tfengine}const V=YN();function GV(t,e){const n={a:t,b:e};return V.runKernel(su,n)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HV(){return typeof navigator<"u"&&navigator!=null}function QN(t){if(t||HV()){if(t||(t=navigator),t.product==="ReactNative")return!0;const e=t.userAgent||t.vendor||(typeof window<"u"?window.opera:"");if(!e){const n=t;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function ZN(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gn=j();Gn.registerFlag("DEBUG",()=>!1,t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});Gn.registerFlag("IS_BROWSER",()=>ZN());Gn.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");Gn.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));Gn.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));Gn.registerFlag("PROD",()=>!1);Gn.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>Gn.getBool("DEBUG"));Gn.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);Gn.registerFlag("IS_TEST",()=>!1);Gn.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>Gn.getBool("DEBUG"));Gn.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);Gn.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);Gn.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vg(t,e){let n=t;if(qr(t))return e==="string"?[]:[t.length];if(jN(t)){const s=t.channels||"RGBA";return[t.height,t.width*s.length]}else if(KN(t))return[t.buffer.size/(e==null?4:Cp(e))];if(!Array.isArray(t))return[];const r=[];for(;Array.isArray(n)||qr(n)&&e!=="string";)r.push(n.length),n=n[0];return Array.isArray(t)&&j().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&JN(t,r,[]),r}function JN(t,e,n){if(n=n||[],!Array.isArray(t)&&!qr(t)){D(e.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}D(e.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${t.length} elements`),D(t.length===e[0],()=>`Element arr[${n.join("][")}] should have ${e[0]} elements, but has ${t.length} elements`);const r=e.slice(1);for(let s=0;s<t.length;++s)JN(t[s],r,n.concat(s))}function Qk(t,e,n,r){if(t!=="string_or_numeric"){if(t==null)throw new Error("Expected dtype cannot be null.");if(t!=="numeric"&&t!==e||t==="numeric"&&e==="string")throw new Error(`Argument '${n}' passed to '${r}' must be ${t} tensor, but got ${e} tensor`)}}function O(t,e,n,r="numeric"){if(t instanceof X())return Qk(r,t.dtype,e,n),t;let s=nu(t);if(s!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(s=r),Qk(r,s,e,n),t==null||!qr(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string"){const l=t==null?"null":t.constructor.name;throw new Error(`Argument '${e}' passed to '${n}' must be a Tensor or TensorLike, but got '${l}'`)}const o=Vg(t,s);!qr(t)&&!Array.isArray(t)&&(t=[t]);const a=s!=="string"?Ta(t,s):na(t,[],!0);return V.makeTensor(a,o,s)}function eR(t,e,n,r="numeric"){if(!Array.isArray(t))throw new Error(`Argument ${e} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return t.map((o,i)=>O(o,`${e}[${i}]`,n,r))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jV="__op";function W(t){const e=Object.keys(t);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let n=e[0];const r=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+jV;const s=(...o)=>{V.startScope(n);try{const i=r(...o);return Zy(i)&&console.error("Cannot return a Promise inside of tidy."),V.endScope(i),i}catch(i){throw V.endScope(null),i}};return Object.defineProperty(s,"name",{value:n,configurable:!0}),s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KV(t,e){const n=O(t,"real","complex"),r=O(e,"imag","complex");Yy(n.shape,r.shape,`real and imag shapes, ${n.shape} and ${r.shape}, must match in call to tf.complex().`);const s={real:n,imag:r};return V.runKernel(a1,s)}const Wl=W({complex_:KV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bg(t,e,n,r){if(r==null)r=nu(t);else if(r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(KN(t)||jN(t)){if(r!=="float32"&&r!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${r}.`);return V.backend.createTensorFromGPUData(t,e||n,r)}if(!qr(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){wo(e);const s=q(e),o=q(n);D(s===o,()=>`Based on the provided shape, [${e}], the tensor should have ${s} values but has ${o}`);for(let i=0;i<n.length;++i){const a=n[i],l=i===n.length-1?a!==q(e.slice(i)):!0;D(n[i]===e[i]||!l,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${e}). `)}}return!qr(t)&&!Array.isArray(t)&&(t=[t]),e=e||n,t=r!=="string"?Ta(t,r):na(t,[],!0),V.makeTensor(t,e,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Er(t,e,n){const r=Vg(t,n);return Bg(t,e,r,n)}class ou{static join(e){return new ou(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,e==null||(e instanceof Array||(e=[e]),e=e.map(r=>qr(r)?r.buffer:r),e.length===0))return;this.bufferUniformSize=e[0].byteLength;let n=0;for(let r=0;r<e.length;r++){const s=e[r];r!==e.length-1&&s.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const o=n+s.byteLength;this.shards.push({buffer:s,start:n,end:o}),n=o}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(e=0,n=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,n=isNaN(Number(n))?0:n,e=Math.max(0,e),n=Math.min(this.byteLength,n),n<=e)return new ArrayBuffer(0);const r=this.findShardForByte(e);if(r===-1)throw new Error(`Could not find start shard for byte ${e}`);const s=n-e,o=new ArrayBuffer(s),i=new Uint8Array(o);let a=0;for(let l=r;l<this.shards.length;l++){const u=this.shards[l],d=e+a-u.start,f=a,p=Math.min(n,u.end)-u.start,g=new Uint8Array(u.buffer,d,p-d);if(i.set(g,f),a+=g.length,n<u.end)break}return o}findShardForByte(e){if(this.shards.length===0||e<0||e>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function n(s){return e<s.start?-1:e>=s.end?1:0}if(n(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const r=XV(this.shards,n);return r===-1?-1:(this.previousShardIndex=r,this.previousShardIndex)}}function XV(t,e){let n=0,r=t.length;for(;n<=r;){const s=Math.floor((r-n)/2)+n,o=e(t[s]);if(o===0)return s;o<0?r=s:n=s+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Es(){return V}function Zk(){return V.memory()}function H(t,e){return V.tidy(t,e)}function Fe(t){XN(t).forEach(n=>n.dispose())}function _s(t){return V.keep(t)}function qV(t){return V.setBackend(t)}function tR(t,e,n=1){return V.registerBackend(t,e,n)}function YV(){return V.backend}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jk=4;async function eS(t,e){const n=[],r=[],s=Array.isArray(t)?t.map(i=>i.name):Object.keys(t);for(let i=0;i<s.length;++i){const a=s[i],l=Array.isArray(t)?t[i].tensor:t[a];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${a}': ${l.dtype}`);const u={name:a,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const c=new Promise(async d=>{const f=await l.bytes(),h=f.reduce((v,m)=>v+m.length,0)+Jk*f.length,p=new Uint8Array(h);let g=0;for(let v=0;v<f.length;v++){const m=f[v],b=new Uint8Array(new Uint32Array([m.length]).buffer);p.set(b,g),g+=Jk,p.set(m,g),g+=m.length}d(p)});r.push(c)}else r.push(l.data());e!=null&&(u.group=e),n.push(u)}const o=await Promise.all(r);return{data:QV(o),specs:n}}function QV(t){if(t===null)throw new Error(`Invalid input value: ${JSON.stringify(t)}`);let e=0;const n=[];t.forEach(o=>{if(e+=o.byteLength,n.push(o.byteLength===o.buffer.byteLength?o:new o.constructor(o)),!(o instanceof Float32Array||o instanceof Int32Array||o instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${o.constructor.name}`)});const r=new Uint8Array(e);let s=0;return n.forEach(o=>{r.set(new Uint8Array(o.buffer),s),s+=o.byteLength}),r.buffer}const U1=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function tS(t){return U1?Buffer.byteLength(t,"utf8"):new Blob([t]).size}function ZV(t){if(U1)return Buffer.from(t).toString("base64");const e=new Uint8Array(t);let n="";for(let r=0,s=e.length;r<s;r++)n+=String.fromCharCode(e[r]);return btoa(n)}function JV(t){if(U1){const r=Buffer.from(t,"base64");return r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)}const e=atob(t),n=new Uint8Array(e.length);for(let r=0;r<e.length;++r)n.set([e.charCodeAt(r)],r);return n.buffer}function eB(t){return ou.join(t)}function nR(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:t.modelTopology==null?0:tS(JSON.stringify(t.modelTopology)),weightSpecsBytes:t.weightSpecs==null?0:tS(JSON.stringify(t.weightSpecs)),weightDataBytes:t.weightData==null?0:new ou(t.weightData).byteLength}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class In{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return In.instance==null&&(In.instance=new In),In.instance}static registerSaveRouter(e){In.getInstance().saveRouters.push(e)}static registerLoadRouter(e){In.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return In.getHandlers(e,"save")}static getLoadHandlers(e,n){return In.getHandlers(e,"load",n)}static getHandlers(e,n,r){const s=[];return(n==="load"?In.getInstance().loadRouters:In.getInstance().saveRouters).forEach(i=>{const a=i(e,r);a!==null&&s.push(a)}),s}}const tB=t=>In.getSaveHandlers(t);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hb="tensorflowjs",jb=1,Li="models_store",Mo="model_info_store";function rR(){if(!j().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const t=typeof window>"u"?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function Kb(t){const e=t.result;e.createObjectStore(Li,{keyPath:"modelPath"}),e.createObjectStore(Mo,{keyPath:"modelPath"})}class ra{constructor(e){if(this.indexedDB=rR(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,n){return new Promise((r,s)=>{const o=this.indexedDB.open(Hb,jb);o.onupgradeneeded=()=>Kb(o),o.onsuccess=()=>{const i=o.result;if(n==null){const a=i.transaction(Li,"readonly"),u=a.objectStore(Li).get(this.modelPath);u.onsuccess=()=>{if(u.result==null)return i.close(),s(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));r(u.result.modelArtifacts)},u.onerror=c=>(i.close(),s(u.error)),a.oncomplete=()=>i.close()}else{n.weightData=ou.join(n.weightData);const a=nR(n),l=i.transaction(Mo,"readwrite");let u=l.objectStore(Mo),c;try{c=u.put({modelPath:this.modelPath,modelArtifactsInfo:a})}catch(f){return s(f)}let d;c.onsuccess=()=>{d=i.transaction(Li,"readwrite");const f=d.objectStore(Li);let h;try{h=f.put({modelPath:this.modelPath,modelArtifacts:n,modelArtifactsInfo:a})}catch(p){return s(p)}h.onsuccess=()=>r({modelArtifactsInfo:a}),h.onerror=p=>{u=l.objectStore(Mo);const g=u.delete(this.modelPath);g.onsuccess=()=>(i.close(),s(h.error)),g.onerror=v=>(i.close(),s(h.error))}},c.onerror=f=>(i.close(),s(c.error)),l.oncomplete=()=>{d==null?i.close():d.oncomplete=()=>i.close()}}},o.onerror=i=>s(o.error)})}}ra.URL_SCHEME="indexeddb://";const sR=t=>j().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(ra.URL_SCHEME)?nB(t.slice(ra.URL_SCHEME.length)):null;In.registerSaveRouter(sR);In.registerLoadRouter(sR);function nB(t){return new ra(t)}function rB(t){return t.startsWith(ra.URL_SCHEME)?t.slice(ra.URL_SCHEME.length):t}class sB{constructor(){this.indexedDB=rR()}async listModels(){return new Promise((e,n)=>{const r=this.indexedDB.open(Hb,jb);r.onupgradeneeded=()=>Kb(r),r.onsuccess=()=>{const s=r.result,o=s.transaction(Mo,"readonly"),a=o.objectStore(Mo).getAll();a.onsuccess=()=>{const l={};for(const u of a.result)l[u.modelPath]=u.modelArtifactsInfo;e(l)},a.onerror=l=>(s.close(),n(a.error)),o.oncomplete=()=>s.close()},r.onerror=s=>n(r.error)})}async removeModel(e){return e=rB(e),new Promise((n,r)=>{const s=this.indexedDB.open(Hb,jb);s.onupgradeneeded=()=>Kb(s),s.onsuccess=()=>{const o=s.result,i=o.transaction(Mo,"readwrite"),a=i.objectStore(Mo),l=a.get(e);let u;l.onsuccess=()=>{if(l.result==null)return o.close(),r(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const c=a.delete(e),d=()=>{u=o.transaction(Li,"readwrite");const h=u.objectStore(Li).delete(e);h.onsuccess=()=>n(l.result.modelArtifactsInfo),h.onerror=p=>r(l.error)};c.onsuccess=d,c.onerror=f=>(d(),o.close(),r(l.error))}},l.onerror=c=>(o.close(),r(l.error)),i.oncomplete=()=>{u==null?o.close():u.oncomplete=()=>o.close()}},s.onerror=o=>r(s.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ro="/",el="tensorflowjs_models",oR="info",oB="model_topology",iB="weight_specs",aB="weight_data",lB="model_metadata";function iR(t){return{info:[el,t,oR].join(ro),topology:[el,t,oB].join(ro),weightSpecs:[el,t,iB].join(ro),weightData:[el,t,aB].join(ro),modelMetadata:[el,t,lB].join(ro)}}function aR(t){for(const e of Object.values(t))window.localStorage.removeItem(e)}function uB(t){const e=t.split(ro);if(e.length<3)throw new Error(`Invalid key format: ${t}`);return e.slice(1,e.length-1).join(ro)}function cB(t){return t.startsWith(sa.URL_SCHEME)?t.slice(sa.URL_SCHEME.length):t}class sa{constructor(e){if(!j().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=iR(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(e.modelTopology),r=JSON.stringify(e.weightSpecs),s=nR(e),o=ou.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(s)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,ZV(o));const i={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(i)),{modelArtifactsInfo:s}}catch{throw aR(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${s.modelTopologyBytes}, weightSpecsBytes=${s.weightSpecsBytes}, weightDataBytes=${s.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const n={},r=JSON.parse(this.LS.getItem(this.keys.topology));if(r==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);n.modelTopology=r;const s=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(s==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);n.weightSpecs=s;const o=this.LS.getItem(this.keys.modelMetadata);if(o!=null){const a=JSON.parse(o);n.format=a.format,n.generatedBy=a.generatedBy,n.convertedBy=a.convertedBy,a.signature!=null&&(n.signature=a.signature),a.userDefinedMetadata!=null&&(n.userDefinedMetadata=a.userDefinedMetadata),a.modelInitializer!=null&&(n.modelInitializer=a.modelInitializer),a.initializerSignature!=null&&(n.initializerSignature=a.initializerSignature),a.trainingConfig!=null&&(n.trainingConfig=a.trainingConfig)}const i=this.LS.getItem(this.keys.weightData);if(i==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return n.weightData=JV(i),n}}sa.URL_SCHEME="localstorage://";const lR=t=>j().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(sa.URL_SCHEME)?dB(t.slice(sa.URL_SCHEME.length)):null;In.registerSaveRouter(lR);In.registerLoadRouter(lR);function dB(t){return new sa(t)}class fB{constructor(){D(j().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),D(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},n=el+ro,r=ro+oR;for(let s=0;s<this.LS.length;++s){const o=this.LS.key(s);if(o.startsWith(n)&&o.endsWith(r)){const i=uB(o);e[i]=JSON.parse(this.LS.getItem(o))}}return e}async removeModel(e){e=cB(e);const n=iR(e);if(this.LS.getItem(n.info)==null)throw new Error(`Cannot find model at path '${e}'`);const r=JSON.parse(this.LS.getItem(n.info));return aR(n),r}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nS="://";class Ns{constructor(){this.managers={}}static getInstance(){return Ns.instance==null&&(Ns.instance=new Ns),Ns.instance}static registerManager(e,n){D(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(nS)&&(e=e.slice(0,e.indexOf(nS))),D(e.length>0,()=>"scheme must not be an empty string.");const r=Ns.getInstance();D(r.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),r.managers[e]=n}static getManager(e){const n=Ns.getInstance().managers[e];if(n==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return n}static getSchemes(){return Object.keys(Ns.getInstance().managers)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hB{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,n){return fetch(e,n)}now(){return performance.now()}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${n}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,n){return new TextDecoder(n).decode(e)}setTimeoutCustom(e,n){if(typeof window>"u"||!j().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,n);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},n),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",r=>{if(r.source===window&&r.data.name===this.messageName){r.stopPropagation();const s=this.functionRefs[r.data.index];s(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(e){return LN(e)}}if(j().get("IS_BROWSER")){j().setPlatform("browser",new hB);try{Ns.registerManager(sa.URL_SCHEME,new fB)}catch{}try{Ns.registerManager(ra.URL_SCHEME,new sB)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pB={importFetch:()=>require("node-fetch")};let ov;class mB{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,n){return j().global.fetch!=null?j().global.fetch(e,n):(ov==null&&(ov=pB.importFetch()),ov(e,n))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${n}`);return this.textEncoder.encode(e)}decode(e,n){return e.length===0?"":new this.util.TextDecoder(n).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}j().get("IS_NODE")&&!j().get("IS_BROWSER")&&j().setPlatform("node",new mB);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Re(t,e="float32",n){return e=e||"float32",wo(t),new cn(t,e,n)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gB(t,e){const n=O(t,"x","cast");if(!lV(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&n.dtype!=="string"||e!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");const r={x:n},s={dtype:e};return V.runKernel(xd,r,s)}const ce=W({cast_:gB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vB(t){const n={x:O(t,"x","clone","string_or_numeric")};return V.runKernel(Ad,n)}const Hi=W({clone_:vB});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bB(t,e=!1){console.log(t.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */YN();const xB={buffer:Re,cast:ce,clone:Hi,print:bB};VV(xB);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yB(t,e){let n=O(t,"a","add"),r=O(e,"b","add");[n,r]=Pt(n,r);const s={a:n,b:r};return V.runKernel(su,s)}const ne=W({add_:yB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wB(t,e){let n=O(t,"a","floorDiv"),r=O(e,"b","floorDiv");[n,r]=Pt(n,r);const s={a:n,b:r};return V.runKernel(Rd,s)}const uR=W({floorDiv_:wB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $B(t,e){let n=O(t,"a","div"),r=O(e,"b","div");if([n,r]=Pt(n,r),n.dtype==="int32"&&r.dtype==="int32")return uR(n,r);const s={a:n,b:r},o={};return V.runKernel(kd,s,o)}const be=W({div_:$B});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CB(t,e){let n=O(t,"a","mul"),r=O(e,"b","mul");[n,r]=Pt(n,r);const s={a:n,b:r};return V.runKernel(Bd,s)}const _=W({mul_:CB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kB(t){const e=O(t,"x","abs");if(e.dtype==="complex64"){const n={x:e};return V.runKernel(jm,n)}else{const n={x:e};return V.runKernel(zm,n)}}const En=W({abs_:kB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SB(t){const n={x:O(t,"x","acos")};return V.runKernel(fd,n)}const IB=W({acos_:SB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TB(t){const n={x:O(t,"x","acosh")};return V.runKernel(hd,n)}const EB=W({acosh_:TB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NB(t,e=null,n=!1){const s={x:O(t,"x","all","bool")},o={axis:e,keepDims:n};return V.runKernel(t1,s,o)}const cR=W({all_:NB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RB(t,e=null,n=!1){const s={x:O(t,"x","any","bool")},o={axis:e,keepDims:n};return V.runKernel(n1,s,o)}const Xb=W({any_:RB});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DB(t,e=0){const r={x:O(t,"x","argMax")},s={axis:e};return V.runKernel(Vm,r,s)}const Wc=W({argMax_:DB});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AB(t,e=0){const r={x:O(t,"x","argMin")},s={axis:e};return V.runKernel(Bm,r,s)}const FB=W({argMin_:AB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PB(t){const n={x:O(t,"x","asin")};return V.runKernel(pd,n)}const OB=W({asin_:PB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LB(t){const n={x:O(t,"x","asinh")};return V.runKernel(md,n)}const MB=W({asinh_:LB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _B(t){const n={x:O(t,"x","atan")};return V.runKernel(gd,n)}const zB=W({atan_:_B});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VB(t,e){let n=O(t,"a","atan2"),r=O(e,"b","atan2");[n,r]=Pt(n,r);const s={a:n,b:r};return V.runKernel(bd,s)}const BB=W({atan2_:VB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WB(t){const n={x:O(t,"x","atanh")};return V.runKernel(vd,n)}const UB=W({atanh_:WB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lf(t,e,n,r,s="NHWC",o){const i=t[3],a=[...e,i],l=Co(s);return dn(t,a,n,o,r,null,null,l)}function Zr(t,e,n,r,s,o,i="channelsLast"){const[a,l]=Uc(e);let u;if(i==="channelsLast")u=[a,l,t[3],t[3]];else if(i==="channelsFirst")u=[a,l,t[1],t[1]];else throw new Error(`Unknown dataFormat ${i}`);return dn(t,u,n,r,s,o,!1,i)}function $o(t,e,n,r,s,o,i="NDHWC"){const[a,l,u]=qb(e);let c,d;if(i==="NDHWC")d="channelsLast",c=[a,l,u,t[4],t[4]];else if(i==="NCDHW")d="channelsFirst",c=[a,l,u,t[1],t[1]];else throw new Error(`Unknown dataFormat ${i}`);return pi(t,c,n,r,s,!1,d,o)}function dn(t,e,n,r,s,o,i=!1,a="channelsLast"){let[l,u,c,d]=[-1,-1,-1,-1];if(a==="channelsLast")[l,u,c,d]=t;else if(a==="channelsFirst")[l,d,u,c]=t;else throw new Error(`Unknown dataFormat ${a}`);const[f,h,,p]=e,[g,v]=Uc(n),[m,b]=Uc(r),x=Tl(f,m),y=Tl(h,b),{padInfo:$,outHeight:C,outWidth:k}=jB(s,u,c,g,v,x,y,o,a),w=i?p*d:p;let I;return a==="channelsFirst"?I=[l,w,C,k]:a==="channelsLast"&&(I=[l,C,k,w]),{batchSize:l,dataFormat:a,inHeight:u,inWidth:c,inChannels:d,outHeight:C,outWidth:k,outChannels:w,padInfo:$,strideHeight:g,strideWidth:v,filterHeight:f,filterWidth:h,effectiveFilterHeight:x,effectiveFilterWidth:y,dilationHeight:m,dilationWidth:b,inShape:t,outShape:I,filterShape:e}}function pi(t,e,n,r,s,o=!1,i="channelsLast",a){let[l,u,c,d,f]=[-1,-1,-1,-1,-1];if(i==="channelsLast")[l,u,c,d,f]=t;else if(i==="channelsFirst")[l,f,u,c,d]=t;else throw new Error(`Unknown dataFormat ${i}`);const[h,p,g,,v]=e,[m,b,x]=qb(n),[y,$,C]=qb(r),k=Tl(h,y),w=Tl(p,$),I=Tl(g,C),{padInfo:N,outDepth:E,outHeight:R,outWidth:S}=KB(s,u,c,d,m,b,x,k,w,I,a),T=o?v*f:v;let F;return i==="channelsFirst"?F=[l,T,E,R,S]:i==="channelsLast"&&(F=[l,E,R,S,T]),{batchSize:l,dataFormat:i,inDepth:u,inHeight:c,inWidth:d,inChannels:f,outDepth:E,outHeight:R,outWidth:S,outChannels:T,padInfo:N,strideDepth:m,strideHeight:b,strideWidth:x,filterDepth:h,filterHeight:p,filterWidth:g,effectiveFilterDepth:k,effectiveFilterHeight:w,effectiveFilterWidth:I,dilationDepth:y,dilationHeight:$,dilationWidth:C,inShape:t,outShape:F,filterShape:e}}function GB(t,e,n,r,s){r==null&&(r=G1(t,e,n));const o=t[0],i=t[1],a=Gc((o-e+2*r)/n+1,s),l=Gc((i-e+2*r)/n+1,s);return[a,l]}function HB(t,e,n,r,s,o){s==null&&(s=G1(t,e[0],r[0]));const i=[0,0,0,n];for(let a=0;a<3;a++)t[a]+2*s>=e[a]&&(i[a]=Gc((t[a]-e[a]+2*s)/r[a]+1,o));return i}function G1(t,e,n,r=1){const s=Tl(e,r);return Math.floor((t[0]*(n-1)-n+s)/2)}function Uc(t){return typeof t=="number"?[t,t,t]:t.length===2?[t[0],t[1],1]:t}function qb(t){return typeof t=="number"?[t,t,t]:t}function Tl(t,e){return e<=1?t:t+(t-1)*(e-1)}function jB(t,e,n,r,s,o,i,a,l){let u,c,d;if(typeof t=="number"){u={top:t,bottom:t,left:t,right:t,type:t===0?"VALID":"NUMBER"};const h=GB([e,n],o,r,t,a);c=h[0],d=h[1]}else if(t==="same"){c=Math.ceil(e/r),d=Math.ceil(n/s);const f=Math.max(0,(c-1)*r+o-e),h=Math.max(0,(d-1)*s+i-n),p=Math.floor(f/2),g=f-p,v=Math.floor(h/2),m=h-v;u={top:p,bottom:g,left:v,right:m,type:"SAME"}}else if(t==="valid")u={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((e-o+1)/r),d=Math.ceil((n-i+1)/s);else if(typeof t=="object"){const f=l==="channelsLast"?t[1][0]:t[2][0],h=l==="channelsLast"?t[1][1]:t[2][1],p=l==="channelsLast"?t[2][0]:t[3][0],g=l==="channelsLast"?t[2][1]:t[3][1];u={top:f,bottom:h,left:p,right:g,type:f===0&&h===0&&p===0&&g===0?"VALID":"EXPLICIT"},c=Gc((e-o+f+h)/r+1,a),d=Gc((n-i+p+g)/s+1,a)}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:u,outHeight:c,outWidth:d}}function KB(t,e,n,r,s,o,i,a,l,u,c){let d,f,h,p;if(t==="valid"&&(t=0),typeof t=="number"){d={top:t,bottom:t,left:t,right:t,front:t,back:t,type:t===0?"VALID":"NUMBER"};const v=HB([e,n,r,1],[a,l,u],1,[s,o,i],t,c);f=v[0],h=v[1],p=v[2]}else if(t==="same"){f=Math.ceil(e/s),h=Math.ceil(n/o),p=Math.ceil(r/i);const g=(f-1)*s+a-e,v=(h-1)*o+l-n,m=(p-1)*i+u-r,b=Math.floor(g/2),x=g-b,y=Math.floor(v/2),$=v-y,C=Math.floor(m/2),k=m-C;d={top:y,bottom:$,left:C,right:k,front:b,back:x,type:"SAME"}}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:d,outDepth:f,outHeight:h,outWidth:p}}function Gc(t,e){if(!e)return Math.trunc(t);switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error(`Unknown roundingMode ${e}`)}}function oa(t){const[e,n,r]=Uc(t);return e===1&&n===1&&r===1}function wn(t,e){return oa(t)||oa(e)}function ia(t){return Uc(t).every(e=>e>0)}function Co(t){if(t==="NHWC")return"channelsLast";if(t==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${t}`)}function Xn(t,e,n){if(n!=null){if(typeof e=="string")throw Error(`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);if(typeof e=="number")D(zl(e),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);else if(typeof e=="object")e.forEach(r=>{r.forEach(s=>{D(zl(s),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${s}.`)})});else throw Error(`Error in ${t}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XB(t,e){const r={x:O(t,"x","reshape","string_or_numeric")},s={shape:e};return V.runKernel(Ig,r,s)}const B=W({reshape_:XB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qB(t,e,n,r,s){const o=O(t,"x","avgPool","float32"),i=1;D(wn(n,i),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`);let a=o,l=!1;o.rank===3&&(l=!0,a=B(o,[1,o.shape[0],o.shape[1],o.shape[2]])),D(a.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${a.rank}.`),Xn("avgPool",r,s);const u={x:a},c={filterSize:e,strides:n,pad:r,dimRoundingMode:s};let d=V.runKernel(Wm,u,c);return d=ce(d,o.dtype),l?B(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const H1=W({avgPool_:qB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YB(t,e,n,r,s,o="NDHWC"){const i=O(t,"x","avgPool3d","float32");let a=i,l=!1;i.rank===4&&(l=!0,a=B(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),D(a.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${a.rank}.`),D(o==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${o}`),D(typeof n=="number"&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${n}'`),Xn("avgPool3d",r,s);const u={x:a},c={filterSize:e,strides:n,pad:r,dimRoundingMode:s,dataFormat:o};let d=V.runKernel(Um,u,c);return d=ce(d,a.dtype),l?B(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const QB=W({avgPool3d_:YB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZB(t,e=0){D(t.length>=1,()=>"Pass at least one tensor to concat");const n=eR(t,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(o=>{if(o.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${o.dtype}. `)}),n.length===1)return Hi(n[0]);const r=n,s={axis:e};return V.runKernel(Km,r,s)}const Un=W({concat_:ZB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JB(t,e,n=!1,r=!1){let s=O(t,"a","matMul"),o=O(e,"b","matMul");[s,o]=Pt(s,o);const i={a:s,b:o},a={transposeA:n,transposeB:r};return V.runKernel(Gm,i,a)}const Xe=W({matMul_:JB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eW(t){const n={x:O(t,"x","sigmoid","float32")};return V.runKernel(Zd,n)}const iu=W({sigmoid_:eW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tW(t,e,n){const r=O(t,"x","slice","string_or_numeric");if(r.rank===0)throw new Error("Slicing scalar is not possible");const s={x:r},o={begin:e,size:n};return V.runKernel(Dg,s,o)}const at=W({slice_:tW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nW(t){const n={x:O(t,"x","tanh","float32")};return V.runKernel(sf,n)}const Wg=W({tanh_:nW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rW(t,e,n){const r=O(t,"x","batchToSpaceND"),s=e.reduce((a,l)=>a*l);D(r.rank>=1+e.length,()=>`input rank is ${r.rank} but should be > than blockShape.length ${e.length}`),D(n.length===e.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${e.length}`),D(r.shape[0]%s===0,()=>`input tensor batch is ${r.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${s}`);const o={x:r},i={blockShape:e,crops:n};return V.runKernel(Hm,o,i)}const j1=W({batchToSpaceND_:rW});function sW(t){let e;return t.rank===0||t.rank===1?e=B(t,[1,1,1,t.size]):t.rank===2?e=B(t,[1,1,t.shape[0],t.shape[1]]):t.rank===3?e=B(t,[1,t.shape[0],t.shape[1],t.shape[2]]):e=t,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oW(t,e,n,r,s,o){o==null&&(o=.001);const i=O(t,"x","batchNorm"),a=O(e,"mean","batchNorm"),l=O(n,"variance","batchNorm");let u;s!=null&&(u=O(s,"scale","batchNorm"));let c;r!=null&&(c=O(r,"offset","batchNorm")),D(a.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),D(c==null||a.rank===c.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),D(u==null||a.rank===u.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const f={x:sW(i),scale:u,offset:c,mean:a,variance:l},h={varianceEpsilon:o},p=V.runKernel(ng,f,h);return B(p,i.shape)}const Ug=W({batchNorm_:oW});function iW(t,e,n,r,s,o){const i=O(t,"x","batchNorm"),a=O(e,"mean","batchNorm"),l=O(n,"variance","batchNorm");let u;s!=null&&(u=O(s,"scale","batchNorm"));let c;return r!=null&&(c=O(r,"offset","batchNorm")),D(i.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${i.rank}.`),D(a.rank===2||a.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${a.rank}.`),D(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),u!=null&&D(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${u.rank}.`),c!=null&&D(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${c.rank}.`),Ug(i,a,l,c,u,o)}const aW=W({batchNorm2d_:iW});function lW(t,e,n,r,s,o){const i=O(t,"x","batchNorm"),a=O(e,"mean","batchNorm"),l=O(n,"variance","batchNorm");let u;s!=null&&(u=O(s,"scale","batchNorm"));let c;return r!=null&&(c=O(r,"offset","batchNorm")),D(i.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${i.rank}.`),D(a.rank===3||a.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${a.rank}.`),D(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),u!=null&&D(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${u.rank}.`),c!=null&&D(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${c.rank}.`),Ug(i,a,l,c,u,o)}const uW=W({batchNorm3d_:lW});function cW(t,e,n,r,s,o){const i=O(t,"x","batchNorm"),a=O(e,"mean","batchNorm"),l=O(n,"variance","batchNorm");let u;s!=null&&(u=O(s,"scale","batchNorm"));let c;return r!=null&&(c=O(r,"offset","batchNorm")),D(i.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${i.rank}.`),D(a.rank===4||a.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${a.rank}.`),D(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),u!=null&&D(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${u.rank}.`),c!=null&&D(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${c.rank}.`),Ug(i,a,l,c,u,o)}const dW=W({batchNorm4d_:cW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fW(t,e,n){const r=O(t,"x","bincount"),s=O(e,"weights","bincount");D(r.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${r.dtype}`),D(n>=0,()=>`size must be non-negative, but got ${n}.`),D(s.size===r.size||s.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: ${s.shape}.`);const o={x:r,weights:s},i={size:n};return V.runKernel(o1,o,i)}const hW=W({bincount_:fW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pW(t,e){let n=O(t,"broadcastTo","x");const r=n.shape;if(wo(e),e.length<n.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${n.rank}.`);if(e.length>n.rank){const u=n.shape.slice();for(;u.length<e.length;)u.unshift(1);n=B(n,u)}const s=n.shape,o=Array.from(e);for(let u=e.length-1;u>=0;u--)if(s[u]===e[u])o[u]=1;else if(n.shape[u]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${e}].`);if(o.map((u,c)=>u>1?c:-1).filter(u=>u>=0).length===0)return Hi(n);const a={x:n},l={reps:o};return V.runKernel(of,a,l)}const fc=W({broadcastTo_:pW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mW(t){const n={x:O(t,"x","ceil","float32")};return V.runKernel(yd,n)}const gW=W({ceil_:mW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gg(t,e,n){wo(t),n=n||nu(e);const r={shape:t,value:e,dtype:n};return V.runKernel(y1,{},r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vW(t,e,n){const r=O(t,"x","clipByValue");if(D(e<=n,()=>`Error in clip: min (${e}) must be less than or equal to max (${n}).`),e===n)return Gg(r.shape,e,r.dtype);const s={x:r},o={clipValueMin:e,clipValueMax:n};return V.runKernel(wd,s,o)}const br=W({clipByValue_:vW});function bW(t){return Un(t,0)}const xW=W({concat1d_:bW});function yW(t,e){return Un(t,e)}const wW=W({concat2d_:yW});function $W(t,e){return Un(t,e)}const CW=W({concat3d_:$W});function kW(t,e){return Un(t,e)}const SW=W({concat4d_:kW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IW(t,e,n,r,s="NHWC",o=[1,1],i){const a=O(t,"x","conv2d","float32"),l=O(e,"filter","conv2d","float32");let u=a,c=!1;a.rank===3&&(c=!0,u=B(a,[1,a.shape[0],a.shape[1],a.shape[2]])),D(u.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${u.rank}.`),D(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),Xn("conv2d",r,i);const d=s==="NHWC"?u.shape[3]:u.shape[1];D(d===l.shape[2],()=>`Error in conv2d: depth of input (${d}) must match input depth for filter ${l.shape[2]}.`),D(wn(n,o),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),D(ia(o),()=>"Error in conv2D: Dilated rates should be larger than 0."),D(ia(n),()=>"Error in conv2D: Strides should be larger than 0.");const f={x:u,filter:l},h={strides:n,pad:r,dataFormat:s,dilations:o,dimRoundingMode:i},p=V.runKernel(Xm,f,h);return c?B(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const aa=W({conv2d_:IW});function TW(t,e,n,r,s="NWC",o=1,i){const a=O(t,"x","conv1d"),l=O(e,"filter","conv1d");let u=a,c=!1;a.rank===2&&(c=!0,u=B(a,[1,a.shape[0],a.shape[1]])),D(u.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${u.rank}.`),D(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),Xn("conv1d",r,i),D(u.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${u.shape[2]}) must match input depth for filter ${l.shape[1]}.`),D(wn(n,o),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${o}'`),D(ia(o),()=>"Error in conv1D: Dilated rates should be larger than 0."),D(ia(n),()=>"Error in conv1D: Stride should be larger than 0."),D(s==="NWC",()=>`Error in conv1d: got dataFormat of ${s} but only NWC is currently supported.`);const d=B(l,[1,l.shape[0],l.shape[1],l.shape[2]]),f=B(u,[u.shape[0],1,u.shape[1],u.shape[2]]),v=aa(f,d,[1,n],r,"NHWC",[1,o],i);return c?B(v,[v.shape[2],v.shape[3]]):B(v,[v.shape[0],v.shape[2],v.shape[3]])}const dR=W({conv1d_:TW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EW(t,e,n,r,s,o="NHWC",i){D(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let a=t,l=e,u=!1;e.rank===3&&(u=!0,l=B(e,[1,e.shape[0],e.shape[1],e.shape[2]]),a=[1,t[0],t[1],t[2]]),D(a.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${a.length}.`),D(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),D(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);const c=o==="NHWC"?a[3]:a[1],d=o==="NHWC"?l.shape[3]:l.shape[1];D(c===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${c}) must match input depth for filter ${n.shape[2]}.`),D(d===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${d}) must match output depth for filter ${n.shape[3]}.`),Xn("conv2dDerInput",s,i);const f={dy:l,filter:n},h={strides:r,pad:s,dataFormat:o,dimRoundingMode:i,inputShape:a},p=V.runKernel(qm,f,h);return u?B(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const K1=W({conv2DBackpropInput_:EW});function NW(t,e,n,r,s,o){const i=O(t,"x","conv2dTranspose"),a=O(e,"filter","conv2dTranspose");return K1(n,i,a,r,s,"NHWC",o)}const fR=W({conv2dTranspose_:NW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RW(t,e,n,r,s="NDHWC",o=[1,1,1]){const i=O(t,"x","conv3d"),a=O(e,"filter","conv3d");let l=i,u=!1;i.rank===4&&(u=!0,l=B(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),D(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),D(a.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${a.rank}.`),D(l.shape[4]===a.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${a.shape[3]}.`),D(wn(n,o),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),D(s==="NDHWC",()=>`Error in conv3d: got dataFormat of ${s} but only NDHWC is currently supported.`),D(ia(o),()=>"Error in conv3D: Dilated rates should be larger than 0."),D(ia(n),()=>"Error in conv3D: Strides should be larger than 0.");const c={x:l,filter:a},d={strides:n,pad:r,dataFormat:s,dilations:o},f=V.runKernel(Ym,c,d);return u?B(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const DW=W({conv3d_:RW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AW(t,e,n,r,s){D(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let o=t,i=e,a=!1;e.rank===4&&(a=!0,i=B(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),o=[1,t[0],t[1],t[2],t[3]]);const l=o[4],u=i.shape[4];D(o.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${o.length}.`),D(i.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${i.rank}`),D(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),D(l===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[3]}.`),D(u===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${u}) must match output depth for filter ${n.shape[4]}.`);const c={dy:i,filter:n},d={pad:s,strides:r,inputShape:o},f=V.runKernel(c1,c,d);return a?B(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const hR=W({conv3DBackpropInput_:AW});function FW(t,e,n,r,s){const o=O(t,"x","conv3dTranspose"),i=O(e,"filter","conv3dTranspose");return hR(n,o,i,r,s)}const PW=W({conv3dTranspose_:FW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OW(t){const n={x:O(t,"x","cos","float32")};return V.runKernel($d,n)}const X1=W({cos_:OW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LW(t){const n={x:O(t,"x","cosh","float32")};return V.runKernel(Cd,n)}const pR=W({cosh_:LW});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MW(t,e=0,n=!1,r=!1){const o={x:O(t,"x","cumprod")},i={axis:e,exclusive:n,reverse:r};return V.runKernel(d1,o,i)}const Yb=W({cumprod_:MW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _W(t,e=0,n=!1,r=!1){const o={x:O(t,"x","cumsum")},i={axis:e,exclusive:n,reverse:r};return V.runKernel(Qm,o,i)}const mR=W({cumsum_:_W});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zW(t,e,n,r=!1){const s=O(t,"x","denseBincount"),o=O(e,"weights","denseBincount");D(s.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${s.dtype}`),D(s.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${s.rank}.`),D(n>=0,()=>`size must be non-negative, but got ${n}.`),D(o.size===s.size||o.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${s.shape}, weights shape: ${o.shape}.`);const i={x:s,weights:o},a={size:n,binaryOutput:r};return V.runKernel(h1,i,a)}const rS=W({denseBincount_:zW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VW(t,e,n="NHWC"){const r=O(t,"x","depthToSpace","float32"),s=n==="NHWC"?r.shape[1]:r.shape[2],o=n==="NHWC"?r.shape[2]:r.shape[3],i=n==="NHWC"?r.shape[3]:r.shape[1];D(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),D(s*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${s} and ${e}  for depthToSpace with input shape
    ${r.shape}`),D(o*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${o} and ${e} for depthToSpace with input shape
        ${r.shape}`),D(i%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${i} for depthToSpace with input shape ${r.shape}`);const a={x:r},l={blockSize:e,dataFormat:n};return V.runKernel(p1,a,l)}const BW=W({depthToSpace_:VW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WW(t,e,n,r,s="NHWC",o=[1,1],i){const a=O(t,"x","depthwiseConv2d","float32"),l=O(e,"filter","depthwiseConv2d","float32");let u=a,c=!1;a.rank===3&&(c=!0,u=B(a,[1,a.shape[0],a.shape[1],a.shape[2]])),D(u.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${u.rank}.`),D(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const d=s==="NHWC"?u.shape[3]:u.shape[1];D(d===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${d}) must match the inChannels dimension in filter ${l.shape[2]}.`),Xn("depthwiseConv2d",r,i);const f={x:u,filter:l},h={strides:n,pad:r,dataFormat:s,dilations:o,dimRoundingMode:i},p=V.runKernel(Zm,f,h);return c?B(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const q1=W({depthwiseConv2d_:WW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UW(t,e,n,r,s=[1,1],o="NHWC"){const i=O(t,"x","dilation2d"),a=O(e,"filter","dilation2d");D(i.rank===3||i.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${i.rank}.`),D(a.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${a.rank}.`),D(o==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${o}`);let l=i,u=!1;i.rank===3&&(l=B(i,[1,i.shape[0],i.shape[1],i.shape[2]]),u=!0),D(l.shape[3]===a.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${l.shape[3]} vs ${a.shape[2]}`);const c={x:l,filter:a},d={strides:n,pad:r,dilations:s},f=V.runKernel(Jm,c,d);return u?B(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const GW=W({dilation2d_:UW});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ul(t,e){const n=t.length,r=[];for(let s=0;s<n;s++){const o=n-1-s,i=t[o]||1;(e[e.length-1-s]||1)>1&&i===1&&r.unshift(o)}return r}function Yt(t,e){const n=[];for(let r=0;r<e.length;r++){const s=t[t.length-r-1],o=e.length-r-1,i=e[o];(s==null||s===1&&i>1)&&n.unshift(o)}return n}function Se(t,e){const n=Math.max(t.length,e.length),r=new Array(n);for(let s=0;s<n;s++){let o=t[t.length-s-1];o==null&&(o=1);let i=e[e.length-s-1];if(i==null&&(i=1),o===1)r[n-s-1]=i;else if(i===1)r[n-s-1]=o;else if(o!==i){const a=`Operands could not be broadcast together with shapes ${t} and ${e}.`;throw Error(a)}else r[n-s-1]=o}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HW(t,e){let n=O(t,"a","equal","string_or_numeric"),r=O(e,"b","equal","string_or_numeric");[n,r]=Pt(n,r),Se(n.shape,r.shape);const s={a:n,b:r};return V.runKernel(eg,s)}const Us=W({equal_:HW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jW(t,e,n){const r=O(e,"a","where"),s=O(n,"b","where"),o=O(t,"condition","where","bool"),i=Se(Se(o.shape,r.shape),s.shape),a=fc(o,i),l=fc(r,i),u=fc(s,i),c={condition:a,t:l,e:u};return V.runKernel(Rg,c)}const Fn=W({where_:jW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KW(t){const n={x:O(t,"x","zerosLike")};return V.runKernel(_g,n)}const Ve=W({zerosLike_:KW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XW(t,e){let n=O(t,"a","div"),r=O(e,"b","div");[n,r]=Pt(n,r);const s=be(n,r),o=Ve(s),i=Us(r,o);return Fn(i,o,s)}const qW=W({divNoNan_:XW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YW(t,e){const n=O(t,"t1","dot"),r=O(e,"t2","dot");D((n.rank===1||n.rank===2)&&(r.rank===1||r.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${r.rank}.`);const s=n.rank===1?n.size:n.shape[1],o=r.rank===1?r.size:r.shape[0];if(D(s===o,()=>`Error in dot: inner dimensions of inputs must match, but got ${s} and ${o}.`),n.rank===1&&r.rank===1){const i=B(n,[1,-1]),a=B(r,[-1,1]),l=Xe(i,a);return B(l,[])}else if(n.rank===1&&r.rank===2){const i=B(n,[1,-1]),a=B(r,[r.shape[0],r.shape[1]]),l=Xe(i,a);return B(l,[l.size])}else if(n.rank===2&&r.rank===1){const i=B(r,[-1,1]),a=Xe(n,i);return B(a,[a.size])}else{const i=B(r,[r.shape[0],r.shape[1]]);return Xe(n,i)}}const QW=W({dot_:YW});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZW(t,...e){const n=e.map((s,o)=>O(s,`tensors${o}`,"einsum")),r={equation:t};return V.runKernel(v1,n,r)}const Pu=W({einsum_:ZW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JW(t){const n={x:O(t,"x","elu","float32")};return V.runKernel(Sd,n)}const Hg=W({elu_:JW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e6(t){let e=O(t,"x","erf");D(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=ce(e,"float32"));const n={x:e};return V.runKernel(Id,n)}const gR=W({erf_:e6});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y1(t,e){for(let n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function vR(t,e,n){const r=t.length+e.length,s=[];let o=0,i=0;for(let a=0;a<r;a++)n.indexOf(a)===-1?s.push(t[o++]):s.push(e[i++]);return s}function sn(t,e){const n=[],r=t.length;for(let o=0;o<r;o++)e.indexOf(o)===-1&&n.push(t[o]);const s=e.map(o=>t[o]);return[n,s]}function Vt(t,e){const n=e.map(r=>1);return vR(t,n,e)}function fn(t,e,n){D(Y1(e,n),()=>`${t} supports only inner-most axes for now. Got axes ${e} and rank-${n} input.`)}function It(t,e){if(Y1(t,e))return null;const n=[];for(let r=0;r<e;++r)t.indexOf(r)===-1&&n.push(r);return t.forEach(r=>n.push(r)),n}function mi(t){return t.map((e,n)=>[n,e]).sort((e,n)=>e[1]-n[1]).map(e=>e[0])}function Ot(t,e){const n=[];for(let r=e-t;r<e;++r)n.push(r);return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t6(t,e=null,n=!1){const s={x:O(t,"x","max")},o={reductionIndices:e,keepDims:n};return V.runKernel(fg,s,o)}const ms=W({max_:t6});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n6(t,e=null,n=!1){const s={x:O(t,"x","min")},o={axis:e,keepDims:n};return V.runKernel(gg,s,o)}const Np=W({min_:n6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r6(t,e){let n=O(t,"base","pow"),r=O(e,"exp","pow");[n,r]=Pt(n,r);const s={a:n,b:r};return V.runKernel(Wd,s)}const la=W({pow_:r6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qe(t,e){if((qr(t)&&e!=="string"||Array.isArray(t))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&qr(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Bg(t,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s6(t){const n={x:O(t,"x","sqrt","float32")};return V.runKernel(ef,n)}const yn=W({sqrt_:s6});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o6(t){const e=O(t,"x","square"),n={};return V.runKernel("Square",{x:e},n)}const dt=W({square_:o6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i6(t,e=null,n=!1){let r=O(t,"x","sum");r.dtype==="bool"&&(r=ce(r,"int32"));const s={x:r},o={axis:e,keepDims:n};return V.runKernel(Ag,s,o)}const ge=W({sum_:i6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a6(t,e="euclidean",n=null,r=!1){t=O(t,"x","norm");const s=bR(t,e,n);let o=s.shape;if(r){const i=De(n,t.shape);o=Vt(s.shape,i)}return B(s,o)}function bR(t,e,n=null){if(t.rank===0)return En(t);if(t.rank!==1&&n===null)return bR(B(t,[-1]),e,n);if(t.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(e===1)return ge(En(t),n);if(e===1/0)return ms(En(t),n);if(e===-1/0)return Np(En(t),n);if(e==="euclidean"||e===2)return yn(ge(la(En(t),qe(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(n)&&n.length===2){if(e===1)return ms(ge(En(t),n[0]),n[1]-1);if(e===1/0)return ms(ge(En(t),n[1]),n[0]);if(e===-1/0)return Np(ge(En(t),n[1]),n[0]);if(e==="fro"||e==="euclidean")return yn(ge(dt(t),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const jg=W({norm_:a6});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l6(t,e=null,n=!1){return jg(t,"euclidean",e,n)}const u6=W({euclideanNorm_:l6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c6(t){const n={x:O(t,"x","exp")};return V.runKernel(Td,n)}const Gs=W({exp_:c6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d6(t,e=0){const n=O(t,"x","expandDims","string_or_numeric");D(e<=n.rank,()=>"Axis must be <= rank of the tensor");const r={input:n},s={dim:e};return V.runKernel(tg,r,s)}const zn=W({expandDims_:d6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f6(t){const n={x:O(t,"x","expm1")};return V.runKernel(Ed,n)}const h6=W({expm1_:f6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p6(t,e){const n=O(t,"x","tile","string_or_numeric");D(n.rank===e.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${e}.`);const r={x:n},s={reps:e};return V.runKernel(of,r,s)}const ds=W({tile_:p6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m6(t,e,n,r="float32"){e==null&&(e=t);const s=Re([t,e],r),o=t<=e?t:e;for(let a=0;a<o;++a)s.set(1,a,a);const i=B(s.toTensor(),[t,e]);if(n==null)return i;if(n.length===1)return ds(zn(i,0),[n[0],1,1]);if(n.length===2)return ds(zn(zn(i,0),0),[n[0],n[1],1,1]);if(n.length===3)return ds(zn(zn(zn(i,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}const xR=W({eye_:m6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g6(t){const n={x:O(t,"x","floor","float32")};return V.runKernel(Nd,n)}const Kg=W({floor_:g6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v6(t,e,n=0,r=0){const s=O(t,"x","gather"),o=O(e,"indices","gather","int32"),i={x:s,indices:o},a={axis:n,batchDims:r};return V.runKernel(rg,i,a)}const Q1=W({gather_:v6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b6(t,e){let n=O(t,"a","greater","string_or_numeric"),r=O(e,"b","greater","string_or_numeric");[n,r]=Pt(n,r),Se(n.shape,r.shape);const s={a:n,b:r};return V.runKernel(sg,s)}const wr=W({greater_:b6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x6(t,e){let n=O(t,"a","greaterEqual","string_or_numeric"),r=O(e,"b","greaterEqual","string_or_numeric");[n,r]=Pt(n,r),Se(n.shape,r.shape);const s={a:n,b:r};return V.runKernel(Dd,s)}const Ea=W({greaterEqual_:x6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y6(t){const n={input:O(t,"input","imag")};return V.runKernel(C1,n)}const Z1=W({imag_:y6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w6(t){const n={x:O(t,"x","isFinite")};return V.runKernel(Fd,n)}const $6=W({isFinite_:w6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C6(t){const n={x:O(t,"x","isInf")};return V.runKernel(Pd,n)}const k6=W({isInf_:C6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S6(t){const n={x:O(t,"x","isNaN")};return V.runKernel(Od,n)}const I6=W({isNaN_:S6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T6(t,e=.2){const r={x:O(t,"x","leakyRelu")},s={alpha:e};return V.runKernel(og,r,s)}const J1=W({leakyRelu_:T6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E6(t,e){let n=O(t,"a","less","string_or_numeric"),r=O(e,"b","less","string_or_numeric");[n,r]=Pt(n,r),Se(n.shape,r.shape);const s={a:n,b:r};return V.runKernel(ig,s)}const Rp=W({less_:E6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N6(t,e){let n=O(t,"a","lessEqual","string_or_numeric"),r=O(e,"b","lessEqual","string_or_numeric");[n,r]=Pt(n,r),Se(n.shape,r.shape);const s={a:n,b:r};return V.runKernel(ag,s)}const au=W({lessEqual_:N6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R6(t,e=5,n=1,r=1,s=.5){const o=O(t,"x","localResponseNormalization");D(o.rank===4||o.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${o.rank}.`),D(zl(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let i=o,a=!1;o.rank===3&&(a=!0,i=B(o,[1,o.shape[0],o.shape[1],o.shape[2]]));const l={x:i},u={depthRadius:e,bias:n,alpha:r,beta:s},c=V.runKernel(dg,l,u);return a?B(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const D6=W({localResponseNormalization_:R6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A6(t){const n={x:O(t,"x","log","float32")};return V.runKernel(Ld,n)}const Hs=W({log_:A6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F6(t){const n={x:O(t,"x","log1p")};return V.runKernel(Md,n)}const yR=W({log1p_:F6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P6(t,e){D(Pb(t),()=>"The f passed in variableGrads(f) must be a function"),D(e==null||Array.isArray(e)&&e.every(u=>u instanceof Ep),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=e!=null;if(!n){e=[];for(const u in V.registeredVariables)e.push(V.registeredVariables[u])}const r=n?e.filter(u=>!u.trainable):null,s=e.length;e=e.filter(u=>u.trainable),D(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${s} variables is trainable.`);const o=!0,{value:i,grads:a}=V.gradients(t,e,null,o);D(a.some(u=>u!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),D(i.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${i.rank} tensor`);const l={};return e.forEach((u,c)=>{a[c]!=null&&(l[u.name]=a[c])}),r!=null&&r.forEach(u=>l[u.name]=null),{value:i,grads:l}}function Gl(t){return V.customGrad(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O6(t){const n={x:O(t,"x","neg")};return V.runKernel(bg,n)}const Ft=W({neg_:O6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L6(t){const n={x:O(t,"x","softplus")};return V.runKernel(Jd,n)}const uf=W({softplus_:L6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M6(t){const e=O(t,"x","logSigmoid");return Gl(r=>({value:Ft(uf(Ft(r))),gradFunc:i=>_(i,iu(Ft(r)))}))(e)}const _6=W({logSigmoid_:M6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z6(t,e){let n=O(t,"a","sub"),r=O(e,"b","sub");[n,r]=Pt(n,r);const s={a:n,b:r};return V.runKernel(nf,s)}const ye=W({sub_:z6});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V6(t,e=-1){const n=O(t,"logits","logSoftmax");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${e}`);return Gl((s,o)=>{const a=ms(s,e,!0),l=ye(s,a),u=ye(ce(l,"float32"),Hs(ge(Gs(l),e,!0)));return o([u]),{value:u,gradFunc:(d,f)=>{const[h]=f,p=!0,g=Gs(h);return ye(d,_(ge(d,e,p),g))}}})(n)}const wR=W({logSoftmax_:V6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B6(t,e=null,n=!1){const r=O(t,"x","logSumExp"),s=De(e,r.shape),o=ms(r,s,!0),i=ye(r,o),a=Gs(i),l=ge(a,s),u=Hs(l),c=ne(B(o,u.shape),u);if(n){const d=Vt(c.shape,s);return B(c,d)}return c}const $R=W({logSumExp_:B6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W6(t,e){const n=O(t,"a","logicalAnd","bool"),r=O(e,"b","logicalAnd","bool");Se(n.shape,r.shape);const s={a:n,b:r};return V.runKernel(lg,s)}const go=W({logicalAnd_:W6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U6(t){const n={x:O(t,"x","logicalNot","bool")};return V.runKernel(ug,n)}const ew=W({logicalNot_:U6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G6(t,e){const n=O(t,"a","logicalOr","bool"),r=O(e,"b","logicalOr","bool");Se(n.shape,r.shape);const s={a:n,b:r};return V.runKernel(cg,s)}const CR=W({logicalOr_:G6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H6(t,e){const n=O(t,"a","logicalXor","bool"),r=O(e,"b","logicalXor","bool");return Se(n.shape,r.shape),go(CR(t,e),ew(go(t,e)))}const j6=W({logicalXor_:H6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K6(t,e,n,r,s){const o=O(t,"x","maxPool"),i=1;let a=o,l=!1;o.rank===3&&(l=!0,a=B(o,[1,o.shape[0],o.shape[1],o.shape[2]])),D(a.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${a.rank}.`),D(wn(n,i),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),Xn("maxPool",r,s);const u={x:a},c={filterSize:e,strides:n,pad:r,dimRoundingMode:s},d=V.runKernel(hg,u,c);return l?B(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const tw=W({maxPool_:K6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X6(t,e=[1,1,1],n,r,s,o="NDHWC"){const i=O(t,"x","maxPool3d");let a=i,l=!1;i.rank===4&&(l=!0,a=B(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),D(a.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${a.rank}.`),D(o==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${o}`),Xn("maxPool3d",r,s);const u={x:a},c={filterSize:e,strides:n,pad:r,dimRoundingMode:s,dataFormat:o},d=V.runKernel(pg,u,c);return l?B(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const q6=W({maxPool3d_:X6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y6(t,e){let n=O(t,"a","maximum"),r=O(e,"b","maximum");[n,r]=Pt(n,r),n.dtype==="bool"&&(n=ce(n,"int32"),r=ce(r,"int32")),Se(n.shape,r.shape);const s={a:n,b:r};return V.runKernel(_d,s)}const gi=W({maximum_:Y6});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q6(t,e=null,n=!1){const s={x:O(t,"x","mean")},o={axis:e,keepDims:n};return V.runKernel(mg,s,o)}const zt=W({mean_:Q6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ct(t,e="float32"){if(wo(t),e==="complex64"){const r=Ct(t,"float32"),s=Ct(t,"float32");return Wl(r,s)}const n=xn(q(t),e);return V.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ko(t,e="float32"){if(wo(t),e==="complex64"){const r=ko(t,"float32"),s=Ct(t,"float32");return Wl(r,s)}const n=Qy(q(t),e);return V.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z6(t,e){let n=O(t,"a","minimum"),r=O(e,"b","minimum");[n,r]=Pt(n,r),n.dtype==="bool"&&(n=ce(n,"int32"),r=ce(r,"int32")),Se(n.shape,r.shape);const s={a:n,b:r};return V.runKernel(zd,s)}const Hc=W({minimum_:Z6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J6(t,e,n){D(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const r=O(t,"x","mirrorPad");if(r.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");D(e.length===r.rank,()=>`Padding doesn't match input. Must be ${r.rank}. Got ${e.length}.`);const s=n==="reflect"?1:0;for(let a=0;a<r.rank;a++)D(e[a].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),D(e[a][0]>=0&&e[a][0]<=r.shape[a]-s&&e[a][1]>=0&&e[a][1]<=r.shape[a]-s,()=>`Padding in dimension ${a} cannot be greater than or equal to ${r.shape[a]-s} or less than 0 for input of shape ${r.shape}`);const o={paddings:e,mode:n},i={x:r};return V.runKernel(vg,i,o)}const eU=W({mirrorPad_:J6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tU(t,e){let n=O(t,"a","mod"),r=O(e,"b","mod");[n,r]=Pt(n,r);const s={a:n,b:r};return V.runKernel(Vd,s)}const nU=W({mod_:tU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rU(t,e=null,n=!1){t=O(t,"x","moments");const r=De(e,t.shape),s=zt(t,r,n);let o=s.shape;n||(o=Vt(s.shape,r));const i=dt(ye(ce(t,"float32"),B(s,o))),a=zt(i,r,n);return{mean:s,variance:a}}const nw=W({moments_:rU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sU(t,e){let n=O(t,"a","notEqual","string_or_numeric"),r=O(e,"b","notEqual","string_or_numeric");[n,r]=Pt(n,r),Se(n.shape,r.shape);const s={a:n,b:r};return V.runKernel(xg,s)}const Dp=W({notEqual_:sU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oU(t,e,n=1,r=0,s="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const i={indices:O(t,"indices","oneHot","int32")},a={dtype:s,depth:e,onValue:n,offValue:r};return V.runKernel(wg,i,a)}const kR=W({oneHot_:oU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iU(t){const n={x:O(t,"x","onesLike")};return V.runKernel(yg,n)}const Yr=W({onesLike_:iU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aU(t,e,n=0){const r=O(t,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const s={paddings:e,constantValue:n},o={x:r};return V.runKernel(Cg,o,s)}const rw=W({pad_:aU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lU(t,e,n){const r=O(t,"x","spaceToBatchND");D(r.rank>=1+e.length,()=>`input rank ${r.rank} should be > than [blockShape] ${e.length}`),D(n.length===e.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${e.length}`),D(r.shape.reduce((i,a,l)=>l>0&&l<=e.length?i&&(a+n[l-1][0]+n[l-1][1])%e[l-1]===0:i,!0),()=>`input spatial dimensions ${r.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${e.toString()}`);const s={x:r},o={blockShape:e,paddings:n};return V.runKernel(Fg,s,o)}const sw=W({spaceToBatchND_:lU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uU(t,e,n,r,s,o,i){s==null&&(s=[1,1]),o==null&&(o=1),r===0&&(r="valid");const a=O(t,"x","maxPool");let l=a,u=!1;a.rank===3&&(u=!0,l=B(a,[1,a.shape[0],a.shape[1],a.shape[2]])),D(wn(o,s),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${o} and dilations '${s}'`);const c=Zr(l.shape,e,o,s,r),d=[c.dilationHeight,c.dilationWidth];let f;r==="same"?f=dU([c.filterHeight,c.filterWidth],d):f=[[0,0],[0,0]];const h=d[0]===1&&d[1]===1,[p,g]=cU([c.inHeight,c.inWidth],d,f),v=h?r:"valid",m=h?l:sw(l,d,p),x=(n==="avg"?()=>H1(m,e,o,v,i):()=>tw(m,e,o,v,i))(),y=h?x:j1(x,d,g);return u?B(y,[y.shape[1],y.shape[2],y.shape[3]]):y}function cU(t,e,n){const r=n.map(c=>c[0]),s=n.map(c=>c[1]),o=t.concat(r,s),i=e.map((c,d)=>(c-o[d]%c)%c),a=s.map((c,d)=>c+i[d]),l=e.map((c,d)=>[r[d],a[d]]),u=e.map((c,d)=>[0,i[d]]);return[l,u]}function dU(t,e){const r=t.map((i,a)=>i+(i-1)*(e[a]-1)).map(i=>i-1),s=r.map(i=>Math.floor(i/2)),o=r.map((i,a)=>i-s[a]);return r.map((i,a)=>[s[a],o[a]])}const fU=W({pool_:uU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hU(t,e){const n=O(t,"x","prelu"),r=O(e,"alpha","prelu"),s={x:n,alpha:r};return V.runKernel(kg,s)}const ow=W({prelu_:hU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pU(t,e=null,n=!1){let r=O(t,"x","prod");r.dtype==="bool"&&(r=ce(r,"int32"));const s={x:r},o={axis:e,keepDims:n};return V.runKernel(Sg,s,o)}const mU=W({prod_:pU});var iw={exports:{}};iw.exports;(function(t){(function(e,n,r){function s(l){var u=this,c=a();u.next=function(){var d=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=d-(u.c=d|0)},u.c=1,u.s0=c(" "),u.s1=c(" "),u.s2=c(" "),u.s0-=c(l),u.s0<0&&(u.s0+=1),u.s1-=c(l),u.s1<0&&(u.s1+=1),u.s2-=c(l),u.s2<0&&(u.s2+=1),c=null}function o(l,u){return u.c=l.c,u.s0=l.s0,u.s1=l.s1,u.s2=l.s2,u}function i(l,u){var c=new s(l),d=u&&u.state,f=c.next;return f.int32=function(){return c.next()*4294967296|0},f.double=function(){return f()+(f()*2097152|0)*11102230246251565e-32},f.quick=f,d&&(typeof d=="object"&&o(d,c),f.state=function(){return o(c,{})}),f}function a(){var l=4022871197,u=function(c){c=String(c);for(var d=0;d<c.length;d++){l+=c.charCodeAt(d);var f=.02519603282416938*l;l=f>>>0,f-=l,f*=l,l=f>>>0,f-=l,l+=f*4294967296}return(l>>>0)*23283064365386963e-26};return u}n&&n.exports?n.exports=i:this.alea=i})(Ca,t)})(iw);var gU=iw.exports,aw={exports:{}};aw.exports;(function(t){(function(e,n,r){function s(a){var l=this,u="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var d=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^d^d>>>8},a===(a|0)?l.x=a:u+=a;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,l.next()}function o(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l}function i(a,l){var u=new s(a),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var f=u.next()>>>11,h=(u.next()>>>0)/4294967296,p=(f+h)/(1<<21);while(p===0);return p},d.int32=u.next,d.quick=d,c&&(typeof c=="object"&&o(c,u),d.state=function(){return o(u,{})}),d}n&&n.exports?n.exports=i:this.xor128=i})(Ca,t)})(aw);var vU=aw.exports,lw={exports:{}};lw.exports;(function(t){(function(e,n,r){function s(a){var l=this,u="";l.next=function(){var d=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(d^d<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,a===(a|0)?l.x=a:u+=a;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,c==u.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function o(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l.v=a.v,l.d=a.d,l}function i(a,l){var u=new s(a),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var f=u.next()>>>11,h=(u.next()>>>0)/4294967296,p=(f+h)/(1<<21);while(p===0);return p},d.int32=u.next,d.quick=d,c&&(typeof c=="object"&&o(c,u),d.state=function(){return o(u,{})}),d}n&&n.exports?n.exports=i:this.xorwow=i})(Ca,t)})(lw);var bU=lw.exports,uw={exports:{}};uw.exports;(function(t){(function(e,n,r){function s(a){var l=this;l.next=function(){var c=l.x,d=l.i,f,h;return f=c[d],f^=f>>>7,h=f^f<<24,f=c[d+1&7],h^=f^f>>>10,f=c[d+3&7],h^=f^f>>>3,f=c[d+4&7],h^=f^f<<7,f=c[d+7&7],f=f^f<<13,h^=f^f<<9,c[d]=h,l.i=d+1&7,h};function u(c,d){var f,h=[];if(d===(d|0))h[0]=d;else for(d=""+d,f=0;f<d.length;++f)h[f&7]=h[f&7]<<15^d.charCodeAt(f)+h[f+1&7]<<13;for(;h.length<8;)h.push(0);for(f=0;f<8&&h[f]===0;++f);for(f==8?h[7]=-1:h[f],c.x=h,c.i=0,f=256;f>0;--f)c.next()}u(l,a)}function o(a,l){return l.x=a.x.slice(),l.i=a.i,l}function i(a,l){a==null&&(a=+new Date);var u=new s(a),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var f=u.next()>>>11,h=(u.next()>>>0)/4294967296,p=(f+h)/(1<<21);while(p===0);return p},d.int32=u.next,d.quick=d,c&&(c.x&&o(c,u),d.state=function(){return o(u,{})}),d}n&&n.exports?n.exports=i:this.xorshift7=i})(Ca,t)})(uw);var xU=uw.exports,cw={exports:{}};cw.exports;(function(t){(function(e,n,r){function s(a){var l=this;l.next=function(){var c=l.w,d=l.X,f=l.i,h,p;return l.w=c=c+1640531527|0,p=d[f+34&127],h=d[f=f+1&127],p^=p<<13,h^=h<<17,p^=p>>>15,h^=h>>>12,p=d[f]=p^h,l.i=f,p+(c^c>>>16)|0};function u(c,d){var f,h,p,g,v,m=[],b=128;for(d===(d|0)?(h=d,d=null):(d=d+"\0",h=0,b=Math.max(b,d.length)),p=0,g=-32;g<b;++g)d&&(h^=d.charCodeAt((g+32)%d.length)),g===0&&(v=h),h^=h<<10,h^=h>>>15,h^=h<<4,h^=h>>>13,g>=0&&(v=v+1640531527|0,f=m[g&127]^=h+v,p=f==0?p+1:0);for(p>=128&&(m[(d&&d.length||0)&127]=-1),p=127,g=4*128;g>0;--g)h=m[p+34&127],f=m[p=p+1&127],h^=h<<13,f^=f<<17,h^=h>>>15,f^=f>>>12,m[p]=h^f;c.w=v,c.X=m,c.i=p}u(l,a)}function o(a,l){return l.i=a.i,l.w=a.w,l.X=a.X.slice(),l}function i(a,l){a==null&&(a=+new Date);var u=new s(a),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var f=u.next()>>>11,h=(u.next()>>>0)/4294967296,p=(f+h)/(1<<21);while(p===0);return p},d.int32=u.next,d.quick=d,c&&(c.X&&o(c,u),d.state=function(){return o(u,{})}),d}n&&n.exports?n.exports=i:this.xor4096=i})(Ca,t)})(cw);var yU=cw.exports,dw={exports:{}};dw.exports;(function(t){(function(e,n,r){function s(a){var l=this,u="";l.next=function(){var d=l.b,f=l.c,h=l.d,p=l.a;return d=d<<25^d>>>7^f,f=f-h|0,h=h<<24^h>>>8^p,p=p-d|0,l.b=d=d<<20^d>>>12^f,l.c=f=f-h|0,l.d=h<<16^f>>>16^p,l.a=p-d|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,a===Math.floor(a)?(l.a=a/4294967296|0,l.b=a|0):u+=a;for(var c=0;c<u.length+20;c++)l.b^=u.charCodeAt(c)|0,l.next()}function o(a,l){return l.a=a.a,l.b=a.b,l.c=a.c,l.d=a.d,l}function i(a,l){var u=new s(a),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var f=u.next()>>>11,h=(u.next()>>>0)/4294967296,p=(f+h)/(1<<21);while(p===0);return p},d.int32=u.next,d.quick=d,c&&(typeof c=="object"&&o(c,u),d.state=function(){return o(u,{})}),d}n&&n.exports?n.exports=i:this.tychei=i})(Ca,t)})(dw);var wU=dw.exports,SR={exports:{}};const $U={},CU=Object.freeze(Object.defineProperty({__proto__:null,default:$U},Symbol.toStringTag,{value:"Module"})),kU=N_(CU);(function(t){(function(e,n,r){var s=256,o=6,i=52,a="random",l=r.pow(s,o),u=r.pow(2,i),c=u*2,d=s-1,f;function h(y,$,C){var k=[];$=$==!0?{entropy:!0}:$||{};var w=m(v($.entropy?[y,x(n)]:y??b(),3),k),I=new p(k),N=function(){for(var E=I.g(o),R=l,S=0;E<u;)E=(E+S)*s,R*=s,S=I.g(1);for(;E>=c;)E/=2,R/=2,S>>>=1;return(E+S)/R};return N.int32=function(){return I.g(4)|0},N.quick=function(){return I.g(4)/4294967296},N.double=N,m(x(I.S),n),($.pass||C||function(E,R,S,T){return T&&(T.S&&g(T,I),E.state=function(){return g(I,{})}),S?(r[a]=E,R):E})(N,w,"global"in $?$.global:this==r,$.state)}function p(y){var $,C=y.length,k=this,w=0,I=k.i=k.j=0,N=k.S=[];for(C||(y=[C++]);w<s;)N[w]=w++;for(w=0;w<s;w++)N[w]=N[I=d&I+y[w%C]+($=N[w])],N[I]=$;(k.g=function(E){for(var R,S=0,T=k.i,F=k.j,L=k.S;E--;)R=L[T=d&T+1],S=S*s+L[d&(L[T]=L[F=d&F+R])+(L[F]=R)];return k.i=T,k.j=F,S})(s)}function g(y,$){return $.i=y.i,$.j=y.j,$.S=y.S.slice(),$}function v(y,$){var C=[],k=typeof y,w;if($&&k=="object")for(w in y)try{C.push(v(y[w],$-1))}catch{}return C.length?C:k=="string"?y:y+"\0"}function m(y,$){for(var C=y+"",k,w=0;w<C.length;)$[d&w]=d&(k^=$[d&w]*19)+C.charCodeAt(w++);return x($)}function b(){try{var y;return f&&(y=f.randomBytes)?y=y(s):(y=new Uint8Array(s),(e.crypto||e.msCrypto).getRandomValues(y)),x(y)}catch{var $=e.navigator,C=$&&$.plugins;return[+new Date,e,C,e.screen,x(n)]}}function x(y){return String.fromCharCode.apply(0,y)}if(m(r.random(),n),t.exports){t.exports=h;try{f=kU}catch{}}else r["seed"+a]=h})(typeof self<"u"?self:Ca,[],Math)})(SR);var SU=SR.exports,IU=gU,TU=vU,EU=bU,NU=xU,RU=yU,DU=wU,Na=SU;Na.alea=IU;Na.xor128=TU;Na.xorwow=EU;Na.xorshift7=NU;Na.xor4096=RU;Na.tychei=DU;var fw=Na;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class IR{constructor(e,n,r,s,o){this.mean=e,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=s,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const i=o||Math.random();this.random=fw.alea(i.toString())}nextValue(){if(!isNaN(this.nextVal)){const s=this.nextVal;return this.nextVal=NaN,s}let e,n,r=!1;for(;!r;){let s,o,i;do s=2*this.random()-1,o=2*this.random()-1,i=s*s+o*o;while(i>=1||i===0);const a=Math.sqrt(-2*Math.log(i)/i);e=this.mean+this.stdDev*s*a,n=this.mean+this.stdDev*o*a,(!this.truncated||this.isValidTruncated(e))&&(r=!0)}return(!this.truncated||this.isValidTruncated(n))&&(this.nextVal=this.convertValue(n)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class AU{constructor(e=0,n=1,r,s){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=n-e,this.dtype=r,s==null&&(s=Math.random()),typeof s=="number"&&(s=s.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${n} <= 1 and dtype is not float`);this.random=fw.alea(s)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FU(t,e=0,n=1,r,s){if(wo(t),r!=null&&r==="bool")throw new Error(`Unsupported data type ${r}`);const o=new IR(e,n,r,!1,s),i=Re(t,r);for(let a=0;a<i.values.length;a++)i.values[a]=o.nextValue();return i.toTensor()}const PU=W({randomNormal_:FU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OU(t,e=0,n=1,r="float32",s){wo(t);const o=Re(t,r),i=new AU(e,n,null,s);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const cf=W({randomUniform_:OU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jc(t,e,n=1,r="float32"){if(n===0)throw new Error("Cannot have a step of zero");const s={start:t,stop:e,step:n,dtype:r};return V.runKernel(R1,{},s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LU(t){const n={input:O(t,"input","real")};return V.runKernel(D1,n)}const Ap=W({real_:LU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MU(t){const n={x:O(t,"x","reciprocal")};return V.runKernel(Ud,n)}const _U=W({reciprocal_:MU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zU(t){const n={x:O(t,"x","relu")};return V.runKernel(Gd,n)}const Ra=W({relu_:zU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VU(t){const n={x:O(t,"x","relu6")};return V.runKernel(Hd,n)}const TR=W({relu6_:VU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BU(t,e){const r={x:O(t,"x","reverse")},s={dims:e};return V.runKernel(Ng,r,s)}const ua=W({reverse_:BU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WU(t){const n={x:O(t,"x","round")};return V.runKernel(jd,n)}const ER=W({round_:WU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UU(t){const n={x:O(t,"x","rsqrt","float32")};return V.runKernel(Kd,n)}const NR=W({rsqrt_:UU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GU(t){const n={x:O(t,"x","selu")};return V.runKernel(Xd,n)}const RR=W({selu_:GU});function HU(t,e,n,r,s,o=[1,1],i="NHWC"){const a=O(t,"x","separableConv2d"),l=O(e,"depthwiseFilter","separableConv2d"),u=O(n,"pointwiseFilter","separableConv2d");let c=a,d=!1;if(a.rank===3&&(d=!0,c=B(a,[1,a.shape[0],a.shape[1],a.shape[2]])),i==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");D(c.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${c.rank}.`),D(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),D(u.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),D(u.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${u.shape[0]}.`),D(u.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${u.shape[1]}.`);const f=l.shape[2],h=l.shape[3];D(u.shape[2]===f*h,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${f*h}, but got ${u.shape[2]}.`);const p=q1(c,l,r,s,i,o),v=aa(p,u,1,"valid",i);return d?B(v,[v.shape[1],v.shape[2],v.shape[3]]):v}const DR=W({separableConv2d_:HU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jU(t){const n={x:O(t,"x","sign")};return V.runKernel(Qd,n)}const KU=W({sign_:jU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XU(t){const n={x:O(t,"x","sin","float32")};return V.runKernel(qd,n)}const AR=W({sin_:XU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qU(t){const n={x:O(t,"x","sinh")};return V.runKernel(Yd,n)}const FR=W({sinh_:qU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YU(t,e,n){const r=O(t,"x","slice1d");return D(r.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`),at(r,[e],[n])}const hw=W({slice1d_:YU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QU(t,e,n){const r=O(t,"x","slice2d");return D(r.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`),at(r,e,n)}const PR=W({slice2d_:QU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZU(t,e,n){const r=O(t,"x","slice3d");return D(r.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`),at(r,e,n)}const pw=W({slice3d_:ZU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JU(t,e,n){const r=O(t,"x","slice4d");return D(r.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`),at(r,e,n)}const Fp=W({slice4d_:JU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e5(t,e=-1){const n=O(t,"logits","softmax","float32");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${e}`);const r={logits:n},s={dim:e};return V.runKernel(Og,r,s)}const mw=W({softmax_:e5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t5(t){D(t.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${t.dtype}.`);const e={input:t};return V.runKernel(x1,e)}const OR=W({fft_:t5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n5(t){D(t.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${t.dtype}.`);const e={input:t};return V.runKernel($1,e)}const Qb=W({ifft_:n5});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r5(t){const e=t.shape[t.shape.length-1],n=t.size/e;let r;if(e<=2){const s=B(t,[n,e]);r=Qb(s)}else{const s=[n,2*(e-1)],o=B(Ap(t),[n,e]),i=B(Z1(t),[n,e]),a=ua(at(o,[0,1],[n,e-2]),1),l=_(ua(at(i,[0,1],[n,e-2]),1),qe(-1)),u=Un([o,a],1),c=Un([i,l],1),d=B(Wl(u,c),[s[0],s[1]]);r=Qb(d)}if(r=Ap(r),t.rank===3&&t.shape[0]!==0){const s=r,o=t.shape[0];r=B(r,[o,r.shape[0]/o,r.shape[1]]),s.dispose()}return r}const s5=W({irfft_:r5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o5(t,e,n=0){const s={x:O(t,"x","split")},o={numOrSizeSplits:e,axis:n};return V.runKernel(Pg,s,o)}const gr=W({split_:o5});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i5(t,e){D(t.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${t.dtype}`);let n=t.shape[t.shape.length-1];const r=t.size/n;let s;if(e!=null&&e<n){const p=t.shape.map(v=>0),g=t.shape.map(v=>v);g[t.shape.length-1]=e,s=at(t,p,g),n=e}else if(e!=null&&e>n){const p=t.shape.map(g=>g);p[t.shape.length-1]=e-n,s=Un([t,Ct(p)],t.shape.length-1),n=e}else s=t;const o=Ve(s),i=B(Wl(s,o),[r,n]),a=OR(i),l=Math.floor(n/2)+1,u=Ap(a),c=Z1(a),d=gr(u,[l,n-l],u.shape.length-1),f=gr(c,[l,n-l],c.shape.length-1),h=s.shape.slice();return h[s.shape.length-1]=l,B(Wl(d[0],f[0]),h)}const a5=W({rfft_:i5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l5(t,e){let n=O(t,"a","squaredDifference"),r=O(e,"b","squaredDifference");[n,r]=Pt(n,r),Se(n.shape,r.shape);const s={a:n,b:r},o={};return V.runKernel(tf,s,o)}const u5=W({squaredDifference_:l5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c5(t,e){const n=O(t,"x","squeeze","string_or_numeric");return B(n,fi(n.shape,e).newShape)}const df=W({squeeze_:c5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d5(t,e=0){const n=eR(t,"tensors","stack","string_or_numeric");D(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&D(e<=n[0].rank,()=>"Axis must be <= rank of the tensor");const r=n,s={axis:e};return V.runKernel($g,r,s)}const vo=W({stack_:d5});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f5(t,e=0){const r={x:O(t,"x","step")},s={alpha:e};return V.runKernel(af,r,s)}const ff=W({step_:f5});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h5(t,e,n,r,s=0,o=0,i=0,a=0,l=0){const c={x:O(t,"x","stridedSlice","string_or_numeric")},d={begin:e,end:n,strides:r,beginMask:s,endMask:o,ellipsisMask:i,newAxisMask:a,shrinkAxisMask:l};return V.runKernel(L1,c,d)}const p5=W({stridedSlice_:h5});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m5(t){const n={x:O(t,"x","tan","float32")};return V.runKernel(rf,n)}const g5=W({tan_:m5});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function er(t,e){iN(t);const n=Vg(t,e);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Bg(t,null,n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iv(t,e,n){if(iN(t),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const r=Vg(t,n);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Bg(t,e,r,n)}function LR(t,e,n){const r=e.rank>1?e.shape[e.rank-1]:1,s=e.rank>1?e.rank-1:1,o=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${e.shape}, shape: ${t}, sliceDim: ${r}, and batchDim: ${s}.`;if(n.rank<s)throw new Error(o+` update.rank < ${s}. `);if(t.length<r+(n.rank-s))throw new Error(o+` Output shape length < ${r+(n.rank-s)}`);if(n.rank!==s+t.length-r)throw new Error(o+` update.rank != ${s+t.length-r}`);for(let i=0;i<s;++i)if(n.shape[i]!==e.shape[i])throw new Error(o+` updates.shape[${i}] (${n.shape[i]}) != indices.shape[${i}] (${e.shape[i]}).`);for(let i=0;i<n.rank-s;++i)if(n.shape[i+s]!==t[i+r])throw new Error(o+` updates.shape[${i+s}] (${n.shape[i+s]}) != shape[${i+s}] (${t[i+s]})`)}function v5(t,e,n){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(t.size===0)throw new Error(`Updates specified for empty output. updates shape: ${t.shape}`)}LR(n,e,t)}function Da(t,e,n){const r=e.shape.length,s=r>1?e.shape[r-1]:1,o=n.length;let i=1;for(let d=s;d<o;++d)i*=n[d];const a=s<1?1:s,l=q(e.shape)/a,u=[...me(n.slice(0,s)),1],c=q(n);return{sliceRank:s,numUpdates:l,sliceSize:i,strides:u,outputSize:c}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b5(t,e=1,n=!0){const r=O(t,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const s=r.shape[r.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>s)throw new Error(`'k' passed to topk() must be <= the last dimension (${s}) but got ${e}`);const o={x:r},i={k:e,sorted:n},[a,l]=V.runKernel(M1,o,i);return{values:a,indices:l}}const x5=W({topk_:b5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y5(t,e=0,n=1,r,s){if(wo(t),r!=null&&r==="bool")throw new Error("Unsupported data type $ { dtype }");const o=new IR(e,n,r,!0,s),i=Re(t,r);for(let a=0;a<i.values.length;a++)i.values[a]=o.nextValue();return i.toTensor()}const MR=W({truncatedNormal_:y5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w5(t,e=0){const n=O(t,"x","unique","string_or_numeric");D(n.rank>0,()=>"The input tensor must be at least 1D");const r={x:n},s={axis:e},[o,i]=V.runKernel(z1,r,s);return{values:o,indices:i}}const $5=W({unique_:w5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C5(t,e,n){const r=O(t,"x","unsortedSegmentSum"),s=O(e,"segmentIds","unsortedSegmentSum","int32");D(zl(n),()=>"numSegments must be of dtype int");const o={x:r,segmentIds:s},i={numSegments:n};return V.runKernel(Mg,o,i)}const _R=W({unsortedSegmentSum_:C5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k5(t,e=0){const n=O(t,"x","unstack","string_or_numeric");D(e>=-n.shape.length&&e<n.shape.length,()=>`Axis = ${e} is not in [-${n.shape.length}, ${n.shape.length})`);const r={value:n},s={axis:e};return V.runKernel(Lg,r,s)}const ca=W({unstack_:k5});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S5(t,e=!0,n,r){return V.makeVariable(t,e,n,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zR(t,e){const n=[];for(let o=0;o<e.length;o++)e[o]&&n.push(o);const r=Re(t,"int32"),s=Re([n.length,t.length],"int32");for(let o=0;o<n.length;o++){const i=r.indexToLoc(n[o]),a=o*t.length;s.values.set(i,a)}return s.toTensor()}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I5(t,e,n){const r=O(t,"x","transpose");if(e==null&&(e=r.shape.map((i,a)=>a).reverse()),D(r.rank===e.length,()=>`Error in transpose: rank of input ${r.rank} must match length of perm ${e}.`),e.forEach(i=>{D(i>=0&&i<r.rank,()=>`All entries in 'perm' must be between 0 and ${r.rank-1} but got ${e}`)}),r.rank<=1)return r.clone();const s={x:r},o={perm:e};return r.dtype==="complex64"?H(()=>{let i=Ap(r),a=Z1(r);return i=V.runKernel(Il,{x:i},o),a=V.runKernel(Il,{x:a},o),n&&(a=Ft(a)),Wl(i,a)}):V.runKernel(Il,s,o)}const ze=W({transpose_:I5});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T5(t,e){if(e==null)return t.shape.slice();if(Ye(t.shape,e))return e;if(t.shape.length===e.length){const n=[];for(let r=0;r<t.shape.length;r++)e[r]==null&&t.shape[r]!=null?n.push(t.shape[r]):n.push(e[r]);return n}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E5(t,e,n,r){const s=O(t,"x","dropout");if(D(s.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${s.dtype} tensor instead.`),D(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return t instanceof Gt?s.clone():s;const o=T5(s,n),i=1-e,a=be(Kg(ne(cf(o,0,1,"float32",r),i)),i);return _(s,a)}const N5=W({dropout_:E5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R5(t,e,n,r,s,o="NHWC",i){let a=t;t.rank===3&&(a=B(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=B(e,[1,e.shape[0],e.shape[1],e.shape[2]])),D(a.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${a.shape}.`),D(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),D(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);const u=o==="NHWC"?a.shape[3]:a.shape[1],c=o==="NHWC"?l.shape[3]:l.shape[1];D(u===n[2],()=>`Error in conv2dDerFilter: depth of input ${u}) must match input depth in filter (${n[2]}.`),D(c===n[3],()=>`Error in conv2dDerFilter: depth of dy (${c}) must match output depth for filter (${n[3]}).`),Xn("conv2dDerFilter",s,i);const d={x:a,dy:l},f={strides:r,pad:s,dataFormat:o,dimRoundingMode:i,filterShape:n};return V.runKernel(l1,d,f)}const gw=W({conv2DBackpropFilter_:R5});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vw(t,e,n){if(n==null||n==="linear")return t;if(n==="relu")return _(t,ff(e));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function bw(t,e){let n=e;const r=Yt(t.shape,e.shape);return r.length>0&&(n=ge(n,r)),B(n,t.shape)}function xw(t,e,n,r){if(e==="linear")return t;if(e==="relu")return Ra(t);if(e==="elu")return Hg(t);if(e==="relu6")return TR(t);if(e==="prelu")return ow(t,n);if(e==="leakyrelu")return J1(t,r);if(e==="sigmoid")return iu(t);throw new Error(`Unknown fused activation ${e}.`)}const yw=(t,e)=>!(t>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D5({x:t,filter:e,strides:n,pad:r,dataFormat:s="NHWC",dilations:o=[1,1],dimRoundingMode:i,bias:a,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:c}){if(l=l||"linear",yw(V.state.gradientDepth,l)===!1){D(s==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${s} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let C=aa(t,e,n,r,s,o,i);return a!=null&&(C=ne(C,a)),xw(C,l,u,c)}const d=O(t,"x","conv2d","float32"),f=O(e,"filter","conv2d","float32");let h=d,p=!1;d.rank===3&&(p=!0,h=B(d,[1,d.shape[0],d.shape[1],d.shape[2]])),D(h.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${h.rank}.`),D(f.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${f.rank}.`),Xn("fused conv2d",r,i);const g=s==="NHWC"?h.shape[3]:h.shape[1];D(f.shape[2]===g,()=>`Error in conv2d: depth of input (${g}) must match input depth for filter ${f.shape[2]}.`),D(wn(n,o),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`);const v=dn(h.shape,f.shape,n,o,r,i);let m;a!=null&&(m=O(a,"bias","fused conv2d"),[m]=Pt(m,d),s==="NHWC"?Se(v.outShape,m.shape):(D(m.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${m.shape.length}.`),D(m.shape.length===0||m.shape[0]===v.outChannels||m.shape[0]===1,()=>`Error in fused conv2d: bias shape (${m.shape}) is not compatible with the number of output channels (${v.outChannels})`)));let b;if(u!=null){const C=u.shape;if(D(C.length<=1||C.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${C.length}.`),C.length===1)D(C[0]===1||C[0]===v.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${C}) is not compatible with the number of output channels (${v.outChannels}).`);else if(C.length===3)try{Se(C,v.outShape)}catch{const w=`Error in fused conv2d: PReLU activation weights (${C}) is not compatible with the output shape of the conv2d (${v.outShape}).`;throw Error(w)}b=O(u,"prelu weights","fused conv2d")}const x=(C,k)=>{D(s==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${s} but only NHWC is currently supported.`);const[w,I,N,E]=k,R=vw(C,N,l);D(oa(o),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${o}'`);const S=K1(I.shape,R,w,n,r),T=gw(I,R,w.shape,n,r),F=[S,T];if(E!=null){const L=bw(E,R);F.push(L)}return F},y={x:h,filter:f,bias:m,preluActivationWeights:b},$={strides:n,pad:r,dataFormat:s,dilations:o,dimRoundingMode:i,activation:l,leakyreluAlpha:c};return a==null?Gl((k,w,I)=>{let N=V.runKernel(Sp,y,$);return I([w,k,N]),p&&(N=B(N,[N.shape[1],N.shape[2],N.shape[3]])),{value:N,gradFunc:x}})(h,f):Gl((k,w,I,N)=>{let E=V.runKernel(Sp,y,$);return N([w,k,E,I]),p&&(E=B(E,[E.shape[1],E.shape[2],E.shape[3]])),{value:E,gradFunc:x}})(h,f,m)}const A5=W({fusedConv2d_:D5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F5(t,e,n,r,s,o=[1,1],i){let a=t;t.rank===3&&(a=B(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=B(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={x:a,dy:l},c={strides:r,pad:s,dimRoundingMode:i,dilations:o,filterShape:n};return V.runKernel(m1,u,c)}const P5=W({depthwiseConv2dNativeBackpropFilter_:F5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O5(t,e,n,r,s,o=[1,1],i){let a=e,l=!1;e.rank===3&&(l=!0,a=B(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={dy:a,filter:n},c={strides:r,pad:s,dimRoundingMode:i,dilations:o,inputShape:t},d=V.runKernel(g1,u,c);return l?B(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const L5=W({depthwiseConv2dNativeBackpropInput_:O5});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M5({a:t,b:e,transposeA:n=!1,transposeB:r=!1,bias:s,activation:o="linear",preluActivationWeights:i,leakyreluAlpha:a=.2}){if(yw(V.state.gradientDepth,o)===!1){let E=Xe(t,e,n,r);return s!=null&&(E=ne(E,s)),xw(E,o,i,a)}let l=O(t,"a","fused matMul"),u=O(e,"b","fused matMul");[l,u]=Pt(l,u);const c=n?l.shape[l.rank-2]:l.shape[l.rank-1],d=r?u.shape[u.rank-1]:u.shape[u.rank-2],f=n?l.shape[l.rank-1]:l.shape[l.rank-2],h=r?u.shape[u.rank-2]:u.shape[u.rank-1],p=l.shape.slice(0,-2),g=u.shape.slice(0,-2),v=q(p),m=q(g);D(c===d,()=>`Error in fused matMul: inner shapes (${c}) and (${d}) of Tensors with shapes ${l.shape} and ${u.shape} and transposeA=${n} and transposeB=${r} must match.`);const x=Se(l.shape.slice(0,-2),u.shape.slice(0,-2)).concat([f,h]),y=n?B(l,[v,c,f]):B(l,[v,f,c]),$=r?B(u,[m,h,d]):B(u,[m,d,h]);let C;s!=null&&(C=O(s,"bias","fused matMul"),[C]=Pt(C,l),Se(x,C.shape));let k;i!=null&&(k=O(i,"prelu weights","fused matMul"));const w=(E,R)=>{const[S,T,F,L]=R,G=vw(B(E,F.shape),F,o);let P,z;if(!n&&!r?(P=Xe(G,T,!1,!0),z=Xe(S,G,!0,!1)):!n&&r?(P=Xe(G,T,!1,!1),z=Xe(G,S,!0,!1)):n&&!r?(P=Xe(T,G,!1,!0),z=Xe(S,G,!1,!1)):(P=Xe(T,G,!0,!0),z=Xe(G,S,!0,!0)),s!=null){const U=bw(L,G);return[P,z,U]}else return[P,z]},I={a:y,b:$,bias:C,preluActivationWeights:k},N={transposeA:n,transposeB:r,activation:o,leakyreluAlpha:a};return s==null?Gl((R,S,T)=>{const F=V.runKernel(kp,I,N);return T([R,S,F]),{value:B(F,x),gradFunc:w}})(y,$):Gl((R,S,T,F)=>{const L=V.runKernel(kp,I,N);return F([R,S,L,T]),{value:B(L,x),gradFunc:w}})(y,$,C)}const sS=W({fusedMatMul_:M5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _5(t,e,n,r,s="bilinear",o=0){const i=O(t,"image","cropAndResize"),a=O(e,"boxes","cropAndResize","float32"),l=O(n,"boxInd","cropAndResize","int32"),u=a.shape[0];D(i.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${i.rank}.`),D(a.rank===2&&a.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${u},4] but had shape ${a.shape}.`),D(l.rank===1&&l.shape[0]===u,()=>`Error in cropAndResize: boxInd must be have size [${u}] but had shape ${a.shape}.`),D(r.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`),D(r[0]>=1&&r[1]>=1,()=>`cropSize must be atleast [1,1], but was ${r}`),D(s==="bilinear"||s==="nearest",()=>`method must be bilinear or nearest, but was ${s}`);const c={image:i,boxes:a,boxInd:l},d={method:s,extrapolationValue:o,cropSize:r};return V.runKernel(f1,c,d)}const z5=W({cropAndResize_:_5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V5(t){const e=O(t,"image","flipLeftRight","float32");D(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const n={image:e};return V.runKernel(w1,n,{})}const B5=W({flipLeftRight_:V5});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W5(t){const e=O(t,"image","grayscaleToRGB"),n=e.rank-1,r=e.shape[n];D(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),D(r===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`);const s=new Array(e.rank);return s.fill(1,0,n),s[n]=3,ds(e,s)}const U5=W({grayscaleToRGB_:W5});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G5(t){const e=O(t,"image","RGBToGrayscale"),n=e.rank-1,r=e.shape[n];D(e.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${e.rank}.`),D(r===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${r}.`);const s=e.dtype,o=ce(e,"float32"),i=er([.2989,.587,.114]);let a;switch(e.rank){case 2:a=Pu("ij,j->i",o,i);break;case 3:a=Pu("ijk,k->ij",o,i);break;case 4:a=Pu("ijkl,l->ijk",o,i);break;case 5:a=Pu("ijklm,m->ijkl",o,i);break;case 6:a=Pu("ijklmn,n->ijklm",o,i);break;default:throw new Error("Not a valid tensor rank.")}return a=zn(a,-1),ce(a,s)}const H5=W({rgbToGrayscale_:G5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j5(t,e,n=0,r=.5){const s=O(t,"image","rotateWithOffset","float32");D(s.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${s.rank}.`);const o={image:s},i={radians:e,fillValue:n,center:r};return V.runKernel(V1,o,i)}const K5=W({rotateWithOffset_:j5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lu(t,e,n,r,s,o){r==null&&(r=.5),s==null&&(s=Number.NEGATIVE_INFINITY),o==null&&(o=0);const i=t.shape[0];return n=Math.min(n,i),D(0<=r&&r<=1,()=>`iouThreshold must be in [0, 1], but was '${r}'`),D(t.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${t.rank}'`),D(t.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${t.shape[1]}`),D(e.rank===1,()=>"scores must be a 1D tensor"),D(e.shape[0]===i,()=>`scores has incompatible shape with boxes. Expected ${i}, but was ${e.shape[0]}`),D(0<=o&&o<=1,()=>`softNmsSigma must be in [0, 1], but was '${o}'`),{maxOutputSize:n,iouThreshold:r,scoreThreshold:s,softNmsSigma:o}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X5(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY){const o=O(t,"boxes","nonMaxSuppression","float32"),i=O(e,"scores","nonMaxSuppression","float32"),a=lu(o,i,n,r,s);n=a.maxOutputSize,r=a.iouThreshold,s=a.scoreThreshold;const l={maxOutputSize:n,iouThreshold:r,scoreThreshold:s};return V.runKernel(T1,{boxes:o,scores:i},l)}const q5=W({nonMaxSuppression_:X5});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y5(t,e,n){const r=Q5(t,e,n),s=r<0?-(r+1):r;t.splice(s,0,e)}function Q5(t,e,n){return J5(t,e,n||Z5)}function Z5(t,e){return t>e?1:t<e?-1:0}function J5(t,e,n){let r=0,s=t.length,o=0,i=!1;for(;r<s;){o=r+(s-r>>>1);const a=n(e,t[o]);a>0?r=o+1:(s=o,i=!a)}return i?r:-r-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ww(t,e,n,r,s){return kw(t,e,n,r,s,0)}function $w(t,e,n,r,s,o){return kw(t,e,n,r,s,0,!1,o,!0)}function Cw(t,e,n,r,s,o){return kw(t,e,n,r,s,o,!0)}function kw(t,e,n,r,s,o,i=!1,a=!1,l=!1){const u=[];for(let v=0;v<e.length;v++)e[v]>s&&u.push({score:e[v],boxIndex:v,suppressBeginIndex:0});u.sort(oS);const c=o>0?-.5/o:0,d=[],f=[];for(;d.length<n&&u.length>0;){const v=u.pop(),{score:m,boxIndex:b,suppressBeginIndex:x}=v;if(m<s)break;let y=!1;for(let $=d.length-1;$>=x;--$){const C=eG(t,b,d[$]);if(C>=r){y=!0;break}if(v.score=v.score*tG(r,c,C),v.score<=s)break}v.suppressBeginIndex=d.length,y||(v.score===m?(d.push(b),f.push(v.score)):v.score>s&&Y5(u,v,oS))}const h=d.length,p=n-h;a&&p>0&&(d.push(...new Array(p).fill(0)),f.push(...new Array(p).fill(0)));const g={selectedIndices:d};return i&&(g.selectedScores=f),l&&(g.validOutputs=h),g}function eG(t,e,n){const r=t.subarray(e*4,e*4+4),s=t.subarray(n*4,n*4+4),o=Math.min(r[0],r[2]),i=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]),u=Math.min(s[0],s[2]),c=Math.min(s[1],s[3]),d=Math.max(s[0],s[2]),f=Math.max(s[1],s[3]),h=(a-o)*(l-i),p=(d-u)*(f-c);if(h<=0||p<=0)return 0;const g=Math.max(o,u),v=Math.max(i,c),m=Math.min(a,d),b=Math.min(l,f),x=Math.max(m-g,0)*Math.max(b-v,0);return x/(h+p-x)}function tG(t,e,n){const r=Math.exp(e*n*n);return n<=t?r:0}function oS(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function nG(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY){const o=O(t,"boxes","nonMaxSuppressionAsync"),i=O(e,"scores","nonMaxSuppressionAsync"),a=lu(o,i,n,r,s);n=a.maxOutputSize,r=a.iouThreshold,s=a.scoreThreshold;const l=await Promise.all([o.data(),i.data()]),u=l[0],c=l[1],{selectedIndices:d}=ww(u,c,n,r,s);return o!==t&&o.dispose(),i!==e&&i.dispose(),er(d,"int32")}const rG=nG;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sG(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,o=0){const i=O(t,"boxes","nonMaxSuppression"),a=O(e,"scores","nonMaxSuppression"),l=lu(i,a,n,r,s,o);n=l.maxOutputSize,r=l.iouThreshold,s=l.scoreThreshold,o=l.softNmsSigma;const u={boxes:i,scores:a},c={maxOutputSize:n,iouThreshold:r,scoreThreshold:s,softNmsSigma:o},d=V.runKernel(N1,u,c);return{selectedIndices:d[0],selectedScores:d[1]}}const oG=W({nonMaxSuppressionWithScore_:sG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function iG(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,o=0){const i=O(t,"boxes","nonMaxSuppressionAsync"),a=O(e,"scores","nonMaxSuppressionAsync"),l=lu(i,a,n,r,s,o);n=l.maxOutputSize,r=l.iouThreshold,s=l.scoreThreshold,o=l.softNmsSigma;const u=await Promise.all([i.data(),a.data()]),c=u[0],d=u[1],{selectedIndices:f,selectedScores:h}=Cw(c,d,n,r,s,o);return i!==t&&i.dispose(),a!==e&&a.dispose(),{selectedIndices:er(f,"int32"),selectedScores:er(h)}}const aG=iG;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lG(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,o=!1){const i=O(t,"boxes","nonMaxSuppression"),a=O(e,"scores","nonMaxSuppression"),l=lu(i,a,n,r,s,null),u=l.maxOutputSize,c=l.iouThreshold,d=l.scoreThreshold,f={boxes:i,scores:a},h={maxOutputSize:u,iouThreshold:c,scoreThreshold:d,padToMaxOutputSize:o},p=V.runKernel(E1,f,h);return{selectedIndices:p[0],validOutputs:p[1]}}const uG=W({nonMaxSuppressionPadded_:lG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function cG(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,o=!1){const i=O(t,"boxes","nonMaxSuppressionAsync"),a=O(e,"scores","nonMaxSuppressionAsync"),l=lu(i,a,n,r,s,null),u=l.maxOutputSize,c=l.iouThreshold,d=l.scoreThreshold,[f,h]=await Promise.all([i.data(),a.data()]),{selectedIndices:p,validOutputs:g}=$w(f,h,u,c,d,o);return i!==t&&i.dispose(),a!==e&&a.dispose(),{selectedIndices:er(p,"int32"),validOutputs:qe(g,"int32")}}const dG=cG;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fG(t,e,n=!1,r=!1){const s=O(t,"images","resizeBilinear");D(s.rank===3||s.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${s.rank}.`),D(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),D(r===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let o=s,i=!1;s.rank===3&&(i=!0,o=B(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const a={images:o},l={alignCorners:n,halfPixelCenters:r,size:e},u=V.runKernel(Eg,a,l);return i?B(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const VR=W({resizeBilinear_:fG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hG(t,e,n=!1,r=!1){const s=O(t,"images","resizeNearestNeighbor");D(s.rank===3||s.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${s.rank}.`),D(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),D(s.dtype==="float32"||s.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),D(r===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let o=s,i=!1;s.rank===3&&(i=!0,o=B(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const a={images:o},l={alignCorners:n,halfPixelCenters:r,size:e},u=V.runKernel(Tg,a,l);return i?B(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const BR=W({resizeNearestNeighbor_:hG});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pG(t,e="binary",n=!1,r=.5){const s=O(t,"image","threshold"),o=.2989,i=.587,a=.114,l=s.shape[0]*s.shape[1];let u=_(er([r]),255),c,d,f,h;if(D(s.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${s.rank}.`),D(s.shape[2]===3||s.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${s.shape[2]}.`),D(s.dtype==="int32"||s.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${s.dtype}.`),D(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),s.shape[2]===3){[c,d,f]=gr(s,[1,1,1],-1);const v=_(c,o),m=_(d,i),b=_(f,a);h=ne(ne(v,m),b)}else h=t;if(e==="otsu"){const v=hW(ce(ER(h),"int32"),Er([]),256);u=mG(v,l)}const p=n?au(h,u):wr(h,u);return ce(_(p,255),"int32")}function mG(t,e){let n=er([-1]),r=er([0]),s=er([0]),o,i,a,l,u,c;for(let d=0;d<t.size-1;d++){o=at(t,0,d+1),i=at(t,d+1),u=be(ge(o),e),c=be(ge(i),e);const f=ge(_(o,jc(0,o.size)));a=be(f,ge(o));const h=Gg(i.shape,o.size),p=ne(jc(0,i.size),h),g=_(i,p);l=be(ge(g),ge(i));const v=ye(a,l),m=ye(a,l),b=_(u,c);s=_(_(b,v),m);const x=wr(s,r);r=Fn(x,s,r),n=Fn(x,er([d]),n)}return n}const gG=W({threshold_:pG});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vG(t,e,n="nearest",r="constant",s=0,o){const i=O(t,"image","transform","float32"),a=O(e,"transforms","transform","float32");D(i.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${i.rank}.`),D(a.rank===2&&(a.shape[0]===i.shape[0]||a.shape[0]===1)&&a.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),D(o==null||o.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${o}.`);const l={image:i,transforms:a},u={interpolation:n,fillMode:r,fillValue:s,outputShape:o};return V.runKernel(_1,l,u)}const bG=W({transform_:vG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xG(t,e,n){const r=O(t,"a","bandPart");D(r.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`);const s=r.shape,[o,i]=r.shape.slice(-2);let a,l;typeof e=="number"?(D(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),D(e<=o,()=>`bandPart(): numLower (${e}) must not be greater than the number of rows (${o}).`),a=O(e<0?o:e,"numLower","bandPart")):(D(e.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),a=Fn(Rp(e,0),o,Hc(e,o))),typeof n=="number"?(D(n%1===0,()=>`bandPart(): numUpper must be an integer, got ${n}.`),D(n<=i,()=>`bandPart(): numUpper (${n}) must not be greater than the number of columns (${i}).`),l=O(n<0?i:n,"numUpper","bandPart")):(D(n.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),l=Fn(Rp(n,0),i,Hc(n,i)));const u=B(jc(0,o,1,"int32"),[-1,1]),c=jc(0,i,1,"int32"),d=ye(u,c),f=go(au(d,a),Ea(d,Ft(l))),h=Ct([o,i],r.dtype);return B(vo(ca(B(r,[-1,o,i])).map(p=>Fn(f,p,h))),s)}const yG=W({bandPart_:xG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wG(t){let e;if(Array.isArray(t)){e=!1,D(t!=null&&t.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const s=t[0].shape[0];for(let o=1;o<t.length;++o)D(t[o].shape[0]===s,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${t[o].shape[0]} vs. ${s})`)}else e=!0,t=gr(t,t.shape[0],0).map(s=>df(s,[0]));D(t.length<=t[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${t.length}) exceeds number of dimensions (${t[0].shape[0]}).`);const n=[],r=t;for(let s=0;s<t.length;++s)n.push(V.tidy(()=>{let o=r[s];if(s>0)for(let i=0;i<s;++i){const a=_(ge(_(n[i],o)),n[i]);o=ye(o,a)}return be(o,jg(o,"euclidean"))}));return e?vo(n,0):n}const $G=W({gramSchmidt_:wG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CG(t,e=!1){if(D(t.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${t.rank}`),t.rank===2)return iS(t,e);{const n=t.shape.slice(0,t.shape.length-2).reduce((l,u)=>l*u),r=ca(B(t,[n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),s=[],o=[];r.forEach(l=>{const[u,c]=iS(l,e);s.push(u),o.push(c)});const i=B(vo(s,0),t.shape),a=B(vo(o,0),t.shape);return[i,a]}}function iS(t,e=!1){return V.tidy(()=>{D(t.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${t.shape.length}D Tensor.`);const n=t.shape[0],r=t.shape[1];let s=xR(n),o=Hi(t);const i=iv([[1]],[1,1]);let a=Hi(i);const l=n>=r?r:n;for(let u=0;u<l;++u){const c=o,d=a,f=s;[a,o,s]=V.tidy(()=>{const h=at(o,[u,u],[n-u,1]),p=jg(h),g=at(o,[u,u],[1,1]),v=Fn(wr(g,0),iv([[-1]]),iv([[1]])),m=ye(g,_(v,p)),b=be(h,m);b.shape[0]===1?a=Hi(i):a=Un([i,at(b,[1,0],[b.shape[0]-1,b.shape[1]])],0);const x=Ft(be(Xe(v,m),p)),y=at(o,[u,0],[n-u,r]),$=_(x,a),C=ze(a);if(u===0)o=ye(y,Xe($,Xe(C,y)));else{const I=ye(y,Xe($,Xe(C,y)));o=Un([at(o,[0,0],[u,r]),I],0)}const k=ze($),w=at(s,[0,u],[n,s.shape[1]-u]);if(u===0)s=ye(w,Xe(Xe(w,a),k));else{const I=ye(w,Xe(Xe(w,a),k));s=Un([at(s,[0,0],[n,u]),I],1)}return[a,o,s]}),Fe([c,d,f])}return!e&&n>r&&(s=at(s,[0,0],[n,r]),o=at(o,[0,0],[r,r])),[s,o]})}const kG=W({qr_:CG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const io={flipLeftRight:B5,grayscaleToRGB:U5,resizeNearestNeighbor:BR,resizeBilinear:VR,rgbToGrayscale:H5,rotateWithOffset:K5,cropAndResize:z5,nonMaxSuppression:q5,nonMaxSuppressionAsync:rG,nonMaxSuppressionWithScore:oG,nonMaxSuppressionWithScoreAsync:aG,nonMaxSuppressionPadded:uG,nonMaxSuppressionPaddedAsync:dG,threshold:gG,transform:bG},SG={bandPart:yG,gramSchmidt:$G,qr:kG};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IG=new Map,TG=new Map;class uu{getClassName(){return this.constructor.className}static fromConfig(e,n){return new e(n)}}class zr{constructor(){this.classNameMap={}}static getMap(){return zr.instance==null&&(zr.instance=new zr),zr.instance}static register(e){zr.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function ee(t,e,n){D(t.className!=null,()=>"Class being registered does not have the static className property defined."),D(typeof t.className=="string",()=>"className is required to be a string, but got type "+typeof t.className),D(t.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof e>"u"&&(e="Custom"),typeof n>"u"&&(n=t.className);const r=n,s=e+">"+r;return zr.register(t),IG.set(s,t),TG.set(t,s),t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vi extends uu{minimize(e,n=!1,r){const{value:s,grads:o}=this.computeGradients(e,r);if(r!=null){const i=r.map(a=>({name:a.name,tensor:o[a.name]}));this.applyGradients(i)}else this.applyGradients(o);return Fe(o),n?s:(s.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,n){return P6(e,n)}dispose(){this.iterations_!=null&&Fe(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:qe(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(vi,Symbol.hasInstance,{value:t=>t.minimize!=null&&t.computeGradients!=null&&t.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class WR extends vi{static get className(){return"Adadelta"}constructor(e,n,r=null){super(),this.learningRate=e,this.rho=n,this.epsilon=r,this.accumulatedGrads=[],this.accumulatedUpdates=[],r==null&&(this.epsilon=V.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const o=V.registeredVariables[r],i=!1;this.accumulatedGrads[s]==null&&(this.accumulatedGrads[s]={originalName:`${r}/accum_grad`,variable:H(()=>Ve(o).variable(i))}),this.accumulatedUpdates[s]==null&&(this.accumulatedUpdates[s]={originalName:`${r}/accum_var`,variable:H(()=>Ve(o).variable(i))});const a=Array.isArray(e)?e[s].tensor:e[r];if(a==null)return;const l=this.accumulatedGrads[s].variable,u=this.accumulatedUpdates[s].variable;H(()=>{const c=ne(_(l,this.rho),_(dt(a),1-this.rho)),d=_(be(yn(ne(u,this.epsilon)),yn(ne(l,this.epsilon))),a),f=ne(_(u,this.rho),_(dt(d),1-this.rho));l.assign(c),u.assign(f);const h=ne(_(d,-this.learningRate),o);o.assign(h)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(Fe(this.accumulatedGrads.map(e=>e.variable)),Fe(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=e.length/2,r=!1;this.accumulatedGrads=e.slice(0,n).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedUpdates=e.slice(n,n*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.rho,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class UR extends vi{static get className(){return"Adagrad"}constructor(e,n=.1){super(),this.learningRate=e,this.initialAccumulatorValue=n,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const o=V.registeredVariables[r];this.accumulatedGrads[s]==null&&(this.accumulatedGrads[s]={originalName:`${r}/accumulator`,variable:H(()=>Gg(o.shape,this.initialAccumulatorValue).variable(!1))});const i=Array.isArray(e)?e[s].tensor:e[r];if(i==null)return;const a=this.accumulatedGrads[s].variable;H(()=>{const l=ne(a,dt(i));a.assign(l);const u=ne(_(be(i,yn(ne(l,V.backend.epsilon()))),-this.learningRate),o);o.assign(u)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&Fe(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulatedGrads=e.map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,n){return new e(n.learningRate,n.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class GR extends vi{static get className(){return"Adam"}constructor(e,n,r,s=null){super(),this.learningRate=e,this.beta1=n,this.beta2=r,this.epsilon=s,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],H(()=>{this.accBeta1=qe(n).variable(),this.accBeta2=qe(r).variable()}),s==null&&(this.epsilon=V.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);H(()=>{const r=ye(1,this.accBeta1),s=ye(1,this.accBeta2);n.forEach((o,i)=>{const a=V.registeredVariables[o],l=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:`${o}/m`,variable:H(()=>Ve(a).variable(l))}),this.accumulatedSecondMoment[i]==null&&(this.accumulatedSecondMoment[i]={originalName:`${o}/v`,variable:H(()=>Ve(a).variable(l))});const u=Array.isArray(e)?e[i].tensor:e[o];if(u==null)return;const c=this.accumulatedFirstMoment[i].variable,d=this.accumulatedSecondMoment[i].variable,f=ne(_(c,this.beta1),_(u,1-this.beta1)),h=ne(_(d,this.beta2),_(dt(u),1-this.beta2)),p=be(f,r),g=be(h,s);c.assign(f),d.assign(h);const v=ne(_(be(p,ne(yn(g),this.epsilon)),-this.learningRate),a);a.assign(v)}),this.accBeta1.assign(_(this.accBeta1,this.beta1)),this.accBeta2.assign(_(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Fe(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&Fe(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e),H(()=>{this.accBeta1.assign(la(this.beta1,this.iterations_+1)),this.accBeta2.assign(la(this.beta2,this.iterations_+1))});const n=e.length/2,r=!1;this.accumulatedFirstMoment=e.slice(0,n).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedSecondMoment=e.slice(n,n*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class HR extends vi{static get className(){return"Adamax"}constructor(e,n,r,s=null,o=0){super(),this.learningRate=e,this.beta1=n,this.beta2=r,this.epsilon=s,this.decay=o,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],H(()=>{this.iteration=qe(0).variable(),this.accBeta1=qe(n).variable()}),s==null&&(this.epsilon=V.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);H(()=>{const r=ye(1,this.accBeta1),s=be(-this.learningRate,ne(_(this.iteration,this.decay),1));n.forEach((o,i)=>{const a=V.registeredVariables[o],l=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:`${o}/m`,variable:Ve(a).variable(l)}),this.accumulatedWeightedInfNorm[i]==null&&(this.accumulatedWeightedInfNorm[i]={originalName:`${o}/v`,variable:Ve(a).variable(l)});const u=Array.isArray(e)?e[i].tensor:e[o];if(u==null)return;const c=this.accumulatedFirstMoment[i].variable,d=this.accumulatedWeightedInfNorm[i].variable,f=ne(_(c,this.beta1),_(u,1-this.beta1)),h=_(d,this.beta2),p=En(u),g=gi(h,p);c.assign(f),d.assign(g);const v=ne(_(be(s,r),be(f,ne(g,this.epsilon))),a);a.assign(v)}),this.iteration.assign(ne(this.iteration,1)),this.accBeta1.assign(_(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Fe(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&Fe(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Sw extends vi{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const o=Array.isArray(e)?e[s].tensor:e[r];if(o==null)return;const i=V.registeredVariables[r];H(()=>{const a=ne(_(this.c,o),i);i.assign(a)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=_s(qe(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,n){return new e(n.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jR extends Sw{static get className(){return"Momentum"}constructor(e,n,r=!1){super(e),this.learningRate=e,this.momentum=n,this.useNesterov=r,this.accumulations=[],this.m=qe(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const o=V.registeredVariables[r];this.accumulations[s]==null&&(this.accumulations[s]={originalName:`${r}/momentum`,variable:H(()=>Ve(o).variable(!1))});const i=this.accumulations[s].variable,a=Array.isArray(e)?e[s].tensor:e[r];a!=null&&H(()=>{let l;const u=ne(_(this.m,i),a);this.useNesterov?l=ne(_(this.c,ne(a,_(u,this.m))),o):l=ne(_(this.c,u),o),i.assign(u),o.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&Fe(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulations=e.map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,n){return new e(n.learningRate,n.momentum,n.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class KR extends vi{static get className(){return"RMSProp"}constructor(e,n=.9,r=0,s=null,o=!1){if(super(),this.learningRate=e,this.decay=n,this.momentum=r,this.epsilon=s,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=o,s==null&&(this.epsilon=V.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const o=V.registeredVariables[r],i=!1;this.accumulatedMeanSquares[s]==null&&(this.accumulatedMeanSquares[s]={originalName:`${r}/rms`,variable:H(()=>Ve(o).variable(i))}),this.accumulatedMoments[s]==null&&(this.accumulatedMoments[s]={originalName:`${r}/momentum`,variable:H(()=>Ve(o).variable(i))}),this.accumulatedMeanGrads[s]==null&&this.centered&&(this.accumulatedMeanGrads[s]={originalName:`${r}/mg`,variable:H(()=>Ve(o).variable(i))});const a=Array.isArray(e)?e[s].tensor:e[r];if(a==null)return;const l=this.accumulatedMeanSquares[s].variable,u=this.accumulatedMoments[s].variable;H(()=>{const c=ne(_(l,this.decay),_(dt(a),1-this.decay));if(this.centered){const d=this.accumulatedMeanGrads[s].variable,f=ne(_(d,this.decay),_(a,1-this.decay)),h=be(_(a,this.learningRate),yn(ye(c,ne(dt(f),this.epsilon)))),p=ne(_(u,this.momentum),h);l.assign(c),d.assign(f),u.assign(p);const g=ye(o,p);o.assign(g)}else{const d=ne(_(l,this.decay),_(dt(a),1-this.decay)),f=ne(_(u,this.momentum),be(_(a,this.learningRate),yn(ne(d,this.epsilon))));l.assign(d),u.assign(f);const h=ye(o,f);o.assign(h)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&Fe(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&Fe(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&Fe(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=this.centered?e.length/3:e.length/2,r=!1;this.accumulatedMeanSquares=e.slice(0,n).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedMoments=e.slice(n,n*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.centered&&(this.accumulatedMeanGrads=e.slice(n*2,n*3).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,n){return new e(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EG=[WR,UR,GR,HR,jR,KR,Sw];function NG(){for(const t of EG)ee(t)}function Iw(t,e){const n=t.shape.length,r=e.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(r<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[r-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[r-1]} vs. ${n}`);if(q(t.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${t.shape}.`);const s=e.shape,o=s[s.length-1];let i=1;for(let d=0;d<s.length-1;++d)i*=s[d];const a=t.shape,l=s.slice();l.pop();let u=1;for(let d=o;d<n;++d)u*=a[d],l.push(a[d]);const c=[...me(t.shape).map(d=>d/u),1].slice(0,o);return[l,i,u,c]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zb=-2,RG=-1;function Tw(t,e,n){const r=t.shape.length;D(r===e.length,()=>`Error in slice${r}D: Length of begin ${e} must match the rank of the array (${r}).`),D(r===n.length,()=>`Error in slice${r}D: Length of size ${n} must match the rank of the array (${r}).`);for(let s=0;s<r;++s)D(e[s]+n[s]<=t.shape[s],()=>`Error in slice${r}D: begin[${s}] + size[${s}] (${e[s]+n[s]}) would overflow input.shape[${s}] (${t.shape[s]})`)}function DG(t){const e=[];let n=0;for(;t>0;)t&1&&e.push(n),t/=2,n++;return e}function Ew(t,e,n){const r=[];for(let s=0;s<t.length;s++)r[s]=Math.ceil((e[s]-t[s])/n[s]);return r}function XR(t,e,n,r){const s=[...t];for(let o=s.length;o<r.length;o++)s.push(1);for(let o=0;o<n;o++)o===0?s[e]=1:(s.splice(e,0,1),s.pop());return s}function qR(t,e,n){return n<=t?n:n-(e-1)}function YR(t,e){const n=[];for(let r=0;r<t;r++)n.push(e+r);return n}function AG(t,e,n,r,s,o,i,a,l){const u=t.length;let c=new Array(u),d=new Array(u),f=new Array(u);if(e.length&&n>0){const h=e[0],p=n+1;c=QR(i,h,p,r,t),d=ZR(a,h,p,s,t),f=XR(o,h,p,t)}else for(let h=0;h<u;h++)c[h]=eD(i,r,o,t,h,l),d[h]=tD(a,s,o,t,h,l),f[h]=JR(o,h,l);return{begin:c,end:d,strides:f}}function QR(t,e,n,r,s){const o=[...s],i=YR(n,e);for(let a=0;a<o.length;a++)if(i.indexOf(a)>-1)o[a]=0;else{const l=qR(e,n,a);let u=r[l];t&1<<l&&(u=0),o[a]=u}return o}function ZR(t,e,n,r,s){const o=[...s],i=YR(n,e);for(let a=0;a<o.length;a++)if(i.indexOf(a)>-1)o[a]=Number.MAX_SAFE_INTEGER;else{const l=qR(e,n,a);let u=r[l];t&1<<l&&(u=Number.MAX_SAFE_INTEGER),o[a]=u}for(let a=0;a<o.length;a++){const l=s[a];o[a]<0&&(o[a]+=l),o[a]=ta(0,o[a],s[a])}return o}function JR(t,e,n){let r=t[e];return(n&1<<e||r==null)&&(r=1),r}function eD(t,e,n,r,s,o){let i=e[s];const a=n[s]||1;(t&1<<s||o&1<<s||i==null)&&(a>0?i=Number.MIN_SAFE_INTEGER:i=Number.MAX_SAFE_INTEGER);const l=r[s];return i<0&&(i+=l),i=ta(0,i,l-1),i}function tD(t,e,n,r,s,o){let i=e[s];const a=n[s]||1;(t&1<<s||o&1<<s||i==null)&&(a>0?i=Number.MAX_SAFE_INTEGER:i=Number.MIN_SAFE_INTEGER);const l=r[s];return i<0&&(i+=l),a>0?i=ta(0,i,l):i=ta(-1,i,l-1),i}function Nw(t,e,n){let r=n.length;for(let s=0;s<n.length;s++)if(n[s]>1){r=s;break}for(let s=r+1;s<n.length;s++)if(e[s]>0||n[s]!==t[s])return!1;return!0}function Rw(t,e){let n=t.length>0?t[t.length-1]:1;for(let r=0;r<t.length-1;r++)n+=t[r]*e[r];return n}function Xg(t,e,n){let r;const s=t.shape.length;typeof e=="number"?r=[e,...new Array(s-1).fill(0)]:e.length<s?r=e.concat(new Array(s-e.length).fill(0)):r=e.slice(),r.forEach(i=>{D(i!==-1,()=>"slice() does not support negative begin indexing.")});let o;return n==null?o=new Array(s).fill(-1):typeof n=="number"?o=[n,...new Array(s-1).fill(-1)]:n.length<s?o=n.concat(new Array(s-n.length).fill(-1)):o=n,o=o.map((i,a)=>i>=0?i:(D(i===-1,()=>`Negative size values should be exactly -1 but got ${i} for the slice() size at index ${a}.`),t.shape[a]-r[a])),[r,o]}function Dw(t,e,n,r,s,o,i,a,l){let u;if(r==null?(u=new Array(e.length),u.fill(1)):u=r,i!=null&&i&i-1)throw new Error("Multiple ellipses in slice is not allowed.");let c=!1;const d={dims:u.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:n.slice(),strides:u.slice(),beginMask:s,endMask:o,ellipsisMask:i,newAxisMask:a,shrinkAxisMask:l};for(let x=0;x<d.dims;x++)c&&1<<x&a&&d.numAddAxisAfterEllipsis++,1<<x&i&&(c=!0);c||(d.ellipsisMask|=1<<d.dims,d.dims++);const f={dims:t.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};FG(d,f);let h=!0,p=!0,g=!0;const v=[],m=[];for(let x=0;x<t.length;++x){if(f.strides[x]===0)throw Error(`strides[${x}] must be non-zero`);const y=!!(f.shrinkAxisMask&1<<x),$=t[x];if($===-1){v.push(y?1:-1);continue}const C=[f.beginMask&1<<x,f.endMask&1<<x],k=[f.strides[x]>0?0:-1,f.strides[x]>0?$:$-1];if(y&&f.strides[x]<=0)throw Error("only stride 1 allowed on non-range indexing.");g=g&&f.strides[x]===1;const w=!!(f.beginMask&1<<x&&f.endMask&1<<x);if(f.beginValid&&f.endValid){if(y){const R=f.begin[x]<0?$+f.begin[x]:f.begin[x];if(f.begin[x]=R,f.end[x]=f.begin[x]+1,R<0||R>=$)throw Error(`slice index ${f.begin[x]} of dimension ${x} out of bounds.`)}else f.begin[x]=aS(f.begin[x],0,f.strides[x],$,C,k),f.end[x]=aS(f.end[x],1,f.strides[x],$,C,k);const E=f.strides[x]===1&&f.begin[x]===0&&f.end[x]===$;h=h&&E,p=p&&(x===0&&f.strides[x]===1||E)}else h=h&&f.strides[x]===1&&w,p=p&&(x===0&&f.strides[x]===1||w);let I,N=!1;if(f.beginValid&&f.endValid?(I=f.end[x]-f.begin[x],N=!0):y?(I=1,N=!0):w&&$>=0&&(f.strides[x]<0?I=-$:I=$,N=!0),N){let E;I===0||I<0!=f.strides[x]<0?E=0:E=Math.trunc(I/f.strides[x])+(I%f.strides[x]!==0?1:0),v.push(E)}else v.push(-1)}for(let x=0;x<f.finalShapeGatherIndices.length;++x){const y=f.finalShapeGatherIndices[x];y>=0?m.push(v[y]):y===Zb&&m.push(1)}return{finalShapeSparse:m.filter((x,y)=>f.finalShapeGatherIndices[y]!==Zb),finalShape:m,isIdentity:h,sliceDim0:p,isSimpleSlice:g,begin:f.begin,end:f.end,strides:f.strides}}function FG(t,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let n=0;e.beginValid=t.begin!=null,e.endValid=t.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let r=0;r<t.dims;r++)if(1<<r&t.ellipsisMask){const s=Math.min(e.dims-(t.dims-r)+1+t.numAddAxisAfterEllipsis,e.dims);for(;n<s;n++)e.begin[n]=0,e.end[n]=0,e.strides[n]=1,e.beginMask|=1<<n,e.endMask|=1<<n,e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[n]=r}else if(1<<r&t.newAxisMask)e.finalShapeGatherIndices.push(Zb),e.finalShapeGatherIndicesSparse.push(-1);else{if(n===e.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${e.dims} dims, ${e.begin.length}.`);t.begin!=null&&(e.begin[n]=t.begin[r]),t.end!=null&&(e.end[n]=t.end[r]),e.strides[n]=t.strides[r],t.beginMask&1<<r&&(e.beginMask|=1<<n),t.endMask&1<<r&&(e.endMask|=1<<n),t.shrinkAxisMask&1<<r?(e.finalShapeGatherIndices.push(RG),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<n):(e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(r)),e.inputShapeGatherIndicesSparse[n]=r,n++}}function aS(t,e,n,r,s,o){if(s[e])return n>0?o[e]:o[e+1&1];{const i=t<0?r+t:t;return i<o[0]?o[0]:i>o[1]?o[1]:i}}const PG=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:Tw,computeFlatOffset:Rw,computeOutShape:Ew,getNormalizedAxes:AG,isSliceContinous:Nw,maskToAxes:DG,parseSliceParams:Xg,sliceInfo:Dw,startForAxis:eD,startIndicesWithElidedDims:QR,stopForAxis:tD,stopIndicesWithElidedDims:ZR,stridesForAxis:JR,stridesWithElidedDims:XR},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class OG{static sgd(e){return new Sw(e)}static momentum(e,n,r=!1){return new jR(e,n,r)}static rmsprop(e,n=.9,r=0,s=null,o=!1){return new KR(e,n,r,s,o)}static adam(e=.001,n=.9,r=.999,s=null){return new GR(e,n,r,s)}static adadelta(e=.001,n=.95,r=null){return new WR(e,n,r)}static adamax(e=.002,n=.9,r=.999,s=null,o=0){return new HR(e,n,r,s,o)}static adagrad(e,n=.1){return new UR(e,n)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ha=OG;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LG=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:t=>t();function nD(){return new Promise(t=>LG(()=>t()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aw(t,e){const n=t[0].length;t.forEach((s,o)=>{D(s.length===n,()=>`Error in concat${n}D: rank of tensors[${o}] must be the same as the rank of the rest (${n})`)}),D(e>=0&&e<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const r=t[0];t.forEach((s,o)=>{for(let i=0;i<n;i++)D(i===e||s[i]===r[i],()=>`Error in concat${n}D: Shape of tensors[${o}] (${s}) does not match the shape of the rest (${r}) along the non-concatenated axis ${o}.`)})}function zs(t,e){const n=t[0].slice();for(let r=1;r<t.length;r++)n[e]+=t[r][e];return n}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var cs;(function(t){t[t.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",t[t.VALUE_ROWIDS=1]="VALUE_ROWIDS",t[t.ROW_LENGTHS=2]="ROW_LENGTHS",t[t.ROW_SPLITS=3]="ROW_SPLITS",t[t.ROW_LIMITS=4]="ROW_LIMITS",t[t.ROW_STARTS=5]="ROW_STARTS"})(cs||(cs={}));function rD(t,e,n){let r=new Array;if(n==null&&e==null)return r;if(e==null)for(;r.length<t+n.length;)r.push(-1);else r=e.slice();if(n==null)return r;if(t+n.length!==r.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${t+n.length}, but shape.rank = ${r.length}`);for(let s=1;s<n.length;++s){const o=n[s],i=r[r.length-n.length+s],a=r[i];if(o>=0)if(a>=0){if(a!==o)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${s+t}] = ${o} but shape[${s+t}] = ${a}`)}else r[i]=o}return r}function sD(t){const e={FIRST_DIM_SIZE:cs.FIRST_DIM_SIZE,VALUE_ROWIDS:cs.VALUE_ROWIDS,ROW_LENGTHS:cs.ROW_LENGTHS,ROW_SPLITS:cs.ROW_SPLITS,ROW_LIMITS:cs.ROW_LIMITS,ROW_STARTS:cs.ROW_STARTS},n=[];for(const r of t)if(r in e)n.push(e[r]);else break;return n}function oD(t){return t.length===0?0:t[0]===cs.FIRST_DIM_SIZE?t.length-1:t.length}function iD(t,e){if(t==null||e==null)return;const n=t.length,r=e.length;if(n>=r)throw new Error(`defaultValue.shape=${t} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${r})`);for(let s=0;s<Math.min(n,r-1);++s){const o=t[s],i=e[s+1];if(o>=0&&i>=0&&o!==1&&o!==i)throw new Error(`defaultValue.shape=${t}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${s-t.length}] = ${o} but ragged tensor input.flatValues.shape[${s-t.length}] = ${i}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fw=30;function qg(t){return t<=Fw?t:Ob(t,Math.floor(Math.sqrt(t)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pw(t,e,n){const r=n*(typeof t=="number"?t:t[0]),s=e*(typeof t=="number"?t:t[1]);return[r,s]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hf(t,e,n,r=!0){let s=[];if(r)s=s.concat(e.slice(0)),s.push(t[0]/n),s=s.concat(t.slice(1));else{s=s.concat(t[0]);const o=e.length;for(let i=0;i<o;++i)s=s.concat([t[i+1]/e[i],e[i]]);s=s.concat(t.slice(o+1))}return s}function pf(t,e,n=!0){const r=[];if(n){r.push(e);for(let s=e+1;s<t;++s)s<=2*e?(r.push(s),r.push(s-(e+1))):r.push(s)}else{const s=[],o=[];for(let i=1;i<t;++i)i>=e*2+1||i%2===1?o.push(i):s.push(i);r.push(...s),r.push(0),r.push(...o)}return r}function mf(t,e,n,r=!0){const s=[];r?s.push(t[0]/n):s.push(t[0]*n);for(let o=1;o<t.length;++o)o<=e.length?r?s.push(e[o-1]*t[o]):s.push(t[o]/e[o-1]):s.push(t[o]);return s}function Ow(t,e){const n=[0];for(let r=0;r<e;++r)n.push(t[r][0]);return n}function Lw(t,e,n){const r=t.slice(0,1);for(let s=0;s<n;++s)r.push(t[s+1]-e[s][0]-e[s][1]);return r}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yg=1.7580993408473768,Qg=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mw=.3275911,_w=.254829592,zw=-.284496736,Vw=1.421413741,Bw=-1.453152027,Ww=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bo(t,e){if(t.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${t.length}, imag: ${e.length}.`);const n=new Float32Array(t.length*2);for(let r=0;r<n.length;r+=2)n[r]=t[r/2],n[r+1]=e[r/2];return n}function aD(t){const e=new Float32Array(t.length/2),n=new Float32Array(t.length/2);for(let r=0;r<t.length;r+=2)e[r/2]=t[r],n[r/2]=t[r+1];return{real:e,imag:n}}function lD(t){const e=Math.ceil(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let s=0;s<t.length;s+=4)n[Math.floor(s/4)]=t[s],r[Math.floor(s/4)]=t[s+1];return{real:n,imag:r}}function uD(t){const e=Math.floor(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let s=2;s<t.length;s+=4)n[Math.floor(s/4)]=t[s],r[Math.floor(s/4)]=t[s+1];return{real:n,imag:r}}function Uw(t,e){const n=t[e*2],r=t[e*2+1];return{real:n,imag:r}}function cD(t,e,n,r){t[r*2]=e,t[r*2+1]=n}function dD(t,e){const n=new Float32Array(t/2),r=new Float32Array(t/2);for(let s=0;s<Math.ceil(t/2);s++){const o=(e?2:-2)*Math.PI*(s/t);n[s]=Math.cos(o),r[s]=Math.sin(o)}return{real:n,imag:r}}function fD(t,e,n){const r=(n?2:-2)*Math.PI*(t/e),s=Math.cos(r),o=Math.sin(r);return{real:s,imag:o}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const av="->",MG=/->/g,lS=",",uS="...";function Gw(t,e){t=t.replace(/\s/g,"");const n=(t.length-t.replace(MG,"").length)/av.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${av}").`);const[r,s]=t.split(av);D(r.indexOf(uS)===-1,()=>`The ellipsis notation ("${uS}") is not supported yet.`);const o=r.split(lS),i=o.length;if(e!==i)throw new Error(`Expected ${i} input tensors, received ${e}`);if(i>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const a=[];for(let f=0;f<s.length;++f){const h=s[f];if(!o.some(p=>p.indexOf(h)!==-1))throw new Error(`Output subscripts contain the label ${h} not present in the input subscripts.`);a.indexOf(h)===-1&&a.push(h)}for(let f=0;f<r.length;++f){const h=r[f];a.indexOf(h)===-1&&h!==lS&&a.push(h)}const l=new Array(o.length);for(let f=0;f<i;++f){if(new Set(o[f].split("")).size!==o[f].length)throw new Error(`Found duplicate axes in input component ${o[f]}. Support for duplicate axes in input is not implemented yet.`);l[f]=[];for(let h=0;h<o[f].length;++h)l[f].push(a.indexOf(o[f][h]))}const u=a.length,c=s.length,d=[];for(let f=c;f<u;++f)d.push(f);return{allDims:a,summedDims:d,idDims:l}}function Hw(t,e){let n=new Array(t);n.fill(-1);for(let s=0;s<e.length;++s)n[e[s]]=s;const r=[];for(let s=0;s<t;++s)n[s]===-1&&r.push(s);return n=n.filter(s=>s!==-1),{permutationIndices:n,expandDims:r}}function jw(t,e,n){const r=new Array(t);for(let s=0;s<n.length;++s){const o=n[s].shape;for(let i=0;i<e[s].length;++i)r[e[s][i]]===void 0?r[e[s][i]]=o[i]:D(r[e[s][i]]===o[i],()=>`Expected dimension ${r[e[s][i]]} at axis ${i} of input shaped ${JSON.stringify(o)}, but got dimension ${o[i]}`)}}function Kw(t,e){const n=t,r=[];let s=0;t.length===0&&n.push(-1),s=t.length+1;for(let i=0;i<s;++i)r.push([]);const o=[];for(let i=0;i<n.length;++i){const a=n[i],l=_G(e,a);for(const u of l)o.indexOf(u)===-1&&(r[i].push(u),o.push(u))}return{path:n,steps:r}}function Xw(t){return t.every((e,n)=>e===n)}function _G(t,e){const n=[];for(let r=0;r<t.length;++r)(t[r].length===0||t[r].indexOf(e)!==-1||e===-1)&&n.push(r);return n}function qw(t,e,n=0){let r=[];if(typeof e=="number")D(t.shape[n]%e===0,()=>"Number of splits must evenly divide the axis."),r=new Array(e).fill(t.shape[n]/e);else{const s=e.reduce((i,a)=>(a===-1&&(i+=1),i),0);D(s<=1,()=>"There should be only one negative value in split array.");const o=e.indexOf(-1);if(o!==-1){const i=e.reduce((a,l)=>l>0?a+l:a);e[o]=t.shape[n]-i}D(t.shape[n]===e.reduce((i,a)=>i+a),()=>"The sum of sizes must match the size of the axis dimension."),r=e}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hD(t){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${t}`}function pD(t,e){return`indices(${t}, 0) is invalid: ${e} < 0`}function mD(t,e,n){return`indices(${t}, 0) is invalid: ${e} >= ${n}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gD(t,e){return`only one output dimension may be -1, not both ${t} and ${e}`}function vD(t,e){return`size ${t} must be non-negative, not ${e}`}function bD(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function xD(t,e){const n=q(t),r=q(e);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${r}. inputShape=${t} outputShape= ${e}`}function yD(t,e){const n=q(t),r=q(e);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${r}. inputShape=${t} outputShape=${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jb(){return"segment ids must be >= 0"}function wD(){return"segment ids are not increasing"}function $D(t,e){return`Segment id ${t} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function CD(t,e,n){return`Bad: indices[${t}] == ${e} out of range [0, ${n})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kD(t,e){let n=!1,r;for(t<=Fw?(r=t,n=!0):r=Ob(t,Math.floor(Math.sqrt(t)));!n;)r>e||r===t?n=!0:r=Ob(t,r+1);return r}function SD(t,e,n){const r=[],s=t.length;for(let o=0;o<s;o++)o!==e?r.push(t[o]):r.push(n);return r}function Yw(t,e,n,r){const s=e.shape.length,o=t.shape.length;if(r!==0&&(r<-s||r>s))throw new Error(`Expect batchDims in the range of [-${s}, ${s}], but got ${r}`);if(r<0&&(r+=s),r>o)throw new Error(`batchDims (${r}) must be less than rank(x) (
    ${o}).`);if(n<r)throw new Error(`batchDims (${r}) must be less than or equal to axis (${n}).`);for(let d=0;d<r;++d)if(t.shape[d]!==e.shape[d])throw new Error(`x.shape[${d}]: ${t.shape[d]} should be equal to indices.shape[${d}]: ${e.shape[d]}.`);const i=t.shape[n],a=[];let l=1,u=1,c=1;for(let d=0;d<r;++d)a.push(t.shape[d]),l*=t.shape[d];for(let d=r;d<n;d++)a.push(t.shape[d]),u*=t.shape[d];for(let d=r;d<s;d++)a.push(e.shape[d]);for(let d=n+1;d<o;d++)a.push(t.shape[d]),c*=t.shape[d];return{batchSize:l,sliceSize:c,outerSize:u,dimSize:i,outputShape:a}}const zG=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:Yw,computeOutShape:SD,segOpComputeOptimalWindowSize:kD},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xo(t){try{return t.map(e=>ri(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function ID(t){return t.map(e=>Yo(e))}const VG=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:_w,ERF_A2:zw,ERF_A3:Vw,ERF_A4:Bw,ERF_A5:Ww,ERF_P:Mw,PARALLELIZE_THRESHOLD:Fw,get RowPartitionType(){return cs},SELU_SCALE:Qg,SELU_SCALEALPHA:Yg,applyActivation:xw,assertAndGetBroadcastShape:Se,assertAxesAreInnerMostDims:fn,assertParamsConsistent:Aw,assignToTypedArray:cD,axesAreInnerMostDims:Y1,calculateShapes:Da,checkEinsumDimSizes:jw,checkPadOnDimRoundingMode:Xn,combineLocations:vR,combineRaggedTensorToTensorShapes:rD,complexWithEvenIndex:lD,complexWithOddIndex:uD,computeConv2DInfo:dn,computeConv3DInfo:pi,computeDefaultPad:G1,computeDilation2DInfo:lf,computeOptimalWindowSize:qg,computeOutAndReduceShapes:sn,computeOutShape:zs,computePool2DInfo:Zr,computePool3DInfo:$o,convertConv2DDataFormat:Co,decodeEinsumEquation:Gw,eitherStridesOrDilationsAreOne:wn,expandShapeToKeepDim:Vt,exponent:fD,exponents:dD,fromStringArrayToUint8:ID,fromUint8ToStringArray:xo,getAxesPermutation:It,getBroadcastDims:Ul,getComplexWithIndex:Uw,getEinsumComputePath:Kw,getEinsumPermutation:Hw,getFusedBiasGradient:bw,getFusedDyActivation:vw,getImageCenter:Pw,getInnerMostAxes:Ot,getPermuted:pf,getRaggedRank:oD,getReductionAxes:Yt,getReshaped:hf,getReshapedPermuted:mf,getRowPartitionTypesHelper:sD,getSliceBeginCoords:Ow,getSliceSize:Lw,getSparseFillEmptyRowsIndicesDenseShapeMismatch:hD,getSparseFillEmptyRowsNegativeIndexErrorMessage:pD,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:mD,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:bD,getSparseReshapeInputOutputMismatchErrorMessage:yD,getSparseReshapeInputOutputMultipleErrorMessage:xD,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:gD,getSparseReshapeNegativeOutputDimErrorMessage:vD,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:CD,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:Jb,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:wD,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:$D,getUndoAxesPermutation:mi,isIdentityPermutation:Xw,log:$V,mergeRealAndImagArrays:bo,prepareAndValidate:Iw,prepareSplitSize:qw,segment_util:zG,shouldFuse:yw,slice_util:PG,splitRealAndImagArrays:aD,stridesOrDilationsArePositive:ia,tupleValuesAreOne:oa,upcastType:sr,validateDefaultValueShape:iD,validateInput:v5,validateUpdateShape:LR,warn:fr},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */NG();/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TD={kernelName:zm,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_(t,ff(ce(n,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BG={kernelName:fd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const r=dt(ce(n,"float32")),s=yn(ye(qe(1),r));return Ft(be(t,s))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WG={kernelName:hd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const r=yn(ye(dt(ce(n,"float32")),1));return be(t,r)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UG={kernelName:su,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=Se(n.shape,r.shape);return{a:()=>{let a=t;const l=Yt(n.shape,s);return l.length>0&&(a=ge(a,l)),B(a,n.shape)},b:()=>{let a=t;const l=Yt(r.shape,s);return l.length>0&&(a=ge(a,l)),B(a,r.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GG={kernelName:e1,saveAllInputs:!0,gradFunc:(t,e)=>{const n={};return e.forEach((r,s)=>{n[s]=()=>t.clone()}),n}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HG={kernelName:Vm,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ve(n)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jG={kernelName:Bm,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ve(n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KG={kernelName:pd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>be(t,yn(ye(qe(1),dt(ce(n,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XG={kernelName:md,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const r=yn(ne(qe(1),dt(ce(n,"float32"))));return be(t,r)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qG={kernelName:bd,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=Se(n.shape,r.shape);return{a:()=>{const a=ne(dt(n),dt(r));let l=_(t,be(r,a));const u=Yt(n.shape,s);return u.length>0&&(l=ge(l,u)),B(l,n.shape)},b:()=>{const a=ne(dt(n),dt(r));let l=Ft(_(t,be(n,a)));const u=Yt(r.shape,s);return u.length>0&&(l=ge(l,u)),B(l,r.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YG={kernelName:gd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>be(t,ne(dt(ce(n,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QG={kernelName:vd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>be(t,ye(qe(1),dt(ce(n,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZG(t,e,n,r,s,o){const i=O(t,"dy","avgPool3dGrad"),a=O(e,"input","avgPool3dGrad");let l=i,u=a,c=!1;a.rank===4&&(c=!0,l=B(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]]),u=B(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),D(l.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`),D(u.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${u.rank}.`),Xn("avgPool3dGrad",s,o);const d={dy:l,input:u},f={filterSize:n,strides:r,pad:s,dimRoundingMode:o},h=V.runKernel(s1,d,f);return c?B(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const JG=W({avgPool3dGrad_:ZG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e7={kernelName:Um,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{filterSize:s,strides:o,pad:i,dimRoundingMode:a}=n;return{x:()=>JG(t,r,s,o,i,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t7(t,e,n,r,s){const o=O(t,"dy","avgPoolGrad"),i=O(e,"input","avgPoolGrad");D(i.rank===o.rank,()=>`Rank of input (${i.rank}) does not match rank of dy (${o.rank})`);let a=i,l=o,u=!1;i.rank===3&&(u=!0,a=B(i,[1,i.shape[0],i.shape[1],i.shape[2]]),l=B(o,[1,o.shape[0],o.shape[1],o.shape[2]])),D(l.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),D(a.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${a.rank}.`);const c={dy:l,input:a},d={filterSize:n,strides:r,pad:s},f=V.runKernel(r1,c,d);return u?B(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const n7=W({avgPoolGrad_:t7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r7={kernelName:Wm,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{filterSize:s,strides:o,pad:i}=n;return{x:()=>n7(t,r,s,o,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s7={kernelName:Gm,inputsToSave:["a","b"],gradFunc:(t,e,n)=>{const[r,s]=e,{transposeA:o,transposeB:i}=n;return!o&&!i?{a:()=>Xe(t,s,!1,!0),b:()=>Xe(r,t,!0,!1)}:!o&&i?{a:()=>Xe(t,s,!1,!1),b:()=>Xe(t,r,!0,!1)}:o&&!i?{a:()=>Xe(s,t,!1,!0),b:()=>Xe(r,t,!1,!1)}:{a:()=>Xe(s,t,!0,!0),b:()=>Xe(t,r,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o7={kernelName:Hm,gradFunc:(t,e,n)=>{const{blockShape:r,crops:s}=n;return{x:()=>sw(t,r,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i7={kernelName:bV,gradFunc:(t,e,n)=>{const r=n,s=r.inputShape,o=r.shape,i=Array.from(o);for(let l=s.length-1;l>=0;l--)if(s[l]===o[l])i[l]=1;else if(s[l]!==1)throw new Error(`broadcastTo(): [${s}] cannot be broadcast to [${o}].`);const a=[];for(let l=0;l<i.length;l++)i[l]>1&&a.push(l);return{x:()=>ge(t,a,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a7={kernelName:xd,gradFunc:t=>({x:()=>t.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l7={kernelName:yd,gradFunc:t=>({x:()=>Ve(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u7={kernelName:wd,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{clipValueMin:s,clipValueMax:o}=n;return{x:()=>Fn(go(Ea(r,s),au(r,o)),t,Ve(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c7={kernelName:jm,inputsToSave:["x"],gradFunc:TD.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d7={kernelName:Km,saveAllInputs:!0,gradFunc:(t,e,n)=>{const r=e.map(l=>l.shape),{axis:s}=n,o=De(s,e[0].shape)[0],i=r.map(l=>l[o]);return gr(t,i,o).map(l=>()=>l)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const f7={kernelName:Xm,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[r,s]=e,{dilations:o,strides:i,pad:a,dataFormat:l}=n;return D(oa(o),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${o}'`),{x:()=>K1(r.shape,t,s,i,a,l),filter:()=>gw(r,t,s.shape,i,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h7={kernelName:qm,inputsToSave:["dy","filter"],gradFunc:(t,e,n)=>{const[r,s]=e,{strides:o,pad:i,dataFormat:a,dimRoundingMode:l}=n;return{dy:()=>aa(t,s,o,i,a,1,l),filter:()=>gw(t,r,s.shape,o,i,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p7(t,e,n,r,s){let o=t;t.rank===4&&(o=B(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]));let i=e;i.rank===4&&(i=B(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),D(o.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${o.shape}.`),D(i.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${i.shape}.`),D(n.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${n}.`),D(o.shape[4]===n[3],()=>`Error in conv3dDerFilter: depth of input ${o.shape[4]}) must match input depth in filter (${n[3]}.`),D(i.shape[4]===n[4],()=>`Error in conv3dDerFilter: depth of dy (${i.shape[4]}) must match output depth for filter (${n[4]}).`);const a={x:o,dy:i},l={strides:r,pad:s,filterShape:n};return V.runKernel(u1,a,l)}const m7=W({conv3DBackpropFilter_:p7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g7={kernelName:Ym,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:r,strides:s,pad:o}=n;D(oa(r),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${r}'`);const[i,a]=e;return{x:()=>hR(i.shape,t,a,s,o),filter:()=>m7(i,t,a.shape,s,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v7={kernelName:$d,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_(Ft(AR(ce(n,"float32"))),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b7={kernelName:Cd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_(FR(ce(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x7={kernelName:Qm,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:s,exclusive:o,reverse:i}=n;return{x:()=>{const a=It([s],r.rank);let l=mR(t,s,o,!i);return a!=null&&(l=ze(l,a)),l}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y7={kernelName:Zm,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:r,strides:s,pad:o,dimRoundingMode:i}=n,a=r??[1,1];D(oa(a),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`);const[l,u]=e;return D(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`),D(u.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${u.rank}.`),D(l.shape[3]===u.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${u.shape[2]}.`),D(wn(s,a),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${s} and dilations '${a}'.`),Xn("depthwiseConv2d",o,i),{x:()=>L5(l.shape,t,u,s,o,a,i),filter:()=>P5(l,t,u.shape,s,o,a,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w7={kernelName:Jm,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[r,s]=e,o={x:r,filter:s,dy:t},i={x:r,filter:s,dy:t};return{x:()=>V.runKernel(Lb,o,n),filter:()=>V.runKernel(Mb,i,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $7={kernelName:Sd,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e,r={dy:t,y:n};return{x:()=>V.runKernel(b1,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C7={kernelName:Id,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,r=_(Gs(Ft(dt(n))),2/Math.sqrt(Math.PI));return{x:()=>_(t,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k7={kernelName:Td,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_(t,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S7={kernelName:tg,inputsToSave:["input"],gradFunc:(t,e)=>{const[n]=e;return{input:()=>B(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I7={kernelName:Ed,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_(t,Gs(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T7={kernelName:Nd,gradFunc:t=>({x:()=>Ve(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E7={kernelName:Rd,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=Se(n.shape,r.shape);return{a:()=>{const a=be(t,ce(r,"float32")),l=Yt(n.shape,s);return l.length>0?B(ge(a,l),n.shape):a},b:()=>{let a=_(t,ce(n,"float32"));const l=Yt(r.shape,s);l.length>0&&(a=B(ge(a,l),r.shape));const u=dt(r);return Ft(be(a,ce(u,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N7={kernelName:ng,inputsToSave:["x","mean","variance","scale"],gradFunc:(t,e,n)=>{const{varianceEpsilon:r}=n,[s,o,i,a]=e,l=a??qe(1),u=Yt(o.shape,s.shape),c=[];if(o.rank===1){for(let y=0;y<s.shape.length-1;++y)c.push(s.shape[y]);c.push(1)}const d=ye(s,o),f=_(t,l),h=NR(ne(i,qe(r))),p=_(_(_(h,h),h),qe(-.5));return{x:()=>o.rank===1?B(_(_(t,ds(B(h,[1,1,1,o.shape[0]]),c)),l),s.shape):B(_(_(t,h),l),s.shape),mean:()=>{let y=_(_(h,qe(-1)),f);return o.rank===1&&(y=ge(y,u)),B(y,o.shape)},variance:()=>{let y=_(_(p,d),f);return o.rank===1&&(y=ge(y,u)),B(y,o.shape)},scale:()=>{const y=_(d,h);let $=_(t,y);return o.rank===1&&($=ge($,u)),B($,o.shape)},offset:()=>{let y=t;return o.rank===1&&(y=ge(y,u)),B(y,o.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R7={kernelName:rg,inputsToSave:["x","indices"],gradFunc:(t,e,n)=>{const[r,s]=e,{axis:o,batchDims:i}=n,a=De(o,r.shape)[0],l=(u,c,d)=>()=>{const f=u.shape,h=c.size,p=f.slice(0,a),g=p.length,v=f.slice(o,f.length).slice(1),m=v.length,b=cS(0,g),x=cS(g+1,g+1+m),y=dS([p,[h],v]),$=B(d,y),C=B(c,[h]),k=dS([[g],b,x]),w=ze($,k);let I=_R(w,C,u.shape[a]);const N=mi(k);return I=ze(I,N),I};if(i===1){const u=r.shape[0],c=r.split(u,0);return{x:()=>vo(c.map((h,p)=>l(h,s.slice(p,1),t.slice(p,1))())).reshape(r.shape),indices:()=>s}}else return{x:l(r,s,t),indices:()=>s}}};function cS(t,e){const n=[];for(let r=t;r<e;++r)n.push(r);return n}function dS(t){const e=[];for(let n=0;n<t.length;++n)for(let r=0;r<t[n].length;++r)e.push(t[n][r]);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D7={kernelName:Dd,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>Ve(n),b:()=>Ve(r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A7={kernelName:Ad,gradFunc:t=>({x:()=>ce(t,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F7={kernelName:Fd,gradFunc:t=>({x:()=>Ve(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P7={kernelName:Pd,gradFunc:t=>({x:()=>Ve(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O7={kernelName:Od,gradFunc:t=>({x:()=>Ve(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L7={kernelName:og,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{alpha:s}=n,o=wr(r,0);return{x:()=>Fn(o,t,_(t,s))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M7={kernelName:Md,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>be(t,ne(n,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _7={kernelName:Ld,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>be(t,ce(n,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z7={kernelName:yV,inputsToSave:[],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r]=e,{axis:s}=n;return{logits:()=>{const i=Gs(r);return ye(t,_(ge(t,s,!0),i))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V7(t,e,n,r=5,s=1,o=1,i=.5){const a={x:t,y:e,dy:n},l={depthRadius:r,bias:s,alpha:o,beta:i};return V.runKernel(k1,a,l)}const B7=W({localResponseNormalizationBackprop_:V7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W7={kernelName:dg,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,s]=e,{depthRadius:o,bias:i,alpha:a,beta:l}=n;return{x:()=>B7(r,s,t,o,i,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ED(t,e,n,r){return e.rank<n.rank&&(e=B(e,Vt(e.shape,r))),t.rank<n.rank&&(t=B(t,Vt(t.shape,r))),{x:()=>_(t,ce(Us(n,e),t.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fS={kernelName:fg,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const r=n,{reductionIndices:s}=r,o=e[0],i=e[1],a=De(s,o.shape),l=ED(t,i,o,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U7={kernelName:_d,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>_(t,ce(Ea(n,r),"float32")),b:()=>_(t,ce(Rp(n,r),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G7(t,e,n,r,s,o,i){const a=O(t,"dy","maxPool3dGrad"),l=O(e,"input","maxPool3dGrad"),u=O(n,"output","maxPool3dGrad");let c=a,d=l,f=u,h=!1;l.rank===4&&(h=!0,c=B(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]]),d=B(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),f=B(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]])),D(c.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${c.rank}.`),D(d.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${d.rank}.`),D(f.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${f.rank}.`),Xn("maxPool3dGrad",o,i);const p={dy:c,input:d,output:f},g={filterSize:r,strides:s,pad:o,dimRoundingMode:i},v=V.runKernel(I1,p,g);return h?B(v,[v.shape[1],v.shape[2],v.shape[3],v.shape[4]]):v}const H7=W({maxPool3dGrad_:G7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j7={kernelName:pg,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,s]=e,{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=n;return{x:()=>H7(t,r,s,o,i,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K7(t,e,n,r,s,o,i){const a=O(t,"dy","maxPoolGrad"),l=O(e,"input","maxPoolGrad"),u=O(n,"output","maxPoolGrad");D(l.rank===a.rank,()=>`Rank of input (${l.rank}) does not match rank of dy (${a.rank})`),D(a.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${a.rank}.`),D(l.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`),Xn("maxPoolGrad",o,i);const c={dy:a,input:l,output:u},d={filterSize:r,strides:s,pad:o,dimRoundingMode:i};return V.runKernel(S1,c,d)}const X7=W({maxPoolGrad_:K7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q7={kernelName:hg,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,s]=e,{filterSize:o,strides:i,pad:a}=n;return{x:()=>X7(t,r,s,o,i,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Y7={kernelName:mg,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:s}=n,o=De(s,r.shape),a=sn(r.shape,o)[1],l=q(a);return{x:()=>{const c=r.shape.slice();o.forEach(h=>{c[h]=1});const d=B(t,c);return be(_(d,ko(r.shape,"float32")),l)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q7={kernelName:gg,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const r=n,{axis:s}=r,[o,i]=e,a=De(s,o.shape),l=ED(t,i,o,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z7={kernelName:zd,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>_(t,ce(au(n,r),"float32")),b:()=>_(t,ce(wr(n,r),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J7={kernelName:vg,inputsToSave:["x"],gradFunc:(t,e,n)=>{const r=e[0],{paddings:s}=n,o=s.map(i=>i[0]);return{x:()=>at(t,o,r.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eH={kernelName:Vd,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=Se(n.shape,r.shape);return{a:()=>{const a=Yt(n.shape,s);return a.length>0?B(ge(t,a),n.shape):t},b:()=>{const a=_(t,Ft(Kg(be(n,r)))),l=Yt(r.shape,s);return l.length>0?B(ge(a,l),r.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tH={kernelName:Bd,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=Se(n.shape,r.shape);return{a:()=>{const a=_(t,ce(r,"float32")),l=Yt(n.shape,s);return l.length>0?B(ge(a,l),n.shape):a},b:()=>{const a=_(t,ce(n,"float32")),l=Yt(r.shape,s);return l.length>0?B(ge(a,l),r.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nH={kernelName:bg,gradFunc:t=>({x:()=>Ft(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rH={kernelName:wg,inputsToSave:["indices"],gradFunc:(t,e)=>{const n=e[0];return{indices:()=>Ct(n.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sH={kernelName:yg,gradFunc:t=>({x:()=>Ve(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oH={kernelName:$g,saveAllInputs:!0,gradFunc:(t,e,n)=>{const{axis:r}=n;return ca(t,r).map(o=>()=>o)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hS={kernelName:Cg,inputsToSave:["x"],gradFunc:(t,e,n)=>{const r=e[0],{paddings:s}=n,o=s.map(i=>i[0]);return{x:()=>at(t,o,r.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iH={kernelName:Wd,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(t,e)=>{const[n,r,s]=e,o=n,i=r,a=Se(o.shape,i.shape);return{a:()=>{const c=ce(i,"float32");let d=_(t,_(c,la(o,ye(c,qe(1)))));const f=Yt(o.shape,a);return f.length>0&&(d=ge(d,f)),B(d,o.shape)},b:()=>{const c=wr(o,0),d=Fn(c,Hs(o),Ve(o));let f=_(t,_(s,d));const h=Yt(i.shape,a);return h.length>0&&(f=ge(f,h)),B(f,i.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aH={kernelName:kg,inputsToSave:["x","alpha"],gradFunc:(t,e)=>{const[n,r]=e,s=wr(n,0);return{x:()=>Fn(s,t,_(t,r)),alpha:()=>{let o=Fn(s,Ve(t),_(t,n));const i=Yt(r.shape,t.shape);return i.length>0&&(o=ge(o,i)),B(o,r.shape)}}}};/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lH(t,e,n){const r=t.shape.slice();r[n]=1;const s=B(e,r),o=Yb(t,n,!0,!1),i=Yb(t,n,!0,!0),a=_(o,i);return _(s,a)}function uH(t,e,n){const r=t.shape.length,s=r-n.length,o=It(n,r);let i=t;o!=null&&(i=ze(t,o));const a=i.shape.slice(),u=a.splice(r-n.length,n.length).reduce((f,h)=>f*h,1);a.push(u);const c=i.reshape(a);let d=lH(c,e,s);if(d=d.reshape(i.shape),o!=null){const f=mi(o);d=ze(d,f)}return d}const cH={kernelName:Sg,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:s}=n;let o=[];return s==null?o=r.shape.map((i,a)=>a):typeof s=="number"?o=[s]:o=s,{x:()=>uH(r,t,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dH={kernelName:kd,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=Se(n.shape,r.shape);return{a:()=>{const a=be(t,ce(r,"float32")),l=Yt(n.shape,s);return l.length>0?B(ge(a,l),n.shape):a},b:()=>{let a=_(t,ce(n,"float32"));const l=Yt(r.shape,s);l.length>0&&(a=B(ge(a,l),r.shape));const u=dt(r);return Ft(be(a,ce(u,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fH={kernelName:Ud,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>be(t,Ft(dt(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hH={kernelName:Hd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,r=_(au(n,6),ff(n));return{x:()=>_(t,ce(r,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pH={kernelName:Gd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_(t,ce(ff(n),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mH={kernelName:Ig,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>B(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gH={kernelName:Eg,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[r]=e,s={dy:t,images:r};return{images:()=>V.runKernel(F1,s,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vH={kernelName:Tg,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[r]=e,s={dy:t,images:r};return{images:()=>V.runKernel(A1,s,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bH={kernelName:Ng,gradFunc:(t,e,n)=>{const{dims:r}=n,s=De(r,t.shape);return{x:()=>ua(t,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xH={kernelName:jd,gradFunc:t=>({x:()=>Ve(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yH={kernelName:Kd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ft(be(t,_(la(n,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wH={kernelName:Rg,inputsToSave:["condition"],gradFunc:(t,e)=>{const[n]=e;return{condition:()=>ce(Ve(n),"float32"),t:()=>_(t,ce(n,t.dtype)),e:()=>_(t,ce(ew(n),t.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $H={kernelName:Xd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const r=wr(n,qe(0)),s=qe(Yg),o=qe(Qg),i=_(t,o),a=_(_(t,s),Gs(ce(n,"float32")));return Fn(r,i,a)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CH={kernelName:Zd,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_(t,_(n,ye(qe(1),n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kH={kernelName:Qd,gradFunc:t=>({x:()=>Ve(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SH={kernelName:qd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_(X1(ce(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IH={kernelName:Yd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_(pR(ce(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TH={kernelName:Dg,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{begin:s,size:o}=n,i=r.shape,[a,l]=Xg(r,s,o),u=[];for(let c=0;c<t.rank;c++)u.push([a[c],i[c]-a[c]-l[c]]);return{x:()=>rw(t,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EH={kernelName:Og,outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r]=e,{dim:s}=n,o=!0,i=_(t,r);return{logits:()=>ye(i,_(ge(i,[s],o),r))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NH={kernelName:Jd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_(t,iu(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pS={kernelName:Fg,gradFunc:(t,e,n)=>{const{blockShape:r,paddings:s}=n;return{x:()=>j1(t,r,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mS={kernelName:Pg,gradFunc:(t,e,n)=>{const{axis:r}=n;return{x:()=>Un(t,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RH={kernelName:ef,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>be(t,_(yn(ce(n,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DH={kernelName:P1,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_(t,_(ce(n,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AH={kernelName:tf,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=qe(2);return{a:()=>_(t,_(s,ye(n,r))),b:()=>_(t,_(s,ye(r,n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FH={kernelName:af,gradFunc:t=>({x:()=>Ve(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PH={kernelName:nf,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=Se(n.shape,r.shape);return{a:()=>{let a=t;const l=Yt(n.shape,s);return l.length>0&&(a=ge(a,l)),B(a,n.shape)},b:()=>{let a=t;const l=Yt(r.shape,s);return l.length>0&&(a=ge(a,l)),B(Ft(a),r.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OH={kernelName:Ag,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,s=r.shape.slice(),{axis:o}=n;De(o,r.shape).forEach(u=>{s[u]=1});const a=B(t,s),l=_(a,ko(r.shape,"float32"));return{x:()=>l}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LH={kernelName:rf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>be(t,dt(X1(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MH={kernelName:sf,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_(ye(qe(1),dt(n)),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _H={kernelName:of,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{reps:s}=n;return{x:()=>{let i=Ve(r);if(r.rank===1)for(let a=0;a<s[0];++a)i=ne(i,at(t,[a*r.shape[0]],[r.shape[0]]));else if(r.rank===2)for(let a=0;a<s[0];++a)for(let l=0;l<s[1];++l)i=ne(i,at(t,[a*r.shape[0],l*r.shape[1]],[r.shape[0],r.shape[1]]));else if(r.rank===3)for(let a=0;a<s[0];++a)for(let l=0;l<s[1];++l)for(let u=0;u<s[2];++u)i=ne(i,at(t,[a*r.shape[0],l*r.shape[1],u*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else if(r.rank===4)for(let a=0;a<s[0];++a)for(let l=0;l<s[1];++l)for(let u=0;u<s[2];++u)for(let c=0;c<s[3];++c)i=ne(i,at(t,[a*r.shape[0],l*r.shape[1],u*r.shape[2],c*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${r.rank} tensors yet.`);return i}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zH={kernelName:Il,gradFunc:(t,e,n)=>{const r=n,{perm:s}=r,o=mi(s);return{x:()=>ze(t,o)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VH={kernelName:Lg,gradFunc:(t,e,n)=>{const r=n,{axis:s}=r;return{value:()=>vo(t,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BH={kernelName:Mg,inputsToSave:["segmentIds"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>WH(t,n)}}};function WH(t,e){const n=gi(e,Ve(e)),r=Q1(t,n);let s=Ea(e,qe(0,"int32"));const o=r.rank-s.rank;for(let a=0;a<o;++a)s=zn(s,a+1);s=go(s,ko(r.shape,"bool"));const i=Ve(r);return Fn(s,r,i)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UH={kernelName:_g,gradFunc:t=>({x:()=>Ve(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GH=[TD,BG,WG,UG,GG,HG,jG,KG,XG,qG,YG,QG,e7,r7,s7,o7,i7,a7,l7,u7,c7,d7,h7,f7,g7,v7,b7,x7,y7,w7,dH,$7,C7,k7,S7,I7,E7,T7,N7,R7,D7,A7,F7,P7,O7,L7,M7,_7,z7,W7,fS,fS,U7,j7,q7,Y7,Q7,Z7,J7,eH,tH,nH,rH,sH,oH,hS,hS,iH,aH,cH,fH,hH,pH,mH,gH,vH,bH,xH,yH,wH,$H,CH,kH,SH,IH,TH,EH,NH,pS,pS,mS,mS,RH,AH,DH,FH,PH,OH,LH,MH,_H,zH,VH,BH,UH];for(const t of GH)CV(t);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.abs=function(){return this.throwIfDisposed(),En(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.acos=function(){return this.throwIfDisposed(),IB(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.acosh=function(){return this.throwIfDisposed(),EB(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.add=function(t){return this.throwIfDisposed(),ne(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.all=function(t,e){return this.throwIfDisposed(),cR(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.any=function(t,e){return this.throwIfDisposed(),Xb(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.argMax=function(t){return this.throwIfDisposed(),Wc(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.argMin=function(t){return this.throwIfDisposed(),FB(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.asScalar=function(){return this.throwIfDisposed(),D(this.size===1,()=>"The array must have only 1 element."),B(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.asType=function(t){return this.throwIfDisposed(),ce(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.as1D=function(){return this.throwIfDisposed(),B(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.as2D=function(t,e){return this.throwIfDisposed(),B(this,[t,e])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.as3D=function(t,e,n){return this.throwIfDisposed(),B(this,[t,e,n])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.as4D=function(t,e,n,r){return this.throwIfDisposed(),B(this,[t,e,n,r])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.as5D=function(t,e,n,r,s){return this.throwIfDisposed(),B(this,[t,e,n,r,s])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.asin=function(){return this.throwIfDisposed(),OB(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.asinh=function(){return this.throwIfDisposed(),MB(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.atan=function(){return this.throwIfDisposed(),zB(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.atan2=function(t){return this.throwIfDisposed(),BB(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.atanh=function(){return this.throwIfDisposed(),UB(this)};X().prototype.avgPool=function(t,e,n,r){return this.throwIfDisposed(),H1(this,t,e,n,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),j1(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.batchNorm=function(t,e,n,r,s){return this.throwIfDisposed(),Ug(this,t,e,n,r,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.broadcastTo=function(t){return this.throwIfDisposed(),fc(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.cast=function(t){return this.throwIfDisposed(),ce(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.ceil=function(){return this.throwIfDisposed(),gW(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.clipByValue=function(t,e){return this.throwIfDisposed(),br(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.concat=function(t,e){return this.throwIfDisposed(),t instanceof Gt&&(t=[t]),Un([this,...t],e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.conv1d=function(t,e,n,r,s,o){return this.throwIfDisposed(),dR(this,t,e,n,r,s,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.conv2dTranspose=function(t,e,n,r,s){return this.throwIfDisposed(),fR(this,t,e,n,r,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.conv2d=function(t,e,n,r,s,o){return this.throwIfDisposed(),aa(this,t,e,n,r,s,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.cos=function(){return this.throwIfDisposed(),X1(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.cosh=function(){return this.throwIfDisposed(),pR(this)};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.cumprod=function(t,e,n){return this.throwIfDisposed(),Yb(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.cumsum=function(t,e,n){return this.throwIfDisposed(),mR(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),BW(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.depthwiseConv2d=function(t,e,n,r,s,o){return this.throwIfDisposed(),q1(this,t,e,n,r,s,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.dilation2d=function(t,e,n,r,s){return this.throwIfDisposed(),GW(this,t,e,n,r,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.divNoNan=function(t){return this.throwIfDisposed(),qW(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.div=function(t){return this.throwIfDisposed(),be(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.dot=function(t){return this.throwIfDisposed(),QW(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.elu=function(){return this.throwIfDisposed(),Hg(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.equal=function(t){return this.throwIfDisposed(),Us(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.erf=function(){return this.throwIfDisposed(),gR(this)};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.euclideanNorm=function(t,e){return this.throwIfDisposed(),u6(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.exp=function(){return this.throwIfDisposed(),Gs(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.expandDims=function(t){return this.throwIfDisposed(),zn(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.expm1=function(){return this.throwIfDisposed(),h6(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.fft=function(){return this.throwIfDisposed(),OR(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.flatten=function(){return this.throwIfDisposed(),B(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.floor=function(){return this.throwIfDisposed(),Kg(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.floorDiv=function(t){return this.throwIfDisposed(),uR(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.gather=function(t,e,n){return this.throwIfDisposed(),Q1(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.greaterEqual=function(t){return this.throwIfDisposed(),Ea(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.greater=function(t){return this.throwIfDisposed(),wr(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.ifft=function(){return this.throwIfDisposed(),Qb(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.irfft=function(){return this.throwIfDisposed(),s5(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.isFinite=function(){return this.throwIfDisposed(),$6(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.isInf=function(){return this.throwIfDisposed(),k6(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.isNaN=function(){return this.throwIfDisposed(),I6(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.leakyRelu=function(t){return this.throwIfDisposed(),J1(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.lessEqual=function(t){return this.throwIfDisposed(),au(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.less=function(t){return this.throwIfDisposed(),Rp(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.localResponseNormalization=function(t,e,n,r){return this.throwIfDisposed(),D6(this,t,e,n,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.logSigmoid=function(){return this.throwIfDisposed(),_6(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.logSoftmax=function(t){return this.throwIfDisposed(),wR(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.logSumExp=function(t,e){return this.throwIfDisposed(),$R(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.log=function(){return this.throwIfDisposed(),Hs(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.log1p=function(){return this.throwIfDisposed(),yR(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.logicalAnd=function(t){return this.throwIfDisposed(),go(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.logicalNot=function(){return this.throwIfDisposed(),ew(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.logicalOr=function(t){return this.throwIfDisposed(),CR(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.logicalXor=function(t){return this.throwIfDisposed(),j6(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.matMul=function(t,e,n){return this.throwIfDisposed(),Xe(this,t,e,n)};X().prototype.maxPool=function(t,e,n,r){return this.throwIfDisposed(),tw(this,t,e,n,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.max=function(t,e){return this.throwIfDisposed(),ms(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.maximum=function(t){return this.throwIfDisposed(),gi(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.mean=function(t,e){return this.throwIfDisposed(),zt(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.min=function(t,e){return this.throwIfDisposed(),Np(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.minimum=function(t){return this.throwIfDisposed(),Hc(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.mirrorPad=function(t,e){return this.throwIfDisposed(),eU(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.mod=function(t){return this.throwIfDisposed(),nU(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.mul=function(t){return this.throwIfDisposed(),_(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.neg=function(){return this.throwIfDisposed(),Ft(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.norm=function(t,e,n){return this.throwIfDisposed(),jg(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.notEqual=function(t){return this.throwIfDisposed(),Dp(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.oneHot=function(t,e=1,n=0){return this.throwIfDisposed(),kR(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.onesLike=function(){return this.throwIfDisposed(),Yr(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.pad=function(t,e){return this.throwIfDisposed(),rw(this,t,e)};X().prototype.pool=function(t,e,n,r,s,o){return this.throwIfDisposed(),fU(this,t,e,n,r,s,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.pow=function(t){return this.throwIfDisposed(),la(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.prelu=function(t){return this.throwIfDisposed(),ow(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.prod=function(t,e){return this.throwIfDisposed(),mU(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.reciprocal=function(){return this.throwIfDisposed(),_U(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.relu=function(){return this.throwIfDisposed(),Ra(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.relu6=function(){return this.throwIfDisposed(),TR(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.reshapeAs=function(t){return this.throwIfDisposed(),B(this,t.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.reshape=function(t){return this.throwIfDisposed(),B(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.resizeBilinear=function(t,e,n){return this.throwIfDisposed(),VR(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.resizeNearestNeighbor=function(t,e,n){return this.throwIfDisposed(),BR(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.reverse=function(t){return this.throwIfDisposed(),ua(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.rfft=function(){return this.throwIfDisposed(),a5(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.round=function(){return this.throwIfDisposed(),ER(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.rsqrt=function(){return this.throwIfDisposed(),NR(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.selu=function(){return this.throwIfDisposed(),RR(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.separableConv2d=function(t,e,n,r,s,o){return this.throwIfDisposed(),DR(this,t,e,n,r,s,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.sigmoid=function(){return this.throwIfDisposed(),iu(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.sign=function(){return this.throwIfDisposed(),KU(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.sin=function(){return this.throwIfDisposed(),AR(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.sinh=function(){return this.throwIfDisposed(),FR(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.slice=function(t,e){return this.throwIfDisposed(),at(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.softmax=function(t){return this.throwIfDisposed(),mw(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.softplus=function(){return this.throwIfDisposed(),uf(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),sw(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.split=function(t,e){return this.throwIfDisposed(),gr(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.sqrt=function(){return this.throwIfDisposed(),yn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.square=function(){return this.throwIfDisposed(),dt(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.squaredDifference=function(t){return this.throwIfDisposed(),u5(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.squeeze=function(t){return this.throwIfDisposed(),df(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.stack=function(t,e){this.throwIfDisposed();const n=t instanceof Gt?[this,t]:[this,...t];return vo(n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.step=function(t){return this.throwIfDisposed(),ff(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.stridedSlice=function(t,e,n,r,s,o,i,a){return this.throwIfDisposed(),p5(this,t,e,n,r,s,o,i,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.sub=function(t){return this.throwIfDisposed(),ye(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.sum=function(t,e){return this.throwIfDisposed(),ge(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.tan=function(){return this.throwIfDisposed(),g5(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.tanh=function(){return this.throwIfDisposed(),Wg(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.tile=function(t){return this.throwIfDisposed(),ds(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.toBool=function(){return this.throwIfDisposed(),ce(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.toFloat=function(){return this.throwIfDisposed(),ce(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.toInt=function(){return this.throwIfDisposed(),ce(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.topk=function(t,e){return this.throwIfDisposed(),x5(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.transpose=function(t){return this.throwIfDisposed(),ze(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.unique=function(t){return this.throwIfDisposed(),$5(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),_R(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.unstack=function(t){return this.throwIfDisposed(),ca(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.where=function(t,e){return this.throwIfDisposed(),Fn(t,this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.zerosLike=function(){return this.throwIfDisposed(),Ve(this)};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Rs extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Rs.prototype)}}class Gr extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Gr.prototype)}}class M extends Error{constructor(e){super(e),Object.setPrototypeOf(this,M.prototype)}}class Te extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Te.prototype)}}class Qw extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Qw.prototype)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class ND{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let n;return this.cache.has(e)&&(n=this.cache.get(e),this.cache.delete(e),this.cache.set(e,n)),n}put(e,n){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){const r=this.cache.keys().next().value;this.cache.delete(r)}this.cache.set(e,n)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${e}.`);if(this.maxEntries>e)for(let n=0;n<this.maxEntries-e;n++){const r=this.cache.keys().next().value;this.cache.delete(r)}this.maxEntries=e}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function da(t,e){if(Array.isArray(t)){let n=[];for(let r=0;r<e;r++)n=n.concat(t);return n}else{const n=new Array(e);return n.fill(t),n}}function Ds(t,e){if(!t)throw new Qw(e)}function gS(t,e){let n=0;for(const r of t)r===e&&n++;return n}function Vn(t){return t.length===1?t[0]:t}function et(t){return Array.isArray(t)?t:[t]}function to(t){const n=t.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return n[0]!=="_"?n:"private"+n}function Ri(t){return t.length<=1||t.indexOf("_")===-1?t:t.replace(/[_]+(\w|$)/g,(e,n)=>n.toUpperCase())}let Sr={};function Zw(t){if(t==null)return null;const e={};return e.className=t.getClassName(),e.config=t.getConfig(),e}function ex(t){if(!(t==null||typeof t!="object"))if(Array.isArray(t))t.forEach(e=>ex(e));else{const e=Object.keys(t);for(const n of e){const r=t[n];r!=null&&typeof r=="object"&&(!Array.isArray(r)&&r.type==="ndarray"&&typeof r.value=="number"?t[n]=r.value:ex(r))}}}function gf(t,e={},n={},r="object",s=!1){if(typeof t=="string"){const o=t;let i;if(o in n)i=n[o];else if(o in Sr)i=Sr[o];else if(i=e[o],i==null)throw new M(`Unknown ${r}: ${t}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return i}else{const o=t;if(o.className==null||o.config==null)throw new M(`${r}: Improper config format: ${JSON.stringify(o)}.
'className' and 'config' must set.`);const i=o.className;let a,l;if(i in n?[a,l]=n[i]:i in Sr?[a,l]=Sr.className:i in e&&([a,l]=e[i]),a==null)throw new M(`Unknown ${r}: ${i}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(l!=null){const u={};for(const h of Object.keys(Sr))u[h]=Sr[h];for(const h of Object.keys(n))u[h]=n[h];const c=o.config;c.customObjects=u;const d=Object.assign({},Sr);for(const h of Object.keys(n))Sr[h]=n[h];ex(o.config);const f=l(a,o.config,n,s);return Sr=Object.assign({},d),f}else{const u=Object.assign({},Sr);for(const d of Object.keys(n))Sr[d]=n[d];const c=new a(o.config);return Sr=Object.assign({},u),c}}}function HH(t,e){return t<e?-1:t>e?1:0}function ih(t,e){return-1*HH(t,e)}function Qo(t){if(t==null)return t;const e=[];for(const n of t)e.indexOf(n)===-1&&e.push(n);return e}function jH(t){if(t==null)throw new M(`Invalid value in obj: ${JSON.stringify(t)}`);for(const e in t)if(t.hasOwnProperty(e))return!1;return!0}function Aa(t,e,n){if(n!=null&&t.indexOf(n)<0)throw new M(`${n} is not a valid ${e}.  Valid values are ${t} or null/undefined.`)}function Jw(t,e,n=0,r=1/0){return Ds(n>=0),Ds(r>=n),Array.isArray(t)&&t.length>=n&&t.length<=r&&t.every(s=>typeof s===e)}function tn(t,e){Array.isArray(t)?(D(t.length>0,()=>`${e} is unexpectedly an empty array.`),t.forEach((n,r)=>tn(n,`element ${r+1} of ${e}`))):D(Number.isInteger(t)&&t>0,()=>`Expected ${e} to be a positive integer, but got ${RD(t)}.`)}function RD(t){return t===null?"null":Array.isArray(t)?"["+t.map(e=>RD(e)).join(",")+"]":typeof t=="string"?`"${t}"`:`${t}`}function KH(t,e,n){let r=n!=null?n():_n(),s;return(...i)=>{const a=n!=null?n():_n();return a-r<e||(r=a,s=t(...i)),s}}function DD(t){return t==="relu"?"relu":t==="linear"?"linear":t==="elu"?"elu":null}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let XH=0;function AD(){return XH++}const ah={};function Zg(t=""){return t in ah||(ah[t]=0),ah[t]+=1,t+ah[t].toString()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const qH=["channelsFirst","channelsLast"],YH=["nearest","bilinear"],QH=["valid","same","causal"],ZH=["max","avg"],JH=["sum","mul","concat","ave"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const ja=new Map;function Lt(t){Aa(qH,"DataFormat",t)}function e8(t){Aa(YH,"InterpolationFormat",t)}function $r(t){Aa(QH,"PaddingMode",t)}function FD(t){Aa(ZH,"PoolMode",t)}const hc=[],vS="/";function ji(t,e){hc.push(t);try{const n=e();return hc.pop(),n}catch(n){throw hc.pop(),n}}function t8(){return hc.length===0?"":hc.join(vS)+vS}function PD(t){if(!LD(t))throw new Error("Not a valid tensor name: '"+t+"'");return t8()+t}function OD(t){if(!LD(t))throw new Error("Not a valid tensor name: '"+t+"'");ja.has(t)||ja.set(t,0);const e=ja.get(t);if(ja.set(t,ja.get(t)+1),e>0){const n=`${t}_${e}`;return ja.set(n,1),n}else return t}const n8=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function LD(t){return!!t.match(n8)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function r8(t){return t===parseInt(t.toString(),10)}function Zo(t,e,n){e==null&&(e=0),n==null&&(n=t.length);let r=1;for(let s=e;s<n;++s)r*=t[s];return r}function Hl(t){if(t.length===0)return Number.NaN;let e=Number.POSITIVE_INFINITY;for(let n=0;n<t.length;n++){const r=t[n];r<e&&(e=r)}return e}function si(t){if(t.length===0)return Number.NaN;let e=Number.NEGATIVE_INFINITY;for(let n=0;n<t.length;n++){const r=t[n];r>e&&(e=r)}return e}function bs(t,e){if(e<t)throw new M(`end (${e}) < begin (${t}) is forbidden.`);const n=[];for(let r=t;r<e;++r)n.push(r);return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let lv;function jt(){return lv==null&&(lv=YV().epsilon()),lv}function xs(){return"channelsLast"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Vs(t,e){return ce(t,e)}function vf(t,e=-1){const n=t.shape.slice();return e<0&&(e=n.length+e+1),n.splice(e,0,1),B(t,n)}function s8(t,e){return H(()=>{if(t.shape.length!==2)throw new M(`repeat() expects a rank-2 tensor, but received a rank-${t.shape.length} tensor.`);const n=vf(t,1);return tx(n,[1,e,1])})}function o8(t){const e=[Zo(t.shape)];return B(t,e)}function i8(t){if(t.rank<=1)throw new M(`batchFlatten requires a minimum rank of 2. Got rank: ${t.rank}.`);const e=[t.shape[0],Zo(t.shape,1)];return B(t,e)}function Ki(t,e,n){return H(()=>{switch(t.rank){case 1:return hw(t,e,n);case 2:return PR(t,[e,0],[n,t.shape[1]]);case 3:return pw(t,[e,0,0],[n,t.shape[1],t.shape[2]]);case 4:return Fp(t,[e,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3]]);case 5:return at(t,[e,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4]]);case 6:return at(t,[e,0,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4],t.shape[5]]);default:throw new M(`sliceAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}})}function uv(t,e,n){return H(()=>{switch(t.rank){case 1:return hw(t,e,n);case 2:return PR(t,[0,e],[t.shape[0],n]);case 3:return pw(t,[0,0,e],[t.shape[0],t.shape[1],n]);case 4:return Fp(t,[0,0,0,e],[t.shape[0],t.shape[1],t.shape[2],n]);default:throw new M(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function lh(t,e,n,r){return H(()=>{switch(t.rank){case 1:return hw(t,e,n);case 2:switch(r){case 1:return Ki(t,e,n);case 2:return uv(t,e,n);default:throw new M(`The axis is not within the rank of the tensor ${r}`)}case 3:switch(r){case 1:return Ki(t,e,n);case 2:return pw(t,[0,e,0],[t.shape[0],n,t.shape[2]]);case 3:return uv(t,e,n);default:throw new M(`The axis is not within the rank of the tensor ${r}`)}case 4:switch(r){case 1:return Ki(t,e,n);case 2:return Fp(t,[0,e,0,0],[t.shape[0],n,t.shape[2],t.shape[3]]);case 3:return Fp(t,[0,0,e,0],[t.shape[0],t.shape[1],n,t.shape[3]]);case 4:return uv(t,e,n);default:throw new M(`The axis is not within the rank of the tensor ${r}`)}default:throw new M(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function e$(t,e=-1){let n;return e<0&&(n=t[0].rank,n!==0?e=n:e=0),e===t[0].rank&&(e=-1),Un(t,e)}function bS(t,e){switch(t.rank){case 1:return xW([t,e]);case 2:return wW([t,e],0);case 3:return CW([t,e],0);case 4:return SW([t,e],0);default:throw new M(`concatAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}}function tx(t,e){if(Array.isArray(e)||(e=[e]),t.rank!==e.length)throw new M(`The length of input n (${e.length}) does not match the number of dimensions in input x (${t.rank})`);return ds(t,e)}function Jg(t,e=0,n=1,r,s){return PU(t,e,n,r,s)}function Bs(t,e,n,r){if(t.rank<2||e.rank<2)throw new Te(`dot requires both inputs to be rank >= 2 but got x shape = ${t.shape} and y shape = ${e.shape}`);if(e.rank>=3){const s=t.shape.slice(-1)[0],o=e.shape.slice(-2)[0];if(s!==o)throw new Te(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${t.shape} and  y shape = ${e.shape}`)}if(t.rank===2&&e.rank===2)return sS({a:t,b:e,transposeA:!1,transposeB:!1,bias:r?nx(t.rank,r,xs()):null,activation:n});{const s=t.shape.slice(),o=s.pop();t=B(t,[-1,o]);const i=e.shape.slice(),a=i.pop(),l=i.pop(),u=[...i,a],c=Array.from({length:e.rank},(p,g)=>g===0?e.rank-2:g<=e.rank-2?g-1:g);e=B(ze(e,c),[l,-1]);const d=[...s,...u];return B(sS({a:t,b:e,transposeA:!1,transposeB:!1,bias:r?nx(t.rank,r,xs()):null,activation:n}),d)}}function MD(t,e,n){return H(()=>(Array.isArray(e)?e=er(e,"int32"):e=ce(e,"int32"),Q1(t,e,n)))}function bf(t){return _(t,t)}function nx(t,e,n){const r=e.shape;if(e.rank!==1&&e.rank!==t)throw new M(`Unexpected bias dimensions: ${e.rank}; expected it to be 1 or ${t}`);if(t===5){if(n==="channelsFirst")return r.length===1?B(e,[1,r[0],1,1,1]):B(e,[1,r[3],r[0],r[1],r[2]]);if(n==="channelsLast")return r.length===1?B(e,[1,1,1,1,r[0]]):B(e,[1].concat(r))}else if(t===4){if(n==="channelsFirst")return r.length===1?B(e,[1,r[0],1,1]):B(e,[1,r[2],r[0],r[1]]);if(n==="channelsLast")return r.length===1?B(e,[1,1,1,r[0]]):B(e,[1].concat(r))}else if(t===3){if(n==="channelsFirst")return r.length===1?B(e,[1,r[0],1]):B(e,[1,r[1],r[0]]);if(n==="channelsLast")return r.length===1?B(e,[1,1,r[0]]):B(e,[1].concat(r))}else if(t<3)return e;throw new M(`Unsupported input rank by biasAdd: ${e.rank}`)}function ks(t,e,n){return H(()=>(n==null&&(n=xs()),Lt(n),ne(t,nx(t.rank,e,n))))}function a8(t,e=1){if(e!==1)throw new Te(`Support for alpha values other than 1 (${e}) is not implemented yet.`);return Hg(t)}function l8(t){return H(()=>be(t,ne(En(t),1)))}function _D(t,e,n,r){return H(()=>N5(t,e,n,r))}function u8(t){return H(()=>{const e=ne(.5,_(.2,t));return br(e,0,1)})}function xf(t,e,n=!1){return n?t():e()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const c8=["fanIn","fanOut","fanAvg"],d8=["normal","uniform","truncatedNormal"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function f8(t){Aa(c8,"FanMode",t)}function h8(t){Aa(d8,"Distribution",t)}class Jr extends uu{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class zD extends Jr{apply(e,n){return Ct(e,n)}}zD.className="Zeros";ee(zD);class t$ extends Jr{apply(e,n){return ko(e,n)}}t$.className="Ones";ee(t$);class VD extends Jr{constructor(e){if(super(),typeof e!="object")throw new M(`Expected argument of type ConstantConfig but got ${e}`);if(e.value===void 0)throw new M(`config must have value set but got ${e}`);this.value=e.value}apply(e,n){return H(()=>_(qe(this.value),ko(e,n)))}getConfig(){return{value:this.value}}}VD.className="Constant";ee(VD);class BD extends Jr{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,n){return cf(e,this.minval,this.maxval,n,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}BD.className="RandomUniform";ee(BD);class WD extends Jr{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Te(`randomNormal does not support dType ${n}.`);return Jg(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}WD.className="RandomNormal";ee(WD);class UD extends Jr{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Te(`truncatedNormal does not support dType ${n}.`);return MR(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}UD.className="TruncatedNormal";ee(UD);class GD extends Jr{constructor(e){super(),this.gain=e.gain!=null?e.gain:1}apply(e,n){return H(()=>{if(e.length!==2||e[0]!==e[1])throw new M("Identity matrix initializer can only be used for 2D square matrices.");return _(this.gain,xR(e[0]))})}getConfig(){return{gain:this.gain}}}GD.className="Identity";ee(GD);function p8(t,e="channelsLast"){let n,r;if(Lt(e),t.length===2)n=t[0],r=t[1];else if([3,4,5].indexOf(t.length)!==-1){if(e==="channelsFirst"){const s=Zo(t,2);n=t[1]*s,r=t[0]*s}else if(e==="channelsLast"){const s=Zo(t,0,t.length-2);n=t[t.length-2]*s,r=t[t.length-1]*s}}else{const s=Zo(t);n=Math.sqrt(s),r=Math.sqrt(s)}return[n,r]}class or extends Jr{constructor(e){if(super(),e.scale<0)throw new M(`scale must be a positive float. Got: ${e.scale}`);this.scale=e.scale==null?1:e.scale,this.mode=e.mode==null?"fanIn":e.mode,f8(this.mode),this.distribution=e.distribution==null?"normal":e.distribution,h8(this.distribution),this.seed=e.seed}apply(e,n){const r=p8(e),s=r[0],o=r[1];let i=this.scale;if(this.mode==="fanIn"?i/=Math.max(1,s):this.mode==="fanOut"?i/=Math.max(1,o):i/=Math.max(1,(s+o)/2),this.distribution==="normal"){const a=Math.sqrt(i);if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Te(`${this.getClassName()} does not support dType ${n}.`);return MR(e,0,a,n,this.seed)}else{const a=Math.sqrt(3*i);return cf(e,-a,a,n,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}or.className="VarianceScaling";ee(or);class n$ extends or{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return or.className}}n$.className="GlorotUniform";ee(n$);class r$ extends or{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return or.className}}r$.className="GlorotNormal";ee(r$);class s$ extends or{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return or.className}}s$.className="HeNormal";ee(s$);class o$ extends or{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return or.className}}o$.className="HeUniform";ee(o$);class i$ extends or{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return or.className}}i$.className="LeCunNormal";ee(i$);class a$ extends or{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return or.className}}a$.className="LeCunUniform";ee(a$);class HD extends Jr{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=e.gain==null?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,n){return H(()=>{if(e.length<2)throw new Te("Shape must be at least 2D.");if(n!=="int32"&&n!=="float32"&&n!==void 0)throw new TypeError(`Unsupported data type ${n}.`);n=n;const r=q(e.slice(0,-1)),s=e[e.length-1],o=r*s;o>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${o}) elements: Slowness may result.`);const i=[Math.max(s,r),Math.min(s,r)],a=Jg(i,0,1,n,this.seed),l=SG.qr(a,!1);let u=l[0];const d=l[1].flatten().stridedSlice([0],[Math.min(s,r)*Math.min(s,r)],[Math.min(s,r)+1]);return u=_(u,d.sign()),r<s&&(u=u.transpose()),_(qe(this.gain),u.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}}HD.className="Orthogonal";ee(HD);const xS={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function yS(t,e={}){return gf(t,zr.getMap().classNameMap,e,"initializer")}function St(t){return Zw(t)}function vt(t){if(typeof t=="string"){const e=t in xS?xS[t]:t;if(e==="GlorotNormal")return new r$;if(e==="GlorotUniform")return new n$;if(e==="HeNormal")return new s$;if(e==="HeUniform")return new o$;if(e==="LeCunNormal")return new i$;if(e==="LeCunUniform")return new a$;{const n={};return n.className=e,n.config={},yS(n)}}else return t instanceof Jr?t:yS(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function rx(t){return Array.isArray(t)&&Array.isArray(t[0])}function Pp(t){return t.length===0?[]:Array.isArray(t[0])?t:[t]}function we(t){let e;if(Array.isArray(t)){if(t.length!==1)throw new M(`Expected Tensor length to be 1; got ${t.length}`);e=t[0]}else e=t;return e}function Ge(t){if(Array.isArray(t)&&Array.isArray(t[0])){if(t.length===1)return t=t,t[0];throw new M(`Expected exactly 1 Shape; got ${t.length}`)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Op(t){let e=0;for(const n of t)n.shape.length===0?e+=1:e+=n.shape.reduce((r,s)=>r*s);return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const wS="Variable";class m8{constructor(e,n="float32",r=wS,s=!0,o=null){this.dtype=n??"float32",this.shape=e.shape,this.id=AD(),r=r??wS,this.originalName=PD(r),this.name=OD(this.originalName),this.trainable_=s,this.constraint=o,this.val=S5(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),g8(this.val,e),this.val.id!==e.id&&(this.val.assign(e),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}}function g8(t,e){if(t.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(t.shape)+" vs. "+JSON.stringify(e.shape))}function sx(t){return t.map(e=>e.read())}function l$(t){t.forEach(e=>{e[0].write(e[1])})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Kt{constructor(e){this.dtype=e.dtype,this.shape=e.shape,e.shape!=null?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}class js{constructor(e,n,r,s,o,i,a){this.dtype=e,this.shape=n,this.sourceLayer=r,this.inputs=s,this.callArgs=o,this.outputTensorIndex=a,this.id=AD(),i!=null&&(this.originalName=PD(i),this.name=OD(this.originalName)),this.rank=n.length}}let v8=0;class e0{constructor(e,n){this.callArgs=n,this.id=v8++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(const r of e.inboundLayers)r!=null&&r.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){const e=[];for(const n of this.inboundLayers)n!=null?e.push(n.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let b8=0;class Ae extends uu{constructor(e={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=b8++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let n=e.name;if(!n){const r=this.getClassName();n=to(r)+"_"+Zg(r)}if(this.name=n,this.trainable_=e.trainable==null?!0:e.trainable,e.inputShape!=null||e.batchInputShape!=null){let r;if(e.batchInputShape!=null)r=e.batchInputShape;else if(e.inputShape!=null){let o=null;e.batchSize!=null&&(o=e.batchSize),r=[o].concat(e.inputShape)}this.batchInputShape=r;let s=e.dtype;s==null&&(s=e.inputDType),s==null&&(s="float32"),this.dtype=s}e.weights!=null?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,n){return e.name+"_ib-"+n.toString()}getNodeAtIndex(e,n){if(this.inboundNodes.length===0)throw new Gr(`The layer has never been called and thus has no defined ${n}.`);if(this.inboundNodes.length<=e)throw new M(`Asked to get ${n} at node ${e}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[e]}getInputAt(e){return Vn(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return Vn(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new Rs(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new Rs(`Layer ${this.name} is not connected, no input to return.`);return Vn(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new Rs(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new Rs(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return Vn(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(n=>n.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){const n=et(e);if(this.inputSpec==null||this.inputSpec.length===0)return;const r=et(this.inputSpec);if(n.length!==r.length)throw new M(`Layer ${this.name} expects ${r.length} inputs, but it received ${n.length} input tensors. Input received: ${e}`);for(let s=0;s<n.length;s++){const o=n[s],i=r[s];if(i==null)continue;const a=o.rank;if(i.ndim!=null&&a!==i.ndim)throw new M(`Input ${s} is incompatible with layer ${this.name}: expected ndim=${i.ndim}, found ndim=${a}`);if(i.maxNDim!=null&&a>i.maxNDim)throw new M(`Input ${s} is incompatible with layer ${this.name}: expected max_ndim=${i.maxNDim}, found ndim=${a}`);if(i.minNDim!=null&&a<i.minNDim)throw new M(`Input ${s} is incompatible with layer ${this.name}: expected min_ndim=${i.minNDim}, found ndim=${a}.`);if(i.dtype!=null&&o.dtype!==i.dtype)throw new M(`Input ${s} is incompatible with layer ${this.name} : expected dtype=${i.dtype}, found dtype=${o.dtype}.`);if(i.axes){const l=o.shape;for(const u in i.axes){const c=Number(u),d=i.axes[u],f=c>=0?l[c]:l[l.length+c];if(d!=null&&[d,null].indexOf(f)===-1)throw new M(`Input ${s} is incompatible with layer ${this.name}: expected axis ${c} of input shape to have value ${d} but got shape ${l}.`)}}if(i.shape!=null)for(let l=0;l<i.shape.length;++l){const u=i.shape[l],c=o.shape[l];if(u!=null&&c!=null&&u!==c)throw new M(`Input ${s} is incompatible with layer ${this.name}: expected shape=${i.shape}, found shape=${o.shape}.`)}}}call(e,n){return e}invokeCallHook(e,n){this._callHook!=null&&this._callHook(e,n)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,n){n=n||{},this.assertNotDisposed();const r=et(e),s=w8(e),o=$8(e);if(s===o)throw new M("Arguments to apply() must be all SymbolicTensors or all Tensors");return ji(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);const i=[];for(const a of et(e))i.push(a.shape);this.build(Vn(i)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&o&&(this._refCount=1)}if(this.assertInputCompatibility(e),o){let i=this.call(e,n);this.supportsMasking&&this.setMaskMetadata(e,i);const a=et(i),l=[];for(let u of a)r.indexOf(u)!==-1&&(u=u.clone()),l.push(u);if(i=Vn(l),this.activityRegularizer!=null)throw new Te("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return i}else{const i=x8(e),a=this.computeOutputShape(i);let l;const u=y8(e);if(this.warnOnIncompatibleInputShape(Array.isArray(e)?i[0]:i),a!=null&&a.length>0&&Array.isArray(a[0])?l=a.map((c,d)=>new js(u,c,this,et(e),n,this.name,d)):l=new js(u,a,this,et(e),n,this.name),this.addInboundNode(e,l,null,null,i,a,n),this._refCount++,this.activityRegularizer!=null)throw new Te("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return l}})}warnOnIncompatibleInputShape(e){if(this.batchInputShape!=null)if(e.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(e)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let n=!1;this.batchInputShape.forEach((r,s)=>{r!=null&&e[s]!=null&&e[s]!==r&&(n=!0)}),n&&console.warn(`The shape of the input tensor (${JSON.stringify(e)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new Rs(`The layer ${this.name} has never been called and thus has no defined output shape.`);const e=[];for(const n of this.inboundNodes){const r=JSON.stringify(n.outputShapes);e.indexOf(r)===-1&&e.push(r)}if(e.length===1){const n=this.inboundNodes[0].outputShapes;return Array.isArray(n)&&Array.isArray(n[0])&&n.length===1?n[0]:n}else throw new Rs(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new Gr(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return Op(this.weights)}build(e){this.built=!0}getWeights(e=!1){return sx(e?this.trainableWeights:this.weights)}setWeights(e){H(()=>{const n=this.weights;if(n.length!==e.length)throw new M(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${e.length}, but the layer was expecting ${n.length} weights. Provided weights: ${e}...`);if(n.length===0)return;const r=[],s=sx(n);for(let o=0;o<s.length;++o){const i=s[o],a=n[o],l=e[o];if(!Ye(i.shape,l.shape))throw new M(`Layer weight shape ${i.shape} not compatible with provided weight shape ${l.shape}`);r.push([a,l])}l$(r)})}addWeight(e,n,r,s,o,i,a,l){if(this._addedWeightNames.indexOf(e)!==-1)throw new M(`Duplicate weight name ${e} for layer ${this.name}`);this._addedWeightNames.push(e),r==null&&(r="float32"),this.fastWeightInitDuringBuild&&(s=l!=null?l():vt("zeros"));const u=s.apply(n,r),c=new m8(u,r,e,i,a);return u.dispose(),o!=null&&this.addLoss(()=>o.apply(c.read())),i==null&&(i=!0),i?this._trainableWeights.push(c):this._nonTrainableWeights.push(c),c}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){e==null||Array.isArray(e)&&e.length===0||(e=et(e),this._losses!==void 0&&this._losses!==null&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,n){if(!this.supportsMasking){if(n!=null)if(Array.isArray(n))n.forEach(r=>{if(r!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return n}setMaskMetadata(e,n,r){if(!this.supportsMasking)return;const s=this.computeMask(e,r),o=et(n),i=et(s);if(o.length!==i.length)throw new Error(`${this.name} outputs ${o.length} tensors but ${o.length} masks for those tensors`);for(let a=0;a<o.length;a++)o[a].kerasMask=i[a]}addInboundNode(e,n,r,s,o,i,a=null){const l=et(e);n=et(n),r=et(r),s=et(s),o=Pp(o),i=Pp(i);const u=[],c=[],d=[];for(const f of l)u.push(f.sourceLayer),c.push(f.nodeIndex),d.push(f.tensorIndex);new e0({outboundLayer:this,inboundLayers:u,nodeIndices:c,tensorIndices:d,inputTensors:l,outputTensors:n,inputMasks:r,outputMasks:s,inputShapes:o,outputShapes:i},a);for(let f=0;f<n.length;f++)n[f].sourceLayer=this,n[f].nodeIndex=this.inboundNodes.length-1,n[f].tensorIndex=f}getConfig(){const e={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(e.batchInputShape=this.batchInputShape),this.dtype!=null&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let e=0;return--this._refCount===0&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}function x8(t){t=et(t);const e=[];for(const n of t)e.push(n.shape);return Vn(e)}function y8(t){return"float32"}function jD(t,e,n){if((e==null||n!=null&&n>0)&&(e=t.sourceLayer,n=t.nodeIndex),e.inboundNodes.length===0)return[t];{const r=e.inboundNodes[n];if(r.inboundLayers.length===0)return r.inputTensors;{const s=[];for(let o=0;o<r.inboundLayers.length;o++){const i=r.inputTensors[o],a=r.inboundLayers[o],l=r.nodeIndices[o],u=jD(i,a,l);for(const c of u)s.indexOf(c)===-1&&s.push(c)}return s}}}function w8(t){let e=!0;for(const n of et(t))if(!(n instanceof js)){e=!1;break}return e}function $8(t){let e=!0;for(const n of et(t))if(n instanceof js){e=!1;break}return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class yf extends Ae{constructor(e){if(super({dtype:e.dtype,name:e.name!=null?e.name:Zg("input").toString()}),e.batchSize==null&&(e.batchSize=null),e.sparse==null&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new M("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let n=e.batchInputShape;if(n==null){if(e.inputShape==null)throw new M("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");n=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new M("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const r=e.dtype||"float32";this.batchInputShape=n,this.dtype=r,this.inputSpec=[{shape:n}];const s=new js(this.dtype,this.batchInputShape,this,[],{},this.name);s.nodeIndex=0,s.tensorIndex=0,new e0({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[s],outputTensors:[s],inputMasks:[null],outputMasks:[null],inputShapes:[n],outputShapes:[n]})}apply(e,n){throw new M(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}yf.className="InputLayer";ee(yf);function C8(t){if(t.batchShape==null&&t.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(t.batchShape!=null&&t.shape!=null)throw new M("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=t.batchShape;t.shape!=null&&e==null&&(e=[null].concat(t.shape));let n=t.dtype;return n==null&&(n="float32"),new yf({batchInputShape:e,name:t.name,dtype:n,sparse:t.sparse}).inboundNodes[0].outputTensors[0]}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function k8(t,e){if(t.dtype==null||t.dtype===e.dtype)return e;try{return ce(e,t.dtype)}catch{throw new M(`The dtype of the feed (${e.dtype}) can not be cast to the dtype of the key '${t.name}' (${t.dtype}).`)}}class _o{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof _o)for(const n in e.id2Value)this.id2Value[n]=e.id2Value[n],n in e.id2Mask&&(this.id2Mask[n]=e.id2Mask[n]);else{if(e==null)return;for(const n of e)this.add(n.key,n.value)}}add(e,n,r){if(this.id2Value[e.id]==null)this.id2Value[e.id]=k8(e,n),this.name2Id[e.name]=e.id,r!=null&&(this.id2Mask[e.id]=r);else throw new M(`Duplicate key: name=${e.name}, id=${e.id}`);return this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return this.id2Value[e.id]!=null}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof js){if(this.id2Value[e.id]==null)throw new M(`Nonexistent key: ${e.name}`);return this.id2Value[e.id]}else{const n=this.name2Id[e];if(n==null)throw new M(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Value[n]}}getMask(e){if(e instanceof js){if(this.id2Value[e.id]==null)throw new M(`Nonexistent key: ${e.name}`);return this.id2Mask[e.id]}else{const n=this.name2Id[e];if(n==null)throw new M(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Mask[n]}}disposeMasks(){this.id2Mask!=null&&Fe(this.id2Mask)}}const Lp=new ND,Mp=new ND;function S8(t){Lp!=null&&Lp.setMaxEntries(t),Mp!=null&&Mp.setMaxEntries(t)}function Yu(t,e,n,r){const s=n==null?!1:n.training,o=Array.isArray(t),i=o?t:[t],a=i.map(p=>p.name),l=[],u=e.names();for(const p of a)u.indexOf(p)!==-1?l.push(e.getValue(p)):l.push(null);const c=a.join(",")+"|"+e.names().sort().join(",");let d=Lp.get(c),f;if(d==null){const p=I8(i,e);d=p.sorted,f=p.recipientCounts,Lp.put(c,d),Mp.put(c,f)}f={},s||Object.assign(f,Mp.get(c));const h=new _o(e);for(let p=0;p<d.length;++p){const g=d[p],v=g.sourceLayer;if(v instanceof yf)continue;const m=[],b=[],x=[];let y=!1;for(const I of g.inputs){const N=h.getValue(I),E=h.getMask(I);m.push(N),b.push(E),E!=null&&(y=!0),s||(f[I.name]--,f[I.name]===0&&!e.hasKey(I)&&a.indexOf(I.name)===-1&&!N.isDisposed&&I.sourceLayer.stateful!==!0&&x.push(N))}y&&(n=n||{},n.mask=b[0]);const $=et(v.apply(m,n));let C=null;v.supportsMasking&&(C=v.computeMask(m,b));const k=E8(g),w=Array.isArray(k)?k:[k];for(let I=0;I<w.length;++I){h.hasKey(w[I])||h.add(w[I],$[I],Array.isArray(C)?C[0]:C);const N=a.indexOf(w[I].name);N!==-1&&(l[N]=$[I])}s||Fe(x)}return h.disposeMasks(),o?l:l[0]}function I8(t,e){D(t!=null&&t.length>0,()=>"Expected at least one fetch, got none");let n=[],r={};if(t.length===1){const s=$S(t[0],e);n=s.sorted,r=s.recipientMap}else{const s=new Set;for(const o of t){const{sorted:i,recipientMap:a}=$S(o,e);for(const l of i)s.has(l.name)||(n.push(l),s.add(l.name));for(const l in a)r[l]==null&&(r[l]=new Set),a[l].forEach(u=>r[l].add(u))}}return{sorted:n,recipientCounts:T8(r)}}function T8(t){const e={};for(const n in t)e[n]=t[n].size;return e}function $S(t,e){const n=new Set,r=[],s={};for(const a of e.names())n.add(a);const o=[],i=[];for(o.push(t);o.length>0;){const a=o[o.length-1];if(n.has(a.name)){o.pop();continue}const l=i[i.length-1]===o.length-1;if(a.inputs.length===0||l)o.pop(),r.push(a),n.add(a.name),l&&i.pop();else{i.push(o.length-1);for(const u of a.inputs)s[u.name]==null&&(s[u.name]=new Set),s[u.name].add(a.name),!n.has(u.name)&&o.push(u)}}return{sorted:r,recipientMap:s}}function E8(t){let e;if(t.sourceLayer.inboundNodes.length===1)e=t.sourceLayer.output;else{let n=null;for(let r=0;r<t.sourceLayer.inboundNodes.length;++r)for(const s of t.sourceLayer.inboundNodes[r].outputTensors)if(s.id===t.id){n=r;break}e=t.sourceLayer.getOutputAt(n)}return e}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N8=j();N8.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,S8);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function u$(t,e){return H(()=>yn(ge(_(t,t),e,!0)))}class wf extends uu{getConfig(){return{}}}class KD extends wf{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return H(()=>{const n=u$(e,this.axis),r=br(n,0,this.maxValue);return _(e,be(r,ne(jt(),n)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}KD.className="MaxNorm";ee(KD);class XD extends wf{constructor(e){super(),this.defaultAxis=0,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return H(()=>be(e,ne(jt(),u$(e,this.axis))))}getConfig(){return{axis:this.axis}}}XD.className="UnitNorm";ee(XD);class qD extends wf{apply(e){return Ra(e)}}qD.className="NonNeg";ee(qD);class YD extends wf{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=e.minValue!=null?e.minValue:this.defaultMinValue,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.rate=e.rate!=null?e.rate:this.defaultRate,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return H(()=>{const n=u$(e,this.axis),r=ne(_(this.rate,br(n,this.minValue,this.maxValue)),_(1-this.rate,n));return _(e,be(r,ne(jt(),n)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}YD.className="MinMaxNorm";ee(YD);const CS={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function Xt(t){return Zw(t)}function kS(t,e={}){return gf(t,zr.getMap().classNameMap,e,"constraint")}function qt(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in CS?CS[t]:t,config:{}};return kS(n)}else return t instanceof wf?t:kS(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function $i(t){if(t==null)return;const e=[],n=[],r=[];for(const s in t){const o=t[s];if(typeof o!="number"){const i=o;e.push(i.data()),n.push(s),r.push(i)}}if(e.length>0){const s=await Promise.all(e);for(let o=0;o<s.length;++o)t[n[o]]=s[o][0];Fe(r)}}function QD(t){if(t!=null)for(const e in t){const n=t[e];typeof n!="number"&&n.dispose()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var SS;(function(t){t[t.SILENT=0]="SILENT",t[t.VERBOSE=1]="VERBOSE"})(SS||(SS={}));const R8=125;class Kc{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,n){}async onEpochEnd(e,n){}async onBatchBegin(e,n){}async onBatchEnd(e,n){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}}class D8{constructor(e,n=10){e==null&&(e=[]),this.callbacks=e,this.queueLength=n}append(e){this.callbacks.push(e)}setParams(e){for(const n of this.callbacks)n.setParams(e)}setModel(e){for(const n of this.callbacks)n.setModel(e)}async onEpochBegin(e,n){n==null&&(n={});for(const r of this.callbacks)await r.onEpochBegin(e,n)}async onEpochEnd(e,n){n==null&&(n={});for(const r of this.callbacks)await r.onEpochEnd(e,n)}async onBatchBegin(e,n){n==null&&(n={});for(const r of this.callbacks)await r.onBatchBegin(e,n)}async onBatchEnd(e,n){n==null&&(n={});for(const r of this.callbacks)await r.onBatchEnd(e,n)}async onTrainBegin(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainBegin(e)}async onTrainEnd(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainEnd(e)}}class A8 extends Kc{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,n){n==null&&(n={});const r=n.size==null?0:n.size;this.seen+=r;for(const s in n){const o=n[s];if(typeof o=="number")this.totals.hasOwnProperty(s)||(this.totals[s]=0),this.totals[s]=this.totals[s]+o*r;else{let i;s in this.totals?i=this.totals[s]:this.totals[s]=0;const a=H(()=>ne(this.totals[s],_(o,r)));this.totals[s]=a,i!=null&&i.dispose()}}}async onEpochEnd(e,n){if(n!=null)for(const r of this.params.metrics)this.totals[r]!=null&&(typeof this.totals[r]=="number"?n[r]=this.totals[r]/this.seen:H(()=>{const s=_(be(1,this.seen),this.totals[r]);n[r]=s,this.totals[r].dispose(),_s(n[r])}))}}class F8 extends Kc{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,n){n==null&&(n={}),this.epoch.push(e);for(const r in n)this.history[r]==null&&(this.history[r]=[]),this.history[r].push(n[r])}async syncData(){const e=[],n=[],r=[];for(const o in this.history){const i=this.history[o];for(let a=0;a<i.length;++a)if(typeof i[a]!="number"){const l=i[a];e.push(l.data()),n.push(o),r.push(a)}}const s=await Promise.all(e);for(let o=0;o<s.length;++o)this.history[n[o]][r[o]].dispose(),this.history[n[o]][r[o]]=s[o][0]}}class P8 extends Kc{constructor(e,n){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||nD,this.yieldEvery=n||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=R8),this.yieldEvery==="never"&&e.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");Fb(this.yieldEvery)&&(this.maybeWait=KH(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,n,r){const s=[];this.yield!=null&&(await $i(r),s.push(this.yield(e,n,r))),s.push(this.nextFrameFunc()),await Promise.all(s)}async onEpochBegin(e,n){this.currentEpoch=e,this.epochBegin!=null&&(await $i(n),await this.epochBegin(e,n))}async onEpochEnd(e,n){const r=[];this.epochEnd!=null&&(await $i(n),r.push(this.epochEnd(e,n))),this.yieldEvery==="epoch"&&r.push(this.nextFrameFunc()),await Promise.all(r)}async onBatchBegin(e,n){this.batchBegin!=null&&(await $i(n),await this.batchBegin(e,n))}async onBatchEnd(e,n){const r=[];this.batchEnd!=null&&(await $i(n),r.push(this.batchEnd(e,n))),this.yieldEvery==="batch"?r.push(this.nextFrameFunc()):Fb(this.yieldEvery)&&r.push(this.maybeWait(this.currentEpoch,e,n)),await Promise.all(r)}async onTrainBegin(e){this.trainBegin!=null&&(await $i(e),await this.trainBegin(e))}async onTrainEnd(e){this.trainEnd!=null&&(await $i(e),await this.trainEnd(e))}}function ZD(t,e){return t==null&&(t={}),t instanceof Kc?[t]:Array.isArray(t)&&t[0]instanceof Kc?t:et(t).map(r=>new P8(r,e))}class Nr{constructor(){}static registerCallbackConstructor(e,n){D(e>=0&&Number.isInteger(e),()=>`Verbosity level is expected to be an integer >= 0, but got ${e}`),Nr.checkForDuplicate(n),Nr.constructors[e]==null&&(Nr.constructors[e]=[]),Nr.constructors[e].push(n)}static checkForDuplicate(e){for(const n in Nr.constructors)Nr.constructors[+n].forEach(s=>{if(s===e)throw new M("Duplicate callback constructor.")})}static clear(){Nr.constructors={}}static createCallbacks(e){const n=[];for(const r in Nr.constructors){const s=+r;e>=s&&n.push(...Nr.constructors[s])}return n.map(r=>new r)}}Nr.constructors={};function JD(t,e,n,r,s,o,i,a,l){const u=new F8,c=[new A8,...Nr.createCallbacks(e)];t!=null&&c.push(...t),c.push(u);const d=new D8(c);return d.setParams({epochs:n,initialEpoch:r,samples:s,steps:o,batchSize:i,verbose:e,doValidation:a,metrics:l}),{callbackList:d,history:u}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function co(t,e={},n=!1){return gf(t,zr.getMap().classNameMap,e,"layer",n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function _p(t,e){return H(()=>{t.dtype!=="float32"&&(t=ce(t,"float32"));const n=ge(bf(t),e,!0),r=Gg(n.shape,jt()),s=yn(gi(n,r));return be(t,s)})}function t0(t,e){return H(()=>zt(bf(ye(e,t)),-1))}function c$(t,e){return H(()=>zt(En(ye(e,t)),-1))}function d$(t,e){return H(()=>{const n=ye(t,e),r=br(En(t),jt(),Number.MAX_VALUE),s=En(be(n,r));return _(100,zt(s,-1))})}function O8(t,e){return H(()=>{const n=br(e,jt(),Number.MAX_VALUE),r=Hs(ne(1,n)),s=br(t,jt(),Number.MAX_VALUE),o=Hs(ne(1,s));return zt(bf(ye(r,o)),-1)})}function L8(t,e){return H(()=>{const n=gi(0,ye(1,_(t,e)));return zt(bf(n),-1)})}function M8(t,e){return H(()=>{const n=gi(0,ye(1,_(t,e)));return zt(n,-1)})}function _8(t,e){return H(()=>{const n=ge(_(t,e),-1),r=ms(_(ye(1,t),e),-1);return gi(0,ne(1,ye(r,n)))})}function z8(t,e){return H(()=>{const n=Math.log(2),r=ye(e,t),s=ye(ne(r,uf(_(-2,r))),n);return zt(s,-1)})}function Xc(t,e,n=!1){return H(()=>{if(n)e=mw(e);else{const r=ge(e,e.shape.length-1,!0);e=be(e,r)}return e=br(e,jt(),1-jt()),Ft(ge(_(ce(t,"float32"),Hs(e)),e.shape.length-1))})}function zp(t,e,n=!1){return H(()=>{const r=ce(Kg(o8(t)),"int32");e=br(e,jt(),1-jt());const s=e.shape,o=B(kR(r,s[s.length-1]),s);return Xc(o,e,n)})}function V8(t,e){if(!Ye(t.shape,e.shape))throw new M(`logits and labels must have the same shape, but got shapes ${JSON.stringify(t.shape)} and ${JSON.stringify(e.shape)}`);return H(()=>{const n=Ra(e),r=Ft(En(e));return ne(ye(n,_(e,t)),yR(Gs(r)))})}function n0(t,e){return H(()=>{let n;return n=br(e,jt(),1-jt()),n=Hs(be(n,ye(1,n))),zt(V8(t,n),-1)})}function B8(t,e){return H(()=>{const n=br(t,jt(),1),r=br(e,jt(),1);return ge(_(t,Hs(be(n,r))),-1)})}function W8(t,e){return H(()=>{const n=Hs(ne(jt(),e));return zt(ye(e,_(t,n)),-1)})}function eA(t,e){return H(()=>{const n=_p(t,-1),r=_p(e,-1),s=_(n,r);return Ft(ge(s,-1))})}const Vp={meanSquaredError:t0,meanAbsoluteError:c$,meanAbsolutePercentageError:d$,meanSquaredLogarithmicError:O8,squaredHinge:L8,hinge:M8,categoricalHinge:_8,logcosh:z8,categoricalCrossentropy:Xc,sparseCategoricalCrossentropy:zp,binaryCrossentropy:n0,kullbackLeiblerDivergence:B8,poisson:W8,cosineProximity:eA};function cv(t){if(typeof t=="string"){if(t in Vp)return Vp[t];let e=`Unknown loss ${t}`;throw t.toLowerCase().includes("softmaxcrossentropy")&&(e=`Unknown loss ${t}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new M(e)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function tA(t,e){return H(()=>{const n=_(.5,Yr(e)),r=Vs(wr(e,n),t.dtype);return zt(Us(t,r),-1)})}function nA(t,e){return H(()=>Vs(Us(Wc(t,-1),Wc(e,-1)),"float32"))}function U8(t,e){return H(()=>ce(ge(go(Us(t,1),Us(e,1))),"float32"))}function G8(t,e){return H(()=>ce(ge(go(Us(t,0),Us(e,1))),"float32"))}function H8(t,e){return H(()=>{const n=U8(t,e),r=G8(t,e),s=ne(n,r);return ce(Fn(wr(s,0),be(n,s),0),"float32")})}function j8(t,e){return n0(t,e)}function K8(t,e){return t.rank===e.rank&&(t=df(t,[t.rank-1])),e=Wc(e,-1),e.dtype!==t.dtype&&(e=ce(e,t.dtype)),ce(Us(t,e),"float32")}const X8=t0,q8=t0,Y8=c$,Q8=c$,Z8=d$,J8=d$,rA=Xc,ej=eA,sA=zp,Bp={binaryAccuracy:tA,categoricalAccuracy:nA,precision:H8,categoricalCrossentropy:rA,sparseCategoricalCrossentropy:sA,mse:X8,MSE:q8,mae:Y8,MAE:Q8,mape:Z8,MAPE:J8,cosine:ej};function tj(t){if(typeof t=="string"&&t in Bp)return Bp[t];if(typeof t!="string"&&t!=null)return t;throw new M(`Unknown metric ${t}`)}function uh(t){if(Ds(t!==null,`Unknown LossOrMetricFn ${t}`),typeof t=="string")return t;{let e;for(const n of Object.keys(Vp))if(Vp[n]===t){e=n;break}if(e!==void 0)return e;for(const n of Object.keys(Bp))if(Bp[n]===t){e=n;break}return e!==void 0?e:t.name}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function nj(t){const e={Adagrad:()=>Ha.adagrad(.01),Adadelta:()=>Ha.adadelta(1,.95,jt()),Adam:()=>Ha.adam(.001,.9,.999,jt()),Adamax:()=>Ha.adamax(.002,.9,.999,jt(),0),RMSProp:()=>Ha.rmsprop(.001,.9,0,jt()),SGD:()=>Ha.sgd(.01)};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,t in e)return e[t]();throw new M(`Unknown Optimizer ${t}`)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const IS=1*1024*1024;function TS(t,e,n=!1){if(t==null||typeof t!="object"||Object.getPrototypeOf(t)!==Object.prototype||!ox(t))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const r=JSON.stringify(t);r.length>IS&&console.warn(`User-defined metadata of model "${e}" is too large in size (length=${r.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${IS}.`)}}function ox(t){if(t===null)return!0;if(typeof t=="object")if(Object.getPrototypeOf(t)===Object.prototype){const e=Object.keys(t);for(const n of e)if(typeof n!="string"||!ox(t[n]))return!1;return!0}else if(Array.isArray(t)){for(const e of t)if(!ox(e))return!1;return!0}else return!1;else{const e=typeof t;return e==="string"||e==="number"||e==="boolean"}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function rj(t,e,n,r=console.log){const s=oj(t),o=["Layer (type)","Input Shape","Output shape","Param #"];s?(e=e||90,n=n||[.32,.61,.89,1]):(e=e||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map(c=>Math.floor(e*c)));let i;if(!s){o.push("Receives inputs"),i=[];for(const c in t.nodesByDepth)i.push(...t.nodesByDepth[c])}r("_".repeat(e)),Wp(o,n,r),r("=".repeat(e));const a=t.layers;for(let c=0;c<a.length;++c)s?ij(a[c],n,r):aj(a[c],n,i,r),r((c===a.length-1?"=":"_").repeat(e));t.checkTrainableWeightsConsistency();const l=sj(t),u=Op(t.nonTrainableWeights);r(`Total params: ${l+u}`),r(`Trainable params: ${l}`),r(`Non-trainable params: ${u}`),r("_".repeat(e))}function sj(t){let e;return t.collectedTrainableWeights!=null?e=Op(t.collectedTrainableWeights):e=Op(t.trainableWeights),e}function oj(t){let e=!0;const n=[],r=[];for(const s in t.nodesByDepth)n.push(t.nodesByDepth[s]);for(const s of n){if(s.length>1||s.length===1&&s[0].inboundLayers.length>1){e=!1;break}r.push(...s)}if(e)for(const s of t.layers){let o=!1;for(const i of s.inboundNodes)if(r.indexOf(i)!==-1)if(o){e=!1;break}else o=!0;if(!e)break}return e}function Wp(t,e,n=console.log){let r="";for(let s=0;s<t.length;++s)s>0&&(r=r.slice(0,r.length-1)+" "),r+=t[s],r=r.slice(0,e[s]),r+=" ".repeat(e[s]-r.length);n(r)}function ij(t,e,n){let r,s;try{s=t.inboundNodes.map(l=>JSON.stringify(l.inputShapes)).join(",")}catch{s="multiple"}try{r=JSON.stringify(t.outputShape)}catch{r="multiple"}const o=t.name,i=t.getClassName(),a=[`${o} (${i})`,s,r,t.countParams().toString()];Wp(a,e,n)}function aj(t,e,n,r){let s,o;try{o=t.inboundNodes.map(d=>JSON.stringify(d.inputShapes)).join(",")}catch{o="multiple"}try{s=JSON.stringify(t.outputShape)}catch{s="multiple"}const i=[];for(const d of t.inboundNodes)if(!(n!=null&&n.length>0&&n.indexOf(d)===-1))for(let f=0;f<d.inboundLayers.length;++f){const h=d.inboundLayers[f].name,p=d.nodeIndices[f],g=d.tensorIndices[f];i.push(`${h}[${p}][${g}]`)}const a=t.name,l=t.getClassName(),u=i.length===0?"":i[0],c=[`${a} (${l})`,o,s,t.countParams().toString(),u];Wp(c,e,r);for(let d=1;d<i.length;++d)Wp(["","","","",i[d]],e,r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function oA(t,e,n){return(t==="inboundNodes"||t==="outputLayers"||t==="inputLayers")&&e===0&&typeof n=="string"}function ix(t,e){if(t===null)return null;if(typeof t=="string")return Ri(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],r=t.length;for(let s=0;s<r;++s){const o=t[s];oA(e,s,o)?n.push(o):n.push(ix(o,e))}return n}else{const n={};for(const r of Object.keys(t)){const s=t[r];if(r==="name"&&typeof s=="string")n[r]=s;else{const o=Ri(r);n[o]=ix(s,o)}}return n}}function ax(t,e){if(t==null)return null;if(typeof t=="string")return to(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],r=t.length;for(let s=0;s<r;++s){const o=t[s];oA(e,s,o)?n.push(o):n.push(ax(o,e))}return n}else{const n={};for(const r of Object.keys(t)){const s=t[r],o=to(r);(r==="name"||r==="className")&&typeof s=="string"?n[o]=s:n[o]=ax(s,r)}return n}}/** @license See the LICENSE file. */const iA="4.20.0";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const lj=t=>{const e=Object.keys(t);if(e.length===0)return!1;const n=e[0].split("/");return!isNaN(parseInt(n[n.length-1],10))};class os extends Ae{constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,this.name==null){const b=this.getClassName().toLowerCase();this.name=Zg(b)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],Qo(this.inputs).length!==this.inputs.length)throw new M(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(b=>b.name)}`);Qo(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(b=>b.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const b of this.outputs){const x=b.sourceLayer,y=b.nodeIndex,$=b.tensorIndex;this.outputLayers.push(x),this.outputLayersNodeIndices.push(y),this.outputLayersTensorIndices.push($)}for(const b of this.inputs){const x=b.sourceLayer,y=b.nodeIndex,$=b.tensorIndex;Ds(y===0,"input layer has >1 nodes"),Ds($===0,"input layer has >1 tensors"),this.inputLayers.push(x),this.inputLayersNodeIndices.push(y),this.inputLayersTensorIndices.push($)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let b=0;b<this.inputLayers.length;b++){const x=this.inputLayers[b];if(!(x instanceof yf))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${e.inputs}. Input ${b} (0-based) originates from layer type ${x.getClassName()}.`);this.inputNames.push(x.name),this.feedInputShapes.push(x.batchInputShape),this.feedInputNames.push(x.name)}for(const b of this.outputLayers)this.outputNames.push(b.name);this.internalInputShapes=this.inputs.map(b=>b.shape),this.internalOutputShapes=this.outputs.map(b=>b.shape);const n={},r={},s={},o={},i={},a=[],l=(b,x,y,$,C,k)=>{($==null||C==null||k==null)&&($=b.sourceLayer,C=b.nodeIndex,k=b.tensorIndex);const w=$.inboundNodes[C];if(y.indexOf(w)!==-1)throw new Gr(`The tensor ${b.name} at layer "${$.name}" is part of a cycle.`);if(x.indexOf(w)!==-1)return;this.containerNodes.add(os.nodeKey($,C)),$.id in i||(i[$.id]=Object.keys(i).length),y.indexOf(w)===-1&&y.push(w);const I=w.inboundLayers.length;for(let N=0;N<I;N++){const E=w.inputTensors[N],R=w.inboundLayers[N],S=w.nodeIndices[N],T=w.tensorIndices[N];l(E,x,y,R,S,T)}for(x.push(w);y.indexOf(w)>=0;)y.splice(y.indexOf(w),1);a.push(w)},u=[],c=[];for(const b of this.outputs)l(b,u,c);const d=a.slice().reverse();for(const b of d){r[b.id]=b,b.id in n||(n[b.id]=0);let x=n[b.id];const y=s[b.outboundLayer.id]==null?0:s[b.outboundLayer.id];x=Math.max(x,y),s[b.outboundLayer.id]=x,o[b.outboundLayer.id]=b.outboundLayer,n[b.id]=x;for(let $=0;$<b.inboundLayers.length;$++){const C=b.inboundLayers[$],k=b.nodeIndices[$],w=C.inboundNodes[k],I=n[w.id]==null?0:n[w.id];n[w.id]=Math.max(x+1,I),r[w.id]=w}}const f={};for(const b in n){const x=n[b];x in f||(f[x]=[]),f[x].push(r[b])}const h={};for(const b in s){const x=s[b];x in h||(h[x]=[]),h[x].push(o[b])}let p=Object.keys(h).map(b=>parseInt(b,10)).sort(ih);this.layers=[];for(const b of p){const x=h[b];x.sort((y,$)=>{const C=i[y.id],k=i[$.id];return C<k?-1:C>k?1:0});for(const y of x)y instanceof os&&this.internalContainerRefs.push(y),this.layers.push(y)}this.layersByDepth=h,p=Object.keys(f).map(b=>parseInt(b,10)).sort(ih);const g=this.inputs.slice(),v=[];for(const b of p)for(const x of f[b]){const y=x.outboundLayer;if(y!=null){for(const $ of x.inputTensors)if(g.indexOf($)===-1)throw new Gr(`Graph disconnected: cannot obtain value for tensor ${$} at layer "${y.name}". The following previous layers were accessed without issue: ${v}`);for(const $ of x.outputTensors)g.push($);v.push(y.name)}}this.nodesByDepth=f;const m=this.layers.map(b=>b.name);for(const b of m){const x=m.filter(y=>y===b).length;if(x!==1)throw new Gr(`The name "${b}" is used ${x} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(m))}this.outboundNodes=[],this.inboundNodes=[],new e0({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(b=>null),outputMasks:this.outputs.map(b=>null),inputShapes:this.inputs.map(b=>b.shape),outputShapes:this.outputs.map(b=>b.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const e={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(const n of this.layers)e.numDisposedVariables+=n.dispose().numDisposedVariables;for(const n of this.internalContainerRefs)e.numDisposedVariables+=n.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach(n=>{n._trainableWeights.forEach(r=>r.trainable=e)}),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new M("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(const n of this.layers)e=e.concat(n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.layers)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const r of this.layers)n.push(...r.trainableWeights);return n.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e,n=!0){const r={};let s=0;const o=lj(e);o&&this.parseWeights(e);for(const a of this.layers)for(const[l,u]of a.weights.entries()){const c=o?`${u.name.split("/").slice(0,-1).join("/")+"/"}${l}`:u.originalName;if(r[c]!=null)throw new M(`Duplicate weight name: ${c}`);r[c]=u,s++}const i=[];for(const a in e){let l=a;if(r[a]==null){const u=a.split("/");l=u.slice(0,-2).concat([u[u.length-1]]).join("/")}if(r[l]!=null)i.push([r[l],e[a]]);else if(n)throw new M(`Provided weight data has no target variable: ${a}`);delete r[l]}if(n){const a=[];for(const l in r)a.push(l);if(a.length>0)throw new M(`${a.length} of ${s} weights are not set: ${a}`)}l$(i)}parseWeights(e){for(const n in Object.keys(e)){const r=n.split("/"),s=["vars","layer_checkpoint_dependencies"],o=r.map(i=>i.startsWith("_")?i.slice(1):i).filter(i=>!s.includes(i)).join("/");o!==n&&(e[o]=e[n],delete e[n])}}updatedConfig(){const e=this.getConfig(),n={};return n.className=this.getClassName(),n.config=e,n.kerasVersion=`tfjs-layers ${iA}`,n.backend="TensorFlow.js",n}toJSON(e,n=!0){const r=ax(this.updatedConfig());return n?JSON.stringify(r):r}call(e,n){return H(()=>{e=et(e);const r=new _o;for(let s=0;s<this.inputs.length;++s)r.add(this.inputs[s],e[s]);return Yu(this.outputs,r,n)})}computeMask(e,n){return H(()=>{e=et(e);let r;return n==null?r=da(null,e.length):r=et(n),this.runInternalGraph(e,r)[1]})}computeOutputShape(e){const n=Pp(e);if(n.length!==this.inputLayers.length)throw new M(`Invalid inputShape argument ${e}: model has ${this.inputLayers.length} tensor inputs.`);const r={};for(let a=0;a<n.length;a++){const l=this.inputLayers[a],u=n[a],c=l.name+"_0_0";r[c]=u}const s=Object.keys(this.nodesByDepth).map(a=>parseInt(a,10)).sort(ih);if(s.length>1)for(const a of s){const l=this.nodesByDepth[a];for(const u of l){const c=u.outboundLayer;if(this.inputLayers.map(g=>g.id).indexOf(c.id)!==-1)continue;const d=[];for(let g=0;g<u.inboundLayers.length;g++){const v=u.inboundLayers[g],m=u.nodeIndices[g],b=u.tensorIndices[g],x=`${v.name}_${m}_${b}`,y=r[x];d.push(y)}const f=c.computeOutputShape(Vn(d)),h=Pp(f),p=c.inboundNodes.indexOf(u);for(let g=0;g<h.length;g++){const v=`${c.name}_${p}_${g}`;r[v]=h[g]}}}const o=[],i=[];for(let a=0;a<this.outputLayers.length;a++){const l=this.outputLayers[a],u=this.outputLayersNodeIndices[a],c=this.outputLayersTensorIndices[a],d=`${l.name}_${u}_${c}`;i.push(d)}for(let a=0;a<i.length;a++){const l=i[a];Ds(l in r),o.push(r[l])}return Vn(o)}runInternalGraph(e,n){n==null&&(n=da(null,e.length));const r={};for(let l=0;l<this.inputs.length;++l){const u=this.inputs[l],c=e[l],d=n[l];r[u.id]=[c,d]}const s=Object.keys(this.nodesByDepth).map(l=>parseInt(l,10)).sort(ih);for(const l of s){const u=this.nodesByDepth[l];for(const c of u){const d=c.outboundLayer,f=c.inputTensors,h=c.outputTensors,p=new Array;for(const g of f)g.id in r&&p.push(r[g.id]);if(p.length===f.length){let g={},v,m,b,x;if(c.callArgs!=null&&(g=c.callArgs),p.length===1){const[y,$]=p[0];g.mask==null&&(g.mask=$),b=et(d.call(y,g)),x=et(d.computeMask(y,$)),v=[y],m=[$]}else v=p.map(y=>y[0]),m=p.map(y=>y[1]),g.mask==null&&(g.mask=m),b=et(d.call(v,g)),x=et(d.computeMask(v,m));if(d.activityRegularizer)throw new Te("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let y=0;y<h.length;++y){const $=h[y],C=b[y],k=x[y];r[$.id]=[C,k]}}}}const o=[],i=[],a=[];for(const l of this.outputs){Ds(l.id in r,`Could not compute output ${l.name} : ${l.id}`);const[u,c]=r[l.id];a.push(u.shape),o.push(u),i.push(c)}return[o,i,a]}buildNodeConversionMap(e){const n={};let r;for(const s of this.layers){r=s instanceof os?1:0;for(let o=0;o<s.inboundNodes.length;o++){const i=os.nodeKey(s,o);this.containerNodes.has(i)&&(n[i]=r,r+=1)}}return n}getLayer(e,n){if(n!=null)return this.findLayer(n);if(e==null)throw new M("Provide either a layer name or layer index");if(typeof e=="number")return this.findLayer(e);for(const r of this.layers)if(r.name===e)return r;throw new M(`No such layer: ${e}`)}findLayer(e){if(this.layers.length<=e)throw new M(`Was asked to retrieve layer at index ${e}, but model only has ${this.layers.length} layer(s).`);return this.layers[e]}calculateLosses(){return H(()=>{const e=[];for(const n of this.layers)for(let r=0;r<n.inboundNodes.length;++r){const s=os.nodeKey(n,r);this.containerNodes.has(s)&&e.push(...n.calculateLosses())}return e})}getConfig(){const e={name:this.name},n=this.buildNodeConversionMap(this.layers),r=[];for(const i of this.layers){const a=i.getClassName(),l=i.getConfig(),u=[];for(let d=0;d<i.inboundNodes.length;d++){const f=i.inboundNodes[d],h=os.nodeKey(i,d);let p={};if(this.containerNodes.has(h)){if(f.callArgs)try{JSON.stringify(f.callArgs),p=f.callArgs}catch{console.warn(`Layer ${i.name} was passed non-serializable keyword arguments: ${f.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),p={}}if(f.inboundLayers.length>0){const g=[];for(let v=0;v<f.inboundLayers.length;v++){const m=f.inboundLayers[v],b=f.nodeIndices[v],x=f.tensorIndices[v],y=os.nodeKey(m,b);let $=n[y];$==null&&($=0),g.push([m.name,$,x,p])}u.push(g)}}}const c={};c.name=i.name,c.className=a,c.config=l,c.inboundNodes=u,r.push(c)}e.layers=r;const s=[];for(let i=0;i<this.inputLayers.length;i++){const a=this.inputLayers[i],l=this.inputLayersNodeIndices[i],u=os.nodeKey(a,l);if(!this.containerNodes.has(u))continue;let c=n[u];c==null&&(c=0);const d=this.inputLayersTensorIndices[i];s.push([a.name,c,d])}e.inputLayers=s;const o=[];for(let i=0;i<this.outputLayers.length;i++){const a=this.outputLayers[i],l=this.outputLayersNodeIndices[i],u=os.nodeKey(a,l);if(!this.containerNodes.has(u))continue;let c=n[u];c==null&&(c=0);const d=this.outputLayersTensorIndices[i];o.push([a.name,c,d])}return e.outputLayers=o,e}static fromConfig(e,n,r={},s=!1){const o={},i={};function a(v,m){v.name in i?i[v.name].push(m):i[v.name]=[m]}function l(v,m){const b=[];let x;for(const y of m){const $=y[0],C=y[1],k=y[2];if(x=y[3]==null?{}:y[3],!($ in o)){a(v,m);return}const w=o[$];if(w.inboundNodes.length<=C){a(v,m);return}const I=w.inboundNodes[C];b.push(I.outputTensors[k])}b.length>0&&v.apply(Vn(b),x)}function u(v){const m=v.name,b=co(v,n.customObjects!=null?n.customObjects:{});b.setFastWeightInitDuringBuild(s),o[m]=b,v.inboundNodes.forEach(y=>{if(!(y instanceof Array))throw new M(`Corrupted configuration, expected array for nodeData: ${y}`);a(b,y)})}const c=n.name,d=n.layers;for(const v of d)u(v);for(;!jH(i);)for(const v of d){const m=o[v.name];if(m.name in i){const b=i[m.name];delete i[m.name];for(const x of b)l(m,x)}}const f=[],h=[],p=n.inputLayers;for(const v of p){const m=v[0],b=v[1],x=v[2];Ds(m in o);const $=o[m].inboundNodes[b].outputTensors;f.push($[x])}const g=n.outputLayers;for(const v of g){const m=v[0],b=v[1],x=v[2];Ds(m in o);const $=o[m].inboundNodes[b].outputTensors;h.push($[x])}return new e({inputs:f,outputs:h,name:c})}get stateful(){if(this._stateful)throw new M("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const e of this.layers)if(e.stateful)return!0;return!1}resetStates(){H(()=>{this.layers.forEach(e=>{e.stateful&&e.resetStates()})})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function uj(t,e,n){const r=e.length;if(t==null||Array.isArray(t)&&t.length===0)return e.map(s=>null);if(r===1)return Array.isArray(t)&&t.length===1?t:typeof t=="object"&&e[0]in t?[t[e[0]]]:[t];if(Array.isArray(t)){if(t.length!==r)throw new Error(`Provided ${n} is an array of ${t.length} element(s), but the model has ${r} outputs. Make sure a set of weights is provided for each model output.`);return t}else if(typeof t=="object"&&Object.keys(t).length>0&&typeof t[Object.keys(t)[0]]=="object"){const s=[];return e.forEach(o=>{o in t?s.push(t[o]):s.push(null)}),s}else throw new Error(`The model has multiple (${r}) outputs, so ${n} must be either an array with ${r} elements or an object with ${e} keys. Provided ${n} not understood: ${JSON.stringify(t)}`)}function aA(t,e){return uj(t,e,"classWeight")}async function lA(t,e,n,r){if(n!=null){const s=H(()=>{if(t.shape.length===1)return Hi(t);if(t.shape.length===2){if(t.shape[1]>1)return Wc(t,1);if(t.shape[1]===1)return B(t,[t.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${t.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${t.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),o=Array.from(await s.data());Fe(s);const i=[];return o.forEach(a=>{if(n[a]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${a} exists in the data but not in classWeight`);i.push(n[a])}),er(i,"float32")}else return null}function cj(t,e){return _(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const dj=32;function uA(t,e){let n,r;const s=e;n=s.xs,r=s.ys,D(n!=null&&r!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${e}`);const o=ES("input",t.inputNames,n),i=ES("output",t.outputNames,r),a=o[0].shape[0];D(o.length===t.inputs.length,()=>`LayersModel has ${t.inputs.length} inputs, but the dataset provides ${o.length} inputs.  (Expected input keys: ${JSON.stringify(t.inputNames)})`),D(i.length===t.outputs.length,()=>`LayersModel has ${t.outputs.length} outputs, but the dataset provides ${i.length} outputs.  (Expected output keys: ${JSON.stringify(t.outputNames)})`);for(let l=0;l<o.length;l++)D(o[l].shape[0]===a,()=>`Batch size mismatch: input ${t.inputNames[l]} has ${o[l].shape[0]}; expected  ${a} based on input ${t.inputNames[0]}.`);for(let l=0;l<i.length;l++)D(i[l].shape[0]===a,()=>`Batch size mismatch: output ${t.outputNames[l]} has ${i[l].shape[0]}; expected  ${a} based on input ${t.inputNames[0]}.`);return{xs:o,ys:i}}function ES(t,e,n){if(n instanceof Gt)return[n];if(Array.isArray(n))return D(n.length===e.length,()=>`Received an array of ${n.length} Tensors, but expected ${e.length} to match the ${t} keys ${e}.`),n;{const r=[];for(const s of e){if(n[s]==null)throw new M(`The feature data generated by the dataset lacks the required ${t} key '${s}'.`);r.push(n[s])}return r}}function fj(t){if(t.length===3)throw new Te("Validation with sample weights is not implemented yet.");return{xs:t[0],ys:t[1]}}async function hj(t,e,n){const r=n.batchesPerEpoch!=null;if(D(t.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),D(n!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),D(n.epochs!=null&&n.epochs>0&&Number.isInteger(n.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${n.epochs}`),D(!r||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${n.batchesPerEpoch}`),D(n.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0;try{const s=n.validationData!=null;let o,i;if(s)if(NS(n.validationData))D(n.validationBatches==null||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${n.validationBatches}`);else{const v=fj(n.validationData);o=v.xs,i=v.ys}const a=t.makeTrainFunction(),l=t.getDedupedMetricsNames();let u;s?u=l.slice().concat(l.map(v=>"val_"+v)):u=l.slice();const c=ZD(n.callbacks,n.yieldEvery),d=n.verbose==null?1:n.verbose,{callbackList:f,history:h}=JD(c,d,n.epochs,null,null,pj(e,n),null,s,u);f.setModel(t),t.history=h,await f.onTrainBegin(),t.stopTraining_=!1;let p=n.initialEpoch==null?0:n.initialEpoch,g=await e.iterator();for(;p<n.epochs;){const v={};await f.onEpochBegin(p);let m=0,b=0;for(r||(g=await e.iterator());!r||m<n.batchesPerEpoch;){const x=await g.next();if(r&&x.done){console.warn(`You provided \`batchesPerEpoch\` as ${n.batchesPerEpoch}, but your dataset iterator ran out of data after ${m} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${n.batchesPerEpoch*n.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(x.value!=null){const{xs:y,ys:$}=uA(t,x.value),C={};C.batch=b,C.size=y[0].shape[0],await f.onBatchBegin(b,C);const k=[];if(n.classWeight!=null){const N=aA(n.classWeight,t.outputNames);for(let E=0;E<N.length;++E)k.push(await lA($[E],null,N[E]))}const w=y.concat($).concat(k),I=a(w);Fe(w);for(let N=0;N<l.length;++N){const E=l[N],R=I[N];C[E]=R,_s(R)}await f.onBatchEnd(b,C),QD(C),b++,m++}if(r?m>=n.batchesPerEpoch:x.done){if(s){let y;NS(n.validationData)?y=et(await t.evaluateDataset(n.validationData,{batches:n.validationBatches})):y=et(t.evaluate(o,i,{batchSize:n.validationBatchSize==null?dj:n.validationBatchSize,verbose:0}));for(let $=0;$<t.metricsNames.length;++$)v[`val_${t.metricsNames[$]}`]=y[$]}break}if(t.stopTraining_)break}if(await f.onEpochEnd(p,v),p++,t.stopTraining_)break}return await f.onTrainEnd(),await t.history.syncData(),t.history}finally{t.isTraining=!1}}function pj(t,e){let n=null;return e.batchesPerEpoch!=null?n=e.batchesPerEpoch:Number.isFinite(t.size)&&(n=t.size),n}function NS(t){return typeof t.iterator=="function"}function mj(t){return typeof t.next=="function"}async function gj(t,e,n){n=n||{};const r=n.batches!=null,s=t.testFunction;let o=[];if(n.verbose>0)throw new Te("Verbose mode is not implemented yet.");D(!r||n.batches>0&&Number.isInteger(n.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(n.batches)}`);const i=mj(e)?e:await e.iterator();let a=0,l=0;for(;!r||l<n.batches;){const u=await i.next();if(o=H(()=>{if(u.value){const{xs:c,ys:d}=uA(t,u.value),f=c.concat(d),h=H(()=>s(f));if(Fe(f),l===0)for(let g=0;g<h.length;++g)o.push(qe(0));const p=f[0].shape[0];for(let g=0;g<h.length;++g){const v=h[g],m=o[g];o[g]=H(()=>ne(o[g],_(p,v))),l>0&&Fe(m)}Fe(h),a+=p,++l}return o}),u.done){r&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let u=0;u<o.length;++u){const c=o[u];o[u]=be(o[u],a),Fe(c)}return Vn(o)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function dv(t){D(t>0&&Number.isInteger(t),()=>`batchSize is required to be a positive integer, but got ${t}`)}function Ou(t,e,n){return t==null?[null]:Array.isArray(t)?t.map(r=>Ki(r,e,n-e)):Ki(t,e,n-e)}function lx(t,e){return H(()=>t==null?null:Array.isArray(t)?t.map(n=>lx(n,e)):MD(t,e.dtype==="int32"?e:ce(e,"int32")))}function fv(t,e){const n=[];let r=0,s=null;for(;r<t;)s=r+e,s>=t&&(s=t),n.push([r,s]),r=s;return n}function cA(t){const e=[];t instanceof Gt&&(t=[t]);for(let n=0;n<t.length;++n){const r=t[n];if(r.rank===1)e.push(vf(r,1));else{if(r.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(r)}}return e}function rs(t,e){if(t==null)return;const n=[];if(e instanceof Gt)n.push(e.id);else if(Array.isArray(e))e.forEach(s=>n.push(s.id));else if(e!=null)for(const s in e){const o=e[s];n.push(o.id)}const r=[];if(t instanceof Gt)n.indexOf(t.id)===-1&&r.push(t);else if(Array.isArray(t))t.forEach(s=>{n.indexOf(s.id)===-1&&r.push(s)});else if(t!=null)for(const s in t){const o=t[s];n.indexOf(o.id)===-1&&r.push(o)}r.forEach(s=>{s.isDisposed||s.dispose()})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function vj(t){return t instanceof Gt}function ux(t){return Array.isArray(t)}function RS(t){return!vj(t)&&!ux(t)}function DS(t,e,n,r=!0,s=""){if(e==null||e.length===0){if(t!=null){let i=!1;if(ux(t)&&t.length>0)i=!0;else if(RS(t)){for(const a in t)if(t.hasOwnProperty(a)){i=!0;break}}else i=!0;if(i)throw new M(`Error when checking model ${s} expected no data, but got ${t}`)}return[]}if(t==null)return e.map(i=>null);let o;if(RS(t)){t=t,o=[];for(const i of e){if(t[i]==null)throw new M(`No data provided for "${i}". Need data for each key in: ${e}`);o.push(t[i])}}else if(ux(t)){if(t=t,t.length!==e.length)throw new M(`Error when checking model ${s}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${e.length} Tensor(s), but instead got the following list of Tensor(s): ${t}`);o=t}else{if(t=t,e.length>1)throw new M(`The model ${s} expects ${e.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${t.shape}`);o=[t]}if(o=cA(o),n!=null)for(let i=0;i<e.length;++i){if(n[i]==null)continue;const a=o[i];if(a.shape.length!==n[i].length)throw new M(`Error when checking ${s}: expected ${e[i]} to have ${n[i].length} dimension(s). but got array with shape ${a.shape}`);for(let l=0;l<n[i].length;++l){if(l===0&&!r)continue;const u=a.shape[l],c=n[i][l];if(c!=null&&c>=0&&u!==c)throw new M(`${s} expected a batch of elements where each example has shape [${n[i].slice(1,n[i].length)}] (i.e.,tensor shape [*,${n[i].slice(1,n[i].length)}]) but the ${s} received an input with ${a.shape[0]} examples, each with shape [${a.shape.slice(1,a.shape.length)}] (tensor shape [${a.shape}])`)}}return o}function bj(t,e,n){const r=Qo(t.map(o=>o.shape[0]));r.sort();const s=Qo(e.map(o=>o.shape[0]));if(s.sort(),r.length>1)throw new M(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map(o=>o.shape))}`);if(s.length>1)throw new M(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(o=>o.shape))}`);if(r.length>0&&s.length>0&&!Ye(r,s))throw new M(`Input Tensors should have the same number of samples as target Tensors. Found ${r[0]} input sample(s) and ${s[0]} target sample(s).`)}function xj(t,e,n){const r=[t0,n0,Xc];for(let s=0;s<t.length;++s){const o=t[s],i=e[s],a=n[s];if(i!=null){if(i===Xc&&o.shape[o.shape.length-1]===1)throw new M(`You are passing a target array of shape ${o.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(r.indexOf(i)!==-1){const l=o.shape.slice(1),u=a.slice(1);for(let c=0;c<l.length;++c){const d=l[c],f=u[c];if(f!=null&&d!==f)throw new M(`A target Tensor with shape ${o.shape} was passed for an output of shape ${a}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function AS(t,e,n,r=!0,s=""){let o;if(Array.isArray(t)){if(t.length!==e.length)throw new M(`Error when checking model ${s}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${e.length} Tensor(s), but instead got ${t.length} Tensors(s).`);o=t}else{if(e.length>1)throw new M(`The model expects ${e.length} ${s} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(t.shape)}.`);o=[t]}if(n!=null)for(let i=0;i<e.length;++i){if(n[i]==null)continue;const a=o[i];if(a.shape.length!==n[i].length)throw new M(`Error when checking ${s}: expected ${e[i]} to have ${n[i].length} dimension(s), but got array with shape ${JSON.stringify(a.shape)}`);for(let l=0;l<n[i].length;++l){if(l===0&&!r)continue;const u=a.shape[l],c=n[i][l];if(c!=null&&c!==u)throw new M(`Error when checking ${s}: expected ${e[i]} to have shape ${JSON.stringify(n[i])} but got array with shape ${JSON.stringify(a.shape)}.`)}}}function yj(t,e){if(t==null||Array.isArray(t)&&t.length===0)return e.map(r=>[]);let n;if(typeof t=="string"||typeof t=="function")n=[t];else if(Array.isArray(t)||typeof t=="object")n=t;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${t}`);if(Array.isArray(n))return e.map(r=>n);{const r=[];for(const s of e){let o=n.hasOwnProperty(s)?n[s]:[];Array.isArray(o)||(o=[o]),r.push(o)}return r}}const wj="layers-model";class El extends os{constructor(e){super(e),this.isTraining=!1}summary(e,n,r=console.log){if(!this.built)throw new M("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");rj(this,e,n,r)}compile(e){if(e.loss==null&&(e.loss=[]),this.loss=e.loss,typeof e.optimizer=="string")this.optimizer_=nj(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof vi))throw new M("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let n=[];if(!Array.isArray(e.loss)&&typeof e.loss!="string"&&typeof e.loss!="function"){e.loss=e.loss;for(const i in e.loss)if(this.outputNames.indexOf(i)===-1)throw new M(`Unknown entry in loss dictionary: "${i}". Only expected the following keys: ${this.outputNames}`);for(const i of this.outputNames)e.loss[i]==null&&console.warn(`Output "${i}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${i} during training`),n.push(cv(e.loss[i]))}else if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new M(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);n=e.loss.map(a=>cv(a))}else{const i=cv(e.loss);this.outputs.forEach(a=>{n.push(i)})}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let i=0;i<this.outputs.length;++i){const a=this.internalOutputShapes[i],l=this.outputNames[i];this.feedOutputNames.push(l),this.feedOutputShapes.push(a),this.feedLossFns.push(this.lossFunctions[i])}const r=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],ji("loss",()=>{for(let i=0;i<this.outputs.length;++i){if(r.indexOf(i)!==-1)continue;const a=this.lossFunctions[i];this.outputs.length>1&&(this.metricsTensors.push([a,i]),this.metricsNames.push(this.outputNames[i]+"_loss"))}});const s=yj(e.metrics,this.outputNames),o=(i,a,l)=>{this.outputNames.length>1&&(a=this.outputNames[i]+"_"+a),this.metricsNames.push(a),this.metricsTensors.push([l,i])};ji("metric",()=>{for(let i=0;i<this.outputs.length;++i){if(r.indexOf(i)!==-1)continue;const a=s[i];(u=>{const c="";let d,f,h;for(const p of u){if(typeof p=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(p)!==-1){const v=this.internalOutputShapes[i];v[v.length-1]===1||this.lossFunctions[i]===n0?["accuracy","acc"].indexOf(p)!==-1?f=tA:["crossentropy","ce"].indexOf(p)!==-1&&(f=j8):this.lossFunctions[i]===zp?["accuracy","acc"].indexOf(p)!==-1?f=K8:["crossentropy","ce"].indexOf(p)!==-1&&(f=sA):["accuracy","acc"].indexOf(p)!==-1?f=nA:["crossentropy","ce"].indexOf(p)!==-1&&(f=rA);let m;["accuracy","acc"].indexOf(p)!==-1?m="acc":["crossentropy","ce"].indexOf(p)!==-1&&(m="ce"),h=f,d=c+m}else h=tj(p),d=c+uh(p);let g;ji(d,()=>{g=h}),o(i,d,g)}})(a)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,n,r={}){const s=r.batchSize==null?32:r.batchSize;dv(s);const i=this.standardizeUserDataXY(e,n,!0,s);try{const a=i[0].concat(i[1]);this.makeTestFunction();const l=this.testFunction,u=this.testLoop(l,a,s,r.verbose,r.steps);return Vn(u)}finally{rs(i[0],e),rs(i[1],n)}}async evaluateDataset(e,n){return this.makeTestFunction(),gj(this,e,n)}checkNumSamples(e,n,r,s="steps"){let o;if(r!=null){if(o=null,n!=null)throw new M(`If ${s} is set, batchSize must be null or undefined.Got batchSize = ${n}`)}else if(e!=null)Array.isArray(e)?o=e[0].shape[0]:o=e.shape[0];else throw new M(`Either the input data should have a defined shape, or ${s} shoud be specified.`);return o}execute(e,n){if(Array.isArray(n)&&n.length===0)throw new M("`outputs` is an empty Array, which is not allowed.");const r=Array.isArray(n),s=r?n:[n],o=this.retrieveSymbolicTensors(s),i=new _o;if(e instanceof Gt&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new M(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let l=0;l<this.inputs.length;++l)i.add(this.inputs[l],e[l])}else for(const l of this.inputs){const u=e[l.name];if(u==null)throw new M(`No value is provided for the model's input ${l.name}`);i.add(l,u)}const a=Yu(o,i);return r?a:a[0]}retrieveSymbolicTensors(e){const n=da(null,e.length);let r=e.length;for(const s of this.layers){const o=Array.isArray(s.output)?s.output:[s.output],i=o.map(a=>a.name);for(let a=0;a<e.length;++a){const l=i.indexOf(e[a]);if(l!==-1&&(n[a]=o[l],r--),r===0)break}if(r===0)break}if(r>0){const s=[];throw n.forEach((o,i)=>{o==null&&s.push(e[i])}),new M(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(s)}`)}return n}predictLoop(e,n=32,r=!1){return H(()=>{const s=this.checkNumSamples(e);if(r)throw new Te("Verbose predictLoop() is not implemented yet.");const o=fv(s,n),i=this.outputs.map(a=>[]);for(let a=0;a<o.length;++a)H(()=>{const u=o[a][0],c=o[a][1],d=Ou(e,u,c),f=[];if(Array.isArray(d))for(let p=0;p<d.length;++p)f.push({key:this.inputs[p],value:d[p]});else f.push({key:this.inputs[0],value:d});const h=new _o(f);return Yu(this.outputs,h)}).forEach((u,c)=>i[c].push(u));return Vn(i.map(a=>Un(a,0)))})}predict(e,n={}){const r=cA(e);AS(r,this.inputNames,this.feedInputShapes,!1);try{const s=n.batchSize==null?32:n.batchSize;return dv(s),this.predictLoop(r,s)}finally{rs(r,e)}}predictOnBatch(e){AS(e,this.inputNames,this.feedInputShapes,!0);const n=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,n)}standardizeUserDataXY(e,n,r=!0,s){if(this.optimizer_==null)throw new Gr("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const o=[];for(let i=0;i<this.feedOutputShapes.length;++i){const a=this.feedOutputShapes[i];this.feedLossFns[i]===zp?o.push(a.slice(0,a.length-1).concat([1])):o.push(a)}if(e=DS(e,this.feedInputNames,this.feedInputShapes,!1,"input"),n=DS(n,this.feedOutputNames,o,!1,"target"),bj(e,n),xj(n,this.feedLossFns,this.feedOutputShapes),this.stateful&&s!=null&&s>0&&e[0].shape[0]%s!==0)throw new M(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${s}. Found: ${e[0].shape[0]} sample(s).`);return[e,n]}async standardizeUserData(e,n,r,s,o=!0,i){const[a,l]=this.standardizeUserDataXY(e,n,o,i);if(r!=null)throw new Error("sample weight is not supported yet.");let u=null;if(s!=null){const c=aA(s,this.outputNames);u=[];for(let d=0;d<c.length;++d)u.push(await lA(l[d],null,c[d]))}return[a,l,u]}testLoop(e,n,r,s=0,o){return H(()=>{const i=this.checkNumSamples(n,r,o,"steps"),a=[];if(s>0)throw new Te("Verbose mode is not implemented yet.");if(o!=null)throw new Te("steps mode in testLoop() is not implemented yet");{const l=fv(i,r),u=er(bs(0,i));for(let c=0;c<l.length;++c){const d=l[c][0],f=l[c][1],h=Ki(u,d,f-d),p=lx(n,h),g=e(p);if(c===0)for(let v=0;v<g.length;++v)a.push(qe(0));for(let v=0;v<g.length;++v){const m=g[v];a[v]=ne(a[v],_(f-d,m))}}for(let c=0;c<a.length;++c)a[c]=be(a[c],i)}return a})}getDedupedMetricsNames(){const e=this.metricsNames,n=[];for(let r=0;r<e.length;++r){const s=e[r];let o=s;if(gS(e,s)>1){const i=gS(e.slice(0,r),s);o+=`_${i}`}n.push(o)}return n}makeTrainFunction(){return e=>{const n=[],r=e.slice(0,this.inputs.length),s=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),o=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),i=[],a=()=>{const d=[];for(let g=0;g<this.inputs.length;++g)d.push({key:this.inputs[g],value:r[g]});const f=new _o(d),h=Yu(this.outputs,f,{training:!0});let p;for(let g=0;g<this.lossFunctions.length;++g){const v=this.lossFunctions[g];let m=v(s[g],h[g]);o[g]!=null&&(m=cj(m,o[g]));const b=zt(m);n.push(b),g===0?p=m:p=ne(p,m)}for(let g=0;g<this.metricsTensors.length;++g){let v;if(this.outputs.length>1&&g<this.outputs.length)v=n[g];else{const m=this.metricsTensors[g][0],b=this.metricsTensors[g][1];v=zt(m(s[b],h[b]))}_s(v),i.push(v)}return p=zt(p),this.calculateLosses().forEach(g=>{p=ne(p,g)}),p},l=this.collectedTrainableWeights.map(d=>d.read());return[this.optimizer_.minimize(a,!0,l)].concat(i)}}makeTestFunction(){this.testFunction=e=>H(()=>{const n=[];let r;const s=e.slice(0,this.inputs.length),o=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=[];for(let u=0;u<this.inputs.length;++u)i.push({key:this.inputs[u],value:s[u]});const a=new _o(i),l=Yu(this.outputs,a);for(let u=0;u<this.lossFunctions.length;++u){const c=this.lossFunctions[u],d=zt(c(o[u],l[u]));u===0?r=d:r=ne(r,d),n.push(r)}for(let u=0;u<this.metricsTensors.length;++u){const c=this.metricsTensors[u][0],d=this.metricsTensors[u][1],f=zt(c(o[d],l[d]));n.push(f)}return n})}async fit(e,n,r={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let s,o,i,a,l,u,c,d,f;try{const h=r.batchSize==null?32:r.batchSize;dv(h);const g=await this.standardizeUserData(e,n,r.sampleWeight,r.classWeight,!1,h);s=g[0],o=g[1],f=g[2];let v=!1,m;if(r.validationData!=null&&r.validationData.length>0){if(v=!0,r.validationData.length===2)l=r.validationData[0],u=r.validationData[1];else throw r.validationData.length===3?new Te("validationData including sample weights is not supported yet."):new M(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${r.validationData} is invalid.`);const N=await this.standardizeUserData(l,u,null,null,!0,h);c=N[0],d=N[1],m=c.concat(d)}else if(r.validationSplit!=null&&r.validationSplit>0&&r.validationSplit<1){v=!0;const I=Math.floor(s[0].shape[0]*(1-r.validationSplit)),N=s[0].shape[0];c=Ou(s,I,N),i=s,s=Ou(s,0,I),d=Ou(o,I,N),a=o,o=Ou(o,0,I),m=c.concat(d)}else r.validationSteps!=null&&(v=!0);const b=s.concat(o).concat(f);this.checkTrainableWeightsConsistency();const x=this.makeTrainFunction(),y=this.getDedupedMetricsNames();let $,C;v?(this.makeTestFunction(),$=this.testFunction,C=y.slice().concat(y.map(I=>"val_"+I))):($=null,m=[],C=y.slice());const k=ZD(r.callbacks,r.yieldEvery);return await this.fitLoop(x,b,y,h,r.epochs,r.verbose,k,$,m,r.shuffle,C,r.initialEpoch,null,null)}finally{this.isTraining=!1,rs(s,e),rs(o,n),rs(i,e),rs(a,n),rs(c,l),rs(d,u),f!=null&&Fe(f)}}async fitLoop(e,n,r,s,o,i,a,l,u,c,d,f,h,p){s==null&&(s=32),o==null&&(o=1),c==null&&(c=!0),f==null&&(f=0);let g=!1;if(l!=null&&u!=null&&(g=!0),p!=null&&(g=!0,h==null))throw new M("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const v=this.checkNumSamples(n,s,h,"steps_per_epoch");let m;v!=null&&(m=bs(0,v)),i==null&&(i=1);const{callbackList:b,history:x}=JD(a,i,o,f,v,h,s,g,d);b.setModel(this),this.history=x,await b.onTrainBegin(),this.stopTraining_=!1;for(let y=f;y<o;++y){await b.onEpochBegin(y);const $={};if(h!=null)throw new Te("stepsPerEpoch mode is not implemented yet.");{if(c==="batch")throw new Te("batch shuffling is not implemneted yet");c&&oV(m);const C=er(m),k=fv(v,s);for(let w=0;w<k.length;++w){const I={};if(await b.onBatchBegin(w,I),H(()=>{const N=k[w][0],E=k[w][1],R=Ki(C,N,E-N);I.batch=w,I.size=E-N;const S=lx(n,R),T=e(S);for(let F=0;F<r.length;++F){const L=r[F],G=T[F];I[L]=G,_s(G)}if(w===k.length-1&&g){const F=this.testLoop(l,u,s);for(let L=0;L<r.length;++L){const G=r[L],P=F[L];_s(P),$["val_"+G]=P}}}),await b.onBatchEnd(w,I),QD(I),this.stopTraining_)break}C.dispose()}if(await b.onEpochEnd(y,$),this.stopTraining_)break}return await b.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,n){return hj(this,e,n)}async trainOnBatch(e,n){const r=await this.standardizeUserData(e,n),s=r[0],o=r[1],a=this.makeTrainFunction()(s.concat(o)),l=[];for(const u of a){const c=await u.data();l.push(c[0])}return Fe(a),rs(r[0],e),rs(r[1],n),Vn(l)}getNamedWeights(e){const n=[],r=e!=null&&e.trainableOnly,s=r?this.trainableWeights:this.weights,o=this.getWeights(r);for(let i=0;i<s.length;++i)r&&!s[i].trainable||n.push({name:s[i].originalName,tensor:o[i]});return n}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){const e=super.dispose();if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const n=Zk().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=n-Zk().numTensors}return e}getLossIdentifiers(){let e;if(typeof this.loss=="string")e=to(this.loss);else if(Array.isArray(this.loss)){for(const n of this.loss)if(typeof n!="string")throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(n=>to(n))}else{const n=Object.keys(this.loss);e={};const r=this.loss;for(const s of n)if(typeof r[s]=="string")e[s]=to(r[s]);else throw new Error("Serialization of non-string loss is not supported.")}return e}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[to(uh(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>to(uh(e)));{const e={};for(const n in this.metrics)e[n]=to(uh(this.metrics[n]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(e.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(e.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(e.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const n=ix(e.optimizer_config),r=co(n);let s;if(typeof e.loss=="string")s=Ri(e.loss);else if(Array.isArray(e.loss))s=e.loss.map(i=>Ri(i));else if(e.loss!=null){s={};for(const i in e.loss)s[i]=Ri(e.loss[i])}let o;if(Array.isArray(e.metrics))o=e.metrics.map(i=>Ri(i));else if(e.metrics!=null){o={};for(const i in e.metrics)o[i]=Ri(e.metrics[i])}this.compile({loss:s,metrics:o,optimizer:r})}async save(e,n){if(typeof e=="string"){const u=tB(e);if(u.length===0)throw new M(`Cannot find any save handlers for URL '${e}'`);if(u.length>1)throw new M(`Found more than one (${u.length}) save handlers for URL '${e}'`);e=u[0]}if(e.save==null)throw new M("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const r=await eS(this.getNamedWeights(n)),a={modelTopology:this.toJSON(null,!1),format:wj,generatedBy:`TensorFlow.js tfjs-layers v${iA}`,convertedBy:null};if((n==null?!1:n.includeOptimizer)&&this.optimizer!=null){a.trainingConfig=this.getTrainingConfig();const u="optimizer",{data:c,specs:d}=await eS(await this.optimizer.getWeights(),u);r.specs.push(...d),r.data=eB([r.data,c])}return this.userDefinedMetadata!=null&&(TS(this.userDefinedMetadata,this.name,!0),a.userDefinedMetadata=this.userDefinedMetadata),a.weightData=r.data,a.weightSpecs=r.specs,e.save(a)}setUserDefinedMetadata(e){TS(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}El.className="Model";ee(El);class dA extends El{}dA.className="Functional";ee(dA);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class qc extends El{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=e.name!=null?e.name:Zg("sequential_"),e.layers!=null)for(const n of e.layers)this.add(n)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(r=>r<0))throw new M(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(e){const n=e instanceof qc||e instanceof El;let r;if(n){if(r=e,r.outputs.length!==1)throw new M("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(r.inputs.length!==1)throw new M("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(e.inboundNodes.length===0){if(e.batchInputShape==null)throw new M("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const s=C8({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(s)}if(n)this.outputs=r.outputs,this.inputs=r.inputs;else{if(e.inboundNodes.length!==1)throw new M(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${e.name} which has ${e.inboundNodes.length} pre-existing inbound connections.`);if(e.inboundNodes[0].outputTensors.length!==1)throw new M("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=jD(this.outputs[0])}this.inboundNodes=[],new e0({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:da(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(s=>s.shape),outputShapes:this.outputs[0].shape})}else{const s=e.apply(this.outputs[0]);if(Array.isArray(s))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[s],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,n){return this.model==null&&this.build(),this.model.call(e,n)}build(e){if(Ge(e),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new El({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,n,r=console.log){this.built||this.build(),super.summary(e,n,r)}setWeights(e){this.model==null&&this.build(),this.model.setWeights(e)}evaluate(e,n,r={}){if(!this.built)throw new Gr("The model needs to be compiled before being used.");return this.model.evaluate(e,n,r)}async evaluateDataset(e,n){if(!this.built)throw new Gr("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,n)}predict(e,n={}){return this.model==null&&this.build(),this.model.predict(e,n)}predictOnBatch(e){return this.model==null&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,n,r={}){if(!this.built)throw new Gr("The model needs to be compiled before being used.");return this.model.fit(e,n,r)}async fitDataset(e,n){if(!this.built)throw new Gr("The model needs to be compiled before being used.");return this.model.fitDataset(e,n)}async trainOnBatch(e,n){return this.model.trainOnBatch(e,n)}static fromConfig(e,n,r={},s=!1){let o,i={};if(n instanceof Array){if(n[0].className==null||n[0].className==="Merge")throw new M("Legacy serialization format not supported yet.");o=n}else D(n.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),o=n.layers,delete n.layers,i=n;const a=new e(i);if(!(a instanceof qc))throw new Te(`Sequential.fromConfig called on non-Sequential input: ${a}`);for(const l of o){const c=co(l,void 0,s);s&&c.setFastWeightInitDuringBuild(!0),a.add(c)}return a}set stopTraining(e){if(this.model==null)throw new M("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(this.model==null)throw new M("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const e=[];for(const n of this.layers){const r={};r.className=n.getClassName(),r.config=n.getConfig(),e.push(r)}return{name:this.name,layers:e}}}qc.className="Sequential";ee(qc);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let $n=class extends uu{getConfig(){return{}}};class fA extends $n{apply(e,n=1){return a8(e,n)}}fA.className="elu";ee(fA);class hA extends $n{apply(e){return RR(e)}}hA.className="selu";ee(hA);class pA extends $n{apply(e){return Ra(e)}}pA.className="relu";ee(pA);class mA extends $n{apply(e){return H(()=>Hc(6,Ra(e)))}}mA.className="relu6";ee(mA);class gA extends $n{apply(e){return e}}gA.className="linear";ee(gA);class vA extends $n{apply(e){return iu(e)}}vA.className="sigmoid";ee(vA);class bA extends $n{apply(e){return u8(e)}}bA.className="hardSigmoid";ee(bA);class xA extends $n{apply(e){return uf(e)}}xA.className="softplus";ee(xA);class yA extends $n{apply(e){return l8(e)}}yA.className="softsign";ee(yA);class wA extends $n{apply(e){return Wg(e)}}wA.className="tanh";ee(wA);let f$=class extends $n{apply(e,n=-1){return mw(e,n)}};f$.className="softmax";ee(f$);class $A extends $n{apply(e,n=-1){return wR(e,n)}}$A.className="logSoftmax";ee($A);class CA extends $n{apply(e){return H(()=>H(()=>{const n=Math.sqrt(2),r=_(.5,ne(1,gR(be(e,n))));return _(e,r)}))}}CA.className="gelu";ee(CA);class kA extends $n{apply(e){return H(()=>_(.5,_(e,ne(1,Wg(_(yn(be(2,Math.PI)),ne(e,_(.044715,la(e,3)))))))))}}kA.className="gelu_new";ee(kA);class SA extends $n{apply(e){return H(()=>_(e,Wg(uf(e))))}}SA.className="mish";ee(SA);class IA extends $n{apply(e,n=1){return H(()=>_(iu(_(e,n)),e))}}IA.className="swish";ee(IA);function oi(t){return t.getClassName()}function hv(t,e={}){return gf(t,zr.getMap().classNameMap,e,"activation")}function ii(t){if(t==null){const e={};return e.className="linear",e.config={},hv(e)}if(typeof t=="string"){const e={};return e.className=t,e.config={},hv(e)}else return t instanceof $n?t:hv(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function $j(t){if(t!=null&&typeof t!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${t}`)}class TA extends uu{}class EA extends TA{constructor(e){super(),$j(e),this.l1=e==null||e.l1==null?.01:e.l1,this.l2=e==null||e.l2==null?.01:e.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(e){return H(()=>{let n=Ct([1]);return this.hasL1&&(n=ne(n,ge(_(this.l1,En(e))))),this.hasL2&&(n=ne(n,ge(_(this.l2,bf(e))))),B(n,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,n){return new e({l1:n.l1,l2:n.l2})}}EA.className="L1L2";ee(EA);const FS={l1l2:"L1L2"};function ot(t){return Zw(t)}function PS(t,e={}){return gf(t,zr.getMap().classNameMap,e,"regularizer")}function xt(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in FS?FS[t]:t,config:{}};return PS(n)}else return t instanceof TA?t:PS(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class NA extends Ae{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null&&(this.maxValue=e.maxValue)}call(e,n){e=we(e);let r=Ra(e);return this.maxValue!=null&&(r=br(r,0,this.maxValue)),r}computeOutputShape(e){return e}getConfig(){const e={maxValue:this.maxValue},n=super.getConfig();return Object.assign(e,n),e}}NA.className="ReLU";ee(NA);class RA extends Ae{constructor(e){super(e??{}),this.DEFAULT_ALPHA=.3,e==null&&(e={}),this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const r=we(e);return J1(r,this.alpha)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}}RA.className="LeakyReLU";ee(RA);class DA extends Ae{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",e==null&&(e={}),this.supportsMasking=!0,this.alphaInitializer=vt(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=xt(e.alphaRegularizer),this.alphaConstraint=qt(e.alphaConstraint),e.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if(typeof e.sharedAxes=="number")this.sharedAxes=[e.sharedAxes];else throw new M(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`)}build(e){e=Ge(e);const n=e.slice(1);if(this.sharedAxes!=null)for(const s of this.sharedAxes)n[s-1]=1;this.alpha=this.addWeight("alpha",n,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const r={};if(this.sharedAxes!=null)for(let s=1;s<e.length;++s)r[s]=e[s];this.inputSpec=[new Kt({ndim:e.length,axes:r})],this.built=!0}call(e,n){return e=we(e),ow(e,this.alpha.read())}getConfig(){const e={alphaInitializer:St(this.alphaInitializer),alphaRegularizer:ot(this.alphaRegularizer),alphaConstraint:Xt(this.alphaConstraint),sharedAxes:this.sharedAxes},n=super.getConfig();return Object.assign(e,n),e}}DA.className="PReLU";ee(DA);let AA=class extends Ae{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA=1,e==null&&(e={}),e.alpha!=null&&e.alpha!==this.DEFAULT_ALPHA)throw new Te(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const r=we(e);return Hg(r)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}};AA.className="ELU";ee(AA);class FA extends Ae{constructor(e){super(e??{}),this.DEFAULT_THETA=1,e==null&&(e={}),this.theta=e.theta==null?this.DEFAULT_THETA:e.theta}call(e,n){const r=we(e);return _(r,ce(wr(r,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){const e={theta:this.theta},n=super.getConfig();return Object.assign(e,n),e}}FA.className="ThresholdedReLU";ee(FA);class PA extends Ae{constructor(e){super(e??{}),this.DEFAULT_AXIS=1,e==null&&(e={}),this.softmax=new f$().apply,this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis}call(e,n){return H(()=>{let r=we(e);const s=n.mask;if(s!=null){const o=_(ye(ko(r.shape),ce(s,r.dtype)),qe(-1e9));r=ne(r,o)}return this.axis instanceof Array?this.axis.length>1?Gs(ye(r,$R(r,this.axis,!0))):this.softmax(r,this.axis[0]):this.softmax(r,this.axis)})}computeOutputShape(e){return e}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}PA.className="Softmax";ee(PA);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Nl(t,e,n){if(typeof t=="number")return da(t,e);if(t.length!==e)throw new M(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${t.length} elements.`);for(let r=0;r<e;++r){const s=t[r];if(!r8(s))throw new M(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${JSON.stringify(t)} including a non-integer number ${s}`)}return t}function gs(t,e,n,r,s=1){if(t==null)return t;const o=e+(e-1)*(s-1);let i;return n==="same"?i=t:i=t-o+1,Math.floor((i+r-1)/r)}function As(t,e,n,r){if(t==null)return null;if(r==="valid")t=t*e+si([n-e,0]);else if(r==="same")t=t*e;else throw new M(`Unsupport padding mode: ${r}.`);return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function h$(t,e){return H(()=>(Lt(e),e==="channelsFirst"?ze(t,[0,2,3,1]):t))}function OA(t,e){return H(()=>(Lt(e),e==="channelsFirst"?ze(t,[0,2,3,4,1]):t))}function Cj(t,e,n,r=1,s="valid",o,i=1){return H(()=>{if(o==null&&(o=xs()),Lt(o),t.shape.length!==3)throw new M(`The input of a conv1dWithBias operation should be 3, but is ${t.shape.length} instead.`);if(e.shape.length!==3)throw new M(`The kernel for a conv1dWithBias operation should be 3, but is ${e.shape.length} instead`);if(n!=null&&n.shape.length!==1)throw new M(`The bias for a conv1dWithBias operation should be 1, but is ${n.shape.length} instead`);if(o==="channelsFirst"&&(t=ze(t,[0,2,1])),s==="causal")throw new Te("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let a=dR(t,e,r,s==="same"?"same":"valid","NWC",i);return n!=null&&(a=ks(a,n)),a})}function OS(t,e,n,r=[1,1],s="valid",o,i,a=null){return H(()=>{if(o==null&&(o=xs()),Lt(o),t.rank!==3&&t.rank!==4)throw new M(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${t.rank}.`);if(e.rank!==3&&e.rank!==4)throw new M(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${t.rank}.`);let l=h$(t,o);if(s==="causal")throw new Te("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=A5({x:l,filter:e,strides:r,pad:s==="same"?"same":"valid",dilations:i,dataFormat:"NHWC",bias:n,activation:a}),o==="channelsFirst"&&(l=ze(l,[0,3,1,2])),l})}function kj(t,e,n,r=[1,1,1],s="valid",o,i){return H(()=>{if(o==null&&(o=xs()),Lt(o),t.rank!==4&&t.rank!==5)throw new M(`conv3dWithBias expects input to be of rank 4 or 5, but received ${t.rank}.`);if(e.rank!==4&&e.rank!==5)throw new M(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${t.rank}.`);let a=OA(t,o);if(s==="causal")throw new Te("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return a=DW(a,e,r,s==="same"?"same":"valid","NDHWC",i),n!=null&&(a=ks(a,n)),o==="channelsFirst"&&(a=ze(a,[0,4,1,2,3])),a})}class r0 extends Ae{constructor(e,n){if(super(n),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",r0.verifyArgs(n),this.rank=e,tn(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new Te(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=Nl(n.kernelSize,e,"kernelSize"),this.strides=Nl(n.strides==null?1:n.strides,e,"strides"),this.padding=n.padding==null?"valid":n.padding,$r(this.padding),this.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,Lt(this.dataFormat),this.activation=ii(n.activation),this.useBias=n.useBias==null?!0:n.useBias,this.biasInitializer=vt(n.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=qt(n.biasConstraint),this.biasRegularizer=xt(n.biasRegularizer),this.activityRegularizer=xt(n.activityRegularizer),this.dilationRate=Nl(n.dilationRate==null?1:n.dilationRate,e,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new M(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new M(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new M(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(e){if(Ds("kernelSize"in e,"required key 'kernelSize' not in config"),typeof e.kernelSize!="number"&&!Jw(e.kernelSize,"number",1,3))throw new M(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(e.kernelSize)}.`)}getConfig(){const e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:oi(this.activation),useBias:this.useBias,biasInitializer:St(this.biasInitializer),biasRegularizer:ot(this.biasRegularizer),activityRegularizer:ot(this.activityRegularizer),biasConstraint:Xt(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}class cu extends r0{constructor(e,n){super(e,n),this.kernel=null,cu.verifyArgs(n),this.filters=n.filters,tn(this.filters,"filters"),this.kernelInitializer=vt(n.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=qt(n.kernelConstraint),this.kernelRegularizer=xt(n.kernelRegularizer)}build(e){e=Ge(e);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new M(`The channel dimension of the input should be defined. Found ${e[n]}`);const r=e[n],s=this.kernelSize.concat([r,this.filters]);this.kernel=this.addWeight("kernel",s,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[n]:r}}],this.built=!0}call(e,n){return H(()=>{e=we(e);let r;const s=this.bias==null?null:this.bias.read(),o=DD(this.activation.getClassName());if(o!=null&&this.rank===2)r=OS(e,this.kernel.read(),s,this.strides,this.padding,this.dataFormat,this.dilationRate,o);else{if(this.rank===1)r=Cj(e,this.kernel.read(),s,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)r=OS(e,this.kernel.read(),s,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)r=kj(e,this.kernel.read(),s,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new Te("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(r=this.activation.apply(r))}return r})}computeOutputShape(e){e=Ge(e);const n=[],r=this.dataFormat==="channelsLast"?e.slice(1,e.length-1):e.slice(2);for(let o=0;o<r.length;++o){const i=gs(r[o],this.kernelSize[o],this.padding,this.strides[o],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[o]);n.push(i)}let s=[e[0]];return this.dataFormat==="channelsLast"?(s=s.concat(n),s.push(this.filters)):(s.push(this.filters),s=s.concat(n)),s}getConfig(){const e={filters:this.filters,kernelInitializer:St(this.kernelInitializer),kernelRegularizer:ot(this.kernelRegularizer),kernelConstraint:Xt(this.kernelConstraint)},n=super.getConfig();return Object.assign(e,n),e}static verifyArgs(e){if(!("filters"in e)||typeof e.filters!="number"||e.filters<1)throw new M(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(e.filters)}`)}}class $f extends cu{constructor(e){super(2,e),$f.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!Jw(e.kernelSize,"number",1,2))throw new M(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(e.kernelSize)}.`)}}$f.className="Conv2D";ee($f);class Cf extends cu{constructor(e){super(3,e),Cf.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!(Array.isArray(e.kernelSize)&&(e.kernelSize.length===1||e.kernelSize.length===3)))throw new M(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(e.kernelSize)}.`)}}Cf.className="Conv3D";ee(Cf);class LA extends $f{constructor(e){if(super(e),this.inputSpec=[new Kt({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new M(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=Ge(e),e.length!==4)throw new M("Input should have rank 4; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new M("The channel dimension of the inputs should be defined. Found `None`.");const r=e[n],s=this.kernelSize.concat([this.filters,r]);this.kernel=this.addWeight("kernel",s,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Kt({ndim:4,axes:{[n]:r}})],this.built=!0}call(e,n){return H(()=>{let r=we(e);if(r.shape.length!==4)throw new M(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${r.shape.length}`);const s=r.shape,o=s[0];let i,a;this.dataFormat==="channelsFirst"?(i=2,a=3):(i=1,a=2);const l=s[i],u=s[a],c=this.kernelSize[0],d=this.kernelSize[1],f=this.strides[0],h=this.strides[1],p=As(l,f,c,this.padding),g=As(u,h,d,this.padding),v=[o,p,g,this.filters];this.dataFormat!=="channelsLast"&&(r=ze(r,[0,2,3,1]));let m=fR(r,this.kernel.read(),v,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(m=ze(m,[0,3,1,2])),this.bias!=null&&(m=ks(m,this.bias.read(),this.dataFormat)),this.activation!=null&&(m=this.activation.apply(m)),m})}computeOutputShape(e){e=Ge(e);const n=e.slice();let r,s,o;this.dataFormat==="channelsFirst"?(r=1,s=2,o=3):(r=3,s=1,o=2);const i=this.kernelSize[0],a=this.kernelSize[1],l=this.strides[0],u=this.strides[1];return n[r]=this.filters,n[s]=As(n[s],l,i,this.padding),n[o]=As(n[o],u,a,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}LA.className="Conv2DTranspose";ee(LA);class MA extends Cf{constructor(e){if(super(e),this.inputSpec=[new Kt({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new M(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=Ge(e),e.length!==5)throw new M("Input should have rank 5; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new M("The channel dimension of the inputs should be defined. Found `None`.");const r=e[n],s=this.kernelSize.concat([this.filters,r]);this.kernel=this.addWeight("kernel",s,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Kt({ndim:5,axes:{[n]:r}})],this.built=!0}call(e,n){return H(()=>{let r=we(e);if(r.shape.length!==5)throw new M(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${r.shape.length}`);const s=r.shape,o=s[0];let i,a,l;this.dataFormat==="channelsFirst"?(l=2,i=3,a=4):(l=1,i=2,a=3);const u=s[l],c=s[i],d=s[a],f=this.kernelSize[0],h=this.kernelSize[1],p=this.kernelSize[2],g=this.strides[0],v=this.strides[1],m=this.strides[2],b=As(u,g,f,this.padding),x=As(c,v,h,this.padding),y=As(d,m,p,this.padding),$=[o,b,x,y,this.filters];this.dataFormat!=="channelsLast"&&(r=ze(r,[0,2,3,4,1]));let C=PW(r,this.kernel.read(),$,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(C=ze(C,[0,4,1,2,3])),this.bias!==null&&(C=ks(C,this.bias.read(),this.dataFormat)),this.activation!==null&&(C=this.activation.apply(C)),C})}computeOutputShape(e){e=Ge(e);const n=e.slice();let r,s,o,i;this.dataFormat==="channelsFirst"?(r=1,s=2,o=3,i=4):(r=4,s=1,o=2,i=3);const a=this.kernelSize[0],l=this.kernelSize[1],u=this.kernelSize[2],c=this.strides[0],d=this.strides[1],f=this.strides[2];return n[r]=this.filters,n[s]=As(n[s],c,a,this.padding),n[o]=As(n[o],d,l,this.padding),n[i]=As(n[i],f,u,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}MA.className="Conv3DTranspose";ee(MA);class _A extends cu{constructor(e,n){if(super(e,n),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,n.filters==null)throw new M("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(n.kernelInitializer!=null||n.kernelRegularizer!=null||n.kernelConstraint!=null)throw new M("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(n.padding!=null&&n.padding!=="same"&&n.padding!=="valid")throw new M(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(n.padding)}`);this.depthMultiplier=n.depthMultiplier==null?1:n.depthMultiplier,this.depthwiseInitializer=vt(n.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=xt(n.depthwiseRegularizer),this.depthwiseConstraint=qt(n.depthwiseConstraint),this.pointwiseInitializer=vt(n.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=xt(n.pointwiseRegularizer),this.pointwiseConstraint=qt(n.pointwiseConstraint)}build(e){if(e=Ge(e),e.length<this.rank+2)throw new M(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null||e[n]<0)throw new M(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[n])}`);const r=e[n],s=this.kernelSize.concat([r,this.depthMultiplier]),o=[];for(let a=0;a<this.rank;++a)o.push(1);o.push(r*this.depthMultiplier,this.filters);const i=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",s,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,i,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",o,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,i,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,i,this.biasConstraint):this.bias=null,this.inputSpec=[new Kt({ndim:this.rank+2,axes:{[n]:r}})],this.built=!0}call(e,n){return H(()=>{e=we(e);let r;if(this.rank===1)throw new Te("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(e=ze(e,[0,2,3,1])),r=DR(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(r=ks(r,this.bias.read(),this.dataFormat)),this.activation!=null&&(r=this.activation.apply(r)),this.dataFormat==="channelsFirst"&&(r=ze(r,[0,3,1,2])),r})}getConfig(){const e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=St(this.depthwiseInitializer),e.pointwiseInitializer=St(this.pointwiseInitializer),e.depthwiseRegularizer=ot(this.depthwiseRegularizer),e.pointwiseRegularizer=ot(this.pointwiseRegularizer),e.depthwiseConstraint=Xt(this.depthwiseConstraint),e.pointwiseConstraint=Xt(this.pointwiseConstraint),e}}_A.className="SeparableConv";class zA extends _A{constructor(e){super(2,e)}}zA.className="SeparableConv2D";ee(zA);class s0 extends cu{constructor(e){super(1,e),s0.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){const e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!Jw(e.kernelSize,"number",1,1))throw new M(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(e.kernelSize)}.`)}}s0.className="Conv1D";ee(s0);class VA extends Ae{constructor(e){super(e),typeof e.cropping=="number"?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]=="number"?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=e.dataFormat===void 0?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return this.dataFormat==="channelsFirst"?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,n){return H(()=>{if(e=we(e),this.dataFormat==="channelsLast"){const r=lh(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return lh(r,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const r=lh(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return lh(r,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const e={cropping:this.cropping,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}VA.className="Cropping2D";ee(VA);class BA extends Ae{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=e.size==null?this.DEFAULT_SIZE:e.size,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Lt(this.dataFormat),this.interpolation=e.interpolation==null?"nearest":e.interpolation,e8(this.interpolation)}computeOutputShape(e){if(this.dataFormat==="channelsFirst"){const n=e[2]==null?null:this.size[0]*e[2],r=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],n,r]}else{const n=e[1]==null?null:this.size[0]*e[1],r=e[2]==null?null:this.size[1]*e[2];return[e[0],n,r,e[3]]}}call(e,n){return H(()=>{let r=we(e);const s=r.shape;if(this.dataFormat==="channelsFirst"){r=ze(r,[0,2,3,1]);const o=this.size[0]*s[2],i=this.size[1]*s[3],a=this.interpolation==="nearest"?io.resizeNearestNeighbor(r,[o,i]):io.resizeBilinear(r,[o,i]);return ze(a,[0,3,1,2])}else{const o=this.size[0]*s[1],i=this.size[1]*s[2];return this.interpolation==="nearest"?io.resizeNearestNeighbor(r,[o,i]):io.resizeBilinear(r,[o,i])}})}getConfig(){const e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},n=super.getConfig();return Object.assign(e,n),e}}BA.className="UpSampling2D";ee(BA);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Sj(t,e,n=[1,1],r="valid",s,o){return H(()=>{s==null&&(s=xs()),Lt(s);let i=h$(t,s);if(t.rank!==4)throw new M(`Input for depthwiseConv2d is required to be 4-D, but is instead ${t.rank}-D`);if(e.rank!==4)throw new M(`depthwiseKernel is required to be 4-D, but is instead ${e.rank}-D`);return i=q1(i,e,n,r==="same"?"same":"valid","NHWC",o),s==="channelsFirst"&&(i=ze(i,[0,3,1,2])),i})}class WA extends r0{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=vt(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=qt(e.depthwiseConstraint),this.depthwiseRegularizer=xt(e.depthwiseRegularizer)}build(e){if(e=Ge(e),e.length<4)throw new M(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);const n=this.dataFormat==="channelsFirst"?1:3;if(e[n]==null||e[n]<0)throw new M(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[n]}).`);const r=e[n],s=[this.kernelSize[0],this.kernelSize[1],r,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",s,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[r*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return H(()=>{e=we(e);let r=Sj(e,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(r=ks(r,this.bias.read(),this.dataFormat)),this.activation!=null&&(r=this.activation.apply(r)),r})}computeOutputShape(e){e=Ge(e);const n=this.dataFormat==="channelsFirst"?e[2]:e[1],r=this.dataFormat==="channelsFirst"?e[3]:e[2],s=this.dataFormat==="channelsFirst"?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,o=gs(n,this.kernelSize[0],this.padding,this.strides[0]),i=gs(r,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[e[0],s,o,i]:[e[0],o,i,s]}getConfig(){const e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=St(this.depthwiseInitializer),e.depthwiseRegularizer=ot(this.depthwiseRegularizer),e.depthwiseConstraint=Xt(this.depthwiseRegularizer),e}}WA.className="DepthwiseConv2D";ee(WA);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function UA(t,e,n,r){if(Array.isArray(t)){if(e!=null||n!=null)throw new M("When inputs is an array, neither initialState or constants should be provided");r!=null&&(n=t.slice(t.length-r,t.length),t=t.slice(0,t.length-r)),t.length>1&&(e=t.slice(1,t.length)),t=t[0]}function s(o){return o==null||Array.isArray(o)?o:[o]}return e=s(e),n=s(n),{inputs:t,initialState:e,constants:n}}function GA(t,e,n,r=!1,s,o,i=!1,a=!1){return H(()=>{const l=e.shape.length;if(l<3)throw new M(`Input should be at least 3D, but is ${l}D.`);const u=[1,0].concat(bs(2,l));e=ze(e,u),i&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),s!=null&&(s=ce(ce(s,"bool"),"float32"),s.rank===l-1&&(s=zn(s,-1)),s=ze(s,u)),r&&(e=ua(e,0),s!=null&&(s=ua(s,0)));const c=[];let d,f=n;const h=e.shape[0],p=ca(e);let g;s!=null&&(g=ca(s));for(let m=0;m<h;++m){const b=p[m],x=H(()=>t(b,f));if(s==null)d=x[0],f=x[1];else{const y=H(()=>{const $=g[m],C=ye(Yr($),$),k=ne(_(x[0],$),_(f[0],C)),w=f.map((I,N)=>ne(_(x[1][N],$),_(I,C)));return{output:k,newStates:w}});d=y.output,f=y.newStates}a&&c.push(d)}let v;return a&&(v=vo(c,1)),[d,v,f]})}class bi extends Ae{constructor(e){super(e);let n;if(e.cell==null)throw new M("cell property is missing for the constructor of RNN.");if(Array.isArray(e.cell)?n=new g$({cells:e.cell}):n=e.cell,n.stateSize==null)throw new M("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=n,this.returnSequences=e.returnSequences==null?!1:e.returnSequences,this.returnState=e.returnState==null?!1:e.returnState,this.goBackwards=e.goBackwards==null?!1:e.goBackwards,this._stateful=e.stateful==null?!1:e.stateful,this.unroll=e.unroll==null?!1:e.unroll,this.supportsMasking=!0,this.inputSpec=[new Kt({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return bs(0,e).map(n=>null)}else return this.states_}setStates(e){this.states_=e}computeOutputShape(e){rx(e)&&(e=e[0]),e=e;let n=this.cell.stateSize;Array.isArray(n)||(n=[n]);const r=n[0];let s;if(this.returnSequences?s=[e[0],e[1],r]:s=[e[0],r],this.returnState){const o=[];for(const i of n)o.push([e[0],i]);return[s].concat(o)}else return s}computeMask(e,n){return H(()=>{Array.isArray(n)&&(n=n[0]);const r=this.returnSequences?n:null;if(this.returnState){const s=this.states.map(o=>null);return[r].concat(s)}else return r})}get states(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,n=[];for(let r=0;r<e;++r)n.push(null);return n}else return this.states_}set states(e){this.states_=e}build(e){if(this.numConstants!=null)throw new Te("Constants support is not implemented in RNN yet.");rx(e)&&(e=e[0]),e=e;const n=this.stateful?e[0]:null,r=e.slice(2);this.inputSpec[0]=new Kt({shape:[n,null,...r]});const s=[e[0]].concat(e.slice(2));this.cell.build(s);let o;if(Array.isArray(this.cell.stateSize)?o=this.cell.stateSize:o=[this.cell.stateSize],this.stateSpec!=null){if(!Ye(this.stateSpec.map(i=>i.shape[i.shape.length-1]),o))throw new M(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=o.map(i=>new Kt({shape:[null,i]}));this.stateful&&this.resetStates()}resetStates(e,n=!1){H(()=>{if(!this.stateful)throw new Rs("Cannot call resetStates() on an RNN Layer that is not stateful.");const r=this.inputSpec[0].shape[0];if(r==null)throw new M("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(s=>Ct([r,s])):this.states_=[Ct([r,this.cell.stateSize])];else if(e==null)Fe(this.states_),this.keptStates!=null&&(Fe(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(s=>Ct([r,s])):this.states_[0]=Ct([r,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new M(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n===!0?this.keptStates.push(this.states_.slice()):Fe(this.states_);for(let s=0;s<this.states_.length;++s){const o=e[s],i=Array.isArray(this.cell.stateSize)?this.cell.stateSize[s]:this.cell.stateSize,a=[r,i];if(!Ye(o.shape,a))throw new M(`State ${s} is incompatible with layer ${this.name}: expected shape=${a}, received shape=${o.shape}`);this.states_[s]=o}}this.states_=this.states_.map(s=>_s(s.clone()))})}apply(e,n){let r=n==null?null:n.initialState,s=n==null?null:n.constants;n==null&&(n={});const o=UA(e,r,s,this.numConstants);e=o.inputs,r=o.initialState,s=o.constants;let i=[],a=[];if(r!=null){n.initialState=r,i=i.concat(r),this.stateSpec=[];for(const u of r)this.stateSpec.push(new Kt({shape:u.shape}));a=a.concat(this.stateSpec)}if(s!=null&&(n.constants=s,i=i.concat(s),this.numConstants=s.length),i[0]instanceof js){const u=[e].concat(i),c=this.inputSpec.concat(a),d=this.inputSpec;this.inputSpec=c;const f=super.apply(u,n);return this.inputSpec=d,f}else return super.apply(e,n)}call(e,n){return H(()=>{const r=n==null?null:n.mask,s=n==null?null:n.training;let o=n==null?null:n.initialState;e=we(e),o==null&&(this.stateful?o=this.states_:o=this.getInitialState(e));const i=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(o.length!==i)throw new M(`RNN Layer has ${i} state(s) but was passed ${o.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const a={training:s},u=GA((p,g)=>{const v=this.cell.call([p].concat(g),a);return[v[0],v.slice(1)]},e,o,this.goBackwards,r,null,this.unroll,this.returnSequences),c=u[0],d=u[1],f=u[2];this.stateful&&this.resetStates(f,s);const h=this.returnSequences?d:c;return this.returnState?[h].concat(f):h})}getInitialState(e){return H(()=>{let n=Ct(e.shape);return n=ge(n,[1,2]),n=vf(n),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(r=>r>1?tx(n,[1,r]):n):this.cell.stateSize>1?[tx(n,[1,this.cell.stateSize])]:[n]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){const e=super.getConfig(),n={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(n.numConstants=this.numConstants);const r=this.cell.getConfig();return this.getClassName()===bi.className&&(n.cell={className:this.cell.getClassName(),config:r}),Object.assign(Object.assign(Object.assign({},r),e),n)}static fromConfig(e,n,r={}){const s=n.cell,o=co(s,r);return new e(Object.assign(n,{cell:o}))}}bi.className="RNN";ee(bi);class o0 extends Ae{}class p$ extends o0{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,tn(this.units,"units"),this.activation=ii(e.activation==null?this.DEFAULT_ACTIVATION:e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=vt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=vt(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=vt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=xt(e.kernelRegularizer),this.recurrentRegularizer=xt(e.recurrentRegularizer),this.biasRegularizer=xt(e.biasRegularizer),this.kernelConstraint=qt(e.kernelConstraint),this.recurrentConstraint=qt(e.recurrentConstraint),this.biasConstraint=qt(e.biasConstraint),this.dropout=Hl([1,si([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Hl([1,si([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Ge(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return H(()=>{if(e=e,e.length!==2)throw new M(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let r=e[1];e=e[0];const s=n.training==null?!1:n.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=ai({ones:()=>Yr(e),rate:this.dropout,training:s,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=ai({ones:()=>Yr(r),rate:this.recurrentDropout,training:s,dropoutFunc:this.dropoutFunc}));let o;const i=this.dropoutMask,a=this.recurrentDropoutMask;i!=null?o=Bs(_(e,i),this.kernel.read()):o=Bs(e,this.kernel.read()),this.bias!=null&&(o=ks(o,this.bias.read())),a!=null&&(r=_(r,a));let l=ne(o,Bs(r,this.recurrentKernel.read()));return this.activation!=null&&(l=this.activation.apply(l)),[l,l]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:oi(this.activation),useBias:this.useBias,kernelInitializer:St(this.kernelInitializer),recurrentInitializer:St(this.recurrentInitializer),biasInitializer:St(this.biasInitializer),kernelRegularizer:ot(this.kernelRegularizer),recurrentRegularizer:ot(this.recurrentRegularizer),biasRegularizer:ot(this.biasRegularizer),activityRegularizer:ot(this.activityRegularizer),kernelConstraint:Xt(this.kernelConstraint),recurrentConstraint:Xt(this.recurrentConstraint),biasConstraint:Xt(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),n)}}p$.className="SimpleRNNCell";ee(p$);class HA extends bi{constructor(e){e.cell=new p$(e),super(e)}call(e,n){return H(()=>{this.cell.dropoutMask!=null&&(Fe(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Fe(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=n==null?null:n.mask,s=n==null?null:n.training,o=n==null?null:n.initialState;return super.call(e,{mask:r,training:s,initialState:o})})}static fromConfig(e,n){return new e(n)}}HA.className="SimpleRNN";ee(HA);class m$ extends o0{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new M("GRUCell does not support reset_after parameter set to true.");this.units=e.units,tn(this.units,"units"),this.activation=ii(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=ii(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=vt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=vt(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=vt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=xt(e.kernelRegularizer),this.recurrentRegularizer=xt(e.recurrentRegularizer),this.biasRegularizer=xt(e.biasRegularizer),this.kernelConstraint=qt(e.kernelConstraint),this.recurrentConstraint=qt(e.recurrentConstraint),this.biasConstraint=qt(e.biasConstraint),this.dropout=Hl([1,si([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Hl([1,si([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Ge(e);const n=e[e.length-1];this.kernel=this.addWeight("kernel",[n,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return H(()=>{if(e=e,e.length!==2)throw new M(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);const r=n.training==null?!1:n.training;let s=e[1];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=ai({ones:()=>Yr(e),rate:this.dropout,training:r,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=ai({ones:()=>Yr(s),rate:this.recurrentDropout,training:r,count:3,dropoutFunc:this.dropoutFunc}));const o=this.dropoutMask,i=this.recurrentDropoutMask;let a,l,u;0<this.dropout&&this.dropout<1&&(e=_(e,o[0]));let c=Bs(e,this.kernel.read());this.useBias&&(c=ks(c,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(s=_(s,i[0]));const d=this.recurrentKernel.read(),[f,h]=gr(d,[2*this.units,this.units],d.rank-1),p=Bs(s,f),[g,v,m]=gr(c,3,c.rank-1),[b,x]=gr(p,2,p.rank-1);a=this.recurrentActivation.apply(ne(g,b)),l=this.recurrentActivation.apply(ne(v,x));const y=Bs(_(l,s),h);u=this.activation.apply(ne(m,y));const $=ne(_(a,s),_(ne(1,Ft(a)),u));return[$,$]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:oi(this.activation),recurrentActivation:oi(this.recurrentActivation),useBias:this.useBias,kernelInitializer:St(this.kernelInitializer),recurrentInitializer:St(this.recurrentInitializer),biasInitializer:St(this.biasInitializer),kernelRegularizer:ot(this.kernelRegularizer),recurrentRegularizer:ot(this.recurrentRegularizer),biasRegularizer:ot(this.biasRegularizer),activityRegularizer:ot(this.activityRegularizer),kernelConstraint:Xt(this.kernelConstraint),recurrentConstraint:Xt(this.recurrentConstraint),biasConstraint:Xt(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),n)}}m$.className="GRUCell";ee(m$);class jA extends bi{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new m$(e),super(e)}call(e,n){return H(()=>{this.cell.dropoutMask!=null&&(Fe(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Fe(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=n==null?null:n.mask,s=n==null?null:n.training,o=n==null?null:n.initialState;return super.call(e,{mask:r,training:s,initialState:o})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}jA.className="GRU";ee(jA);class i0 extends o0{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,tn(this.units,"units"),this.activation=ii(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=ii(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=vt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=vt(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=vt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=xt(e.kernelRegularizer),this.recurrentRegularizer=xt(e.recurrentRegularizer),this.biasRegularizer=xt(e.biasRegularizer),this.kernelConstraint=qt(e.kernelConstraint),this.recurrentConstraint=qt(e.recurrentConstraint),this.biasConstraint=qt(e.biasConstraint),this.dropout=Hl([1,si([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Hl([1,si([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var n;e=Ge(e);const r=e[e.length-1];this.kernel=this.addWeight("kernel",[r,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let s;if(this.useBias){if(this.unitForgetBias){const o=this.biasInitializer,i=this.units;s=new(n=class extends Jr{apply(l,u){const c=o.apply([i]),d=new t$().apply([i]),f=o.apply([i*2]);return bS(bS(c,d),f)}},n.className="CustomInit",n)}else s=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,s,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,n){return H(()=>{const r=n.training==null?!1:n.training;if(e=e,e.length!==3)throw new M(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let s=e[1];const o=e[2];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=ai({ones:()=>Yr(e),rate:this.dropout,training:r,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=ai({ones:()=>Yr(s),rate:this.recurrentDropout,training:r,count:4,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,a=this.recurrentDropoutMask;let l,u,c,d;0<this.dropout&&this.dropout<1&&(e=_(e,i[0]));let f=Bs(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(s=_(s,a[0])),f=ne(f,Bs(s,this.recurrentKernel.read())),this.useBias&&(f=ks(f,this.bias.read()));const[h,p,g,v]=gr(f,4,f.rank-1);l=this.recurrentActivation.apply(h),u=this.recurrentActivation.apply(p),c=ne(_(u,o),_(l,this.activation.apply(g))),d=this.recurrentActivation.apply(v);const m=_(d,this.activation.apply(c));return[m,m,c]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:oi(this.activation),recurrentActivation:oi(this.recurrentActivation),useBias:this.useBias,kernelInitializer:St(this.kernelInitializer),recurrentInitializer:St(this.recurrentInitializer),biasInitializer:St(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:ot(this.kernelRegularizer),recurrentRegularizer:ot(this.recurrentRegularizer),biasRegularizer:ot(this.biasRegularizer),activityRegularizer:ot(this.activityRegularizer),kernelConstraint:Xt(this.kernelConstraint),recurrentConstraint:Xt(this.recurrentConstraint),biasConstraint:Xt(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),n)}}i0.className="LSTMCell";ee(i0);class KA extends bi{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new i0(e),super(e)}call(e,n){return H(()=>{this.cell.dropoutMask!=null&&(Fe(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Fe(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=n==null?null:n.mask,s=n==null?null:n.training,o=n==null?null:n.initialState;return super.call(e,{mask:r,training:s,initialState:o})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}KA.className="LSTM";ee(KA);class g$ extends o0{constructor(e){super(e),this.cells=e.cells}get stateSize(){const e=[];for(const n of this.cells.slice().reverse())Array.isArray(n.stateSize)?e.push(...n.stateSize):e.push(n.stateSize);return e}call(e,n){return H(()=>{e=e;let r=e.slice(1);const s=[];for(const a of this.cells.slice().reverse())Array.isArray(a.stateSize)?s.push(r.splice(0,a.stateSize.length)):s.push(r.splice(0,1));s.reverse();const o=[];let i;for(let a=0;a<this.cells.length;++a){const l=this.cells[a];r=s[a],a===0?i=[e[0]].concat(r):i=[i[0]].concat(r),i=l.call(i,n),o.push(i.slice(1))}r=[];for(const a of o.slice().reverse())r.push(...a);return[i[0]].concat(r)})}build(e){rx(e)&&(e=e[0]),e=e;let n;this.cells.forEach((r,s)=>{ji(`RNNCell_${s}`,()=>{r.build(e),Array.isArray(r.stateSize)?n=r.stateSize[0]:n=r.stateSize,e=[e[0],n]})}),this.built=!0}getConfig(){const e=super.getConfig(),n=o=>({className:o.getClassName(),config:o.getConfig()}),s={cells:this.cells.map(n)};return Object.assign(Object.assign({},e),s)}static fromConfig(e,n,r={}){const s=[];for(const o of n.cells)s.push(co(o,r));return new e({cells:s})}get trainableWeights(){if(!this.trainable)return[];const e=[];for(const n of this.cells)e.push(...n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.cells)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const r of this.cells)n.push(...r.trainableWeights);return n.concat(e)}return e}getWeights(){const e=[];for(const n of this.cells)e.push(...n.weights);return sx(e)}setWeights(e){const n=[];for(const r of this.cells){const s=r.weights.length,o=e.splice(s);for(let i=0;i<r.weights.length;++i)n.push([r.weights[i],o[i]])}l$(n)}}g$.className="StackedRNNCells";ee(g$);function ai(t){const{ones:e,rate:n,training:r=!1,count:s=1,dropoutFunc:o}=t,i=()=>o!=null?o(e(),n):_D(e(),n),a=()=>xf(i,e,r);return!s||s<=1?_s(a().clone()):Array(s).fill(void 0).map(a).map(u=>_s(u.clone()))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var Ij=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n};class XA extends bi{constructor(e){if(e.unroll)throw new Te("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new Te("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new Kt({ndim:5})]}call(e,n){return H(()=>{if(this.cell.dropoutMask!=null&&(Fe(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Fe(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),n&&n.constants)throw new M("ConvRNN2D cell does not support constants");const r=n==null?null:n.mask,s=n==null?null:n.training,o=n==null?null:n.initialState;return super.call(e,{mask:r,training:s,initialState:o})})}computeOutputShape(e){let n=this.computeSingleOutputShape(e);return this.returnSequences||(n=[n[0],...n.slice(2)]),this.returnState&&(n=[n,...Array(2).fill([e[0],...n.slice(-3)])]),n}getInitialState(e){return H(()=>{const{stateSize:n}=this.cell,r=e.shape,s=this.computeSingleOutputShape(r),o=[s[0],...s.slice(2)],i=Ct(o);return Array.isArray(n)?Array(n.length).fill(i):[i]})}resetStates(e,n=!1){H(()=>{if(!this.stateful)throw new Rs("Cannot call resetStates() on an RNN Layer that is not stateful.");const r=this.inputSpec[0].shape,s=this.computeSingleOutputShape(r),o=[s[0],...s.slice(2)];if(r[0]==null)throw new M("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>Ct(o)):this.states_=[Ct(o)];else if(e==null)Fe(this.states_),this.keptStates!=null&&(Fe(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>Ct(o)):this.states_[0]=Ct(o);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new M(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n?this.keptStates.push(this.states_.slice()):Fe(this.states_);for(let a=0;a<this.states_.length;++a){const l=e[a],u=o;if(!Ye(l.shape,u))throw new M(`State ${a} is incompatible with layer ${this.name}: expected shape=${u}, received shape=${l.shape}`);this.states_[a]=l}}this.states_=this.states_.map(a=>_s(a.clone()))})}computeSingleOutputShape(e){const{dataFormat:n,filters:r,kernelSize:s,padding:o,strides:i,dilationRate:a}=this.cell,l=n==="channelsFirst",u=e[l?3:2],c=e[l?4:3],d=gs(u,s[0],o,i[0],a[0]),f=gs(c,s[1],o,i[1],a[1]);return[...e.slice(0,2),...l?[r,d,f]:[d,f,r]]}}XA.className="ConvRNN2D";class v$ extends i0{constructor(e){const{filters:n,kernelSize:r,strides:s,padding:o,dataFormat:i,dilationRate:a}=e;super(Object.assign(Object.assign({},e),{units:n})),this.filters=n,tn(this.filters,"filters"),this.kernelSize=Nl(r,2,"kernelSize"),this.kernelSize.forEach(l=>tn(l,"kernelSize")),this.strides=Nl(s||1,2,"strides"),this.strides.forEach(l=>tn(l,"strides")),this.padding=o||"valid",$r(this.padding),this.dataFormat=i||"channelsLast",Lt(this.dataFormat),this.dilationRate=Nl(a||1,2,"dilationRate"),this.dilationRate.forEach(l=>tn(l,"dilationRate"))}build(e){var n;e=Ge(e);const r=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[r]==null)throw new M(`The channel dimension of the input should be defined. Found ${e[r]}`);const s=e[r],o=4,i=this.kernelSize.concat([s,this.filters*o]);this.kernel=this.addWeight("kernel",i,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const a=this.kernelSize.concat([this.filters,this.filters*o]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",a,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let l;if(this.unitForgetBias){const u=this.biasInitializer,c=this.filters;l=new(n=class extends Jr{apply(f,h){const p=u.apply([c]),g=ko([c]),v=u.apply([c*2]);return e$([p,g,v])}},n.className="CustomInit",n)}else l=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*o],null,l,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,n){return H(()=>{if(e.length!==3)throw new M(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);const r=n.training||!1,s=e[0],o=e[1],i=e[2],a=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=ai({ones:()=>Yr(s),rate:this.dropout,training:r,count:a,dropoutFunc:this.dropoutFunc}));const l=this.dropoutMask,u=(U,K,Q)=>!K||!K[Q]?U:_(K[Q],U);let c=u(s,l,0),d=u(s,l,1),f=u(s,l,2),h=u(s,l,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=ai({ones:()=>Yr(o),rate:this.recurrentDropout,training:r,count:a,dropoutFunc:this.dropoutFunc}));const p=this.recurrentDropoutMask;let g=u(o,p,0),v=u(o,p,1),m=u(o,p,2),b=u(o,p,3);const x=3,[y,$,C,k]=gr(this.kernel.read(),a,x),[w,I,N,E]=this.useBias?gr(this.bias.read(),a):[null,null,null,null];c=this.inputConv(c,y,w,this.padding),d=this.inputConv(d,$,I,this.padding),f=this.inputConv(f,C,N,this.padding),h=this.inputConv(h,k,E,this.padding);const[R,S,T,F]=gr(this.recurrentKernel.read(),a,x);g=this.recurrentConv(g,R),v=this.recurrentConv(v,S),m=this.recurrentConv(m,T),b=this.recurrentConv(b,F);const L=this.recurrentActivation.apply(ne(c,g)),G=this.recurrentActivation.apply(ne(d,v)),P=ne(_(G,i),_(L,this.activation.apply(ne(f,m)))),z=_(this.recurrentActivation.apply(ne(h,b)),this.activation.apply(P));return[z,z,P]})}getConfig(){const e=super.getConfig(),n=Ij(e,["units"]),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},n),r)}inputConv(e,n,r,s){const o=aa(e,n,this.strides,s||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return r?ks(o,r,this.dataFormat):o}recurrentConv(e,n){return aa(e,n,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}v$.className="ConvLSTM2DCell";ee(v$);class qA extends XA{constructor(e){const n=new v$(e);super(Object.assign(Object.assign({},e),{cell:n}))}static fromConfig(e,n){return new e(n)}}qA.className="ConvLSTM2D";ee(qA);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class b$ extends Ae{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(this.noiseShape==null)return this.noiseShape;const n=e.shape,r=[];for(let s=0;s<this.noiseShape.length;++s)r.push(this.noiseShape[s]==null?n[s]:this.noiseShape[s]);return r}call(e,n){return H(()=>{this.invokeCallHook(e,n);const r=we(e);if(0<this.rate&&this.rate<1){const s=n.training==null?!1:n.training,o=this.getNoiseShape(r);return xf(()=>_D(r,this.rate,o,this.seed),()=>r,s)}return e})}getConfig(){const e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},n=super.getConfig();return Object.assign(e,n),e}dispose(){return super.dispose()}}b$.className="Dropout";ee(b$);class YA extends b${constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){const n=e.shape;return[n[0],1,n[2]]}}YA.className="SpatialDropout1D";ee(YA);class QA extends Ae{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){let n=null;e.batchSize!=null&&(n=e.batchSize),this.batchInputShape=[n,e.inputDim]}this.units=e.units,tn(this.units,"units"),this.activation=ii(e.activation),e.useBias!=null&&(this.useBias=e.useBias),this.kernelInitializer=vt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=vt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=qt(e.kernelConstraint),this.biasConstraint=qt(e.biasConstraint),this.kernelRegularizer=xt(e.kernelRegularizer),this.biasRegularizer=xt(e.biasRegularizer),this.activityRegularizer=xt(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){e=Ge(e);const n=e[e.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[n,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:n}}],this.built=!0}computeOutputShape(e){e=Ge(e);const n=e.slice();return n[n.length-1]=this.units,n}call(e,n){return H(()=>{this.invokeCallHook(e,n);const r=we(e),s=DD(this.activation.getClassName());let o;return s!=null?o=Bs(r,this.kernel.read(),s,this.bias?this.bias.read():null):(o=Bs(r,this.kernel.read()),this.bias!=null&&(o=ks(o,this.bias.read())),this.activation!=null&&(o=this.activation.apply(o))),o})}getConfig(){const e={units:this.units,activation:oi(this.activation),useBias:this.useBias,kernelInitializer:St(this.kernelInitializer),biasInitializer:St(this.biasInitializer),kernelRegularizer:ot(this.kernelRegularizer),biasRegularizer:ot(this.biasRegularizer),activityRegularizer:ot(this.activityRegularizer),kernelConstraint:Xt(this.kernelConstraint),biasConstraint:Xt(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}QA.className="Dense";ee(QA);class ZA extends Ae{constructor(e){e=e||{},super(e),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=Ge(e);for(const n of e.slice(1))if(n==null)throw new M(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],Zo(e,1)]}call(e,n){return H(()=>{this.invokeCallHook(e,n);let r=we(e);if(this.dataFormat==="channelsFirst"&&r.rank>1){const s=[0];for(let o=2;o<r.rank;++o)s.push(o);s.push(1),r=ze(r,s)}return i8(r)})}getConfig(){const e={};this.dataFormat!=null&&(e.dataFormat=this.dataFormat);const n=super.getConfig();return Object.assign(e,n),e}}ZA.className="Flatten";ee(ZA);class JA extends Ae{constructor(e){super(e),this.supportsMasking=!0,this.activation=ii(e.activation)}call(e,n){return H(()=>{this.invokeCallHook(e,n);const r=we(e);return this.activation.apply(r)})}getConfig(){const e={activation:oi(this.activation)},n=super.getConfig();return Object.assign(e,n),e}}JA.className="Activation";ee(JA);class eF extends Ae{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,n){return H(()=>(e=we(e),s8(e,this.n)))}getConfig(){const e={n:this.n},n=super.getConfig();return Object.assign(e,n),e}}eF.className="RepeatVector";ee(eF);class tF extends Ae{constructor(e){super(e),this.targetShape=e.targetShape;for(let n=0;n<this.targetShape.length;++n)this.isUnknown(this.targetShape[n])&&(this.targetShape[n]=null)}isUnknown(e){return e<0||e==null}fixUnknownDimension(e,n){const r="Total size of new array must be unchanged.",s=n.slice();let o=1,i=null;for(let l=0;l<s.length;++l){const u=s[l];if(this.isUnknown(u))if(i===null)i=l;else throw new M("Can only specifiy one unknown dimension.");else o*=u}const a=Zo(e);if(i!==null){if(o===0||a%o!==0)throw new M(r);s[i]=a/o}else if(a!==o)throw new M(r);return s}computeOutputShape(e){let n=!1;for(let r=0;r<e.length;++r)if(this.isUnknown(e[r])){n=!0;break}return n?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,n){return H(()=>{this.invokeCallHook(e,n);const r=we(e),s=r.shape,o=s.slice(0,1).concat(this.fixUnknownDimension(s.slice(1),this.targetShape));return B(r,o)})}getConfig(){const e={targetShape:this.targetShape},n=super.getConfig();return Object.assign(e,n),e}}tF.className="Reshape";ee(tF);class nF extends Ae{constructor(e){if(super(e),e.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);const n=bs(1,e.dims.length+1);if(!Ye(e.dims.slice().sort(),n))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new Kt({ndim:this.dims.length+1})]}computeOutputShape(e){e=Ge(e);const n=e.slice();return this.dims.forEach((r,s)=>{n[s+1]=e[r]}),n}call(e,n){return ze(we(e),this.dimsIncludingBatch)}getConfig(){const e={dims:this.dims},n=super.getConfig();return Object.assign(e,n),e}}nF.className="Permute";ee(nF);class rF extends Ae{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null?this.maskValue=e.maskValue==null?0:e.maskValue:this.maskValue=0}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={maskValue:this.maskValue};return Object.assign(n,e),n}computeMask(e,n){const r=we(e);return Xb(Dp(r,this.maskValue),-1)}call(e,n){return H(()=>{this.invokeCallHook(e,n);const r=we(e),i=Xb(Dp(r,this.maskValue),-1,!0);return _(r,ce(i,r.dtype))})}}rF.className="Masking";ee(rF);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class sF extends Ae{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",e.batchInputShape==null&&e.inputShape==null){let n=null;e.batchSize!=null&&(n=e.batchSize),e.inputLength==null?this.batchInputShape=[n,null]:this.batchInputShape=[n].concat(et(e.inputLength))}this.inputDim=e.inputDim,tn(this.inputDim,"inputDim"),this.outputDim=e.outputDim,tn(this.outputDim,"outputDim"),this.embeddingsInitializer=vt(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=xt(e.embeddingsRegularizer),this.activityRegularizer=xt(e.activityRegularizer),this.embeddingsConstraint=qt(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,n){return H(()=>this.maskZero?(e=we(e),Dp(e,Ve(e))):null)}computeOutputShape(e){if(e=Ge(e),this.inputLength==null)return[...e,this.outputDim];const n=et(this.inputLength);if(n.length!==e.length-1)throw new M(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let r=0;for(let s=0;s<n.length;++s){const o=n[s],i=e[s+1];if(o!=null&&i!=null&&o!==i)throw new M(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);o==null&&(n[r]=i),r++}}return[e[0],...n,this.outputDim]}call(e,n){return H(()=>{this.invokeCallHook(e,n);let r=we(e);r.dtype!=="int32"&&(r=Vs(r,"int32"));const s=MD(this.embeddings.read(),B(r,[r.size]));return B(s,Ge(this.computeOutputShape(r.shape)))})}getConfig(){const e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:St(this.embeddingsInitializer),embeddingsRegularizer:ot(this.embeddingsRegularizer),activityRegularizer:ot(this.activityRegularizer),embeddingsConstraint:Xt(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},n=super.getConfig();return Object.assign(e,n),e}}sF.className="Embedding";ee(sF);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Fa extends Ae{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new Te}computeElementwiseOpOutputShape(e,n){if(e==null||n==null)return null;if(e.length<n.length)return this.computeElementwiseOpOutputShape(n,e);if(n.length===0)return e;const r=e.slice(0,e.length-n.length);for(let s=0;s<n.length;++s){const o=e[e.length-n.length+s],i=n[s];if(o==null||i==null||o<0||i<0)r.push(null);else if(o===1)r.push(i);else if(i===1)r.push(o);else{if(o!==i)throw new M("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(n));r.push(o)}}return r}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[Ge(e)]),e=e,e.length<2)throw new M(`A merge layer should be called on an Array of at least 2 inputs. Got ${e.length} input(s).`);let n=[];for(const o of e)o!=null&&o[0]!==null&&n.push(o[0]);if(n=Qo(n),n.length>1)throw new M(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(e)}.`);let r=e[0]==null?null:e[0].slice(1);for(let o=1;o<e.length;++o){const i=e[o]==null?null:e[o].slice(1);r=this.computeElementwiseOpOutputShape(r,i)}const s=e.map(o=>o.length);e.indexOf(null)===-1&&Qo(s).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,n){return H(()=>{if(e=e,this.reshapeRequired){const r=[],s=e.map(o=>o.rank);if(s.indexOf(null)===-1){const o=si(s);for(let i of e){const a=i.rank;for(let l=0;l<o-a;++l)i=vf(i,1);r.push(i)}return this.mergeFunction(r)}else{let o=!1;for(const l of e){const u=l.rank;if(u==null){const c=l.shape,d=c[0],f=c.slice(1).concat([d]);let h=B(l,[d].concat(Zo(c.slice(1))));h=ze(h,[1,0]),h=B(h,f),r.push(h),o=!0}else if(u>1){const c=bs(1,u).concat([0]);r.push(ze(l,c)),o=!0}else r.push(l)}let i=this.mergeFunction(r);const a=i.rank;if(o){if(a==null){const l=i.shape,u=l.length,c=l[u-1],d=[c].concat(l.slice(0,l.length-1));i=B(ze(B(i,[-1,c]),[1,0]),d)}else if(a>1){const l=[a-1].concat(bs(0,a-1));i=ze(i,l)}}return i}}else return this.mergeFunction(e)})}computeOutputShape(e){e=e;let n;e[0]==null?n=null:n=e[0].slice(1);for(let s=1;s<e.length;++s){const o=e[s]==null?null:e[s].slice(1);n=this.computeElementwiseOpOutputShape(n,o)}let r=[];for(const s of e)s!=null&&s[0]!==null&&r.push(s[0]);return r=Qo(r),r.length===1?n=r.concat(n):n=[null].concat(n),n}computeMask(e,n){return H(()=>{if(n==null)return null;if(!Array.isArray(n))throw new M("`mask` should be an Array");if(!Array.isArray(e))throw new M("`inputs` should be an Array");if(n.length!==e.length)throw new M(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${e.length} vs ${n.length})`);if(n.every(s=>s==null))return null;n=n.map(s=>s==null?s:zn(s,0));let r=n[0];for(let s=1;s<n.length-1;++s)r=go(r,n[s]);return r})}}class oF extends Fa{constructor(e){super(e)}mergeFunction(e){return H(()=>{let n=e[0].clone();for(let r=1;r<e.length;++r)n=ne(n,e[r]);return n})}}oF.className="Add";ee(oF);class iF extends Fa{constructor(e){super(e)}mergeFunction(e){return H(()=>{let n=e[0].clone();for(let r=1;r<e.length;++r)n=_(n,e[r]);return n})}}iF.className="Multiply";ee(iF);class aF extends Fa{constructor(e){super(e)}mergeFunction(e){return H(()=>{let n=e[0].clone();for(let r=1;r<e.length;++r)n=ne(n,e[r]);return _(1/e.length,n)})}}aF.className="Average";ee(aF);class lF extends Fa{constructor(e){super(e)}mergeFunction(e){return H(()=>{let n=e[0];for(let r=1;r<e.length;++r)n=gi(n,e[r]);return n})}}lF.className="Maximum";ee(lF);class uF extends Fa{constructor(e){super(e)}mergeFunction(e){return H(()=>{let n=e[0];for(let r=1;r<e.length;++r)n=Hc(n,e[r]);return n})}}uF.className="Minimum";ee(uF);class cF extends Fa{constructor(e){super(e),this.DEFAULT_AXIS=-1,e==null&&(e={}),this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||e.length===1)throw new M("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;let n=!0;for(const s of e)if(s!=null){n=!1;break}if(n)return;const r=[];for(let s=0;s<e.length;++s){const o=e[s].slice();o.splice(this.axis,1);let i=!1;for(const a of r)if(Ye(a,o)){i=!0;break}i||r.push(o)}if(r.length>1)throw new M("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return H(()=>e$(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new M("A `Concatenate` layer should be called on a list of inputs.");const n=e,r=n[0].slice(),s=this.axis<0?r.length+this.axis:this.axis;for(const o of n.slice(1)){if(r[s]==null||o[s]==null){r[s]=null;break}r[s]+=o[s]}return r}computeMask(e,n){if(n==null)return null;if(!Array.isArray(n))throw new M("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new M("`inputs` should be an array for Concatenate");if(n.length!==e.length)throw new M(`Mismatch in the length of mask (${n.length}) and the legnth of inputs (${e.length})`);return H(()=>{let r=!0;if(n.forEach(i=>{if(i!=null){r=!1;return}}),r)return null;const s=[];for(let i=0;i<e.length;++i)n[i]==null?s.push(ce(Yr(e[i]),"bool")):n[i].rank<e[i].rank?s.push(zn(n[i],-1)):s.push(n[i]);const o=Un(s,this.axis);return cR(o,-1,!1)})}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}cF.className="Concatenate";ee(cF);function Lu(t,e){for(;t<0;)t+=e;return t}function Tj(t,e,n){if(t.shape.length>3||e.shape.length>3)throw new Te("batchDot is not implemented for tensors of 4D or higher rank yet");if(D(t.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${t.shape.length}`),D(t.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${e.shape.length}`),typeof n=="number"&&(n=[n,n]),t.dtype==="complex64"||e.dtype==="complex64")throw new Te("batchDot is not implemented for complex64-type Tensors yet.");const r=t.shape.length,s=e.shape.length;n==null&&(n=[r-1,s-2]);const o=n;return H(()=>{let i;if(r>s){i=r-s;const l=[];for(let u=0;u<i;++u)l.push(1);e=B(e,e.shape.concat(l))}else if(s>r){i=s-r;const l=[];for(let u=0;u<i;++u)l.push(1);t=B(t,t.shape.concat(l))}else i=0;let a;if(t.shape.length===2&&e.shape.length===2)o[0]===o[1]?a=ge(_(t,e),o[0]):a=ge(_(ze(t,[1,0]),e),o[1]);else{const l=o[0]!==t.shape.length-1,u=o[1]===e.shape.length-1;a=Xe(t,e,l,u)}if(i>0){let l;r>s?l=r+s-3:l=r-1;const u=[];for(let c=l;c<l+i;++c)u.push(c);a=df(a,u)}return a.shape.length===1&&(a=zn(a,1)),a})}class dF extends Fa{constructor(e){super(e),this.axes=e.axes,this.normalize=e.normalize==null?!1:e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){D(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0],r=e[1];if(n.length>3||r.length>3)throw new Te("Dot layer does not support tensors of 4D or higher rank yet.");const s=this.interpretAxes(n,r);if(n[s[0]]!==r[s[1]])throw new M(`Dimension incompatibility: ${n[s[0]]} !== ${r[s[1]]}`)}mergeFunction(e){if(e.length!==2)throw new M(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let n=e[0],r=e[1],s;return Array.isArray(this.axes)?s=this.axes.map((o,i)=>Lu(o,e[i].shape.length)):s=[Lu(this.axes,n.shape.length),Lu(this.axes,r.shape.length)],this.normalize&&(n=_p(n,s[0]),r=_p(r,s[1])),Tj(n,r,s)}interpretAxes(e,n){let r;return Array.isArray(this.axes)?r=this.axes:r=[Lu(this.axes,e.length),Lu(this.axes,n.length)],r}computeOutputShape(e){D(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0].slice(),r=e[1].slice();if(n.length>3||r.length>3)throw new Te("Dot layer does not support tensors of 4D or higher rank yet.");const s=this.interpretAxes(n,r);n.splice(s[0],1),r.splice(s[1],1),r.splice(0,1);const o=n.concat(r);return o.length===1&&o.push(1),o}computeMask(e,n){return null}getConfig(){const e={axes:this.axes,normalize:this.normalize},n=super.getConfig();return Object.assign(e,n),e}}dF.className="Dot";ee(dF);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class fF extends Ae{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={stddev:this.stddev};return Object.assign(n,e),n}call(e,n){return H(()=>{this.invokeCallHook(e,n);const r=we(e);return xf(()=>ne(Jg(r.shape,0,this.stddev),r),()=>r,n.training||!1)})}}fF.className="GaussianNoise";ee(fF);class hF extends Ae{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return H(()=>{this.invokeCallHook(e,n);const r=we(e);return this.rate>0&&this.rate<1?xf(()=>{const o=Math.sqrt(this.rate/(1-this.rate));return _(r,Jg(r.shape,1,o))},()=>r,n.training||!1):r})}}hF.className="GaussianDropout";ee(hF);class pF extends Ae{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||we(e).shape}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return H(()=>{if(this.rate<1&&this.rate>0){const r=this._getNoiseShape(e);return xf(()=>{const o=we(e),l=-1.6732632423543772*1.0507009873554805;let u=Ea(cf(r),this.rate);u=Vs(u,"float32");const c=((1-this.rate)*(1+this.rate*l**2))**-.5,d=-c*l*this.rate,f=ne(_(o,u),_(ne(u,-1),l));return ne(_(f,c),d)},()=>we(e),n.training||!1)}return e})}}pF.className="AlphaDropout";ee(pF);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Yc(t,e,n,r,s,o=.001){let i;if(t.rank===2)i=aW(t,e,n,r,s,o);else if(t.rank===3)i=uW(t,e,n,r,s,o);else if(t.rank===4)i=dW(t,e,n,r,s,o);else throw new Te(`batchNormalization is not implemented for array of rank ${t.rank} yet`);return i}function Ej(t,e,n,r,s=.001){return H(()=>{const o=nw(t,r),i=o.mean,a=o.variance;return[Yc(t,i,a,n,e,s),i,a]})}function Nj(t,e,n,r,s=.001){return H(()=>{const o=nw(t,r),i=o.mean,a=o.variance,l=[];for(const p of bs(0,t.rank))r.indexOf(p)!==-1?l.push(1):l.push(t.shape[p]);const u=B(i,l),c=B(a,l),d=e==null?null:B(e,l),f=n==null?null:B(n,l);return[Yc(t,u,c,f,d,s),i,a]})}function Rj(t,e,n,r,s=.001){return Ye(r.slice().sort(),bs(0,t.rank-1))?Ej(t,e,n,r,s):Nj(t,e,n,r,s)}class mF extends Ae{constructor(e){e==null&&(e={}),super(e),this.supportsMasking=!0,this.axis=e.axis==null?-1:e.axis,this.momentum=e.momentum==null?.99:e.momentum,this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=vt(e.betaInitializer||"zeros"),this.gammaInitializer=vt(e.gammaInitializer||"ones"),this.movingMeanInitializer=vt(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=vt(e.movingVarianceInitializer||"ones"),this.betaConstraint=qt(e.betaConstraint),this.gammaConstraint=qt(e.gammaConstraint),this.betaRegularizer=xt(e.betaRegularizer),this.gammaRegularizer=xt(e.gammaRegularizer)}build(e){e=Ge(e);const n=this.axis>=0?this.axis:this.axis+e.length,r=e[n];if(r==null)throw new M(`Axis ${n} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new Kt({ndim:e.length,axes:{[n]:r}})];const s=[r];this.scale&&(this.gamma=this.addWeight("gamma",s,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",s,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",s,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",s,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,n){return H(()=>{const r=n.training==null?!1:n.training,s=we(e),o=s.shape,i=o.length,a=bs(0,i),l=this.axis>=0?this.axis:this.axis+i;a.splice(l,1);const u=da(1,i);u[l]=o[l];const c=a.slice();c.sort();const d=!Ye(c,bs(0,i).slice(0,i-1)),f=()=>{if(d){const b=B(this.movingMean.read(),u),x=B(this.movingVariance.read(),u),y=this.center?B(this.beta.read(),u):null,$=this.scale?B(this.gamma.read(),u):null;return Yc(s,b,x,y,$,this.epsilon)}else return Yc(s,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!r)return f();const[h,p,g]=Rj(s,this.gamma.read(),this.beta.read(),a,this.epsilon),v=(b,x,y)=>{H(()=>{const $=1-y,C=b.read(),k=_(ye(C,x),$);b.write(ye(C,k))})};return(()=>{v(this.movingMean,p,this.momentum),v(this.movingVariance,g,this.momentum)})(),h})}getConfig(){const e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:St(this.betaInitializer),gammaInitializer:St(this.gammaInitializer),movingMeanInitializer:St(this.movingMeanInitializer),movingVarianceInitializer:St(this.movingVarianceInitializer),betaRegularizer:ot(this.betaRegularizer),gammaRegularizer:ot(this.gammaRegularizer),betaConstraint:Xt(this.betaConstraint),gammaConstraint:Xt(this.gammaConstraint)},n=super.getConfig();return Object.assign(e,n),e}}mF.className="BatchNormalization";ee(mF);class gF extends Ae{constructor(e){if(e==null&&(e={}),super(e),this.axis=e.axis==null?-1:e.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(const n of this.axis)if(!Number.isInteger(n))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=vt(e.betaInitializer||"zeros"),this.gammaInitializer=vt(e.gammaInitializer||"ones"),this.betaRegularizer=xt(e.betaRegularizer),this.gammaRegularizer=xt(e.gammaRegularizer),this.supportsMasking=!0}build(e){e=Ge(e);const n=e.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let o=0;o<this.axis.length;++o)this.axis[o]<0&&(this.axis[o]+=n);for(const o of this.axis)if(o<0||o>=n)throw new Error(`Invalid axis: ${o}`);if(this.axis.length!==Qo(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const r=this.axis.map(o=>e[o]),s=!0;this.scale?this.gamma=this.addWeight("gamma",r,"float32",this.gammaInitializer,this.gammaRegularizer,s):this.gamma=null,this.center?this.beta=this.addWeight("beta",r,"float32",this.betaInitializer,this.betaRegularizer,s):this.beta=null,this.built=!0}call(e,n){const r=we(e),s=r.shape,o=s.length;return H(()=>{let{mean:a,variance:l}=nw(r,this.axis,!0);const u=da(1,o);for(const g of this.axis)u[g]=s[g];const c=g=>g!=null&&g.shape.length!==o?B(g,u):g;let d=this.scale?c(this.gamma.read()):null,f=this.center?c(this.beta.read()):null;const h=[],p=[];for(let g=0;g<o;++g)this.axis.indexOf(g)!==-1?(h.push(s[g]),p.push(1)):(h.push(1),p.push(s[g]));return a=ds(a,h),l=ds(l,h),d!=null&&(d=ds(d,p)),f!=null&&(f=ds(f,p)),Yc(r,a,l,f,d,this.epsilon)})}getConfig(){const e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:St(this.betaInitializer),gammaInitializer:St(this.gammaInitializer),betaRegularizer:ot(this.betaRegularizer),gammaRegularizer:ot(this.gammaRegularizer)},n=super.getConfig();return Object.assign(e,n),e}}gF.className="LayerNormalization";ee(gF);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Dj(t,e,n){return H(()=>{if(t.rank!==4)throw new M(`temporalPadding expects input tensor to be 4-D, but received a ${t.rank}-D tensor.`);if(e==null&&(e=[[1,1],[1,1]]),e.length!==2||e[0].length!==2||e[1].length!==2)throw new M("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(n==null&&(n=xs()),n!=="channelsLast"&&n!=="channelsFirst")throw new M(`Unknown data format: ${n}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let r;return n==="channelsFirst"?r=[[0,0],[0,0],e[0],e[1]]:r=[[0,0],e[0],e[1],[0,0]],rw(t,r)})}class vF extends Ae{constructor(e){if(e==null&&(e={}),super(e),this.dataFormat=e.dataFormat==null?xs():e.dataFormat,e.padding==null)this.padding=[[1,1],[1,1]];else if(typeof e.padding=="number")this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new M(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let n,r;if(typeof e.padding[0]=="number")n=[e.padding[0],e.padding[0]],r=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new M(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(n=e.padding[0],e.padding[1].length!==2)throw new M(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);r=e.padding[1]}this.padding=[n,r]}this.inputSpec=[new Kt({ndim:4})]}computeOutputShape(e){e=Ge(e);let n,r;return this.dataFormat==="channelsFirst"?(e[2]!=null&&e[2]>=0?n=e[2]+this.padding[0][0]+this.padding[0][1]:n=null,e[3]!=null&&e[3]>=0?r=e[3]+this.padding[1][0]+this.padding[1][1]:r=null,[e[0],e[1],n,r]):(e[1]!=null&&e[1]>=0?n=e[1]+this.padding[0][0]+this.padding[0][1]:n=null,e[2]!=null&&e[2]>=0?r=e[2]+this.padding[1][0]+this.padding[1][1]:r=null,[e[0],n,r,e[3]])}call(e,n){return H(()=>Dj(we(e),this.padding,this.dataFormat))}getConfig(){const e={padding:this.padding,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}vF.className="ZeroPadding2D";ee(vF);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function a0(t,e,n,r,s,o){return H(()=>{Lt(s),FD(o),$r(r),n==null&&(n=[1,1]),r==null&&(r="valid"),s==null&&(s=xs()),o==null&&(o="max"),t=h$(t,s);let i;const a=r==="same"?"same":"valid";return o==="max"?i=tw(t,e,n,a):i=H1(t,e,n,a),s==="channelsFirst"&&(i=ze(i,[0,3,1,2])),i})}function bF(t,e,n,r,s,o){return H(()=>{Lt(s),FD(o),$r(r),n==null&&(n=[1,1,1]),r==null&&(r="valid"),s==null&&(s=xs()),o==null&&(o="max"),t=OA(t,s);let i;const a=r==="same"?"same":"valid";return o==="max"?i=q6(t,e,n,a):i=QB(t,e,n,a),s==="channelsFirst"&&(i=ze(i,[0,4,1,2,3])),i})}class xF extends Ae{constructor(e){if(e.poolSize==null&&(e.poolSize=2),super(e),typeof e.poolSize=="number")this.poolSize=[e.poolSize];else if(Array.isArray(e.poolSize)&&e.poolSize.length===1&&typeof e.poolSize[0]=="number")this.poolSize=e.poolSize;else throw new M(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.poolSize)}`);if(tn(this.poolSize,"poolSize"),e.strides==null)this.strides=this.poolSize;else if(typeof e.strides=="number")this.strides=[e.strides];else if(Array.isArray(e.strides)&&e.strides.length===1&&typeof e.strides[0]=="number")this.strides=e.strides;else throw new M(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.strides)}`);tn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,$r(this.padding),this.inputSpec=[new Kt({ndim:3})]}computeOutputShape(e){e=Ge(e);const n=gs(e[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],n,e[2]]}call(e,n){return H(()=>{this.invokeCallHook(e,n),e=vf(we(e),2);const r=this.poolingFunction(we(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return df(r,[2])})}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},n=super.getConfig();return Object.assign(e,n),e}}class yF extends xF{constructor(e){super(e)}poolingFunction(e,n,r,s,o){return Lt(o),$r(s),a0(e,n,r,s,o,"max")}}yF.className="MaxPooling1D";ee(yF);class wF extends xF{constructor(e){super(e)}poolingFunction(e,n,r,s,o){return Lt(o),$r(s),a0(e,n,r,s,o,"avg")}}wF.className="AveragePooling1D";ee(wF);class $F extends Ae{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==2)throw new M(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides];tn(this.poolSize,"poolSize"),tn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Lt(this.dataFormat),$r(this.padding),this.inputSpec=[new Kt({ndim:4})]}computeOutputShape(e){e=Ge(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],r=this.dataFormat==="channelsFirst"?e[3]:e[2];return n=gs(n,this.poolSize[0],this.padding,this.strides[0]),r=gs(r,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,r]:[e[0],n,r,e[3]]}call(e,n){return H(()=>(this.invokeCallHook(e,n),this.poolingFunction(we(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class CF extends $F{constructor(e){super(e)}poolingFunction(e,n,r,s,o){return Lt(o),$r(s),a0(e,n,r,s,o,"max")}}CF.className="MaxPooling2D";ee(CF);class kF extends $F{constructor(e){super(e)}poolingFunction(e,n,r,s,o){return Lt(o),$r(s),a0(e,n,r,s,o,"avg")}}kF.className="AveragePooling2D";ee(kF);class SF extends Ae{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==3)throw new M(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];tn(this.poolSize,"poolSize"),tn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Lt(this.dataFormat),$r(this.padding),this.inputSpec=[new Kt({ndim:5})]}computeOutputShape(e){e=Ge(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],r=this.dataFormat==="channelsFirst"?e[3]:e[2],s=this.dataFormat==="channelsFirst"?e[4]:e[3];return n=gs(n,this.poolSize[0],this.padding,this.strides[0]),r=gs(r,this.poolSize[1],this.padding,this.strides[1]),s=gs(s,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,r,s]:[e[0],n,r,s,e[4]]}call(e,n){return H(()=>(this.invokeCallHook(e,n),this.poolingFunction(we(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class IF extends SF{constructor(e){super(e)}poolingFunction(e,n,r,s,o){return Lt(o),$r(s),bF(e,n,r,s,o,"max")}}IF.className="MaxPooling3D";ee(IF);class TF extends SF{constructor(e){super(e)}poolingFunction(e,n,r,s,o){return Lt(o),$r(s),bF(e,n,r,s,o,"avg")}}TF.className="AveragePooling3D";ee(TF);class EF extends Ae{constructor(e){super(e),this.inputSpec=[new Kt({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,n){throw new Te}}class NF extends EF{constructor(e){super(e||{})}call(e,n){return H(()=>{const r=we(e);return zt(r,1)})}}NF.className="GlobalAveragePooling1D";ee(NF);class RF extends EF{constructor(e){super(e||{})}call(e,n){return H(()=>{const r=we(e);return ms(r,1)})}}RF.className="GlobalMaxPooling1D";ee(RF);class DF extends Ae{constructor(e){super(e),this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Lt(this.dataFormat),this.inputSpec=[new Kt({ndim:4})]}computeOutputShape(e){return e=e,this.dataFormat==="channelsLast"?[e[0],e[3]]:[e[0],e[1]]}call(e,n){throw new Te}getConfig(){const e={dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class AF extends DF{call(e,n){return H(()=>{const r=we(e);return this.dataFormat==="channelsLast"?zt(r,[1,2]):zt(r,[2,3])})}}AF.className="GlobalAveragePooling2D";ee(AF);class FF extends DF{call(e,n){return H(()=>{const r=we(e);return this.dataFormat==="channelsLast"?ms(r,[1,2]):ms(r,[2,3])})}}FF.className="GlobalMaxPooling2D";ee(FF);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class PF extends Ae{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(e){this.layer!=null&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){const e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},n=super.getConfig();return Object.assign(e,n),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,n,r={}){const s=n.layer,o=co(s,r);delete n.layer;const i={layer:o};return Object.assign(i,n),new e(i)}}class OF extends PF{constructor(e){super(e),this.supportsMasking=!0}build(e){if(e=Ge(e),e.length<3)throw new M(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];const n=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(n),this.layer.built=!0),super.build(e)}computeOutputShape(e){e=Ge(e);const n=[e[0]].concat(e.slice(2)),r=this.layer.computeOutputShape(n),s=e[1];return[r[0],s].concat(r.slice(1))}call(e,n){return H(()=>(e=we(e),GA((i,a)=>[we(this.layer.call(i,n)),[]],e,[],!1,null,null,!1,!0)[1]))}}OF.className="TimeDistributed";ee(OF);function Aj(t){Aa(JH,"BidirectionalMergeMode",t)}const Fj="concat";class LF extends PF{constructor(e){super(e);const n=e.layer.getConfig(),r={};r.className=e.layer.getClassName(),r.config=n,this.forwardLayer=co(r),n.goBackwards=n.goBackwards!==!0;const s={};if(s.className=e.layer.getClassName(),s.config=n,this.backwardLayer=co(s),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=e.mergeMode===void 0?Fj:e.mergeMode,Aj(this.mergeMode),e.weights)throw new Te("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){const n=e.length,r=Math.floor(n/2);this.forwardLayer.setWeights(e.slice(0,r)),this.backwardLayer.setWeights(e.slice(r))}computeOutputShape(e){let n=this.forwardLayer.computeOutputShape(e);Array.isArray(n)&&Array.isArray(n[0])||(n=[n]),n=n;let r,s,o;return this.returnState&&(o=n.slice(1)),r=n[0],r=r,this.mergeMode==="concat"?(r[r.length-1]*=2,s=[r]):this.mergeMode==null?s=[r,r.slice()]:s=[r],this.returnState?this.mergeMode==null?s.concat(o).concat(o.slice()):[r].concat(o).concat(o.slice()):Vn(s)}apply(e,n){let r=n==null?null:n.initialState,s=n==null?null:n.constants;n==null&&(n={});const o=UA(e,r,s,this.numConstants);if(e=o.inputs,r=o.initialState,s=o.constants,Array.isArray(e)&&(r=e.slice(1),e=e[0]),(r==null||r.length===0)&&s==null)return super.apply(e,n);const i=[],a=[];if(r!=null){const u=r.length;if(u%2>0)throw new M("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");n.initialState=r,i.push(...r);const c=r.map(d=>new Kt({shape:d.shape}));this.forwardLayer.stateSpec=c.slice(0,u/2),this.backwardLayer.stateSpec=c.slice(u/2),a.push(...c)}if(s!=null)throw new Te("Support for constants in Bidirectional layers is not implemented yet.");const l=i[0]instanceof js;for(const u of i)if(u instanceof js!==l)throw new M("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(l){const u=[e].concat(i),c=this.inputSpec.concat(a),d=this.inputSpec;this.inputSpec=c;const f=super.apply(u,n);return this.inputSpec=d,f}else return super.apply(e,n)}call(e,n){return H(()=>{const r=n.initialState;let s,o;if(r==null)s=this.forwardLayer.call(e,n),o=this.backwardLayer.call(e,n);else{const l=r.slice(0,r.length/2),u=r.slice(r.length/2);s=this.forwardLayer.call(e,Object.assign(n,{initialState:l})),o=this.backwardLayer.call(e,Object.assign(n,{initialState:u}))}let i;this.returnState&&(Array.isArray(s)&&(i=s.slice(1).concat(o.slice(1))),s=s[0],o=o[0]),this.returnSequences&&(o=ua(o,1));let a;return this.mergeMode==="concat"?a=e$([s,o]):this.mergeMode==="sum"?a=ne(s,o):this.mergeMode==="ave"?a=_(.5,ne(s,o)):this.mergeMode==="mul"?a=_(s,o):this.mergeMode==null&&(a=[s,o]),this.returnState?this.mergeMode==null?a.concat(i):[a].concat(i):a})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){ji(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),ji(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,n){Array.isArray(n)&&(n=n[0]);let r;if(this.returnSequences?this.mergeMode==null?r=[n,n]:r=n:this.mergeMode==null?r=[null,null]:r=null,this.returnState){const o=this.forwardLayer.states.map(i=>null);return Array.isArray(r)?r.concat(o).concat(o):[r].concat(o).concat(o)}else return r}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){const e={mergeMode:this.mergeMode},n=super.getConfig();return Object.assign(e,n),e}static fromConfig(e,n){const r=co(n.layer);if(delete n.layer,n.numConstants!=null)throw new Te("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const s=n;return s.layer=r,new e(s)}}LF.className="Bidirectional";ee(LF);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class MF extends Ae{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){const e={scale:this.scale,offset:this.offset},n=super.getConfig();return Object.assign(e,n),e}call(e,n){return H(()=>(e=we(e),e.dtype!=="float32"&&(e=Vs(e,"float32")),ne(_(e,this.scale),this.offset)))}}MF.className="Rescaling";ee(MF);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const{resizeBilinear:Pj,cropAndResize:Oj}=io;class _F extends Ae{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,n,r,s,o,i,a,l){return H(()=>{let u,c=!1;const d=n/i,f=r/a,h=(s+n)/i,p=(o+r)/a,g=[d,f,h,p],v=[];e.rank===3?(c=!0,u=vo([e])):u=e;for(let $=0;$<u.shape[0];$++)v.push(g);const m=Er(v,[v.length,4]),b=jc(0,v.length,1,"int32"),y=Oj(u,m,b,[s,o],"nearest");return Vs(c?we(ca(y)):y,l)})}upsize(e,n,r,s){return H(()=>{const o=Pj(e,[n,r]);return Vs(o,s)})}call(e,n){return H(()=>{const r=we(e),s=r.dtype,o=r.shape,i=o[o.length-3],a=o[o.length-2];let l=0;i!==this.height&&(l=Math.floor((i-this.height)/2));let u=0;return a!==this.width&&(u=Math.floor((a-this.width)/2),u===0&&(u=1)),l>=0&&u>=0?this.centerCrop(r,l,u,this.height,this.width,i,a,s):this.upsize(e,this.height,this.width,s)})}getConfig(){const e={height:this.height,width:this.width},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){e=Ge(e);const n=e.length-3,r=e.length-2;return e[n]=this.height,e[r]=this.width,e}}_F.className="CenterCrop";ee(_F);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Lj(t,e,n,r){let s=we(t);if(s.dtype!=="int32"&&(s=Vs(s,"int32")),e==="int")return s;const o=s.shape;if(s.rank===0&&(s=zn(s,-1)),e==="oneHot"&&s.shape[s.shape.length-1]!==1&&(s=zn(s,-1)),s.rank>2)throw new M(`When outputMode is not int, maximum output rank is 2 Received outputMode ${e} and input shape ${o} which would result in output rank ${s.rank}.`);const i=["multiHot","oneHot"].includes(e),a=s;let l;if(typeof r<"u"&&e==="count"?l=rS(a,r,n,i):l=rS(a,[],n,i),e!=="tfIdf")return l;if(r)return _(l,r);throw new M("When outputMode is 'tfIdf', weights must be provided.")}/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class zF extends Ae{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){const e={numTokens:this.numTokens,outputMode:this.outputMode},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){return e=Ge(e),e==null?[this.numTokens]:this.outputMode==="oneHot"&&e[e.length-1]!==1?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,n){return H(()=>{e=we(e),e.dtype!=="int32"&&(e=Vs(e,"int32"));let r;if(typeof n.countWeights<"u"){if(this.outputMode!=="count")throw new M(`countWeights is not used when outputMode !== count.
              Received countWeights=${n.countWeights}`);r=we(n.countWeights)}const s=ms(e),o=Np(e),i=wr(this.numTokens,s).bufferSync().get(0),a=Ea(o,0).bufferSync().get(0);if(!(i&&a))throw new M(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return Lj(e,this.outputMode,this.numTokens,r)})}}zF.className="CategoryEncoding";ee(zF);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Mj=["bilinear","nearest"],LS=new Set(Mj);class VF extends Ae{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation)if(LS.has(e.interpolation))this.interpolation=e.interpolation;else throw new M(`Invalid interpolation parameter: ${e.interpolation} is not implemented`);else this.interpolation="bilinear";this.cropToAspectRatio=!!e.cropToAspectRatio}computeOutputShape(e){e=Ge(e);const n=e[2];return[this.height,this.width,n]}getConfig(){const e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},n=super.getConfig();return Object.assign(e,n),e}call(e,n){return H(()=>{const r=[this.height,this.width];if(this.interpolation==="bilinear")return io.resizeBilinear(e,r,!this.cropToAspectRatio);if(this.interpolation==="nearest")return io.resizeNearestNeighbor(e,r,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...LS]} are supported`)})}}VF.className="Resizing";ee(VF);/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class BF{constructor(e){this.seed=e}next(){if(this.seed!==void 0)return this.seed++}}BF.className="RandomSeed";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class WF extends Ae{constructor(e){super(e),this.randomGenerator=new BF(e.seed)}getConfig(){const e={seed:this.randomGenerator.seed},n=super.getConfig();return Object.assign(e,n),e}}WF.className="BaseRandomLayer";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const _j=["bilinear","nearest"],MS=new Set(_j);class UF extends WF{constructor(e){super(e);const{factor:n,interpolation:r="bilinear"}=e;if(this.factor=n,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new M(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);if(this.widthLower<-1||this.widthUpper<-1)throw new M(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new M(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(r)if(MS.has(r))this.interpolation=r;else throw new M(`Invalid interpolation parameter: ${r} is not implemented`)}getConfig(){const e={factor:this.factor,interpolation:this.interpolation},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){e=Ge(e);const n=e[2];return[this.imgHeight,-1,n]}call(e,n){return H(()=>{const r=we(e);this.imgHeight=r.shape[r.shape.length-3];const s=r.shape[r.shape.length-2];this.widthFactor=cf([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let o=this.widthFactor.dataSync()[0]*s;o=Math.round(o);const i=[this.imgHeight,o];switch(this.interpolation){case"bilinear":return io.resizeBilinear(e,i);case"nearest":return io.resizeNearestNeighbor(e,i);default:throw new Error(`Interpolation is ${this.interpolation}
          but only ${[...MS]} are supported`)}})}}UF.className="RandomWidth";ee(UF);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zj=j();zj.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,t=>{t&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var _S;(function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_QINT16=15]="DT_QINT16",t[t.DT_QUINT16=16]="DT_QUINT16",t[t.DT_UINT16=17]="DT_UINT16",t[t.DT_COMPLEX128=18]="DT_COMPLEX128",t[t.DT_HALF=19]="DT_HALF",t[t.DT_RESOURCE=20]="DT_RESOURCE",t[t.DT_VARIANT=21]="DT_VARIANT",t[t.DT_UINT32=22]="DT_UINT32",t[t.DT_UINT64=23]="DT_UINT64",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",t[t.DT_QINT16_REF=115]="DT_QINT16_REF",t[t.DT_QUINT16_REF=116]="DT_QUINT16_REF",t[t.DT_UINT16_REF=117]="DT_UINT16_REF",t[t.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",t[t.DT_HALF_REF=119]="DT_HALF_REF",t[t.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",t[t.DT_VARIANT_REF=121]="DT_VARIANT_REF",t[t.DT_UINT32_REF=122]="DT_UINT32_REF",t[t.DT_UINT64_REF=123]="DT_UINT64_REF"})(_S||(_S={}));var zS;(function(t){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))})(zS||(zS={}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var VS;(function(t){t[t.FAIL=0]="FAIL",t[t.SHORTEST=1]="SHORTEST",t[t.LONGEST=2]="LONGEST"})(VS||(VS={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fe(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&D(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vj=zR;class l0 extends Xy{nextDataId(){return l0.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new oN(this,Es())}write(e,n,r){this.firstUse&&(this.firstUse=!1,j().get("IS_NODE")&&fr(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const s={id:this.nextDataId()};return this.data.set(s,{values:e,dtype:r,refCount:1}),s}makeTensorInfo(e,n,r){let s;if(n==="string"&&r!=null&&r.length>0&&dd(r[0])){const o=r.map(i=>Yo(i));s=this.write(o,e,n)}else s=this.write(r,e,n);return{dataId:s,shape:e,dtype:n}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){const n=this.data.get(e);n.refCount++}decRef(e){if(this.data.has(e)){const n=this.data.get(e);n.refCount--}}move(e,n,r,s,o){this.data.set(e,{values:n,dtype:s,refCount:o})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){const{dtype:n,complexTensorInfos:r}=this.data.get(e);if(n==="complex64"){const s=this.readSync(r.real.dataId),o=this.readSync(r.imag.dataId);return bo(s,o)}return dV(this.data.get(e).values,n)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const r=n.map(s=>ri(s));return Re(e.shape,e.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Re(e.shape,e.dtype,n)}makeOutput(e,n,r){return Es().makeTensorFromTensorInfo(this.makeTensorInfo(n,r,e),this)}disposeData(e,n=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!n&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:r}=this.data.get(e);r!=null&&(this.disposeData(r.real.dataId,!0),this.disposeData(r.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){const n=_n();return e(),{kernelMs:_n()-n}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){fe([e],"where");const n=this.readSync(e.dataId);return Vj(e.shape,n)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}l0.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GF(t){const e=new Float32Array(t.length);for(let n=0;n<t.length;++n)e[n]=Math.abs(t[n]);return e}const Bj=t=>{const{x:e}=t.inputs,n=t.backend;fe(e,"abs");let r=new Float32Array(q(e.shape));const s=n.data.get(e.dataId).values;return r=GF(s),n.makeOutput(r,e.shape,e.dtype)},Wj={kernelName:zm,backendName:"cpu",kernelFunc:Bj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mt(t){return(e,n,r,s,o)=>{const i=Se(e,n),a=i.length,l=me(i),u=q(i),c=bn(o,u),d=e.length,f=n.length,h=me(e),p=me(n),g=Ul(e,i),v=Ul(n,i);if(g.length+v.length===0)for(let m=0;m<c.length;++m)c[m]=t(r[m%r.length],s[m%s.length]);else for(let m=0;m<c.length;++m){const b=ru(m,a,l),x=b.slice(-d);g.forEach(k=>x[k]=0);const y=Ms(x,d,h),$=b.slice(-f);v.forEach(k=>$[k]=0);const C=Ms($,f,p);c[m]=t(r[y],s[C])}return[c,i]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qn(t){const{inputs:e,backend:n}=t,{real:r,imag:s}=e,o=n.data.get(r.dataId).values,i=n.data.get(s.dataId).values,a=n.makeTensorInfo(r.shape,"complex64"),l=n.data.get(a.dataId);return l.complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",o),imag:n.makeTensorInfo(s.shape,"float32",i)},a}const Uj={kernelName:a1,backendName:"cpu",kernelFunc:Qn};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Up(t,e,n="float32"){if(n==="complex64"){const s=Up(t,e,"float32"),o=Up(t,e,"float32");return Qn({inputs:{real:s,imag:o},backend:t})}const r=xn(q(e),n);return t.makeTensorInfo(e,n,r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ks(t){const{inputs:e,backend:n}=t,{x:r}=e;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const Gj={kernelName:Ad,backendName:"cpu",kernelFunc:Ks};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fa(t){const{inputs:e,backend:n}=t,{input:r}=e,s=n.data.get(r.dataId).complexTensorInfos.real,o=n.data.get(s.dataId).values;return n.makeTensorInfo(s.shape,s.dtype,o)}const Hj={kernelName:D1,backendName:"cpu",kernelFunc:fa};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HF(t,e,n,r){if(r==="int32"){const s=Int32Array.from(t);return[e,"int32",s]}if(r==="bool"){const s=Ta([0],n),[o,i]=Mt((a,l)=>a!==l?1:0)(e,[],t,s,"bool");return[i,"bool",o]}throw new Error(`Error in Cast: failed to cast ${n} to ${r}`)}function li(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{dtype:o}=r;if(o==="complex64"){if(s.dtype==="complex64")return Ks({inputs:{x:s},backend:n});const c=Up(n,s.shape,s.dtype),d=li({inputs:{x:s},backend:n,attrs:{dtype:"float32"}}),f=Qn({inputs:{real:d,imag:c},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),f}if(s.dtype==="complex64"){const c=fa({inputs:{input:s},backend:n}),d=li({inputs:{x:c},backend:n,attrs:{dtype:o}});return n.disposeIntermediateTensorInfo(c),d}if(!lN(s.dtype,o)){const c=Ks({inputs:{x:s},backend:n});return{dataId:c.dataId,shape:c.shape,dtype:o}}const i=n.data.get(s.dataId).values,[a,l,u]=HF(i,s.shape,s.dtype,o);return n.makeTensorInfo(a,l,u)}const jj={kernelName:xd,backendName:"cpu",kernelFunc:li};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qt(t,e,n,r){return n==null?({inputs:s,backend:o})=>{const{a:i,b:a}=s,l=o;fe([i,a],t);const u=l.data.get(i.dataId).values,c=l.data.get(a.dataId).values,d=i.dtype==="string"?xo(u):u,f=i.dtype==="string"?xo(c):c,h=r||i.dtype,[p,g]=e(i.shape,a.shape,d,f,h);return l.makeTensorInfo(g,h,p)}:({inputs:s,backend:o})=>{const{a:i,b:a}=s,l=o;if(i.dtype==="complex64"||a.dtype==="complex64"){const u=li({inputs:{x:i},backend:l,attrs:{dtype:"complex64"}}),c=l.data.get(u.dataId),d=c.complexTensorInfos.real,f=c.complexTensorInfos.imag,h=l.data.get(d.dataId).values,p=l.data.get(f.dataId).values,g=li({inputs:{x:a},backend:l,attrs:{dtype:"complex64"}}),v=l.data.get(g.dataId),m=v.complexTensorInfos.real,b=v.complexTensorInfos.imag,x=l.data.get(m.dataId).values,y=l.data.get(b.dataId).values,[$,C,k]=n(i.shape,a.shape,h,p,x,y),w=l.makeTensorInfo(k,"float32",$),I=l.makeTensorInfo(k,"float32",C),N=Qn({inputs:{real:w,imag:I},backend:l});return l.disposeIntermediateTensorInfo(u),l.disposeIntermediateTensorInfo(g),l.disposeIntermediateTensorInfo(w),l.disposeIntermediateTensorInfo(I),N}else{const u=l.data.get(i.dataId).values,c=l.data.get(a.dataId).values,d=r||i.dtype,[f,h]=e(i.shape,a.shape,u,c,d);return l.makeTensorInfo(h,d,f)}}}function x$(t){return(e,n,r,s,o,i)=>{const a=Se(e,n),l=q(a),u=a.length,c=me(a),d=bn("float32",l),f=bn("float32",l),h=Ul(e,a),p=Ul(n,a),g=bo(r,s),v=bo(o,i),m=e.length,b=me(e),x=n.length,y=me(n);if(h.length+p.length===0)for(let $=0;$<d.length;$++){const C=$%g.length,k=$%v.length,w=t(g[C*2],g[C*2+1],v[k*2],v[k*2+1]);d[$]=w.real,f[$]=w.imag}else for(let $=0;$<d.length;$++){const C=ru($,u,c),k=C.slice(-m);h.forEach(R=>k[R]=0);const w=Ms(k,m,b),I=C.slice(-x);p.forEach(R=>I[R]=0);const N=Ms(I,x,y),E=t(g[w*2],g[w*2+1],v[N*2],v[N*2+1]);d[$]=E.real,f[$]=E.imag}return[d,f,a]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jF=Mt((t,e)=>t+e),Kj=x$((t,e,n,r)=>({real:t+n,imag:e+r})),jl=Qt(su,jF,Kj),Xj={kernelName:su,backendName:"cpu",kernelFunc:jl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y$(t,e,n,r,s){const o=q(r),i=xn(s,n);for(let a=0;a<t.length;a++){const l=t[a];if(l<0)throw new Error("Input x must be non-negative!");l>=s||(o>0?i[l]+=e[a]:i[l]+=1)}return i}function KF(t,e,n,r=!1){const s=t.shape[0],o=t.shape[1],i=Re([s,n],e.dtype);for(let a=0;a<s;a++)for(let l=0;l<o;l++){const u=t.get(a,l);if(u<0)throw new Error("Input x must be non-negative!");u>=n||(r?i.set(1,a,u):e.size>0?i.set(i.get(a,u)+e.get(a,l),a,u):i.set(i.get(a,u)+1,a,u))}return i}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XF=Mt((t,e)=>t&e),qj=Qt(i1,XF),Yj={kernelName:i1,backendName:"cpu",kernelFunc:qj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xs(t){return(e,n,r)=>{const s=At(n,e.length);for(let o=0;o<e.length;++o)s[o]=t(e[o],r);return s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nt(t,e,n){const r=Xs(e);return xi(t,r,n)}function xi(t,e,n){return({inputs:r,attrs:s,backend:o})=>{const{x:i}=r;fe(i,t);const a=o,l=a.data.get(i.dataId).values;let u;if(i.dtype==="string"){if(!Array.isArray(l))throw new Error("String tensor's value was not an instance of Array");u=xo(l)}else u=l;const c=n||i.dtype,d=e(u,c,s);return a.makeTensorInfo(i.shape,c,d)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qF=Xs(t=>Math.ceil(t)),Qj=xi(yd,qF),Zj={kernelName:yd,backendName:"cpu",kernelFunc:Qj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YF(t,e,n,r){const s=At(n,q(e));if(r&&n!=="string"){let o=0;t.forEach(i=>{const a=q(i.shape);s.set(i.vals,o),o+=a})}else{let o=0;t.forEach(i=>{const a=n==="string"?xo(i.vals):i.vals;let l=0;for(let u=0;u<i.shape[0];++u){const c=u*e[1]+o;for(let d=0;d<i.shape[1];++d)s[c+d]=a[l++]}o+=i.shape[1]})}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QF=Mt((t,e)=>t===e?1:0),ZF=Qt(eg,QF,null,"bool"),Jj={kernelName:eg,backendName:"cpu",kernelFunc:ZF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JF=Xs(t=>Math.exp(t)),eP=xi(Td,JF,"float32"),eK={kernelName:Td,backendName:"cpu",kernelFunc:eP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tP=Xs(t=>Math.expm1(t)),tK=xi(Ed,tP),nK={kernelName:Ed,backendName:"cpu",kernelFunc:tK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nP=Xs(t=>Math.floor(t)),rK=xi(Nd,nP),sK={kernelName:Nd,backendName:"cpu",kernelFunc:rK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rP=Mt((t,e)=>Math.floor(t/e)),oK=Qt(Rd,rP,null,"int32"),iK={kernelName:Rd,backendName:"cpu",kernelFunc:oK};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sP(t,e,n,r,s,o,i,a,l){const u=Re([r,o],n);for(let c=0;c<r;c++){const d=[];let f=0;for(let h=0;h<s;h++){const p=t[c*s+h];f+=p*i[h],d.push(p)}if(f<0||f>=l/o)throw new Error(`Invalid indices: ${d} does not index into ${a}`);for(let h=0;h<o;h++)u.values[c*o+h]=e.get(...e.indexToLoc(f*o+h))}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oP(t,e,n){const r=Re(n,t.dtype);for(let s=0;s<r.size;++s){const i=r.indexToLoc(s).slice(),a=i[0],l=i[2],u=e.locToIndex([a,l]);i[2]=e.values[u];const c=t.locToIndex(i);0<=c&&c<t.values.length&&(r.values[s]=t.values[c])}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iP=Mt((t,e)=>t>e?1:0),aK=Qt(sg,iP,null,"bool"),lK={kernelName:sg,backendName:"cpu",kernelFunc:aK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aP=Mt((t,e)=>t>=e?1:0),uK=Qt(Dd,aP,null,"bool"),cK={kernelName:Dd,backendName:"cpu",kernelFunc:uK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lP=Mt((t,e)=>t<e?1:0),dK=Qt(ig,lP,null,"bool"),fK={kernelName:ig,backendName:"cpu",kernelFunc:dK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uP=Mt((t,e)=>t<=e?1:0),hK=Qt(ag,uP,null,"bool"),pK={kernelName:ag,backendName:"cpu",kernelFunc:hK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cP(t,e,n){const r=(e-t)/(n-1),s=xn(n,"float32");s[0]=t;for(let o=1;o<s.length;o++)s[o]=s[o-1]+r;return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dP=Xs(t=>Math.log(t)),mK=xi(Ld,dP),gK={kernelName:Ld,backendName:"cpu",kernelFunc:mK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fP(t,e,n,r){const s=bn(r,q(n));for(let o=0;o<s.length;++o){const i=o*e;let a=t[i];for(let l=0;l<e;++l){const u=t[i+l];(Number.isNaN(u)||u>a)&&(a=u)}s[o]=a}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hP=Mt((t,e)=>Math.max(t,e)),vK=Qt(_d,hP),bK={kernelName:_d,backendName:"cpu",kernelFunc:vK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pP=Mt((t,e)=>Math.min(t,e)),xK=Qt(zd,pP),yK={kernelName:zd,backendName:"cpu",kernelFunc:xK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w$=Mt((t,e)=>t*e),wK=x$((t,e,n,r)=>({real:t*n-e*r,imag:t*r+e*n})),u0=Qt(Bd,w$,wK),$K={kernelName:Bd,backendName:"cpu",kernelFunc:u0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mP(t,e,n){const r=hi(-1,n);return w$([],e,r,t,n)}function CK(t){const{inputs:e,backend:n}=t,{x:r}=e;fe(r,"neg");const s=n.data.get(r.dataId).values,[o,i]=mP(s,r.shape,r.dtype);return n.makeTensorInfo(i,r.dtype,o)}const kK={kernelName:bg,backendName:"cpu",kernelFunc:CK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gP=Mt((t,e)=>t!==e?1:0),SK=Qt(xg,gP,null,"bool"),IK={kernelName:xg,backendName:"cpu",kernelFunc:SK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $$(t,e,n,r,s){const o=e.length,i=q(e),a=me(e),l=me(s),u=bn(n,q(s));for(let c=0;c<i;++c){const d=ru(c,o,a),f=new Array(d.length);for(let p=0;p<f.length;p++)f[p]=d[r[p]];const h=Ms(f,o,l);u[h]=t[c]}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hn(t){const{inputs:e,attrs:n,backend:r}=t,{x:s}=e,{perm:o}=n;fe(s,"transpose");const i=s.shape.length,a=new Array(i);for(let d=0;d<a.length;d++)a[d]=s.shape[o[d]];const l=r.data.get(s.dataId).values,u=$$(l,s.shape,s.dtype,o,a);return{dataId:r.write(u,a,s.dtype),shape:a,dtype:s.dtype}}const TK={kernelName:Il,backendName:"cpu",kernelFunc:Hn};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vP(t,e,n,r){const[s,o]=sn(t,r),i=sr(e,"int32"),a=xn(q(s),i),l=q(o);for(let u=0;u<a.length;++u){const c=u*l;let d=1;for(let f=0;f<l;++f)d*=n[c+f];a[u]=d}return{outVals:a,outShape:s,outDtype:i}}function EK(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,keepDims:i}=r;fe(s,"prod");const a=s.shape.length,l=De(o,s.shape),u=It(l,a);let c=l,d=s;const f=[];u!=null&&(d=Hn({inputs:{x:s},backend:n,attrs:{perm:u}}),f.push(d),c=Ot(c.length,a));const h=n.data.get(d.dataId).values,{outVals:p,outShape:g,outDtype:v}=vP(d.shape,d.dtype,h,c);let m=g;return i&&(m=Vt(g,l)),f.forEach(b=>n.disposeIntermediateTensorInfo(b)),n.makeTensorInfo(m,v,p)}const NK={kernelName:Sg,backendName:"cpu",kernelFunc:EK};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RK(t,e,n){t.forEach((r,s)=>{if(r<0||r>=n){const o=ru(s,e.length,me(e)).join(",");throw new Error(`indices[${o}] = ${r} is not in [0, ${n})`)}})}function DK(t,e){for(let n=0;n<t.length;++n){const r=t[n],s=n===t.length-1?e:t[n+1].length;if(r.length===0)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>s)throw new Error("Ragged splits must not point past values");for(let o=1;o<r.length;++o)if(r[o-1]>r[o])throw new Error("Ragged splits must be sorted in ascending order")}}function AK(t,e,n,r){const s=[];let o=0;const i=e.length-1+n.length,a=new Array(i).fill(null).map(()=>[0]);DK(n,r);let l=1;for(let u=0;u<e.length-1;++u){l*=e[u];const c=e[u+1];for(let d=1;d<l+1;++d)a[u].push(d*c)}for(let u=0;u<t.length;++u){let c=t[u],d=t[u]+1;for(let f=0;f<n.length;++f){const h=n[f],p=f+e.length-1;if(p>=0){const g=a[p],v=g[g.length-1]-h[c];for(let m=c;m<d;++m)a[p].push(h[m+1]+v)}c=h[c],d=h[d]}d!==c&&(s.push([c,d]),o+=d-c)}return{outSplits:a,valueSlices:s,numValues:o}}function FK(t){const e=[];for(let n=0;n<t.length;++n){const r=t[n].length,s=At("int32",r);e.push(s),t[n].forEach((o,i)=>s[i]=o)}return e}function BS(t,e){const n=t.slice(0,e);for(;n.length<e;)n.push(1);for(let r=e;r<t.length;r++)n[e-1]*=t[r];return n}function PK(t,e,n,r,s,o){const i=BS(e,2)[1],a=BS(o,2)[1];let l=0;for(const u of n)for(let c=u[0];c<u[1];++c){for(let d=0;d<r;++d)s[l*a+d]=t[c*i+d];++l}}function OK(t,e,n,r,s){const o=e.slice();o[0]=s;const i=At(n,q(o)),a=t.length,l=a===0?0:a/e[0];return PK(t,e,r,l,i,o),[i,o]}function bP(t,e,n,r,s,o,i,a){if(t.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const l=e[0][0]-1;if(RK(o,i,l),r.length===0)throw new Error("params.rank must be nonzero");const u=r[0],{outSplits:c,valueSlices:d,numValues:f}=AK(o,i,t,u),h=FK(c),p=OK(n,r,s,d,f);return[h,p[0],p[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WS=2147483647;function xP(t,e,n,r,s,o,i){if(e.length>1)throw new Error("starts must be a scalar or vector");if(s.length>1)throw new Error("limits must be a scalar or vector");if(i.length>1)throw new Error("deltas must be a scalar or vector");const a=e.length===0,l=s.length===0,u=i.length===0,c=[];a||c.push(e[0]),l||c.push(s[0]),u||c.push(i[0]);for(let v=1;v<c.length;++v)if(c[v]!==c[v-1])throw new Error("starts, limits, and deltas must have the same shape");const d=c.length===0?1:c[0],f=At("int32",d+1);f[0]=0;for(let v=0;v<d;++v){const m=a?t[0]:t[v],b=l?r[0]:r[v],x=u?o[0]:o[v];if(x===0)throw new Error("Requires delta != 0");let y;if(x>0&&b<m||x<0&&b>m)y=0;else if(y=Math.ceil(Math.abs((b-m)/x)),y>WS)throw new Error(`Requires ((limit - start) / delta) <= ${WS}`);f[v+1]=f[v]+y}const h=f[d],p=At(n,h);let g=0;for(let v=0;v<d;++v){const m=f[v+1]-f[v];let b=a?t[0]:t[v];const x=u?o[0]:o[v];for(let y=0;y<m;++y)p[g++]=b,b+=x}return[f,p]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Ir=cs;class Gp{constructor(e,n,r,s,o,i,a,l,u,c){this.shape=e,this.shapeShape=n,this.values=r,this.valuesShape=s,this.valuesDType=o,this.defaultValue=i,this.defaultValueShape=a,this.rowPartitionValues=l,this.rowPartitionValuesShapes=u,this.rowPartitionTypes=sD(c),this.raggedRank=oD(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===Ir.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===Ir.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const n=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case Ir.VALUE_ROWIDS:return Gp.getMaxWidthValueRowID(n);case Ir.ROW_SPLITS:return Gp.getMaxWidthRowSplit(n);default:throw new Error(`Cannot handle partition type ${Ir[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const n=e.length;if(n===0||n===1)return 0;let r=0;for(let s=0;s<n-1;++s){const o=e[s+1]-e[s];o>r&&(r=o)}return r}static getMaxWidthValueRowID(e){const n=e.length;if(n===0)return 0;let r=0,s=e[0],o=0;for(let i=1;i<n;++i){const a=e[i];a!==s&&(s=a,o=Math.max(i-r,o),r=i)}return Math.max(n-r,o)}tensorShapeFromTensor(e,n,r=!0){if(n.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return GS(e,r)}calculateOutputSize(e){const n=this.valuesShape,r=this.defaultValueShape;iD(r,n);const s=this.tensorShapeFromTensor(this.shape,this.shapeShape),i=rD(this.raggedRank,s,n);i[0]<0&&(i[0]=e);for(let a=1;a<=this.raggedRank;++a)i[a]<0&&(i[a]=this.getMaxWidth(a));return i}calculateFirstParentOutputIndex(e,n,r){const s=Math.min(e,r),o=[];let i=0;for(let a=0;a<s;++a,i+=n)o.push(i);for(let a=s;a<e;++a)o.push(-1);return D(o.length===e,()=>"Final length of result must be equal to firstDimension."),o}calculateOutputIndexRowSplit(e,n,r,s){const o=e.length,i=[];for(let a=0;a<o-1;++a){const l=e[a+1]-e[a];let u=Math.min(s,l),c=n[a];c===-1&&(u=0);for(let d=0;d<u;++d)i.push(c),c+=r;for(let d=0;d<l-u;++d)i.push(-1)}if(o>0&&i.length!==e[o-1])throw new Error("Invalid row split size.");return i}calculateOutputIndexValueRowID(e,n,r,s){const o=e.length,i=[];if(o===0)return[];let a=0,l=e[0];if(l>=n.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${n.length}`);let u=n[l];i.push(u);for(let c=1;c<o;++c){const d=e[c];if(d===l)u>=0&&(++a,a<s?u+=r:u=-1);else{if(a=0,l=d,d>=n.length)throw new Error(`Got nextValueRowId=${d} which is not less than ${n.length}`);u=n[d]}i.push(u)}if(i.length!==e.length)throw new Error("Invalid row ids.");return i}calculateOutputIndex(e,n,r,s){const o=this.getRowPartitionTensor(e),i=this.getRowPartitionTypeByDimension(e);switch(i){case Ir.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(o,n,r,s);case Ir.ROW_SPLITS:if(o.length-1>n.length)throw new Error(`Row partition size is greater than output size: ${o.length-1} > ${n.length}`);return this.calculateOutputIndexRowSplit(o,n,r,s);default:throw new Error(`Unsupported partition type: ${Ir[i]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const n=this.rowPartitionTypes[0];switch(n){case Ir.FIRST_DIM_SIZE:return e[0];case Ir.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case Ir.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${Ir[n]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const n=this.getFirstDimensionSize(),r=this.calculateOutputSize(n),s=new Array(this.raggedRank+1);s[s.length-1]=1;for(let l=s.length-2;l>=0;--l)s[l]=s[l+1]*r[l+1];const o=GS(r,!1),i=At(this.valuesDType,q(o));if(s[0]*r[0]>0){let l=this.calculateFirstParentOutputIndex(n,s[0],r[0]);for(let u=1;u<=this.raggedRank;++u)l=this.calculateOutputIndex(u-1,l,s[u],r[u]);this.setOutput(this.raggedRank,l,i,o)}return[o,i]}setOutput(e,n,r,s){if(r.length===0)return;const o=this.values,i=r;let a=s.slice();a=a.slice(e+1);const l=q(a),u=n.length;let c=this.defaultValue;if(c.length!==l&&c.length!==1){const p=this.defaultValueShape;H(()=>{const g=B(c,p);c=fc(g,a).dataSync()})}let d=0,f=0,h=0;for(let p=0;p<=u;++p){let g=p<u?n[p]:-1;if(g===h){++h;continue}if(f<h){const v=o.subarray(d*l),m=i.subarray(f*l),b=(h-f)*l;US(m,v,b)}if(p>=u){const v=r.length;g=Math.floor(v/l)}if(g>h)if(this.defaultValue.length===1)i.subarray(h*l,g*l).fill(this.defaultValue[0]),h=g;else for(;g>h;){const v=i.slice(h*l);US(v,c,l),++h}g<0?(d=p+1,f=h):(d=p,f=h,h=f+1)}}}function US(t,e,n){for(let r=0;r<n;r++)t[r]=e[r]}function GS(t,e){const n=[];for(let r of t){if(r<0){if(!e)throw new Error(`Dimension ${r} must be >= 0`);if(r<-1)throw new Error(`Dimension ${r} must be >= -1`);r=-1}n.push(r)}return n}function yP(t,e,n,r,s,o,i,a,l,u){return new Gp(t,e,n,r,s,o,i,a,l,u).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wP(t,e,n,r){const s=t===e,o=t<e&&n<0,i=e<t&&n>1;if(s||o||i)return xn(0,r);const a=Math.abs(Math.ceil((e-t)/n)),l=xn(a,r);e<t&&n===1&&(n=-1),l[0]=t;for(let u=1;u<l.length;u++)l[u]=l[u-1]+n;return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $P=Xs(t=>1/Math.sqrt(t)),LK=xi(Kd,$P),MK={kernelName:Kd,backendName:"cpu",kernelFunc:LK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mi(t,e,n,r,s,o,i,a,l,u){const c=[r/s,s],d=t.values,f=e.values;if(r===0)return Re(n,e.dtype);const h=l instanceof cn?l:Re(c,e.dtype);typeof l=="string"||typeof l=="number"?h.values.fill(l):typeof l=="boolean"&&h.values.fill(+l);for(let p=0;p<o;p++){const g=[];let v=0;for(let m=0;m<i;m++){const b=d[p*i+m];g.push(b),v+=b*a[m]}if(v<0||v>=r/s)throw new Error(`Invalid indices: ${g} does not index into ${n}`);for(let m=0;m<s;m++)u?h.values[v*s+m]+=f[p*s+m]:h.values[v*s+m]=e.rank===0?f[0]:f[p*s+m]}return h}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _K=Xs(t=>1/(1+Math.exp(-t))),CP=nt(Zd,t=>1/(1+Math.exp(-t))),zK={kernelName:Zd,backendName:"cpu",kernelFunc:CP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kP(t,e,n,r,s){const o=Nw(r,e,n),i=q(n),a=me(r);if(o){const d=Rw(e,a);return s==="string"?t.slice(d,d+i):t.subarray(d,d+i)}const l=s==="string"?xo(t):t,u=Re(r,s,l),c=Re(n,s);for(let d=0;d<c.size;++d){const f=c.indexToLoc(d),h=f.map((p,g)=>p+e[g]);c.set(u.get(...h),...f)}return s==="string"?ID(c.values):c.values}function ha(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{begin:o,size:i}=r;fe(s,"slice");const[a,l]=Xg(s,o,i);Tw(s,a,l);const u=n.data.get(s.dataId).values,c=kP(u,a,l,s.shape,s.dtype);return n.makeTensorInfo(l,s.dtype,c)}const VK={kernelName:Dg,backendName:"cpu",kernelFunc:ha};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SP(t,e,n,r,s,o,i){const a=e[0],l=o[0],u=new Array(l),c=new Array(a),d=e[1];if(l===0){if(a!==0)throw new Error(hD(a));const v=At(n,0),m=At(s,0);return[v,[0,d],m,u,c]}let f=!0,h=0;const p=new Array(l).fill(0);for(let v=0;v<a;++v){const m=t[v*d];if(m<0)throw new Error(pD(v,m));if(m>=l)throw new Error(mD(v,m,l));++p[m],f=f&&m>=h,h=m}let g=!0;for(let v=0;v<l;++v){const m=p[v]===0;u[v]=m,g=g&&!m,p[v]=Math.max(p[v],1),v>0&&(p[v]+=p[v-1])}if(g&&f){const v=t,m=r;for(let b=0;b<a;++b)c[b]=b;return[v,[a,d],m,u,c]}else{const v=p[l-1],m=At(n,v*d),b=At(s,v),x=new Array(l).fill(0);for(let y=0;y<a;++y){const $=t[y*d],C=x[$],k=($===0?0:p[$-1])+C;x[$]++;for(let w=0;w<d;++w)m[k*d+w]=t[y*d+w];b[k]=r[y],c[y]=k}for(let y=0;y<l;++y)if(x[y]===0){const C=y===0?0:p[y-1];m[C*d+0]=y;for(let k=1;k<d;++k)m[C*d+k]=0;b[C]=i}return[m,[v,d],b,u,c]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IP(t,e,n,r,s){const o=q(r),i=e[0],a=s.length,l=[];let u=1,c=-1;for(let v=0;v<a;++v){const m=s[v];if(m===-1){if(c!==-1)throw new Error(gD(c,v));c=v,l.push(1)}else{if(m<0)throw new Error(vD(v,m));u*=m,l.push(m)}}if(c!==-1){if(u<=0)throw new Error(bD());const v=Math.trunc(o/u);if(u*v!==o)throw new Error(xD(r,l));l[c]=v}if(q(l)!==o)throw new Error(yD(r,l));const f=r.length,h=[];if(f>0){h[f-1]=1;for(let v=f-2;v>=0;--v)h[v]=h[v+1]*r[v+1]}const p=[];if(a>0){p[a-1]=1;for(let v=a-2;v>=0;--v)p[v]=p[v+1]*l[v+1]}const g=At(n,i*a);for(let v=0;v<i;++v){let m=0;for(let b=0;b<f;++b)m+=t[v*f+b]*h[b];for(let b=0;b<a;++b)g[v*a+b]=Math.trunc(m/p[b]),m%=p[b]}return[g,[i,a],l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C$(t,e,n,r,s,o=!1,i=0){const a=r.length,l=[e[0],t.length/e[0]],u=l[1],d=a>0?s[a-1]+1:0;if(d<0)throw new Error(Jb());const f=e.slice();f[0]=d;const h=f.reduce((x,y)=>x*y,1),p=At(n,h);if(a===0)return d>0&&p.fill(i),[p,f];if(d<=0)throw new Error(Jb());let g=0,v=1,m=0,b=s[g];for(;;){let x=0;if(v<a){if(x=s[v],b===x){++v;continue}if(b>=x)throw new Error(wD())}if(b<0||b>=d)throw new Error($D(b,d));b>m&&p.fill(i,m*u,b*u);for(let y=g;y<v;++y){const $=r[y];if($<0||$>=l[0])throw new Error(CD(y,r[y],l[0]));for(let C=0;C<u;C++)p[b*u+C]+=t[$*u+C]}if(o)for(let y=0;y<u;y++)p[b*u+y]/=v-g;if(g=v,++v,m=b+1,b=x,v>a)break}return m<d&&p.fill(i,m*u,d*u),[p,f]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BK=Xs(t=>Math.sqrt(t)),WK=nt(ef,t=>Math.sqrt(t)),UK={kernelName:ef,backendName:"cpu",kernelFunc:WK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TP=Mt((t,e)=>{const n=t-e;return n*n}),GK=Qt(tf,TP),HK={kernelName:tf,backendName:"cpu",kernelFunc:GK};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EP=Xs((t,e)=>{const{pattern:n,replaceGlobal:r,rewrite:s}=e;return t.replace(new RegExp(n,r?"g":""),s)}),jK=xi(O1,EP),KK={kernelName:O1,backendName:"cpu",kernelFunc:jK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NP(t,e,n,r){const s=Re(t,e.dtype);for(let o=0;o<s.size;o++){const i=s.indexToLoc(o),a=new Array(i.length);for(let l=0;l<a.length;l++)a[l]=i[l]*n[l]+r[l];s.set(e.get(...a),...i)}return s}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class XK{constructor(e,n,r,s,o,i){this.separator=Yo(e),this.nGramWidths=n,this.leftPad=Yo(r),this.rightPad=Yo(s),this.padWidth=o,this.preserveShort=i}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,n){const r=this.getPadWidth(n);return Math.max(0,e+2*r-n+1)}createNGrams(e,n,r,s,o,i){for(let a=0;a<o;++a){const l=this.getPadWidth(i),u=Math.max(0,l-a),c=Math.max(0,l-(o-(a+1))),d=i-(u+c),f=n+(u>0?0:a-l);let h=0;h+=u*this.leftPad.length;for(let b=0;b<d;++b)h+=e[f+b].length;h+=c*this.rightPad.length;const p=u+c+d-1;h+=p*this.separator.length,r[s+a]=new Uint8Array(h);const g=r[s+a];let v=0;const m=b=>b.forEach(x=>g[v++]=x);for(let b=0;b<u;++b)m(this.leftPad),m(this.separator);for(let b=0;b<d-1;++b)m(e[f+b]),m(this.separator);if(d>0){m(e[f+d-1]);for(let b=0;b<c;++b)m(this.separator),m(this.rightPad)}else{for(let b=0;b<c-1;++b)m(this.rightPad),m(this.separator);m(this.rightPad)}}}compute(e,n){const r=e.length,s=n.length;if(s>0){let l=n[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let u=1;u<s;++u){let c=n[u]>=l;if(c=c&&n[u]<=r,!c)throw new Error(`Invalid split value ${n[u]}, must be in [${l}, ${r}]`);l=n[u]}if(l!==r)throw new Error(`Last split value must be data size. Expected ${r}, got ${l}`)}const o=s-1,i=At("int32",s);if(r===0||s===0){const l=new Array(r);for(let u=0;u<=o;++u)i[u]=0;return[l,i]}i[0]=0;for(let l=1;l<=o;++l){const u=n[l]-n[l-1];let c=0;this.nGramWidths.forEach(d=>{c+=this.getNumNGrams(u,d)}),this.preserveShort&&u>0&&c===0&&(c=1),i[l]=i[l-1]+c}const a=new Array(i[o]);for(let l=0;l<o;++l){const u=n[l];let c=i[l];if(this.nGramWidths.forEach(d=>{const f=n[l+1]-n[l],h=this.getNumNGrams(f,d);this.createNGrams(e,u,a,c,h,d),c+=h}),this.preserveShort&&c===i[l]){const d=n[l+1]-n[l];if(d===0)continue;const f=d+2*this.padWidth;this.createNGrams(e,u,a,c,1,f)}}return[a,i]}}function RP(t,e,n,r,s,o,i,a){return new XK(n,r,s,o,i,a).compute(t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qK(t,e,n,r){if(!t.length)return;if(e.length===0){for(let o=0;o<t.length;++o)r.push(t.subarray(o,o+1));return}if(e.length===1){const o=e[0];let i=t.indexOf(o);for(;i!==-1;){const a=t.subarray(0,i);(!n||a.length!==0)&&r.push(a),t=t.subarray(i+1),i=t.indexOf(o)}(!n||t.length!==0)&&r.push(t);return}let s=0;for(let o=0;o<t.length+1;o++)if(o===t.length||e.indexOf(t[o])!==-1){const i=t.subarray(s,o);(!n||i.length!==0)&&r.push(i),s=o+1}}function DP(t,e,n){const r=t.length,s=[];let o=0,i=0;const a=new Array(r);for(let f=0;f<r;++f){const h=s.length;qK(t[f],e,n,s);const p=s.length-h;a[f]=p,o+=p,i=Math.max(i,p)}const l=At("int32",o*2),u=new Array(o),c=[r,i];let d=0;for(let f=0;f<r;++f)for(let h=0;h<a[f];++h)l[d*2]=f,l[d*2+1]=h,u[d]=s[d],++d;return[l,u,c]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AP(t,e){const n=At("int32",t.length);for(let r=0;r<t.length;++r)n[r]=RV(t[r]).modulo(e).getLowBitsUnsigned();return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FP=Mt((t,e)=>t-e),YK=x$((t,e,n,r)=>({real:t-n,imag:e-r})),k$=Qt(nf,FP,YK),QK={kernelName:nf,backendName:"cpu",kernelFunc:k$};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PP(t,e){const n=new Array(t.rank);for(let s=0;s<n.length;s++)n[s]=t.shape[s]*e[s];const r=Re(n,t.dtype);for(let s=0;s<r.values.length;++s){const o=r.indexToLoc(s),i=new Array(t.rank);for(let l=0;l<i.length;l++)i[l]=o[l]%t.shape[l];const a=t.locToIndex(i);r.values[s]=t.values[a]}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qu=(t,e)=>{const n=e.value-t.value;return n===0?t.index-e.index:n};function OP(t,e,n=0,r=t.length-1){for(;r>n;){if(r-n>600){const a=r-n+1,l=e-n+1,u=Math.log(a),c=.5*Math.exp(2*u/3),d=.5*Math.sqrt(u*c*(a-c)/a)*Math.sign(l-a/2),f=Math.max(n,Math.floor(e-l*c/a+d)),h=Math.min(r,Math.floor(e+(a-l)*c/a+d));OP(t,e,f,h)}const s=t[e];let o=n,i=r;for(Za(t,n,e),Qu(t[r],s)>0&&Za(t,n,r);o<i;){for(Za(t,o,i),o++,i--;Qu(t[o],s)<0;)o=o+1;for(;Qu(t[i],s)>0;)i=i-1}Qu(t[n],s)===0?Za(t,n,i):(i=i+1,Za(t,i,r)),i<=e&&(n=i+1),e<=i&&(r=i-1)}}function LP(t,e,n,r,s){const o=e[e.length-1],[i,a]=[t.length/o,o],l=bn(n,i*r),u=bn("int32",i*r);for(let d=0;d<i;d++){const f=d*a,h=t.subarray(f,f+a);let p=new Array(h.length);h.forEach((b,x)=>p[x]={value:b,index:x}),r<p.length&&(OP(p,r),p=p.slice(0,r)),s&&p.sort(Qu);const g=d*r,v=l.subarray(g,g+r),m=u.subarray(g,g+r);for(let b=0;b<r;b++)v[b]=p[b].value,m[b]=p[b].index}const c=e.slice();return c[c.length-1]=r,[Re(c,n,l),Re(c,"int32",u)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MP(t,e,n,r){const s=De(e,n)[0],o=[1,n[0],1];for(let p=0;p<s;p++)o[0]*=n[p];o[1]=n[s];for(let p=s+1;p<n.length;p++)o[2]*=n[p];const i=new Map,a=new Int32Array(n[s]),l=new cn(o,r,t),u=[],c=o[0]===1&&o[2]===1;for(let p=0;p<n[s];p++){let g;if(c)g=t[p].toString();else{const m=[];for(let b=0;b<o[0];b++)for(let x=0;x<o[2];x++)m.push(l.get(b,p,x));g=m.join(",")}const v=i.get(g);if(v!=null)a[p]=v;else{const m=i.size;i.set(g,m),a[p]=m,u.push(p)}}const d=o.slice();d[1]=i.size;const f=new cn(d,r);u.forEach((p,g)=>{for(let v=0;v<o[0];v++)for(let m=0;m<o[2];m++)f.set(l.get(v,p,m),v,g,m)});const h=n.slice();return h[s]=d[1],{outputValues:f.values,outputShape:h,indices:a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZK=Object.freeze(Object.defineProperty({__proto__:null,addImpl:jF,bincountImpl:y$,bincountReduceImpl:KF,bitwiseAndImpl:XF,castImpl:HF,ceilImpl:qF,concatImpl:YF,equalImpl:QF,expImpl:JF,expm1Impl:tP,floorDivImpl:rP,floorImpl:nP,gatherNdImpl:sP,gatherV2Impl:oP,greaterEqualImpl:aP,greaterImpl:iP,lessEqualImpl:uP,lessImpl:lP,linSpaceImpl:cP,logImpl:dP,maxImpl:fP,maximumImpl:hP,minimumImpl:pP,multiplyImpl:w$,negImpl:mP,notEqualImpl:gP,prodImpl:vP,raggedGatherImpl:bP,raggedRangeImpl:xP,raggedTensorToTensorImpl:yP,rangeImpl:wP,rsqrtImpl:$P,scatterImpl:Mi,sigmoidImpl:_K,simpleAbsImpl:GF,sliceImpl:kP,sparseFillEmptyRowsImpl:SP,sparseReshapeImpl:IP,sparseSegmentReductionImpl:C$,sqrtImpl:BK,squaredDifferenceImpl:TP,staticRegexReplaceImpl:EP,stridedSliceImpl:NP,stringNGramsImpl:RP,stringSplitImpl:DP,stringToHashBucketFastImpl:AP,subImpl:FP,tileImpl:PP,topKImpl:LP,transposeImpl:$$,uniqueImpl:MP},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */tR("cpu",()=>new l0,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _P=nt(Sd,t=>t>=0?t:Math.exp(t)-1),JK={kernelName:Sd,backendName:"cpu",kernelFunc:_P};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zP(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{alpha:o}=r;fe([s],"leakyRelu");const i=q(s.shape),a=n.data.get(s.dataId).values,l=bn("float32",i);for(let u=0;u<a.length;u++)l[u]=a[u]<0?o*a[u]:a[u];return n.makeTensorInfo(s.shape,"float32",l)}const e9={kernelName:og,backendName:"cpu",kernelFunc:zP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t9=Mt((t,e)=>t<0?e*t:t);function VP(t){const{inputs:e,backend:n}=t,{x:r,alpha:s}=e;fe([r,s],"prelu");const o=n.data.get(r.dataId).values,i=n.data.get(s.dataId).values,[a,l]=t9(r.shape,s.shape,o,i,"float32");return n.makeTensorInfo(l,"float32",a)}const n9={kernelName:kg,backendName:"cpu",kernelFunc:VP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BP=nt(Gd,t=>Math.max(0,t)),r9={kernelName:Gd,backendName:"cpu",kernelFunc:BP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WP=nt(Hd,t=>Math.min(Math.max(0,t),6)),s9={kernelName:Hd,backendName:"cpu",kernelFunc:WP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hp(t,e,n,r,s){if(n==="linear")return Ks({inputs:{x:e},backend:t});if(n==="relu")return BP({inputs:{x:e},backend:t});if(n==="elu")return _P({inputs:{x:e},backend:t});if(n==="relu6")return WP({inputs:{x:e},backend:t});if(n==="prelu")return VP({inputs:{x:e,alpha:r},backend:t});if(n==="leakyrelu")return zP({inputs:{x:e},backend:t,attrs:{alpha:s}});if(n==="sigmoid")return CP({inputs:{x:e},backend:t});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lt(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{shape:o}=r,i=q(s.shape),a=aN(o,i),l=q(a);D(i===l,()=>`The new shape (${a}) has ${l} elements and the old shape (${s.shape}) has ${i} elements. The new shape and old shape must have the same number of elements.`),n.incRef(s.dataId);const u=n.data.get(s.dataId);if(u.complexTensorInfos!=null){const c=u.complexTensorInfos.real,d=u.complexTensorInfos.imag;c.shape=a,d.shape=a}return{dataId:s.dataId,shape:a,dtype:s.dtype}}const o9={kernelName:Ig,backendName:"cpu",kernelFunc:lt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UP(t){const{inputs:e,backend:n,attrs:r}=t,{a:s,b:o}=e,{transposeA:i,transposeB:a}=r;fe([s,o],"matMul");const l=s.shape.length,u=o.shape.length,c=i?s.shape[l-2]:s.shape[l-1],d=a?o.shape[u-1]:o.shape[u-2],f=i?s.shape[l-1]:s.shape[l-2],h=a?o.shape[u-2]:o.shape[u-1],p=s.shape.slice(0,-2),g=o.shape.slice(0,-2),v=q(p),m=q(g),x=Se(s.shape.slice(0,-2),o.shape.slice(0,-2)).concat([f,h]);D(c===d,()=>`Error in matMul: inner shapes (${c}) and (${d}) of Tensors with shapes ${s.shape} and ${o.shape} and transposeA=${i} and transposeB=${a} must match.`);const y=i?[v,c,f]:[v,f,c],$=a?[m,h,d]:[m,d,h],C=lt({inputs:{x:s},backend:n,attrs:{shape:y}}),k=lt({inputs:{x:o},backend:n,attrs:{shape:$}}),w=i?C.shape[1]:C.shape[2],I=i?C.shape[2]:C.shape[1],N=a?k.shape[1]:k.shape[2],E=Math.max(v,m),R=n.data.get(C.dataId).values,S=n.data.get(k.dataId).values,T=me(C.shape),F=me(k.shape),[L,G,P]=i?[T[0],1,T[1]]:[T[0],T[1],1],[z,U,K]=a?[1,F[1],F[0]]:[F[1],1,F[0]],Q=I*N,Z=Re([E,I,N],C.dtype),te=Z.values,J=n.blockSize;for(let re=0;re<E;re++){const le=re%v,pe=re%m;for(let oe=0;oe<I;oe+=J){const xe=Math.min(oe+J,I);for(let $e=0;$e<N;$e+=J){const Oe=Math.min($e+J,N);for(let We=0;We<w;We+=J){const Qe=Math.min(We+J,w);for(let Le=oe;Le<xe;Le++)for(let Pe=$e;Pe<Oe;Pe++){let Ke=0;for(let Ue=We;Ue<Qe;Ue++){const Ce=R[le*L+Le*G+Ue*P],Tt=S[Ue*z+Pe*U+pe*K];Ke+=Ce*Tt}te[re*Q+(Le*N+Pe)]+=Ke}}}}}return n.disposeIntermediateTensorInfo(C),n.disposeIntermediateTensorInfo(k),n.makeTensorInfo(x,Z.dtype,Z.values)}const i9={kernelName:Gm,backendName:"cpu",kernelFunc:UP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a9(t){const{inputs:e,backend:n,attrs:r}=t,{a:s,b:o,bias:i,preluActivationWeights:a}=e,{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:d}=r;let f,h,p;const g=[];f=UP({inputs:{a:s,b:o},attrs:{transposeA:l,transposeB:u},backend:n}),i&&(h=jl({inputs:{a:f,b:i},backend:n}),g.push(f),f=h),c&&(p=Hp(n,f,c,a,d),g.push(f),f=p);for(const m of g)n.disposeIntermediateTensorInfo(m);return f}const l9={kernelName:kp,backendName:"cpu",kernelFunc:a9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u9=nt(fd,t=>Math.acos(t)),c9={kernelName:fd,backendName:"cpu",kernelFunc:u9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d9=nt(hd,t=>Math.acosh(t)),f9={kernelName:hd,backendName:"cpu",kernelFunc:d9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h9(t){const{inputs:e,backend:n}=t,r=e;fe(e,"addN");const s=r.map(a=>n.data.get(a.dataId).values),o=Re(r[0].shape,r[0].dtype),i=o.values;for(let a=0;a<r.length;a++){const l=s[a];for(let u=0;u<i.length;u++)i[u]+=l[u]}return n.makeTensorInfo(o.shape,o.dtype,o.values)}const p9={kernelName:e1,backendName:"cpu",kernelFunc:h9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m9(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,keepDims:i}=r;fe(s,"all");const a=De(o,s.shape);let l=a;const u=It(l,s.shape.length);let c=s;u!=null&&(c=Hn({inputs:{x:s},backend:n,attrs:{perm:u}}),l=Ot(l.length,s.shape.length)),fn("all",l,c.shape.length);const[d,f]=sn(c.shape,l),h=q(f),p=xn(q(d),c.dtype),g=n.data.get(c.dataId).values;for(let m=0;m<p.length;++m){const b=m*h;let x=g[b];for(let y=0;y<h;++y){const $=g[b+y];x=x&&$}p[m]=x}u!=null&&n.disposeIntermediateTensorInfo(c);const v=n.makeTensorInfo(d,c.dtype,p);if(i){const m=Vt(d,a),b=lt({inputs:{x:v},backend:n,attrs:{shape:m}});return n.disposeIntermediateTensorInfo(v),b}return v}const g9={kernelName:t1,backendName:"cpu",kernelFunc:m9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v9(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,keepDims:i}=r;fe(s,"any");const a=De(o,s.shape);let l=a;const u=It(l,s.shape.length);let c=s;u!=null&&(c=Hn({inputs:{x:s},backend:n,attrs:{perm:u}}),l=Ot(l.length,s.shape.length)),fn("any",l,c.shape.length);const[d,f]=sn(c.shape,l),h=q(f),p=xn(q(d),c.dtype),g=n.data.get(c.dataId).values;for(let m=0;m<p.length;++m){const b=m*h;let x=g[b];for(let y=0;y<h;++y){const $=g[b+y];x=x||$}p[m]=x}u!=null&&n.disposeIntermediateTensorInfo(c);const v=n.makeTensorInfo(d,c.dtype,p);if(i){const m=Vt(d,a),b=lt({inputs:{x:v},backend:n,attrs:{shape:m}});return n.disposeIntermediateTensorInfo(v),b}return v}const b9={kernelName:n1,backendName:"cpu",kernelFunc:v9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x9(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o}=r;fe(s,"argMax");let i=De(o,s.shape);const a=It(i,s.shape.length);let l=s;const u=[];a!=null&&(l=Hn({inputs:{x:s},backend:n,attrs:{perm:a}}),u.push(l),i=Ot(i.length,l.shape.length)),i=[i[0]],fn("argMax",i,l.shape.length);const[c,d]=sn(l.shape,i),f=q(c),h=xn(f,"int32"),p=q(d),g=n.data.get(l.dataId).values;for(let v=0;v<h.length;++v){const m=v*p;let b=g[m],x=0;for(let y=0;y<p;++y){const $=g[m+y];$>b&&(b=$,x=y)}h[v]=x}return u.forEach(v=>n.disposeIntermediateTensorInfo(v)),n.makeTensorInfo(c,"int32",h)}const y9={kernelName:Vm,backendName:"cpu",kernelFunc:x9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w9(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o}=r;fe(s,"argMin");let i=De(o,s.shape);const a=It(i,s.shape.length);let l=s;const u=[];a!=null&&(l=Hn({inputs:{x:s},backend:n,attrs:{perm:a}}),u.push(l),i=Ot(i.length,l.shape.length)),i=[i[0]],fn("argMin",i,l.shape.length);const[c,d]=sn(l.shape,i),f=q(c),h=xn(f,"int32"),p=q(d),g=n.data.get(l.dataId).values;for(let v=0;v<h.length;++v){const m=v*p;let b=g[m],x=0;for(let y=0;y<p;++y){const $=g[m+y];$<b&&(b=$,x=y)}h[v]=x}return u.forEach(v=>n.disposeIntermediateTensorInfo(v)),n.makeTensorInfo(c,"int32",h)}const $9={kernelName:Bm,backendName:"cpu",kernelFunc:w9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C9=nt(pd,t=>Math.asin(t)),k9={kernelName:pd,backendName:"cpu",kernelFunc:C9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S9=nt(md,t=>Math.asinh(t)),I9={kernelName:md,backendName:"cpu",kernelFunc:S9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T9=nt(gd,t=>Math.atan(t)),E9={kernelName:gd,backendName:"cpu",kernelFunc:T9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N9=Mt((t,e)=>Math.atan2(t,e)),R9=Qt(bd,N9),D9={kernelName:bd,backendName:"cpu",kernelFunc:R9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A9=nt(vd,t=>Math.atanh(t)),F9={kernelName:vd,backendName:"cpu",kernelFunc:A9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S$(t,e,n,r,s,o){const i=s.strideHeight,a=s.strideWidth,l=s.dilationHeight,u=s.dilationWidth,c=s.effectiveFilterHeight,d=s.effectiveFilterWidth,f=s.padInfo.top,h=s.padInfo.left,p=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,g=Re(s.outShape,n),v=g.values,m=s.outShape[1]*s.outShape[2]*s.outShape[3],b=s.outShape[2]*s.outShape[3],x=s.outShape[3];for(let y=0;y<s.batchSize;++y){const $=y*m,C=y*r[0];for(let k=0;k<s.inChannels;++k)for(let w=0;w<s.outHeight;++w){const I=w*i-f,N=Math.max(0,I),E=Math.min(s.inHeight,c+I),R=$+w*b;for(let S=0;S<s.outWidth;++S){const T=S*a-h,F=Math.max(0,T),L=Math.min(s.inWidth,d+T);let G=p,P=0,z=0;for(let K=N;K<E;K+=l){const Q=C+K*r[1];for(let Z=F;Z<L;Z+=u){const te=Q+Z*r[2],J=t[te+k];o==="max"&&J>G?G=J:o==="avg"&&(P+=J,z++)}if(isNaN(G))break}const U=R+S*x+k;v[U]=o==="avg"?P/z:G}}}return g}function GP(t,e,n,r,s=!1,o=!1){const i=Re(r.outShape,"int32"),a=r.strideHeight,l=r.strideWidth,u=r.dilationHeight,c=r.dilationWidth,d=r.effectiveFilterHeight,f=r.effectiveFilterWidth,h=r.padInfo.top,p=r.padInfo.left,g=Re(e,n,t);for(let v=0;v<r.batchSize;++v)for(let m=0;m<r.inChannels;++m)for(let b=0;b<r.outHeight;++b){const x=b*a-h;let y=x;for(;y<0;)y+=u;const $=Math.min(r.inHeight,d+x);for(let C=0;C<r.outWidth;++C){const k=C*l-p;let w=k;for(;w<0;)w+=c;const I=Math.min(r.inWidth,f+k);let N=Number.NEGATIVE_INFINITY,E=-1;for(let R=y;R<$;R+=u){const S=R-x;for(let T=w;T<I;T+=c){const F=T-k,L=g.get(v,R,T,m);L>N&&(N=L,s?E=o?((v*r.inHeight+R)*r.inWidth+T)*r.inChannels+m:(R*r.inWidth+T)*r.inChannels+m:E=S*f+F)}}i.set(E,v,b,C,m)}}return i}function HP(t,e,n,r,s,o){const i=s.strideDepth,a=s.strideHeight,l=s.strideWidth,u=s.dilationDepth,c=s.dilationHeight,d=s.dilationWidth,f=s.effectiveFilterDepth,h=s.effectiveFilterHeight,p=s.effectiveFilterWidth,g=s.padInfo.front,v=s.padInfo.top,m=s.padInfo.left,b=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,x=Re(s.outShape,n),y=x.values,$=s.outShape[1]*s.outShape[2]*s.outShape[3]*s.outShape[4],C=s.outShape[2]*s.outShape[3]*s.outShape[4],k=s.outShape[3]*s.outShape[4],w=s.outShape[4];for(let I=0;I<s.batchSize;++I){const N=I*$,E=I*r[0];for(let R=0;R<s.inChannels;++R)for(let S=0;S<s.outDepth;++S){const T=S*i-g;let F=T;for(;F<0;)F+=u;const L=Math.min(s.inDepth,f+T),G=N+S*C;for(let P=0;P<s.outHeight;++P){const z=P*a-v;let U=z;for(;U<0;)U+=c;const K=Math.min(s.inHeight,h+z),Q=G+P*k;for(let Z=0;Z<s.outWidth;++Z){const te=Z*l-m;let J=te;for(;J<0;)J+=d;const re=Math.min(s.inWidth,p+te),le=Q+Z*w;let pe=b,oe=0,xe=0;for(let Oe=F;Oe<L;Oe+=u){const We=E+Oe*r[1];for(let Qe=U;Qe<K;Qe+=c){const Le=We+Qe*r[2];for(let Pe=J;Pe<re;Pe+=d){const Ke=Le+Pe*r[3],Ue=t[Ke+R];if(o==="max"&&Ue>pe?pe=Ue:o==="avg"&&(oe+=Ue,xe++),isNaN(pe))break}if(isNaN(pe))break}if(isNaN(pe))break}const $e=le+R;y[$e]=o==="avg"?oe/Math.max(xe,1):pe}}}}return x}function P9(t,e){const n=Re(e.outShape,"int32"),r=e.strideDepth,s=e.strideHeight,o=e.strideWidth,i=e.dilationDepth,a=e.dilationHeight,l=e.dilationWidth,u=e.effectiveFilterDepth,c=e.effectiveFilterHeight,d=e.effectiveFilterWidth,f=e.padInfo.front,h=e.padInfo.top,p=e.padInfo.left;for(let g=0;g<e.batchSize;++g)for(let v=0;v<e.inChannels;++v)for(let m=0;m<e.outDepth;++m){const b=m*r-f;let x=b;for(;x<0;)x+=i;const y=Math.min(e.inDepth,u+b);for(let $=0;$<e.outHeight;++$){const C=$*s-h;let k=C;for(;k<0;)k+=a;const w=Math.min(e.inHeight,c+C);for(let I=0;I<e.outWidth;++I){const N=I*o-p;let E=N;for(;E<0;)E+=l;const R=Math.min(e.inWidth,d+N);let S=Number.NEGATIVE_INFINITY,T=-1;for(let F=x;F<y;F+=i){const L=F-b;for(let G=k;G<w;G+=a){const P=G-C;for(let z=E;z<R;z+=l){const U=z-N,K=t.get(g,F,G,z,v);K>=S&&(S=K,T=L*c*d+P*c+U)}}}n.set(T,g,m,$,I,v)}}}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O9(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;fe(s,"avgPool");const{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=r,u=1;D(wn(i,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const c=Zr(s.shape,o,i,u,a,l);let d;if(c.filterWidth===1&&c.filterHeight===1&&Ye(c.inShape,c.outShape))d=Ks({inputs:{x:s},backend:n});else{const f=n.data.get(s.dataId).values,h=me(s.shape),p=S$(f,s.shape,s.dtype,h,c,"avg");d=n.makeTensorInfo(c.outShape,s.dtype,p.values)}return d}const L9={kernelName:Wm,backendName:"cpu",kernelFunc:O9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M9(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:o,strides:i,pad:a,dimRoundingMode:l,dataFormat:u}=r;fe(s,"avgPool3d");const c=$o(s.shape,o,i,1,a,l,u),d=n.data.get(s.dataId).values,f=HP(d,s.shape,s.dtype,me(s.shape),c,"avg");return n.makeTensorInfo(f.shape,"float32",f.values)}const _9={kernelName:Um,backendName:"cpu",kernelFunc:M9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z9(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:o}=e,{filterSize:i,strides:a,pad:l,dimRoundingMode:u}=r;fe([s,o],"avgPool3DGrad");const c=$o(o.shape,i,a,1,l,u),d=c.strideDepth,f=c.strideHeight,h=c.strideWidth,p=c.filterDepth,g=c.filterHeight,v=c.filterWidth,m=c.dilationDepth,b=c.dilationHeight,x=c.dilationWidth,y=c.effectiveFilterDepth,$=c.effectiveFilterHeight,C=c.effectiveFilterWidth,k=y-1-c.padInfo.front,w=C-1-c.padInfo.left,I=$-1-c.padInfo.top,N=Re(o.shape,"float32"),E=1/(p*g*v),R=n.bufferSync(s);for(let S=0;S<c.batchSize;++S)for(let T=0;T<c.inChannels;++T)for(let F=0;F<c.inDepth;++F)for(let L=0;L<c.inHeight;++L)for(let G=0;G<c.inWidth;++G){const P=F-k,z=L-I,U=G-w;let K=0;for(let Q=0;Q<y;Q+=m){const Z=(P+Q)/d;if(!(Z<0||Z>=c.outDepth||Math.floor(Z)!==Z))for(let te=0;te<$;te+=b){const J=(z+te)/f;if(!(J<0||J>=c.outHeight||Math.floor(J)!==J))for(let re=0;re<C;re+=x){const le=(U+re)/h;if(le<0||le>=c.outWidth||Math.floor(le)!==le)continue;const pe=R.get(S,Z,J,le,T);K+=pe}}}N.set(K*E,S,F,L,G,T)}return n.makeTensorInfo(N.shape,N.dtype,N.values)}const V9={kernelName:s1,backendName:"cpu",kernelFunc:z9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B9(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:o}=e,i=o;fe([s,o],"avgPoolGrad");const{filterSize:a,strides:l,pad:u}=r,c=Zr(i.shape,a,l,1,u),d=c.strideHeight,f=c.strideWidth,h=c.filterHeight,p=c.filterWidth,g=c.dilationHeight,v=c.dilationWidth,m=c.effectiveFilterHeight,b=c.effectiveFilterWidth,x=b-1-c.padInfo.left,y=m-1-c.padInfo.top,$=Re(i.shape,"float32"),C=1/(h*p),k=n.data.get(s.dataId).values,w=Re(s.shape,"float32",k);for(let I=0;I<c.batchSize;++I)for(let N=0;N<c.inChannels;++N)for(let E=0;E<c.inHeight;++E)for(let R=0;R<c.inWidth;++R){const S=E-y,T=R-x;let F=0;for(let L=0;L<m;L+=g){const G=(S+L)/d;if(!(G<0||G>=c.outHeight||Math.floor(G)!==G))for(let P=0;P<b;P+=v){const z=(T+P)/f;if(z<0||z>=c.outWidth||Math.floor(z)!==z)continue;const U=w.get(I,G,z,N);F+=U}}$.set(F*C,I,E,R,N)}return n.makeTensorInfo($.shape,$.dtype,$.values)}const W9={kernelName:r1,backendName:"cpu",kernelFunc:B9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U9(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,scale:o,offset:i,mean:a,variance:l}=e;D(a.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),D(i==null||a.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),D(o==null||a.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),fe([s,a,l,o,i],"batchNorm");let{varianceEpsilon:u}=r;u==null&&(u=.001);const c=n.data.get(s.dataId).values,d=n.data.get(a.dataId).values,f=n.data.get(l.dataId).values,h=o?n.data.get(o.dataId).values:new Float32Array([1]),p=i?n.data.get(i.dataId).values:new Float32Array([0]),g=new Float32Array(c.length),v=p.length,m=h.length,b=f.length,x=d.length;let y=0,$=0,C=0,k=0;for(let w=0;w<c.length;++w)g[w]=p[y++]+(c[w]-d[$++])*h[C++]/Math.sqrt(f[k++]+u),y>=v&&(y=0),$>=x&&($=0),C>=m&&(C=0),k>=b&&(k=0);return n.makeTensorInfo(s.shape,s.dtype,g)}const G9={kernelName:ng,backendName:"cpu",kernelFunc:U9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H9(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockShape:o,crops:i}=r;fe([s],"batchToSpaceND");const a=o.reduce((m,b)=>m*b),l=hf(s.shape,o,a),u=pf(l.length,o.length),c=mf(s.shape,o,a),d=Ow(i,o.length),f=Lw(c,i,o.length),h=lt({inputs:{x:s},backend:n,attrs:{shape:l}}),p=Hn({inputs:{x:h},backend:n,attrs:{perm:u}}),g=lt({inputs:{x:p},backend:n,attrs:{shape:c}}),v=ha({inputs:{x:g},backend:n,attrs:{begin:d,size:f}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),v}const j9={kernelName:Hm,backendName:"cpu",kernelFunc:H9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K9(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,weights:o}=e,{size:i}=r,a=n.data.get(s.dataId).values,l=n.data.get(o.dataId).values,u=y$(a,l,o.dtype,o.shape,i);return n.makeTensorInfo([i],o.dtype,u)}const X9={kernelName:o1,backendName:"cpu",kernelFunc:K9};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q9(t){const{inputs:e,backend:n}=t,{s0:r,s1:s}=e,o=n.data.get(r.dataId).values,i=n.data.get(s.dataId).values,a=Se(Array.from(o),Array.from(i));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const Y9={kernelName:hN,backendName:"cpu",kernelFunc:q9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q9=nt(wd,(t,e)=>{const n=e;return t>n.clipValueMax?n.clipValueMax:t<n.clipValueMin?n.clipValueMin:t}),Z9={kernelName:wd,backendName:"cpu",kernelFunc:Q9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J9=t=>{const{x:e}=t.inputs,n=t.backend,r=new Float32Array(q(e.shape)),s=n.data.get(e.dataId),o=s.complexTensorInfos.real,i=s.complexTensorInfos.imag,a=n.data.get(o.dataId).values,l=n.data.get(i.dataId).values;for(let u=0;u<a.length;u++){const c=a[u],d=l[u];r[u]=Math.hypot(c,d)}return n.makeOutput(r,e.shape,"float32")},eX={kernelName:jm,backendName:"cpu",kernelFunc:J9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kl(t){const{inputs:e,backend:n}=t,{input:r}=e,s=n.data.get(r.dataId).complexTensorInfos.imag,o=n.data.get(s.dataId).values;return n.makeTensorInfo(s.shape,s.dtype,o)}const tX={kernelName:C1,backendName:"cpu",kernelFunc:Kl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xl(t){const{inputs:e,backend:n,attrs:r}=t,{axis:s}=r,o=De(s,e[0].shape)[0],i=e.map(g=>g.shape);Aw(i,o);let a=zs(e.map(g=>g.shape),o);if(q(a)===0)return n.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(g=>q(g.shape)>0);if(l.length===1)return Ks({inputs:{x:l[0]},backend:n});if(l[0].dtype==="complex64"){const g=l.map(y=>fa({inputs:{input:y},backend:n})),v=l.map(y=>Kl({inputs:{input:y},backend:n})),m=Xl({inputs:g,backend:n,attrs:{axis:o}}),b=Xl({inputs:v,backend:n,attrs:{axis:o}}),x=Qn({inputs:{real:m,imag:b},backend:n});return g.forEach(y=>n.disposeIntermediateTensorInfo(y)),v.forEach(y=>n.disposeIntermediateTensorInfo(y)),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(b),x}const u=l.map(g=>{const m=[-1,q(g.shape.slice(o))];return lt({inputs:{x:g},backend:n,attrs:{shape:m}})}),c=u.map(g=>({vals:n.data.get(g.dataId).values,shape:g.shape}));a=zs(u.map(g=>g.shape),1);const d=u[0].shape[0]===1,f=YF(c,a,e[0].dtype,d),h=zs(l.map(g=>g.shape),o),p=n.makeTensorInfo(h,e[0].dtype,f);return u.forEach(g=>n.disposeIntermediateTensorInfo(g)),p}const nX={kernelName:Km,backendName:"cpu",kernelFunc:Xl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jP(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o}=e,{strides:i,pad:a,dataFormat:l,dilations:u,dimRoundingMode:c}=r;fe([s,o],"conv2d");const d=Co(l),f=dn(s.shape,o.shape,i,u,a,c,!1,d),h=f.filterHeight,p=f.filterWidth,g=f.dilationHeight,v=f.dilationWidth,m=f.padInfo.left,b=f.padInfo.top,x=f.dataFormat==="channelsLast",y=new cn(f.outShape,s.dtype),$=me(s.shape),C=me(o.shape),k=$[0],w=x?$[1]:$[2],I=x?$[2]:1,N=x?1:$[1],E=y.strides[0],R=x?y.strides[1]:y.strides[2],S=x?y.strides[2]:1,T=x?1:y.strides[1],F=n.data.get(s.dataId).values,L=n.data.get(o.dataId).values,G=y.values;for(let P=0;P<f.batchSize;++P){const z=P*k,U=P*E;for(let K=0;K<f.outHeight;++K){const Q=U+K*R,Z=K*f.strideHeight-b;for(let te=0;te<h;++te){const J=Z+te*g;if(J<0||J>=f.inHeight)continue;const re=te*C[0],le=z+J*w;for(let pe=0;pe<f.outWidth;++pe){const oe=Q+pe*S,xe=pe*f.strideWidth-m;for(let $e=0;$e<p;++$e){const Oe=xe+$e*v;if(Oe<0||Oe>=f.inWidth)continue;const We=re+$e*C[1],Qe=le+Oe*I;let Le=We;for(let Pe=0;Pe<f.inChannels;++Pe){const Ke=F[Qe+Pe*N];for(let Ue=0;Ue<f.outChannels;++Ue)G[oe+Ue*T]+=Ke*L[Le+Ue];Le+=f.outChannels}}}}}}return n.makeTensorInfo(y.shape,y.dtype,G)}const rX={kernelName:Xm,backendName:"cpu",kernelFunc:jP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sX(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:o}=e,{strides:i,pad:a,dataFormat:l,dimRoundingMode:u,filterShape:c}=r;fe([s,o],"conv2dBackpropFilter");const d=Co(l),f=dn(s.shape,c,i,1,a,u,!1,d),{strideHeight:h,strideWidth:p,filterHeight:g,filterWidth:v}=f,m=f.dataFormat==="channelsLast",b=new cn(f.filterShape,"float32"),x=f.padInfo.left,y=f.padInfo.top,$=n.data.get(s.dataId).values,C=n.data.get(o.dataId).values,k=new cn(s.shape,s.dtype,$),w=new cn(o.shape,o.dtype,C);for(let I=0;I<g;++I){const N=Math.max(0,Math.ceil((y-I)/h)),E=Math.min(f.outHeight,(f.inHeight+y-I)/h);for(let R=0;R<v;++R){const S=Math.max(0,Math.ceil((x-R)/p)),T=Math.min(f.outWidth,(f.inWidth+x-R)/p);for(let F=0;F<f.inChannels;++F)for(let L=0;L<f.outChannels;++L){let G=0;for(let P=0;P<f.batchSize;++P)for(let z=N;z<E;++z){const U=I+z*h-y;for(let K=S;K<T;++K){const Q=R+K*p-x;m?G+=k.get(P,U,Q,F)*w.get(P,z,K,L):G+=k.get(P,F,U,Q)*w.get(P,L,z,K)}}b.set(G,I,R,F,L)}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}const oX={kernelName:l1,backendName:"cpu",kernelFunc:sX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iX(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:o}=e,{inputShape:i,strides:a,pad:l,dataFormat:u,dimRoundingMode:c}=r;fe([s,o],"conv2dBackpropInput");const d=me(o.shape),f=me(s.shape);let h=Co(u);const p=dn(i,o.shape,a,1,l,c,!1,h),g=new cn(p.inShape,"float32"),v=g.values,m=n.data.get(s.dataId).values,b=n.data.get(o.dataId).values,[x,y,$]=d,{batchSize:C,filterHeight:k,filterWidth:w,inChannels:I,inHeight:N,inWidth:E,outChannels:R,outHeight:S,outWidth:T,strideHeight:F,strideWidth:L}=p;h=p.dataFormat;const G=k-1-p.padInfo.top,P=w-1-p.padInfo.left,z=h==="channelsLast",U=g.strides[0],K=z?g.strides[1]:g.strides[2],Q=z?g.strides[2]:1,Z=z?1:g.strides[1],te=f[0],J=z?f[1]:f[2],re=z?f[2]:1,le=z?1:f[1];for(let pe=0;pe<C;++pe)for(let oe=0;oe<I;++oe)for(let xe=0;xe<N;++xe){const $e=xe-G,Oe=Math.max(0,Math.ceil($e/F)),We=Math.min(S,(k+$e)/F);for(let Qe=0;Qe<E;++Qe){const Le=Qe-P,Pe=Math.max(0,Math.ceil(Le/L)),Ke=Math.min(T,(w+Le)/L);let Ue=0;for(let Tt=Oe;Tt<We;++Tt){const lr=Tt*F-$e;for(let yt=Pe;yt<Ke;++yt){const Ss=yt*L-Le,on=te*pe+J*Tt+re*yt,Bt=x*(k-1-lr)+y*(w-1-Ss)+$*oe;for(let Cr=0;Cr<R;++Cr){const kr=m[on+le*Cr],ts=b[Bt+Cr];Ue+=kr*ts}}}const Ce=U*pe+K*xe+Q*Qe+Z*oe;v[Ce]=Ue}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}const aX={kernelName:qm,backendName:"cpu",kernelFunc:iX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lX(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o}=e,{strides:i,pad:a,dilations:l}=r;fe([s,o],"conv3d");const u=pi(s.shape,o.shape,i,l,a),{filterDepth:c,filterHeight:d,filterWidth:f,dilationDepth:h,dilationHeight:p,dilationWidth:g,padInfo:v}=u,m=v.front,b=v.left,x=v.top,y=new cn(u.outShape,s.dtype),$=n.data.get(s.dataId).values,C=n.data.get(o.dataId).values,k=y.values,w=me(s.shape),I=me(o.shape);for(let N=0;N<u.batchSize;++N){const E=N*w[0],R=N*y.strides[0];for(let S=0;S<u.outDepth;++S){const T=R+S*y.strides[1],F=S*u.strideDepth-m;for(let L=0;L<c;++L){const G=F+L*h;if(G<0||G>=u.inDepth)continue;const P=L*I[0],z=E+G*w[1];for(let U=0;U<u.outHeight;++U){const K=T+U*y.strides[2],Q=U*u.strideHeight-x;for(let Z=0;Z<d;++Z){const te=Q+Z*p;if(te<0||te>=u.inHeight)continue;const J=P+Z*I[1],re=z+te*w[2];for(let le=0;le<u.outWidth;++le){const pe=K+le*u.outChannels,oe=le*u.strideWidth-b;for(let xe=0;xe<f;++xe){const $e=oe+xe*g;if($e<0||$e>=u.inWidth)continue;const Oe=J+xe*I[2],We=re+$e*u.inChannels;let Qe=Oe;for(let Le=0;Le<u.inChannels;++Le){const Pe=$[We+Le];for(let Ke=0;Ke<u.outChannels;++Ke)k[pe+Ke]+=Pe*C[Qe+Ke];Qe+=u.outChannels}}}}}}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}const uX={kernelName:Ym,backendName:"cpu",kernelFunc:lX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cX(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:o}=e,{strides:i,pad:a,filterShape:l}=r;fe([s,o],"conv3dBackpropFilterV2");const u=me(s.shape),c=me(o.shape),d=pi(s.shape,l,i,1,a),f=d.strideDepth,h=d.strideHeight,p=d.strideWidth,g=d.filterDepth,v=d.filterHeight,m=d.filterWidth,b=new cn(d.filterShape,"float32"),x=b.values,[y,$,C,k]=b.strides,w=n.data.get(o.dataId).values,[I,N,E,R]=c,S=n.data.get(s.dataId).values,[T,F,L,G]=u,P=d.padInfo.front,z=d.padInfo.left,U=d.padInfo.top;for(let K=0;K<g;++K){const Q=Math.max(0,Math.ceil((P-K)/f)),Z=Math.min(d.outDepth,(d.inDepth+P-K)/f),te=K*y;for(let J=0;J<v;++J){const re=Math.max(0,Math.ceil((U-J)/h)),le=Math.min(d.outHeight,(d.inHeight+U-J)/h),pe=J*$+te;for(let oe=0;oe<m;++oe){const xe=Math.max(0,Math.ceil((z-oe)/p)),$e=Math.min(d.outWidth,(d.inWidth+z-oe)/p),Oe=oe*C+pe;for(let We=0;We<d.inChannels;++We){const Qe=We*k+Oe;for(let Le=0;Le<d.outChannels;++Le){let Pe=0;for(let Ke=0;Ke<d.batchSize;++Ke){const Ue=Ke*T,Ce=Ke*I;for(let Tt=Q;Tt<Z;++Tt){const yt=(K+Tt*f-P)*F+Ue,Ss=Tt*N+Ce;for(let on=re;on<le;++on){const Cr=(J+on*h-U)*L+yt,kr=on*E+Ss;for(let ts=xe;ts<$e;++ts){const Ba=(oe+ts*p-z)*G+Cr,wi=ts*R+kr;Pe+=S[Ba+We]*w[wi+Le]}}}}x[Qe+Le]=Pe}}}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}const dX={kernelName:u1,backendName:"cpu",kernelFunc:cX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fX(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:o}=e,{pad:i,strides:a,inputShape:l}=r;fe([s],"conv3dBackpropInputV2");const u=me(s.shape),c=me(o.shape),d=pi(l,o.shape,a,1,i),f=new cn(d.inShape,"float32"),h=f.values,[p,g,v,m]=f.strides,b=n.data.get(s.dataId).values,[x,y,$,C]=u,k=n.data.get(o.dataId).values,[w,I,N,E]=c,{batchSize:R,filterDepth:S,filterHeight:T,filterWidth:F,inChannels:L,inDepth:G,inHeight:P,inWidth:z,outChannels:U,outDepth:K,outHeight:Q,outWidth:Z,strideDepth:te,strideHeight:J,strideWidth:re}=d,le=S-1-d.padInfo.front,pe=T-1-d.padInfo.top,oe=F-1-d.padInfo.left;for(let xe=0;xe<R;++xe)for(let $e=0;$e<L;++$e)for(let Oe=0;Oe<G;++Oe){const We=Oe-le,Qe=Math.max(0,Math.ceil(We/te)),Le=Math.min(K,(S+We)/te);for(let Pe=0;Pe<P;++Pe){const Ke=Pe-pe,Ue=Math.max(0,Math.ceil(Ke/J)),Ce=Math.min(Q,(T+Ke)/J);for(let Tt=0;Tt<z;++Tt){const lr=Tt-oe,yt=Math.max(0,Math.ceil(lr/re)),Ss=Math.min(Z,(F+lr)/re);let on=0;for(let Bt=Qe;Bt<Le;++Bt){const Cr=Bt*te-We;for(let kr=Ue;kr<Ce;++kr){const ts=kr*J-Ke;for(let ur=yt;ur<Ss;++ur){const Ba=ur*re-lr,wi=x*xe+y*Bt+$*kr+C*ur,Vf=w*(S-1-Cr)+I*(T-1-ts)+N*(F-1-Ba)+E*$e;for(let Wa=0;Wa<U;++Wa){const Ua=b[wi+Wa],N0=k[Vf+Wa];on+=Ua*N0}}}}h[p*xe+g*Oe+v*Pe+m*Tt+$e]=on}}}return n.makeTensorInfo(f.shape,f.dtype,f.values)}const hX={kernelName:c1,backendName:"cpu",kernelFunc:fX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pX=nt($d,t=>Math.cos(t)),mX={kernelName:$d,backendName:"cpu",kernelFunc:pX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gX=nt(Cd,t=>Math.cosh(t)),vX={kernelName:Cd,backendName:"cpu",kernelFunc:gX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bX(t){const{inputs:e,backend:n,attrs:r}=t,{image:s,boxes:o,boxInd:i}=e,{cropSize:a,method:l,extrapolationValue:u}=r,[c,d,f,h]=s.shape,p=o.shape[0],[g,v]=a,m=Re([p,g,v,h],"float32"),b=n.data.get(o.dataId).values,x=n.data.get(i.dataId).values,y=n.data.get(s.dataId).values,$=me(s.shape),C=me(m.shape);for(let k=0;k<p;k++){const w=k*4,I=b[w],N=b[w+1],E=b[w+2],R=b[w+3],S=x[k];if(S>=c)continue;const T=g>1?(E-I)*(d-1)/(g-1):0,F=v>1?(R-N)*(f-1)/(v-1):0;for(let L=0;L<g;L++){const G=g>1?I*(d-1)+L*T:.5*(I+E)*(d-1);if(G<0||G>d-1){for(let P=0;P<v;P++)for(let z=0;z<h;z++){const U=z+P*C[2]+L*C[1]+k*C[0];m.values[U]=u}continue}if(l==="bilinear"){const P=Math.floor(G),z=Math.ceil(G),U=G-P;for(let K=0;K<v;K++){const Q=v>1?N*(f-1)+K*F:.5*(N+R)*(f-1);if(Q<0||Q>f-1){for(let re=0;re<h;re++){const le=re+K*C[2]+L*C[1]+k*C[0];m.values[le]=u}continue}const Z=Math.floor(Q),te=Math.ceil(Q),J=Q-Z;for(let re=0;re<h;re++){let le=re+Z*$[2]+P*$[1]+S*$[0];const pe=y[le];le=re+te*$[2]+P*$[1]+S*$[0];const oe=y[le];le=re+Z*$[2]+z*$[1]+S*$[0];const xe=y[le];le=re+te*$[2]+z*$[1]+S*$[0];const $e=y[le],Oe=pe+(oe-pe)*J,We=xe+($e-xe)*J;le=re+K*C[2]+L*C[1]+k*C[0],m.values[le]=Oe+(We-Oe)*U}}}else for(let P=0;P<v;++P){const z=v>1?N*(f-1)+P*F:.5*(N+R)*(f-1);if(z<0||z>f-1){for(let Q=0;Q<h;Q++){const Z=Q+P*C[2]+L*C[1]+k*C[0];m.values[Z]=u}continue}const U=Math.round(z),K=Math.round(G);for(let Q=0;Q<h;Q++){const Z=Q+U*$[2]+K*$[1]+S*$[0],te=Q+P*C[2]+L*C[1]+k*C[0];m.values[te]=y[Z]}}}}return n.makeTensorInfo(m.shape,m.dtype,m.values)}const xX={kernelName:f1,backendName:"cpu",kernelFunc:bX};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yX(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,exclusive:i,reverse:a}=r;fe(s,"cumprod");const l=It([o],s.shape.length);let u=s;l!=null&&(u=Hn({inputs:{x:s},backend:n,attrs:{perm:l}}));const c=Ot(1,s.shape.length)[0];if(c!==u.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${c}`);const d=sr(u.dtype,"int32"),f=Qy(q(u.shape),d),h=n.data.get(u.dataId).values,p=u.shape[u.shape.length-1],g=a?(m,b)=>m+p-b-1:(m,b)=>m+b;for(let m=0;m<h.length;m+=p)for(let b=0;b<p;b++){const x=g(m,b);if(b===0)f[x]=i?1:h[x];else{const y=g(m,b-1);f[x]=i?h[y]*f[y]:h[x]*f[y]}}const v=n.makeTensorInfo(u.shape,d,f);if(l!=null){const m=mi(l),b=Hn({inputs:{x:v},backend:n,attrs:{perm:m}});return n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(u),b}return v}const wX={kernelName:d1,backendName:"cpu",kernelFunc:yX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $X(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,exclusive:i,reverse:a}=r;fe(s,"cumsum");const l=It([o],s.shape.length);let u=s;l!=null&&(u=Hn({inputs:{x:s},backend:n,attrs:{perm:l}}));const c=Ot(1,s.shape.length)[0];if(c!==u.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${c}`);const d=sr(u.dtype,"int32"),f=xn(q(u.shape),d),h=n.data.get(u.dataId).values,p=u.shape[u.shape.length-1],g=a?(m,b)=>m+p-b-1:(m,b)=>m+b;for(let m=0;m<h.length;m+=p)for(let b=0;b<p;b++){const x=g(m,b);if(b===0)f[x]=i?0:h[x];else{const y=g(m,b-1);f[x]=i?h[y]+f[y]:h[x]+f[y]}}const v=n.makeTensorInfo(u.shape,d,f);if(l!=null){const m=mi(l),b=Hn({inputs:{x:v},backend:n,attrs:{perm:m}});return n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(u),b}return v}const CX={kernelName:Qm,backendName:"cpu",kernelFunc:$X};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kX(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,weights:o}=e,{size:i,binaryOutput:a}=r;if(s.shape.length===1){const l=n.data.get(s.dataId).values,u=n.data.get(o.dataId).values,c=y$(l,u,o.dtype,o.shape,i);return n.makeTensorInfo([i],o.dtype,c)}else if(s.shape.length===2){const l=n.bufferSync(s),u=n.bufferSync(o),c=KF(l,u,i,a);return n.makeTensorInfo(c.shape,o.dtype,c.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${s.shape.length}.`)}const SX={kernelName:h1,backendName:"cpu",kernelFunc:kX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IX(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockSize:o,dataFormat:i}=r;D(i==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${i}`);const a=s.shape[0],l=s.shape[1],u=s.shape[2],c=s.shape[3],d=l*o,f=u*o,h=c/(o*o),p=n.data.get(s.dataId).values,g=new Float32Array(a*d*f*h);let v=0;for(let m=0;m<a;++m)for(let b=0;b<d;++b){const x=Math.floor(b/o),y=b%o;for(let $=0;$<f;++$){const C=Math.floor($/o),k=$%o,w=(y*o+k)*h;for(let I=0;I<h;++I){const E=I+w+c*(C+u*(x+l*m));g[v++]=p[E]}}}return n.makeTensorInfo([a,d,f,h],s.dtype,g)}const TX={kernelName:p1,backendName:"cpu",kernelFunc:IX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KP(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o}=e,{strides:i,pad:a,dilations:l,dimRoundingMode:u}=r;fe([s,o],"depthwiseConv2DNative");const c=me(s.shape),d=me(o.shape);let f=l;f==null&&(f=[1,1]),D(wn(i,f),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${f}'`);const h=dn(s.shape,o.shape,i,f,a,u,!0),{filterHeight:p,filterWidth:g,dilationHeight:v,dilationWidth:m,padInfo:b}=h,x=b.left,y=b.top,$=h.outChannels/h.inChannels,C=new cn(h.outShape,s.dtype),k=n.data.get(s.dataId).values,w=n.data.get(o.dataId).values,I=C.values;for(let N=0;N<h.batchSize;++N){const E=N*c[0],R=N*C.strides[0];for(let S=0;S<h.outHeight;++S){const T=R+S*C.strides[1],F=S*h.strideHeight-y;for(let L=0;L<p;++L){const G=F+L*v;if(G<0||G>=h.inHeight)continue;const P=L*d[0],z=E+G*c[1];for(let U=0;U<h.outWidth;++U){const K=T+U*C.strides[2],Q=U*h.strideWidth-x;for(let Z=0;Z<g;++Z){const te=Q+Z*m;if(te<0||te>=h.inWidth)continue;const J=P+Z*d[1],re=z+te*h.inChannels;let le=K,pe=J;for(let oe=0;oe<h.inChannels;++oe){const xe=k[re+oe];for(let $e=0;$e<$;++$e)I[le+$e]+=xe*w[pe+$e];le+=$,pe+=$}}}}}}return n.makeTensorInfo(C.shape,C.dtype,C.values)}const EX={kernelName:Zm,backendName:"cpu",kernelFunc:KP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NX(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:o}=e,{strides:i,dilations:a,pad:l,dimRoundingMode:u,filterShape:c}=r;fe([s,o],"depthwiseConv2dNativeBackpropFilter");const d=dn(s.shape,c,i,a,l,u,!0),{strideHeight:f,strideWidth:h,filterHeight:p,filterWidth:g}=d,v=new cn(d.filterShape,"float32"),m=d.padInfo.left,b=d.padInfo.top,x=d.outChannels/d.inChannels,y=n.data.get(s.dataId).values,$=new cn(s.shape,s.dtype,y),C=n.data.get(o.dataId).values,k=new cn(o.shape,o.dtype,C);for(let w=0;w<p;++w){const I=Math.max(0,Math.ceil((b-w)/f)),N=Math.min(d.outHeight,(d.inHeight+b-w)/f);for(let E=0;E<g;++E){const R=Math.max(0,Math.ceil((m-E)/h)),S=Math.min(d.outWidth,(d.inWidth+m-E)/h);for(let T=0;T<d.outChannels;++T){const F=Math.trunc(T/x),L=T%x;let G=0;for(let P=0;P<d.batchSize;++P)for(let z=I;z<N;++z){const U=w+z*f-b;for(let K=R;K<S;++K){const Q=E+K*h-m;G+=$.get(P,U,Q,F)*k.get(P,z,K,T)}}v.set(G,w,E,F,L)}}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}const RX={kernelName:m1,backendName:"cpu",kernelFunc:NX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DX(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:o}=e,{strides:i,dilations:a,pad:l,dimRoundingMode:u,inputShape:c}=r;fe([s,o],"depthwiseConv2DNativeBackpropInput");const d=me(s.shape),f=me(o.shape),h=dn(c,o.shape,i,a,l,u,!0),p=new cn(h.inShape,"float32"),g=p.values,[v,m,b]=p.strides,x=n.data.get(s.dataId).values,[y,$,C]=d,k=n.data.get(o.dataId).values,[w,I,N]=f,{batchSize:E,filterHeight:R,filterWidth:S,inChannels:T,inHeight:F,inWidth:L,outChannels:G,outHeight:P,outWidth:z,strideHeight:U,strideWidth:K}=h,Q=R-1-h.padInfo.top,Z=S-1-h.padInfo.left,te=G/T;for(let J=0;J<E;++J)for(let re=0;re<T;++re)for(let le=0;le<F;++le){const pe=le-Q,oe=Math.max(0,Math.ceil(pe/U)),xe=Math.min(P,(R+pe)/U);for(let $e=0;$e<L;++$e){const Oe=$e-Z,We=Math.max(0,Math.ceil(Oe/K)),Qe=Math.min(z,(S+Oe)/K);let Le=0;for(let Pe=oe;Pe<xe;++Pe){const Ke=Pe*U-pe;for(let Ue=We;Ue<Qe;++Ue){const Ce=Ue*K-Oe,Tt=y*J+$*Pe+C*Ue,lr=w*(R-1-Ke)+I*(S-1-Ce)+N*re;for(let yt=0;yt<te;++yt){const Ss=re*te+yt,on=x[Tt+Ss],Bt=k[lr+yt];Le+=on*Bt}}}g[v*J+m*le+b*$e+re]=Le}}return n.makeTensorInfo(p.shape,p.dtype,p.values)}const AX={kernelName:g1,backendName:"cpu",kernelFunc:DX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FX(t){const{inputs:e,backend:n}=t,{x:r}=e,s=q(r.shape),o=n.data.get(r.dataId).values,i=Re([s,s],r.dtype),a=i.values;for(let u=0;u<o.length;u++)a[u*s+u]=o[u];const l=[...r.shape,...r.shape];return n.makeTensorInfo(l,i.dtype,i.values)}const PX={kernelName:pN,backendName:"cpu",kernelFunc:FX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OX={kernelName:Jm,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:r,filter:s}=t,{strides:o,pad:i,dilations:a}=n,l=e,u=l.data.get(r.dataId).values,c=r.shape.length,d=l.data.get(s.dataId).values,f=s.shape.length,{batchSize:h,inHeight:p,inWidth:g,inChannels:v,outHeight:m,outWidth:b,padInfo:x,strideHeight:y,strideWidth:$,filterHeight:C,filterWidth:k,dilationHeight:w,dilationWidth:I,outShape:N}=lf(r.shape,s.shape,o,i,"NHWC",a),E=q(N),R=N.length,S=At(r.dtype,E);for(let F=0;F<h;++F)for(let L=0;L<m;++L){const G=L*y-x.top;for(let P=0;P<b;++P){const z=P*$-x.left;for(let U=0;U<v;++U){let K=Number.MIN_SAFE_INTEGER;for(let Z=0;Z<C;++Z){const te=G+Z*w;if(te>=0&&te<p)for(let J=0;J<k;++J){const re=z+J*I;if(re>=0&&re<g){const le=Ms([F,te,re,U],c,me(r.shape)),pe=Ms([Z,J,U],f,me(s.shape)),oe=u[le]+d[pe];oe>K&&(K=oe)}}}const Q=Ms([F,L,P,U],R,me(N));S[Q]=K}}}return{dataId:l.write(Ta(S,r.dtype),N,r.dtype),shape:N,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LX={kernelName:Mb,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:r,filter:s,dy:o}=t,{strides:i,pad:a,dilations:l}=n,u=e,c=ps(r.shape,u.data.get(r.dataId).values),d=ps(s.shape,u.data.get(s.dataId).values),{batchSize:f,inHeight:h,inWidth:p,inChannels:g,outHeight:v,outWidth:m,padInfo:b,strideHeight:x,strideWidth:y,filterHeight:$,filterWidth:C,dilationHeight:k,dilationWidth:w,outShape:I}=lf(r.shape,s.shape,i,a,"NHWC",l);D(o.rank===I.length,()=>`Error in ${Mb}, dy must have the same rank as output ${I.length}, but got ${o.rank}`);const N=ps(I,u.data.get(o.dataId).values),E=cN(s.shape,s.dtype);for(let S=0;S<f;++S)for(let T=0;T<v;++T){const F=T*x-b.top;for(let L=0;L<m;++L){const G=L*y-b.left;for(let P=0;P<g;++P){let z=Number.MIN_SAFE_INTEGER,U=0,K=0;for(let Q=0;Q<$;++Q){const Z=F+Q*k;if(Z>=0&&Z<h)for(let te=0;te<C;++te){const J=G+te*w;if(J>=0&&J<p){const re=c[S][Z][J][P]+d[Q][te][P];re>z&&(z=re,U=Q,K=te)}}}E[U][K][P]+=N[S][T][L][P]}}}return{dataId:u.write(Ta(E,r.dtype),s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MX={kernelName:Lb,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:r,filter:s,dy:o}=t,{strides:i,pad:a,dilations:l}=n,u=e,c=ps(r.shape,u.data.get(r.dataId).values),d=ps(s.shape,u.data.get(s.dataId).values),{batchSize:f,inHeight:h,inWidth:p,inChannels:g,outHeight:v,outWidth:m,padInfo:b,strideHeight:x,strideWidth:y,filterHeight:$,filterWidth:C,dilationHeight:k,dilationWidth:w,outShape:I}=lf(r.shape,s.shape,i,a,"NHWC",l);D(o.rank===I.length,()=>`Error in ${Lb}, dy must have the same rank as output ${I.length}, but got ${o.rank}`);const N=ps(I,u.data.get(o.dataId).values),E=cN(r.shape,r.dtype);for(let S=0;S<f;++S)for(let T=0;T<v;++T){const F=T*x-b.top;for(let L=0;L<m;++L){const G=L*y-b.left;for(let P=0;P<g;++P){let z=Number.MIN_SAFE_INTEGER,U=F<0?0:F,K=G<0?0:G;for(let Q=0;Q<$;++Q){const Z=F+Q*k;if(Z>=0&&Z<h)for(let te=0;te<C;++te){const J=G+te*w;if(J>=0&&J<p){const re=c[S][Z][J][P]+d[Q][te][P];re>z&&(z=re,U=Z,K=J)}}}E[S][U][K][P]+=N[S][T][L][P]}}}return{dataId:u.write(Ta(E,r.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _X(t){const{inputs:e,backend:n,attrs:r}=t,{image:s}=e,{canvas:o,options:i}=r,{contextOptions:a,imageOptions:l}=i||{},u=(l==null?void 0:l.alpha)||1,c=(a==null?void 0:a.contextType)||"2d";if(c!=="2d")throw new Error(`Context type ${a.contextType} is not supported by the CPU backend.`);const d=o.getContext(c,(a==null?void 0:a.contextAttributes)||{});if(d==null)throw new Error(`Could not get the context with ${c} type.`);const[f,h]=s.shape.slice(0,2),p=s.shape.length===2?1:s.shape[2],g=n.data.get(s.dataId).values,v=s.dtype==="float32"?255:1,m=new Uint8ClampedArray(h*f*4);for(let x=0;x<f*h;++x){const y=[0,0,0,255*u];for(let C=0;C<p;C++){const k=g[x*p+C];if(s.dtype==="float32"){if(k<0||k>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${k}.`)}else if(s.dtype==="int32"&&(k<0||k>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${k}.`);p===1?(y[0]=k*v,y[1]=k*v,y[2]=k*v):y[C]=k*v}const $=x*4;m[$+0]=Math.round(y[0]),m[$+1]=Math.round(y[1]),m[$+2]=Math.round(y[2]),m[$+3]=Math.round(y[3])}o.width=h,o.height=f;const b=new ImageData(m,h,f);return d.putImageData(b,0,0),s}const zX={kernelName:xV,backendName:"cpu",kernelFunc:_X};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kf(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,keepDims:i}=r;fe(s,"sum");let a;s.dtype==="bool"?a=li({inputs:{x:s},backend:n,attrs:{dtype:"int32"}}):a=Ks({inputs:{x:s},backend:n});const l=a.shape.length,u=De(o,a.shape),c=It(u,l);let d=u,f=a;c!=null&&(f=Hn({inputs:{x:a},backend:n,attrs:{perm:c}}),d=Ot(d.length,l)),fn("sum",d,f.shape.length);const[h,p]=sn(f.shape,d),g=sr(f.dtype,"int32");let v=Up(n,h,g);const m=q(p),b=n.data.get(v.dataId).values,x=n.data.get(f.dataId).values;for(let y=0;y<b.length;++y){const $=y*m;let C=0;for(let k=0;k<m;++k)C+=x[$+k];b[y]=C}if(i){const y=Vt(v.shape,u),$=v;v=lt({inputs:{x:v},backend:n,attrs:{shape:y}}),n.disposeIntermediateTensorInfo($)}return n.disposeIntermediateTensorInfo(a),c!=null&&n.disposeIntermediateTensorInfo(f),v}const VX={kernelName:Ag,backendName:"cpu",kernelFunc:kf};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BX(t){const{inputs:e,backend:n,attrs:r}=t,{equation:s}=r,o=e,{allDims:i,summedDims:a,idDims:l}=Gw(s,o.length);jw(i.length,l,o);const{path:u,steps:c}=Kw(a,l),d=c.length;let f=null,h=i.length;const p=[];for(let g=0;g<d;++g){for(const v of c[g]){const{permutationIndices:m,expandDims:b}=Hw(h,l[v]);let x;Xw(m)?x=o[v]:(x=Hn({inputs:{x:o[v]},backend:n,attrs:{perm:m}}),p.push(x));const y=x.shape.slice();for(let $=0;$<b.length;++$)y.splice(b[$],0,1);Ye(x.shape,y)||(x=lt({inputs:{x},backend:n,attrs:{shape:y}}),p.push(x)),f===null?f=x:(f=u0({inputs:{a:x,b:f},backend:n}),p.push(f))}g<d-1&&(u[g]>=0&&(f=kf({inputs:{x:f},backend:n,attrs:{axis:u[g]-(i.length-h),keepDims:!1}}),p.push(f)),h--)}for(const g of p)g!==f&&n.disposeIntermediateTensorInfo(g);return f}const WX={kernelName:v1,backendName:"cpu",kernelFunc:BX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UX(t){const{inputs:e,backend:n}=t,{dy:r,y:s}=e;fe([r,s],"eluGrad");const o=new Float32Array(q(s.shape)),i=n.data.get(s.dataId).values,a=n.data.get(r.dataId).values;for(let l=0;l<i.length;++l){const u=i[l];u>=0?o[l]=a[l]:o[l]=a[l]*(u+1)}return n.makeTensorInfo(s.shape,"float32",o)}const GX={kernelName:b1,backendName:"cpu",kernelFunc:UX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HX=Mw,jX=_w,KX=zw,XX=Vw,qX=Bw,YX=Ww,QX=nt(Id,t=>{const e=Math.sign(t),n=Math.abs(t),r=1/(1+HX*n);return e*(1-((((YX*r+qX)*r+XX)*r+KX)*r+jX)*r*Math.exp(-n*n))}),ZX={kernelName:Id,backendName:"cpu",kernelFunc:QX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jp(t){const{inputs:e,backend:n,attrs:r}=t,{input:s}=e,{dim:o}=r,i=s.shape.length,a=s.shape.slice();let l=o;return o<0&&(D(-(i+1)<=o,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),l=i+o+1),a.splice(l,0,1),lt({inputs:{x:s},backend:n,attrs:{shape:a}})}const JX={kernelName:tg,backendName:"cpu",kernelFunc:jp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eq=Mt((t,e)=>t/e),I$=Qt(kd,eq),cx={kernelName:kd,backendName:"cpu",kernelFunc:I$};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XP(t,e,n){const r=t.shape,s=r[0],o=r[1],i=n.data.get(t.dataId),a=i.complexTensorInfos.real,l=i.complexTensorInfos.imag,u=[s,o],c=q(u),d=bn("float32",c),f=bn("float32",c);for(let v=0;v<s;v++){const m=ha({inputs:{x:a},backend:n,attrs:{begin:[v,0],size:[1,o]}}),b=ha({inputs:{x:l},backend:n,attrs:{begin:[v,0],size:[1,o]}}),x=Qn({inputs:{real:m,imag:b},backend:n}),{real:y,imag:$}=tq(x,e,n),C=bo(y,$);for(let k=0;k<o;k++){const w=Uw(C,k);d[v*o+k]=w.real,f[v*o+k]=w.imag}n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(x)}const h=n.makeTensorInfo(u,"float32",d),p=n.makeTensorInfo(u,"float32",f),g=Qn({inputs:{real:h,imag:p},backend:n});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),g}function tq(t,e,n){const r=q(t.shape),s=n.data.get(t.dataId),o=n.data.get(s.complexTensorInfos.real.dataId).values,i=n.data.get(s.complexTensorInfos.imag.dataId).values;if(nq(r)){const a=dx(o,i,r,e,n),l=[t.shape[0],t.shape[1]];if(e){const u=n.makeTensorInfo(l,"float32",a.real),c=n.makeTensorInfo(l,"float32",a.imag),d=n.makeTensorInfo([],"float32",hi(r,"float32")),f=Ks({inputs:{x:d},backend:n}),h=cx.kernelFunc({inputs:{a:u,b:d},backend:n}),p=cx.kernelFunc({inputs:{a:c,b:f},backend:n}),g=n.data.get(h.dataId).values,v=n.data.get(p.dataId).values;return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),{real:g,imag:v}}return a}else{const a=bo(o,i),l=rq(a,r,e);return aD(l)}}function nq(t){return(t&t-1)===0}function dx(t,e,n,r,s){if(n===1)return{real:t,imag:e};const o=bo(t,e),i=n/2,a=lD(o),l=a.real,u=a.imag,c=[l.length],d=s.makeTensorInfo(c,"float32",l),f=s.makeTensorInfo(c,"float32",u),h=Qn({inputs:{real:d,imag:f},backend:s}),p=uD(o),g=p.real,v=p.imag,m=[g.length],b=s.makeTensorInfo(m,"float32",g),x=s.makeTensorInfo(m,"float32",v),y=Qn({inputs:{real:b,imag:x},backend:s}),$=dx(l,u,i,r,s),C=$.real,k=$.imag,w=[C.length],I=s.makeTensorInfo(w,"float32",C),N=s.makeTensorInfo(w,"float32",k),E=Qn({inputs:{real:I,imag:N},backend:s}),R=dx(g,v,i,r,s),S=R.real,T=R.imag,F=[S.length],L=s.makeTensorInfo(F,"float32",S),G=s.makeTensorInfo(F,"float32",T),P=Qn({inputs:{real:L,imag:G},backend:s}),z=dD(n,r),U=[z.real.length],K=s.makeTensorInfo(U,"float32",z.real),Q=s.makeTensorInfo(U,"float32",z.imag),Z=Qn({inputs:{real:K,imag:Q},backend:s}),te=u0({inputs:{a:Z,b:P},backend:s}),J=jl({inputs:{a:E,b:te},backend:s}),re=k$({inputs:{a:E,b:te},backend:s}),le=fa({inputs:{input:J},backend:s}),pe=fa({inputs:{input:re},backend:s}),oe=Kl({inputs:{input:J},backend:s}),xe=Kl({inputs:{input:re},backend:s}),$e=Xl({inputs:[le,pe],backend:s,attrs:{axis:0}}),Oe=Xl({inputs:[oe,xe],backend:s,attrs:{axis:0}}),We=s.data.get($e.dataId).values,Qe=s.data.get(Oe.dataId).values;return s.disposeIntermediateTensorInfo(d),s.disposeIntermediateTensorInfo(f),s.disposeIntermediateTensorInfo(h),s.disposeIntermediateTensorInfo(b),s.disposeIntermediateTensorInfo(x),s.disposeIntermediateTensorInfo(y),s.disposeIntermediateTensorInfo(I),s.disposeIntermediateTensorInfo(N),s.disposeIntermediateTensorInfo(E),s.disposeIntermediateTensorInfo(L),s.disposeIntermediateTensorInfo(G),s.disposeIntermediateTensorInfo(P),s.disposeIntermediateTensorInfo(K),s.disposeIntermediateTensorInfo(Q),s.disposeIntermediateTensorInfo(Z),s.disposeIntermediateTensorInfo(te),s.disposeIntermediateTensorInfo(J),s.disposeIntermediateTensorInfo(re),s.disposeIntermediateTensorInfo(le),s.disposeIntermediateTensorInfo(oe),s.disposeIntermediateTensorInfo(pe),s.disposeIntermediateTensorInfo(xe),s.disposeIntermediateTensorInfo($e),s.disposeIntermediateTensorInfo(Oe),{real:We,imag:Qe}}function rq(t,e,n){const r=new Float32Array(e*2);for(let s=0;s<e;s++){let o=0,i=0;for(let a=0;a<e;a++){const l=fD(s*a,e,n),u=Uw(t,a);o+=u.real*l.real-u.imag*l.imag,i+=u.real*l.imag+u.imag*l.real}n&&(o/=e,i/=e),cD(r,o,i,s)}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sq(t){const{inputs:e,backend:n}=t,{input:r}=e,s=q(r.shape),o=r.shape[r.shape.length-1],i=s/o,a=lt({inputs:{x:r},backend:n,attrs:{shape:[i,o]}}),l=XP(a,!1,n),u=lt({inputs:{x:l},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),u}const oq={kernelName:x1,backendName:"cpu",kernelFunc:sq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T$(t){const{backend:e,attrs:n}=t,{shape:r,value:s,dtype:o}=n,i=o||nu(s),a=At(i,q(r));return aq(a,s,i),e.makeTensorInfo(r,i,a)}const iq={kernelName:y1,backendName:"cpu",kernelFunc:T$};function aq(t,e,n){t.fill(e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lq={kernelName:w1,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,s=n,o=bn(r.dtype,q(r.shape)),[i,a,l,u]=r.shape,c=s.data.get(r.dataId).values;for(let f=0;f<i;f++){const h=f*l*a*u;for(let p=0;p<a;p++){const g=p*(l*u);for(let v=0;v<l;v++){const m=v*u;for(let b=0;b<u;b++){const x=Math.round(l-v-1),y=h+g+m+b;let $=c[y];if(x>=0&&x<l){const C=x*u,k=h+g+C+b;$=c[k]}o[y]=$}}}}return{dataId:s.write(o,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uq(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o,bias:i,preluActivationWeights:a}=e,{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:f,activation:h,leakyreluAlpha:p}=r;let g=jP({inputs:{x:s,filter:o},backend:n,attrs:{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:f}});if(i){const v=g;if(c==="NCHW"&&i.shape.length===1&&i.shape[0]!==1){const m=lt({inputs:{x:i},backend:n,attrs:{shape:[i.shape[0],1,1]}});g=jl({inputs:{a:g,b:m},backend:n}),n.disposeIntermediateTensorInfo(m)}else g=jl({inputs:{a:g,b:i},backend:n});n.disposeIntermediateTensorInfo(v)}if(h){const v=g;if(c==="NCHW"&&h==="prelu"&&a.shape.length===1&&a.shape[0]!==1){const m=lt({inputs:{x:a},backend:n,attrs:{shape:[a.shape[0],1,1]}});g=Hp(n,g,h,m,p),n.disposeIntermediateTensorInfo(m)}else g=Hp(n,g,h,a,p);n.disposeIntermediateTensorInfo(v)}return g}const cq={kernelName:Sp,backendName:"cpu",kernelFunc:uq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dq(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o,bias:i,preluActivationWeights:a}=e,{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:f,activation:h,leakyreluAlpha:p}=r;let g=KP({inputs:{x:s,filter:o},backend:n,attrs:{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:f}});if(i){const v=g;g=jl({inputs:{a:g,b:i},backend:n}),n.disposeIntermediateTensorInfo(v)}if(h){const v=g;g=Hp(n,g,h,a,p),n.disposeIntermediateTensorInfo(v)}return g}const fq={kernelName:FN,backendName:"cpu",kernelFunc:dq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hq(t){const{inputs:e,backend:n}=t,{params:r,indices:s}=e,o=q(r.shape),i=s.shape,a=i[i.length-1],[l,u,c,d]=Iw(r,s);if(u===0)return n.makeTensorInfo(l,r.dtype,[]);const f=n.data.get(s.dataId).values,h=n.bufferSync(r),p=sP(f,h,r.dtype,u,a,c,d,r.shape,o);return n.makeTensorInfo(l,r.dtype,p.values)}const pq={kernelName:mN,backendName:"cpu",kernelFunc:hq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mq(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,indices:o}=e,{axis:i,batchDims:a}=r;fe([s,o],"gatherV2");const l=De(i,s.shape)[0],u=n.data.get(o.dataId).values,c=s.shape[l];for(let y=0;y<u.length;++y){const $=u[y];D($<=c-1&&$>=0,()=>`GatherV2: the index value ${$} is not in [0, ${c-1}]`)}let d=a;a==null&&(d=0);const f=q(o.shape),h=Yw(s,o,l,d),p=lt({inputs:{x:s},backend:n,attrs:{shape:[h.batchSize,h.outerSize,h.dimSize,h.sliceSize]}}),g=lt({inputs:{x:o},backend:n,attrs:{shape:[h.batchSize,f/h.batchSize]}}),v=[h.batchSize,h.outerSize,f/h.batchSize,h.sliceSize],m=n.bufferSync(g),b=n.bufferSync(p),x=oP(b,m,v);return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),n.makeTensorInfo(h.outputShape,x.dtype,x.values)}const gq={kernelName:rg,backendName:"cpu",kernelFunc:mq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vq(t){const{inputs:e,backend:n}=t,{input:r}=e,s=q(r.shape),o=r.shape[r.shape.length-1],i=s/o,a=lt({inputs:{x:r},backend:n,attrs:{shape:[i,o]}}),l=XP(a,!0,n),u=lt({inputs:{x:l},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),u}const bq={kernelName:$1,backendName:"cpu",kernelFunc:vq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xq=nt(Fd,t=>Number.isFinite(t)?1:0,"bool"),yq={kernelName:Fd,backendName:"cpu",kernelFunc:xq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wq=nt(Pd,t=>Math.abs(t)===1/0?1:0,"bool"),$q={kernelName:Pd,backendName:"cpu",kernelFunc:wq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cq=nt(Od,t=>Number.isNaN(t)?1:0,"bool"),kq={kernelName:Od,backendName:"cpu",kernelFunc:Cq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sq(t){const{backend:e,attrs:n}=t,{start:r,stop:s,num:o}=n,i=cP(r,s,o);return e.makeTensorInfo([i.length],"float32",i)}const Iq={kernelName:gN,backendName:"cpu",kernelFunc:Sq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tq=nt(Md,t=>Math.log1p(t)),Eq={kernelName:Md,backendName:"cpu",kernelFunc:Tq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nq=Mt((t,e)=>t&&e),Rq=Qt(lg,Nq,null,"bool"),Dq={kernelName:lg,backendName:"cpu",kernelFunc:Rq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Aq=nt(ug,t=>t?0:1,"bool"),Fq={kernelName:ug,backendName:"cpu",kernelFunc:Aq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pq=Mt((t,e)=>t||e),Oq=Qt(cg,Pq,null,"bool"),Lq={kernelName:cg,backendName:"cpu",kernelFunc:Oq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mq(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{depthRadius:o,bias:i,alpha:a,beta:l}=r;fe(s,"LRN");const u=s.shape[3],c=u-1,d=n.data.get(s.dataId).values,f=q(s.shape),h=new Float32Array(f);function p(g){const v=g%u;let m=g-v+Math.max(0,v-o);const b=g-v+Math.min(v+o,c);let x=0;for(;m<=b;m++){const y=d[m];x+=y*y}return x}for(let g=0;g<f;g++){const v=p(g),m=d[g]*Math.pow(i+a*v,-l);h[g]=m}return n.makeTensorInfo(s.shape,s.dtype,h)}const _q={kernelName:dg,backendName:"cpu",kernelFunc:Mq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zq(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,y:o,dy:i}=e,{depthRadius:a,bias:l,alpha:u,beta:c}=r;fe(i,"LRNGrad");const d=q(i.shape),f=i.shape[3],h=n.data.get(i.dataId).values,p=n.data.get(s.dataId).values,g=n.data.get(o.dataId).values,v=new Float32Array(d),m=d;for(let b=0;b<m;b++){const x=b%f,y=b-x+Math.max(0,x-a),$=b-x+Math.min(f,x+a+1);let C=0;for(let k=y;k<$;k++)C+=Math.pow(p[k],2);C=u*C+l;for(let k=y;k<$;k++){let w=-2*u*c*p[k]*g[b]/C;b===k&&(w+=Math.pow(C,-c)),w*=h[b],v[k]+=w}}return n.makeTensorInfo(i.shape,s.dtype,v)}const Vq={kernelName:k1,backendName:"cpu",kernelFunc:zq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qP(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{reductionIndices:o,keepDims:i}=r,a=n;let l=s.shape;const u=l.length,c=De(o,l);let d=c;const f=It(d,u);let h=a.data.get(s.dataId).values;if(f!=null){const y=new Array(u);for(let $=0;$<y.length;$++)y[$]=l[f[$]];h=$$(h,l,s.dtype,f,y),d=Ot(d.length,u),l=y}fe(s,"max"),fn("max",d,u);const[p,g]=sn(l,d),v=q(g),m=fP(h,v,p,s.dtype),b=a.write(m,p,s.dtype);let x=p;return i&&(x=Vt(p,c)),{dataId:b,shape:x,dtype:s.dtype}}const Bq={kernelName:fg,backendName:"cpu",kernelFunc:qP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wq(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;fe(s,"maxPool");const{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=r,u=1;D(wn(i,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const c=Zr(s.shape,o,i,u,a,l);let d;if(c.filterWidth===1&&c.filterHeight===1&&Ye(c.inShape,c.outShape))d=Ks({inputs:{x:s},backend:n});else{const f=n.data.get(s.dataId).values,h=me(s.shape),p=S$(f,s.shape,s.dtype,h,c,"max");d=n.makeTensorInfo(c.outShape,s.dtype,p.values)}return d}const Uq={kernelName:hg,backendName:"cpu",kernelFunc:Wq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gq(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:o,strides:i,pad:a,dimRoundingMode:l,dataFormat:u}=r;fe(s,"maxPool3d");const c=$o(s.shape,o,i,1,a,l,u),d=n.data.get(s.dataId).values,f=HP(d,s.shape,s.dtype,me(s.shape),c,"max");return n.makeTensorInfo(f.shape,"float32",f.values)}const Hq={kernelName:pg,backendName:"cpu",kernelFunc:Gq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jq(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:o}=e,{filterSize:i,strides:a,pad:l,dimRoundingMode:u}=r;fe([s,o],"maxPool3DGrad");const c=$o(o.shape,i,a,1,l,u),d=n.bufferSync(o),f=P9(d,c),h=c.strideDepth,p=c.strideHeight,g=c.strideWidth,v=c.dilationDepth,m=c.dilationHeight,b=c.dilationWidth,x=c.effectiveFilterDepth,y=c.effectiveFilterHeight,$=c.effectiveFilterWidth,C=x-1-c.padInfo.front,k=$-1-c.padInfo.left,w=y-1-c.padInfo.top,I=Re(o.shape,"float32"),N=n.bufferSync(s);for(let E=0;E<c.batchSize;++E)for(let R=0;R<c.inChannels;++R)for(let S=0;S<c.inDepth;++S)for(let T=0;T<c.inHeight;++T)for(let F=0;F<c.inWidth;++F){const L=S-C,G=T-w,P=F-k;let z=0;for(let U=0;U<x;U+=v){const K=(L+U)/h;if(!(K<0||K>=c.outDepth||Math.floor(K)!==K))for(let Q=0;Q<y;Q+=m){const Z=(G+Q)/p;if(!(Z<0||Z>=c.outHeight||Math.floor(Z)!==Z))for(let te=0;te<$;te+=b){const J=(P+te)/g;if(J<0||J>=c.outWidth||Math.floor(J)!==J)continue;const re=x*y*$-1-f.get(E,K,Z,J,R),le=U*y*$+Q*$+te,pe=re===le?1:0;if(pe===0)continue;const oe=N.get(E,K,Z,J,R);z+=oe*pe}}}I.set(z,E,S,T,F,R)}return n.makeTensorInfo(I.shape,I.dtype,I.values)}const Kq={kernelName:I1,backendName:"cpu",kernelFunc:jq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xq(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:o,output:i}=e,a=o;fe([o,i],"maxPoolGrad");const{filterSize:l,strides:u,pad:c,dimRoundingMode:d}=r,f=Zr(a.shape,l,u,1,c,d),h=n.data.get(a.dataId).values,p=Re(f.outShape,a.dtype,GP(h,a.shape,a.dtype,f).values),g=f.strideHeight,v=f.strideWidth,m=f.dilationHeight,b=f.dilationWidth,x=f.effectiveFilterHeight,y=f.effectiveFilterWidth,$=y-1-f.padInfo.left,C=x-1-f.padInfo.top,k=Re(a.shape,"float32"),w=n.data.get(s.dataId).values,I=Re(s.shape,"float32",w);for(let N=0;N<f.batchSize;++N)for(let E=0;E<f.inChannels;++E)for(let R=0;R<f.inHeight;++R)for(let S=0;S<f.inWidth;++S){const T=R-C,F=S-$;let L=0;for(let G=0;G<x;G+=m){const P=(T+G)/g;if(!(P<0||P>=f.outHeight||Math.floor(P)!==P))for(let z=0;z<y;z+=b){const U=(F+z)/v;if(U<0||U>=f.outWidth||Math.floor(U)!==U)continue;const K=x*y-1-p.get(N,P,U,E),Q=G*y+z,Z=K===Q?1:0;if(Z===0)continue;const te=I.get(N,P,U,E);L+=te*Z}}k.set(L,N,R,S,E)}return n.makeTensorInfo(k.shape,k.dtype,k.values)}const qq={kernelName:S1,backendName:"cpu",kernelFunc:Xq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yq(t,e,n,r,s){const o=me(e),i=S$(t,e,n,o,s,"max"),a=GP(t,e,n,s,!0,r);return[i.values,a.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qq={kernelName:vN,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{filterSize:s,strides:o,pad:i,includeBatchInIndex:a}=e,l=n;fe(r,"MaxPoolWithArgmax");const u=l.data.get(r.dataId).values,c=Zr(r.shape,s,o,[1,1],i),[d,f]=Yq(u,r.shape,r.dtype,a,c),h=l.write(d,c.outShape,r.dtype),p=l.write(f,c.outShape,r.dtype);return[{dataId:h,shape:c.outShape,dtype:r.dtype},{dataId:p,shape:c.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zq(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,keepDims:i}=r,a=De(o,s.shape),u=sn(s.shape,a)[1],c=q(u),d=[],f=n.makeTensorInfo([],"float32",new Float32Array([c]));d.push(f);const h=li({inputs:{x:s},backend:n,attrs:{dtype:"float32"}});d.push(h);const p=I$({inputs:{a:h,b:f},backend:n});d.push(p);const g=kf({inputs:{x:p},backend:n,attrs:{axis:o,keepDims:i}});return d.forEach(v=>n.disposeIntermediateTensorInfo(v)),g}const Jq={kernelName:mg,backendName:"cpu",kernelFunc:Zq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eY(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,keepDims:i}=r;fe(s,"min");const a=De(o,s.shape);let l=a;const u=It(l,s.shape.length);let c=s;u!=null&&(c=Hn({inputs:{x:s},backend:n,attrs:{perm:u}}),l=Ot(l.length,s.shape.length)),fn("min",l,c.shape.length);const[d,f]=sn(c.shape,l),h=q(f),p=xn(q(d),c.dtype),g=n.data.get(c.dataId).values;for(let m=0;m<p.length;++m){const b=m*h;let x=g[b];for(let y=0;y<h;++y){const $=g[b+y];(Number.isNaN($)||$<x)&&(x=$)}p[m]=x}u!=null&&n.disposeIntermediateTensorInfo(c);const v=n.makeTensorInfo(d,c.dtype,p);if(i){const m=Vt(d,a),b=lt({inputs:{x:v},backend:n,attrs:{shape:m}});return n.disposeIntermediateTensorInfo(v),b}return v}const tY={kernelName:gg,backendName:"cpu",kernelFunc:eY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nY(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{paddings:o,mode:i}=r;fe(s,"mirrorPad");const a=o.map((x,y)=>x[0]+s.shape[y]+x[1]),l=o.map(x=>x[0]),u=o.map((x,y)=>x[0]+s.shape[y]),c=i==="reflect"?0:1,d=n.data.get(s.dataId).values,f=s.shape.length,h=me(s.shape),p=q(a),g=a.length,v=me(a),m=bn(s.dtype,p);for(let x=0;x<p;x++){let y=ru(x,g,v);for(let C=0;C<g;C++)y[C]<l[C]?y[C]=l[C]*2-y[C]-c:y[C]>=u[C]&&(y[C]=(u[C]-1)*2-y[C]+c);y=y.map((C,k)=>C-l[k]);const $=Ms(y,f,h);m[x]=d[$]}return{dataId:n.write(m,a,s.dtype),shape:a,dtype:s.dtype}}const rY={kernelName:vg,backendName:"cpu",kernelFunc:nY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sY=Mt((t,e)=>{const n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e}),oY=Qt(Vd,sY),iY={kernelName:Vd,backendName:"cpu",kernelFunc:oY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YP(t){const{inputs:e,backend:n,attrs:r}=t,{logits:s}=e,{dim:o}=r,i=s.shape.length;let a=o;if(a===-1&&(a=i-1),a!==i-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${i} and dim was ${a}`);const l=De([a],s.shape),u=qP({inputs:{x:s},backend:n,attrs:{reductionIndices:l,keepDims:!1}}),c=Vt(u.shape,l),d=lt({inputs:{x:u},backend:n,attrs:{shape:c}}),f=k$({inputs:{a:s,b:d},backend:n}),h=eP({inputs:{x:f},backend:n}),p=kf({inputs:{x:h},backend:n,attrs:{axis:l,keepDims:!1}}),g=lt({inputs:{x:p},backend:n,attrs:{shape:c}}),v=I$({inputs:{a:h,b:g},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),v}const aY={kernelName:Og,backendName:"cpu",kernelFunc:YP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lY(t){const{inputs:e,backend:n,attrs:r}=t,{logits:s}=e,{numSamples:o,seed:i,normalized:a}=r;fe(s,"multinomial");const l=a?s:YP({inputs:{logits:s},backend:n,attrs:{dim:-1}}),u=l.shape[0],c=l.shape[1],d=n.data.get(l.dataId).values,f=[u,o],h=xn(q(f),"int32");for(let p=0;p<u;++p){const g=p*c,v=new Float32Array(c-1);v[0]=d[g];for(let x=1;x<v.length;++x)v[x]=v[x-1]+d[g+x];const m=fw.alea(i.toString()),b=p*o;for(let x=0;x<o;++x){const y=m();h[b+x]=v.length;for(let $=0;$<v.length;$++)if(y<v[$]){h[b+x]=$;break}}}return a||n.disposeIntermediateTensorInfo(l),n.makeTensorInfo(f,"int32",h)}const uY={kernelName:bN,backendName:"cpu",kernelFunc:lY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cY=ww;function dY(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l}=r;fe(s,"NonMaxSuppression");const u=n.data.get(s.dataId).values,c=n.data.get(o.dataId).values,{selectedIndices:d}=cY(u,c,i,a,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const fY={kernelName:T1,backendName:"cpu",kernelFunc:dY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hY=$w;function pY(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:u}=r;fe(s,"NonMaxSuppressionPadded");const c=n.data.get(s.dataId).values,d=n.data.get(o.dataId).values,{selectedIndices:f,validOutputs:h}=hY(c,d,i,a,l,u);return[n.makeTensorInfo([f.length],"int32",new Int32Array(f)),n.makeTensorInfo([],"int32",new Int32Array([h]))]}const mY={kernelName:E1,backendName:"cpu",kernelFunc:pY};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gY=Cw;function vY(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,softNmsSigma:u}=r;fe(s,"NonMaxSuppressionWithScore");const c=n.data.get(s.dataId).values,d=n.data.get(o.dataId).values,f=i,h=a,p=l,g=u,{selectedIndices:v,selectedScores:m}=gY(c,d,f,h,p,g);return[n.makeTensorInfo([v.length],"int32",new Int32Array(v)),n.makeTensorInfo([m.length],"float32",new Float32Array(m))]}const bY={kernelName:N1,backendName:"cpu",kernelFunc:vY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xY(t){const{inputs:e,backend:n,attrs:r}=t,{indices:s}=e,{dtype:o,depth:i,onValue:a,offValue:l}=r;fe(s,"oneHot");const u=q(s.shape),c=new Float32Array(u*i);c.fill(l);const d=n.data.get(s.dataId).values;for(let f=0;f<u;++f)d[f]>=0&&d[f]<i&&(c[f*i+d[f]]=a);return n.makeTensorInfo([...s.shape,i],o,c)}const yY={kernelName:wg,backendName:"cpu",kernelFunc:xY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kp(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(r.dtype==="complex64"){const s=fa({inputs:{input:r},backend:n}),o=Kp({inputs:{x:s},backend:n}),i=Kl({inputs:{input:r},backend:n}),a=Kp({inputs:{x:i},backend:n}),l=Qn({inputs:{real:o,imag:a},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),l}else return T$({backend:n,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}const wY={kernelName:_g,backendName:"cpu",kernelFunc:Kp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QP(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(r.dtype==="complex64"){const s=fa({inputs:{input:r},backend:n}),o=QP({inputs:{x:s},backend:n}),i=Kl({inputs:{input:r},backend:n}),a=Kp({inputs:{x:i},backend:n}),l=Qn({inputs:{real:o,imag:a},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),l}else return T$({backend:n,attrs:{shape:r.shape,value:1,dtype:r.dtype}})}const $Y={kernelName:yg,backendName:"cpu",kernelFunc:QP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZP(t){const{inputs:e,backend:n,attrs:r}=t,{axis:s}=r;if(e.length===1)return jp({inputs:{input:e[0]},backend:n,attrs:{dim:s}});const o=e[0].shape,i=e[0].dtype;e.forEach(c=>{Yy(o,c.shape,"All tensors passed to stack must have matching shapes"),D(i===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(c=>{const d=jp({inputs:{input:c},backend:n,attrs:{dim:s}});return a.push(d),d}),u=Xl({inputs:l,backend:n,attrs:{axis:s}});return a.forEach(c=>n.disposeIntermediateTensorInfo(c)),u}const CY={kernelName:$g,backendName:"cpu",kernelFunc:ZP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kY(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{paddings:o,constantValue:i}=r;fe(s,"pad");const a=o.map((b,x)=>b[0]+s.shape[x]+b[1]),l=o.map(b=>b[0]),u=n.data.get(s.dataId).values,c=q(s.shape),d=s.shape.length,f=me(s.shape),h=q(a),p=a.length,g=me(a),v=bn(s.dtype,h);i!==0&&v.fill(i);for(let b=0;b<c;b++){const y=ru(b,d,f).map((C,k)=>C+l[k]),$=Ms(y,p,g);v[$]=u[b]}return{dataId:n.write(v,a,s.dtype),shape:a,dtype:s.dtype}}const JP={kernelName:Cg,backendName:"cpu",kernelFunc:kY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SY=Mt((t,e)=>Math.pow(t,e)),IY=Qt(Wd,SY),TY={kernelName:Wd,backendName:"cpu",kernelFunc:IY};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EY(t){const{inputs:e,backend:n,attrs:r}=t,{paramsNestedSplits:s,paramsDenseValues:o,indices:i}=e,a=s.map(v=>n.data.get(v.dataId).values),l=s.map(v=>v.shape),u=n.data.get(o.dataId).values,c=n.data.get(i.dataId).values,[d,f,h]=bP(a,l,u,o.shape,o.dtype,c,i.shape),p=d.map(v=>n.makeTensorInfo([v.length],"int32",v)),g=n.makeTensorInfo(h,o.dtype,f);return p.concat([g])}const NY={kernelName:xN,backendName:"cpu",kernelFunc:EY};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RY(t){const{inputs:e,backend:n}=t,{starts:r,limits:s,deltas:o}=e,i=n.data.get(r.dataId).values,a=n.data.get(s.dataId).values,l=n.data.get(o.dataId).values,[u,c]=xP(i,r.shape,r.dtype,a,s.shape,l,o.shape),d=n.makeTensorInfo([u.length],"int32",u),f=n.makeTensorInfo([c.length],r.dtype,c);return[d,f]}const DY={kernelName:yN,backendName:"cpu",kernelFunc:RY};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AY(t){const{inputs:e,backend:n,attrs:r}=t,{shape:s,values:o,defaultValue:i,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=r,u=n.data.get(s.dataId).values,c=n.data.get(o.dataId).values,d=n.data.get(i.dataId).values,f=a.map(v=>n.data.get(v.dataId).values),h=a.map(v=>v.shape),[p,g]=yP(u,s.shape,c,o.shape,o.dtype,d,i.shape,f,h,l);return n.makeTensorInfo(p,o.dtype,g)}const FY={kernelName:wN,backendName:"cpu",kernelFunc:AY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PY(t){const{backend:e,attrs:n}=t,{start:r,stop:s,dtype:o,step:i}=n,a=wP(r,s,i,o);return e.makeTensorInfo([a.length],o,a)}const OY={kernelName:R1,backendName:"cpu",kernelFunc:PY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LY=nt(Ud,t=>1/t),MY={kernelName:Ud,backendName:"cpu",kernelFunc:LY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Y(t){const{inputs:e,backend:n,attrs:r}=t,{images:s}=e,{alignCorners:o,halfPixelCenters:i,size:a}=r;fe(s,"resizeBilinear");const l=me(s.shape),[u,c]=a,[d,f,h,p]=s.shape,g=n.data.get(s.dataId).values,v=new Float32Array(q([d,u,c,p])),m=[o&&u>1?f-1:f,o&&c>1?h-1:h],b=[o&&u>1?u-1:u,o&&c>1?c-1:c];let x=0;const y=m[0]/b[0],$=m[1]/b[1];for(let C=0;C<d;C++)for(let k=0;k<u;k++){let w;i?w=y*(k+.5)-.5:w=y*k;const I=Math.max(0,Math.floor(w)),N=w-I,E=Math.min(f-1,Math.ceil(w)),R=C*l[0]+I*l[1],S=C*l[0]+E*l[1];for(let T=0;T<c;T++){let F;i?F=$*(T+.5)-.5:F=$*T;const L=Math.max(0,Math.floor(F)),G=F-L,P=Math.min(h-1,Math.ceil(F)),z=R+L*l[2],U=S+L*l[2],K=R+P*l[2],Q=S+P*l[2];for(let Z=0;Z<p;Z++){const te=g[z+Z],J=g[U+Z],re=g[K+Z],le=g[Q+Z],pe=te+(re-te)*G,oe=J+(le-J)*G,xe=pe+(oe-pe)*N;v[x++]=xe}}}return n.makeTensorInfo([d,u,c,p],"float32",v)}const zY={kernelName:Eg,backendName:"cpu",kernelFunc:_Y};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VY(t){const{inputs:e,backend:n,attrs:r}=t,{images:s,dy:o}=e,{alignCorners:i}=r;fe([o,s],"resizeBilinearGrad");const a=me(s.shape),[l,u,c,d]=s.shape,[,f,h]=o.shape,p=new Float32Array(l*u*c*d),g=[i&&f>1?u-1:u,i&&h>1?c-1:c],v=[i&&f>1?f-1:f,i&&h>1?h-1:h],m=g[0]/v[0],b=g[1]/v[1],x=n.data.get(o.dataId).values;let y=0;for(let $=0;$<l;$++){const C=$*a[0];for(let k=0;k<f;k++){const w=k*m,I=Math.floor(w),N=Math.min(Math.ceil(w),u-1),E=C+I*a[1],R=C+N*a[1],S=w-I,T=1-S;for(let F=0;F<h;F++){const L=F*b,G=Math.floor(L),P=Math.min(Math.ceil(L),c-1),z=L-G,U=1-z,K=E+G*a[2],Q=E+P*a[2],Z=R+G*a[2],te=R+P*a[2],J=T*U,re=T*z,le=S*U,pe=S*z;for(let oe=0;oe<d;oe++){const xe=x[y++];p[K+oe]+=xe*J,p[Q+oe]+=xe*re,p[Z+oe]+=xe*le,p[te+oe]+=xe*pe}}}}return n.makeTensorInfo([l,c,u,d],"float32",p)}const BY={kernelName:F1,backendName:"cpu",kernelFunc:VY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WY(t){const{inputs:e,backend:n,attrs:r}=t,{images:s}=e,{alignCorners:o,halfPixelCenters:i,size:a}=r;fe(s,"resizeNearestNeighbor");const l=me(s.shape),[u,c]=a,[d,f,h,p]=s.shape,g=n.data.get(s.dataId).values,v=new Float32Array(d*u*c*p),m=[o&&u>1?f-1:f,o&&c>1?h-1:h],b=[o&&u>1?u-1:u,o&&c>1?c-1:c],x=m[0]/b[0],y=m[1]/b[1];let $=0;for(let C=0;C<d;C++){const k=C*l[0];for(let w=0;w<u;w++){const I=i?x*(w+.5):x*w;let N=Math.min(f-1,o?Math.round(I):Math.floor(I));i&&(N=Math.max(0,N));const E=k+N*l[1];for(let R=0;R<c;R++){const S=i?y*(R+.5):y*R;let T=Math.min(h-1,o?Math.round(S):Math.floor(S));i&&(T=Math.max(0,T));const F=E+T*l[2];for(let L=0;L<p;L++){const G=g[F+L];v[$++]=G}}}}return n.makeTensorInfo([d,u,c,p],s.dtype,v)}const UY={kernelName:Tg,backendName:"cpu",kernelFunc:WY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GY(t){const{inputs:e,backend:n,attrs:r}=t,{images:s,dy:o}=e,{alignCorners:i}=r;fe([o,s],"resizeNearestNeighborGrad");const a=me(s.shape),l=me(o.shape),[u,c,d,f]=s.shape,[,h,p]=o.shape,g=new Float32Array(u*c*d*f),v=n.data.get(o.dataId).values,m=[i&&h>1?c-1:c,i&&p>1?d-1:d],b=[i&&h>1?h-1:h,i&&p>1?p-1:p],x=m[0]/b[0],y=m[1]/b[1],$=1/x,C=1/y,k=Math.ceil($)*2+2,w=Math.ceil(C)*2+2;for(let I=0;I<u;I++){const N=I*a[0];for(let E=0;E<c;E++){const R=N+E*a[1],S=Math.floor(E*$),T=Math.floor(S-k/2);for(let F=0;F<d;F++){const L=R+F*a[2],G=Math.floor(F*C),P=Math.floor(G-w/2);for(let z=0;z<f;z++){let U=0;for(let K=0;K<k;K++){const Q=K+T;if(Q<0||Q>=h)continue;const Z=N+Q*l[1],te=Q*x,J=Math.min(c-1,i?Math.round(te):Math.floor(te));if(E===J)for(let re=0;re<w;re++){const le=re+P;if(le<0||le>=p)continue;const pe=Z+le*l[2],oe=le*y,xe=Math.min(d-1,i?Math.round(oe):Math.floor(oe));F===xe&&(U+=v[pe+z])}}g[L+z]=U}}}}return n.makeTensorInfo(s.shape,s.dtype,g)}const HY={kernelName:A1,backendName:"cpu",kernelFunc:GY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jY(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{dims:o}=r;fe(s,"reverse");const i=s.shape.length,a=De(o,s.shape);if(i===0)return Ks({inputs:{x:s},backend:n});const l=new cn(s.shape,s.dtype),u=n.bufferSync(s);for(let c=0;c<l.size;c++){const d=l.indexToLoc(c),f=d.slice();a.forEach(h=>f[h]=s.shape[h]-1-f[h]),l.set(u.get(...f),...d)}return n.makeTensorInfo(l.shape,l.dtype,l.values)}const KY={kernelName:Ng,backendName:"cpu",kernelFunc:jY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XY={kernelName:V1,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,{radians:s,fillValue:o,center:i}=e,a=n,l=bn(r.dtype,q(r.shape)),[u,c,d,f]=r.shape,[h,p]=Pw(i,c,d),g=255,v=Math.sin(s),m=Math.cos(s),b=a.data.get(r.dataId).values;for(let y=0;y<u;y++){const $=y*d*c*f;for(let C=0;C<c;C++){const k=C*(d*f);for(let w=0;w<d;w++){const I=w*f;for(let N=0;N<f;N++){const E=[u,C,w,N],R=E[2],S=E[1];let T=(R-h)*m-(S-p)*v,F=(R-h)*v+(S-p)*m;T=Math.round(T+h),F=Math.round(F+p);let L=o;if(typeof o!="number"&&(N===3?L=g:L=o[N]),T>=0&&T<d&&F>=0&&F<c){const P=F*(d*f),z=T*f,U=$+P+z+N;L=b[U]}const G=$+k+I+N;l[G]=L}}}}return{dataId:a.write(l,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qY=nt(jd,t=>{const e=Math.floor(t);return t-e<.5?Math.floor(t):t-e>.5?Math.ceil(t):e%2===0?e:e+1}),YY={kernelName:jd,backendName:"cpu",kernelFunc:qY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QY(t){const{inputs:e,backend:n,attrs:r}=t,{indices:s,updates:o}=e,{shape:i}=r,{sliceRank:a,numUpdates:l,sliceSize:u,strides:c,outputSize:d}=Da(o,s,i),f=!0,h=n.bufferSync(s),p=n.bufferSync(o),g=Mi(h,p,i,d,u,l,a,c,0,f);return n.makeTensorInfo(i,g.dtype,g.values)}const ZY={kernelName:$N,backendName:"cpu",kernelFunc:QY};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JY(t,e){let n=0,r=t.length,s=0;for(;n<r;)s=Math.floor((n+r)/2),t[s]<e?n=s+1:r=s;return r}function eQ(t,e){let n=0,r=t.length,s=0;for(;n<r;)s=Math.floor((n+r)/2),t[s]<=e?n=s+1:r=s;return r}function tQ(t,e,n,r,s,o){const i=At("int32",n*s);for(let a=0;a<n;++a){const l=t.slice(a*r,(a+1)*r),u=a*s;for(let c=0;c<s;++c)i[u+c]=o==="left"?JY(l,e[c+u]):eQ(l,e[c+u])}return i}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nQ(t){const{inputs:e,backend:n,attrs:r}=t,{sortedSequence:s,values:o}=e,{side:i}=r,a=n.data.get(s.dataId).values,l=n.data.get(o.dataId).values,u=tQ(a,l,s.shape[0],s.shape[1],o.shape[1],i);return n.makeTensorInfo(o.shape,"int32",u)}const rQ={kernelName:kN,backendName:"cpu",kernelFunc:nQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sQ(t){const{inputs:e,backend:n}=t,{condition:r,t:s,e:o}=e;fe([r,s,o],"select");const i=r.shape.length,a=n.data.get(r.dataId).values,l=n.data.get(s.dataId).values,u=n.data.get(o.dataId).values,c=sr(s.dtype,o.dtype),d=xn(q(s.shape),c);let f=0;const h=i===0||i>1||s.shape.length===1?1:q(s.shape.slice(1));for(let p=0;p<a.length;p++)for(let g=0;g<h;g++)a[p]===1?d[f++]=l[p]:d[f++]=u[p];return n.makeTensorInfo(s.shape,c,d)}const oQ={kernelName:Rg,backendName:"cpu",kernelFunc:sQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iQ=Yg,aQ=Qg,lQ=nt(Xd,t=>t>=0?aQ*t:iQ*(Math.exp(t)-1)),uQ={kernelName:Xd,backendName:"cpu",kernelFunc:lQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cQ=nt(Qd,t=>t<0?-1:t>0?1:0),dQ={kernelName:Qd,backendName:"cpu",kernelFunc:cQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fQ=nt(qd,t=>Math.sin(t)),hQ={kernelName:qd,backendName:"cpu",kernelFunc:fQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pQ=nt(Yd,t=>Math.sinh(t)),mQ={kernelName:Yd,backendName:"cpu",kernelFunc:pQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gQ=11920928955078125e-23,HS=Math.log(gQ)+2,vQ=nt(Jd,t=>{const e=t>-HS,n=t<HS,r=Math.exp(t);let s;return n?s=r:e?s=t:s=Math.log(1+r),s}),bQ={kernelName:Jd,backendName:"cpu",kernelFunc:vQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xQ(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockShape:o,paddings:i}=r;fe([s],"spaceToBatchND");const a=q(o),l=[[0,0]];l.push(...i);for(let C=1+o.length;C<s.shape.length;++C)l.push([0,0]);const u=JP.kernelFunc({inputs:{x:s},backend:n,attrs:{paddings:l,constantValue:0}}),c=hf(u.shape,o,a,!1),d=pf(c.length,o.length,!1),f=mf(u.shape,o,a,!1),g=lt({inputs:{x:u},backend:n,attrs:{shape:c}}),b=Hn({inputs:{x:g},backend:n,attrs:{perm:d}}),$=lt({inputs:{x:b},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(b),$}const yQ={kernelName:Fg,backendName:"cpu",kernelFunc:xQ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wQ(t){const{inputs:e,backend:n}=t,{indices:r,values:s,denseShape:o,defaultValue:i}=e;if(o.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${o.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${r.shape}`);if(s.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${s.shape}`);if(i.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${i.shape}`);const a=n.data.get(r.dataId).values,l=n.data.get(s.dataId).values,u=n.data.get(o.dataId).values,c=n.data.get(i.dataId).values[0],[d,f,h,p,g]=SP(a,r.shape,r.dtype,l,s.dtype,u,c);return[n.makeTensorInfo(f,r.dtype,d),n.makeTensorInfo([f[0]],s.dtype,h),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(v=>Number(v)))),n.makeTensorInfo([g.length],r.dtype,new Int32Array(g))]}const $Q={kernelName:SN,backendName:"cpu",kernelFunc:wQ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CQ(t){const{inputs:e,backend:n}=t,{inputIndices:r,inputShape:s,newShape:o}=e;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${r.shape}`);if(s.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${s.shape}`);if(o.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${o.shape}`);const i=Array.from(n.data.get(s.dataId).values),a=n.data.get(r.dataId).values,l=Array.from(n.data.get(o.dataId).values),[u,c,d]=IP(a,r.shape,r.dtype,i,l);return[n.makeTensorInfo(c,r.dtype,u),n.makeTensorInfo([d.length],o.dtype,new Int32Array(d))]}const kQ={kernelName:IN,backendName:"cpu",kernelFunc:CQ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SQ(t){const{inputs:e,backend:n}=t,{data:r,indices:s,segmentIds:o}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${s.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${o.shape}`);if(s.shape[0]!==o.shape[0])throw new Error("segmentIds and indices should have same size.");const i=n.data.get(r.dataId).values,a=n.data.get(s.dataId).values,l=n.data.get(o.dataId).values,[u,c]=C$(i,r.shape,r.dtype,a,l,!0);return n.makeTensorInfo(c,r.dtype,u)}const IQ={kernelName:TN,backendName:"cpu",kernelFunc:SQ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TQ(t){const{inputs:e,backend:n}=t,{data:r,indices:s,segmentIds:o}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${s.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${o.shape}`);if(s.shape[0]!==o.shape[0])throw new Error("segmentIds and indices should have same size.");const i=n.data.get(r.dataId).values,a=n.data.get(s.dataId).values,l=n.data.get(o.dataId).values,[u,c]=C$(i,r.shape,r.dtype,a,l);return n.makeTensorInfo(c,r.dtype,u)}const EQ={kernelName:EN,backendName:"cpu",kernelFunc:TQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NQ(t){const{inputs:e,backend:n,attrs:r}=t,{sparseIndices:s,sparseValues:o,defaultValue:i}=e,{outputShape:a}=r,{sliceRank:l,numUpdates:u,sliceSize:c,strides:d,outputSize:f}=Da(o,s,a),h=!1,p=n.bufferSync(s);let g;switch(o.dtype){case"bool":{const v=n.bufferSync(o),m=!!n.data.get(i.dataId).values[0];g=Mi(p,v,a,f,c,u,l,d,m,h);break}case"float32":{const v=n.bufferSync(o),m=n.data.get(i.dataId).values[0];g=Mi(p,v,a,f,c,u,l,d,m,h);break}case"int32":{const v=n.bufferSync(o),m=n.data.get(i.dataId).values[0];g=Mi(p,v,a,f,c,u,l,d,m,h);break}case"string":{const v=n.bufferSync(o),m=ri(n.data.get(i.dataId).values[0]);g=Mi(p,v,a,f,c,u,l,d,m,h);break}default:throw new Error(`Unsupported type ${o.dtype}`)}return n.makeTensorInfo(a,g.dtype,g.values)}const RQ={kernelName:NN,backendName:"cpu",kernelFunc:NQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DQ(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{numOrSizeSplits:o,axis:i}=r,a=De(i,s.shape)[0],l=qw(s,o,a),u=new Array(s.shape.length).fill(0),c=s.shape.slice();return l.map(d=>{const f=[...c];f[a]=d;const h=ha({inputs:{x:s},backend:n,attrs:{begin:u,size:f}});return u[a]+=d,h})}const AQ={kernelName:Pg,backendName:"cpu",kernelFunc:DQ};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FQ={kernelName:P1,backendName:"cpu",kernelFunc:({inputs:t,backend:e})=>{const{x:n}=t,r=e;fe(n,"square");const s=r.data.get(n.dataId).values,o=new Float32Array(s.length);for(let a=0;a<s.length;++a){const l=s[a];o[a]=l*l}return{dataId:r.write(o,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PQ=nt(af,(t,e)=>{const n=e;return isNaN(t)?NaN:t>0?1:n.alpha}),OQ={kernelName:af,backendName:"cpu",kernelFunc:PQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LQ(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{begin:o,end:i,strides:a,beginMask:l,endMask:u,ellipsisMask:c,newAxisMask:d,shrinkAxisMask:f}=r;fe(s,"stridedSlice");const{finalShapeSparse:h,finalShape:p,isIdentity:g,sliceDim0:v,isSimpleSlice:m,begin:b,end:x,strides:y}=Dw(s.shape,o,i,a,l,u,c,d,f);let $;if(g)$=lt({inputs:{x:s},backend:n,attrs:{shape:p}});else if(v||m){D(s.shape.length>=1,()=>`Input must have rank at least 1, got: ${s.shape.length}`);const C=Ew(b,x,y),k=ha({inputs:{x:s},backend:n,attrs:{begin:b,size:C}});$=lt({inputs:{x:k},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(k)}else{const C=n.bufferSync(s),k=NP(h,C,y,b);$=n.makeTensorInfo(p,k.dtype,k.values)}return $}const MQ={kernelName:L1,backendName:"cpu",kernelFunc:LQ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Q(t){const{inputs:e,backend:n,attrs:r}=t,{separator:s,nGramWidths:o,leftPad:i,rightPad:a,padWidth:l,preserveShortSequences:u}=r,{data:c,dataSplits:d}=e,f=n.data.get(c.dataId).values,h=n.data.get(d.dataId).values,[p,g]=RP(f,h,s,o,i,a,l,u);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(d.shape,"int32",g)]}const zQ={kernelName:RN,backendName:"cpu",kernelFunc:_Q};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VQ(t){const{inputs:e,backend:n,attrs:r}=t,{skipEmpty:s}=r,{input:o,delimiter:i}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(o.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${o.shape}`);if(i.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);const a=n.data.get(o.dataId).values,l=n.data.get(i.dataId).values[0],[u,c,d]=DP(a,l,s),f=c.length;return[n.makeTensorInfo([f,2],"int32",u),n.makeTensorInfo([f],"string",c),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const BQ={kernelName:DN,backendName:"cpu",kernelFunc:VQ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WQ(t){const{inputs:e,backend:n,attrs:r}=t,{numBuckets:s}=r,{input:o}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(s<=0)throw new Error("Number of buckets must be at least 1");const i=n.data.get(o.dataId).values,a=AP(i,s);return n.makeTensorInfo(o.shape,"int32",a)}const UQ={kernelName:AN,backendName:"cpu",kernelFunc:WQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GQ=nt(rf,t=>Math.tan(t)),HQ={kernelName:rf,backendName:"cpu",kernelFunc:GQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jQ=nt(sf,t=>Math.tanh(t)),KQ={kernelName:sf,backendName:"cpu",kernelFunc:jQ};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XQ(t){const{inputs:e,backend:n}=t,{tensor:r,indices:s,updates:o}=e,{sliceRank:i,numUpdates:a,sliceSize:l,strides:u,outputSize:c}=Da(o,s,r.shape),d=!1,f=n.bufferSync(s),h=n.bufferSync(o),p=n.bufferSync(r),g=Mi(f,h,r.shape,c,l,a,i,u,p,d);return n.makeTensorInfo(r.shape,g.dtype,g.values)}const qQ={kernelName:CN,backendName:"cpu",kernelFunc:XQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YQ(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{reps:o}=r;fe(s,"tile");const i=PP(n.bufferSync(s),o);return n.makeTensorInfo(i.shape,i.dtype,i.values)}const QQ={kernelName:of,backendName:"cpu",kernelFunc:YQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZQ(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{k:o,sorted:i}=r;fe(s,"topk");const a=n.data.get(s.dataId).values,[l,u]=LP(a,s.shape,s.dtype,o,i);return[n.makeTensorInfo(l.shape,l.dtype,l.values),n.makeTensorInfo(u.shape,u.dtype,u.values)]}const JQ={kernelName:M1,backendName:"cpu",kernelFunc:ZQ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eZ(t){const{inputs:e,attrs:n,backend:r}=t,{image:s,transforms:o}=e,{interpolation:i,fillMode:a,fillValue:l,outputShape:u}=n,[c,d,f,h]=s.shape,[p,g]=u??[d,f],v=[c,p,g,h],m=me(s.shape),b=m[0],x=m[1],y=m[2],$=me(v),C=$[0],k=$[1],w=$[2],I=bn(s.dtype,q(v));I.fill(l);const N=r.data.get(s.dataId).values,E=r.data.get(o.dataId).values;for(let S=0;S<c;++S){const T=o.shape[0]===1?E:E.subarray(S*8,S*8+8);for(let F=0;F<p;++F)for(let L=0;L<g;++L)for(let G=0;G<h;++G){let P;const z=T[6]*L+T[7]*F+1;if(z===0)continue;const U=(T[0]*L+T[1]*F+T[2])/z,K=(T[3]*L+T[4]*F+T[5])/z,Q=jS(U,f,a),Z=jS(K,d,a);switch(i){case"nearest":P=iZ(N,d,f,b,x,y,S,Z,Q,G,l);break;case"bilinear":P=aZ(N,d,f,b,x,y,S,Z,Q,G,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${i}`)}const te=S*C+F*k+L*w+G;I[te]=P}return r.makeTensorInfo(v,s.dtype,I)}return{dataId:r.write(I,v,s.dtype),shape:s.shape,dtype:s.dtype}}const tZ={kernelName:_1,backendName:"cpu",kernelFunc:eZ};function jS(t,e,n){switch(n){case"reflect":return nZ(t,e);case"wrap":return rZ(t,e);case"nearest":return oZ(t,e);case"constant":default:return sZ(t)}}function nZ(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const r=2*e;n<r&&(n=r*Math.trunc(-n/r)+n),n=n<-e?n+r:-n-1}else if(n>e-1)if(e<=1)n=0;else{const r=2*e;n-=r*Math.trunc(n/r),n>=e&&(n=r-n-1)}return ta(0,n,e-1)}function rZ(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const r=e-1;n+=e*(Math.trunc(-n/r)+1)}else if(n>e-1)if(e<=1)n=0;else{const r=e-1;n-=e*Math.trunc(n/r)}return ta(0,n,e-1)}function sZ(t,e){return t}function oZ(t,e){return ta(0,t,e-1)}function Zu(t,e,n,r,s,o,i,a,l,u,c){const d=i*r+a*s+l*o+u;return 0<=a&&a<e&&0<=l&&l<n?t[d]:c}function iZ(t,e,n,r,s,o,i,a,l,u,c){const d=Math.round(a),f=Math.round(l);return Zu(t,e,n,r,s,o,i,d,f,u,c)}function aZ(t,e,n,r,s,o,i,a,l,u,c){const d=Math.floor(a),f=Math.floor(l),h=d+1,p=f+1,g=(p-l)*Zu(t,e,n,r,s,o,i,d,f,u,c)+(l-f)*Zu(t,e,n,r,s,o,i,d,p,u,c),v=(p-l)*Zu(t,e,n,r,s,o,i,h,f,u,c)+(l-f)*Zu(t,e,n,r,s,o,i,h,p,u,c);return(h-a)*g+(a-d)*v}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lZ(t){const{inputs:e,attrs:n,backend:r}=t,{axis:s}=n,{x:o}=e;fe(o,"unique");const i=r.data.get(o.dataId).values,{outputValues:a,outputShape:l,indices:u}=MP(i,s,o.shape,o.dtype);return[r.makeTensorInfo(l,o.dtype,a),r.makeTensorInfo([u.length],"int32",u)]}const uZ={kernelName:z1,backendName:"cpu",kernelFunc:lZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cZ(t){const{inputs:e,backend:n,attrs:r}=t,{value:s}=e;let{axis:o}=r;o<0&&(o+=s.shape.length);const i=s.shape.length,a=s.shape[o],l=new Array(i-1);let u=0;for(let h=0;h<i;h++)h!==o&&(l[u++]=s.shape[h]);const c=new Array(i).fill(0),d=s.shape.slice();d[o]=1;const f=new Array(a);for(let h=0;h<f.length;h++){c[o]=h;const p=ha({inputs:{x:s},backend:n,attrs:{begin:c,size:d}});f[h]=lt({inputs:{x:p},backend:n,attrs:{shape:l}}),n.disposeIntermediateTensorInfo(p)}return f}const dZ={kernelName:Lg,backendName:"cpu",kernelFunc:cZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fZ(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,segmentIds:o}=e,{numSegments:i}=r;fe(s,"unsortedSegmentSum");const a=s.shape.length,l=o.shape.length,u=[],c=[],d=a-l;let f=o;for(let p=0;p<d;++p){const g=jp({inputs:{input:f},backend:n,attrs:{dim:p+1}});f=g,c.push(g)}for(let p=0;p<i;++p){const g=hi(p,"int32"),v=n.makeTensorInfo([],"int32",g),m=ZF({inputs:{a:v,b:f},backend:n}),b=li({inputs:{x:m},backend:n,attrs:{dtype:"float32"}}),x=u0({inputs:{a:b,b:s},backend:n}),y=kf({inputs:{x},backend:n,attrs:{axis:0,keepDims:!1}});u.push(y),c.push(v),c.push(m),c.push(b),c.push(x),c.push(y)}const h=ZP({inputs:u,backend:n,attrs:{axis:0}});return c.forEach(p=>n.disposeIntermediateTensorInfo(p)),h}const hZ={kernelName:Mg,backendName:"cpu",kernelFunc:fZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pZ=[l9,Wj,c9,f9,Xj,p9,g9,b9,y9,$9,k9,I9,E9,D9,F9,L9,_9,V9,W9,i9,G9,j9,X9,Yj,Y9,jj,Zj,Z9,Uj,eX,nX,rX,oX,aX,uX,dX,hX,mX,vX,xX,wX,CX,SX,TX,EX,RX,AX,PX,OX,LX,MX,zX,WX,JK,GX,Jj,ZX,eK,JX,nK,oq,iq,lq,sK,iK,cq,fq,pq,gq,lK,cK,Gj,bq,tX,yq,$q,kq,e9,fK,pK,Iq,gK,Eq,Dq,Fq,Lq,_q,Vq,Bq,bK,Uq,Hq,Kq,qq,Qq,Jq,tY,yK,rY,iY,uY,$K,kK,fY,mY,bY,IK,yY,$Y,CY,JP,TY,n9,NK,NY,DY,FY,OY,Hj,cx,MY,r9,s9,o9,zY,BY,UY,HY,KY,XY,YY,MK,ZY,rQ,oQ,uQ,zK,dQ,hQ,mQ,VK,aY,bQ,yQ,$Q,kQ,IQ,EQ,RQ,AQ,UK,FQ,HK,KK,OQ,MQ,zQ,BQ,UQ,QK,VX,HQ,KQ,qQ,QQ,JQ,tZ,TK,uZ,dZ,hZ,wY];for(const t of pZ)PN(t);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Di={},ch={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function mZ(t,e){Di[t]=e}function ys(t,e){if(!(t in Di)||e!=null){const r=vZ(t,e);if(r!==null)Di[t]=r;else return console.log("Could not get context for WebGL version",t),null}const n=Di[t];return n==null||n.isContextLost()?(delete Di[t],ys(t)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),Di[t])}function gZ(t){if(!j().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&t===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function vZ(t,e){if(t!==1&&t!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=e??gZ(t);return n.addEventListener("webglcontextlost",r=>{r.preventDefault(),delete Di[t]},!1),j().getBool("SOFTWARE_WEBGL_ENABLED")&&(ch.failIfMajorPerformanceCaveat=!1),t===1?n.getContext("webgl",ch)||n.getContext("experimental-webgl",ch):n.getContext("webgl2",ch)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Qc;(function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"})(Qc||(Qc={}));var pr;(function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"})(pr||(pr={}));var ln;(function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(ln||(ln={}));function Sf(t,e){return[e,t]}function bZ(t,e){return t*e}function dh(t){const e=q(t),n=Math.ceil(e/4);return Ab(n)}function du(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function xZ(t,e){const[n,r]=du(t,e);return n*r*4}function E$(t,e){const n=t;let r,s,o,i,a,l,u,c,d,f;return j().getNumber("WEBGL_VERSION")===2?(r=n.R32F,s=n.R16F,o=n.RGBA16F,i=n.RGBA32F,a=n.RED,u=4,c=1,d=n.HALF_FLOAT,f=n.FLOAT,l=n.RGBA8):(r=t.RGBA,s=t.RGBA,o=t.RGBA,i=n.RGBA,a=t.RGBA,u=4,c=4,d=e!=null?e.HALF_FLOAT_OES:null,f=t.FLOAT,l=t.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:s,internalFormatPackedHalfFloat:o,internalFormatPackedFloat:i,textureFormatFloat:a,downloadTextureFormat:l,downloadUnpackNumChannels:u,defaultNumChannels:c,textureTypeHalfFloat:d,textureTypeFloat:f}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ue(t,e){const n=e();return j().getBool("DEBUG")&&yZ(t),n}function yZ(t){const e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+kZ(t,e))}const wZ=596e-10,$Z=65504;function CZ(t){return!!(j().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||t===0||wZ<Math.abs(t)&&Math.abs(t)<$Z)}function kZ(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function fh(t,e){return So(t,()=>t.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function SZ(t,e){const n=So(t,()=>t.createShader(t.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(ue(t,()=>t.shaderSource(n,e)),ue(t,()=>t.compileShader(n)),t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw console.log(t.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function IZ(t,e){const n=So(t,()=>t.createShader(t.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(ue(t,()=>t.shaderSource(n,e)),ue(t,()=>t.compileShader(n)),j().get("ENGINE_COMPILE_ONLY"))return n;if(t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw eO(e,t.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}const TZ=/ERROR: [0-9]+:([0-9]+):/g;function eO(t,e){const n=TZ.exec(e);if(n==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(t);return}const r=+n[1],s=t.split(`
`),o=s.length.toString().length+2,i=s.map((d,f)=>Sl((f+1).toString(),o)+d);let a=0;for(let d=0;d<i.length;d++)a=Math.max(i[d].length,a);const l=i.slice(0,r-1),u=i.slice(r-1,r),c=i.slice(r);console.log(l.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${Sl(u[0],a)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(c.join(`
`))}function EZ(t){return So(t,()=>t.createProgram(),"Unable to create WebGLProgram.")}function NZ(t,e){if(ue(t,()=>t.linkProgram(e)),!j().get("ENGINE_COMPILE_ONLY")&&t.getProgramParameter(e,t.LINK_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function pv(t,e){if(ue(t,()=>t.validateProgram(e)),t.getProgramParameter(e,t.VALIDATE_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function RZ(t,e){const n=So(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return ue(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),ue(t,()=>t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function DZ(t,e){const n=So(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return ue(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n)),ue(t,()=>t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function AZ(t){return So(t,()=>t.createTexture(),"Unable to create WebGLTexture.")}function FZ(t,e){const n=j().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){const r=`[${t}x${e}]`;throw new Error("Requested texture size "+r+" is invalid.")}if(t>n||e>n){const r=`[${t}x${e}]`,s=`[${n}x${n}]`;throw new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+s+".")}}function PZ(t){return So(t,()=>t.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function KS(t,e,n,r,s,o,i){const a=t.getAttribLocation(e,n);return a===-1?!1:(ue(t,()=>t.bindBuffer(t.ARRAY_BUFFER,r)),ue(t,()=>t.vertexAttribPointer(a,s,t.FLOAT,!1,o,i)),ue(t,()=>t.enableVertexAttribArray(a)),!0)}function OZ(t,e,n){VZ(t,n),ue(t,()=>t.activeTexture(t.TEXTURE0+n)),ue(t,()=>t.bindTexture(t.TEXTURE_2D,e))}function LZ(t,e,n){return So(t,()=>t.getUniformLocation(e,n),'uniform "'+n+'" not present in program.')}function MZ(t,e,n){return t.getUniformLocation(e,n)}function _Z(t,e,n,r){ue(t,()=>OZ(t,e,r)),ue(t,()=>t.uniform1i(n,r))}function mv(t,e,n){ue(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,n)),ue(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0))}function XS(t,e){ue(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,e)),ue(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0))}function hh(t){const e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+zZ(t,e))}function zZ(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function So(t,e,n){const r=ue(t,()=>e());if(r==null)throw new Error(n);return r}function VZ(t,e){const n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+t.TEXTURE0;if(r<t.TEXTURE0||r>n){const s=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw new Error(`textureUnit must be in ${s}.`)}}function ql(t,e=2){return q(t.slice(0,t.length-e))}function Yl(t){if(t.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function ph(t){let e=[1,1,1];return t.length===0||t.length===1&&t[0]===1||(e=[ql(t),...Yl(t)]),e}function BZ(t,e=!1){let n=j().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=j().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");r===1/0&&j().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=n/2),e&&(n=n*2,r=r*2,t=t.map((a,l)=>l>=t.length-2?qy(t[l]):t[l]),t.length===1&&(t=[2,t[0]])),t.length!==2&&(t=fi(t).newShape);let s=q(t),o=null;t.length<=1&&s<=n?o=[1,s]:t.length===2&&t[0]<=n&&t[1]<=n?o=t:t.length===3&&t[0]*t[1]<=n&&t[2]<=n?o=[t[0]*t[1],t[2]]:t.length===3&&t[0]<=n&&t[1]*t[2]<=n?o=[t[0],t[1]*t[2]]:t.length===4&&t[0]*t[1]*t[2]<=n&&t[3]<=n?o=[t[0]*t[1]*t[2],t[3]]:t.length===4&&t[0]<=n&&t[1]*t[2]*t[3]<=n&&(o=[t[0],t[1]*t[2]*t[3]]);const i=o!=null&&Math.max(...o)>r&&Math.min(...o)<=(e?2:1)&&Math.min(...o)>0;if(o==null||i)if(e){const a=ql(t);let l=2,u=2;t.length&&([l,u]=Yl(t)),s=a*(l/2)*(u/2),o=Ab(s).map(c=>c*2)}else o=Ab(s);return o}function mh(t){return t%2===0}function Xp(t,e){if(t=t.slice(-2),e=e.slice(-2),Ye(t,e)||!t.length||!e.length||t[0]===0||t[1]===0||e[0]===0||e[1]===0)return!0;if(t.length!==e.length){const n=t[t.length-1],r=e[e.length-1];if(n===r||mh(n)&&mh(r)&&(t[0]===1||e[0]===1))return!0}return t[1]===e[1]&&mh(t[0])&&mh(e[0])}let gv,vv;function WZ(t){if(gv==null){const e=ys(t);gv=e.getParameter(e.MAX_TEXTURE_SIZE)}return gv}function UZ(t){if(vv==null){const e=ys(t);vv=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,vv)}function GZ(t){if(t===0)return 0;let e;const n=ys(t);return Hr(n,"EXT_disjoint_timer_query_webgl2")&&t===2?e=2:Hr(n,"EXT_disjoint_timer_query")?e=1:e=0,e}function Hr(t,e){return t.getExtension(e)!=null}function qS(t){try{if(ys(t)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function HZ(t){if(t===0)return!1;const e=ys(t);if(t===1){if(!Hr(e,"OES_texture_float"))return!1}else if(!Hr(e,"EXT_color_buffer_float"))return!1;return fx(e)}function jZ(t){if(t===0)return!1;const e=ys(t);if(t===1){if(!Hr(e,"OES_texture_float")||!Hr(e,"WEBGL_color_buffer_float"))return!1}else{if(Hr(e,"EXT_color_buffer_float"))return fx(e);const r="EXT_color_buffer_half_float";if(Hr(e,r)){const s=e.getExtension(r);return KZ(e,s)}return!1}return fx(e)}function fx(t){const e=E$(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);const o=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,o),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);const i=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(o),i}function KZ(t,e){const n=E$(t,e),r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r),t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);const a=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(r),t.deleteFramebuffer(i),a}function XZ(t){return t!==2?!1:ys(t).fenceSync!=null}function If(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&D(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const he=j();he.registerFlag("HAS_WEBGL",()=>he.getNumber("WEBGL_VERSION")>0);he.registerFlag("WEBGL_VERSION",()=>qS(2)?2:qS(1)?1:0);he.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);he.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>he.get("WEBGL_VERSION")===2);he.registerFlag("WEBGL_CPU_FORWARD",()=>!0);he.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);he.registerFlag("WEBGL_PACK",()=>he.getBool("HAS_WEBGL"));he.registerFlag("WEBGL_PACK_NORMALIZATION",()=>he.getBool("WEBGL_PACK"));he.registerFlag("WEBGL_PACK_CLIP",()=>he.getBool("WEBGL_PACK"));he.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>he.getBool("WEBGL_PACK"));he.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>he.getBool("WEBGL_PACK"));he.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>he.getBool("WEBGL_PACK"));he.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>he.getBool("WEBGL_PACK"));he.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>he.getBool("WEBGL_PACK"));he.registerFlag("WEBGL_PACK_REDUCE",()=>he.getBool("WEBGL_PACK"));he.registerFlag("WEBGL_LAZILY_UNPACK",()=>he.getBool("WEBGL_PACK"));he.registerFlag("WEBGL_CONV_IM2COL",()=>he.getBool("WEBGL_PACK"));he.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>he.getBool("WEBGL_PACK"));he.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>WZ(he.getNumber("WEBGL_VERSION")));he.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>UZ(he.getNumber("WEBGL_VERSION")));he.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const t=he.getNumber("WEBGL_VERSION");return t===0?0:GZ(t)});he.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>he.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!QN());he.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>HZ(he.getNumber("WEBGL_VERSION")));he.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>he.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:he.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));he.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>jZ(he.getNumber("WEBGL_VERSION")));he.registerFlag("WEBGL_FENCE_API_ENABLED",()=>XZ(he.getNumber("WEBGL_VERSION")));he.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>he.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);he.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${t}.`)});he.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>QN()?1:-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${t}.`)});he.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);he.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);he.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);he.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);he.registerFlag("WEBGL_EXP_CONV",()=>!1);he.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>he.getBool("IS_TEST"));he.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);he.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);he.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);he.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ln(){let t,e,n,r,s,o,i,a,l,u;return j().getNumber("WEBGL_VERSION")===2?(t="#version 300 es",e="in",n="out",r="in",s="texture",o="outputColor",i="out vec4 outputColor;",a=j().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",u=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(t="",e="attribute",n="varying",r="varying",s="texture2D",o="gl_FragColor",i="",a=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,u=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:t,attribute:e,varyingVs:n,varyingFs:r,texture2D:s,output:o,defineOutput:i,defineSpecialNaN:a,defineSpecialInf:l,defineRound:u}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pa(t,e,n="index"){const r=me(e);return r.map((s,o)=>{const i=`int ${t[o]} = ${n} / ${s}`,a=o===r.length-1?`int ${t[o+1]} = ${n} - ${t[o]} * ${s}`:`index -= ${t[o]} * ${s}`;return`${i}; ${a};`}).join("")}function c0(t,e,n="index"){const r=me(e);return r.map((s,o)=>{const i=`int ${t[o]} = ${n} / outShapeStrides[${o}]`,a=o===r.length-1?`int ${t[o+1]} = ${n} - ${t[o]} * outShapeStrides[${o}]`:`index -= ${t[o]} * outShapeStrides[${o}]`;return`${i}; ${a};`}).join("")}function qZ(t,e){const n=t.length,r=t.map(o=>`${e}[${o}]`),s=new Array(n-1);s[n-2]=r[n-1];for(let o=n-3;o>=0;--o)s[o]=`(${s[o+1]} * ${r[o+1]})`;return s}function YZ(t,e,n="index"){const r=t.map((o,i)=>i),s=qZ(r,e);return s.map((o,i)=>{const a=`int ${t[i]} = ${n} / ${s[i]}`,l=i===s.length-1?`int ${t[i+1]} = ${n} - ${t[i]} * ${s[i]}`:`index -= ${t[i]} * ${s[i]}`;return`${a}; ${l};`}).join("")}function N$(t){const e=me(t).map(n=>n.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function R$(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const tO=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:nO}=VG;function QZ(t,e,n){const r=[];if(t.forEach(h=>{const p=q(h.shapeInfo.logicalShape);if(h.shapeInfo.isUniform?r.push(`uniform float ${h.name}${p>1?`[${p}]`:""};`):(r.push(`uniform sampler2D ${h.name};`),r.push(`uniform int offset${h.name};`)),n.enableShapeUniforms){const{uniformShape:g}=D$(n.packedInputs,h.shapeInfo.logicalShape,h.shapeInfo.texShape);switch(g.length){case 1:r.push(`uniform int ${h.name}Shape;`);break;case 2:r.push(`uniform ivec2 ${h.name}Shape;`);break;case 3:r.push(`uniform ivec3 ${h.name}Shape;`);break;case 4:r.push(`uniform ivec4 ${h.name}Shape;`);break}r.push(`uniform ivec2 ${h.name}TexShape;`)}}),n.enableShapeUniforms){switch(e.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;");break}r.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(h=>{r.push(`uniform ${h.type} ${h.name}${h.arrayIndex?`[${h.arrayIndex}]`:""};`)});const s=r.join(`
`),o=t.map(h=>ZZ(h,e,n.packedInputs,n.enableShapeUniforms)).join(`
`),i=e.texShape,a=Ln(),l=tJ(a);let u,c,d=sJ(a);return e.isPacked?(u=JZ(e.logicalShape,i,n.enableShapeUniforms),c=rJ(a)):(u=eJ(e.logicalShape,i,n.enableShapeUniforms),c=nJ(a)),n.packedInputs&&(d+=lJ),[d,l,c,s,u,o,n.userCode].join(`
`)}function fu(t,e=!1){const n=t.shapeInfo.logicalShape;switch(n.length){case 0:return yJ(t,e);case 1:return $J(t,e);case 2:return kJ(t,e);case 3:return IJ(t,e);case 4:return EJ(t,e);case 5:return NJ(t);case 6:return RJ(t);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function rO(t,e){switch(t.shapeInfo.logicalShape.length){case 0:return xJ(t);case 1:return wJ(t,e);case 2:return CJ(t,e);case 3:return SJ(t,e);default:return TJ(t,e)}}function ZZ(t,e,n=!1,r){let s="";n?s+=rO(t,r):s+=fu(t,r);const o=t.shapeInfo.logicalShape,i=e.logicalShape;return o.length<=i.length&&(n?s+=DJ(t,e):s+=AJ(t,e)),s}function JZ(t,e,n){switch(t.length){case 0:return sO();case 1:return uJ(t,e,n);case 2:return vJ(t,e,n);case 3:return dJ(t,e,n);default:return hJ(t,e,n)}}function eJ(t,e,n){switch(t.length){case 0:return sO();case 1:return cJ(t,e,n);case 2:return bJ(t,e,n);case 3:return fJ(t,e,n);case 4:return pJ(t,e,n);case 5:return mJ(t,e);case 6:return gJ(t,e);default:throw new Error(`${t.length}-D output sampling is not yet supported`)}}function tJ(t){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${t.texture2D}(textureSampler, uv).r;
    }
  `}function nJ(t){return`
    void setOutput(float val) {
      ${t.output} = vec4(val, 0, 0, 0);
    }
  `}function rJ(t){return`
    void setOutput(vec4 val) {
      ${t.output} = val;
    }
  `}function sJ(t){return`${t.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${t.varyingFs} vec2 resultUV;
    ${t.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${t.defineSpecialNaN}
    ${t.defineSpecialInf}
    ${t.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${oJ}
    ${iJ}
    ${aJ}
  `}const oJ=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,iJ=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,aJ=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,lJ=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function sO(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function uJ(t,e,n){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return r[0]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${r[1]}.0);
      }
    `:r[1]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${r[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      return 2 * (resTexRC.x * ${r[1]} + resTexRC.y);
    }
  `}function cJ(t,e,n){return e[0]===1?n?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?n?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function dJ(t,e,n){if(n)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],s=Math.ceil(t[2]/2),o=s*Math.ceil(t[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      int b = index / ${o};
      index -= b * ${o};

      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec3(b, r, c);
    }
  `}function fJ(t,e,n){if(n)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${c0(["r","c","d"],t)}
    return ivec3(r, c, d);
  }
`;const r=Pa(["r","c","d"],t);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${r}
      return ivec3(r, c, d);
    }
  `}function hJ(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],s=Math.ceil(t[t.length-1]/2),o=s*Math.ceil(t[t.length-2]/2);let i=o,a="",l="b, r, c";for(let u=2;u<t.length-1;u++)i*=t[t.length-u-1],a=`
      int b${u} = index / ${i};
      index -= b${u} * ${i};
    `+a,l=`b${u}, `+l;return`
    ivec${t.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      ${a}

      int b = index / ${o};
      index -= b * ${o};

      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec${t.length}(${l});
    }
  `}function pJ(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${c0(["r","c","d","d2"],t)}
      return ivec4(r, c, d, d2);
    }
  `;const r=Pa(["r","c","d","d2"],t);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${r}
      return ivec4(r, c, d, d2);
    }
  `}function mJ(t,e){const n=Pa(["r","c","d","d2","d3"],t);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function gJ(t,e){const n=Pa(["r","c","d","d2","d3","d4"],t);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function vJ(t,e,n){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(Ye(t,e))return n?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${r[0]}, ${r[1]}));
      }
    `;const s=Math.ceil(t[1]/2);return n?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));

      int index = resTexRC.x * ${r[1]} + resTexRC.y;
      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec2(r, c);
    }
  `}function bJ(t,e,n){return Ye(t,e)?n?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:t[1]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:t[0]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:n?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${t[1]};
      int c = index - r * ${t[1]};
      return ivec2(r, c);
    }
  `}function Oa(t){return`offset${t}`}function xJ(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=Ln();return`
    vec4 ${n}() {
      return ${r.texture2D}(${e}, halfCR);
    }
  `}function yJ(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`float ${r}() {return ${n};}`;const[s,o]=t.shapeInfo.texShape;if(s===1&&o===1)return`
      float ${r}() {
        return sampleTexture(${n}, halfCR);
      }
    `;const i=Oa(n);if(e)return`
    float ${r}() {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${i});
      return sampleTexture(${n}, uv);
    }
  `;const[a,l]=t.shapeInfo.texShape;return`
    float ${r}() {
      vec2 uv = uvFromFlat(${a}, ${l}, ${i});
      return sampleTexture(${n}, uv);
    }
  `}function wJ(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),s=t.shapeInfo.texShape,o=Ln();if(e)return`
    vec4 ${r}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${o.texture2D}(${n}, uv);
    }
  `;const i=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)];return`
    vec4 ${r}(int index) {
      vec2 uv = packedUVfrom1D(
        ${i[0]}, ${i[1]}, index);
      return ${o.texture2D}(${n}, uv);
    }
  `}function $J(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`
      float ${r}(int index) {
        ${hu(t)}
      }
    `;const s=t.shapeInfo.texShape,o=s[0],i=s[1];if(i===1&&o===1)return`
      float ${r}(int index) {
        return sampleTexture(${n}, halfCR);
      }
    `;const a=Oa(n);return i===1?e?`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / float(${n}TexShape[0]));
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / ${o}.0);
        return sampleTexture(${n}, uv);
      }
    `:o===1?e?`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / float(${n}TexShape[1]), 0.5);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / ${i}.0, 0.5);
        return sampleTexture(${n}, uv);
      }
    `:e?`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${a});
      return sampleTexture(${n}, uv);
    }
  `:`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${o}, ${i}, index + ${a});
      return sampleTexture(${n}, uv);
    }
  `}function CJ(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),o=t.shapeInfo.texShape,i=o[0],a=o[1],l=Ln();if(o!=null&&Ye(n,o))return e?`
      vec4 ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);

        return ${l.texture2D}(${r}, uv);
      }
    `:`
      vec4 ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${a}.0, ${i}.0);

        return ${l.texture2D}(${r}, uv);
      }
    `;if(e)return`
    vec4 ${s}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `;const u=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],c=Math.ceil(n[1]/2);return`
    vec4 ${s}(int row, int col) {
      vec2 uv = packedUVfrom2D(${c}, ${u[0]}, ${u[1]}, row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `}function kJ(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),o=t.shapeInfo.texShape;if(o!=null&&Ye(n,o)){if(e)return`
      float ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `;const f=o[0],h=o[1];return`
    float ${s}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${h}.0, ${f}.0);
      return sampleTexture(${r}, uv);
    }
  `}const{newShape:i,keptDims:a}=fi(n),l=i;if(l.length<n.length){const f=pu(t,l),h=["row","col"];return`
      ${fu(f,e)}
      float ${s}(int row, int col) {
        return ${s}(${mu(h,a)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));
        ${hu(t)}
      }
    `;const u=o[0],c=o[1],d=Oa(r);return c===1?e?`
      float ${s}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${r}TexShape[0]));
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${u}.0);
      return sampleTexture(${r}, uv);
    }
  `:u===1?e?`
      float ${s}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${r}TexShape[1]), 0.5);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${c}.0, 0.5);
      return sampleTexture(${r}, uv);
    }
  `:e?`
      float ${s}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${r}Shape[1] + col + ${d};
        vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
        return sampleTexture(${r}, uv);
      }
    `:`
  float ${s}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${n[1]} + col + ${d};
    vec2 uv = uvFromFlat(${u}, ${c}, index);
    return sampleTexture(${r}, uv);
  }
`}function SJ(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),o=t.shapeInfo.texShape,i=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];if(n[0]===1){const f=n.slice(1),h=[1,2],p=pu(t,f),g=["b","row","col"];return`
        ${rO(p,e)}
        vec4 ${s}(int b, int row, int col) {
          return ${s}(${mu(g,h)});
        }
      `}const a=Ln();if(e)return`
    vec4 ${s}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${a.texture2D}(${r}, uv);
    }
  `;const l=i[0],u=i[1],c=Math.ceil(n[2]/2),d=c*Math.ceil(n[1]/2);return`
    vec4 ${s}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${u}, ${d}, ${c}, b, row, col);
      return ${a.texture2D}(${r}, uv);
    }
  `}function IJ(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),o=n[1]*n[2],i=n[2],{newShape:a,keptDims:l}=fi(n),u=a;if(u.length<n.length){const g=pu(t,u),v=["row","col","depth"];return`
        ${fu(g,e)}
        float ${s}(int row, int col, int depth) {
          return ${s}(${mu(v,l)});
        }
      `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${o}, ${i}, 1)));
        ${hu(t)}
      }
    `;const c=t.shapeInfo.texShape,d=c[0],f=c[1],h=t.shapeInfo.flatOffset;if(f===o&&h==null)return e?`
      float ${s}(int row, int col, int depth) {
        int stride1 = ${r}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
        float ${s}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${i}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${f}.0, ${d}.0);
          return sampleTexture(${r}, uv);
        }
      `;if(f===i&&h==null)return e?`
      float ${s}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${r}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${f}.0, ${d}.0);
      return sampleTexture(${r}, uv);
    }
  `;const p=Oa(r);return e?`
    float ${s}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${r}Shape[1] * ${r}Shape[2];
      int stride1 = ${r}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${p};
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
      return sampleTexture(${r}, uv);
    }
    `:`
      float ${s}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${o} + col * ${i} + depth + ${p};
        vec2 uv = uvFromFlat(${d}, ${f}, index);
        return sampleTexture(${r}, uv);
      }
  `}function TJ(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),s=Ln();if(e)return`
    vec4 ${r}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${n}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${s.texture2D}(${n}, uv);
    }
  `;const o=t.shapeInfo.logicalShape,i=o.length,a=t.shapeInfo.texShape,l=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],u=l[0],c=l[1],d=Math.ceil(o[i-1]/2);let f=d*Math.ceil(o[i-2]/2),h="int b, int row, int col",p=`b * ${f} + (row / 2) * ${d} + (col / 2)`;for(let g=2;g<i-1;g++)h=`int b${g}, `+h,f*=o[i-g-1],p=`b${g} * ${f} + `+p;return`
    vec4 ${r}(${h}) {
      int index = ${p};
      int texR = index / ${c};
      int texC = index - texR * ${c};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${c}, ${u});
      return ${s.texture2D}(${n}, uv);
    }
  `}function EJ(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),o=n[3],i=n[2]*o,a=n[1]*i,{newShape:l,keptDims:u}=fi(n);if(l.length<n.length){const b=pu(t,l),x=["row","col","depth","depth2"];return`
      ${fu(b,e)}
      float ${s}(int row, int col, int depth, int depth2) {
        return ${s}(${mu(x,u)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${a}, ${i}, ${o}, 1)));
        ${hu(t)}
      }
    `;const c=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,f=d[0],h=d[1],p=`int stride2 = ${r}Shape[3];`,g=`int stride1 = ${r}Shape[2] * stride2;`,v=`int stride0 = ${r}Shape[1] * stride1;`;if(h===a&&c==null)return e?`
      float ${s}(int row, int col, int depth, int depth2) {
        ${p}
        ${g}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${i}, ${o}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${h}.0, ${f}.0);
        return sampleTexture(${r}, uv);
      }
    `;if(h===o&&c==null)return e?`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${r}Shape[1] * ${r}Shape[2], ${r}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${n[1]*n[2]}, ${n[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${h}.0, ${f}.0);
        return sampleTexture(${r}, uv);
      }
    `;const m=Oa(r);return e?`
    float ${s}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${p}
      ${g}
      ${v}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index + ${m});
      return sampleTexture(${r}, uv);
    }
  `:`
    float ${s}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${i} +
          depth * ${o} + depth2;
      vec2 uv = uvFromFlat(${f}, ${h}, index + ${m});
      return sampleTexture(${r}, uv);
    }
  `}function NJ(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),s=e[4],o=e[3]*s,i=e[2]*o,a=e[1]*i,{newShape:l,keptDims:u}=fi(e);if(l.length<e.length){const g=pu(t,l),v=["row","col","depth","depth2","depth3"];return`
      ${fu(g)}
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        return ${r}(${mu(v,u)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${a}, ${i}, ${o}, ${s})) +
          depth3;
        ${hu(t)}
      }
    `;const c=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,f=d[0],h=d[1];if(h===a&&c==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${i}, ${o}, ${s}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${h}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(h===s&&c==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${h}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;const p=Oa(n);return`
    float ${r}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${i} + depth * ${o} +
          depth2 * ${s} + depth3 + ${p};
      vec2 uv = uvFromFlat(${f}, ${h}, index);
      return sampleTexture(${n}, uv);
    }
  `}function RJ(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:s,keptDims:o}=fi(e);if(s.length<e.length){const v=pu(t,s),m=["row","col","depth","depth2","depth3","depth4"];return`
      ${fu(v)}
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${r}(${mu(m,o)});
      }
    `}const i=e[5],a=e[4]*i,l=e[3]*a,u=e[2]*l,c=e[1]*u;if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${c}, ${u}, ${l}, ${a})) +
          dot(
            vec2(depth3, depth4),
            vec2(${i}, 1)));
        ${hu(t)}
      }
    `;const d=t.shapeInfo.flatOffset,f=t.shapeInfo.texShape,h=f[0],p=f[1];if(p===c&&d==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${u}, ${l}, ${a}, ${i})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${p}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(p===i&&d==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${p}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;const g=Oa(n);return`
    float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${c} + col * ${u} + depth * ${l} +
          depth2 * ${a} + depth3 * ${i} + depth4 + ${g};
      vec2 uv = uvFromFlat(${h}, ${p}, index);
      return sampleTexture(${n}, uv);
    }
  `}function hu(t){const e=t.name,n=q(t.shapeInfo.logicalShape);return n<2?`return ${e};`:`
    for (int i = 0; i < ${n}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function DJ(t,e){const n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),s="get"+r+"AtOutCoords",o=t.shapeInfo.logicalShape.length,i=e.logicalShape.length,a=nO(t.shapeInfo.logicalShape,e.logicalShape),l=st(i),u=i-o;let c;const d=["x","y","z","w","u","v"];o===0?c="":i<2&&a.length>=1?c="coords = 0;":c=a.map(b=>`coords.${d[b+u]} = 0;`).join(`
`);let f="";i<2&&o>0?f="coords":f=t.shapeInfo.logicalShape.map((b,x)=>`coords.${d[x+u]}`).join(", ");let h="return outputValue;";const g=q(t.shapeInfo.logicalShape)===1,m=q(e.logicalShape)===1;if(o===1&&!g&&!m)h=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(g&&!m)i===1?h=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:h=`
        return vec4(outputValue.x);
      `;else if(a.length){const b=o-2,x=o-1;a.indexOf(b)>-1&&a.indexOf(x)>-1?h="return vec4(outputValue.x);":a.indexOf(b)>-1?h="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":a.indexOf(x)>-1&&(h="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${s}() {
      ${l} coords = getOutputCoords();
      ${c}
      vec4 outputValue = get${r}(${f});
      ${h}
    }
  `}function AJ(t,e){const n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),s="get"+r+"AtOutCoords",o=e.texShape,i=t.shapeInfo.texShape,a=t.shapeInfo.logicalShape.length,l=e.logicalShape.length;if(!t.shapeInfo.isUniform&&a===l&&t.shapeInfo.flatOffset==null&&Ye(i,o))return`
      float ${s}() {
        return sampleTexture(${n}, resultUV);
      }
    `;const u=st(l),c=nO(t.shapeInfo.logicalShape,e.logicalShape),d=l-a;let f;const h=["x","y","z","w","u","v"];a===0?f="":l<2&&c.length>=1?f="coords = 0;":f=c.map(g=>`coords.${h[g+d]} = 0;`).join(`
`);let p="";return l<2&&a>0?p="coords":p=t.shapeInfo.logicalShape.map((g,v)=>`coords.${h[v+d]}`).join(", "),`
    float ${s}() {
      ${u} coords = getOutputCoords();
      ${f}
      return get${r}(${p});
    }
  `}function st(t){if(t<=1)return"int";if(t===2)return"ivec2";if(t===3)return"ivec3";if(t===4)return"ivec4";if(t===5)return"ivec5";if(t===6)return"ivec6";throw Error(`GPU for rank ${t} is not yet supported`)}function D$(t,e,n){const{newShape:r,keptDims:s}=fi(e),o=e.length,i=t&&o===3&&e[0]===1,a=i?e.slice(1):r,l=!t&&o>1&&!Ye(e,n)&&r.length<o||i;return{useSqueezeShape:l,uniformShape:l?a:e,keptDims:s}}function pu(t,e){const n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function mu(t,e){return e.map(n=>t[n]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FJ(t,e,n,r){const s=n.map((c,d)=>{const f={logicalShape:c.shape,texShape:c.isUniform?null:c.texData.texShape,isUniform:c.isUniform,isPacked:c.isUniform?!1:c.texData.isPacked,flatOffset:null};return c.texData!=null&&c.texData.slice!=null&&c.texData.slice.flatOffset>0&&(f.flatOffset=c.texData.slice.flatOffset),{name:e.variableNames[d],shapeInfo:f}}),o=s.map(c=>c.shapeInfo),i={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},a=QZ(s,i,e),l=IZ(t.gl,a),u=t.createProgram(l);return j().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:l,source:a,webGLProgram:u,inShapeInfos:o,outShapeInfo:i,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(t.buildVao(u),Object.assign({program:e,fragmentShader:l,source:a,webGLProgram:u,inShapeInfos:o,outShapeInfo:i},oO(t,e,u)))}function oO(t,e,n){const r=[],s=[];let o,i,a,l=null,u=null;u=t.getUniformLocation(n,"NAN",!1),j().getNumber("WEBGL_VERSION")===1&&(l=t.getUniformLocation(n,"INFINITY",!1));const c=!1;for(const d of e.variableNames){const f={name:d,uniform:t.getUniformLocation(n,d,c),offset:t.getUniformLocation(n,`offset${d}`,c)};e.enableShapeUniforms&&(f.shape=t.getUniformLocation(n,`${d}Shape`,c),f.texShape=t.getUniformLocation(n,`${d}TexShape`,c)),r.push(f)}if(e.enableShapeUniforms&&(o=t.getUniformLocation(n,"outShape",c),a=t.getUniformLocation(n,"outShapeStrides",c),i=t.getUniformLocation(n,"outTexShape",c)),e.customUniforms)for(const d of e.customUniforms)s.push(t.getUniformLocation(n,d.name,c));return{variablesLocations:r,customUniformLocations:s,infLoc:l,nanLoc:u,outShapeLocation:o,outShapeStridesLocation:a,outTexShapeLocation:i}}function YS(t,e){if(t.length!==e.length)throw Error(`Binary was compiled with ${t.length} inputs, but was executed with ${e.length} inputs`);t.forEach((n,r)=>{const s=n.logicalShape,o=e[r],i=o.shape;if(!Ye(s,i))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${s} and ${i} must match`);if(n.isUniform&&o.isUniform)return;const a=n.texShape,l=o.isUniform?null:o.texData.texShape;if(!Ye(a,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${a} and ${l} must match`)})}function PJ(t,e,n,r,s){e.program.enableShapeUniforms||(YS(e.inShapeInfos,n),YS([e.outShapeInfo],[r]));const o=r.texData.texture,i=r.texData.texShape;r.texData.isPacked?t.setOutputPackedMatrixTexture(o.texture,i[0],i[1]):t.setOutputMatrixTexture(o.texture,i[0],i[1]),t.setProgram(e.webGLProgram),t.bindVertexArray(e.webGLProgram.vao),j().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&t.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&t.gl.uniform1f(e.nanLoc,NaN);for(let l=0;l<n.length;++l){const u=n[l],{uniform:c,offset:d,shape:f,texShape:h}=e.variablesLocations[l];if(f){const{uniformShape:p}=D$(e.program.packedInputs,u.shape,u.texData.texShape);switch(p.length){case 1:t.gl.uniform1iv(f,new Int32Array(p));break;case 2:t.gl.uniform2iv(f,new Int32Array(p));break;case 3:t.gl.uniform3iv(f,new Int32Array(p));break;case 4:t.gl.uniform4iv(f,new Int32Array(p));break}}if(h&&t.gl.uniform2i(h,u.texData.texShape[0],u.texData.texShape[1]),c!=null){if(u.isUniform){if(q(u.shape)<2)t.gl.uniform1f(c,u.uniformValues[0]);else{let p=u.uniformValues;p instanceof Float32Array||(p=new Float32Array(p)),t.gl.uniform1fv(c,p)}continue}u.texData.slice!=null&&d!=null&&t.gl.uniform1i(d,u.texData.slice.flatOffset),t.setInputMatrixTexture(u.texData.texture.texture,c,l)}}const a=e.outShapeLocation;if(a)switch(r.shape.length){case 1:t.gl.uniform1iv(a,new Int32Array(r.shape));break;case 2:t.gl.uniform2iv(a,new Int32Array(r.shape));break;case 3:t.gl.uniform3iv(a,new Int32Array(r.shape));break;case 4:t.gl.uniform4iv(a,new Int32Array(r.shape));break}if(e.outShapeStridesLocation){const l=me(r.shape);switch(r.shape.length){case 2:t.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(l));break;case 3:t.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(l));break;case 4:t.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(l));break}}if(e.outTexShapeLocation&&t.gl.uniform2i(e.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),e.program.customUniforms&&s)for(let l=0;l<e.program.customUniforms.length;++l){const u=e.program.customUniforms[l],c=e.customUniformLocations[l],d=s[l];if(u.type==="float")t.gl.uniform1fv(c,d);else if(u.type==="vec2")t.gl.uniform2fv(c,d);else if(u.type==="vec3")t.gl.uniform3fv(c,d);else if(u.type==="vec4")t.gl.uniform4fv(c,d);else if(u.type==="int")t.gl.uniform1iv(c,d);else if(u.type==="ivec2")t.gl.uniform2iv(c,d);else if(u.type==="ivec3")t.gl.uniform3iv(c,d);else if(u.type==="ivec4")t.gl.uniform4iv(c,d);else throw Error(`uniform type ${u.type} is not supported yet.`)}t.executeProgram()}function OJ(t,e,n){let r="";e.concat(n).forEach(i=>{const a=i.texData!=null&&i.texData.slice!=null&&i.texData.slice.flatOffset>0;if(t.enableShapeUniforms&&!i.isUniform){const l=i.texData.texShape,{useSqueezeShape:u,uniformShape:c,keptDims:d}=D$(t.packedInputs,i.shape,l);let f="",h="",p="";if(c.length===1&&t.packedInputs){const $=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];f=`${$[0]>1}_${$[1]>1}`}else if(c.length===2&&!t.packedInputs)h=`${c[0]>1}_${c[1]>1}`;else if(c.length>2&&!t.packedInputs){const $=me(c);p=`${$[0]===l[1]}_${$[$.length-1]===l[1]}`}const g=i.shape.length,v=c.length===2&&Ye(i.shape,l),m=q(i.shape)===1,b=Ul(i.shape,n.shape),x=!t.packedInputs&&g===n.shape.length&&Ye(l,n.texData.texShape),y=t.packedInputs||c.length>2?"":`${l[0]>1}_${l[1]>1}`;r+=`${g}_${x}_${u?d:""}_${c.length}_${m}_${b}_${v}_${f}_${h}_${p}_${y}_${a}`}else{const l=i.isUniform?"uniform":i.texData.texShape;r+=`${i.shape}_${l}_${a}`}});const s=t.userCode;let o=t.constructor.name;return o+="_"+r+"_"+s+`${j().getNumber("WEBGL_VERSION")}`,o}function Cn(t){return j().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&t<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class LJ{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Qc.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=Ln();this.outputShape=e,this.enableShapeUniforms=Cn(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?c0(["r","c","d"],e):Pa(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class MJ{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Qc.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=Ln();this.outputShape=e,this.enableShapeUniforms=Cn(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?c0(["r","c","d"],e):Pa(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _J{constructor(e){this.variableNames=["A"],this.outTexUsage=pr.DOWNLOAD;const n=Ln();this.outputShape=e,this.userCode=`
      ${tO}

      void main() {
        float x = getAAtOutCoords();
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zJ{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=pr.DOWNLOAD;const n=Ln();this.outputShape=e,this.userCode=`
      ${tO}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VJ={R:0,G:1,B:2,A:3};class QS{constructor(e,n=!1,r="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=Ln();this.outputShape=e,this.enableShapeUniforms=Cn(this.outputShape.length);let o="result";n&&(o="floor(result * 255. + 0.5)");let i="";for(let a=0;a<r.length;a++){const l=r[a];i+=`
          if(offset == ${a}) {
            result = values[${VJ[l]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?R$():N$(e)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${r.length});

        flatIndex = idiv(flatIndex, ${r.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${s.texture2D}(A, uv);
          ${i}
        }
        ${s.output} = vec4(${o}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class BJ{constructor(e,n=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=Ln();this.outputShape=e,this.enableShapeUniforms=Cn(this.outputShape.length);let s="",o="result";n&&(o="floor(result * 255. + 0.5)");for(let i=0;i<=1;i++)for(let a=0;a<=1;a++){const l=i*2+a;s+=`
          localCoords = coords;
          if(localCoords[2] + ${a} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${a};
          if (localCoords[1] + ${i} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${i};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${r.texture2D}(A, uv);

            if (offset == 0) {
              result[${l}] = values[0];
            } else if (offset == 1) {
              result[${l}] = values[1];
            } else if (offset == 2) {
              result[${l}] = values[2];
            } else {
              result[${l}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?R$():N$(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${s}

          ${r.output} = ${o};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WJ(t){const e=Ln(),n=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return SZ(t,n)}function UJ(t){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return RZ(t,e)}function GJ(t){const e=new Uint16Array([0,1,2,2,1,3]);return DZ(t,e)}function Tf(t,e,n,r,s,o){FZ(e,n);const i=AZ(t),a=t.TEXTURE_2D;return ue(t,()=>t.bindTexture(a,i)),ue(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)),ue(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),ue(t,()=>t.texParameteri(a,t.TEXTURE_MIN_FILTER,t.NEAREST)),ue(t,()=>t.texParameteri(a,t.TEXTURE_MAG_FILTER,t.NEAREST)),j().getNumber("WEBGL_VERSION")===1?ue(t,()=>t.texImage2D(a,0,r,e,n,0,s,o,null)):ue(t,()=>t.texStorage2D(a,1,r,e,n)),ue(t,()=>t.bindTexture(t.TEXTURE_2D,null)),{texture:i,texShape:[n,e]}}function iO(t){return t.internalFormatFloat}function HJ(t,e,n,r){const[s,o]=Sf(e,n);return Tf(t,s,o,iO(r),r.textureFormatFloat,t.FLOAT)}function aO(t){return t.internalFormatHalfFloat}function jJ(t,e,n,r){const[s,o]=Sf(e,n);return Tf(t,s,o,aO(r),r.textureFormatFloat,r.textureTypeHalfFloat)}function lO(t){return t.downloadTextureFormat}function KJ(t,e,n,r){const[s,o]=Sf(e,n);return Tf(t,s,o,lO(r),t.RGBA,t.UNSIGNED_BYTE)}function uO(t){return t.internalFormatPackedFloat}function XJ(t,e,n,r){const[s,o]=du(e,n);return Tf(t,s,o,uO(r),t.RGBA,t.FLOAT)}function cO(t){return t.internalFormatPackedHalfFloat}function qJ(t,e,n,r){const[s,o]=du(e,n);return Tf(t,s,o,cO(r),t.RGBA,r.textureTypeHalfFloat)}function YJ(t,e,n){return ue(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),KS(t,e,"clipSpacePos",n,3,20,0)&&KS(t,e,"uv",n,2,20,12)}function QJ(t,e,n,r,s,o){ue(t,()=>t.bindTexture(t.TEXTURE_2D,e));let i,a,l;s instanceof Uint8Array?(i=new Uint8Array(n*r*4),a=t.UNSIGNED_BYTE,l=t.RGBA):(i=new Float32Array(n*r*4),a=t.FLOAT,l=o.internalFormatPackedFloat),i.set(s),j().getNumber("WEBGL_VERSION")===2?ue(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n,r,t.RGBA,a,i)):ue(t,()=>t.texImage2D(t.TEXTURE_2D,0,l,n,r,0,t.RGBA,a,i)),ue(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function ZJ(t,e,n){ue(t,()=>t.bindTexture(t.TEXTURE_2D,e)),n.data instanceof Uint8Array?j().getNumber("WEBGL_VERSION")===2?ue(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n.width,n.height,t.RGBA,t.UNSIGNED_BYTE,n.data)):ue(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n.width,n.height,0,t.RGBA,t.UNSIGNED_BYTE,n.data)):j().getNumber("WEBGL_VERSION")===2?ue(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,n)):ue(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n)),ue(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function JJ(t,e,n,r){const s=t.createBuffer();ue(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,s));const a=4*4*e*n;return ue(t,()=>t.bufferData(t.PIXEL_PACK_BUFFER,a,t.STREAM_READ)),ue(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,0)),ue(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,null)),s}function eee(t,e,n){const r=t,s=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,s),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),s}function tee(t,e,n,r){const[s,o]=Sf(e,n),i=4,a=new Uint8Array(bZ(e*n,i));return ue(t,()=>t.readPixels(0,0,s,o,r.downloadTextureFormat,t.UNSIGNED_BYTE,a)),new Float32Array(a.buffer)}function nee(t,e,n,r,s,o,i,a){const l=t,u=new Float32Array(xZ(o,i));return l.bindBuffer(l.PIXEL_PACK_BUFFER,e),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,u),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),u}function ree(t,e,n){const r=new Float32Array(e*n*4);return ue(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,r)),r}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bv{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const n=j().getNumber("WEBGL_VERSION");if(e!=null?(this.gl=e,mZ(n,e)):this.gl=ys(n),e=this.gl,j().getNumber("WEBGL_VERSION")===2){const o=e;this.createVertexArray=()=>ue(o,()=>o.createVertexArray()),this.bindVertexArray=i=>ue(o,()=>o.bindVertexArray(i)),this.deleteVertexArray=i=>ue(o,()=>o.deleteVertexArray(i)),this.getVertexArray=()=>ue(o,()=>o.getParameter(o.VERTEX_ARRAY_BINDING))}else if(e!=null){const o=e.getExtension("OES_vertex_array_object");if(o==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>ue(e,()=>o.createVertexArrayOES()),this.bindVertexArray=i=>ue(e,()=>o.bindVertexArrayOES(i)),this.deleteVertexArray=i=>ue(e,()=>o.deleteVertexArrayOES(i)),this.getVertexArray=()=>ue(e,()=>e.getParameter(o.VERTEX_ARRAY_BINDING_OES))}let r="WEBGL_color_buffer_float";const s="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),j().getNumber("WEBGL_VERSION")===1){const o="OES_texture_float",i="OES_texture_half_float";if(this.textureFloatExtension=fh(this.gl,o),Hr(this.gl,i))this.textureHalfFloatExtension=fh(this.gl,i);else if(j().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),Hr(this.gl,s))this.colorBufferHalfFloatExtension=fh(this.gl,s);else if(j().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",Hr(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else if(Hr(this.gl,s))this.colorBufferHalfFloatExtension=this.gl.getExtension(s);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=UJ(this.gl),this.indexBuffer=GJ(this.gl),this.framebuffer=PZ(this.gl),this.textureConfig=E$(this.gl,this.textureHalfFloatExtension)}get debug(){return j().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;ue(e,()=>e.finish()),ue(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),ue(e,()=>e.deleteFramebuffer(this.framebuffer)),ue(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),ue(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),ue(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,n){return this.throwIfDisposed(),HJ(this.gl,e,n,this.textureConfig)}createFloat16MatrixTexture(e,n){return this.throwIfDisposed(),jJ(this.gl,e,n,this.textureConfig)}createUnsignedBytesMatrixTexture(e,n){return this.throwIfDisposed(),KJ(this.gl,e,n,this.textureConfig)}uploadPixelDataToTexture(e,n){this.throwIfDisposed(),ZJ(this.gl,e,n)}uploadDenseMatrixToTexture(e,n,r,s){this.throwIfDisposed(),QJ(this.gl,e,n,r,s,this.textureConfig)}createFloat16PackedMatrixTexture(e,n){return this.throwIfDisposed(),qJ(this.gl,e,n,this.textureConfig)}createPackedMatrixTexture(e,n){return this.throwIfDisposed(),XJ(this.gl,e,n,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(XS(this.gl,this.framebuffer),this.outputTexture=null),ue(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,n,r){return this.downloadMatrixDriver(e,()=>tee(this.gl,n,r,this.textureConfig))}downloadPackedMatrixFromBuffer(e,n,r,s,o,i){return nee(this.gl,e,n,r,s,o,i,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,n){return eee(this.gl,e,n)}createBufferFromTexture(e,n,r){this.bindTextureToFrameBuffer(e);const s=JJ(this.gl,n,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),s}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let n,r;if(j().getBool("WEBGL_FENCE_API_ENABLED")){const s=e,o=s.fenceSync(s.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),r=()=>{const i=s.clientWaitSync(o,0,0);return i===s.ALREADY_SIGNALED||i===s.CONDITION_SATISFIED},n=o}else j().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),r=()=>this.isQueryAvailable(n,j().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):r=()=>!0;return{query:n,isFencePassed:r}}downloadMatrixFromPackedTexture(e,n,r){return this.downloadMatrixDriver(e,()=>ree(this.gl,n,r))}createProgram(e){this.throwIfDisposed();const n=this.gl;this.vertexShader==null&&(this.vertexShader=WJ(n));const r=EZ(n);ue(n,()=>n.attachShader(r,this.vertexShader)),ue(n,()=>n.attachShader(r,e)),NZ(n,r);const s=Object.assign(r,{vao:this.createVertexArray()});return this.debug&&pv(n,s),s}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);const n=this.gl;ue(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),YJ(n,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&(ue(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&pv(this.gl,this.program),ue(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,n,r=!0){return this.throwIfDisposed(),r?LZ(this.gl,e,n):MZ(this.gl,e,n)}getAttributeLocation(e,n){return this.throwIfDisposed(),ue(this.gl,()=>this.gl.getAttribLocation(e,n))}getUniformLocationNoThrow(e,n){return this.throwIfDisposed(),this.gl.getUniformLocation(e,n)}setInputMatrixTexture(e,n,r){this.throwIfDisposed(),this.throwIfNoProgram(),_Z(this.gl,e,n,r)}setOutputMatrixTexture(e,n,r){this.setOutputMatrixTextureDriver(e,r,n)}setOutputPackedMatrixTexture(e,n,r){this.throwIfDisposed();const[s,o]=du(n,r);this.setOutputMatrixTextureDriver(e,s,o)}setOutputMatrixWriteRegion(e,n,r,s){this.setOutputMatrixWriteRegionDriver(r,e,s,n)}setOutputPackedMatrixWriteRegion(e,n,r,s){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&pv(this.gl,this.program),hh(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const n=this.getVertexArray();console.assert(n===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}ue(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),ue(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=fh(this.gl,j().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(j().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const r=this.gl,s=this.getQueryTimerExtensionWebGL2(),o=r.createQuery();return r.beginQuery(s.TIME_ELAPSED_EXT,o),o}const e=this.getQueryTimerExtensionWebGL1(),n=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,n),n}endQuery(){if(j().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const n=this.gl,r=this.getQueryTimerExtensionWebGL2();n.endQuery(r.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await Mk(()=>this.disposed||this.isQueryAvailable(e,j().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,j().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,n){if(n===0)return null;if(n===2){const r=this.gl;return r.getQueryParameter(e,r.QUERY_RESULT)/1e6}else{const r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,n){if(n===0)return!0;if(n===2){const r=this.gl,s=this.getQueryTimerExtensionWebGL2(),o=r.getQueryParameter(e,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(s.GPU_DISJOINT_EXT)),o&&!this.disjoint}else{const r=this.getQueryTimerExtensionWebGL1(),s=r.getQueryObjectEXT(e,r.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),s&&!this.disjoint}}pollFence(e){return new Promise(n=>{this.addItemToPoll(()=>e.isFencePassed(),()=>n())})}pollItems(){const e=see(this.itemsToPoll.map(n=>n.isDoneFn));for(let n=0;n<=e;++n){const{resolveFn:r}=this.itemsToPoll[n];r()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,n){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:n}),this.itemsToPoll.length>1)return;let r;"setTimeoutCustom"in j().platform&&(r=j().platform.setTimeoutCustom.bind(j().platform)),Mk(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,r)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),mv(this.gl,e,this.framebuffer),this.debug&&hh(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(mv(this.gl,this.outputTexture,this.framebuffer),this.debug&&hh(this.gl)):XS(this.gl,this.framebuffer)}downloadMatrixDriver(e,n){this.bindTextureToFrameBuffer(e);const r=n();return this.unbindTextureToFrameBuffer(),r}setOutputMatrixTextureDriver(e,n,r){this.throwIfDisposed();const s=this.gl;mv(s,e,this.framebuffer),this.debug&&hh(s),this.outputTexture=e,ue(s,()=>s.viewport(0,0,n,r)),ue(s,()=>s.scissor(0,0,n,r))}setOutputMatrixWriteRegionDriver(e,n,r,s){this.throwIfDisposed(),ue(this.gl,()=>this.gl.scissor(e,n,r,s))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function see(t){let e=0;for(;e<t.length&&t[e]();++e);return e-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:oee,bincountImpl:dO,bincountReduceImpl:iee,bitwiseAndImpl:aee,castImpl:lee,ceilImpl:uee,concatImpl:cee,equalImpl:dee,expImpl:fee,expm1Impl:hee,floorImpl:pee,gatherNdImpl:mee,gatherV2Impl:gee,greaterImpl:vee,greaterEqualImpl:bee,lessImpl:xee,lessEqualImpl:yee,linSpaceImpl:wee,logImpl:$ee,maxImpl:Cee,maximumImpl:kee,minimumImpl:See,multiplyImpl:Iee,negImpl:Tee,notEqualImpl:Eee,prodImpl:Nee,raggedGatherImpl:Ree,raggedRangeImpl:Dee,raggedTensorToTensorImpl:Aee,rangeImpl:Fee,rsqrtImpl:Pee,scatterImpl:Oee,sigmoidImpl:Lee,simpleAbsImpl:fO,sliceImpl:Mee,sparseFillEmptyRowsImpl:_ee,sparseReshapeImpl:zee,sparseSegmentReductionImpl:hO,sqrtImpl:Vee,staticRegexReplaceImpl:Bee,stridedSliceImpl:Wee,stringNGramsImpl:Uee,stringSplitImpl:Gee,stringToHashBucketFastImpl:Hee,subImpl:jee,tileImpl:Kee,topKImpl:Xee,transposeImpl:A$,uniqueImpl:qee}=ZK;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pO(t,e){return["x","y","z","w","u","v"].slice(0,e).map(n=>`${t}.${n}`)}function Dn(t,e){return e===1?[t]:pO(t,e)}function Yee(t,e){if(t===1)return"rc";let n="";for(let r=0;r<t;r++)n+=e[r],r<t-1&&(n+=",");return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qee{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=Cn(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const n=Dn("rc",this.rank),r=st(this.rank),s=this.getOutOfBoundsCondition(n),o=this.getSetup(n),i=this.getOutput(n);this.userCode=`
        void main() {
          ${r} rc = getOutputCoords();

          if(${s}) {
            setOutput(vec4(0));
          } else {
            ${o}

            setOutput(vec4(${i}));
          }
        }
      `}}getSourceCoordsArr(e){const n=[];for(let r=0;r<=1;r++)for(let s=0;s<=1;s++){let o=`${r===0?"r":"rp1"}, ${s===0?"c":"cp1"}`;for(let i=2;i<this.rank;i++)o=`${e[e.length-1-i]},`+o;n.push(o)}return n}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let n="";for(let r=this.rank-2;r<this.rank;r++)n+=`${e[r]} >= ${this.enableShapeUniforms?`outShape[${r}]`:this.outputShape[r]}`,r<this.rank-1&&(n+="||");return n}getSetup(e){if(this.rank===1)return"";const n=e.slice(-2),r=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],s=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${n[0]};
      int c = ${n[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${r};
      bool rEdge = rp1 >= ${s};
    `}getOutput(e){const n=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${n[0]}),
            cEdge ? 0. : getA(${n[1]}),
            rEdge ? 0. : getA(${n[2]}),
            rEdge || cEdge ? 0. : getA(${n[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mO{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=Cn(this.outputShape.length);let r="";for(let s=0;s<4;s++){let o="thisRC = rc;";s%2===1&&(o+="thisRC.z += 1;"),s>1&&(o+="thisRC.y += 1;"),r+=`
        ${o}
        ${s>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${s}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${s>0?"}":""}
      `}this.userCode=`
      ${Zee(n,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?R$():N$(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${r}

        setOutput(result);
      }
    `}}function Zee(t,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?YZ(["r","c","d"],"inputShape"):Pa(["r","c","d"],t)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jee{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,n,r){const s=JS(n,r),o=eI(e,s,r);o in this.freeTextures||(this.freeTextures[o]=[]),o in this.usedTextures||(this.usedTextures[o]=[]);const i=ZS(e,s,this.gpgpu.gl,this.gpgpu.textureConfig,r);if(this.freeTextures[o].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=i,this.log();const l=this.freeTextures[o].pop();return this.usedTextures[o].push(l),l}let a;return s===ln.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):s===ln.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):s===ln.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):s===ln.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):s===ln.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[o].push(a),this.numUsedTextures++,this._numBytesAllocated+=i,this.log(),a}releaseTexture(e,n,r,s){if(this.freeTextures==null)return;const o=JS(r,s),i=eI(n,o,s);i in this.freeTextures||(this.freeTextures[i]=[]);const a=ZS(n,o,this.gpgpu.gl,this.gpgpu.textureConfig,s),l=j().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=a):(this.freeTextures[i].push(e),this.numFreeTextures++,this._numBytesFree+=a),this.numUsedTextures--;const u=this.usedTextures[i],c=u&&u.indexOf(e);if(c==null||c<0)throw new Error("Cannot release a texture that was never provided by this texture manager");u[c]=u[u.length-1],u.pop(),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const n=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*n)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function ete(t,e){const n=t;if(e===n.R32F)return 4;if(e===n.R16F)return 2;if(e===n.RGBA32F)return 16;if(e===t.RGBA)return 16;if(e===n.RGBA16F)return 8;if(e===n.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function ZS(t,e,n,r,s){const o=tte(e,r);let i;if(s){const[l,u]=du(t[0],t[1]);i=l*u}else{const[l,u]=Sf(t[0],t[1]);i=l*u}const a=ete(n,o);return i*a}function tte(t,e){switch(t){case ln.PACKED_2X2_FLOAT32:return uO(e);case ln.PACKED_2X2_FLOAT16:return cO(e);case ln.UNPACKED_FLOAT32:return iO(e);case ln.UNPACKED_FLOAT16:return aO(e);case ln.PACKED_4X1_UNSIGNED_BYTE:return lO(e);default:throw new Error(`Unknown physical texture type ${t}`)}}function nte(t){return j().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?ln.PACKED_2X2_FLOAT32:ln.UNPACKED_FLOAT32:t?ln.PACKED_2X2_FLOAT16:ln.UNPACKED_FLOAT16}function JS(t,e){if(t===pr.UPLOAD)return ln.PACKED_2X2_FLOAT32;if(t===pr.RENDER||t==null)return nte(e);if(t===pr.DOWNLOAD||t===pr.PIXELS)return ln.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${t}`)}function eI(t,e,n){return`${t[0]}_${t[1]}_${e}_${n}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ps{constructor(e,n){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=Cn(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${n}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const es="if (isnan(x)) return x;",rte="return x;",tI="return abs(x);",ste="return (x >= 0.0) ? x : (exp(x) - 1.0);",ote=es+`
  return (x < 0.0) ? 0.0 : x;
`,ite=es+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Ao="return x;",ate="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lte="return x;",ute=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,cte=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,dte=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,fte="return 1.0 / (1.0 + exp(-1.0 * x));";class zo{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=Cn(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${n}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hte{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=Cn(this.outputShape.length);const n=e.length,r=Dn("rc",n),s=st(n),o=Yee(n,r),i=r.slice(-2),a=n<=1?"rc":`vec2(${i.join(",")})`;this.userCode=`
      void main() {
        ${s} rc = getOutputCoords();
        vec4 packedInput = getA(${o});

        setOutput(getChannel(packedInput, ${a}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pte=zR,mte=1e-7,gte=1e-4,gh={};function vte(t){return t in gh||(gh[t]={}),gh[t]}const bte=j().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),xte=600;function yte(){return j().global.screen==null?1024:j().global.screen.height*j().global.screen.width*window.devicePixelRatio*xte/1024/1024}class d0 extends Xy{nextDataId(){return d0.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!j().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let n;if(e!=null){if(e instanceof bv)n=e;else{const r=ys(j().getNumber("WEBGL_VERSION"),e);n=new bv(r)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const r=ys(j().getNumber("WEBGL_VERSION"));n=new bv(r),this.binaryCache=vte(j().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=n,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new Jee(this.gpgpu),this.numMBBeforeWarning=yte(),this.texData=new oN(this,Es())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,n,r,s,o,i){const a=this.makeTensorInfo(n,r),l=this.texData.get(a.dataId);l.isPacked=!1,l.texture={texture:e,texShape:[s,o]},l.texShape=[s,o];const u=ph(n),c=new QS(u,!1,i),d=this.runWebGLProgram(c,[a],r,[[s,o]]);return d.shape=n,l.texture=null,this.disposeIntermediateTensorInfo(a),d.dataId}write(e,n,r){if((j().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||j().getBool("DEBUG"))&&this.checkNumericalProblems(e),r==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const s={id:this.nextDataId()};return this.texData.set(s,{shape:n,dtype:r,values:e,usage:pr.UPLOAD,refCount:1}),s}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const n=this.texData.get(e);n.refCount++}decRef(e){if(this.texData.has(e)){const n=this.texData.get(e);n.refCount--}}move(e,n,r,s,o){if(j().getBool("DEBUG")&&this.checkNumericalProblems(n),s==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:r,dtype:s,values:n,usage:pr.UPLOAD,refCount:o})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const n=this.texData.get(e),{values:r,dtype:s,complexTensorInfos:o,slice:i,shape:a,isPacked:l}=n;if(i!=null){let f;l?f=new zo(a,Ao):f=new Ps(a,Ao);const h=this.runWebGLProgram(f,[{dataId:e,shape:a,dtype:s}],s),p=this.readSync(h.dataId);return this.disposeIntermediateTensorInfo(h),p}if(r!=null)return this.convertAndCacheOnCPU(e);if(s==="string")return r;const u=this.activeTimers!=null;let c;u&&(c=_n());let d;if(s==="complex64"){const f=this.readSync(o.real.dataId),h=this.readSync(o.imag.dataId);d=bo(f,h)}else d=this.getValuesFromTexture(e);return u&&(this.downloadWaitMs+=_n()-c),this.convertAndCacheOnCPU(e,d)}async read(e){if(this.pendingRead.has(e)){const p=this.pendingRead.get(e);return new Promise(g=>p.push(g))}const n=this.texData.get(e),{values:r,shape:s,slice:o,dtype:i,complexTensorInfos:a,isPacked:l}=n;if(o!=null){let p;l?p=new zo(s,Ao):p=new Ps(s,Ao);const g=this.runWebGLProgram(p,[{dataId:e,shape:s,dtype:i}],i),v=this.read(g.dataId);return this.disposeIntermediateTensorInfo(g),v}if(r!=null)return this.convertAndCacheOnCPU(e);if(j().getBool("DEBUG")&&!j().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&j().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let u=null,c;if(i!=="complex64"&&j().get("WEBGL_BUFFER_SUPPORTED")){c=this.decode(e);const p=this.texData.get(c.dataId);u=this.gpgpu.createBufferFromTexture(p.texture.texture,...dh(s))}this.pendingRead.set(e,[]),i!=="complex64"&&await this.gpgpu.createAndWaitForFence();let d;if(i==="complex64"){const p=await Promise.all([this.read(a.real.dataId),this.read(a.imag.dataId)]),g=p[0],v=p[1];d=bo(g,v)}else if(u==null)d=this.getValuesFromTexture(e);else{const p=q(s);d=this.gpgpu.downloadFloat32MatrixFromBuffer(u,p)}if(c!=null&&this.disposeIntermediateTensorInfo(c),u!=null){const p=this.gpgpu.gl;ue(p,()=>p.deleteBuffer(u))}const f=this.convertAndCacheOnCPU(e,d),h=this.pendingRead.get(e);return this.pendingRead.delete(e),h.forEach(p=>p(f)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&Es().removeDataId(e,this),this.pendingDeletes--),f}readToGPU(e,n={}){const r=this.texData.get(e),{values:s,shape:o,slice:i,dtype:a,isPacked:l,texture:u}=r;if(a==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(i!=null){let h;l?h=new zo(o,Ao):h=new Ps(o,Ao);const p=this.runWebGLProgram(h,[{dataId:e,shape:o,dtype:a}],a),g=this.readToGPU(p,n);return this.disposeIntermediateTensorInfo(p),g}if(u==null)throw s!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const c=this.decode(e,n.customTexShape),d=Es().makeTensorFromTensorInfo(c),f=this.texData.get(c.dataId);return Object.assign({tensorRef:d},f.texture)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const r=n.map(s=>ri(s));return Re(e.shape,e.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Re(e.shape,e.dtype,n)}checkNumericalProblems(e){if(e!=null)for(let n=0;n<e.length;n++){const r=e[n];if(!CZ(r))throw j().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${r} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${r} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:n,dtype:r,isPacked:s}=this.texData.get(e),o=q(n);if(j().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const f=this.decode(e),h=this.texData.get(f.dataId),p=this.gpgpu.downloadMatrixFromPackedTexture(h.texture.texture,...dh(n)).subarray(0,o);return this.disposeIntermediateTensorInfo(f),p}const i=j().getBool("WEBGL_PACK")&&s===!0,a=i?ph(n):n,l=i?new zJ(a):new _J(a),u=this.runWebGLProgram(l,[{shape:a,dtype:r,dataId:e}],"float32"),c=this.texData.get(u.dataId),d=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(c.texture.texture,c.texShape[0],c.texShape[1]).subarray(0,o);return this.disposeIntermediateTensorInfo(u),d}timerAvailable(){return j().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const n=this.activeTimers,r=[];let s=!1;this.programTimersStack==null?(this.programTimersStack=r,s=!0):this.activeTimers.push(r),this.activeTimers=r,e();const o=na(this.activeTimers.map(l=>l.query)).filter(l=>l!=null),i=na(this.activeTimers.map(l=>l.name)).filter(l=>l!=null);this.activeTimers=n,s&&(this.programTimersStack=null);const a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(j().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const l=await Promise.all(o);a.kernelMs=iV(l),a.getExtraProfileInfo=()=>l.map((u,c)=>({name:i[c],ms:u})).map(u=>`${u.name}: ${u.ms}`).join(", ")}else a.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,a})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return j().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:_n(),endMs:null}}endTimer(e){return j().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=_n(),e)}async getQueryTime(e){if(j().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const n=e;return n.endMs-n.startMs}disposeData(e,n=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(n?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!n&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:r}=this.texData.get(e);return r!=null&&(this.disposeData(r.real.dataId,n),this.disposeData(r.imag.dataId,n)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:n,dtype:r,texShape:s,usage:o,isPacked:i,slice:a}=this.texData.get(e),l=a&&a.origDataId||e,u=this.dataRefCount.get(l);u>1?this.dataRefCount.set(l,u-1):(this.dataRefCount.delete(l),n!=null&&(this.numBytesInGPU-=this.computeBytes(s,r),this.textureManager.releaseTexture(n,s,o,i)));const c=this.texData.get(e);c.texture=null,c.texShape=null,c.isPacked=!1,c.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,n=bte){return j().getBool("WEBGL_CPU_FORWARD")&&e.every(r=>this.texData.get(r.dataId).texture==null&&q(r.shape)<n)}getGPGPUContext(){return this.gpgpu}where(e){fr("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const n=e.dataSync();return pte(e.shape,n)}packedUnaryOp(e,n,r){const s=new zo(e.shape,n),o=this.compileAndRun(s,[e],r);return Es().makeTensorFromTensorInfo(o)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const s=fO(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,s)}if(j().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,tI,e.dtype);const n=new Ps(e.shape,tI),r=this.compileAndRun(n,[e]);return Es().makeTensorFromTensorInfo(r)}makeTensorInfo(e,n,r){let s;if(n==="string"&&r!=null&&r.length>0&&dd(r[0])){const o=r.map(i=>Yo(i));s=this.write(o,e,n)}else s=this.write(r,e,n);return this.texData.get(s).usage=null,{dataId:s,shape:e,dtype:n}}makeOutput(e,n,r){return Es().makeTensorFromTensorInfo(this.makeTensorInfo(e,n,r),this)}unpackTensor(e){const n=new hte(e.shape);return this.runWebGLProgram(n,[e],e.dtype)}packTensor(e){const n=new Qee(e.shape);return this.runWebGLProgram(n,[e],e.dtype,null,!0)}packedReshape(e,n){const r=[ql(e.shape),...Yl(e.shape)],s={dtype:e.dtype,shape:r,dataId:e.dataId},o=[ql(n),...Yl(n)],i=new mO(o,r),a=!0,l=[r],u=this.runWebGLProgram(i,[s],e.dtype,l,a);return{dataId:u.dataId,shape:n,dtype:u.dtype}}decode(e,n){const r=this.texData.get(e),{isPacked:s,shape:o,dtype:i}=r;if(n!=null){const f=q(o),h=n[0]*n[1]*4;D(f<=h,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const a=ph(o);let l;s?l=new MJ(a):l=new LJ(a);const u=!0,c=[n??dh(a)],d=this.runWebGLProgram(l,[{shape:a,dtype:i,dataId:e}],i,c,u,n);return{dtype:i,shape:o,dataId:d.dataId}}runWebGLProgram(e,n,r,s,o=!1,i){const a=this.makeTensorInfo(e.outputShape,r),l=this.texData.get(a.dataId);if(e.packedOutput&&(l.isPacked=!0),e.outPackingScheme===Qc.DENSE){const m=i??dh(e.outputShape);l.texShape=m.map(b=>b*2)}if(e.outTexUsage!=null&&(l.usage=e.outTexUsage),q(a.shape)===0)return l.values=bn(a.dtype,0),a;const u=[],c=n.map(m=>{if(m.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let b=this.texData.get(m.dataId);if(b.texture==null){if(!e.packedInputs&&q(m.shape)<=j().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:m.shape,texData:null,isUniform:!0,uniformValues:b.values};e.packedInputs&&(b.isPacked=!0,b.shape=m.shape)}if(this.uploadToGPU(m.dataId),!!b.isPacked!=!!e.packedInputs)m=b.isPacked?this.unpackTensor(m):this.packTensor(m),u.push(m),b=this.texData.get(m.dataId);else if(b.isPacked&&!Xp(b.shape,m.shape)){const x=m,y=m.shape;m.shape=b.shape,m=this.packedReshape(m,y),u.push(m),b=this.texData.get(m.dataId),x.shape=y}return{shape:m.shape,texData:b,isUniform:!1}});this.uploadToGPU(a.dataId);const d={shape:a.shape,texData:l,isUniform:!1},f=OJ(e,c,d),h=this.getAndSaveBinary(f,()=>FJ(this.gpgpu,e,c,d)),p=this.activeTimers!=null;let g;p&&(g=this.startTimer()),j().get("ENGINE_COMPILE_ONLY")||PJ(this.gpgpu,h,c,d,s),u.forEach(m=>this.disposeIntermediateTensorInfo(m)),p&&(g=this.endTimer(g),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(g)}));const v=j().getNumber("WEBGL_FLUSH_THRESHOLD");if(v>0){const m=_n();m-this.lastGlFlushTime>v&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=m)}if(!j().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&o===!1){const m=this.unpackTensor(a);return this.disposeIntermediateTensorInfo(a),m}return a}compileAndRun(e,n,r,s,o=!1){return r=r||n[0].dtype,this.runWebGLProgram(e,n,r,s,o)}getAndSaveBinary(e,n){return e in this.binaryCache||(this.binaryCache[e]=n()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(j().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(n=>{this.gpgpu.deleteProgram(this.binaryCache[n].webGLProgram),delete this.binaryCache[n]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=H(()=>{if(!j().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=j().getBool("DEBUG");j().set("DEBUG",!1);const n=this.abs(qe(1e-8)).dataSync()[0];if(j().set("DEBUG",e),n>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?mte:gte}uploadToGPU(e){const n=this.texData.get(e),{shape:r,dtype:s,values:o,texture:i,usage:a,isPacked:l}=n;if(i!=null)return;const u=this.activeTimers!=null;let c;u&&(c=_n());let d=n.texShape;if(d==null&&(d=BZ(r,l),n.texShape=d),o!=null){const f=ph(r);let h,p=d[1],g=d[0];const v=o instanceof Uint8Array||o instanceof Uint8ClampedArray;(l||!v)&&([p,g]=du(d[0],d[1])),l?h=new BJ(f,v):h=new QS(f,v);const m=v?[g,p]:d,b=this.makeTensorInfo(m,s),x=this.texData.get(b.dataId);v?x.usage=pr.PIXELS:x.usage=pr.UPLOAD,x.texShape=m,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(b.dataId),p,g,o);const y=[[g,p]],C=this.runWebGLProgram(h,[b],s,y,!0),k=this.texData.get(C.dataId);n.texShape=k.texShape,n.isPacked=k.isPacked,n.usage=k.usage,j().get("ENGINE_COMPILE_ONLY")?this.disposeData(C.dataId):(n.texture=k.texture,n.values=null,this.texData.delete(C.dataId)),this.disposeIntermediateTensorInfo(b),u&&(this.uploadWaitMs+=_n()-c)}else{const f=this.acquireTexture(d,a,s,l);n.texture=f}}convertAndCacheOnCPU(e,n){const r=this.texData.get(e),{dtype:s}=r;return n!=null&&(r.values=wte(n,s)),r.values}acquireTexture(e,n,r,s){if(this.numBytesInGPU+=this.computeBytes(e,r),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const o=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${o} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,n,s)}computeBytes(e,n){return e[0]*e[1]*Cp(n)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,n]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(n));return Promise.all(e)}else{for(const[,n]of Object.entries(this.binaryCache)){const r=new Promise(s=>{try{this.checkCompletion_(n),s(!0)}catch(o){throw o}});e.push(r)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await nD(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(eO(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:n,customUniformLocations:r,infLoc:s,nanLoc:o,outShapeLocation:i,outShapeStridesLocation:a,outTexShapeLocation:l}=oO(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=n,e.customUniformLocations=r,e.infLoc=s,e.nanLoc=o,e.outShapeLocation=i,e.outShapeStridesLocation=a,e.outTexShapeLocation=l}}createTensorFromGPUData(e,n,r){e.channels=e.channels||"RGBA";const{texture:s,height:o,width:i,channels:a}=e,l=Es().backend;if(!l.gpgpu.gl.isTexture(s))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const u=l.writeTexture(s,n,r,o,i,a);return Es().makeTensorFromDataId(u,n,r,l)}}d0.nextDataId=0;function wte(t,e){if(e==="float32"||e==="complex64")return t;if(e==="int32"||e==="bool"){const n=e==="int32"?new Int32Array(t.length):new Uint8Array(t.length);for(let r=0;r<n.length;++r)n[r]=Math.round(t[r]);return n}else throw new Error(`Unknown dtype ${e}`)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ZN()&&tR("webgl",()=>new d0,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F$=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class pa{constructor(e,n,r){this.variableNames=["A","B"],this.outputShape=Se(n,r),this.enableShapeUniforms=Cn(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const La=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class gu{constructor(e,n,r,s=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Se(n,r);const o=this.outputShape.length;this.enableShapeUniforms=Cn(o);let i="";if(s)if(o===0||q(this.outputShape)===1)i=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(i=`
          ${st(o)} coords = getOutputCoords();
        `,o===1)this.enableShapeUniforms?i+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:i+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const l=Dn("coords",o);this.enableShapeUniforms?i+=`
            bool nextRowOutOfBounds =
              (${l[o-2]} + 1) >= outShape[${o} - 2];
            bool nextColOutOfBounds =
              (${l[o-1]} + 1) >= outShape[${o} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:i+=`
            bool nextRowOutOfBounds =
              (${l[o-2]} + 1) >= ${this.outputShape[o-2]};
            bool nextColOutOfBounds =
              (${l[o-1]} + 1) >= ${this.outputShape[o-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${i}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ir(t){const{inputs:e,backend:n}=t,{x:r}=e;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const $te={kernelName:Ad,backendName:"webgl",kernelFunc:ir};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yi(t){const{inputs:e,backend:n}=t,{real:r,imag:s}=e,o=n.makeTensorInfo(r.shape,"complex64"),i=n.texData.get(o.dataId),a=ir({inputs:{x:r},backend:n}),l=ir({inputs:{x:s},backend:n});return i.complexTensorInfos={real:a,imag:l},o}const Cte={kernelName:a1,backendName:"webgl",kernelFunc:yi};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gO="return (a < 0.) ? b * a : a;",vO=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function kte(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{alpha:o}=r,i=n.makeTensorInfo([],"float32",hi(o,"float32")),a=j().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new gu(vO,s.shape,i.shape):new pa(gO,s.shape,i.shape),l=n.runWebGLProgram(a,[s,i],"float32");return n.disposeIntermediateTensorInfo(i),l}const Ste={kernelName:og,backendName:"webgl",kernelFunc:kte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bO="return (a < 0.) ? b * a : a;",xO=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function Ite(t){const{inputs:e,backend:n}=t,{x:r,alpha:s}=e,o=j().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new gu(xO,r.shape,s.shape):new pa(bO,r.shape,s.shape);return n.runWebGLProgram(o,[r,s],"float32")}const Tte={kernelName:kg,backendName:"webgl",kernelFunc:Ite};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vu="if (isnan(x)) return x;";function Be({opSnippet:t,packedOpSnippet:e,cpuKernelImpl:n,dtype:r}){return({inputs:s,backend:o})=>{const{x:i}=s,a=o,l=r||i.dtype;if(a.shouldExecuteOnCPU([i])&&n!=null){const d=a.texData.get(i.dataId),f=n(d.values,l);return a.makeTensorInfo(i.shape,l,f)}const u=j().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let c;return u?c=new zo(i.shape,e):c=new Ps(i.shape,t),a.runWebGLProgram(c,[i],l)}}function hn({opSnippet:t,packedOpSnippet:e,checkOutOfBounds:n=!1,supportsComplex:r=!1,cpuKernelImpl:s,dtype:o}){return({inputs:i,backend:a})=>{const{a:l,b:u}=i,c=a;if(r&&l.dtype==="complex64"){const p=c.texData.get(l.dataId),g=c.texData.get(u.dataId),[v,m]=[[p.complexTensorInfos.real,g.complexTensorInfos.real],[p.complexTensorInfos.imag,g.complexTensorInfos.imag]].map(x=>{const[y,$]=x,C={dataId:y.dataId,dtype:y.dtype,shape:l.shape},k={dataId:$.dataId,dtype:$.dtype,shape:u.shape},w=new pa(t,l.shape,u.shape);return c.runWebGLProgram(w,[C,k],sr(y.dtype,$.dtype))}),b=yi({inputs:{real:v,imag:m},backend:c});return c.disposeIntermediateTensorInfo(v),c.disposeIntermediateTensorInfo(m),b}const d=o||sr(l.dtype,u.dtype);if((l.dtype==="string"||u.dtype==="string"||c.shouldExecuteOnCPU([l,u]))&&s!=null){const p=c.texData.get(l.dataId).values,g=c.texData.get(u.dataId).values,v=l.dtype==="string"?xo(p):p,m=l.dtype==="string"?xo(g):g,[b,x]=s(l.shape,u.shape,v,m,d),y=c.makeTensorInfo(x,d),$=c.texData.get(y.dataId);return $.values=b,y}const f=j().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let h;return f?h=new gu(e,l.shape,u.shape,n):h=new pa(t,l.shape,u.shape),c.runWebGLProgram(h,[l,u],d)}}function Zc(t,e=!1){if(t==="linear")return e?lte:rte;if(t==="relu")return e?cte:ote;if(t==="elu")return e?ute:ste;if(t==="relu6")return e?dte:ite;if(t==="prelu")return e?xO:bO;if(t==="leakyrelu")return e?vO:gO;if(t==="sigmoid")return e?fte:ate;throw new Error(`Activation ${t} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yO{constructor(e,n,r,s=!1,o=!1,i=!1,a=null,l=!1,u=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.enableShapeUniforms=Cn(this.outputShape.length);const c=s?e[1]:e[2],d=Math.ceil(c/2),f=s?"i * 2, rc.y":"rc.y, i * 2",h=o?"rc.z, i * 2":"i * 2, rc.z",p=s?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],g=o?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let v="",m="";a&&(l?v=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${a}
        }`:u?v=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${a}
        }`:v=`vec4 activation(vec4 x) {
          ${a}
        }`,m="result = activation(result);");const b=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),u&&this.variableNames.push("leakyreluAlpha");let x="rc.x",y="rc.x";e[0]<n[0]?x=`imod(rc.x, ${e[0]})`:n[0]<e[0]&&(y=`imod(rc.x, ${n[0]})`),this.userCode=`
      ${v}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${d}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${x};
        int batchB = ${y};
        for (int i = 0; i < ${d}; i++) {
          vec4 a = getMatrixA(batchA, ${f});
          vec4 b = getMatrixB(batchB, ${h});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${p[0]} * ${g[0]});
          result += (${p[1]} * ${g[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${b}

        ${m}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nI={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class rI{constructor(e,n,r){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Se(n,r),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sI="return a * b;";function P$(t){const{inputs:e,backend:n}=t,{a:r,b:s}=e,o=sr(r.dtype,s.dtype);if(r.dtype==="complex64"){const a=n.texData.get(r.dataId),l=n.texData.get(s.dataId),u=new rI(nI.REAL,r.shape,s.shape),c=new rI(nI.IMAG,r.shape,s.shape),d=[{dataId:a.complexTensorInfos.real.dataId,dtype:a.complexTensorInfos.real.dtype,shape:r.shape},{dataId:a.complexTensorInfos.imag.dataId,dtype:a.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:s.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:s.shape}],f=n.runWebGLProgram(u,d,"float32"),h=n.runWebGLProgram(c,d,"float32"),p=yi({inputs:{real:f,imag:h},backend:n});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(h),p}if(n.shouldExecuteOnCPU([r,s])){const a=n.texData.get(r.dataId),l=n.texData.get(s.dataId),[u,c]=Iee(r.shape,s.shape,a.values,l.values,o),d=n.makeTensorInfo(c,o),f=n.texData.get(d.dataId);return f.values=u,d}let i;return j().getBool("WEBGL_PACK_BINARY_OPERATIONS")?i=new gu(sI,r.shape,s.shape):i=new pa(sI,r.shape,s.shape),n.runWebGLProgram(i,[r,s],o)}const Ete={kernelName:Bd,backendName:"webgl",kernelFunc:P$};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nte(t,e,n){const r=[ql(t.shape),...Yl(t.shape)],s={dtype:t.dtype,shape:r,dataId:t.dataId},o=[ql(e),...Yl(e)],i=new mO(o,r),a=!0,l=[r],u=n.runWebGLProgram(i,[s],t.dtype,l,a);return{dataId:u.dataId,shape:e,dtype:u.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ie(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{shape:o}=r,i=n,a=q(s.shape),l=aN(o,a),u=q(l);D(a===u,()=>`The new shape (${l}) has ${u} elements and the old shape (${s.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`);const c=i.texData.get(s.dataId);return c.isPacked&&!Xp(s.shape,l)&&!(c.texture!==null&&Xp(c.shape,l))?Nte(s,l,i):(i.incRef(s.dataId),{dataId:s.dataId,shape:l,dtype:s.dtype})}const Rte={kernelName:Ig,backendName:"webgl",kernelFunc:ie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oI{constructor(e,n){this.variableNames=["x"];const{windowSize:r,batchSize:s,inSize:o,outSize:i}=e;this.outputShape=[s,i];const a=Math.floor(r/4)*4,l=r%4;let u="sumValue += dot(values, ones);";if(n!=null){const d=1/n;u=`sumValue += dot(values * ${zl(d)?d.toPrecision(2):d}, ones);`}let c="";o%r>0&&(c=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${c}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        float sumValue = 0.0;

        for (int i = 0; i < ${a}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${u}
        }

        int inIdx = inOffset + ${a};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${u}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${u}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${u}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Dte{constructor(e,n){this.variableNames=["x"];const{windowSize:r,batchSize:s,inSize:o,outSize:i}=e;this.outputShape=[s,i];let a="0.0",l="";n==="prod"?a="1.0":n==="min"?(a="1.0 / 1e-20",l="min"):n==="max"&&(a="-1.0 / 1e-20",l="max");let u=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="sum"?u="sumValue":n==="prod"?u="prodValue":n==="all"?u="allValue":n==="any"&&(u="anyValue");const c=Math.floor(r/4)*4,d=r%4;let f=`
      if (${n==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${n==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
        if (${n==="min"} || ${n==="max"}) {
          minMaxValue = ${l}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,h="vec4";n==="all"?(a="1.0",f=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,h="bvec4"):n==="any"&&(a="0.0",f=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,h="bvec4");let p="";o%r>0&&(p=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${a};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${p}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        vec4 minMaxValue = vec4(${a});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          ${h} values = ${h}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${f}
        }

        int inIdx = inOffset + ${c};
        if (${d===1}) {
          ${h} values = ${h}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${f}
        } else if (${d===2}) {
          ${h} values = ${h}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${f}
        } else if (${d===3}) {
          ${h} values = ${h}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${f}
        }
        setOutput(${u});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ate(t){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const n=e.length?e[e.length-1].outSize:t[1],r=qg(n);e.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return e}function Ma(t,e,n,r){const s=Ate(t.shape);let o=t;for(let i=0;i<s.length;i++){const{inSize:a,windowSize:l,outSize:u}=s[i];let c,d;n==="mean"?c=i===0?new oI({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:u},a):new oI({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:u}):c=new Dte({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:u},n),d=o,o=r.runWebGLProgram(c,[o],e),d.dataId!==t.dataId&&r.disposeIntermediateTensorInfo(d)}return o}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fte{constructor(e,n){this.variableNames=["A"];const r=new Array(e.length);for(let i=0;i<r.length;i++)r[i]=e[n[i]];this.outputShape=r,this.rank=r.length;const s=st(this.rank),o=Pte(n);this.userCode=`
    void main() {
      ${s} resRC = getOutputCoords();
      setOutput(getA(${o}));
    }
    `}}function Pte(t){const e=t.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(e);for(let s=0;s<t.length;s++)r[t[s]]=n[s];return r.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ote{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const r=new Array(e.length);for(let c=0;c<r.length;c++)r[c]=e[n[c]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const s=st(this.rank),o=pO("rc",this.rank),i=new Array(this.rank);for(let c=0;c<n.length;c++)i[n[c]]=o[c];const a=`vec2(${i.slice(-2).join()})`,l=`++${o[this.rank-1]} < ${r[this.rank-1]}`,u=`getChannel(getA(${i.join()}), ${a})`;this.userCode=`
    void main() {
      ${s} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${u};
      if(${l}) {
        result[1] = ${u};
      }
      --${o[this.rank-1]};
      if(++${o[this.rank-2]} < ${r[this.rank-2]}) {
        result[2] = ${u};
        if(${l}) {
          result[3] = ${u};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f0(t,e,n){const r=j().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Ote(t.shape,e):new Fte(t.shape,e);return n.runWebGLProgram(r,[t],t.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lte(t,e,n,r){const s=e,o=t.shape.length,i=De(s,t.shape);let a=i;const l=It(a,o),u=l!=null;let c=t;u&&(c=f0(t,l,r),a=Ot(a.length,o)),fn("sum",a,o);const[d,f]=sn(c.shape,a);let h=d;n&&(h=Vt(d,i));const p=q(f),v=q(t.shape)/p,m=ie({inputs:{x:c},attrs:{shape:[v,p]},backend:r}),b=W1(t.dtype),x=Ma(m,b,"sum",r),y=ie({inputs:{x},attrs:{shape:h},backend:r});return r.disposeIntermediateTensorInfo(m),r.disposeIntermediateTensorInfo(x),u&&r.disposeIntermediateTensorInfo(c),y}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h0(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,keepDims:i}=r;return Lte(s,o,i,n)}const Mte={kernelName:Ag,backendName:"webgl",kernelFunc:h0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function On(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{perm:o}=r,i=n,a=s.shape.length,l=new Array(a);for(let c=0;c<l.length;c++)l[c]=s.shape[o[c]];let u;if(i.shouldExecuteOnCPU([s])){const d=i.texData.get(s.dataId).values,f=A$(d,s.shape,s.dtype,o,l);u=i.makeTensorInfo(l,s.dtype);const h=i.texData.get(u.dataId);h.values=f}else u=f0(s,o,i);return u}const _te={kernelName:Il,backendName:"webgl",kernelFunc:On};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wO=1e3;function qp({a:t,b:e,transposeA:n,transposeB:r,backend:s,bias:o=null,preluActivationWeights:i=null,leakyreluAlpha:a=0,activation:l=null}){const u=t.shape.length,c=e.shape.length,d=n?t.shape[u-2]:t.shape[u-1],f=r?e.shape[c-1]:e.shape[c-2],h=n?t.shape[u-1]:t.shape[u-2],p=r?e.shape[c-2]:e.shape[c-1],g=t.shape.slice(0,-2),v=e.shape.slice(0,-2),m=q(g),b=q(v),y=Se(t.shape.slice(0,-2),e.shape.slice(0,-2)).concat([h,p]);D(d===f,()=>`Error in matMul: inner shapes (${d}) and (${f}) of Tensors with shapes ${t.shape} and ${e.shape} and transposeA=${n} and transposeB=${r} must match.`);const $=n?[m,d,h]:[m,h,d],C=r?[b,p,f]:[b,f,p],k=ie({inputs:{x:t},backend:s,attrs:{shape:$}}),w=ie({inputs:{x:e},backend:s,attrs:{shape:C}}),I=[k,w],N=Math.max(m,b),E=n?k.shape[1]:k.shape[2],R=o!=null,S=i!=null,T=l==="leakyrelu",F=l!=null?Zc(l,!0):null,L=R||S||T||F!=null;let G;if((h===1||p===1)&&E>wO&&L===!1){let z=k,U=w;n&&(z=On({inputs:{x:k},backend:s,attrs:{perm:[0,2,1]}}),I.push(z)),r&&(U=On({inputs:{x:w},backend:s,attrs:{perm:[0,2,1]}}),I.push(U));const K=p!==1,Q=p===1;let Z=z;K&&(Z=ie({inputs:{x:z},backend:s,attrs:{shape:[N,E,1]}}),I.push(Z));const te=p===1?2:1;let J=U;Q&&(J=ie({inputs:{x:U},backend:s,attrs:{shape:[N,1,E]}}),I.push(J));const re=P$({inputs:{a:Z,b:J},backend:s});G=h0({inputs:{x:re},backend:s,attrs:{axis:te,keepDims:!0}}),I.push(re)}else{const z=sr(t.dtype,e.dtype),U=new yO($,C,[N,h,p],n,r,R,F,S,T),K=[k,w];if(o!=null&&K.push(o),S&&K.push(i),T){const Q=s.makeTensorInfo([],"float32",hi(a,"float32"));K.push(Q),I.push(Q)}G=s.runWebGLProgram(U,K,z)}const P=ie({inputs:{x:G},backend:s,attrs:{shape:y}});I.push(G);for(const z of I)s.disposeIntermediateTensorInfo(z);return P}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zte(t){const{inputs:e,backend:n,attrs:r}=t,{a:s,b:o,bias:i,preluActivationWeights:a}=e,{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:d}=r;return qp({a:s,b:o,transposeA:l,transposeB:u,backend:n,bias:i,preluActivationWeights:a,leakyreluAlpha:d,activation:c})}const Vte={kernelName:kp,backendName:"webgl",kernelFunc:zte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iI="return abs(x);";function Bte(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])&&r.dtype!=="complex64"){const o=n.texData.get(r.dataId),i=fO(o.values);return n.makeTensorInfo(r.shape,r.dtype,i)}let s;return j().getBool("WEBGL_PACK_UNARY_OPERATIONS")?s=new zo(r.shape,iI):s=new Ps(r.shape,iI),n.runWebGLProgram(s,[r],r.dtype)}const Wte={kernelName:zm,backendName:"webgl",kernelFunc:Bte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ute=es+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,Gte=Be({opSnippet:Ute}),Hte={kernelName:fd,backendName:"webgl",kernelFunc:Gte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jte=es+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,Kte=Be({opSnippet:jte}),Xte={kernelName:hd,backendName:"webgl",kernelFunc:Kte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aI="return a + b;",qte=hn({opSnippet:aI,packedOpSnippet:aI,supportsComplex:!0,cpuKernelImpl:oee}),Yte={kernelName:su,backendName:"webgl",kernelFunc:qte};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qte{constructor(e,n){this.outputShape=[],this.outputShape=e,this.variableNames=n.map((o,i)=>`T${i}`);const r=[];this.variableNames.forEach(o=>{r.push(`float v${o} = get${o}AtOutCoords();`)});const s=this.variableNames.map(o=>`v${o}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        float result = ${s};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Zte{constructor(e,n){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=n.map((o,i)=>`T${i}`);const r=[];this.variableNames.forEach(o=>{r.push(`vec4 v${o} = get${o}AtOutCoords();`)});const s=this.variableNames.map(o=>`v${o}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        vec4 result = ${s};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xh(t){const{inputs:e,backend:n}=t,r=e;if(r.length===1)return ir({inputs:{x:r[0]},backend:n});if(r.length>j().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const l=Math.floor(r.length/2),u=Xh({inputs:r.slice(0,l),backend:n}),c=Xh({inputs:r.slice(l),backend:n});return Xh({inputs:[u,c],backend:n})}const s=r.map(l=>l.dtype).reduce((l,u)=>sr(l,u)),o=r.map(l=>l.shape),a=j().getBool("WEBGL_PACK")?new Zte(r[0].shape,o):new Qte(r[0].shape,o);return n.runWebGLProgram(a,r,s)}const Jte={kernelName:e1,backendName:"webgl",kernelFunc:Xh};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ene(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,keepDims:i}=r,a=s.shape.length,l=De(o,s.shape);let u=l;const c=It(u,a);let d=s;c!=null&&(d=On({inputs:{x:s},backend:n,attrs:{perm:c}}),u=Ot(u.length,a)),fn("all",u,a);const[f,h]=sn(d.shape,u),p=q(h),g=ie({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}}),v=Ma(g,g.dtype,"all",n);let m;if(i){const b=Vt(f,l);m=ie({inputs:{x:v},backend:n,attrs:{shape:b}})}else m=ie({inputs:{x:v},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(v),c!=null&&n.disposeIntermediateTensorInfo(d),m}const tne={kernelName:t1,backendName:"webgl",kernelFunc:ene};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nne(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,keepDims:i}=r,a=s.shape.length,l=De(o,s.shape);let u=l;const c=It(u,a);let d=s;c!=null&&(d=On({inputs:{x:s},backend:n,attrs:{perm:c}}),u=Ot(u.length,a)),fn("any",u,a);const[f,h]=sn(d.shape,u),p=q(h),g=ie({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}}),v=Ma(g,g.dtype,"any",n);let m;if(i){const b=Vt(f,l);m=ie({inputs:{x:v},backend:n,attrs:{shape:b}})}else m=ie({inputs:{x:v},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(v),c!=null&&n.disposeIntermediateTensorInfo(d),m}const rne={kernelName:n1,backendName:"webgl",kernelFunc:nne};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sne{constructor(e,n,r){this.variableNames=["A"];const{windowSize:s,batchSize:o,outSize:i}=e;r||this.variableNames.push("bestIndicesA"),this.outputShape=[o,i];const a=n==="max"?">":"<",l=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${s}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${a} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class one{constructor(e,n,r,s){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,D(e.length>2,()=>`Packed arg${r.charAt(0).toUpperCase()+r.slice(1)} supports only inputs with rank above 2.`);const o=e[e.length-1],i=Math.ceil(o/n);this.outputShape=e.slice(0,-1),i>1&&this.outputShape.push(i),s||this.variableNames.push("bestIndicesA");const a=this.outputShape,l=a.length,u=st(l),c=Dn("coords",l);let d,f;if(i===1){f=l+1;const w=st(f);d=`
        ${w} sourceLocR = ${w}(${c.join()}, 0);
        ++${c[l-1]};
        ${w} sourceLocG = ${w}(${c.join()}, 0);
        ++${c[l-2]};
        ${w} sourceLocA = ${w}(${c.join()}, 0);
        --${c[l-1]};
        ${w} sourceLocB = ${w}(${c.join()}, 0);
        --${c[l-2]};`}else f=l,d=`
        ${u} sourceLocR = coords;
        ++${c[l-1]};
        ${u} sourceLocG = coords;
        ++${c[l-2]};
        ${u} sourceLocA = coords;
        --${c[l-1]};
        ${u} sourceLocB = coords;
        --${c[l-2]};`;const h=["x","y","z","w","u","v"].slice(0,f),p="."+h[f-1],g=h.map(w=>"int "+w),v=Dn("sourceLocR",f-1).concat("inIdx.r"),m=Dn("sourceLocG",f-1).concat("inIdx.g"),b=Dn("sourceLocB",f-1).concat("inIdx.b"),x=Dn("sourceLocA",f-1).concat("inIdx.a"),y=r==="max"?"greaterThan":"lessThan",$=s?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${v.join()}),
                             getBestIndicesAChannel(${m.join()}),
                             getBestIndicesAChannel(${b.join()}),
                             getBestIndicesAChannel(${x.join()})));`,C=`vec4(
            getAChannel(${v.join()}),
            hasNextCol ? getAChannel(${m.join()}) : 0.,
            hasNextRow ? getAChannel(${b.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${x.join()}) : 0.)`,k=s?"":`
      float getBestIndicesAChannel(${g.join()}) {
        return getChannel(getBestIndicesA(${h.join()}),
                                          vec2(${h.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${g.join()}) {
        return getChannel(getA(${h.join()}),
                               vec2(${h.slice(-2).join()}));
      }
      ${k}
      void main() {
        ${u} coords = getOutputCoords();
        bool hasNextCol = ${c[l-1]} < ${a[l-1]-1};
        bool hasNextRow = ${c[l-2]} < ${a[l-2]-1};
        ${d}
        ivec4 srcIdx = ivec4(sourceLocR${p}, sourceLocG${p},
          sourceLocB${p}, sourceLocA${p}) * ${n};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${C};

        for (int i = 0; i < ${n}; i++) {
          inIdx = srcIdx;
          ${$}
          vec4 candidate = ${C};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${y}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $O(t,e,n,r=null){let s=e.shape[0],o=e.shape[1];r!=null&&(s=r.shape[0],o=r.shape[1]);const i=qg(o),a={windowSize:i,inSize:o,batchSize:s,outSize:Math.ceil(o/i)},l=new sne(a,n,r==null),u=[e];r!=null&&u.push(r);const c=t.runWebGLProgram(l,u,"int32");if(c.shape[1]===1)return c;const d=$O(t,e,n,c);return t.disposeIntermediateTensorInfo(c),d}function CO(t,e,n,r=null){const s=r!=null?r.shape:e.shape,o=s[s.length-1],i=qg(o),a=new one(s,i,n,r==null),l=r==null?[e]:[e,r],u=t.runWebGLProgram(a,l,"int32");if(u.shape.length===e.shape.length){const c=CO(t,e,n,u);return t.disposeIntermediateTensorInfo(u),c}return u}function kO(t,e,n,r){const s=[n];if(fn("arg"+r.charAt(0).toUpperCase()+r.slice(1),s,e.shape.length),!j().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const o=[],i=t.texData.get(e.dataId),a=i!==null&&i.isPacked;let l=e;a&&(l=t.unpackTensor(e),o.push(l));const[u,c]=sn(l.shape,s),d=q(c),f=ie({inputs:{x:l},backend:t,attrs:{shape:[-1,d]}});o.push(f);const h=$O(t,f,r);o.push(h);const p=ie({inputs:{x:h},backend:t,attrs:{shape:u}});return o.forEach(g=>t.disposeIntermediateTensorInfo(g)),p}return CO(t,e,r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ine(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o}=r;let i=De(o,s.shape);const a=It(i,s.shape.length);let l=s;const u=[];a!=null&&(l=On({inputs:{x:s},backend:n,attrs:{perm:a}}),u.push(l),i=Ot(i.length,l.shape.length)),fn("argMax",[i[0]],l.shape.length);const c=kO(n,l,i[0],"max");return u.forEach(d=>n.disposeIntermediateTensorInfo(d)),c}const ane={kernelName:Vm,backendName:"webgl",kernelFunc:ine};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lne(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o}=r;let i=De(o,s.shape);const a=It(i,s.shape.length);let l=s;const u=[];a!=null&&(l=On({inputs:{x:s},backend:n,attrs:{perm:a}}),u.push(l),i=Ot(i.length,l.shape.length)),fn("argMin",[i[0]],l.shape.length);const c=kO(n,l,i[0],"min");return u.forEach(d=>n.disposeIntermediateTensorInfo(d)),c}const une={kernelName:Bm,backendName:"webgl",kernelFunc:lne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cne=es+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,dne=Be({opSnippet:cne}),fne={kernelName:pd,backendName:"webgl",kernelFunc:dne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hne=es+"return log(x + sqrt(x * x + 1.0));",pne=Be({opSnippet:hne}),mne={kernelName:md,backendName:"webgl",kernelFunc:pne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gne=es+`
  return atan(x);
`,vne=Be({opSnippet:gne}),bne={kernelName:gd,backendName:"webgl",kernelFunc:vne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xne=F$+`
  return atan(a, b);
`,yne=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+La+`
  return result;
`,wne=hn({opSnippet:xne,packedOpSnippet:yne}),$ne={kernelName:bd,backendName:"webgl",kernelFunc:wne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cne=es+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,kne=Be({opSnippet:Cne}),Sne={kernelName:vd,backendName:"webgl",kernelFunc:kne};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jc{constructor(e,n,r,s=!1,o=!1){if(this.variableNames=["x"],n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const i=e.filterWidth,a=e.strideHeight,l=e.strideWidth,u=e.dilationHeight,c=e.dilationWidth,d=e.effectiveFilterHeight,f=e.effectiveFilterWidth,h=e.padInfo.top,p=e.padInfo.left;this.outputShape=e.outShape;const g=n==="avg",v=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,m=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let b="0.0";if(g||(b="-1.0 / 1e-20"),r){const w=">=";this.userCode=`
        const ivec2 strides = ivec2(${a}, ${l});
        const ivec2 pads = ivec2(${h}, ${p});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${d};
              wR += ${u}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${f};
                wC += ${c}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${w} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${s?o?v:m:`wR * ${f} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const x="max";let y=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(y="avgValue / max(count, 1.0)");const $=Math.floor(i/4)*4,C=i%4,k=`
      if (${g}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${x}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${l});
      const ivec2 pads = ivec2(${h}, ${p});
      const float initializationValue = ${b};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${b});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${d};
            wR += ${u}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${$}; wC += 4) {
            int xC = xCCorner + wC * ${c};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              getValue(batch, xR, xC + 3 * ${c}, d)
            );

            ${k}
          }

          int xC = xCCorner + ${$};
          if (${C===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${k}
          } else if (${C===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              initializationValue,
              initializationValue
            );

            ${k}
          } else if (${C===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              initializationValue
            );

            ${k}
          }
        }
        setOutput(${y});
      }
    `}}class O${constructor(e,n,r,s=!1,o=!1){if(this.variableNames=["x"],n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const i=e.filterWidth,a=e.strideDepth,l=e.strideHeight,u=e.strideWidth,c=e.dilationDepth,d=e.dilationHeight,f=e.dilationWidth,h=e.effectiveFilterDepth,p=e.effectiveFilterHeight,g=e.effectiveFilterWidth,v=e.padInfo.front,m=e.padInfo.top,b=e.padInfo.left;this.outputShape=e.outShape;const x=n==="avg";let y="0.0";if(x||(y="-1.0 / 1e-20"),r){const N=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${a}, ${l}, ${u});
        const ivec3 pads = ivec3(${v}, ${m}, ${b});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${h};
              wD += ${c}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${p};
                wR += ${d}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${g};
                  wC += ${f}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${N} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${s?o?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${p} * ${g} +
                      wR * ${g} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const $="max";let C=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(C="avgValue / max(count, 1.0)");const k=Math.floor(i/4)*4,w=i%4,I=`
      if (${x}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${$}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${a}, ${l}, ${u});
      const ivec3 pads = ivec3(${v}, ${m}, ${b});
      const float initializationValue = ${y};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${y});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${h};
            wD += ${c}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${p};
            wR += ${d}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${k}; wC += 4) {
              int xC = xCCorner + wC * ${f};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${f}, ch),
                getValue(batch, xD, xR, xC + 2 * ${f}, ch),
                getValue(batch, xD, xR, xC + 3 * ${f}, ch)
              );

              ${I}
            }

            int xC = xCCorner + ${k};
            if (${w===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${I}
            } else if (${w===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${f}, ch),
                initializationValue,
                initializationValue
              );

              ${I}
            } else if (${w===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${f}, ch),
                getValue(batch, xD, xR, xC + 2 * ${f}, ch),
                initializationValue
              );

              ${I}
            }
          }
        }
        setOutput(${C});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ine(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;If(s,"avgPool");const{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=r,u=1;D(wn(i,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const c=Zr(s.shape,o,i,u,a,l);if(c.filterWidth===1&&c.filterHeight===1&&Ye(c.inShape,c.outShape))return ir({inputs:{x:s},backend:n});const d=new Jc(c,"avg",!1);return n.runWebGLProgram(d,[s],"float32")}const Tne={kernelName:Wm,backendName:"webgl",kernelFunc:Ine};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ene(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:o,strides:i,pad:a,dimRoundingMode:l,dataFormat:u}=r,c=[1,1,1],d=$o(s.shape,o,i,c,a,l,u),f=new O$(d,"avg",!1);return n.runWebGLProgram(f,[s],"float32")}const Nne={kernelName:Um,backendName:"webgl",kernelFunc:Ene};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Rne{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,s=e.strideHeight,o=e.strideWidth,i=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterHeight,u=e.effectiveFilterWidth,c=l-1-e.padInfo.top,d=u-1-e.padInfo.left,f=1/(n*r);this.userCode=`
      const ivec2 pads = ivec2(${c}, ${d});
      const float avgMultiplier = float(${f});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${i}) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${u};
            wC+= ${a}) {
            float dyC = float(dyCCorner + wC) / ${o}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class Dne{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterDepth,r=e.filterHeight,s=e.filterWidth,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,d=e.effectiveFilterDepth,f=e.effectiveFilterHeight,h=e.effectiveFilterWidth,p=d-1-e.padInfo.front,g=f-1-e.padInfo.top,v=h-1-e.padInfo.left,m=1/(n*r*s);this.userCode=`
      const ivec3 pads = ivec3(${p}, ${g}, ${v});
      const float avgMultiplier = float(${m});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${d};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${o}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${f};
              wR += ${u}) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${h};
                wC += ${c}) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ane(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:o}=e,i=o,{filterSize:a,strides:l,pad:u,dimRoundingMode:c}=r,d=[1,1,1],f=$o(i.shape,a,l,d,u,c),h=new Dne(f);return n.runWebGLProgram(h,[s],i.dtype)}const Fne={kernelName:s1,backendName:"webgl",kernelFunc:Ane};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pne(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:o}=e,i=o;If([s,o],"avgPoolGrad");const{filterSize:a,strides:l,pad:u}=r,c=Zr(i.shape,a,l,1,u),d=new Rne(c);return n.runWebGLProgram(d,[s],i.dtype)}const One={kernelName:r1,backendName:"webgl",kernelFunc:Pne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lne(t){const{inputs:e,backend:n,attrs:r}=t,{a:s,b:o}=e,{transposeA:i,transposeB:a}=r;return qp({a:s,b:o,transposeA:i,transposeB:a,backend:n})}const Mne={kernelName:Gm,backendName:"webgl",kernelFunc:Lne};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _ne{constructor(e,n,r,s,o,i){this.outputShape=[],this.variableNames=["x","mean","variance"],Se(e,n),Se(e,r);let a="0.0";s!=null&&(Se(e,s),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="1.0";o!=null&&(Se(e,o),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${a};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${i}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zne{constructor(e,n,r,s,o,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Se(e,n),Se(e,r);let a="vec4(0.0)";s!=null&&(Se(e,s),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="vec4(1.0)";o!=null&&(Se(e,o),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${a};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${i}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vne=({inputs:t,backend:e,attrs:n})=>{const{x:r,mean:s,variance:o,offset:i,scale:a}=t;D(s.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),D(i==null||s.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),D(a==null||s.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=n;l==null&&(l=.001);const u=[r,s,o];let c=null;i!=null&&(c=i.shape,u.push(i));let d=null;a!=null&&(d=a.shape,u.push(a));const f=j().getBool("WEBGL_PACK_NORMALIZATION")?new zne(r.shape,s.shape,o.shape,c,d,l):new _ne(r.shape,s.shape,o.shape,c,d,l);return e.runWebGLProgram(f,u,u[0].dtype)},Bne={kernelName:ng,backendName:"webgl",kernelFunc:Vne};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wne{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const n=st(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const r=Une(this.rank);let s;const o=e.map((i,a)=>`sourceLoc.${hx[a]} = start[${a}] + coords.${hx[a]};`);s=`
        ${n} sourceLoc;
        ${n} coords = getOutputCoords();
        ${o.join(`
`)}
      `,this.userCode=`
      void main() {
        ${s}
        setOutput(getSource(${r}));
      }
    `}}const hx=["x","y","z","w","u","v"];function Une(t){if(t===1)return"sourceLoc";if(t<=6)return hx.slice(0,t).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gne{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=st(this.rank),r=Dn("coords",this.rank),s=Dn("sourceLoc",this.rank),o=this.rank===1?"sourceLoc":`vec2(${s.slice(-2).join()})`,i=`getChannel(getSource(${s.join()}), ${o})`,a=`
      result.x = ${i};
      if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
        ++${s[this.rank-1]};
        result.y = ${i};
        --${s[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${r[this.rank-1]};
      if (++${r[this.rank-2]} < ${e[this.rank-2]}) {
        ++${s[this.rank-2]};
        result.z = ${i};
        if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
          ++${s[this.rank-1]};
          result.w = ${i};
        }
      }
    `,u=this.rank<=4?`sourceLoc = coords +
            ${n}(${e.map((c,d)=>`start[${d}]`).join()});`:e.map((c,d)=>`${s[d]} = ${r[d]} + start[${d}];`).join(`
`);this.userCode=`
      void main() {
        ${n} coords = getOutputCoords();
        ${n} sourceLoc;
        ${u}
        vec4 result = vec4(0.);
        ${a}
        ${l}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hne(t,e,n,r){const s=r.texData.get(t.dataId),o=r.makeTensorInfo(n,t.dtype),i=r.texData.get(o.dataId);Object.assign(i,s),i.refCount=1,i.shape=n,i.dtype=t.dtype;let a=Rw(e,me(t.shape));s.slice&&(a+=s.slice.flatOffset),i.slice={flatOffset:a,origDataId:s.slice&&s.slice.origDataId||t.dataId};const l=r.dataRefCount.get(i.slice.origDataId)||1;return r.dataRefCount.set(i.slice.origDataId,l+1),o}function bu(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{begin:o,size:i}=r,[a,l]=Xg(s,o,i);if(Tw(s,a,l),q(l)===0)return n.makeTensorInfo(l,s.dtype,[]);if(n.shouldExecuteOnCPU([s])||s.dtype==="string"){const d=n.texData.get(s.dataId),f=Mee(d.values,a,l,s.shape,s.dtype);return n.makeTensorInfo(l,s.dtype,f)}const{isPacked:u}=n.texData.get(s.dataId),c=Nw(s.shape,a,l);if(u||!c){const d=j().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Gne(l):new Wne(l),f=[a];return n.runWebGLProgram(d,[s],s.dtype,f)}return n.uploadToGPU(s.dataId),Hne(s,a,l,n)}const jne={kernelName:Dg,backendName:"webgl",kernelFunc:bu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kne=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockShape:o,crops:i}=r;D(s.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const a=o.reduce((b,x)=>b*x),l=hf(s.shape,o,a),u=pf(l.length,o.length),c=mf(s.shape,o,a),d=Ow(i,o.length),f=Lw(c,i,o.length),h=[],p=ie({inputs:{x:s},backend:n,attrs:{shape:l}}),g=On({inputs:{x:p},backend:n,attrs:{perm:u}}),v=ie({inputs:{x:g},backend:n,attrs:{shape:c}}),m=bu({inputs:{x:v},backend:n,attrs:{begin:d,size:f}});return h.push(p),h.push(g),h.push(v),h.forEach(b=>n.disposeIntermediateTensorInfo(b)),m},Xne={kernelName:Hm,backendName:"webgl",kernelFunc:Kne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qne(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,weights:o}=e,{size:i}=r,a=n.readSync(s.dataId),l=n.readSync(o.dataId),u=dO(a,l,o.dtype,o.shape,i);return n.makeTensorInfo([i],o.dtype,u)}const Yne={kernelName:o1,backendName:"webgl",kernelFunc:qne};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qne=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,Zne=`
  return float(int(a.r) & int(b.r));
`;function Jne(t){const{inputs:e,backend:n}=t,{a:r,b:s}=e,o=j().getBool("WEBGL_PACK_BINARY_OPERATIONS"),i=j().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([r,s])||i===1){const l=n.texData.get(r.dataId).values,u=n.texData.get(s.dataId).values,[c,d]=aee(r.shape,s.shape,l,u,r.dtype),f=n.makeTensorInfo(d,r.dtype),h=n.texData.get(f.dataId);return h.values=c,f}let a;return o?a=new gu(Qne,r.shape,s.shape,!1):a=new pa(Zne,r.shape,s.shape),n.runWebGLProgram(a,[r,s],r.dtype)}const ere={kernelName:i1,backendName:"webgl",kernelFunc:Jne};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tre(t){const{inputs:e,backend:n}=t,{s0:r,s1:s}=e,o=n.readSync(r.dataId),i=n.readSync(s.dataId),a=Se(Array.from(o),Array.from(i));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const nre={kernelName:hN,backendName:"webgl",kernelFunc:tre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rre="return float(a != b);",SO=hn({opSnippet:rre,cpuKernelImpl:Eee,dtype:"bool"}),sre={kernelName:xg,backendName:"webgl",kernelFunc:SO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ef(t){const{inputs:e,backend:n}=t,{input:r}=e,s=n.texData.get(r.dataId);return ir({inputs:{x:s.complexTensorInfos.real},backend:n})}const ore={kernelName:D1,backendName:"webgl",kernelFunc:Ef};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ire="return float(int(x));";function are(t,e){const n=new Ps(t.shape,ire),r=e.runWebGLProgram(n,[t],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function px(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{dtype:o}=r;if(o==="complex64"){if(s.dtype==="complex64")return ir({inputs:{x:s},backend:n});const i=Ct(s.shape),a=px({inputs:{x:s},backend:n,attrs:{dtype:"float32"}}),l=yi({inputs:{real:a,imag:i},backend:n});return i.dispose(),n.disposeIntermediateTensorInfo(a),l}if(s.dtype==="complex64"){const i=Ef({inputs:{input:s},backend:n}),a=px({inputs:{x:i},backend:n,attrs:{dtype:o}});return n.disposeIntermediateTensorInfo(i),a}if(!lN(s.dtype,o)){const i=ir({inputs:{x:s},backend:n});return{dataId:i.dataId,shape:i.shape,dtype:o}}if(n.shouldExecuteOnCPU([s])){const i=n.texData.get(s.dataId).values,[a,l,u]=lee(i,s.shape,s.dtype,o);return n.makeTensorInfo(a,l,u)}if(o==="int32")return are(s,n);if(o==="bool"){const i=n.makeTensorInfo([],"bool",bn("bool",1)),l=SO({inputs:{a:s,b:i},backend:n});return n.disposeIntermediateTensorInfo(i),l}throw new Error(`Error in Cast: failed to cast ${s.dtype} to ${o}`)}const lre={kernelName:xd,backendName:"webgl",kernelFunc:px};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lI="return ceil(x);",ure=Be({opSnippet:lI,packedOpSnippet:lI,cpuKernelImpl:uee}),cre={kernelName:yd,backendName:"webgl",kernelFunc:ure};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dre{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fre{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hre(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{clipValueMin:o,clipValueMax:i}=r;let a;j().getBool("WEBGL_PACK_CLIP")?a=new fre(s.shape):a=new dre(s.shape);const l=[[o],[i]];return n.runWebGLProgram(a,[s],s.dtype,l)}const pre={kernelName:wd,backendName:"webgl",kernelFunc:hre};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mre{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uI(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}function gre(t){const{inputs:e,backend:n}=t,{x:r}=e,s=n.texData.get(r.dataId),o=new mre(r.shape),i=[uI(r,s.complexTensorInfos.real),uI(r,s.complexTensorInfos.imag)];return n.runWebGLProgram(o,i,i[0].dtype)}const vre={kernelName:jm,backendName:"webgl",kernelFunc:gre};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bre{constructor(e){this.outputShape=[],this.outputShape=zs(e,1),this.variableNames=e.map((i,a)=>`T${a}`);const n=new Array(e.length-1);n[0]=e[0][1];for(let i=1;i<n.length;i++)n[i]=n[i-1]+e[i][1];const r=[`if (yC < ${n[0]}) setOutput(getT0(yR, yC));`];for(let i=1;i<n.length;i++){const a=n[i-1];r.push(`else if (yC < ${n[i]}) setOutput(getT${i}(yR, yC-${a}));`)}const s=n.length,o=n[n.length-1];r.push(`else setOutput(getT${s}(yR, yC-${o}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${r.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xre{constructor(e,n){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=zs(e,n);const r=this.outputShape,s=r.length,o=st(s),i=Dn("coords",s),a=["x","y","z","w","u","v"].slice(0,s);this.variableNames=e.map((g,v)=>`T${v}`);const l=new Array(e.length-1);l[0]=e[0][n];for(let g=1;g<l.length;g++)l[g]=l[g-1]+e[g][n];const u=a[n],c=a.slice(-2),d=a.join();let f=`if (${u} < ${l[0]}) {
        return getChannel(
            getT0(${d}), vec2(${c.join()}));
        }`;for(let g=1;g<l.length;g++){const v=l[g-1];f+=`
        if (${u} < ${l[g]}  && ${u} >= ${l[g-1]}) {
          return getChannel(
            getT${g}(${vh(a,u,v)}),
            vec2(${vh(c,u,v)}));
        }`}const h=l.length,p=l[l.length-1];f+=`
        return getChannel(
          getT${h}(${vh(a,u,p)}),
          vec2(${vh(c,u,p)}));`,this.userCode=`
      float getValue(${a.map(g=>"int "+g)}) {
        ${f}
      }

      void main() {
        ${o} coords = getOutputCoords();
        vec4 result = vec4(getValue(${i}), 0., 0., 0.);

        ${i[s-1]} = ${i[s-1]} + 1;
        if (${i[s-1]} < ${r[s-1]}) {
          result.g = getValue(${i});
        }

        ${i[s-2]} = ${i[s-2]} + 1;
        if (${i[s-2]} < ${r[s-2]}) {
          result.a = getValue(${i});
        }

        ${i[s-1]} = ${i[s-1]} - 1;
        if (${i[s-2]} < ${r[s-2]} &&
            ${i[s-1]} < ${r[s-1]}) {
          result.b = getValue(${i});
        }
        setOutput(result);
      }
    `}}function vh(t,e,n){const r=t.indexOf(e);return t.map((o,i)=>i===r?`${o} - ${n}`:o).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p0(t){const{inputs:e,backend:n}=t,{input:r}=e,s=n.texData.get(r.dataId);return ir({inputs:{x:s.complexTensorInfos.imag},backend:n})}const yre={kernelName:C1,backendName:"webgl",kernelFunc:p0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ju(t,e,n){const r=t[0].dtype;if(r==="complex64"){const h=t.map(b=>Ef({inputs:{input:b},backend:n})),p=t.map(b=>p0({inputs:{input:b},backend:n})),g=Ju(h,e,n),v=Ju(p,e,n),m=yi({inputs:{real:g,imag:v},backend:n});return h.forEach(b=>n.disposeIntermediateTensorInfo(b)),p.forEach(b=>n.disposeIntermediateTensorInfo(b)),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(v),m}let s=n.shouldExecuteOnCPU(t);if(r==="string"&&(s=!0),s){const h=t.map(y=>{const C=[-1,q(y.shape.slice(e))];return ie({inputs:{x:y},backend:n,attrs:{shape:C}})}),p=h.map(y=>({vals:n.readSync(y.dataId),shape:y.shape})),g=zs(h.map(y=>y.shape),1),v=h[0].shape[0]===1,m=cee(p,g,r,v),b=zs(t.map(y=>y.shape),e),x=n.makeTensorInfo(b,r,m);return h.forEach(y=>n.disposeIntermediateTensorInfo(y)),x}const o=t.filter(h=>q(h.shape)>0),i=j().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&o[0].shape.length>1;if(o.length===1){const h=i?new Ps(t[0].shape,Ao):new zo(t[0].shape,Ao);return n.runWebGLProgram(h,t,r)}const a=j().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(o.length>a){const h=[];for(let g=0;g<o.length;g+=a){const v=o.slice(g,g+a);h.push(Ju(v,e,n))}const p=Ju(h,e,n);for(const g of h)n.disposeIntermediateTensorInfo(g);return p}if(i){const h=new xre(o.map(p=>p.shape),e);return n.runWebGLProgram(h,o,r)}const{tensors2D:l,outShape:u}=wre(o,e,n),c=new bre(l.map(h=>h.shape)),d=n.runWebGLProgram(c,l,r);l.forEach(h=>n.disposeIntermediateTensorInfo(h));const f=ie({inputs:{x:d},attrs:{shape:u},backend:n});return n.disposeIntermediateTensorInfo(d),f}function wre(t,e,n){const r=zs(t.map(o=>o.shape),e);return{tensors2D:t.map(o=>ie({inputs:{x:o},attrs:{shape:[-1,q(o.shape.slice(e))]},backend:n})),outShape:r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IO(t){const{inputs:e,backend:n,attrs:r}=t,{axis:s}=r,o=De(s,e[0].shape)[0],i=e.map(u=>u.shape);Aw(i,o);const a=zs(e.map(u=>u.shape),o);if(q(a)===0)return n.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(u=>q(u.shape)>0);return l.length===1?ir({inputs:{x:l[0]},backend:n}):Ju(l,o,n)}const $re={kernelName:Km,backendName:"webgl",kernelFunc:IO};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class TO{constructor(e,n=!1,r=null,s=!1,o=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const i=e.padInfo.top,a=e.padInfo.left,l=e.strideHeight,u=e.strideWidth,c=e.dilationHeight,d=e.dilationWidth,f=e.filterHeight,h=e.filterWidth,p=Math.floor(e.inChannels/4)*4,g=e.inChannels%4,v=e.dataFormat==="channelsLast",m=v?1:2,b=v?2:3,x=v?3:1;let y="",$="";r&&(s?y=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:o?y=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:y=`
          float activation(float x) {
            ${r}
          }
        `,$="result = activation(result);");const C=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${y}

      const ivec2 strides = ivec2(${l}, ${u});
      const ivec2 pads = ivec2(${i}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${x}];

        ivec2 xRCCorner =
            ivec2(coords[${m}], coords[${b}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${f}; wR++) {
          int xR = xRCorner + wR * ${c};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${h}; wC++) {
            int xC = xCCorner + wC * ${d};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${p}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${v}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${g===1}) {

              if (${v}) {
                dotProd +=
                    getX(batch, xR, xC, ${p}) *
                    getW(wR, wC, ${p}, d2);
              } else {
                dotProd +=
                    getX(batch, ${p}, xR, xC) *
                    getW(wR, wC, ${p}, d2);
              }

            } else if (${g===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2)
              );

              if (${v}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${g===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2),
                getW(wR, wC, ${p} + 2, d2)
              );

              if (${v}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1),
                  getX(batch, xR, xC, ${p} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC),
                  getX(batch, ${p} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${C}
        ${$}
        setOutput(result);
      }
    `}}class Cre{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const n=e.padInfo.front,r=e.padInfo.top,s=e.padInfo.left,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,d=e.filterDepth,f=e.filterHeight,h=e.filterWidth,p=Math.floor(e.inChannels/4)*4,g=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${o}, ${i}, ${a});
      const ivec3 pads = ivec3(${n}, ${r}, ${s});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${d}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${f}; wR++) {
            int xR = xRCorner + wR * ${u};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${h}; wC++) {
              int xC = xCCorner + wC * ${c};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${p}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${g===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${p}) *
                  getW(wF, wR, wC, ${p}, d2);
              } else if (${g===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${g===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1),
                  getX(batch, xF, xR, xC, ${p} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2),
                  getW(wF, wR, wC, ${p} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class EO{constructor(e,n=!1,r=null,s=!1,o=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Cn(this.outputShape.length);const i=e.padInfo.left,a=e.strideWidth,l=e.dilationWidth,u=e.filterHeight,c=e.filterWidth,d=c;let f=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let v=0;v<c;v++)f+=`
           vec4 xTexelC${v*2};
           int xTexelC${v*2}Ready;
           vec4 xTexelC${v*2+1};
           int xTexelC${v*2+1}Ready;
           vec4 xC${v};`;f+=`
     for (int r = 0; r < ${u}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let v=0;v<c;v++)f+=`
           xTexelC${v*2} = vec4(0.0);
           xTexelC${v*2}Ready = 0;
           xTexelC${v*2+1} = vec4(0.0);
           xTexelC${v*2+1}Ready = 0;
           xC${v} = vec4(0.0);`;f+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let v=0;v<(d+1)/2;v++){const m=v*2;if(f+=`
           xC = xCCorner + ${m*l};
           `,a===1){if(m<c&&(i%2===1?(f+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${m}Ready == 0) {
                   xTexelC${m} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${m}.zw = vec2(0.0);
                   }
                   xTexelC${m}Ready = 1;
                 }
               `,l===1&&m>0?f+=`
                 xC${m} = vec4(xTexelC${m-2}.zw, xTexelC${m}.xy);
                 `:f+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${m} = vec4(previous.zw, xTexelC${m}.xy);
                   } else {
                     xC${m} = vec4(0.0, 0.0, xTexelC${m}.xy);
                   }
                   `):f+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${m}Ready == 0) {
                   xTexelC${m} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${m}.zw = vec2(0.0);
                   }
                   xTexelC${m}Ready = 1;
                 }

                 xC${m} = xTexelC${m};
                 `,m+1<c)){const b=i%2===0?qy(l):l;l%2===0&&i%2===1||l%2!==0&&i%2!==1?(f+=`
                   xCOffset = xC + imod(pads[1], 2) + ${b};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${m+1}Ready == 0) {
                     xTexelC${m+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${m+1}.zw = vec2(0.0);
                     }
                     xTexelC${m+1}Ready = 1;
                   }
                   `,l>1?f+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${m+1} = vec4(previous.zw, xTexelC${m+1}.xy);
                     } else {
                      xC${m+1} = vec4(0.0, 0.0, xTexelC${m+1}.xy);
                     }
                     `:f+=`
                     xC${m+1} = vec4(xTexelC${m}.zw, xTexelC${m+1}.xy);
                     `):b===1?f+=`
                     xC${m+1} = xTexelC${m};
                     `:f+=`
                     xCOffset = xC + ${b};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${m+1}Ready == 0) {
                       xTexelC${m+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${m+1}.zw = vec2(0.0);
                       }
                       xTexelC${m+1}Ready = 1;
                     }

                     xC${m+1} = xTexelC${m+1};
                     `}}else m<c&&(i%2===1?(f+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${m}Ready == 0) {
                   xTexelC${m} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${m}.zw = vec2(0.0);
                   }
                   xTexelC${m}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${m+1}Ready == 0) {
                   xTexelC${m+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${m+1}.zw = vec2(0.0);
                   }
                   xTexelC${m+1}Ready = 1;
                 }

                 xC${m} = vec4(xTexelC${m}.zw, xTexelC${m+1}.zw);
               `,m+1<c&&(f+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${m+1} = vec4(xTexelC${m+1}.xy, final.xy);
                 `)):(f+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${m}Ready == 0) {
                   xTexelC${m} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${m}.zw = vec2(0.0);
                   }
                   xTexelC${m}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${m+1}Ready == 0) {
                   xTexelC${m+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${m+1}.zw = vec2(0.);
                   }
                   xTexelC${m+1}Ready = 1;
                 }

                 xC${m} = vec4(
                   xTexelC${m}.xy, xTexelC${m+1}.xy);
               `,m+1<c&&(f+=`
                   xC${m+1} = vec4(xTexelC${m}.zw, xTexelC${m+1}.zw);
                 `)));m<c&&(f+=`
             wTexel = getW(r, ${m}, d1, d2);
             dotProd += xC${m}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${m}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,m+1<c&&(f+=`
               wTexel = getW(r, ${m+1}, d1, d2);
               dotProd += xC${m+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${m+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}f+=`
     }
   `,f+=`
     }
   `,f+=`
     }
   `;let h="",p="";r&&(s?h=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${r}
         }`:o?h=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${r}
         }`:h=`vec4 activation(vec4 x) {
           ${r}
         }`,p="result = activation(result);");const g=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${h}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${f}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${g}
         ${p}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kre{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=Cn(this.outputShape.length);const{dataFormat:r}=n,s=Ln(),o=r==="channelsLast",i=o?1:2,a=o?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let u="";for(let c=0;c<=1;c++)for(let d=0;d<=1;d++)u+=`
          blockIndex = rc.z + ${d};
          pos = rc.y + ${c};

          ${l}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${i}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${a}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${o}) {
                  innerDims = vec2(d1, ch);
                  result[${c*2+d}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${c*2+d}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${u}

        ${s.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yp(t,e){const n=t.length;return n>=3?e?[...t.slice(0,-3),t[n-3]*t[n-2],t[n-1]]:[...t.slice(0,-3),t[n-3],t[n-2]*t[n-1]]:!e&&n===1&&t[0]>1?[t[0],1]:null}function NO({x:t,filter:e,convInfo:n,backend:r,bias:s=null,preluActivationWeights:o=null,leakyreluAlpha:i=0,activation:a=null}){const l=t.shape,u=r.texData.get(t.dataId),c=n.inChannels,d=l[0]*l[1]*l[2],f=n.outChannels,h=n.dataFormat==="channelsLast",p=!1,g=!1;let v;const m=[];if(o!=null){const y=Yp(o.shape,h);y!=null&&(o=ie({inputs:{x:o},backend:r,attrs:{shape:y}}),m.push(o))}if(s!=null){const y=Yp(s.shape,h);y!=null&&(s=ie({inputs:{x:s},backend:r,attrs:{shape:y}}),m.push(s))}if(!((d===1||f===1)&&c>wO)&&u.isPacked&&h&&u.texture!=null&&l[2]%2!==0&&Ye(u.shape.slice(-3),l.slice(-3))){const y=l[0]*l[1]*(l[2]+1),$={dataId:t.dataId,shape:[1,y,n.inChannels],dtype:t.dtype},C=u.shape;u.shape=u.shape.slice(),u.shape[u.shape.length-2]++,D(Xp(u.shape,$.shape),()=>`packed reshape ${u.shape} to ${$.shape} isn't free`);const k=ie({inputs:{x:e},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}});m.push(k);const w=qp({a:$,b:k,backend:r,transposeA:p,transposeB:g,bias:s,activation:a,preluActivationWeights:o,leakyreluAlpha:i}),I=r.texData.get(w.dataId);D(I.isPacked,()=>"batchMatMul result is expected to be packed"),u.shape=C,I.shape=n.outShape,v=ir({inputs:{x:w},backend:r}),v.shape=n.outShape,m.push(w)}else{const y=n.outHeight*n.outWidth,$=ie({inputs:{x:t},backend:r,attrs:{shape:h?[n.batchSize,y,n.inChannels]:[n.batchSize,n.inChannels,y]}}),C=ie({inputs:{x:e},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}}),k=qp({a:h?$:C,b:h?C:$,transposeA:!h,transposeB:g,backend:r,bias:s,activation:a,preluActivationWeights:o,leakyreluAlpha:i});v=ie({inputs:{x:k},backend:r,attrs:{shape:n.outShape}}),m.push($),m.push(C),m.push(k)}for(const y of m)r.disposeIntermediateTensorInfo(y);return v}function RO({x:t,filter:e,convInfo:n,backend:r,bias:s=null,preluActivationWeights:o=null,leakyreluAlpha:i=0,activation:a=null}){const{filterWidth:l,filterHeight:u,inChannels:c,outWidth:d,outHeight:f,dataFormat:h}=n,p=h==="channelsLast",g=l*u*c,v=f*d,m=[n.batchSize,g,v],b=!0,x=!1,y=[];if(o!=null){const P=Yp(o.shape,p);P!=null&&(o=ie({inputs:{x:o},backend:r,attrs:{shape:P}}),y.push(o))}if(s!=null){const P=Yp(s.shape,p);P!=null&&(s=ie({inputs:{x:s},backend:r,attrs:{shape:P}}),y.push(s))}const $=ie({inputs:{x:e},backend:r,attrs:{shape:[1,g,q(e.shape)/g]}});y.push($);const C=new kre(m,n),k=[t.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],w=r.runWebGLProgram(C,[t],"float32",k),I=ie({inputs:{x:w},backend:r,attrs:{shape:m}});y.push(w),y.push(I);const N=s!=null,E=o!=null,R=a==="leakyrelu",S=a?Zc(a,!0):null,T=new yO(p?I.shape:$.shape,p?$.shape:I.shape,p?[n.batchSize,v,n.outChannels]:[n.batchSize,n.outChannels,v],b,x,N,S,E,R),F=p?[I,$]:[$,I];if(s&&F.push(s),E&&F.push(o),R){const P=r.makeTensorInfo([],"float32",hi(i,"float32"));F.push(P),y.push(P)}const L=r.runWebGLProgram(T,F,"float32"),G=ie({inputs:{x:L},backend:r,attrs:{shape:n.outShape}});y.push(L);for(const P of y)r.disposeIntermediateTensorInfo(P);return G}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sre(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o}=e,{strides:i,pad:a,dataFormat:l,dilations:u,dimRoundingMode:c}=r,d=Co(l),f=dn(s.shape,o.shape,i,u,a,c,!1,d);let h;if(f.filterHeight===1&&f.filterWidth===1&&f.dilationHeight===1&&f.dilationWidth===1&&f.strideHeight===1&&f.strideWidth===1&&(f.padInfo.type==="SAME"||f.padInfo.type==="VALID"))h=NO({x:s,filter:o,convInfo:f,backend:n});else if(f.strideWidth<=2&&d==="channelsLast"&&j().getBool("WEBGL_EXP_CONV")){const g=new EO(f),v=[[f.padInfo.top,f.padInfo.left],[f.strideHeight,f.strideWidth],[f.dilationHeight,f.dilationWidth],[f.inHeight,f.inWidth]];h=n.runWebGLProgram(g,[s,o],"float32",v)}else if(j().getBool("WEBGL_CONV_IM2COL"))h=RO({x:s,filter:o,convInfo:f,backend:n});else{const g=new TO(f);h=n.runWebGLProgram(g,[s,o],"float32")}const p=ie({inputs:{x:h},backend:n,attrs:{shape:f.outShape}});return n.disposeIntermediateTensorInfo(h),p}const Ire={kernelName:Xm,backendName:"webgl",kernelFunc:Sre};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tre{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,r=e.strideWidth,s=e.padInfo.top,o=e.padInfo.left,i=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${s};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${o};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              ${i?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class Ere{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,s=e.strideHeight,o=e.strideWidth,i=e.dataFormat==="channelsLast",a=n-1-e.padInfo.top,l=r-1-e.padInfo.left,u=i?1:2,c=i?2:3,d=i?3:1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${d}];

        ivec2 dyCorner = ivec2(coords[${u}], coords[${c}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${o}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${i}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class Nre{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideDepth,r=e.strideHeight,s=e.strideWidth,o=e.padInfo.front,i=e.padInfo.top,a=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${n} - ${o};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${r} - ${i};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${s} - ${a};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class Rre{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterDepth,r=e.filterHeight,s=e.filterWidth,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,l=n-1-e.padInfo.front,u=r-1-e.padInfo.top,c=s-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${u}, ${c});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${n}; wF++) {
          float dyF = float(dyFCorner + wF) / ${o}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${n} - 1 - wF;

          for (int wR = 0; wR < ${r}; wR++) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${r} - 1 - wR;

            for (int wC = 0; wC < ${s}; wC++) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${s} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dre(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:o}=e,{strides:i,pad:a,dataFormat:l,dimRoundingMode:u,filterShape:c}=r,d=Co(l),f=dn(s.shape,c,i,1,a,u,!1,d),h=new Tre(f);return n.runWebGLProgram(h,[s,o],"float32")}const Are={kernelName:l1,backendName:"webgl",kernelFunc:Dre};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fre{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=Cn(this.outputShape.length);const n=e.filterHeight,r=e.filterWidth,s=n-1-e.padInfo.top,o=r-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${s}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            int wCPerm = ${r} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${e.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${e.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pre(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:o}=e,{inputShape:i,strides:a,pad:l,dataFormat:u,dimRoundingMode:c}=r,d=Co(u),f=dn(i,o.shape,a,1,l,c,!1,d);if(j().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&d==="channelsLast"){const h=[[f.strideHeight,f.strideWidth]],p=new Fre(f);return n.runWebGLProgram(p,[s,o],"float32",h)}else{const h=new Ere(f);return n.runWebGLProgram(h,[s,o],"float32")}}const Ore={kernelName:qm,backendName:"webgl",kernelFunc:Pre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lre(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o}=e,{strides:i,pad:a,dilations:l}=r,u=pi(s.shape,o.shape,i,l,a),c=new Cre(u);return n.runWebGLProgram(c,[s,o],"float32")}const Mre={kernelName:Ym,backendName:"webgl",kernelFunc:Lre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _re(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:o}=e,{strides:i,pad:a,filterShape:l}=r,u=pi(s.shape,l,i,1,a),c=new Nre(u);return n.runWebGLProgram(c,[s,o],"float32")}const zre={kernelName:u1,backendName:"webgl",kernelFunc:_re};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vre(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:o}=e,{pad:i,strides:a,inputShape:l}=r,u=pi(l,o.shape,a,1,i),c=new Rre(u);return n.runWebGLProgram(c,[s,o],"float32")}const Bre={kernelName:c1,backendName:"webgl",kernelFunc:Vre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wre=vu+`
  return cos(x);
`,Ure=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${La}
  return result;
`,Gre=Be({opSnippet:Wre,packedOpSnippet:Ure}),Hre={kernelName:$d,backendName:"webgl",kernelFunc:Gre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jre=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,Kre=Be({opSnippet:jre}),Xre={kernelName:Cd,backendName:"webgl",kernelFunc:Kre};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qre{constructor(e,n,r,s,o){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[i,a,l,u]=e,[c]=n,[d,f]=r;this.outputShape=[c,d,f,u];const h=s==="bilinear"?1:0,[p,g]=[`${a-1}.0`,`${l-1}.0`],[v,m,b]=d>1?[`${(a-1)/(d-1)}`,"(y2-y1) * height_ratio",`y1*${p} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${p}`],[x,y,$]=f>1?[`${(l-1)/(f-1)}`,"(x2-x1) * width_ratio",`x1*${g} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${g}`];this.userCode=`
      const float height_ratio = float(${v});
      const float width_ratio = float(${x});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${i}) {
          return;
        }

        float height_scale = ${m};
        float width_scale = ${y};

        float in_y = ${b};
        if( in_y < 0.0 || in_y > ${p} ) {
          setOutput(float(${o}));
          return;
        }
        float in_x = ${$};
        if( in_x < 0.0 || in_x > ${g} ) {
          setOutput(float(${o}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${h} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yre=t=>{const{inputs:e,backend:n,attrs:r}=t,{image:s,boxes:o,boxInd:i}=e,{cropSize:a,method:l,extrapolationValue:u}=r,c=new qre(s.shape,o.shape,a,l,u);return n.runWebGLProgram(c,[s,o,i],"float32")},Qre={kernelName:f1,backendName:"webgl",kernelFunc:Yre};var ed;(function(t){t.Prod="*",t.Sum="+"})(ed||(ed={}));class cI{constructor(e,n,r,s){this.op=e,this.outputShape=n,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const o=this.outputShape.length,i=this.op===ed.Prod?"1.0":"0.0",a=r?i:`getX(${dI(o,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1];let u="",c="";r?(u=s?`end != ${l-1}`:"end != 0",c=s?"end + 1":"end - 1"):(u=s?`end + pow2 < ${l}`:"end >= pow2",c=s?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${st(o)} coords = getOutputCoords();
        int end = ${fI(o,"coords",this.op)};
        float val = ${a};
        int pow2 = int(pow(2.0, index));
        if (${u}) {
          int idx = ${c};
          ${fI(o,"coords",this.op)} = idx;
          val ${this.op}= getX(${dI(o,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function dI(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.x, ${e}.y`;if(t===3)return`${e}.x, ${e}.y, ${e}.z`;if(t===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}function fI(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.y`;if(t===3)return`${e}.z`;if(t===4)return`${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DO(t,e,n,r,s,o){const i=e.shape.length,a=It([r],i);let l=e;a!=null&&(l=On({inputs:{x:e},backend:n,attrs:{perm:a}}));const u=Ot(1,i)[0];if(u!==i-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${r}`);const c=l.shape[u];let d=ir({inputs:{x:l},backend:n});for(let f=0;f<=Math.ceil(Math.log2(c))-1;f++){const h=new cI(t,l.shape,!1,o),p=[[f]],g=d;d=n.runWebGLProgram(h,[d],d.dtype,p),n.disposeIntermediateTensorInfo(g)}if(s){const f=new cI(t,l.shape,s,o),h=d;d=n.runWebGLProgram(f,[d],d.dtype),n.disposeIntermediateTensorInfo(h)}if(a!=null){const f=mi(a),h=On({inputs:{x:d},backend:n,attrs:{perm:f}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(l),h}return d}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zre(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,exclusive:i,reverse:a}=r;return DO(ed.Prod,s,n,o,i,a)}const Jre={kernelName:d1,backendName:"webgl",kernelFunc:Zre};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ese(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,exclusive:i,reverse:a}=r;return DO(ed.Sum,s,n,o,i,a)}const tse={kernelName:Qm,backendName:"webgl",kernelFunc:ese};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nse(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,weights:o}=e,{size:i,binaryOutput:a}=r;if(s.shape.length===1){const l=n.readSync(s.dataId),u=n.readSync(o.dataId),c=dO(l,u,o.dtype,o.shape,i);return n.makeTensorInfo([i],o.dtype,c)}else if(s.shape.length===2){const l=n.bufferSync(s),u=n.bufferSync(o),c=iee(l,u,i,a);return n.makeTensorInfo(c.shape,o.dtype,c.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${s.shape.length}.`)}const rse={kernelName:h1,backendName:"webgl",kernelFunc:nse};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sse{constructor(e,n,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=n,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${n};
      int offset_h = imod(h, ${n});
      int in_w = w / ${n};
      int offset_w = imod(w, ${n});
      int offset_d = (offset_h * ${n} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ose(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockSize:o,dataFormat:i}=r,a=s.shape[0],l=i==="NHWC"?s.shape[1]:s.shape[2],u=i==="NHWC"?s.shape[2]:s.shape[3],c=i==="NHWC"?s.shape[3]:s.shape[1],d=l*o,f=u*o,h=c/(o*o),p=i==="NHWC"?[a,d,f,h]:[a,h,d,f],g=new sse(p,o,i);return n.runWebGLProgram(g,[s],s.dtype)}const ise={kernelName:p1,backendName:"webgl",kernelFunc:ose};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class AO{constructor(e,n=!1,r=null,s=!1,o=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Cn(this.outputShape.length);const i=e.filterHeight,a=e.filterWidth,l=e.outChannels/e.inChannels;let u="",c="";r&&(s?u=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:o?u=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:u=`
          float activation(float x) {
            ${r}
          }
        `,c="result = activation(result);");const d=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${u}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${i}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${a}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${d}
        ${c}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class FO{constructor(e,n=!1,r=null,s=!1,o=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Cn(this.outputShape.length);const i=e.outChannels/e.inChannels,a=e.padInfo.left,l=e.strideWidth,u=e.dilationWidth,c=e.filterHeight,d=e.filterWidth,f=d;let h=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let m=0;m<d;m++)h+=`
          vec4 xTexelC${m*2};
          int xTexelC${m*2}Ready;
          vec4 xTexelC${m*2+1};
          int xTexelC${m*2+1}Ready;
          vec4 xC${m};`;h+=`
    for (int r = 0; r < ${c}; r++) {
      `;for(let m=0;m<d;m++)h+=`
          xTexelC${m*2} = vec4(0.0);
          xTexelC${m*2}Ready = 0;
          xTexelC${m*2+1} = vec4(0.0);
          xTexelC${m*2+1}Ready = 0;
          xC${m} = vec4(0.0);`;h+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let m=0;m<(f+1)/2;m++){const b=m*2;if(h+=`
          xC = xCCorner + ${b*u};
          `,l===1){if(b<d&&(a%2===1?(h+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b}Ready == 0) {
                  xTexelC${b} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${b}.zw = vec2(0.0);
                  }
                  xTexelC${b}Ready = 1;
                }
              `,u===1&&b>0?h+=`
                xC${b} = vec4(xTexelC${b-2}.zw, xTexelC${b}.xy);
                `:h+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${b} = vec4(previous.zw, xTexelC${b}.xy);
                  } else {
                    xC${b} = vec4(0.0, 0.0, xTexelC${b}.xy);
                  }
                  `):h+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${b}Ready == 0) {
                  xTexelC${b} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${b}.zw = vec2(0.0);
                  }
                  xTexelC${b}Ready = 1;
                }

                xC${b} = xTexelC${b};
                `,b+1<d)){const x=a%2===0?qy(u):u;u%2===0&&a%2===1||u%2!==0&&a%2!==1?(h+=`
                  xCOffset = xC + imod(pads[1], 2) + ${x};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b+1}Ready == 0) {
                    xTexelC${b+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${b+1}.zw = vec2(0.0);
                    }
                    xTexelC${b+1}Ready = 1;
                  }
                  `,u>1?h+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${b+1} = vec4(previous.zw, xTexelC${b+1}.xy);
                    } else {
                     xC${b+1} = vec4(0.0, 0.0, xTexelC${b+1}.xy);
                    }
                    `:h+=`
                    xC${b+1} = vec4(xTexelC${b}.zw, xTexelC${b+1}.xy);
                    `):x===1?h+=`
                    xC${b+1} = xTexelC${b};
                    `:h+=`
                    xCOffset = xC + ${x};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b+1}Ready == 0) {
                      xTexelC${b+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${b+1}.zw = vec2(0.0);
                      }
                      xTexelC${b+1}Ready = 1;
                    }

                    xC${b+1} = xTexelC${b+1};
                    `}}else b<d&&(a%2===1?(h+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b}Ready == 0) {
                  xTexelC${b} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${b}.zw = vec2(0.0);
                  }
                  xTexelC${b}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${b+1}Ready == 0) {
                  xTexelC${b+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${b+1}.zw = vec2(0.0);
                  }
                  xTexelC${b+1}Ready = 1;
                }

                xC${b} = vec4(xTexelC${b}.zw, xTexelC${b+1}.zw);
              `,b+1<d&&(h+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${b+1} = vec4(xTexelC${b+1}.xy, final.xy);
                `)):(h+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${b}Ready == 0) {
                  xTexelC${b} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${b}.zw = vec2(0.0);
                  }
                  xTexelC${b}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b+1}Ready == 0) {
                  xTexelC${b+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${b+1}.zw = vec2(0.);
                  }
                  xTexelC${b+1}Ready = 1;
                }

                xC${b} = vec4(
                  xTexelC${b}.xy, xTexelC${b+1}.xy);
              `,b+1<d&&(h+=`
                  xC${b+1} = vec4(xTexelC${b}.zw, xTexelC${b+1}.zw);
                `)));b<d&&(h+=`
            wTexel = getW(r, ${b}, d1, q);
            dotProd += xC${b} * vec4(wTexel.xz, wTexel.xz);
          `,b+1<d&&(h+=`
              wTexel = getW(r, ${b+1}, d1, q);
              dotProd += xC${b+1} * vec4(wTexel.xz, wTexel.xz);
            `))}h+=`
    }
  `,h+=`
      }
    `;let p="",g="";r&&(s?p=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:o?p=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:p=`vec4 activation(vec4 x) {
          ${r}
        }`,g="result = activation(result);");const v=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${p}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${i};
        int q = d2 - d1 * ${i};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${h}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${v}
        ${g}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ase(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o}=e,{strides:i,pad:a,dilations:l,dimRoundingMode:u}=r;let c=l;c==null&&(c=[1,1]),D(wn(i,c),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const d=dn(s.shape,o.shape,i,c,a,u,!0);let f;j().getBool("WEBGL_PACK_DEPTHWISECONV")&&d.strideWidth<=2&&d.outChannels/d.inChannels===1?f=new FO(d):f=new AO(d);const h=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];return n.runWebGLProgram(f,[s,o],"float32",h)}const lse={kernelName:Zm,backendName:"webgl",kernelFunc:ase};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class use{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,r=e.strideWidth,s=e.padInfo.top,o=e.padInfo.left,i=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${i} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${s};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${o};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class cse{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,s=e.strideHeight,o=e.strideWidth,i=n-1-e.padInfo.top,a=r-1-e.padInfo.left,l=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${i}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${o}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dse(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:o}=e,{strides:i,dilations:a,pad:l,dimRoundingMode:u,filterShape:c}=r,d=dn(s.shape,c,i,a,l,u,!0),f=new use(d);return n.runWebGLProgram(f,[s,o],"float32")}const fse={kernelName:m1,backendName:"webgl",kernelFunc:dse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hse(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:o}=e,{strides:i,dilations:a,pad:l,dimRoundingMode:u,inputShape:c}=r,d=dn(c,o.shape,i,a,l,u,!0),f=new cse(d);return n.runWebGLProgram(f,[s,o],"float32")}const pse={kernelName:g1,backendName:"webgl",kernelFunc:hse};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mse{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gse(t){const{inputs:e,backend:n}=t,{x:r}=e,s=[...r.shape,...r.shape],o=q(r.shape),i=ie({inputs:{x:r},backend:n,attrs:{shape:[o]}}),a=new mse(o),l=n.runWebGLProgram(a,[i],i.dtype),u=ie({inputs:{x:l},backend:n,attrs:{shape:s}});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(l),u}const vse={kernelName:pN,backendName:"webgl",kernelFunc:gse};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bse{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:n,inWidth:r,padInfo:s,strideHeight:o,strideWidth:i,filterHeight:a,filterWidth:l,dilationHeight:u,dilationWidth:c}=e,{top:d,left:f}=s;this.userCode=`
      const ivec2 strides = ivec2(${o}, ${i});
      const ivec2 pads = ivec2(${d}, ${f});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${a}; h++) {
          int hIn = hBeg + h * ${u};

          if (hIn >= 0 && hIn < ${n}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${c};

              if (wIn >= 0 && wIn < ${r}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xse(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o}=e,{strides:i,pad:a,dilations:l}=r,u=lf(s.shape,o.shape,i,a,"NHWC",l);let c;const d=new bse(u);c=n.runWebGLProgram(d,[s,o],"float32");const f=ie({inputs:{x:c},backend:n,attrs:{shape:u.outShape}});return n.disposeIntermediateTensorInfo(c),f}const yse={kernelName:Jm,backendName:"webgl",kernelFunc:xse};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wse(t){const{inputs:e,backend:n,attrs:r}=t,{equation:s}=r,o=e,{allDims:i,summedDims:a,idDims:l}=Gw(s,o.length);jw(i.length,l,o);const{path:u,steps:c}=Kw(a,l),d=c.length;let f=null,h=i.length;const p=[];for(let g=0;g<d;++g){for(const v of c[g]){const{permutationIndices:m,expandDims:b}=Hw(h,l[v]);let x;Xw(m)?x=o[v]:(x=On({inputs:{x:o[v]},backend:n,attrs:{perm:m}}),p.push(x));const y=x.shape.slice();for(let $=0;$<b.length;++$)y.splice(b[$],0,1);Ye(x.shape,y)||(x=ie({inputs:{x},backend:n,attrs:{shape:y}}),p.push(x)),f===null?f=x:(f=P$({inputs:{a:x,b:f},backend:n}),p.push(f))}g<d-1&&(u[g]>=0&&(f=h0({inputs:{x:f},backend:n,attrs:{axis:u[g]-(i.length-h),keepDims:!1}}),p.push(f)),h--)}for(const g of p)g!==f&&n.disposeIntermediateTensorInfo(g);return f}const $se={kernelName:v1,backendName:"webgl",kernelFunc:wse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cse="return (x >= 0.0) ? x : (exp(x) - 1.0);",kse=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,Sse=Be({opSnippet:Cse,packedOpSnippet:kse}),Ise={kernelName:Sd,backendName:"webgl",kernelFunc:Sse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tse="return (b >= 0.0) ? a : a * (b + 1.0);",Ese=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,Nse=t=>{const{inputs:e,backend:n}=t,{dy:r,y:s}=e,o=j().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new gu(Ese,r.shape,s.shape):new pa(Tse,r.shape,s.shape);return n.runWebGLProgram(o,[r,s],r.dtype)},Rse={kernelName:b1,backendName:"webgl",kernelFunc:Nse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dse=`
  return vec4(equal(a, b));
`,Ase="return float(a == b);",Fse=hn({opSnippet:Ase,packedOpSnippet:Dse,dtype:"bool",cpuKernelImpl:dee}),Pse={kernelName:eg,backendName:"webgl",kernelFunc:Fse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ose=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${Mw};
  float a1 = ${_w};
  float a2 = ${zw};
  float a3 = ${Vw};
  float a4 = ${Bw};
  float a5 = ${Ww};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,Lse=Be({opSnippet:Ose}),Mse={kernelName:Id,backendName:"webgl",kernelFunc:Lse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _se=vu+`
  return exp(x);
`,zse=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,PO=Be({opSnippet:_se,packedOpSnippet:zse,cpuKernelImpl:fee,dtype:"float32"}),Vse={kernelName:Td,backendName:"webgl",kernelFunc:PO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mx(t){const{inputs:e,attrs:n,backend:r}=t,{dim:s}=n,{input:o}=e,i=o.shape.length,a=o.shape.slice();let l=s;return s<0&&(D(-(i+1)<=s,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),l=i+s+1),a.splice(l,0,1),ie({inputs:{x:o},backend:r,attrs:{shape:a}})}const Bse={kernelName:tg,backendName:"webgl",kernelFunc:mx};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hI="return exp(x) - 1.0;",Wse=Be({opSnippet:hI,packedOpSnippet:hI,cpuKernelImpl:hee}),Use={kernelName:Ed,backendName:"webgl",kernelFunc:Wse};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pI{constructor(e,n,r){this.variableNames=["real","imag"];const s=n[1];this.outputShape=n;const o=r?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,i=r?`${s}.0`:"1.0";let a;if(e==="real")a="return real * expR - imag * expI;";else if(e==="imag")a="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${o};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${a}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${s});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${s}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${i};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OO(t,e,n){const r=n.texData.get(t.dataId),s=q(t.shape),o=t.shape[t.shape.length-1],i=s/o,a=ie({inputs:{x:t},backend:n,attrs:{shape:[i,o]}}),l=a.shape,u=new pI("real",l,e),c=new pI("imag",l,e),d=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:l},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:l}],f=n.runWebGLProgram(u,d,"float32"),h=n.runWebGLProgram(c,d,"float32"),p=yi({inputs:{real:f,imag:h},backend:n});n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(h);const g=ie({inputs:{x:p},backend:n,attrs:{shape:t.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(p),g}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gse(t){const{inputs:e,backend:n}=t,{input:r}=e;return OO(r,!1,n)}const Hse={kernelName:x1,backendName:"webgl",kernelFunc:Gse};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jse{constructor(e,n){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nf(t){const{backend:e,attrs:n}=t,{shape:r,value:s}=n;let{dtype:o}=n;if(o=o||nu(s),o==="string"){const i=At(o,q(r));return i.fill(s),e.makeTensorInfo(r,o,i)}else{const i=new jse(r,s),a=[[s]];return e.runWebGLProgram(i,[],o,a)}}const Kse={kernelName:y1,backendName:"webgl",kernelFunc:Nf};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xse{constructor(e){this.variableNames=["Image"],this.outputShape=[];const n=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${n} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${n}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qse={kernelName:w1,backendName:"webgl",kernelFunc:({inputs:t,backend:e})=>{const{image:n}=t,r=e,s=new Xse(n.shape);return r.runWebGLProgram(s,[n],n.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mI="return floor(x);",Yse=Be({opSnippet:mI,packedOpSnippet:mI,cpuKernelImpl:pee}),Qse={kernelName:Nd,backendName:"webgl",kernelFunc:Yse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zse=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,Jse=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,eoe=hn({opSnippet:Zse,packedOpSnippet:Jse,dtype:"int32"}),toe={kernelName:Rd,backendName:"webgl",kernelFunc:eoe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class noe{constructor(e){this.variableNames=["A"];const n=Ln(),[r,s]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${s}.0, ${r}.0);

        vec4 values = ${n.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class roe{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const n=Ln(),[r,s]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${s}.0, ${r}.0);
            vec4 values = ${n.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const soe={kernelName:wV,backendName:"webgl",kernelFunc:ooe};let Ka,xv=j().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function ooe(t){const{inputs:e,backend:n,attrs:r}=t;let{pixels:s}=e;const{numChannels:o}=r,i=typeof HTMLVideoElement<"u"&&s instanceof HTMLVideoElement,a=typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement,[l,u]=i?[s.videoWidth,s.videoHeight]:[s.width,s.height],c=[u,l],d=[u,l,o];if(a||i){const g=j().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(Ka==null||g!==xv)&&(xv=g,Ka=document.createElement("canvas").getContext("2d",{willReadFrequently:xv})),Ka.canvas.width=l,Ka.canvas.height=u,Ka.drawImage(s,0,0,l,u),s=Ka.canvas}const f=n.makeTensorInfo(c,"int32");n.texData.get(f.dataId).usage=pr.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(f.dataId),s);const h=j().getBool("WEBGL_PACK")?new roe(d):new noe(d),p=n.runWebGLProgram(h,[f],"int32");return n.disposeData(f.dataId),p}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ioe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o,bias:i,preluActivationWeights:a}=e,{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:f,activation:h,leakyreluAlpha:p}=r,g=Co(c),v=dn(s.shape,o.shape,l,d,u,f,!1,g);let m;const b=[],x=i!=null,y=a!=null,$=h==="leakyrelu",C=()=>{const w=[s,o],I=(N,E)=>{if(E==="NCHW"&&N.shape.length===1&&N.shape[0]!==1){const R=ie({inputs:{x:N},backend:n,attrs:{shape:[N.shape[0],1,1]}});return b.push(R),R}return N};if(x&&w.push(I(i,c)),y&&w.push(I(a,c)),$){const N=n.makeTensorInfo([],"float32",hi(p,"float32"));w.push(N),b.push(N)}return w};if(v.filterHeight===1&&v.filterWidth===1&&v.dilationHeight===1&&v.dilationWidth===1&&v.strideHeight===1&&v.strideWidth===1&&(v.padInfo.type==="SAME"||v.padInfo.type==="VALID"))m=NO({x:s,filter:o,convInfo:v,backend:n,bias:i,activation:h,preluActivationWeights:a,leakyreluAlpha:p});else if(v.strideWidth<=2&&g==="channelsLast"&&j().getBool("WEBGL_EXP_CONV")){const w=h?Zc(h,!0):null,I=new EO(v,x,w,y,$),N=[[v.padInfo.top,v.padInfo.left],[v.strideHeight,v.strideWidth],[v.dilationHeight,v.dilationWidth],[v.inHeight,v.inWidth]],E=C();m=n.runWebGLProgram(I,E,"float32",N)}else if(j().getBool("WEBGL_CONV_IM2COL"))m=RO({x:s,filter:o,convInfo:v,backend:n,bias:i,activation:h,preluActivationWeights:a,leakyreluAlpha:p});else{const w=h?Zc(h,!1):null,I=new TO(v,x,w,y,$),N=C();m=n.runWebGLProgram(I,N,"float32")}const k=ie({inputs:{x:m},backend:n,attrs:{shape:v.outShape}});return b.push(m),b.forEach(w=>n.disposeIntermediateTensorInfo(w)),k}const aoe={kernelName:Sp,backendName:"webgl",kernelFunc:ioe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function loe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o,bias:i,preluActivationWeights:a}=e,{strides:l,pad:u,dilations:c,dimRoundingMode:d,activation:f,leakyreluAlpha:h}=r,p=[];let g=c;g==null&&(g=[1,1]),D(wn(l,g),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${g}'`);const v=dn(s.shape,o.shape,l,g,u,d,!0),m=j().getBool("WEBGL_PACK_DEPTHWISECONV")&&v.strideWidth<=2&&v.outChannels/v.inChannels===1,b=f?Zc(f,m):null,x=[s,o],y=i!=null,$=a!=null,C=f==="leakyrelu";if(y&&x.push(i),$&&x.push(a),C){const N=n.makeTensorInfo([],"float32",hi(h,"float32"));x.push(N),p.push(N)}let k;m?k=new FO(v,y,b,$,C):k=new AO(v,y,b,$,C);const w=[[v.padInfo.top,v.padInfo.left],[v.strideHeight,v.strideWidth],[v.dilationHeight,v.dilationWidth],[v.inHeight,v.inWidth]],I=n.runWebGLProgram(k,x,"float32",w);return p.forEach(N=>n.disposeIntermediateTensorInfo(N)),I}const uoe={kernelName:FN,backendName:"webgl",kernelFunc:loe};class coe{constructor(e,n,r,s){this.sliceDim=e,this.strides=n,this.paramsShape=s,this.variableNames=["x","indices"],this.outputShape=r;const o=st(r.length);let i=`
    int index;`;for(let a=0;a<this.sliceDim;a++)i+=`
          index = round(getIndices(coords[0], ${a}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[a]};
          flattenIndex += index * ${this.strides[a]};`;this.userCode=`
         void main() {
          ${o} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${i}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function doe(t){const{inputs:e,backend:n}=t,{params:r,indices:s}=e,o=s.shape,i=o[o.length-1],a=q(r.shape),[l,u,c,d]=Iw(r,s),f=ie({inputs:{x:s},backend:n,attrs:{shape:[u,i]}}),h=ie({inputs:{x:r},backend:n,attrs:{shape:[q(r.shape)/c,c]}});if(n.shouldExecuteOnCPU([r,s])||r.dtype==="string"){const m=n.readSync(s.dataId),b=n.bufferSync(r),x=mee(m,b,r.dtype,u,i,c,d,r.shape,a);return n.makeTensorInfo(l,r.dtype,x.values)}const p=new coe(i,d,[u,c],r.shape),g=n.runWebGLProgram(p,[h,f],h.dtype),v=ie({inputs:{x:g},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(g),v}const foe={kernelName:mN,backendName:"webgl",kernelFunc:doe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hoe{constructor(e,n){this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;const r=st(this.rank),s=poe(e);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${s}));
      }
    `}}function poe(t,e){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let s=0;s<t.length;s++)s===2?r.push("index"):r.push(`${n[s]}`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LO(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,indices:o}=e,{axis:i,batchDims:a}=r,l=De(i,s.shape)[0];if(j().get("DEBUG")){const b=n.readSync(o.dataId),x=s.shape[l];for(let y=0;y<b.length;++y){const $=b[y];D($<=x-1&&$>=0,()=>`GatherV2: the index value ${$} is not in [0, ${x-1}]`)}}const u=Yw(s,o,l,a),c=q(o.shape),d=[],f=ie({inputs:{x:s},backend:n,attrs:{shape:[u.batchSize,u.outerSize,u.dimSize,u.sliceSize]}}),h=ie({inputs:{x:o},backend:n,attrs:{shape:[u.batchSize,c/u.batchSize]}});d.push(f),d.push(h);const p=[u.batchSize,u.outerSize,c/u.batchSize,u.sliceSize];if(n.shouldExecuteOnCPU([s,o])||s.dtype==="string"){const b=n.bufferSync(h),x=n.bufferSync(f),y=gee(x,b,p);return d.forEach($=>n.disposeIntermediateTensorInfo($)),n.makeTensorInfo(u.outputShape,y.dtype,y.values)}const g=new hoe(f.shape,p),v=n.runWebGLProgram(g,[f,h],f.dtype);d.push(v);const m=ie({inputs:{x:v},backend:n,attrs:{shape:u.outputShape}});return d.forEach(b=>n.disposeIntermediateTensorInfo(b)),m}const moe={kernelName:rg,backendName:"webgl",kernelFunc:LO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const goe="return float(a > b);",voe=`
  return vec4(greaterThan(a, b));
`,boe=hn({opSnippet:goe,packedOpSnippet:voe,cpuKernelImpl:vee,dtype:"bool"}),xoe={kernelName:sg,backendName:"webgl",kernelFunc:boe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yoe="return float(a >= b);",woe=`
  return vec4(greaterThanEqual(a, b));
`,$oe=hn({opSnippet:yoe,packedOpSnippet:woe,dtype:"bool",cpuKernelImpl:bee}),Coe={kernelName:Dd,backendName:"webgl",kernelFunc:$oe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function koe(t){const{inputs:e,backend:n}=t,{input:r}=e;return OO(r,!0,n)}const Soe={kernelName:$1,backendName:"webgl",kernelFunc:koe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ioe="return float(!isnan(x) && !isinf(x));",Toe=Be({opSnippet:Ioe,dtype:"bool"}),Eoe={kernelName:Fd,backendName:"webgl",kernelFunc:Toe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Noe="return float(isinf(x));",Roe=Be({opSnippet:Noe,dtype:"bool"}),Doe={kernelName:Pd,backendName:"webgl",kernelFunc:Roe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Aoe="return float(isnan(x));",Foe=Be({opSnippet:Aoe,dtype:"bool"}),Poe={kernelName:Od,backendName:"webgl",kernelFunc:Foe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ooe="return float(a < b);",Loe=`
  return vec4(lessThan(a, b));
`,Moe=hn({opSnippet:Ooe,packedOpSnippet:Loe,cpuKernelImpl:xee,dtype:"bool"}),_oe={kernelName:ig,backendName:"webgl",kernelFunc:Moe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zoe="return float(a <= b);",Voe=`
  return vec4(lessThanEqual(a, b));
`,Boe=hn({opSnippet:zoe,packedOpSnippet:Voe,cpuKernelImpl:yee,dtype:"bool"}),Woe={kernelName:ag,backendName:"webgl",kernelFunc:Boe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uoe(t){const{backend:e,attrs:n}=t,{start:r,stop:s,num:o}=n,i=wee(r,s,o);return e.makeTensorInfo([i.length],"float32",i)}const Goe={kernelName:gN,backendName:"webgl",kernelFunc:Uoe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hoe=vu+`
  return x < 0.0 ? 0./0. : log(x);
`,joe=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,Koe=Be({opSnippet:Hoe,packedOpSnippet:joe,cpuKernelImpl:$ee}),Xoe={kernelName:Ld,backendName:"webgl",kernelFunc:Koe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qoe=vu+`
  return log(1.0 + x);
`,Yoe=Be({opSnippet:qoe}),Qoe={kernelName:Md,backendName:"webgl",kernelFunc:Yoe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zoe="return float(a >= 1.0 && b >= 1.0);",Joe=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,eie=hn({opSnippet:Zoe,packedOpSnippet:Joe,dtype:"bool"}),tie={kernelName:lg,backendName:"webgl",kernelFunc:eie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nie="return float(!(x >= 1.0));",rie=Be({opSnippet:nie}),sie={kernelName:ug,backendName:"webgl",kernelFunc:rie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oie="return float(a >= 1.0 || b >= 1.0);",iie=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,aie=hn({opSnippet:oie,packedOpSnippet:iie,dtype:"bool"}),lie={kernelName:cg,backendName:"webgl",kernelFunc:aie};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uie{constructor(e,n,r,s,o){this.variableNames=["x"],this.outputShape=[];const i=n,a=e[3]-1;this.outputShape=e;let l;const u=`float(${r}) + float(${s}) * sum`;o===.5?l=`inversesqrt(${u})`:o===1?l=`1.0/(${u})`:l=`exp(log(${u}) * float(-${o}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${i}; j <= ${i}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${a}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cie{constructor(e,n,r,s,o){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const i=n,a=e[3]-1;this.outputShape=e;let l;const u=`float(${r}) + float(${s}) * sum`;o===.5?l=`inversesqrt(${u})`:o===1?l=`1.0/(${u})`:l=`exp(log(${u}) * float(-${o}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${i};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${i}; j <= ${i}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${a}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const die=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{depthRadius:o,bias:i,alpha:a,beta:l}=r,u=j().getBool("WEBGL_PACK_NORMALIZATION")?new cie(s.shape,o,i,a,l):new uie(s.shape,o,i,a,l);return n.runWebGLProgram(u,[s],s.dtype)},fie={kernelName:dg,backendName:"webgl",kernelFunc:die};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hie{constructor(e,n,r,s,o){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=n,this.bias=r,this.alpha=s,this.beta=o,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${n})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${n} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${s}) * norm + float(${r});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${s})
                * float(${o})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${o});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pie=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s,y:o,dy:i}=e,{depthRadius:a,bias:l,alpha:u,beta:c}=r,d=new hie(s.shape,a,l,u,c);return n.runWebGLProgram(d,[s,o,i],s.dtype)},mie={kernelName:k1,backendName:"webgl",kernelFunc:pie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gie(t,e,n,r){const s=q(e),i=q(t.shape)/s,a=ie({inputs:{x:t},attrs:{shape:[i,s]},backend:r}),l=Ma(a,t.dtype,"max",r),u=ie({inputs:{x:l},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(l),u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MO(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{reductionIndices:o,keepDims:i}=r,a=s.shape.length,l=De(o,s.shape);let u=l;const c=It(u,a),d=c!=null,f=n.shouldExecuteOnCPU([s]);let h=s;if(d){if(f){const x=n.texData.get(h.dataId).values,y=new Array(a);for(let k=0;k<y.length;k++)y[k]=s.shape[c[k]];const $=A$(x,s.shape,s.dtype,c,y);h=n.makeTensorInfo(y,s.dtype);const C=n.texData.get(h.dataId);C.values=$}else h=f0(s,c,n);u=Ot(u.length,a)}fn("max",u,a);const[p,g]=sn(h.shape,u);let v=p;i&&(v=Vt(p,l));let m;if(f){const x=n.texData.get(h.dataId).values,y=Cee(x,q(g),v,s.dtype);m=n.makeTensorInfo(v,s.dtype);const $=n.texData.get(m.dataId);$.values=y}else m=gie(h,g,v,n);return d&&n.disposeIntermediateTensorInfo(h),m}const vie={kernelName:fg,backendName:"webgl",kernelFunc:MO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bie=F$+`
  return max(a, b);
`,xie=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+La+`
  return result;
`,yie=hn({opSnippet:bie,packedOpSnippet:xie,cpuKernelImpl:kee}),wie={kernelName:_d,backendName:"webgl",kernelFunc:yie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ie(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;If(s,"maxPool");const{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=r,u=1;D(wn(i,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const c=Zr(s.shape,o,i,u,a,l);if(c.filterWidth===1&&c.filterHeight===1&&Ye(c.inShape,c.outShape))return ir({inputs:{x:s},backend:n});const d=new Jc(c,"max",!1);return n.runWebGLProgram(d,[s],s.dtype)}const Cie={kernelName:hg,backendName:"webgl",kernelFunc:$ie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kie(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:o,strides:i,pad:a,dataFormat:l,dimRoundingMode:u}=r,c=[1,1,1],d=$o(s.shape,o,i,c,a,u,l),f=new O$(d,"max",!1);return n.runWebGLProgram(f,[s],s.dtype)}const Sie={kernelName:pg,backendName:"webgl",kernelFunc:kie};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Iie{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideHeight,r=e.strideWidth,s=e.dilationHeight,o=e.effectiveFilterHeight,i=e.effectiveFilterWidth,a=o-1-e.padInfo.top,l=i-1-e.padInfo.left,u=o*i-1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${o};
          wR += ${s}) {
          float dyR = float(dyRCorner + wR) / ${n}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${i}; wC++) {
            float dyC = float(dyCCorner + wC) / ${r}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${u} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${i} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class Tie{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideDepth,r=e.strideHeight,s=e.strideWidth,o=e.dilationDepth,i=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterDepth,u=e.effectiveFilterHeight,c=e.effectiveFilterWidth,d=l-1-e.padInfo.front,f=u-1-e.padInfo.top,h=c-1-e.padInfo.left,p=l*u*c-1;this.userCode=`
      const ivec3 pads = ivec3(${d}, ${f}, ${h});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${o}) {
          float dyD = float(dyDCorner + wD) / ${n}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${u};
              wR += ${i}) {
            float dyR = float(dyRCorner + wR) / ${r}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${c};
                wC += ${a}) {
              float dyC = float(dyCCorner + wC) / ${s}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${p} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${u} * ${c} +
                  wR * ${c} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eie(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:o}=e,i=o,{filterSize:a,strides:l,pad:u,dimRoundingMode:c}=r,d=[1,1,1],f=$o(i.shape,a,l,d,u,c),h=new O$(f,"max",!0),p=n.runWebGLProgram(h,[i],i.dtype),g=new Tie(f),v=n.runWebGLProgram(g,[s,p],i.dtype);return n.disposeIntermediateTensorInfo(p),v}const Nie={kernelName:I1,backendName:"webgl",kernelFunc:Eie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rie(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:o,output:i}=e,a=o;If([o,i],"maxPoolGrad");const{filterSize:l,strides:u,pad:c,dimRoundingMode:d}=r,f=Zr(a.shape,l,u,1,c,d),h=!0,p=new Jc(f,"max",h),g=n.runWebGLProgram(p,[a],a.dtype),v=new Iie(f),m=n.runWebGLProgram(v,[s,g],a.dtype);return n.disposeIntermediateTensorInfo(g),m}const Die={kernelName:S1,backendName:"webgl",kernelFunc:Rie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aie(t,e,n,r){let s=new Jc(n,"max",!1);const o=r.runWebGLProgram(s,[t],"float32");s=new Jc(n,"max",!0,!0,e);const i=r.runWebGLProgram(s,[t],"float32");return[o,i]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fie={kernelName:vN,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{filterSize:s,strides:o,pad:i,includeBatchInIndex:a}=e,l=n;D(r.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${r.shape.length}.`);const u=[1,1];D(wn(o,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const c=Zr(r.shape,s,o,u,i),[d,f]=Aie(r,a,c,l);return[d,f]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pie(t,e,n,r){const s=q(e),i=q(t.shape)/s,a=ie({inputs:{x:t},attrs:{shape:[i,s]},backend:r}),l=Ma(a,"float32","mean",r),u=ie({inputs:{x:l},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(l),u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oie={kernelName:mg,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{keepDims:s,axis:o}=e,i=n,a=r.shape.length,l=De(o,r.shape);let u=l;const c=It(u,a),d=c!=null,f=i.shouldExecuteOnCPU([r]),h=[];let p=r;if(d){if(f){const y=i.texData.get(p.dataId).values,$=new Array(a);for(let w=0;w<$.length;w++)$[w]=r.shape[c[w]];const C=A$(y,r.shape,r.dtype,c,$);p=i.makeTensorInfo($,r.dtype);const k=i.texData.get(p.dataId);k.values=C}else p=f0(r,c,i);h.push(p),u=Ot(u.length,a)}fn("sum",u,a);const[g,v]=sn(p.shape,u);let m=g;s&&(m=Vt(g,l));const b=Pie(p,v,m,i);for(const x of h)i.disposeIntermediateTensorInfo(x);return b}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lie(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,keepDims:i}=r,a=s.shape.length,l=De(o,s.shape);let u=l;const c=It(u,a);let d=s;c!=null&&(d=On({inputs:{x:s},backend:n,attrs:{perm:c}}),u=Ot(u.length,s.shape.length)),fn("min",u,a);const[f,h]=sn(d.shape,u),p=q(h),g=ie({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}}),v=Ma(g,g.dtype,"min",n);let m;if(i){const b=Vt(f,l);m=ie({inputs:{x:v},backend:n,attrs:{shape:b}})}else m=ie({inputs:{x:v},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(v),c!=null&&n.disposeIntermediateTensorInfo(d),m}const Mie={kernelName:gg,backendName:"webgl",kernelFunc:Lie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _ie=F$+`
  return min(a, b);
`,zie=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+La+`
  return result;
`,Vie=hn({opSnippet:_ie,packedOpSnippet:zie,cpuKernelImpl:See}),Bie={kernelName:zd,backendName:"webgl",kernelFunc:Vie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wie{constructor(e,n,r){this.variableNames=["x"],this.outputShape=n.map((c,d)=>c[0]+e[d]+c[1]);const s=e.length,o=st(s),i=n.map(c=>c[0]).join(","),a=n.map((c,d)=>c[0]+e[d]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,s),u=r==="reflect"?0:1;if(s===1){this.userCode=`
        int start = ${i};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${u};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${u};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${o} start = ${o}(${i});
      ${o} end = ${o}(${a});

      void main() {
        ${o} outC = getOutputCoords();
        for (int i = 0; i < ${s}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${u};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${u};
          }
        }
        ${o} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Uie{constructor(e,n,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((p,g)=>p[0]+e[g]+p[1]);const s=e.length,o=st(s),i=n.map(p=>p[0]).join(","),a=n.map((p,g)=>p[0]+e[g]).join(","),l=Dn("rc",s),u=Dn("source",s),c=`${l[s-1]} < ${this.outputShape[s-1]}`,d=s===1?"source":`vec2(${u.slice(-2).join()})`,f=r==="reflect"?0:1;let h="";if(s===1){const p=`
        ${o} source = rc;
        if (source < start) {
          source = start * 2 - source - ${f};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${f};
        }
        source -= start;
      `;h=`
        ${o} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${u.join()}), ${d});
        ${l[s-1]} += 1;
        if(${c}) {
          ${p}
          result[1] = getChannel(getX(${u.join()}), ${d});
        }
      `}else{const p=`
        ${o} source = rc;
        ${o} lt = ${o}(lessThan(source, start));
        ${o} gte = ${o}(greaterThanEqual(source, end));
        ${o} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${f}) +
                gte * ((end - 1) * 2 - source + ${f});
        source -= start;
      `;h=`
        ${o} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${u.join()}), ${d});
        ${l[s-1]} += 1;
        if(${c}) {
          ${p}
          result[1] = getChannel(getX(${u.join()}), ${d});
        }
        rc = outputLoc;
        ${l[s-2]} += 1;
        if(${l[s-2]} < ${this.outputShape[s-2]}) {
          ${p}
          result[2] = getChannel(getX(${u.join()}), ${d});
          ${l[s-1]} += 1;
          if(${c}) {
            ${p}
            result[3] = getChannel(getX(${u.join()}), ${d});
          }
        }
      `}this.userCode=`
      const ${o} start = ${o}(${i});
      const ${o} end = ${o}(${a});

      void main() {
        ${o} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${h}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gie=({inputs:t,backend:e,attrs:n})=>{const{x:r}=t,{paddings:s,mode:o}=n,i=j().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Uie(r.shape,s,o):new Wie(r.shape,s,o);return e.runWebGLProgram(i,[r],r.dtype)},Hie={kernelName:vg,backendName:"webgl",kernelFunc:Gie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jie=`if (b == 0.0) return NAN;
  return mod(a, b);`,Kie=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+La+`
  return result;
`,Xie=hn({opSnippet:jie,packedOpSnippet:Kie}),qie={kernelName:Vd,backendName:"webgl",kernelFunc:Xie};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Yie{constructor(e,n,r){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,r],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${n-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${n-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qie=`
if (a == b) {
  return 1.0;
};
return a / b;`,Zie=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,_O=hn({opSnippet:Qie,packedOpSnippet:Zie,checkOutOfBounds:!0}),Jie={kernelName:kd,backendName:"webgl",kernelFunc:_O};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gI="return a - b;",zO=hn({opSnippet:gI,packedOpSnippet:gI,supportsComplex:!0,cpuKernelImpl:jee}),eae={kernelName:nf,backendName:"webgl",kernelFunc:zO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VO(t){const{inputs:e,backend:n,attrs:r}=t,{logits:s}=e,{dim:o}=r,i=De([o],s.shape),a=MO({inputs:{x:s},backend:n,attrs:{reductionIndices:i,keepDims:!1}}),l=Vt(a.shape,i),u=ie({inputs:{x:a},backend:n,attrs:{shape:l}}),c=zO({inputs:{a:s,b:u},backend:n}),d=PO({inputs:{x:c},backend:n}),f=h0({inputs:{x:d},backend:n,attrs:{axis:i,keepDims:!1}}),h=ie({inputs:{x:f},backend:n,attrs:{shape:l}}),p=_O({inputs:{a:d,b:h},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(h),p}const tae={kernelName:Og,backendName:"webgl",kernelFunc:VO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nae(t){const{inputs:e,backend:n,attrs:r}=t,{logits:s}=e,{numSamples:o,seed:i,normalized:a}=r,l=a?s:VO({inputs:{logits:s},backend:n,attrs:{dim:s.shape.length-1}}),u=l.shape[0],c=l.shape[1],d=new Yie(u,c,o),f=[[i]],h=n.runWebGLProgram(d,[l],"int32",f);return a||n.disposeIntermediateTensorInfo(l),h}const rae={kernelName:bN,backendName:"webgl",kernelFunc:nae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sae=es+`
  return -x;
`,oae=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function iae(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])){const o=n.texData.get(r.dataId),[i,a]=Tee(o.values,r.shape,r.dtype);return n.makeTensorInfo(a,r.dtype,i)}let s;return j().getBool("WEBGL_PACK_UNARY_OPERATIONS")?s=new zo(r.shape,oae):s=new Ps(r.shape,sae),n.runWebGLProgram(s,[r],r.dtype)}const aae={kernelName:bg,backendName:"webgl",kernelFunc:iae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lae=ww;function uae(t){fr("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l}=r,u=n.readSync(s.dataId),c=n.readSync(o.dataId),{selectedIndices:d}=lae(u,c,i,a,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const cae={kernelName:T1,backendName:"webgl",kernelFunc:uae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dae=$w;function fae(t){fr("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:u}=r,c=n.readSync(s.dataId),d=n.readSync(o.dataId),{selectedIndices:f,validOutputs:h}=dae(c,d,i,a,l,u);return[n.makeTensorInfo([f.length],"int32",new Int32Array(f)),n.makeTensorInfo([],"int32",new Int32Array([h]))]}const hae={kernelName:E1,backendName:"webgl",kernelFunc:fae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pae=Cw;function mae(t){fr("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,softNmsSigma:u}=r,c=n.readSync(s.dataId),d=n.readSync(o.dataId),f=i,h=a,p=l,g=u,{selectedIndices:v,selectedScores:m}=pae(c,d,f,h,p,g);return[n.makeTensorInfo([v.length],"int32",new Int32Array(v)),n.makeTensorInfo([m.length],"float32",new Float32Array(m))]}const gae={kernelName:N1,backendName:"webgl",kernelFunc:mae};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vae{constructor(e,n,r,s){this.variableNames=["indices"],this.outputShape=[e,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${s}), float(${r}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bae=t=>{const{inputs:e,backend:n,attrs:r}=t,{indices:s}=e,{dtype:o,depth:i,onValue:a,offValue:l}=r,u=q(s.shape),c=new vae(u,i,a,l),d=ie({inputs:{x:s},backend:n,attrs:{shape:[u]}}),f=n.runWebGLProgram(c,[d],o);n.disposeIntermediateTensorInfo(d);const h=[...s.shape,i],p=ie({inputs:{x:f},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(f),p},xae={kernelName:wg,backendName:"webgl",kernelFunc:bae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qp(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="complex64"){const s=Ef({inputs:{input:r},backend:n}),o=Qp({inputs:{x:s},backend:n}),i=p0({inputs:{input:r},backend:n}),a=Qp({inputs:{x:i},backend:n}),l=yi({inputs:{real:o,imag:a},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),l}else return Nf({attrs:{shape:r.shape,dtype:r.dtype,value:r.dtype==="string"?"":0},backend:n})}const yae={kernelName:_g,backendName:"webgl",kernelFunc:Qp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BO(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(r.dtype==="complex64"){const s=Ef({inputs:{input:r},backend:n}),o=BO({inputs:{x:s},backend:n}),i=p0({inputs:{input:r},backend:n}),a=Qp({inputs:{x:i},backend:n}),l=yi({inputs:{real:o,imag:a},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),l}else return Nf({attrs:{shape:r.shape,dtype:r.dtype,value:1},backend:n})}const wae={kernelName:yg,backendName:"webgl",kernelFunc:BO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ae(t){const{inputs:e,backend:n,attrs:r}=t,{axis:s}=r;if(e.length===1)return mx({inputs:{input:e[0]},backend:n,attrs:{dim:s}});const o=e[0].shape,i=e[0].dtype;e.forEach(c=>{Yy(o,c.shape,"All tensors passed to stack must have matching shapes"),D(i===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(c=>{const d=mx({inputs:{input:c},backend:n,attrs:{dim:s}});return a.push(d),d}),u=IO({inputs:l,backend:n,attrs:{axis:s}});return a.forEach(c=>n.disposeIntermediateTensorInfo(c)),u}const Cae={kernelName:$g,backendName:"webgl",kernelFunc:$ae};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kae{constructor(e,n,r){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((u,c)=>u[0]+e[c]+u[1]);const s=e.length,o=st(s),i=n.map(u=>u[0]).join(","),a=n.map((u,c)=>u[0]+e[c]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,s);if(s===1){this.userCode=`
        int start = ${i};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${o} start = ${o}(${i});
      ${o} end = ${o}(${a});

      void main() {
        ${o} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${o} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Sae{constructor(e,n,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((g,v)=>g[0]+e[v]+g[1]);const s=e.length,o=st(s),i=n.map(g=>g[0]).join(","),a=n.map((g,v)=>g[0]+e[v]).join(","),l=Dn("rc",s),u=Dn("source",s),c=`${l[s-1]} < ${this.outputShape[s-1]}`,d=s===1?"source":`vec2(${u.slice(-2).join()})`,f=[`${o} rc = outputLoc;`,`${l[s-1]} += 1;
       if(${c}) {
      `,s===1?"":`}
       rc = outputLoc;
       ${l[s-2]} += 1;
       if(${l[s-2]} < ${this.outputShape[s-2]}) {`,s===1?"":`  ${l[s-1]} += 1;
         if(${c}) {`],h=s===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let p="";for(let g=0,v=s===1?2:4;g<v;g++)p+=`
        ${f[g]}
        if (${h}) {
          result[${g}] = float(value);
        } else {
          ${o} source = rc - start;
          result[${g}] = getChannel(getX(${u.join()}), ${d});
        }
      `;p+=s===1?"} ":"}}",this.userCode=`
      const ${o} start = ${o}(${i});
      const ${o} end = ${o}(${a});

      void main() {
        ${o} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${p}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WO=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{paddings:o,constantValue:i}=r;if(q(s.shape)===0){const u=o.map((c,d)=>c[0]+s.shape[d]+c[1]);return Nf({backend:n,attrs:{shape:u,value:i,dtype:s.dtype}})}const a=j().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Sae(s.shape,o,i):new kae(s.shape,o,i),l=[[i]];return n.runWebGLProgram(a,[s],s.dtype,l)},Iae={kernelName:Cg,backendName:"webgl",kernelFunc:WO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tae=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,Eae=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+La+`
  return result;
`,Nae=hn({opSnippet:Tae,packedOpSnippet:Eae}),Rae={kernelName:Wd,backendName:"webgl",kernelFunc:Nae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dae(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,keepDims:i}=r,a=s.shape.length,l=[],u=De(o,s.shape);let c=u;const d=It(c,a);let f=s;d!=null&&(f=On({inputs:{x:s},backend:n,attrs:{perm:d}}),c=Ot(c.length,a),l.push(f)),fn("prod",c,a);let h;if(n.shouldExecuteOnCPU([f])){const p=n.texData.get(f.dataId).values,{outVals:g,outShape:v,outDtype:m}=Nee(f.shape,f.dtype,p,c);h=n.makeTensorInfo(v,m,g)}else{const[p,g]=sn(f.shape,c),v=q(g),m=ie({inputs:{x:f},backend:n,attrs:{shape:[-1,v]}}),b=W1(s.dtype),x=Ma(m,b,"prod",n);h=ie({inputs:{x},backend:n,attrs:{shape:p}}),l.push(m),l.push(x)}if(i){l.push(h);const p=Vt(h.shape,u);h=ie({inputs:{x:h},backend:n,attrs:{shape:p}})}return l.forEach(p=>n.disposeIntermediateTensorInfo(p)),h}const Aae={kernelName:Sg,backendName:"webgl",kernelFunc:Dae};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fae(t){const{inputs:e,backend:n,attrs:r}=t,{paramsNestedSplits:s,paramsDenseValues:o,indices:i}=e,{outputRaggedRank:a}=r,l=s.map(m=>n.readSync(m.dataId)),u=s.map(m=>m.shape),c=n.readSync(o.dataId),d=n.readSync(i.dataId),[f,h,p]=Ree(l,u,c,o.shape,o.dtype,d,i.shape,a),g=f.map(m=>n.makeTensorInfo([m.length],"int32",m)),v=n.makeTensorInfo(p,o.dtype,h);return g.concat([v])}const Pae={kernelName:xN,backendName:"webgl",kernelFunc:Fae};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oae(t){const{inputs:e,backend:n}=t,{starts:r,limits:s,deltas:o}=e,i=n.readSync(r.dataId),a=n.readSync(s.dataId),l=n.readSync(o.dataId),[u,c]=Dee(i,r.shape,r.dtype,a,s.shape,l,o.shape),d=n.makeTensorInfo([u.length],"int32",u),f=n.makeTensorInfo([c.length],r.dtype,c);return[d,f]}const Lae={kernelName:yN,backendName:"webgl",kernelFunc:Oae};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mae(t){const{inputs:e,backend:n,attrs:r}=t,{shape:s,values:o,defaultValue:i,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=r,u=n.readSync(s.dataId),c=n.readSync(o.dataId),d=n.readSync(i.dataId),f=a.map(v=>n.readSync(v.dataId)),h=a.map(v=>v.shape),[p,g]=Aee(u,s.shape,c,o.shape,o.dtype,d,i.shape,f,h,l);return n.makeTensorInfo(p,o.dtype,g)}const _ae={kernelName:wN,backendName:"webgl",kernelFunc:Mae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UO=t=>{const{backend:e,attrs:n}=t,{start:r,stop:s,step:o,dtype:i}=n,a=Fee(r,s,o,i);return e.makeTensorInfo([a.length],i,a)},zae={kernelName:R1,backendName:"webgl",kernelFunc:UO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vae="return 1.0 / x;",Bae=Be({opSnippet:Vae}),Wae={kernelName:Ud,backendName:"webgl",kernelFunc:Bae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uae=es+`
  return (x < 0.0) ? 0.0 : x;
`,Gae=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Hae=Be({opSnippet:Uae,packedOpSnippet:Gae}),jae={kernelName:Gd,backendName:"webgl",kernelFunc:Hae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kae=es+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Xae=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,qae=Be({opSnippet:Kae,packedOpSnippet:Xae}),Yae={kernelName:Hd,backendName:"webgl",kernelFunc:qae};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qae{constructor(e,n,r,s,o){this.variableNames=["A"],this.outputShape=[];const[i,a,l,u]=e;this.outputShape=[i,n,r,u];const c=[s&&n>1?a-1:a,s&&r>1?l-1:l],d=[s&&n>1?n-1:n,s&&r>1?r-1:r];let f;o?f="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":f="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/d[0]},
          ${c[1]/d[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${f};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Zae{constructor(e,n,r,s,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,a,l,u]=e;this.outputShape=[i,n,r,u];const c=[s&&n>1?a-1:a,s&&r>1?l-1:l],d=[s&&n>1?n-1:n,s&&r>1?r-1:r];let f;o?f="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":f="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/d[0]},
          ${c[1]/d[1]},
          ${c[1]/d[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${f};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${r-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jae(t){const{inputs:e,backend:n,attrs:r}=t,{images:s}=e,{alignCorners:o,halfPixelCenters:i,size:a}=r,[l,u]=a,c=j().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Zae(s.shape,l,u,o,i):new Qae(s.shape,l,u,o,i);return n.runWebGLProgram(c,[s],"float32")}const ele={kernelName:Eg,backendName:"webgl",kernelFunc:Jae};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tle{constructor(e,n,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,s,o]=n,[,i,a]=e,l=[r&&i>1?s-1:s,r&&a>1?o-1:o],u=[r&&i>1?i-1:i,r&&a>1?a-1:a],c=l[0]/u[0],d=l[1]/u[1],f=1/c,h=1/d,p=Math.ceil(f)*2+2,g=Math.ceil(h)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${d});

        const float invHeightScale = float(${f});
        const float invWidthScale = float(${h});

        const int winHeight = int(${p});
        const int winWidth = int(${g});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${s-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${o-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nle(t){const{inputs:e,backend:n,attrs:r}=t,{images:s,dy:o}=e,{alignCorners:i}=r,a=new tle(o.shape,s.shape,i);return n.runWebGLProgram(a,[o],o.dtype)}const rle={kernelName:F1,backendName:"webgl",kernelFunc:nle};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sle{constructor(e,n,r,s,o){this.variableNames=["A"],this.outputShape=[];const[i,a,l,u]=e;this.outputShape=[i,n,r,u];const c=[s&&n>1?a-1:a,s&&r>1?l-1:l],d=[s&&n>1?n-1:n,s&&r>1?r-1:r],f=s?"0.5":"0.0";let h;o?h="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":h="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/d[0]},
          ${c[1]/d[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${h};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${f})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ole{constructor(e,n,r,s,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,a,l,u]=e;this.outputShape=[i,n,r,u];const c=[s&&n>1?a-1:a,s&&r>1?l-1:l],d=[s&&n>1?n-1:n,s&&r>1?r-1:r],f=s?"0.5":"0.0";let h;o?h="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":h="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/d[0]},
          ${c[1]/d[1]},
          ${c[1]/d[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${h};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${f})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${r-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ile(t){const{inputs:e,backend:n,attrs:r}=t,{images:s}=e,{alignCorners:o,halfPixelCenters:i,size:a}=r,[l,u]=a,c=j().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new ole(s.shape,l,u,o,i):new sle(s.shape,l,u,o,i);return n.runWebGLProgram(c,[s],s.dtype)}const ale={kernelName:Tg,backendName:"webgl",kernelFunc:ile};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lle{constructor(e,n,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,s,o]=n,[,i,a]=e,l=[r&&i>1?s-1:s,r&&a>1?o-1:o],u=[r&&i>1?i-1:i,r&&a>1?a-1:a],c=l[0]/u[0],d=l[1]/u[1],f=1/c,h=1/d,p=Math.ceil(f)*2+2,g=Math.ceil(h)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${d});

        const float invHeightScale = float(${f});
        const float invWidthScale = float(${h});

        const int winHeight = int(${p});
        const int winWidth = int(${g});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${u[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${u[1]}));

            int sourceNearestRow = int(min(
                float(int(${s}) - 1),
                ${r} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${o}) - 1),
                ${r} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ule(t){const{inputs:e,backend:n,attrs:r}=t,{images:s,dy:o}=e,{alignCorners:i}=r,a=new lle(o.shape,s.shape,i);return n.runWebGLProgram(a,[o],o.dtype)}const cle={kernelName:A1,backendName:"webgl",kernelFunc:ule};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dle{constructor(e,n){this.variableNames=["x"];const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);if(this.outputShape=e,r===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}const s=a=>n.indexOf(a)!==-1&&e[a]!==1?`${e[a]} - coords[${a}] - 1`:`coords[${a}]`,o=e.map((a,l)=>s(l)).join(","),i=st(r);this.userCode=`
      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${o}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fle{constructor(e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);this.outputShape=e;const s=Dn("rc",r),o=`${s[r-1]} + 1 < ${this.outputShape[r-1]}`,i=`${s[r-2]} + 1 < ${this.outputShape[r-2]}`,a=st(r);r===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${o}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${a} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(s.slice())};
          if(${o}){
            result.g = ${u(s.slice())};
          }
          if(${i}) {
            result.b = ${c(s.slice())};
            if(${o}) {
              result.a = ${d(s.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(p){return f(p)}function u(p){return p[r-1]="("+p[r-1]+" + 1)",f(p)}function c(p){return p[r-2]="("+p[r-2]+" + 1)",f(p)}function d(p){return p[r-1]="("+p[r-1]+" + 1)",p[r-2]="("+p[r-2]+" + 1)",f(p)}function f(p){const g=e.map((b,x)=>h(x,p)),v=g.join(","),m=g.slice(-2).join(",");return`getChannel(getX(${v}), vec2(${m}))`}function h(p,g){return n.indexOf(p)!==-1&&e[p]!==1?`${e[p]} - ${g[p]} - 1`:`${g[p]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hle(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{dims:o}=r,i=s.shape.length,a=De(o,s.shape);if(i===0)return ir({inputs:{x:s},backend:n});const l=j().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new fle(s.shape,a):new dle(s.shape,a);return n.runWebGLProgram(l,[s],s.dtype)}const ple={kernelName:Ng,backendName:"webgl",kernelFunc:hle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mle{constructor(e,n){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const r=e[1],s=e[2];this.outputShape=e;let o="";typeof n=="number"?o=`float outputValue = ${n.toFixed(2)};`:o=`
        vec3 fill = vec3(${n.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${o}
          if(coordX >= 0 && coordX < ${s} && coordY >= 0 && coordY < ${r}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gle={kernelName:V1,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,{radians:s,fillValue:o,center:i}=e,a=n,l=new mle(r.shape,o),[u,c]=Pw(i,r.shape[1],r.shape[2]),d=[[u,c,Math.sin(s),Math.cos(s)]];return a.runWebGLProgram(l,[r],r.dtype,d)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vle=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,ble=Be({opSnippet:vle}),xle={kernelName:jd,backendName:"webgl",kernelFunc:ble};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yle="return inversesqrt(x);",wle=Be({opSnippet:yle,cpuKernelImpl:Pee}),$le={kernelName:Kd,backendName:"webgl",kernelFunc:wle};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class L${constructor(e,n,r,s,o,i,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;const u=st(o.length),c=st(i.length);let d="";r===1?d="i":r===2&&(d="i, j");const f=`getIndices(${d})`;let h="";s===1?h="i":s===2&&(h="i, coords[1]");const p=`getUpdates(${h})`;let g="";l&&(g="coords[0], coords[1]");const v=`getDefaultValue(${g})`,m=n>1?"strides[j]":"strides";this.userCode=`
        ${u} strides = ${u}(${o});

        void main() {
          ${c} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${n}; j++) {
              int index = round(${f});
              flattenedIndex += index * ${m};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${p};
              found = true;
            }
          }
          setOutput(mix(${v}, sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Cle{constructor(e,n,r,s,o,i,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=i;const u=st(o.length),c=st(i.length);let d="";r===1?d="i":r===2&&(d="i, j");const f=`getIndices(${d})`;let h="";s===1?h="i":s===2&&(h="i, coords[1]");const p=`getUpdates(${h})`;let g="";l&&(g="coords[0], coords[1]");const v=`getDefaultValue(${g})`,m=n>1?"strides[j]":"strides",b=n>1?"strides[j + 1]":"strides";this.userCode=`
        ${u} strides = ${u}(${o});

        void main() {
          ${c} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${e}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${n}; j+=2) {
              ivec4 index = round(${f});
              flattenedIndex += index.xz * ${m};
              if (j + 1 < ${n}) {
                flattenedIndex += index.yw * ${b};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${p};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${v}, sum, found));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kle(t){const{inputs:e,backend:n,attrs:r}=t,{indices:s,updates:o}=e,{shape:i}=r,{sliceRank:a,numUpdates:l,sliceSize:u,strides:c,outputSize:d}=Da(o,s,i),f=[d/u,u];if(d===0)return n.makeTensorInfo(i,s.dtype);const h=ie({inputs:{x:s},backend:n,attrs:{shape:[l,a]}}),p=ie({inputs:{x:o},backend:n,attrs:{shape:[l,u]}}),g=n.makeTensorInfo([],"float32",new Float32Array([0]));let v;j().getBool("WEBGL_PACK")?v=new Cle(l,a,h.shape.length,p.shape.length,c,f):v=new L$(l,a,h.shape.length,p.shape.length,c,f);const m=n.runWebGLProgram(v,[p,h,g],p.dtype),b=ie({inputs:{x:m},backend:n,attrs:{shape:i}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),b}const Sle={kernelName:$N,backendName:"webgl",kernelFunc:kle};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ile{constructor(e,n,r,s){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,r];const o="while (left < right) {",i=`for (int i = 0; i < ${Math.ceil(Math.log2(n+1))}; ++i) { if (left >= right) break;`,a=j().getNumber("WEBGL_VERSION")===2?o:i,l=s==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${a}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${l} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tle(t){const{inputs:e,backend:n,attrs:r}=t,{sortedSequence:s,values:o}=e,{side:i}=r,a=new Ile(s.shape[0],s.shape[1],o.shape[1],i),l=[[s.shape[1]]];return n.runWebGLProgram(a,[s,o],"int32",l)}const Ele={kernelName:kN,backendName:"webgl",kernelFunc:Tle};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Nle{constructor(e,n,r){this.variableNames=["c","a","b"],this.outputShape=n;let s,o;if(r>4)throw Error(`Where for rank ${r} is not yet supported`);if(r===1)o="resRC",s="resRC";else{const a=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],u=[];for(let c=0;c<n.length;c++)u.push(`${a[c]}`),c<e&&l.push(`${a[c]}`);s=l.join(),o=u.join()}const i=st(r);this.userCode=`
      void main() {
        ${i} resRC = getOutputCoords();
        float cVal = getC(${s});
        if (cVal >= 1.0) {
          setOutput(getA(${o}));
        } else {
          setOutput(getB(${o}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rle(t){const{inputs:e,backend:n}=t,{condition:r,t:s,e:o}=e,i=new Nle(r.shape.length,s.shape,s.shape.length);return n.runWebGLProgram(i,[r,s,o],sr(s.dtype,o.dtype))}const Dle={kernelName:Rg,backendName:"webgl",kernelFunc:Rle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ale=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${Yg};
  float scale = ${Qg};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,Fle=Be({opSnippet:Ale}),Ple={kernelName:Xd,backendName:"webgl",kernelFunc:Fle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ole=vu+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,Lle=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Mle=Be({opSnippet:Ole,packedOpSnippet:Lle,cpuKernelImpl:Lee}),_le={kernelName:Zd,backendName:"webgl",kernelFunc:Mle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zle=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,Vle=Be({opSnippet:zle}),Ble={kernelName:Qd,backendName:"webgl",kernelFunc:Vle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wle=vu+`
  return sin(x);
`,Ule=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${La}
  return result;
`,Gle=Be({opSnippet:Wle,packedOpSnippet:Ule}),Hle={kernelName:qd,backendName:"webgl",kernelFunc:Gle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jle=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,Kle=Be({opSnippet:jle}),Xle={kernelName:Yd,backendName:"webgl",kernelFunc:Kle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qle=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,Yle=Be({opSnippet:qle}),Qle={kernelName:Jd,backendName:"webgl",kernelFunc:Yle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zle=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockShape:o,paddings:i}=r;D(s.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const a=o.reduce((m,b)=>m*b),l=[[0,0]];l.push(...i);for(let m=1+o.length;m<s.shape.length;++m)l.push([0,0]);const u=[],c=WO({inputs:{x:s},backend:n,attrs:{paddings:l,constantValue:0}}),d=hf(c.shape,o,a,!1),f=pf(d.length,o.length,!1),h=mf(c.shape,o,a,!1),p=ie({inputs:{x:c},backend:n,attrs:{shape:d}}),g=On({inputs:{x:p},backend:n,attrs:{perm:f}}),v=ie({inputs:{x:g},backend:n,attrs:{shape:h}});return u.push(c),u.push(p),u.push(g),u.forEach(m=>n.disposeIntermediateTensorInfo(m)),v},Jle={kernelName:Fg,backendName:"webgl",kernelFunc:Zle};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eue(t){const{inputs:e,backend:n}=t,{indices:r,values:s,denseShape:o,defaultValue:i}=e;if(o.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${o.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${r.shape}`);if(s.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${s.shape}`);if(i.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${i.shape}`);const a=n.readSync(r.dataId),l=n.readSync(s.dataId),u=n.readSync(o.dataId),c=n.readSync(i.dataId)[0],[d,f,h,p,g]=_ee(a,r.shape,r.dtype,l,s.dtype,u,c);return[n.makeTensorInfo(f,r.dtype,d),n.makeTensorInfo([f[0]],s.dtype,h),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(v=>Number(v)))),n.makeTensorInfo([g.length],r.dtype,new Int32Array(g))]}const tue={kernelName:SN,backendName:"webgl",kernelFunc:eue};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nue(t){const{inputs:e,backend:n}=t,{inputIndices:r,inputShape:s,newShape:o}=e;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${r.shape}`);if(s.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${s.shape}`);if(o.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${o.shape}`);const i=Array.from(n.readSync(s.dataId)),a=n.readSync(r.dataId),l=Array.from(n.readSync(o.dataId)),[u,c,d]=zee(a,r.shape,r.dtype,i,l);return[n.makeTensorInfo(c,r.dtype,u),n.makeTensorInfo([d.length],o.dtype,new Int32Array(d))]}const rue={kernelName:IN,backendName:"webgl",kernelFunc:nue};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sue(t){const{inputs:e,backend:n}=t,{data:r,indices:s,segmentIds:o}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${s.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${o.shape}`);const i=n.readSync(r.dataId),a=n.readSync(s.dataId),l=n.readSync(o.dataId),[u,c]=hO(i,r.shape,r.dtype,a,l,!0);return n.makeTensorInfo(c,r.dtype,u)}const oue={kernelName:TN,backendName:"webgl",kernelFunc:sue};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iue(t){const{inputs:e,backend:n}=t,{data:r,indices:s,segmentIds:o}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${s.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${o.shape}`);const i=n.readSync(r.dataId),a=n.readSync(s.dataId),l=n.readSync(o.dataId),[u,c]=hO(i,r.shape,r.dtype,a,l);return n.makeTensorInfo(c,r.dtype,u)}const aue={kernelName:EN,backendName:"webgl",kernelFunc:iue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lue(t){const{inputs:e,backend:n,attrs:r}=t,{sparseIndices:s,sparseValues:o,defaultValue:i}=e,{outputShape:a}=r,{sliceRank:l,numUpdates:u,sliceSize:c,strides:d,outputSize:f}=Da(o,s,a),h=!1;if(o.dtype==="string"){const m=n.bufferSync(s),b=n.bufferSync(o),x=ri(n.readSync(i.dataId)[0]),y=Oee(m,b,a,f,c,u,l,d,x,h);return n.makeTensorInfo(a,y.dtype,y.values)}const p=new L$(u,l,s.shape.length,o.shape.length,d,[f,1],h),g=n.runWebGLProgram(p,[o,s,i],o.dtype),v=ie({inputs:{x:g},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(g),v}const uue={kernelName:NN,backendName:"webgl",kernelFunc:lue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cue(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{numOrSizeSplits:o,axis:i}=r,a=De(i,s.shape)[0],l=qw(s,o,a),u=s.shape.length,c=new Array(u).fill(0),d=s.shape.slice();return l.map(f=>{const h=[...d];h[a]=f;const p=bu({inputs:{x:s},backend:n,attrs:{begin:c,size:h}});return c[a]+=f,p})}const due={kernelName:Pg,backendName:"webgl",kernelFunc:cue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vI="return sqrt(x);",fue=Be({opSnippet:vI,packedOpSnippet:vI,cpuKernelImpl:Vee}),hue={kernelName:ef,backendName:"webgl",kernelFunc:fue};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pue="return x * x;",mue=Be({opSnippet:pue}),gue={kernelName:P1,backendName:"webgl",kernelFunc:mue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bI="return (a - b) * (a - b);",vue=hn({opSnippet:bI,packedOpSnippet:bI}),bue={kernelName:tf,backendName:"webgl",kernelFunc:vue};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xue(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;if(s.dtype!=="string")throw new Error("Input must be of datatype string");const o=n.readSync(s.dataId),i=xo(o),a=Bee(i,"string",r);return n.makeTensorInfo(s.shape,"string",a)}const yue={kernelName:O1,backendName:"webgl",kernelFunc:xue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wue({inputs:t,attrs:e,backend:n}){const{x:r}=t,s=es+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,o=new Ps(r.shape,s);return n.runWebGLProgram(o,[r],r.dtype)}const $ue={kernelName:af,backendName:"webgl",kernelFunc:wue};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Cue{constructor(e,n,r){this.variableNames=["x"],this.outputShape=r;const s=r.length,o=st(r.length),i=st(r.length);let a="";if(s===1)a="coords * strides + begin";else{let l=0;a=r.map((u,c)=>(l++,r.length===1?`coords * strides[${c}] + begin[${c}]`:`coords[${l-1}] * strides[${c}] + begin[${c}]`)).join(",")}this.userCode=`
      ${o} begin = ${o}(${e});
      ${o} strides = ${o}(${n});

      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kue(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{begin:o,end:i,strides:a,beginMask:l,endMask:u,ellipsisMask:c,newAxisMask:d,shrinkAxisMask:f}=r,{finalShapeSparse:h,finalShape:p,isIdentity:g,sliceDim0:v,isSimpleSlice:m,begin:b,end:x,strides:y}=Dw(s.shape,o,i,a,l,u,c,d,f);let $;if(g)$=ie({inputs:{x:s},backend:n,attrs:{shape:p}});else if(v||m){D(s.shape.length>=1,()=>`Input must have rank at least 1, got: ${s.shape.length}`);const k=Ew(b,x,y),w=bu({inputs:{x:s},backend:n,attrs:{begin:b,size:k}});$=ie({inputs:{x:w},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(w)}else if(n.shouldExecuteOnCPU([s])){const w=n.readSync(s.dataId),I=Re(s.shape,s.dtype,w),N=Wee(h,I,y,b);$=n.makeTensorInfo(p,s.dtype,N.values)}else{const w=new Cue(b,y,h);$=n.runWebGLProgram(w,[s],s.dtype)}const C=ie({inputs:{x:$},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo($),C}const Sue={kernelName:L1,backendName:"webgl",kernelFunc:kue};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iue(t){const{inputs:e,backend:n,attrs:r}=t,{separator:s,nGramWidths:o,leftPad:i,rightPad:a,padWidth:l,preserveShortSequences:u}=r,{data:c,dataSplits:d}=e,f=n.readSync(c.dataId),h=n.readSync(d.dataId),[p,g]=Uee(f,h,s,o,i,a,l,u);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(d.shape,"int32",g)]}const Tue={kernelName:RN,backendName:"webgl",kernelFunc:Iue};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eue(t){const{inputs:e,backend:n,attrs:r}=t,{skipEmpty:s}=r,{input:o,delimiter:i}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(o.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${o.shape}`);if(i.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);const a=n.readSync(o.dataId),l=n.readSync(i.dataId)[0],[u,c,d]=Gee(a,l,s),f=c.length;return[n.makeTensorInfo([f,2],"int32",u),n.makeTensorInfo([f],"string",c),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const Nue={kernelName:DN,backendName:"webgl",kernelFunc:Eue};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rue(t){const{inputs:e,backend:n,attrs:r}=t,{numBuckets:s}=r,{input:o}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(s<=0)throw new Error("Number of buckets must be at least 1");const i=n.readSync(o.dataId),a=Hee(i,s);return n.makeTensorInfo(o.shape,"int32",a)}const Due={kernelName:AN,backendName:"webgl",kernelFunc:Rue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Aue="return tan(x);",Fue=Be({opSnippet:Aue}),Pue={kernelName:rf,backendName:"webgl",kernelFunc:Fue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oue=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,Lue=Be({opSnippet:Oue}),Mue={kernelName:sf,backendName:"webgl",kernelFunc:Lue};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ue(t){const{inputs:e,backend:n,attrs:r}=t,{tensor:s,indices:o,updates:i}=e,{sliceRank:a,numUpdates:l,sliceSize:u,strides:c,outputSize:d}=Da(i,o,s.shape),f=[d/u,u];if(d===0)return n.makeTensorInfo(s.shape,o.dtype);const h=ie({inputs:{x:o},backend:n,attrs:{shape:[l,a]}}),p=ie({inputs:{x:i},backend:n,attrs:{shape:[l,u]}}),g=ie({inputs:{x:s},backend:n,attrs:{shape:f}}),v=new L$(l,a,h.shape.length,p.shape.length,c,f,!1,!0),m=n.runWebGLProgram(v,[p,h,g],g.dtype),b=ie({inputs:{x:m},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),b}const zue={kernelName:CN,backendName:"webgl",kernelFunc:_ue};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Vue{constructor(e,n){this.variableNames=["A"];const r=new Array(e.length);for(let i=0;i<r.length;i++)r[i]=e[i]*n[i];this.outputShape=r,this.rank=r.length;const s=st(this.rank),o=Bue(e);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        setOutput(getA(${o}));
      }
    `}}function Bue(t){const e=t.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${t[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let s=0;s<t.length;s++)r.push(`imod(${n[s]}, ${t[s]})`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GO(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{reps:o}=r;if(s.dtype==="string"||s.shape.length>5){const l=n.readSync(s.dataId),u=s.dtype==="string"?l.map(f=>ri(f)):l,c=Re(s.shape,s.dtype,u),d=Kee(c,o);return n.makeTensorInfo(d.shape,d.dtype,d.values)}const i=new Vue(s.shape,o);return n.runWebGLProgram(i,[s],s.dtype)}const Wue={kernelName:of,backendName:"webgl",kernelFunc:GO};class Uue{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class Gue{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ci(t,e){e!==null&&t.disposeIntermediateTensorInfo(e)}function xI(t){let e=1;for(;e<t;)e*=2;return e}function Hue(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{k:o,sorted:i}=r,a=j().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=j().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),u=s.shape,c=u[u.length-1];if(n.shouldExecuteOnCPU([s])||c<a||o>l){const N=n.readSync(s.dataId),[E,R]=Xee(N,u,s.dtype,o,i);return[n.makeTensorInfo(E.shape,E.dtype,E.values),n.makeTensorInfo(R.shape,R.dtype,R.values)]}if(o===0)return u[u.length-1]=0,[n.makeTensorInfo(u,s.dtype,[]),n.makeTensorInfo(u,"int32",[])];if(c===1)return[s,Nf({attrs:{shape:u,dtype:"int32",value:0},backend:n})];const d=n.texData.get(s.dataId),f=d!==null&&d.isPacked,h=f?n.unpackTensor(s):s,g=q(u)/c,v=ie({inputs:{x:h},attrs:{shape:[g,c]},backend:n});f&&Ci(n,h);const m=xI(o),b=xI(c);let x=null;const y=()=>x===null?[v,v]:[v,x],$=(N,E,R)=>{const S=y(),T=new Uue(R),L=[[c],[x===null?1:0],[Number.NEGATIVE_INFINITY],[N],[E]],G=x;x=n.runWebGLProgram(T,S,"int32",L),Ci(n,G)};for(let N=1;N<m;N*=2){const E=N*2;for(let R=N;R>=1;R/=2)$(E,R,[g,b])}for(let N=b;N>m;N/=2){const E=y(),R=new Gue([g,N/2]),T=[[c],[x===null?1:0],[m]],F=x;x=n.runWebGLProgram(R,E,"int32",T),Ci(n,F);const L=m/2,G=L*2;for(let P=L;P>=1;P/=2)$(G,P,x.shape)}let C=x;x=bu({inputs:{x},backend:n,attrs:{begin:0,size:[g,o]}}),Ci(n,C);let k=LO({inputs:{x:v,indices:x},backend:n,attrs:{axis:1,batchDims:1}});Ci(n,v);const w=u.slice(0,-1);w.push(o),C=x,x=ie({inputs:{x},attrs:{shape:w},backend:n}),Ci(n,C);const I=k;return k=ie({inputs:{x:k},attrs:{shape:w},backend:n}),Ci(n,I),[k,x]}const jue={kernelName:M1,backendName:"webgl",kernelFunc:Hue};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Kue{constructor(e,n,r,s,o,i){this.variableNames=["Image","Transforms"],this.outputShape=i;const a=r==="nearest"?1:2;let l;switch(s){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${n}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${o});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${o});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${n}));
                float mapY = mapCoord(inY, float(${e}));

                if (${a} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xue(t){const{inputs:e,backend:n,attrs:r}=t,{image:s,transforms:o}=e,{interpolation:i,fillMode:a,fillValue:l,outputShape:u}=r,[c,d,f,h]=s.shape,[p,g]=u??[d,f],v=[c,p,g,h],m=new Kue(d,f,i,a,l,v);return n.runWebGLProgram(m,[s,o],"float32")}const que={kernelName:_1,backendName:"webgl",kernelFunc:Xue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yue(t){const{inputs:e,attrs:n,backend:r}=t,{axis:s}=n,{x:o}=e;If(o,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const i=r.readSync(o.dataId),{outputValues:a,outputShape:l,indices:u}=qee(i,s,o.shape,o.dtype);return[r.makeTensorInfo(l,o.dtype,a),r.makeTensorInfo([u.length],"int32",u)]}const Que={kernelName:z1,backendName:"webgl",kernelFunc:Yue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zue(t){const{inputs:e,backend:n,attrs:r}=t,{value:s}=e;let{axis:o}=r;o<0&&(o+=s.shape.length);const i=s,a=i.shape.length,l=s.shape[o],u=new Array(a-1);let c=0;for(let g=0;g<a;g++)g!==o&&(u[c++]=i.shape[g]);const d=[],f=new Array(a).fill(0),h=i.shape.slice();h[o]=1;const p=new Array(l);for(let g=0;g<p.length;g++){f[o]=g;const v=bu({inputs:{x:i},backend:n,attrs:{begin:f,size:h}}),m=ie({inputs:{x:v},backend:n,attrs:{shape:u}});p[g]=m,d.push(v)}return d.forEach(g=>n.disposeIntermediateTensorInfo(g)),p}const Jue={kernelName:Lg,backendName:"webgl",kernelFunc:Zue};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ece{constructor(e,n){this.variableNames=["x","segmentIds"];const r=e.windowSize,s=e.batchSize,o=e.inSize,i=e.numSegments,a=i*Math.ceil(o/r);this.outputShape=[s,a];const l="0.0",u="sumValue",c=Math.floor(r/4)*4,d=r%4,f=`
        sumValue += dot(values, segFilter);
    `;let h="";o%r>0&&(h=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return initializationValue;
        }
      `);let p="";o%r>0&&(p=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${h}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${p}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${i})) * float(${r}));
        int currentSeg = int(mod(float(outIdx), float(${i})));

        float sumValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${f}
        }

        int inIdx = inOffset + ${c};
        if (${d===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${f}
        } else if (${d===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${f}
        } else if (${d===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${f}
        }
        setOutput(${u});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tce(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,segmentIds:o}=e,{numSegments:i}=r,a=s.shape.length,l=[];let u=0;const c=It([u],a);let d=s;c!=null&&(d=On({inputs:{x:s},backend:n,attrs:{perm:c}}),l.push(d),u=Ot(1,a)[0]);const f=SD(d.shape,u,i),h=q([d.shape[u]]),p=ie({inputs:{x:d},backend:n,attrs:{shape:[-1,h]}});l.push(p);const g=W1(s.dtype),v=(y,$,C,k,w)=>{const I=y.shape[0],N=y.shape[1],E=kD(N,w),R={windowSize:E,inSize:N,batchSize:I,numSegments:w},S=new ece(R,$),T=n.compileAndRun(S,[y,C],k);if(l.push(T),T.shape[1]===w)return T;const F=UO({backend:n,attrs:{start:0,stop:w,step:1,dtype:"float32"}}),L=GO({inputs:{x:F},backend:n,attrs:{reps:[N/E]}});return l.push(F),l.push(L),v(T,$,L,k,w)},m=v(p,"unsortedSegmentSum",o,g,i),b=ie({inputs:{x:m},backend:n,attrs:{shape:f}});let x=b;if(c!=null){l.push(b);const y=mi(c);x=On({inputs:{x},backend:n,attrs:{perm:y}})}return l.forEach(y=>n.disposeIntermediateTensorInfo(y)),x}const nce={kernelName:Mg,backendName:"webgl",kernelFunc:tce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rce=[Vte,Wte,Hte,Xte,Yte,Jte,tne,rne,ane,une,fne,mne,bne,$ne,Sne,Tne,Nne,Fne,One,Mne,Bne,Xne,Yne,ere,nre,lre,cre,pre,Cte,vre,$re,Ire,Are,Ore,Mre,zre,Bre,Hre,Xre,Qre,Jre,tse,rse,ise,lse,fse,pse,vse,yse,$se,Ise,Rse,Pse,Mse,Vse,Bse,Use,Hse,Kse,qse,Qse,toe,soe,aoe,uoe,foe,moe,xoe,Coe,$te,Soe,yre,Eoe,Doe,Poe,Ste,_oe,Woe,Goe,Xoe,Qoe,tie,sie,lie,fie,mie,vie,wie,Cie,Sie,Nie,Die,Fie,Oie,Mie,Bie,Hie,qie,rae,Ete,aae,cae,hae,gae,sre,xae,wae,Cae,Iae,Rae,Tte,Aae,Pae,Lae,_ae,zae,ore,Jie,Wae,jae,Yae,Rte,ele,rle,ale,cle,ple,gle,xle,$le,Sle,Ele,Dle,Ple,_le,Ble,Hle,Xle,jne,tae,Qle,Jle,tue,rue,oue,aue,uue,due,hue,gue,bue,yue,$ue,Sue,Tue,Nue,Due,eae,Mte,Pue,Mue,zue,Wue,jue,que,_te,Que,Jue,nce,yae];for(const t of rce)PN(t);qV("webgl").then(()=>{console.log("WebGL backend initialized")});const yI=.2,_i="level-0",pc="level-1",mc="level-2",wI={[_i]:{initialIslands:5,initialSteps:0,minInitialVirusArea:0},[pc]:{initialIslands:4,initialSteps:5,minInitialVirusArea:0},[mc]:{initialIslands:2,initialSteps:12,minInitialVirusArea:50}},bh=(t,e,n=28,r=100)=>{let s,o,i=!1;window.addEventListener("keydown",a=>{t.includes(a.key)&&!i&&(a.preventDefault(),e(),i=!0,o=setTimeout(()=>{s=setInterval(e,n)},r))}),window.addEventListener("keyup",a=>{t.includes(a.key)&&(i=!1,clearInterval(s),clearTimeout(o))})};class sce{constructor(){pn(this,"difficulty",_i);pn(this,"HEIGHT",25);pn(this,"WIDTH",30);pn(this,"grid",Ct([this.HEIGHT,this.WIDTH]));pn(this,"activeCells",Ct([this.HEIGHT,this.WIDTH]));pn(this,"virusCells",Ct([this.HEIGHT,this.WIDTH]));pn(this,"focusedCell",[0,0]);pn(this,"actionQueue",[]);pn(this,"generation",0);pn(this,"hasWon",!1);pn(this,"hasLost",!1);pn(this,"virusMoveRate",yI);pn(this,"leaveTrail",!1);pn(this,"trailSize",5);pn(this,"stats",{activeCellCount:0,virusCellCount:0,wasFocusedCellEaten:!1});pn(this,"onUpdateCallback",()=>{});this.resetGame()}resetGame(){this.grid=ko([this.HEIGHT,this.WIDTH]).mul(-1),this.activeCells=Ct([this.HEIGHT,this.WIDTH]),this.virusCells=Ct([this.HEIGHT,this.WIDTH]);const e=[Math.floor(Math.random()*this.HEIGHT),Math.floor(Math.random()*this.WIDTH)];this.focusedCell=e,this.actionQueue=[],this.generation=0,this.hasWon=!1,this.hasLost=!1,this.virusMoveRate=yI;const n=this.activeCells.arraySync(),r=this.grid.arraySync(),s=this.virusCells.arraySync();for(let i=0;i<wI[this.difficulty].initialIslands;i++){const a=[Math.floor(Math.random()*this.HEIGHT),Math.floor(Math.random()*this.WIDTH)];s[a[0]][a[1]]=1,r[a[0]][a[1]]=1}n[this.focusedCell[0]][this.focusedCell[1]]=1,r[this.focusedCell[0]][this.focusedCell[1]]=50,this.activeCells=Er(n),this.grid=Er(r),this.virusCells=Er(s);const o=wI[this.difficulty];for(let i=0;i<o.initialSteps;i++)this.step();for(;this.stats.virusCellCount<o.minInitialVirusArea;)this.step();this.generation=0}bindEvents(){bh(["w","W","ArrowUp"],()=>{this.moveTo({initialCellPosition:this.focusedCell,destinationCellPosition:[this.focusedCell[0]-1,this.focusedCell[1]]})}),bh(["s","S","ArrowDown"],()=>{this.moveTo({initialCellPosition:this.focusedCell,destinationCellPosition:[this.focusedCell[0]+1,this.focusedCell[1]]})}),bh(["a","A","ArrowLeft"],()=>{this.moveTo({initialCellPosition:this.focusedCell,destinationCellPosition:[this.focusedCell[0],this.focusedCell[1]-1]})}),bh(["d","D","ArrowRight"],()=>{this.moveTo({initialCellPosition:this.focusedCell,destinationCellPosition:[this.focusedCell[0],this.focusedCell[1]+1]})})}queueAction(e){this.actionQueue.push(e)}checkBounds([e,n]){return e>=0&&e<this.HEIGHT&&n>=0&&n<this.WIDTH}moveToMeta({initialCellPosition:e,destinationCellPosition:n,grid:r,playerCells:s,enemyCells:o,trailSize:i}){i=i||0;const a=n,l=e;if(!this.checkBounds(l)||!this.checkBounds(a))return!1;const u=r[l[0]][l[1]];let c=0;if(o[a[0]][a[1]]===1?c=r[a[0]][a[1]]:(s[a[0]][a[1]]>0&&s[l[0]][l[1]]>0,c=-r[a[0]][a[1]]),u<=c||s[l[0]][l[1]]!==1)return!1;r[l[0]][l[1]]=0,r[a[0]][a[1]]=u-c;{let d=!1;for(let f=-1;f<=1;f++)for(let h=-1;h<=1;h++)this.checkBounds([l[0]+f,l[1]+h])&&o[l[0]+f][l[1]+h]===1&&(d=!0);if(d){const f=this.leaveTrail?i-r[l[0]][l[1]]:0;i>0&&r[a[0]][a[1]]>i&&f>0&&(r[l[0]][l[1]]=f,r[a[0]][a[1]]-=f)}}return s[a[0]][a[1]]=1,o[a[0]][a[1]]=0,this.onUpdateCallback(),!0}moveTo({initialCellPosition:e,destinationCellPosition:n}){const r=this.grid.arraySync(),s=this.activeCells.arraySync(),o=this.virusCells.arraySync();this.moveToMeta({initialCellPosition:e,destinationCellPosition:n,grid:r,playerCells:s,enemyCells:o,trailSize:this.trailSize})&&(this.activeCells=Er(s),this.grid=Er(r),this.virusCells=Er(o),this.focusedCell=structuredClone(n),this.onUpdateCallback())}moveVirusTo({initialCellPosition:e,destinationCellPosition:n}){const r=this.grid.arraySync(),s=this.activeCells.arraySync(),o=this.virusCells.arraySync();this.moveToMeta({initialCellPosition:e,destinationCellPosition:n,grid:r,enemyCells:s,playerCells:o})&&(this.activeCells=Er(s),this.grid=Er(r),this.virusCells=Er(o),this.onUpdateCallback())}onCellClick([e,n]){this.activeCells.arraySync()[e][n]===1&&(this.focusedCell=[e,n]),this.onUpdateCallback()}step(){for(;this.actionQueue.length>0;)this.actionQueue.shift().call(this);this.queueAction(()=>{if(this.hasWon)return;const e=structuredClone(this.grid.arraySync()),n=this.activeCells.arraySync(),r=this.virusCells.arraySync();for(let s=0;s<this.grid.shape[0];s++)for(let o=0;o<this.grid.shape[1];o++)if(n[s][o]===1&&this.generation%5===0)e[s][o]++;else if(r[s][o]===1&&(e[s][o]++,Math.random()<this.virusMoveRate)){const i=[[s-1,o],[s+1,o],[s,o-1],[s,o+1]],a=i[Math.floor(Math.random()*i.length)];this.queueAction(()=>{this.moveVirusTo({initialCellPosition:[s,o],destinationCellPosition:a})})}this.grid=Er(e),this.detectGameStatus()||this.generation++})}detectGameStatus(){const e=this.activeCells.mul(this.grid).sum().arraySync(),n=this.virusCells.mul(this.grid).sum().arraySync();return this.stats.activeCellCount=e,this.stats.virusCellCount=n,this.stats.wasFocusedCellEaten=this.virusCells.arraySync()[this.focusedCell[0]][this.focusedCell[1]]===1,this.onUpdateCallback(),n===0?(this.hasWon=!0,!0):e===0?(this.hasLost=!0,!0):!1}}function M$(t={}){const{strict:e=!0,errorMessage:n="useContext: `context` is undefined. Seems you forgot to wrap component within the Provider",name:r}=t,s=A.createContext(void 0);s.displayName=r;function o(){var i;const a=A.useContext(s);if(!a&&e){const l=new Error(n);throw l.name="ContextError",(i=Error.captureStackTrace)==null||i.call(Error,l,o),l}return a}return[s.Provider,o,s]}function ao(t){const e=A.useRef(null);return A.useImperativeHandle(t,()=>e.current),e}var oce=(...t)=>{let e=" ";for(const n of t)if(typeof n=="string"&&n.length>0){e=n;break}return e};function HO(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(n=HO(t[e]))&&(r&&(r+=" "),r+=n);else for(e in t)t[e]&&(r&&(r+=" "),r+=e);return r}function wt(...t){for(var e=0,n,r,s="";e<t.length;)(n=t[e++])&&(r=HO(n))&&(s&&(s+=" "),s+=r);return s}function ice(t){return`${t}-${Math.floor(Math.random()*1e6)}`}function m0(t){if(!t||typeof t!="object")return"";try{return JSON.stringify(t)}catch{return""}}function ace(t,e,n){return Math.min(Math.max(t,e),n)}function _$(t){return Array.isArray(t)}function lce(t){return _$(t)&&t.length===0}function jO(t){const e=typeof t;return t!=null&&(e==="object"||e==="function")&&!_$(t)}function uce(t){return jO(t)&&Object.keys(t).length===0}function cce(t){return _$(t)?lce(t):jO(t)?uce(t):t==null||t===""}function dce(t){return typeof t=="function"}var Ne=t=>t?"true":void 0;function fce(t,e){if(t!=null){if(dce(t)){t(e);return}try{t.current=e}catch{throw new Error(`Cannot assign value '${e}' to ref '${t}'`)}}}function hce(...t){return e=>{t.forEach(n=>fce(n,e))}}var pce=new Set(["id","type","style","title","role","tabIndex","htmlFor","width","height","abbr","accept","acceptCharset","accessKey","action","allowFullScreen","allowTransparency","alt","async","autoComplete","autoFocus","autoPlay","cellPadding","cellSpacing","challenge","charset","checked","cite","class","className","cols","colSpan","command","content","contentEditable","contextMenu","controls","coords","crossOrigin","data","dateTime","default","defer","dir","disabled","download","draggable","dropzone","encType","enterKeyHint","for","form","formAction","formEncType","formMethod","formNoValidate","formTarget","frameBorder","headers","hidden","high","href","hrefLang","httpEquiv","icon","inputMode","isMap","itemId","itemProp","itemRef","itemScope","itemType","kind","label","lang","list","loop","manifest","max","maxLength","media","mediaGroup","method","min","minLength","multiple","muted","name","noValidate","open","optimum","pattern","ping","placeholder","poster","preload","radioGroup","referrerPolicy","readOnly","rel","required","rows","rowSpan","sandbox","scope","scoped","scrolling","seamless","selected","shape","size","sizes","slot","sortable","span","spellCheck","src","srcDoc","srcSet","start","step","target","translate","typeMustMatch","useMap","value","wmode","wrap"]),mce=new Set(["onCopy","onCut","onPaste","onLoad","onError","onWheel","onScroll","onCompositionEnd","onCompositionStart","onCompositionUpdate","onKeyDown","onKeyPress","onKeyUp","onFocus","onBlur","onChange","onInput","onSubmit","onClick","onContextMenu","onDoubleClick","onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onPointerDown","onPointerEnter","onPointerLeave","onPointerUp","onSelect","onTouchCancel","onTouchEnd","onTouchMove","onTouchStart","onAnimationStart","onAnimationEnd","onAnimationIteration","onTransitionEnd"]),$I=/^(data-.*)$/,gce=/^(aria-.*)$/,xh=/^(on[A-Z].*)$/;function gx(t,e={}){let{labelable:n=!0,enabled:r=!0,propNames:s,omitPropNames:o,omitEventNames:i,omitDataProps:a,omitEventProps:l}=e,u={};if(!r)return t;for(const c in t)o!=null&&o.has(c)||i!=null&&i.has(c)&&xh.test(c)||xh.test(c)&&!mce.has(c)||a&&$I.test(c)||l&&xh.test(c)||(Object.prototype.hasOwnProperty.call(t,c)&&(pce.has(c)||n&&gce.test(c)||s!=null&&s.has(c)||$I.test(c))||xh.test(c))&&(u[c]=t[c]);return u}var[Eve,g0]=M$({name:"ProviderContext",strict:!1});const Zp={prefix:String(Math.round(Math.random()*1e10)),current:0},KO=Ze.createContext(Zp),vce=Ze.createContext(!1);let bce=!!(typeof window<"u"&&window.document&&window.document.createElement),yv=new WeakMap;function xce(t=!1){let e=A.useContext(KO),n=A.useRef(null);if(n.current===null&&!t){var r,s;let o=(s=Ze.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED)===null||s===void 0||(r=s.ReactCurrentOwner)===null||r===void 0?void 0:r.current;if(o){let i=yv.get(o);i==null?yv.set(o,{id:e.current,state:o.memoizedState}):o.memoizedState!==i.state&&(e.current=i.id,yv.delete(o))}n.current=++e.current}return n.current}function yce(t){let e=A.useContext(KO);e===Zp&&!bce&&console.warn("When server rendering, you must wrap your application in an <SSRProvider> to ensure consistent ids are generated between the client and server.");let n=xce(!!t),r=`react-aria${e.prefix}`;return t||`${r}-${n}`}function wce(t){let e=Ze.useId(),[n]=A.useState(z$()),r=n?"react-aria":`react-aria${Zp.prefix}`;return t||`${r}-${e}`}const $ce=typeof Ze.useId=="function"?wce:yce;function Cce(){return!1}function kce(){return!0}function Sce(t){return()=>{}}function z$(){return typeof Ze.useSyncExternalStore=="function"?Ze.useSyncExternalStore(Sce,Cce,kce):A.useContext(vce)}const Ice=Symbol.for("react-aria.i18n.locale"),Tce=Symbol.for("react-aria.i18n.strings");let Xa;class v0{getStringForLocale(e,n){let s=this.getStringsForLocale(n)[e];if(!s)throw new Error(`Could not find intl message ${e} in ${n} locale`);return s}getStringsForLocale(e){let n=this.strings[e];return n||(n=Ece(e,this.strings,this.defaultLocale),this.strings[e]=n),n}static getGlobalDictionaryForPackage(e){if(typeof window>"u")return null;let n=window[Ice];if(Xa===void 0){let s=window[Tce];if(!s)return null;Xa={};for(let o in s)Xa[o]=new v0({[n]:s[o]},n)}let r=Xa==null?void 0:Xa[e];if(!r)throw new Error(`Strings for package "${e}" were not included by LocalizedStringProvider. Please add it to the list passed to createLocalizedStringDictionary.`);return r}constructor(e,n="en-US"){this.strings=Object.fromEntries(Object.entries(e).filter(([,r])=>r)),this.defaultLocale=n}}function Ece(t,e,n="en-US"){if(e[t])return e[t];let r=Nce(t);if(e[r])return e[r];for(let s in e)if(s.startsWith(r+"-"))return e[s];return e[n]}function Nce(t){return Intl.Locale?new Intl.Locale(t).language:t.split("-")[0]}const CI=new Map,kI=new Map;class Rce{format(e,n){let r=this.strings.getStringForLocale(e,this.locale);return typeof r=="function"?r(n,this):r}plural(e,n,r="cardinal"){let s=n["="+e];if(s)return typeof s=="function"?s():s;let o=this.locale+":"+r,i=CI.get(o);i||(i=new Intl.PluralRules(this.locale,{type:r}),CI.set(o,i));let a=i.select(e);return s=n[a]||n.other,typeof s=="function"?s():s}number(e){let n=kI.get(this.locale);return n||(n=new Intl.NumberFormat(this.locale),kI.set(this.locale,n)),n.format(e)}select(e,n){let r=e[n]||e.other;return typeof r=="function"?r():r}constructor(e,n){this.locale=e,this.strings=n}}function Dce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function XO(t,e,n){Dce(t,e),e.set(t,n)}const bt=typeof document<"u"?Ze.useLayoutEffect:()=>{};function kt(t){const e=A.useRef(null);return bt(()=>{e.current=t},[t]),A.useCallback((...n)=>{const r=e.current;return r==null?void 0:r(...n)},[])}function Ace(t){let[e,n]=A.useState(t),r=A.useRef(null),s=kt(()=>{if(!r.current)return;let i=r.current.next();if(i.done){r.current=null;return}e===i.value?s():n(i.value)});bt(()=>{r.current&&s()});let o=kt(i=>{r.current=i(e),s()});return[e,o]}let Fce=!!(typeof window<"u"&&window.document&&window.document.createElement),Jp=new Map;function em(t){let[e,n]=A.useState(t),r=A.useRef(null),s=$ce(e),o=A.useCallback(i=>{r.current=i},[]);return Fce&&Jp.set(s,o),bt(()=>{let i=s;return()=>{Jp.delete(i)}},[s]),A.useEffect(()=>{let i=r.current;i&&(r.current=null,n(i))}),s}function Pce(t,e){if(t===e)return t;let n=Jp.get(t);if(n)return n(e),e;let r=Jp.get(e);return r?(r(t),t):e}function vx(t=[]){let e=em(),[n,r]=Ace(e),s=A.useCallback(()=>{r(function*(){yield e,yield document.getElementById(e)?e:void 0})},[e,r]);return bt(s,[e,s,...t]),n}function ws(...t){return(...e)=>{for(let n of t)typeof n=="function"&&n(...e)}}const ve=t=>{var e;return(e=t==null?void 0:t.ownerDocument)!==null&&e!==void 0?e:document},je=t=>t&&"window"in t&&t.window===t?t:ve(t).defaultView||window;function qO(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var s=t.length;for(e=0;e<s;e++)t[e]&&(n=qO(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function Oce(){for(var t,e,n=0,r="",s=arguments.length;n<s;n++)(t=arguments[n])&&(e=qO(t))&&(r&&(r+=" "),r+=e);return r}function tt(...t){let e={...t[0]};for(let n=1;n<t.length;n++){let r=t[n];for(let s in r){let o=e[s],i=r[s];typeof o=="function"&&typeof i=="function"&&s[0]==="o"&&s[1]==="n"&&s.charCodeAt(2)>=65&&s.charCodeAt(2)<=90?e[s]=ws(o,i):(s==="className"||s==="UNSAFE_className")&&typeof o=="string"&&typeof i=="string"?e[s]=Oce(o,i):s==="id"&&o&&i?e.id=Pce(o,i):e[s]=i!==void 0?i:o}}return e}function Lce(...t){return t.length===1?t[0]:e=>{for(let n of t)typeof n=="function"?n(e):n!=null&&(n.current=e)}}const Mce=new Set(["id"]),_ce=new Set(["aria-label","aria-labelledby","aria-describedby","aria-details"]),zce=new Set(["href","hrefLang","target","rel","download","ping","referrerPolicy"]),Vce=/^(data-.*)$/;function b0(t,e={}){let{labelable:n,isLink:r,propNames:s}=e,o={};for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(Mce.has(i)||n&&_ce.has(i)||r&&zce.has(i)||s!=null&&s.has(i)||Vce.test(i))&&(o[i]=t[i]);return o}function nn(t){if(Bce())t.focus({preventScroll:!0});else{let e=Wce(t);t.focus(),Uce(e)}}let yh=null;function Bce(){if(yh==null){yh=!1;try{document.createElement("div").focus({get preventScroll(){return yh=!0,!0}})}catch{}}return yh}function Wce(t){let e=t.parentNode,n=[],r=document.scrollingElement||document.documentElement;for(;e instanceof HTMLElement&&e!==r;)(e.offsetHeight<e.scrollHeight||e.offsetWidth<e.scrollWidth)&&n.push({element:e,scrollTop:e.scrollTop,scrollLeft:e.scrollLeft}),e=e.parentNode;return r instanceof HTMLElement&&n.push({element:r,scrollTop:r.scrollTop,scrollLeft:r.scrollLeft}),n}function Uce(t){for(let{element:e,scrollTop:n,scrollLeft:r}of t)e.scrollTop=n,e.scrollLeft=r}function x0(t){var e;return typeof window>"u"||window.navigator==null?!1:((e=window.navigator.userAgentData)===null||e===void 0?void 0:e.brands.some(n=>t.test(n.brand)))||t.test(window.navigator.userAgent)}function V$(t){var e;return typeof window<"u"&&window.navigator!=null?t.test(((e=window.navigator.userAgentData)===null||e===void 0?void 0:e.platform)||window.navigator.platform):!1}function Qr(){return V$(/^Mac/i)}function Gce(){return V$(/^iPhone/i)}function YO(){return V$(/^iPad/i)||Qr()&&navigator.maxTouchPoints>1}function Rf(){return Gce()||YO()}function Hce(){return x0(/AppleWebKit/i)&&!jce()}function jce(){return x0(/Chrome/i)}function QO(){return x0(/Android/i)}function Kce(){return x0(/Firefox/i)}function ma(t,e,n=!0){var r,s;let{metaKey:o,ctrlKey:i,altKey:a,shiftKey:l}=e;Kce()&&(!((s=window.event)===null||s===void 0||(r=s.type)===null||r===void 0)&&r.startsWith("key"))&&t.target==="_blank"&&(Qr()?o=!0:i=!0);let u=Hce()&&Qr()&&!YO()?new KeyboardEvent("keydown",{keyIdentifier:"Enter",metaKey:o,ctrlKey:i,altKey:a,shiftKey:l}):new MouseEvent("click",{metaKey:o,ctrlKey:i,altKey:a,shiftKey:l,bubbles:!0,cancelable:!0});ma.isOpening=n,nn(t),t.dispatchEvent(u),ma.isOpening=!1}ma.isOpening=!1;let tl=new Map,bx=new Set;function SI(){if(typeof window>"u")return;function t(r){return"propertyName"in r}let e=r=>{if(!t(r)||!r.target)return;let s=tl.get(r.target);s||(s=new Set,tl.set(r.target,s),r.target.addEventListener("transitioncancel",n,{once:!0})),s.add(r.propertyName)},n=r=>{if(!t(r)||!r.target)return;let s=tl.get(r.target);if(s&&(s.delete(r.propertyName),s.size===0&&(r.target.removeEventListener("transitioncancel",n),tl.delete(r.target)),tl.size===0)){for(let o of bx)o();bx.clear()}};document.body.addEventListener("transitionrun",e),document.body.addEventListener("transitionend",n)}typeof document<"u"&&(document.readyState!=="loading"?SI():document.addEventListener("DOMContentLoaded",SI));function _a(t){requestAnimationFrame(()=>{tl.size===0?t():bx.add(t)})}function ZO(){let t=A.useRef(new Map),e=A.useCallback((s,o,i,a)=>{let l=a!=null&&a.once?(...u)=>{t.current.delete(i),i(...u)}:i;t.current.set(i,{type:o,eventTarget:s,fn:l,options:a}),s.addEventListener(o,i,a)},[]),n=A.useCallback((s,o,i,a)=>{var l;let u=((l=t.current.get(i))===null||l===void 0?void 0:l.fn)||i;s.removeEventListener(o,u,a),t.current.delete(i)},[]),r=A.useCallback(()=>{t.current.forEach((s,o)=>{n(s.eventTarget,s.type,o,s.options)})},[n]);return A.useEffect(()=>r,[r]),{addGlobalListener:e,removeGlobalListener:n,removeAllGlobalListeners:r}}function JO(t,e){let{id:n,"aria-label":r,"aria-labelledby":s}=t;return n=em(n),s&&r?s=[...new Set([n,...s.trim().split(/\s+/)])].join(" "):s&&(s=s.trim().split(/\s+/).join(" ")),!r&&!s&&e&&(r=e),{id:n,"aria-label":r,"aria-labelledby":s}}function Df(t,e){bt(()=>{if(t&&t.ref&&e)return t.ref.current=e.current,()=>{t.ref&&(t.ref.current=null)}})}function II(t,e){let n=window.getComputedStyle(t),r=/(auto|scroll)/.test(n.overflow+n.overflowX+n.overflowY);return r&&e&&(r=t.scrollHeight!==t.clientHeight||t.scrollWidth!==t.clientWidth),r}function e3(t,e){let n=t;for(II(n,e)&&(n=n.parentElement);n&&!II(n,e);)n=n.parentElement;return n||document.scrollingElement||document.documentElement}function $s(t){return t.mozInputSource===0&&t.isTrusted?!0:QO()&&t.pointerType?t.type==="click"&&t.buttons===1:t.detail===0&&!t.pointerType}function t3(t){return!QO()&&t.width===0&&t.height===0||t.width===1&&t.height===1&&t.pressure===0&&t.detail===0&&t.pointerType==="mouse"}function n3(t,e,n){let r=A.useRef(e),s=kt(()=>{n&&n(r.current)});A.useEffect(()=>{var o;let i=t==null||(o=t.current)===null||o===void 0?void 0:o.form;return i==null||i.addEventListener("reset",s),()=>{i==null||i.removeEventListener("reset",s)}},[t,s])}function B$(t,e,n){let[r,s]=A.useState(t||e),o=A.useRef(t!==void 0),i=t!==void 0;A.useEffect(()=>{let u=o.current;u!==i&&console.warn(`WARN: A component changed from ${u?"controlled":"uncontrolled"} to ${i?"controlled":"uncontrolled"}.`),o.current=i},[i]);let a=i?t:r,l=A.useCallback((u,...c)=>{let d=(f,...h)=>{n&&(Object.is(a,f)||n(f,...h)),i||(a=f)};typeof u=="function"?(console.warn("We can not support a function callback. See Github Issues for details https://github.com/adobe/react-spectrum/issues/2320"),s((h,...p)=>{let g=u(i?a:h,...p);return d(g,...c),i?h:g})):(i||s(u),d(u,...c))},[i,a,n]);return[a,l]}var r3={};r3={dismiss:""};var s3={};s3={dismiss:""};var o3={};o3={dismiss:"Odstranit"};var i3={};i3={dismiss:"Luk"};var a3={};a3={dismiss:"Schlieen"};var l3={};l3={dismiss:""};var u3={};u3={dismiss:"Dismiss"};var c3={};c3={dismiss:"Descartar"};var d3={};d3={dismiss:"Lpeta"};var f3={};f3={dismiss:"Hylk"};var h3={};h3={dismiss:"Rejeter"};var p3={};p3={dismiss:""};var m3={};m3={dismiss:"Odbaci"};var g3={};g3={dismiss:"Elutasts"};var v3={};v3={dismiss:"Ignora"};var b3={};b3={dismiss:""};var x3={};x3={dismiss:""};var y3={};y3={dismiss:"Atmesti"};var w3={};w3={dismiss:"Nerdt"};var $3={};$3={dismiss:"Lukk"};var C3={};C3={dismiss:"Negeren"};var k3={};k3={dismiss:"Zignoruj"};var S3={};S3={dismiss:"Descartar"};var I3={};I3={dismiss:"Dispensar"};var T3={};T3={dismiss:"Revocare"};var E3={};E3={dismiss:""};var N3={};N3={dismiss:"Zrui"};var R3={};R3={dismiss:"Opusti"};var D3={};D3={dismiss:"Odbaci"};var A3={};A3={dismiss:"Avvisa"};var F3={};F3={dismiss:"Kapat"};var P3={};P3={dismiss:""};var O3={};O3={dismiss:""};var L3={};L3={dismiss:""};const Xce=new Set(["Arab","Syrc","Samr","Mand","Thaa","Mend","Nkoo","Adlm","Rohg","Hebr"]),qce=new Set(["ae","ar","arc","bcc","bqi","ckb","dv","fa","glk","he","ku","mzn","nqo","pnb","ps","sd","ug","ur","yi"]);function Yce(t){if(Intl.Locale){let n=new Intl.Locale(t).maximize(),r=typeof n.getTextInfo=="function"?n.getTextInfo():n.textInfo;if(r)return r.direction==="rtl";if(n.script)return Xce.has(n.script)}let e=t.split("-")[0];return qce.has(e)}const Qce=Symbol.for("react-aria.i18n.locale");function M3(){let t=typeof window<"u"&&window[Qce]||typeof navigator<"u"&&(navigator.language||navigator.userLanguage)||"en-US";try{Intl.DateTimeFormat.supportedLocalesOf([t])}catch{t="en-US"}return{locale:t,direction:Yce(t)?"rtl":"ltr"}}let xx=M3(),ec=new Set;function TI(){xx=M3();for(let t of ec)t(xx)}function Zce(){let t=z$(),[e,n]=A.useState(xx);return A.useEffect(()=>(ec.size===0&&window.addEventListener("languagechange",TI),ec.add(n),()=>{ec.delete(n),ec.size===0&&window.removeEventListener("languagechange",TI)}),[]),t?{locale:"en-US",direction:"ltr"}:e}const Jce=Ze.createContext(null);function ede(){let t=Zce();return A.useContext(Jce)||t}const EI=new WeakMap;function tde(t){let e=EI.get(t);return e||(e=new v0(t),EI.set(t,e)),e}function nde(t,e){return e&&v0.getGlobalDictionaryForPackage(e)||tde(t)}function rde(t,e){let{locale:n}=ede(),r=nde(t,e);return A.useMemo(()=>new Rce(n,r),[n,r])}const _3=Ze.createContext({register:()=>{}});_3.displayName="PressResponderContext";function sde(t,e){return e.get?e.get.call(t):e.value}function z3(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function V3(t,e){var n=z3(t,e,"get");return sde(t,n)}function ode(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function tm(t,e,n){var r=z3(t,e,"set");return ode(t,r,n),n}function ide({children:t}){let e=A.useMemo(()=>({register:()=>{}}),[]);return Ze.createElement(_3.Provider,{value:e},t)}let ade=class{isDefaultPrevented(){return this.nativeEvent.defaultPrevented}preventDefault(){this.defaultPrevented=!0,this.nativeEvent.preventDefault()}stopPropagation(){this.nativeEvent.stopPropagation(),this.isPropagationStopped=()=>!0}isPropagationStopped(){return!1}persist(){}constructor(e,n){this.nativeEvent=n,this.target=n.target,this.currentTarget=n.currentTarget,this.relatedTarget=n.relatedTarget,this.bubbles=n.bubbles,this.cancelable=n.cancelable,this.defaultPrevented=n.defaultPrevented,this.eventPhase=n.eventPhase,this.isTrusted=n.isTrusted,this.timeStamp=n.timeStamp,this.type=e}};function lde(t){let e=A.useRef({isFocused:!1,observer:null});bt(()=>{const r=e.current;return()=>{r.observer&&(r.observer.disconnect(),r.observer=null)}},[]);let n=kt(r=>{t==null||t(r)});return A.useCallback(r=>{if(r.target instanceof HTMLButtonElement||r.target instanceof HTMLInputElement||r.target instanceof HTMLTextAreaElement||r.target instanceof HTMLSelectElement){e.current.isFocused=!0;let s=r.target,o=i=>{e.current.isFocused=!1,s.disabled&&n(new ade("blur",i)),e.current.observer&&(e.current.observer.disconnect(),e.current.observer=null)};s.addEventListener("focusout",o,{once:!0}),e.current.observer=new MutationObserver(()=>{if(e.current.isFocused&&s.disabled){var i;(i=e.current.observer)===null||i===void 0||i.disconnect();let a=s===document.activeElement?null:document.activeElement;s.dispatchEvent(new FocusEvent("blur",{relatedTarget:a})),s.dispatchEvent(new FocusEvent("focusout",{bubbles:!0,relatedTarget:a}))}}),e.current.observer.observe(s,{attributes:!0,attributeFilter:["disabled"]})}},[n])}let Af=null,ude=new Set,gc=new Map,ga=!1,yx=!1;function W$(t,e){for(let n of ude)n(t,e)}function cde(t){return!(t.metaKey||!Qr()&&t.altKey||t.ctrlKey||t.key==="Control"||t.key==="Shift"||t.key==="Meta")}function nm(t){ga=!0,cde(t)&&(Af="keyboard",W$("keyboard",t))}function Ar(t){Af="pointer",(t.type==="mousedown"||t.type==="pointerdown")&&(ga=!0,W$("pointer",t))}function B3(t){$s(t)&&(ga=!0,Af="virtual")}function W3(t){t.target===window||t.target===document||(!ga&&!yx&&(Af="virtual",W$("virtual",t)),ga=!1,yx=!1)}function U3(){ga=!1,yx=!0}function NI(t){if(typeof window>"u"||gc.get(je(t)))return;const e=je(t),n=ve(t);let r=e.HTMLElement.prototype.focus;e.HTMLElement.prototype.focus=function(){ga=!0,r.apply(this,arguments)},n.addEventListener("keydown",nm,!0),n.addEventListener("keyup",nm,!0),n.addEventListener("click",B3,!0),e.addEventListener("focus",W3,!0),e.addEventListener("blur",U3,!1),typeof PointerEvent<"u"?(n.addEventListener("pointerdown",Ar,!0),n.addEventListener("pointermove",Ar,!0),n.addEventListener("pointerup",Ar,!0)):(n.addEventListener("mousedown",Ar,!0),n.addEventListener("mousemove",Ar,!0),n.addEventListener("mouseup",Ar,!0)),e.addEventListener("beforeunload",()=>{G3(t)},{once:!0}),gc.set(e,{focus:r})}const G3=(t,e)=>{const n=je(t),r=ve(t);e&&r.removeEventListener("DOMContentLoaded",e),gc.has(n)&&(n.HTMLElement.prototype.focus=gc.get(n).focus,r.removeEventListener("keydown",nm,!0),r.removeEventListener("keyup",nm,!0),r.removeEventListener("click",B3,!0),n.removeEventListener("focus",W3,!0),n.removeEventListener("blur",U3,!1),typeof PointerEvent<"u"?(r.removeEventListener("pointerdown",Ar,!0),r.removeEventListener("pointermove",Ar,!0),r.removeEventListener("pointerup",Ar,!0)):(r.removeEventListener("mousedown",Ar,!0),r.removeEventListener("mousemove",Ar,!0),r.removeEventListener("mouseup",Ar,!0)),gc.delete(n))};function dde(t){const e=ve(t);let n;return e.readyState!=="loading"?NI(t):(n=()=>{NI(t)},e.addEventListener("DOMContentLoaded",n)),()=>G3(t,n)}typeof document<"u"&&dde();function fde(){return Af}function H3(t){let{isDisabled:e,onBlurWithin:n,onFocusWithin:r,onFocusWithinChange:s}=t,o=A.useRef({isFocusWithin:!1}),i=A.useCallback(u=>{o.current.isFocusWithin&&!u.currentTarget.contains(u.relatedTarget)&&(o.current.isFocusWithin=!1,n&&n(u),s&&s(!1))},[n,s,o]),a=lde(i),l=A.useCallback(u=>{!o.current.isFocusWithin&&document.activeElement===u.target&&(r&&r(u),s&&s(!0),o.current.isFocusWithin=!0,a(u))},[r,s,a]);return e?{focusWithinProps:{onFocus:void 0,onBlur:void 0}}:{focusWithinProps:{onFocus:l,onBlur:i}}}function hde(t){let{ref:e,onInteractOutside:n,isDisabled:r,onInteractOutsideStart:s}=t,o=A.useRef({isPointerDown:!1,ignoreEmulatedMouseEvents:!1}),i=kt(l=>{n&&wh(l,e)&&(s&&s(l),o.current.isPointerDown=!0)}),a=kt(l=>{n&&n(l)});A.useEffect(()=>{let l=o.current;if(r)return;const u=e.current,c=ve(u);if(typeof PointerEvent<"u"){let d=f=>{l.isPointerDown&&wh(f,e)&&a(f),l.isPointerDown=!1};return c.addEventListener("pointerdown",i,!0),c.addEventListener("pointerup",d,!0),()=>{c.removeEventListener("pointerdown",i,!0),c.removeEventListener("pointerup",d,!0)}}else{let d=h=>{l.ignoreEmulatedMouseEvents?l.ignoreEmulatedMouseEvents=!1:l.isPointerDown&&wh(h,e)&&a(h),l.isPointerDown=!1},f=h=>{l.ignoreEmulatedMouseEvents=!0,l.isPointerDown&&wh(h,e)&&a(h),l.isPointerDown=!1};return c.addEventListener("mousedown",i,!0),c.addEventListener("mouseup",d,!0),c.addEventListener("touchstart",i,!0),c.addEventListener("touchend",f,!0),()=>{c.removeEventListener("mousedown",i,!0),c.removeEventListener("mouseup",d,!0),c.removeEventListener("touchstart",i,!0),c.removeEventListener("touchend",f,!0)}}},[e,r,i,a])}function wh(t,e){if(t.button>0)return!1;if(t.target){const n=t.target.ownerDocument;if(!n||!n.documentElement.contains(t.target)||t.target.closest("[data-react-aria-top-layer]"))return!1}return e.current&&!e.current.contains(t.target)}function pde(t){const e=ve(t);if(fde()==="virtual"){let n=e.activeElement;_a(()=>{e.activeElement===n&&t.isConnected&&nn(t)})}else nn(t)}function mde(t){const e=je(t);if(!(t instanceof e.HTMLElement)&&!(t instanceof e.SVGElement))return!1;let{display:n,visibility:r}=t.style,s=n!=="none"&&r!=="hidden"&&r!=="collapse";if(s){const{getComputedStyle:o}=t.ownerDocument.defaultView;let{display:i,visibility:a}=o(t);s=i!=="none"&&a!=="hidden"&&a!=="collapse"}return s}function gde(t,e){return!t.hasAttribute("hidden")&&!t.hasAttribute("data-react-aria-prevent-focus")&&(t.nodeName==="DETAILS"&&e&&e.nodeName!=="SUMMARY"?t.hasAttribute("open"):!0)}function j3(t,e){return t.nodeName!=="#comment"&&mde(t)&&gde(t,e)&&(!t.parentElement||j3(t.parentElement,t))}const RI=Ze.createContext(null);let ut=null;function vde(t){let{children:e,contain:n,restoreFocus:r,autoFocus:s}=t,o=A.useRef(null),i=A.useRef(null),a=A.useRef([]),{parentNode:l}=A.useContext(RI)||{},u=A.useMemo(()=>new wx({scopeRef:a}),[a]);bt(()=>{let f=l||Ut.root;if(Ut.getTreeNode(f.scopeRef)&&ut&&!sm(ut,f.scopeRef)){let h=Ut.getTreeNode(ut);h&&(f=h)}f.addChild(u),Ut.addNode(u)},[u,l]),bt(()=>{let f=Ut.getTreeNode(a);f&&(f.contain=!!n)},[n]),bt(()=>{var f;let h=(f=o.current)===null||f===void 0?void 0:f.nextSibling,p=[];for(;h&&h!==i.current;)p.push(h),h=h.nextSibling;a.current=p},[e]),kde(a,r,n),wde(a,n),Ide(a,r,n),Cde(a,s),A.useEffect(()=>{const f=ve(a.current?a.current[0]:void 0).activeElement;let h=null;if(An(f,a.current)){for(let p of Ut.traverse())p.scopeRef&&An(f,p.scopeRef.current)&&(h=p);h===Ut.getTreeNode(a)&&(ut=h.scopeRef)}},[a]),bt(()=>()=>{var f,h,p;let g=(p=(h=Ut.getTreeNode(a))===null||h===void 0||(f=h.parent)===null||f===void 0?void 0:f.scopeRef)!==null&&p!==void 0?p:null;(a===ut||sm(a,ut))&&(!g||Ut.getTreeNode(g))&&(ut=g),Ut.removeTreeNode(a)},[a]);let c=A.useMemo(()=>bde(a),[]),d=A.useMemo(()=>({focusManager:c,parentNode:u}),[u,c]);return Ze.createElement(RI.Provider,{value:d},Ze.createElement("span",{"data-focus-scope-start":!0,hidden:!0,ref:o}),e,Ze.createElement("span",{"data-focus-scope-end":!0,hidden:!0,ref:i}))}function bde(t){return{focusNext(e={}){let n=t.current,{from:r,tabbable:s,wrap:o,accept:i}=e,a=r||ve(n[0]).activeElement,l=n[0].previousElementSibling,u=zi(n),c=Vo(u,{tabbable:s,accept:i},n);c.currentNode=An(a,n)?a:l;let d=c.nextNode();return!d&&o&&(c.currentNode=l,d=c.nextNode()),d&&lo(d,!0),d},focusPrevious(e={}){let n=t.current,{from:r,tabbable:s,wrap:o,accept:i}=e,a=r||ve(n[0]).activeElement,l=n[n.length-1].nextElementSibling,u=zi(n),c=Vo(u,{tabbable:s,accept:i},n);c.currentNode=An(a,n)?a:l;let d=c.previousNode();return!d&&o&&(c.currentNode=l,d=c.previousNode()),d&&lo(d,!0),d},focusFirst(e={}){let n=t.current,{tabbable:r,accept:s}=e,o=zi(n),i=Vo(o,{tabbable:r,accept:s},n);i.currentNode=n[0].previousElementSibling;let a=i.nextNode();return a&&lo(a,!0),a},focusLast(e={}){let n=t.current,{tabbable:r,accept:s}=e,o=zi(n),i=Vo(o,{tabbable:r,accept:s},n);i.currentNode=n[n.length-1].nextElementSibling;let a=i.previousNode();return a&&lo(a,!0),a}}}const U$=["input:not([disabled]):not([type=hidden])","select:not([disabled])","textarea:not([disabled])","button:not([disabled])","a[href]","area[href]","summary","iframe","object","embed","audio[controls]","video[controls]","[contenteditable]"],xde=U$.join(":not([hidden]),")+",[tabindex]:not([disabled]):not([hidden])";U$.push('[tabindex]:not([tabindex="-1"]):not([disabled])');const yde=U$.join(':not([hidden]):not([tabindex="-1"]),');function zi(t){return t[0].parentElement}function tc(t){let e=Ut.getTreeNode(ut);for(;e&&e.scopeRef!==t;){if(e.contain)return!1;e=e.parent}return!0}function wde(t,e){let n=A.useRef(),r=A.useRef();bt(()=>{let s=t.current;if(!e){r.current&&(cancelAnimationFrame(r.current),r.current=void 0);return}const o=ve(s?s[0]:void 0);let i=u=>{if(u.key!=="Tab"||u.altKey||u.ctrlKey||u.metaKey||!tc(t)||u.isComposing)return;let c=o.activeElement,d=t.current;if(!d||!An(c,d))return;let f=zi(d),h=Vo(f,{tabbable:!0},d);if(!c)return;h.currentNode=c;let p=u.shiftKey?h.previousNode():h.nextNode();p||(h.currentNode=u.shiftKey?d[d.length-1].nextElementSibling:d[0].previousElementSibling,p=u.shiftKey?h.previousNode():h.nextNode()),u.preventDefault(),p&&lo(p,!0)},a=u=>{(!ut||sm(ut,t))&&An(u.target,t.current)?(ut=t,n.current=u.target):tc(t)&&!rm(u.target,t)?n.current?n.current.focus():ut&&ut.current&&om(ut.current):tc(t)&&(n.current=u.target)},l=u=>{r.current&&cancelAnimationFrame(r.current),r.current=requestAnimationFrame(()=>{if(o.activeElement&&tc(t)&&!rm(o.activeElement,t))if(ut=t,o.body.contains(u.target)){var c;n.current=u.target,(c=n.current)===null||c===void 0||c.focus()}else ut.current&&om(ut.current)})};return o.addEventListener("keydown",i,!1),o.addEventListener("focusin",a,!1),s==null||s.forEach(u=>u.addEventListener("focusin",a,!1)),s==null||s.forEach(u=>u.addEventListener("focusout",l,!1)),()=>{o.removeEventListener("keydown",i,!1),o.removeEventListener("focusin",a,!1),s==null||s.forEach(u=>u.removeEventListener("focusin",a,!1)),s==null||s.forEach(u=>u.removeEventListener("focusout",l,!1))}},[t,e]),bt(()=>()=>{r.current&&cancelAnimationFrame(r.current)},[r])}function K3(t){return rm(t)}function An(t,e){return!t||!e?!1:e.some(n=>n.contains(t))}function rm(t,e=null){if(t instanceof Element&&t.closest("[data-react-aria-top-layer]"))return!0;for(let{scopeRef:n}of Ut.traverse(Ut.getTreeNode(e)))if(n&&An(t,n.current))return!0;return!1}function $de(t){return rm(t,ut)}function sm(t,e){var n;let r=(n=Ut.getTreeNode(e))===null||n===void 0?void 0:n.parent;for(;r;){if(r.scopeRef===t)return!0;r=r.parent}return!1}function lo(t,e=!1){if(t!=null&&!e)try{pde(t)}catch{}else if(t!=null)try{t.focus()}catch{}}function om(t,e=!0){let n=t[0].previousElementSibling,r=zi(t),s=Vo(r,{tabbable:e},t);s.currentNode=n;let o=s.nextNode();e&&!o&&(r=zi(t),s=Vo(r,{tabbable:!1},t),s.currentNode=n,o=s.nextNode()),lo(o)}function Cde(t,e){const n=Ze.useRef(e);A.useEffect(()=>{if(n.current){ut=t;const r=ve(t.current?t.current[0]:void 0);!An(r.activeElement,ut.current)&&t.current&&om(t.current)}n.current=!1},[t])}function kde(t,e,n){bt(()=>{if(e||n)return;let r=t.current;const s=ve(r?r[0]:void 0);let o=i=>{let a=i.target;An(a,t.current)?ut=t:K3(a)||(ut=null)};return s.addEventListener("focusin",o,!1),r==null||r.forEach(i=>i.addEventListener("focusin",o,!1)),()=>{s.removeEventListener("focusin",o,!1),r==null||r.forEach(i=>i.removeEventListener("focusin",o,!1))}},[t,e,n])}function Sde(t){let e=Ut.getTreeNode(ut);for(;e&&e.scopeRef!==t;){if(e.nodeToRestore)return!1;e=e.parent}return(e==null?void 0:e.scopeRef)===t}function Ide(t,e,n){const r=A.useRef(typeof document<"u"?ve(t.current?t.current[0]:void 0).activeElement:null);bt(()=>{let s=t.current;const o=ve(s?s[0]:void 0);if(!e||n)return;let i=()=>{(!ut||sm(ut,t))&&An(o.activeElement,t.current)&&(ut=t)};return o.addEventListener("focusin",i,!1),s==null||s.forEach(a=>a.addEventListener("focusin",i,!1)),()=>{o.removeEventListener("focusin",i,!1),s==null||s.forEach(a=>a.removeEventListener("focusin",i,!1))}},[t,n]),bt(()=>{const s=ve(t.current?t.current[0]:void 0);if(!e)return;let o=i=>{if(i.key!=="Tab"||i.altKey||i.ctrlKey||i.metaKey||!tc(t)||i.isComposing)return;let a=s.activeElement;if(!An(a,t.current))return;let l=Ut.getTreeNode(t);if(!l)return;let u=l.nodeToRestore,c=Vo(s.body,{tabbable:!0});c.currentNode=a;let d=i.shiftKey?c.previousNode():c.nextNode();if((!u||!s.body.contains(u)||u===s.body)&&(u=void 0,l.nodeToRestore=void 0),(!d||!An(d,t.current))&&u){c.currentNode=u;do d=i.shiftKey?c.previousNode():c.nextNode();while(An(d,t.current));i.preventDefault(),i.stopPropagation(),d?lo(d,!0):K3(u)?lo(u,!0):a.blur()}};return n||s.addEventListener("keydown",o,!0),()=>{n||s.removeEventListener("keydown",o,!0)}},[t,e,n]),bt(()=>{const s=ve(t.current?t.current[0]:void 0);if(!e)return;let o=Ut.getTreeNode(t);if(o){var i;return o.nodeToRestore=(i=r.current)!==null&&i!==void 0?i:void 0,()=>{let a=Ut.getTreeNode(t);if(!a)return;let l=a.nodeToRestore;if(e&&l&&(An(s.activeElement,t.current)||s.activeElement===s.body&&Sde(t))){let u=Ut.clone();requestAnimationFrame(()=>{if(s.activeElement===s.body){let c=u.getTreeNode(t);for(;c;){if(c.nodeToRestore&&c.nodeToRestore.isConnected){lo(c.nodeToRestore);return}c=c.parent}for(c=u.getTreeNode(t);c;){if(c.scopeRef&&c.scopeRef.current&&Ut.getTreeNode(c.scopeRef)){om(c.scopeRef.current,!0);return}c=c.parent}}})}}}},[t,e])}function Vo(t,e,n){let r=e!=null&&e.tabbable?yde:xde,s=ve(t).createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode(o){var i;return!(e==null||(i=e.from)===null||i===void 0)&&i.contains(o)?NodeFilter.FILTER_REJECT:o.matches(r)&&j3(o)&&(!n||An(o,n))&&(!(e!=null&&e.accept)||e.accept(o))?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});return e!=null&&e.from&&(s.currentNode=e.from),s}let Tde=class X3{get size(){return this.fastMap.size}getTreeNode(e){return this.fastMap.get(e)}addTreeNode(e,n,r){let s=this.fastMap.get(n??null);if(!s)return;let o=new wx({scopeRef:e});s.addChild(o),o.parent=s,this.fastMap.set(e,o),r&&(o.nodeToRestore=r)}addNode(e){this.fastMap.set(e.scopeRef,e)}removeTreeNode(e){if(e===null)return;let n=this.fastMap.get(e);if(!n)return;let r=n.parent;for(let o of this.traverse())o!==n&&n.nodeToRestore&&o.nodeToRestore&&n.scopeRef&&n.scopeRef.current&&An(o.nodeToRestore,n.scopeRef.current)&&(o.nodeToRestore=n.nodeToRestore);let s=n.children;r&&(r.removeChild(n),s.size>0&&s.forEach(o=>r&&r.addChild(o))),this.fastMap.delete(n.scopeRef)}*traverse(e=this.root){if(e.scopeRef!=null&&(yield e),e.children.size>0)for(let n of e.children)yield*this.traverse(n)}clone(){var e;let n=new X3;var r;for(let s of this.traverse())n.addTreeNode(s.scopeRef,(r=(e=s.parent)===null||e===void 0?void 0:e.scopeRef)!==null&&r!==void 0?r:null,s.nodeToRestore);return n}constructor(){this.fastMap=new Map,this.root=new wx({scopeRef:null}),this.fastMap.set(null,this.root)}},wx=class{addChild(e){this.children.add(e),e.parent=this}removeChild(e){this.children.delete(e),e.parent=void 0}constructor(e){this.children=new Set,this.contain=!1,this.scopeRef=e.scopeRef}},Ut=new Tde;const DI={border:0,clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"};function Ede(t={}){let{style:e,isFocusable:n}=t,[r,s]=A.useState(!1),{focusWithinProps:o}=H3({isDisabled:!n,onFocusWithinChange:a=>s(a)}),i=A.useMemo(()=>r?e:e?{...DI,...e}:DI,[r]);return{visuallyHiddenProps:{...o,style:i}}}function Nde(t){let{children:e,elementType:n="div",isFocusable:r,style:s,...o}=t,{visuallyHiddenProps:i}=Ede(t);return Ze.createElement(n,tt(o,i),e)}function Rde(t){return t&&t.__esModule?t.default:t}const Ys=[];function Dde(t,e){let{onClose:n,shouldCloseOnBlur:r,isOpen:s,isDismissable:o=!1,isKeyboardDismissDisabled:i=!1,shouldCloseOnInteractOutside:a}=t;A.useEffect(()=>(s&&Ys.push(e),()=>{let p=Ys.indexOf(e);p>=0&&Ys.splice(p,1)}),[s,e]);let l=()=>{Ys[Ys.length-1]===e&&n&&n()},u=p=>{(!a||a(p.target))&&Ys[Ys.length-1]===e&&(p.stopPropagation(),p.preventDefault())},c=p=>{(!a||a(p.target))&&(Ys[Ys.length-1]===e&&(p.stopPropagation(),p.preventDefault()),l())},d=p=>{p.key==="Escape"&&!i&&(p.stopPropagation(),p.preventDefault(),l())};hde({ref:e,onInteractOutside:o&&s?c:null,onInteractOutsideStart:u});let{focusWithinProps:f}=H3({isDisabled:!r,onBlurWithin:p=>{!p.relatedTarget||$de(p.relatedTarget)||(!a||a(p.relatedTarget))&&n()}}),h=p=>{p.target===p.currentTarget&&p.preventDefault()};return{overlayProps:{onKeyDown:d,...f},underlayProps:{onPointerDown:h}}}const wv=typeof document<"u"&&window.visualViewport,Ade=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);let $h=0,$v;function Fde(t={}){let{isDisabled:e}=t;bt(()=>{if(!e)return $h++,$h===1&&(Rf()?$v=Ode():$v=Pde()),()=>{$h--,$h===0&&$v()}},[e])}function Pde(){return ws(ml(document.documentElement,"paddingRight",`${window.innerWidth-document.documentElement.clientWidth}px`),ml(document.documentElement,"overflow","hidden"))}function Ode(){let t,e,n=u=>{t=e3(u.target,!0),!(t===document.documentElement&&t===document.body)&&t instanceof HTMLElement&&window.getComputedStyle(t).overscrollBehavior==="auto"&&(e=ml(t,"overscrollBehavior","contain"))},r=u=>{if(!t||t===document.documentElement||t===document.body){u.preventDefault();return}t.scrollHeight===t.clientHeight&&t.scrollWidth===t.clientWidth&&u.preventDefault()},s=u=>{let c=u.target;FI(c)&&c!==document.activeElement&&(u.preventDefault(),a(),c.style.transform="translateY(-2000px)",c.focus(),requestAnimationFrame(()=>{c.style.transform=""})),e&&e()},o=u=>{let c=u.target;FI(c)&&(a(),c.style.transform="translateY(-2000px)",requestAnimationFrame(()=>{c.style.transform="",wv&&(wv.height<window.innerHeight?requestAnimationFrame(()=>{AI(c)}):wv.addEventListener("resize",()=>AI(c),{once:!0}))}))},i=null,a=()=>{if(i)return;let u=()=>{window.scrollTo(0,0)},c=window.pageXOffset,d=window.pageYOffset;i=ws(Mu(window,"scroll",u),ml(document.documentElement,"paddingRight",`${window.innerWidth-document.documentElement.clientWidth}px`),ml(document.documentElement,"overflow","hidden"),ml(document.body,"marginTop",`-${d}px`),()=>{window.scrollTo(c,d)}),window.scrollTo(0,0)},l=ws(Mu(document,"touchstart",n,{passive:!1,capture:!0}),Mu(document,"touchmove",r,{passive:!1,capture:!0}),Mu(document,"touchend",s,{passive:!1,capture:!0}),Mu(document,"focus",o,!0));return()=>{e==null||e(),i==null||i(),l()}}function ml(t,e,n){let r=t.style[e];return t.style[e]=n,()=>{t.style[e]=r}}function Mu(t,e,n,r){return t.addEventListener(e,n,r),()=>{t.removeEventListener(e,n,r)}}function AI(t){let e=document.scrollingElement||document.documentElement;for(;t&&t!==e;){let n=e3(t);if(n!==document.documentElement&&n!==document.body&&n!==t){let r=n.getBoundingClientRect().top,s=t.getBoundingClientRect().top;s>r+t.clientHeight&&(n.scrollTop+=s-r)}t=n.parentElement}}function FI(t){return t instanceof HTMLInputElement&&!Ade.has(t.type)||t instanceof HTMLTextAreaElement||t instanceof HTMLElement&&t.isContentEditable}var q3={};q3={"ar-AE":r3,"bg-BG":s3,"cs-CZ":o3,"da-DK":i3,"de-DE":a3,"el-GR":l3,"en-US":u3,"es-ES":c3,"et-EE":d3,"fi-FI":f3,"fr-FR":h3,"he-IL":p3,"hr-HR":m3,"hu-HU":g3,"it-IT":v3,"ja-JP":b3,"ko-KR":x3,"lt-LT":y3,"lv-LV":w3,"nb-NO":$3,"nl-NL":C3,"pl-PL":k3,"pt-BR":S3,"pt-PT":I3,"ro-RO":T3,"ru-RU":E3,"sk-SK":N3,"sl-SI":R3,"sr-SP":D3,"sv-SE":A3,"tr-TR":F3,"uk-UA":P3,"zh-CN":O3,"zh-TW":L3};function PI(t){let{onDismiss:e,...n}=t,r=rde(Rde(q3),"@react-aria/overlays"),s=JO(n,r.format("dismiss")),o=()=>{e&&e()};return Ze.createElement(Nde,null,Ze.createElement("button",{...s,tabIndex:-1,onClick:o,style:{width:1,height:1}}))}let _u=new WeakMap,Tr=[];function Lde(t,e=document.body){let n=new Set(t),r=new Set,s=l=>{for(let f of l.querySelectorAll("[data-live-announcer], [data-react-aria-top-layer]"))n.add(f);let u=f=>{if(n.has(f)||r.has(f.parentElement)&&f.parentElement.getAttribute("role")!=="row")return NodeFilter.FILTER_REJECT;for(let h of n)if(f.contains(h))return NodeFilter.FILTER_SKIP;return NodeFilter.FILTER_ACCEPT},c=document.createTreeWalker(l,NodeFilter.SHOW_ELEMENT,{acceptNode:u}),d=u(l);if(d===NodeFilter.FILTER_ACCEPT&&o(l),d!==NodeFilter.FILTER_REJECT){let f=c.nextNode();for(;f!=null;)o(f),f=c.nextNode()}},o=l=>{var u;let c=(u=_u.get(l))!==null&&u!==void 0?u:0;l.getAttribute("aria-hidden")==="true"&&c===0||(c===0&&l.setAttribute("aria-hidden","true"),r.add(l),_u.set(l,c+1))};Tr.length&&Tr[Tr.length-1].disconnect(),s(e);let i=new MutationObserver(l=>{for(let u of l)if(!(u.type!=="childList"||u.addedNodes.length===0)&&![...n,...r].some(c=>c.contains(u.target))){for(let c of u.removedNodes)c instanceof Element&&(n.delete(c),r.delete(c));for(let c of u.addedNodes)(c instanceof HTMLElement||c instanceof SVGElement)&&(c.dataset.liveAnnouncer==="true"||c.dataset.reactAriaTopLayer==="true")?n.add(c):c instanceof Element&&s(c)}});i.observe(e,{childList:!0,subtree:!0});let a={observe(){i.observe(e,{childList:!0,subtree:!0})},disconnect(){i.disconnect()}};return Tr.push(a),()=>{i.disconnect();for(let l of r){let u=_u.get(l);u===1?(l.removeAttribute("aria-hidden"),_u.delete(l)):_u.set(l,u-1)}a===Tr[Tr.length-1]?(Tr.pop(),Tr.length&&Tr[Tr.length-1].observe()):Tr.splice(Tr.indexOf(a),1)}}const Y3=Ze.createContext(null);function Mde(t){let e=z$(),{portalContainer:n=e?null:document.body,isExiting:r}=t,[s,o]=A.useState(!1),i=A.useMemo(()=>({contain:s,setContain:o}),[s,o]);if(!n)return null;let a=t.children;return t.disableFocusManagement||(a=Ze.createElement(vde,{restoreFocus:!0,contain:s&&!r},a)),a=Ze.createElement(Y3.Provider,{value:i},Ze.createElement(ide,null,a)),tV.createPortal(a,n)}function _de(){let t=A.useContext(Y3),e=t==null?void 0:t.setContain;bt(()=>{e==null||e(!0)},[e])}const G$=A.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"}),y0=A.createContext({}),H$=A.createContext(null),j$=typeof document<"u",K$=j$?A.useLayoutEffect:A.useEffect,X$=A.createContext({strict:!1}),q$=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),zde="framerAppearId",Q3="data-"+q$(zde),Vde={skipAnimations:!1,useManualTiming:!1};class OI{constructor(){this.order=[],this.scheduled=new Set}add(e){if(!this.scheduled.has(e))return this.scheduled.add(e),this.order.push(e),!0}remove(e){const n=this.order.indexOf(e);n!==-1&&(this.order.splice(n,1),this.scheduled.delete(e))}clear(){this.order.length=0,this.scheduled.clear()}}function Bde(t){let e=new OI,n=new OI,r=0,s=!1,o=!1;const i=new WeakSet,a={schedule:(l,u=!1,c=!1)=>{const d=c&&s,f=d?e:n;return u&&i.add(l),f.add(l)&&d&&s&&(r=e.order.length),l},cancel:l=>{n.remove(l),i.delete(l)},process:l=>{if(s){o=!0;return}if(s=!0,[e,n]=[n,e],n.clear(),r=e.order.length,r)for(let u=0;u<r;u++){const c=e.order[u];i.has(c)&&(a.schedule(c),t()),c(l)}s=!1,o&&(o=!1,a.process(l))}};return a}const Ch=["read","resolveKeyframes","update","preRender","render","postRender"],Wde=40;function Z3(t,e){let n=!1,r=!0;const s={delta:0,timestamp:0,isProcessing:!1},o=Ch.reduce((d,f)=>(d[f]=Bde(()=>n=!0),d),{}),i=d=>{o[d].process(s)},a=()=>{const d=performance.now();n=!1,s.delta=r?1e3/60:Math.max(Math.min(d-s.timestamp,Wde),1),s.timestamp=d,s.isProcessing=!0,Ch.forEach(i),s.isProcessing=!1,n&&e&&(r=!1,t(a))},l=()=>{n=!0,r=!0,s.isProcessing||t(a)};return{schedule:Ch.reduce((d,f)=>{const h=o[f];return d[f]=(p,g=!1,v=!1)=>(n||l(),h.schedule(p,g,v)),d},{}),cancel:d=>Ch.forEach(f=>o[f].cancel(d)),state:s,steps:o}}const{schedule:Ude,cancel:Dve}=Z3(queueMicrotask,!1);function Gde(t,e,n,r){const{visualElement:s}=A.useContext(y0),o=A.useContext(X$),i=A.useContext(H$),a=A.useContext(G$).reducedMotion,l=A.useRef();r=r||o.renderer,!l.current&&r&&(l.current=r(t,{visualState:e,parent:s,props:n,presenceContext:i,blockInitialAnimation:i?i.initial===!1:!1,reducedMotionConfig:a}));const u=l.current;A.useInsertionEffect(()=>{u&&u.update(n,i)});const c=A.useRef(!!(n[Q3]&&!window.HandoffComplete));return K$(()=>{u&&(Ude.render(u.render),c.current&&u.animationState&&u.animationState.animateChanges())}),A.useEffect(()=>{u&&(u.updateFeatures(),!c.current&&u.animationState&&u.animationState.animateChanges(),c.current&&(c.current=!1,window.HandoffComplete=!0))}),u}function J3(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function Hde(t,e,n){return A.useCallback(r=>{r&&t.mount&&t.mount(r),e&&(r?e.mount(r):e.unmount()),n&&(typeof n=="function"?n(r):J3(n)&&(n.current=r))},[e])}function td(t){return typeof t=="string"||Array.isArray(t)}function w0(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}const Y$=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Q$=["initial",...Y$];function $0(t){return w0(t.animate)||Q$.some(e=>td(t[e]))}function eL(t){return!!($0(t)||t.variants)}function jde(t,e){if($0(t)){const{initial:n,animate:r}=t;return{initial:n===!1||td(n)?n:void 0,animate:td(r)?r:void 0}}return t.inherit!==!1?e:{}}function Kde(t){const{initial:e,animate:n}=jde(t,A.useContext(y0));return A.useMemo(()=>({initial:e,animate:n}),[LI(e),LI(n)])}function LI(t){return Array.isArray(t)?t.join(" "):t}const MI={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},nd={};for(const t in MI)nd[t]={isEnabled:e=>MI[t].some(n=>!!e[n])};function $x(t){for(const e in t)nd[e]={...nd[e],...t[e]}}const tL=A.createContext({}),Xde=A.createContext({}),qde=Symbol.for("motionComponentSymbol");function Yde({preloadedFeatures:t,createVisualElement:e,useRender:n,useVisualState:r,Component:s}){t&&$x(t);function o(a,l){let u;const c={...A.useContext(G$),...a,layoutId:Qde(a)},{isStatic:d}=c,f=Kde(a),h=r(a,d);if(!d&&j$){f.visualElement=Gde(s,h,c,e);const p=A.useContext(Xde),g=A.useContext(X$).strict;f.visualElement&&(u=f.visualElement.loadFeatures(c,g,t,p))}return Y.jsxs(y0.Provider,{value:f,children:[u&&f.visualElement?Y.jsx(u,{visualElement:f.visualElement,...c}):null,n(s,a,Hde(h,f.visualElement,l),h,d,f.visualElement)]})}const i=A.forwardRef(o);return i[qde]=s,i}function Qde({layoutId:t}){const e=A.useContext(tL).id;return e&&t!==void 0?e+"-"+t:t}function Zde(t){function e(r,s={}){return Yde(t(r,s))}if(typeof Proxy>"u")return e;const n=new Map;return new Proxy(e,{get:(r,s)=>(n.has(s)||n.set(s,e(s)),n.get(s))})}const Jde=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Z$(t){return typeof t!="string"||t.includes("-")?!1:!!(Jde.indexOf(t)>-1||/[A-Z]/u.test(t))}const efe={},Ff=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],za=new Set(Ff);function nL(t,{layout:e,layoutId:n}){return za.has(t)||t.startsWith("origin")||(e||n!==void 0)&&(!!efe[t]||t==="opacity")}const Bn=t=>!!(t&&t.getVelocity),tfe={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},nfe=Ff.length;function rfe(t,{enableHardwareAcceleration:e=!0,allowTransformNone:n=!0},r,s){let o="";for(let i=0;i<nfe;i++){const a=Ff[i];if(t[a]!==void 0){const l=tfe[a]||a;o+=`${l}(${t[a]}) `}}return e&&!t.z&&(o+="translateZ(0)"),o=o.trim(),s?o=s(t,r?"":o):n&&r&&(o="none"),o}const rL=t=>e=>typeof e=="string"&&e.startsWith(t),sL=rL("--"),sfe=rL("var(--"),J$=t=>sfe(t)?ofe.test(t.split("/*")[0].trim()):!1,ofe=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,ife=(t,e)=>e&&typeof t=="number"?e.transform(t):t,Ql=(t,e,n)=>n>e?e:n<t?t:n,xu={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},vc={...xu,transform:t=>Ql(0,1,t)},kh={...xu,default:1},bc=t=>Math.round(t*1e5)/1e5,eC=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu,afe=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu,lfe=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu;function Pf(t){return typeof t=="string"}const Of=t=>({test:e=>Pf(e)&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),No=Of("deg"),Rl=Of("%"),ke=Of("px"),ufe=Of("vh"),cfe=Of("vw"),_I={...Rl,parse:t=>Rl.parse(t)/100,transform:t=>Rl.transform(t*100)},zI={...xu,transform:Math.round},oL={borderWidth:ke,borderTopWidth:ke,borderRightWidth:ke,borderBottomWidth:ke,borderLeftWidth:ke,borderRadius:ke,radius:ke,borderTopLeftRadius:ke,borderTopRightRadius:ke,borderBottomRightRadius:ke,borderBottomLeftRadius:ke,width:ke,maxWidth:ke,height:ke,maxHeight:ke,size:ke,top:ke,right:ke,bottom:ke,left:ke,padding:ke,paddingTop:ke,paddingRight:ke,paddingBottom:ke,paddingLeft:ke,margin:ke,marginTop:ke,marginRight:ke,marginBottom:ke,marginLeft:ke,rotate:No,rotateX:No,rotateY:No,rotateZ:No,scale:kh,scaleX:kh,scaleY:kh,scaleZ:kh,skew:No,skewX:No,skewY:No,distance:ke,translateX:ke,translateY:ke,translateZ:ke,x:ke,y:ke,z:ke,perspective:ke,transformPerspective:ke,opacity:vc,originX:_I,originY:_I,originZ:ke,zIndex:zI,backgroundPositionX:ke,backgroundPositionY:ke,fillOpacity:vc,strokeOpacity:vc,numOctaves:zI};function tC(t,e,n,r){const{style:s,vars:o,transform:i,transformOrigin:a}=t;let l=!1,u=!1,c=!0;for(const d in e){const f=e[d];if(sL(d)){o[d]=f;continue}const h=oL[d],p=ife(f,h);if(za.has(d)){if(l=!0,i[d]=p,!c)continue;f!==(h.default||0)&&(c=!1)}else d.startsWith("origin")?(u=!0,a[d]=p):s[d]=p}if(e.transform||(l||r?s.transform=rfe(t.transform,n,c,r):s.transform&&(s.transform="none")),u){const{originX:d="50%",originY:f="50%",originZ:h=0}=a;s.transformOrigin=`${d} ${f} ${h}`}}const nC=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function iL(t,e,n){for(const r in e)!Bn(e[r])&&!nL(r,n)&&(t[r]=e[r])}function dfe({transformTemplate:t},e,n){return A.useMemo(()=>{const r=nC();return tC(r,e,{enableHardwareAcceleration:!n},t),Object.assign({},r.vars,r.style)},[e])}function ffe(t,e,n){const r=t.style||{},s={};return iL(s,r,t),Object.assign(s,dfe(t,e,n)),s}function hfe(t,e,n){const r={},s=ffe(t,e,n);return t.drag&&t.dragListener!==!1&&(r.draggable=!1,s.userSelect=s.WebkitUserSelect=s.WebkitTouchCallout="none",s.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(r.tabIndex=0),r.style=s,r}const pfe=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function im(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||pfe.has(t)}let aL=t=>!im(t);function mfe(t){t&&(aL=e=>e.startsWith("on")?!im(e):t(e))}try{mfe(require("@emotion/is-prop-valid").default)}catch{}function gfe(t,e,n){const r={};for(const s in t)s==="values"&&typeof t.values=="object"||(aL(s)||n===!0&&im(s)||!e&&!im(s)||t.draggable&&s.startsWith("onDrag"))&&(r[s]=t[s]);return r}function VI(t,e,n){return typeof t=="string"?t:ke.transform(e+n*t)}function vfe(t,e,n){const r=VI(e,t.x,t.width),s=VI(n,t.y,t.height);return`${r} ${s}`}const bfe={offset:"stroke-dashoffset",array:"stroke-dasharray"},xfe={offset:"strokeDashoffset",array:"strokeDasharray"};function yfe(t,e,n=1,r=0,s=!0){t.pathLength=1;const o=s?bfe:xfe;t[o.offset]=ke.transform(-r);const i=ke.transform(e),a=ke.transform(n);t[o.array]=`${i} ${a}`}function rC(t,{attrX:e,attrY:n,attrScale:r,originX:s,originY:o,pathLength:i,pathSpacing:a=1,pathOffset:l=0,...u},c,d,f){if(tC(t,u,c,f),d){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:h,style:p,dimensions:g}=t;h.transform&&(g&&(p.transform=h.transform),delete h.transform),g&&(s!==void 0||o!==void 0||p.transform)&&(p.transformOrigin=vfe(g,s!==void 0?s:.5,o!==void 0?o:.5)),e!==void 0&&(h.x=e),n!==void 0&&(h.y=n),r!==void 0&&(h.scale=r),i!==void 0&&yfe(h,i,a,l,!1)}const lL=()=>({...nC(),attrs:{}}),sC=t=>typeof t=="string"&&t.toLowerCase()==="svg";function wfe(t,e,n,r){const s=A.useMemo(()=>{const o=lL();return rC(o,e,{enableHardwareAcceleration:!1},sC(r),t.transformTemplate),{...o.attrs,style:{...o.style}}},[e]);if(t.style){const o={};iL(o,t.style,t),s.style={...o,...s.style}}return s}function $fe(t=!1){return(n,r,s,{latestValues:o},i)=>{const l=(Z$(n)?wfe:hfe)(r,o,i,n),u=gfe(r,typeof n=="string",t),c=n!==A.Fragment?{...u,...l,ref:s}:{},{children:d}=r,f=A.useMemo(()=>Bn(d)?d.get():d,[d]);return A.createElement(n,{...c,children:f})}}function uL(t,{style:e,vars:n},r,s){Object.assign(t.style,e,s&&s.getProjectionStyles(r));for(const o in n)t.style.setProperty(o,n[o])}const cL=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function dL(t,e,n,r){uL(t,e,void 0,r);for(const s in e.attrs)t.setAttribute(cL.has(s)?s:q$(s),e.attrs[s])}function oC(t,e,n){var r;const{style:s}=t,o={};for(const i in s)(Bn(s[i])||e.style&&Bn(e.style[i])||nL(i,t)||((r=n==null?void 0:n.getValue(i))===null||r===void 0?void 0:r.liveStyle)!==void 0)&&(o[i]=s[i]);return o}function fL(t,e,n){const r=oC(t,e,n);for(const s in t)if(Bn(t[s])||Bn(e[s])){const o=Ff.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;r[o]=t[s]}return r}function BI(t){const e=[{},{}];return t==null||t.values.forEach((n,r)=>{e[0][r]=n.get(),e[1][r]=n.getVelocity()}),e}function iC(t,e,n,r){if(typeof e=="function"){const[s,o]=BI(r);e=e(n!==void 0?n:t.custom,s,o)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[s,o]=BI(r);e=e(n!==void 0?n:t.custom,s,o)}return e}function hL(t){const e=A.useRef(null);return e.current===null&&(e.current=t()),e.current}const Cx=t=>Array.isArray(t),Cfe=t=>!!(t&&typeof t=="object"&&t.mix&&t.toValue),kfe=t=>Cx(t)?t[t.length-1]||0:t;function Sfe(t){const e=Bn(t)?t.get():t;return Cfe(e)?e.toValue():e}function Ife({scrapeMotionValuesFromProps:t,createRenderState:e,onMount:n},r,s,o){const i={latestValues:Tfe(r,s,o,t),renderState:e()};return n&&(i.mount=a=>n(r,a,i)),i}const pL=t=>(e,n)=>{const r=A.useContext(y0),s=A.useContext(H$),o=()=>Ife(t,e,r,s);return n?o():hL(o)};function Tfe(t,e,n,r){const s={},o=r(t,{});for(const f in o)s[f]=Sfe(o[f]);let{initial:i,animate:a}=t;const l=$0(t),u=eL(t);e&&u&&!l&&t.inherit!==!1&&(i===void 0&&(i=e.initial),a===void 0&&(a=e.animate));let c=n?n.initial===!1:!1;c=c||i===!1;const d=c?a:i;return d&&typeof d!="boolean"&&!w0(d)&&(Array.isArray(d)?d:[d]).forEach(h=>{const p=iC(t,h);if(!p)return;const{transitionEnd:g,transition:v,...m}=p;for(const b in m){let x=m[b];if(Array.isArray(x)){const y=c?x.length-1:0;x=x[y]}x!==null&&(s[b]=x)}for(const b in g)s[b]=g[b]}),s}const Ws=t=>t,{schedule:rn,cancel:am,state:lm,steps:Ave}=Z3(typeof requestAnimationFrame<"u"?requestAnimationFrame:Ws,!0),Efe={useVisualState:pL({scrapeMotionValuesFromProps:fL,createRenderState:lL,onMount:(t,e,{renderState:n,latestValues:r})=>{rn.read(()=>{try{n.dimensions=typeof e.getBBox=="function"?e.getBBox():e.getBoundingClientRect()}catch{n.dimensions={x:0,y:0,width:0,height:0}}}),rn.render(()=>{rC(n,r,{enableHardwareAcceleration:!1},sC(e.tagName),t.transformTemplate),dL(e,n)})}})},Nfe={useVisualState:pL({scrapeMotionValuesFromProps:oC,createRenderState:nC})};function Rfe(t,{forwardMotionProps:e=!1},n,r){return{...Z$(t)?Efe:Nfe,preloadedFeatures:n,useRender:$fe(e),createVisualElement:r,Component:t}}function Vi(t,e,n,r={passive:!0}){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n)}const Dfe=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1;function mL(t,e="page"){return{point:{x:t[`${e}X`],y:t[`${e}Y`]}}}const Afe=t=>e=>Dfe(e)&&t(e,mL(e));function qh(t,e,n,r){return Vi(t,e,Afe(n),r)}const Ffe=(t,e)=>n=>e(t(n)),Jo=(...t)=>t.reduce(Ffe);function gL(t){let e=null;return()=>{const n=()=>{e=null};return e===null?(e=t,n):!1}}const Pfe=gL("dragHorizontal"),Ofe=gL("dragVertical");function Lfe(t){let e=!1;{const n=Pfe(),r=Ofe();n&&r?e=()=>{n(),r()}:(n&&n(),r&&r())}return e}function vL(){const t=Lfe();return t?(t(),!1):!0}class yu{constructor(e){this.isMounted=!1,this.node=e}update(){}}function WI(t,e){const n=e?"pointerenter":"pointerleave",r=e?"onHoverStart":"onHoverEnd",s=(o,i)=>{if(o.pointerType==="touch"||vL())return;const a=t.getProps();t.animationState&&a.whileHover&&t.animationState.setActive("whileHover",e);const l=a[r];l&&rn.postRender(()=>l(o,i))};return qh(t.current,n,s,{passive:!t.getProps()[r]})}class Mfe extends yu{mount(){this.unmount=Jo(WI(this.node,!0),WI(this.node,!1))}unmount(){}}class _fe extends yu{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Jo(Vi(this.node.current,"focus",()=>this.onFocus()),Vi(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const bL=(t,e)=>e?t===e?!0:bL(t,e.parentElement):!1;function Cv(t,e){if(!e)return;const n=new PointerEvent("pointer"+t);e(n,mL(n))}class zfe extends yu{constructor(){super(...arguments),this.removeStartListeners=Ws,this.removeEndListeners=Ws,this.removeAccessibleListeners=Ws,this.startPointerPress=(e,n)=>{if(this.isPressing)return;this.removeEndListeners();const r=this.node.getProps(),o=qh(window,"pointerup",(a,l)=>{if(!this.checkPressEnd())return;const{onTap:u,onTapCancel:c,globalTapTarget:d}=this.node.getProps(),f=!d&&!bL(this.node.current,a.target)?c:u;f&&rn.update(()=>f(a,l))},{passive:!(r.onTap||r.onPointerUp)}),i=qh(window,"pointercancel",(a,l)=>this.cancelPress(a,l),{passive:!(r.onTapCancel||r.onPointerCancel)});this.removeEndListeners=Jo(o,i),this.startPress(e,n)},this.startAccessiblePress=()=>{const e=o=>{if(o.key!=="Enter"||this.isPressing)return;const i=a=>{a.key!=="Enter"||!this.checkPressEnd()||Cv("up",(l,u)=>{const{onTap:c}=this.node.getProps();c&&rn.postRender(()=>c(l,u))})};this.removeEndListeners(),this.removeEndListeners=Vi(this.node.current,"keyup",i),Cv("down",(a,l)=>{this.startPress(a,l)})},n=Vi(this.node.current,"keydown",e),r=()=>{this.isPressing&&Cv("cancel",(o,i)=>this.cancelPress(o,i))},s=Vi(this.node.current,"blur",r);this.removeAccessibleListeners=Jo(n,s)}}startPress(e,n){this.isPressing=!0;const{onTapStart:r,whileTap:s}=this.node.getProps();s&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),r&&rn.postRender(()=>r(e,n))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!vL()}cancelPress(e,n){if(!this.checkPressEnd())return;const{onTapCancel:r}=this.node.getProps();r&&rn.postRender(()=>r(e,n))}mount(){const e=this.node.getProps(),n=qh(e.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(e.onTapStart||e.onPointerStart)}),r=Vi(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=Jo(n,r)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const kx=new WeakMap,kv=new WeakMap,Vfe=t=>{const e=kx.get(t.target);e&&e(t)},Bfe=t=>{t.forEach(Vfe)};function Wfe({root:t,...e}){const n=t||document;kv.has(n)||kv.set(n,{});const r=kv.get(n),s=JSON.stringify(e);return r[s]||(r[s]=new IntersectionObserver(Bfe,{root:t,...e})),r[s]}function Ufe(t,e,n){const r=Wfe(e);return kx.set(t,n),r.observe(t),()=>{kx.delete(t),r.unobserve(t)}}const Gfe={some:0,all:1};class Hfe extends yu{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:n,margin:r,amount:s="some",once:o}=e,i={root:n?n.current:void 0,rootMargin:r,threshold:typeof s=="number"?s:Gfe[s]},a=l=>{const{isIntersecting:u}=l;if(this.isInView===u||(this.isInView=u,o&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:c,onViewportLeave:d}=this.node.getProps(),f=u?c:d;f&&f(l)};return Ufe(this.node.current,i,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:n}=this.node;["amount","margin","root"].some(jfe(e,n))&&this.startObserver()}unmount(){}}function jfe({viewport:t={}},{viewport:e={}}={}){return n=>t[n]!==e[n]}const Kfe={inView:{Feature:Hfe},tap:{Feature:zfe},focus:{Feature:_fe},hover:{Feature:Mfe}};function xL(t,e){if(!Array.isArray(e))return!1;const n=e.length;if(n!==t.length)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}function C0(t,e,n){const r=t.getProps();return iC(r,e,n!==void 0?n:r.custom,t)}const Xi=t=>t*1e3,ei=t=>t/1e3,Xfe={type:"spring",stiffness:500,damping:25,restSpeed:10},qfe=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),Yfe={type:"keyframes",duration:.8},Qfe={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Zfe=(t,{keyframes:e})=>e.length>2?Yfe:za.has(t)?t.startsWith("scale")?qfe(e[1]):Xfe:Qfe;function Jfe({when:t,delay:e,delayChildren:n,staggerChildren:r,staggerDirection:s,repeat:o,repeatType:i,repeatDelay:a,from:l,elapsed:u,...c}){return!!Object.keys(c).length}function yL(t,e){return t[e]||t.default||t}const ehe=t=>t!==null;function k0(t,{repeat:e,repeatType:n="loop"},r){const s=t.filter(ehe),o=e&&n!=="loop"&&e%2===1?0:s.length-1;return!o||r===void 0?s[o]:r}let Yh;function the(){Yh=void 0}const Dl={now:()=>(Yh===void 0&&Dl.set(lm.isProcessing||Vde.useManualTiming?lm.timestamp:performance.now()),Yh),set:t=>{Yh=t,queueMicrotask(the)}},wL=t=>/^0[^.\s]+$/u.test(t);function nhe(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||wL(t):!0}let Sx=Ws;const $L=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t),rhe=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function she(t){const e=rhe.exec(t);if(!e)return[,];const[,n,r,s]=e;return[`--${n??r}`,s]}function CL(t,e,n=1){const[r,s]=she(t);if(!r)return;const o=window.getComputedStyle(e).getPropertyValue(r);if(o){const i=o.trim();return $L(i)?parseFloat(i):i}return J$(s)?CL(s,e,n+1):s}const ohe=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),UI=t=>t===xu||t===ke,GI=(t,e)=>parseFloat(t.split(", ")[e]),HI=(t,e)=>(n,{transform:r})=>{if(r==="none"||!r)return 0;const s=r.match(/^matrix3d\((.+)\)$/u);if(s)return GI(s[1],e);{const o=r.match(/^matrix\((.+)\)$/u);return o?GI(o[1],t):0}},ihe=new Set(["x","y","z"]),ahe=Ff.filter(t=>!ihe.has(t));function lhe(t){const e=[];return ahe.forEach(n=>{const r=t.getValue(n);r!==void 0&&(e.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),e}const Zl={width:({x:t},{paddingLeft:e="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),height:({y:t},{paddingTop:e="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:HI(4,13),y:HI(5,14)};Zl.translateX=Zl.x;Zl.translateY=Zl.y;const kL=t=>e=>e.test(t),uhe={test:t=>t==="auto",parse:t=>t},SL=[xu,ke,Rl,No,cfe,ufe,uhe],jI=t=>SL.find(kL(t)),qi=new Set;let Ix=!1,Tx=!1;function IL(){if(Tx){const t=Array.from(qi).filter(r=>r.needsMeasurement),e=new Set(t.map(r=>r.element)),n=new Map;e.forEach(r=>{const s=lhe(r);s.length&&(n.set(r,s),r.render())}),t.forEach(r=>r.measureInitialState()),e.forEach(r=>{r.render();const s=n.get(r);s&&s.forEach(([o,i])=>{var a;(a=r.getValue(o))===null||a===void 0||a.set(i)})}),t.forEach(r=>r.measureEndState()),t.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}Tx=!1,Ix=!1,qi.forEach(t=>t.complete()),qi.clear()}function TL(){qi.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(Tx=!0)})}function che(){TL(),IL()}class aC{constructor(e,n,r,s,o,i=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=n,this.name=r,this.motionValue=s,this.element=o,this.isAsync=i}scheduleResolve(){this.isScheduled=!0,this.isAsync?(qi.add(this),Ix||(Ix=!0,rn.read(TL),rn.resolveKeyframes(IL))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:n,element:r,motionValue:s}=this;for(let o=0;o<e.length;o++)if(e[o]===null)if(o===0){const i=s==null?void 0:s.get(),a=e[e.length-1];if(i!==void 0)e[0]=i;else if(r&&n){const l=r.readValue(n,a);l!=null&&(e[0]=l)}e[0]===void 0&&(e[0]=a),s&&i===void 0&&s.set(e[0])}else e[o]=e[o-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),qi.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,qi.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const lC=(t,e)=>n=>!!(Pf(n)&&lfe.test(n)&&n.startsWith(t)||e&&Object.prototype.hasOwnProperty.call(n,e)),EL=(t,e,n)=>r=>{if(!Pf(r))return r;const[s,o,i,a]=r.match(eC);return{[t]:parseFloat(s),[e]:parseFloat(o),[n]:parseFloat(i),alpha:a!==void 0?parseFloat(a):1}},dhe=t=>Ql(0,255,t),Sv={...xu,transform:t=>Math.round(dhe(t))},Bi={test:lC("rgb","red"),parse:EL("red","green","blue"),transform:({red:t,green:e,blue:n,alpha:r=1})=>"rgba("+Sv.transform(t)+", "+Sv.transform(e)+", "+Sv.transform(n)+", "+bc(vc.transform(r))+")"};function fhe(t){let e="",n="",r="",s="";return t.length>5?(e=t.substring(1,3),n=t.substring(3,5),r=t.substring(5,7),s=t.substring(7,9)):(e=t.substring(1,2),n=t.substring(2,3),r=t.substring(3,4),s=t.substring(4,5),e+=e,n+=n,r+=r,s+=s),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:s?parseInt(s,16)/255:1}}const Ex={test:lC("#"),parse:fhe,transform:Bi.transform},gl={test:lC("hsl","hue"),parse:EL("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:n,alpha:r=1})=>"hsla("+Math.round(t)+", "+Rl.transform(bc(e))+", "+Rl.transform(bc(n))+", "+bc(vc.transform(r))+")"},Tn={test:t=>Bi.test(t)||Ex.test(t)||gl.test(t),parse:t=>Bi.test(t)?Bi.parse(t):gl.test(t)?gl.parse(t):Ex.parse(t),transform:t=>Pf(t)?t:t.hasOwnProperty("red")?Bi.transform(t):gl.transform(t)};function hhe(t){var e,n;return isNaN(t)&&Pf(t)&&(((e=t.match(eC))===null||e===void 0?void 0:e.length)||0)+(((n=t.match(afe))===null||n===void 0?void 0:n.length)||0)>0}const NL="number",RL="color",phe="var",mhe="var(",KI="${}",ghe=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function rd(t){const e=t.toString(),n=[],r={color:[],number:[],var:[]},s=[];let o=0;const a=e.replace(ghe,l=>(Tn.test(l)?(r.color.push(o),s.push(RL),n.push(Tn.parse(l))):l.startsWith(mhe)?(r.var.push(o),s.push(phe),n.push(l)):(r.number.push(o),s.push(NL),n.push(parseFloat(l))),++o,KI)).split(KI);return{values:n,split:a,indexes:r,types:s}}function DL(t){return rd(t).values}function AL(t){const{split:e,types:n}=rd(t),r=e.length;return s=>{let o="";for(let i=0;i<r;i++)if(o+=e[i],s[i]!==void 0){const a=n[i];a===NL?o+=bc(s[i]):a===RL?o+=Tn.transform(s[i]):o+=s[i]}return o}}const vhe=t=>typeof t=="number"?0:t;function bhe(t){const e=DL(t);return AL(t)(e.map(vhe))}const wu={test:hhe,parse:DL,createTransformer:AL,getAnimatableNone:bhe},xhe=new Set(["brightness","contrast","saturate","opacity"]);function yhe(t){const[e,n]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[r]=n.match(eC)||[];if(!r)return t;const s=n.replace(r,"");let o=xhe.has(e)?1:0;return r!==n&&(o*=100),e+"("+o+s+")"}const whe=/\b([a-z-]*)\(.*?\)/gu,Nx={...wu,getAnimatableNone:t=>{const e=t.match(whe);return e?e.map(yhe).join(" "):t}},$he={...oL,color:Tn,backgroundColor:Tn,outlineColor:Tn,fill:Tn,stroke:Tn,borderColor:Tn,borderTopColor:Tn,borderRightColor:Tn,borderBottomColor:Tn,borderLeftColor:Tn,filter:Nx,WebkitFilter:Nx},uC=t=>$he[t];function FL(t,e){let n=uC(t);return n!==Nx&&(n=wu),n.getAnimatableNone?n.getAnimatableNone(e):void 0}const Che=new Set(["auto","none","0"]);function khe(t,e,n){let r=0,s;for(;r<t.length&&!s;){const o=t[r];typeof o=="string"&&!Che.has(o)&&rd(o).values.length&&(s=t[r]),r++}if(s&&n)for(const o of e)t[o]=FL(n,s)}class PL extends aC{constructor(e,n,r,s){super(e,n,r,s,s==null?void 0:s.owner,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:n,name:r}=this;if(!n.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let u=e[l];if(typeof u=="string"&&(u=u.trim(),J$(u))){const c=CL(u,n.current);c!==void 0&&(e[l]=c),l===e.length-1&&(this.finalKeyframe=u)}}if(this.resolveNoneKeyframes(),!ohe.has(r)||e.length!==2)return;const[s,o]=e,i=jI(s),a=jI(o);if(i!==a)if(UI(i)&&UI(a))for(let l=0;l<e.length;l++){const u=e[l];typeof u=="string"&&(e[l]=parseFloat(u))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:n}=this,r=[];for(let s=0;s<e.length;s++)nhe(e[s])&&r.push(s);r.length&&khe(e,r,n)}measureInitialState(){const{element:e,unresolvedKeyframes:n,name:r}=this;if(!e.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Zl[r](e.measureViewportBox(),window.getComputedStyle(e.current)),n[0]=this.measuredOrigin;const s=n[n.length-1];s!==void 0&&e.getValue(r,s).jump(s,!1)}measureEndState(){var e;const{element:n,name:r,unresolvedKeyframes:s}=this;if(!n.current)return;const o=n.getValue(r);o&&o.jump(this.measuredOrigin,!1);const i=s.length-1,a=s[i];s[i]=Zl[r](n.measureViewportBox(),window.getComputedStyle(n.current)),a!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=a),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([l,u])=>{n.getValue(l).set(u)}),this.resolveNoneKeyframes()}}function OL(t){let e;return()=>(e===void 0&&(e=t()),e)}const XI=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(wu.test(t)||t==="0")&&!t.startsWith("url("));function She(t){const e=t[0];if(t.length===1)return!0;for(let n=0;n<t.length;n++)if(t[n]!==e)return!0}function Ihe(t,e,n,r){const s=t[0];if(s===null)return!1;if(e==="display"||e==="visibility")return!0;const o=t[t.length-1],i=XI(s,e),a=XI(o,e);return!i||!a?!1:She(t)||n==="spring"&&r}class LL{constructor({autoplay:e=!0,delay:n=0,type:r="keyframes",repeat:s=0,repeatDelay:o=0,repeatType:i="loop",...a}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.options={autoplay:e,delay:n,type:r,repeat:s,repeatDelay:o,repeatType:i,...a},this.updateFinishedPromise()}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&che(),this._resolved}onKeyframesResolved(e,n){this.hasAttemptedResolve=!0;const{name:r,type:s,velocity:o,delay:i,onComplete:a,onUpdate:l,isGenerator:u}=this.options;if(!u&&!Ihe(e,r,s,o))if(i)this.options.duration=0;else{l==null||l(k0(e,this.options,n)),a==null||a(),this.resolveFinishedPromise();return}const c=this.initPlayback(e,n);c!==!1&&(this._resolved={keyframes:e,finalKeyframe:n,...c},this.onPostResolved())}onPostResolved(){}then(e,n){return this.currentFinishedPromise.then(e,n)}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}function ML(t,e){return e?t*(1e3/e):0}const The=5;function _L(t,e,n){const r=Math.max(e-The,0);return ML(n-t(r),e-r)}const Iv=.001,Ehe=.01,Nhe=10,Rhe=.05,Dhe=1;function Ahe({duration:t=800,bounce:e=.25,velocity:n=0,mass:r=1}){let s,o,i=1-e;i=Ql(Rhe,Dhe,i),t=Ql(Ehe,Nhe,ei(t)),i<1?(s=u=>{const c=u*i,d=c*t,f=c-n,h=Rx(u,i),p=Math.exp(-d);return Iv-f/h*p},o=u=>{const d=u*i*t,f=d*n+n,h=Math.pow(i,2)*Math.pow(u,2)*t,p=Math.exp(-d),g=Rx(Math.pow(u,2),i);return(-s(u)+Iv>0?-1:1)*((f-h)*p)/g}):(s=u=>{const c=Math.exp(-u*t),d=(u-n)*t+1;return-Iv+c*d},o=u=>{const c=Math.exp(-u*t),d=(n-u)*(t*t);return c*d});const a=5/t,l=Phe(s,o,a);if(t=Xi(t),isNaN(l))return{stiffness:100,damping:10,duration:t};{const u=Math.pow(l,2)*r;return{stiffness:u,damping:i*2*Math.sqrt(r*u),duration:t}}}const Fhe=12;function Phe(t,e,n){let r=n;for(let s=1;s<Fhe;s++)r=r-t(r)/e(r);return r}function Rx(t,e){return t*Math.sqrt(1-e*e)}const Ohe=["duration","bounce"],Lhe=["stiffness","damping","mass"];function qI(t,e){return e.some(n=>t[n]!==void 0)}function Mhe(t){let e={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...t};if(!qI(t,Lhe)&&qI(t,Ohe)){const n=Ahe(t);e={...e,...n,mass:1},e.isResolvedFromDuration=!0}return e}function zL({keyframes:t,restDelta:e,restSpeed:n,...r}){const s=t[0],o=t[t.length-1],i={done:!1,value:s},{stiffness:a,damping:l,mass:u,duration:c,velocity:d,isResolvedFromDuration:f}=Mhe({...r,velocity:-ei(r.velocity||0)}),h=d||0,p=l/(2*Math.sqrt(a*u)),g=o-s,v=ei(Math.sqrt(a/u)),m=Math.abs(g)<5;n||(n=m?.01:2),e||(e=m?.005:.5);let b;if(p<1){const x=Rx(v,p);b=y=>{const $=Math.exp(-p*v*y);return o-$*((h+p*v*g)/x*Math.sin(x*y)+g*Math.cos(x*y))}}else if(p===1)b=x=>o-Math.exp(-v*x)*(g+(h+v*g)*x);else{const x=v*Math.sqrt(p*p-1);b=y=>{const $=Math.exp(-p*v*y),C=Math.min(x*y,300);return o-$*((h+p*v*g)*Math.sinh(C)+x*g*Math.cosh(C))/x}}return{calculatedDuration:f&&c||null,next:x=>{const y=b(x);if(f)i.done=x>=c;else{let $=h;x!==0&&(p<1?$=_L(b,x,y):$=0);const C=Math.abs($)<=n,k=Math.abs(o-y)<=e;i.done=C&&k}return i.value=i.done?o:y,i}}}function YI({keyframes:t,velocity:e=0,power:n=.8,timeConstant:r=325,bounceDamping:s=10,bounceStiffness:o=500,modifyTarget:i,min:a,max:l,restDelta:u=.5,restSpeed:c}){const d=t[0],f={done:!1,value:d},h=w=>a!==void 0&&w<a||l!==void 0&&w>l,p=w=>a===void 0?l:l===void 0||Math.abs(a-w)<Math.abs(l-w)?a:l;let g=n*e;const v=d+g,m=i===void 0?v:i(v);m!==v&&(g=m-d);const b=w=>-g*Math.exp(-w/r),x=w=>m+b(w),y=w=>{const I=b(w),N=x(w);f.done=Math.abs(I)<=u,f.value=f.done?m:N};let $,C;const k=w=>{h(f.value)&&($=w,C=zL({keyframes:[f.value,p(f.value)],velocity:_L(x,w,f.value),damping:s,stiffness:o,restDelta:u,restSpeed:c}))};return k(0),{calculatedDuration:null,next:w=>{let I=!1;return!C&&$===void 0&&(I=!0,y(w),k(w)),$!==void 0&&w>=$?C.next(w-$):(!I&&y(w),f)}}}const VL=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t,_he=1e-7,zhe=12;function Vhe(t,e,n,r,s){let o,i,a=0;do i=e+(n-e)/2,o=VL(i,r,s)-t,o>0?n=i:e=i;while(Math.abs(o)>_he&&++a<zhe);return i}function Lf(t,e,n,r){if(t===e&&n===r)return Ws;const s=o=>Vhe(o,0,1,t,n);return o=>o===0||o===1?o:VL(s(o),e,r)}const Bhe=Lf(.42,0,1,1),Whe=Lf(0,0,.58,1),BL=Lf(.42,0,.58,1),Uhe=t=>Array.isArray(t)&&typeof t[0]!="number",WL=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,UL=t=>e=>1-t(1-e),cC=t=>1-Math.sin(Math.acos(t)),Ghe=UL(cC),Hhe=WL(cC),GL=Lf(.33,1.53,.69,.99),dC=UL(GL),jhe=WL(dC),Khe=t=>(t*=2)<1?.5*dC(t):.5*(2-Math.pow(2,-10*(t-1))),QI={linear:Ws,easeIn:Bhe,easeInOut:BL,easeOut:Whe,circIn:cC,circInOut:Hhe,circOut:Ghe,backIn:dC,backInOut:jhe,backOut:GL,anticipate:Khe},ZI=t=>{if(Array.isArray(t)){Sx(t.length===4);const[e,n,r,s]=t;return Lf(e,n,r,s)}else if(typeof t=="string")return Sx(QI[t]!==void 0),QI[t];return t},HL=(t,e,n)=>{const r=e-t;return r===0?1:(n-t)/r},S0=(t,e,n)=>t+(e-t)*n;function Tv(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function Xhe({hue:t,saturation:e,lightness:n,alpha:r}){t/=360,e/=100,n/=100;let s=0,o=0,i=0;if(!e)s=o=i=n;else{const a=n<.5?n*(1+e):n+e-n*e,l=2*n-a;s=Tv(l,a,t+1/3),o=Tv(l,a,t),i=Tv(l,a,t-1/3)}return{red:Math.round(s*255),green:Math.round(o*255),blue:Math.round(i*255),alpha:r}}function um(t,e){return n=>n>0?e:t}const Ev=(t,e,n)=>{const r=t*t,s=n*(e*e-r)+r;return s<0?0:Math.sqrt(s)},qhe=[Ex,Bi,gl],Yhe=t=>qhe.find(e=>e.test(t));function JI(t){const e=Yhe(t);if(!e)return!1;let n=e.parse(t);return e===gl&&(n=Xhe(n)),n}const e2=(t,e)=>{const n=JI(t),r=JI(e);if(!n||!r)return um(t,e);const s={...n};return o=>(s.red=Ev(n.red,r.red,o),s.green=Ev(n.green,r.green,o),s.blue=Ev(n.blue,r.blue,o),s.alpha=S0(n.alpha,r.alpha,o),Bi.transform(s))},Dx=new Set(["none","hidden"]);function Qhe(t,e){return Dx.has(t)?n=>n<=0?t:e:n=>n>=1?e:t}function Zhe(t,e){return n=>S0(t,e,n)}function fC(t){return typeof t=="number"?Zhe:typeof t=="string"?J$(t)?um:Tn.test(t)?e2:tpe:Array.isArray(t)?jL:typeof t=="object"?Tn.test(t)?e2:Jhe:um}function jL(t,e){const n=[...t],r=n.length,s=t.map((o,i)=>fC(o)(o,e[i]));return o=>{for(let i=0;i<r;i++)n[i]=s[i](o);return n}}function Jhe(t,e){const n={...t,...e},r={};for(const s in n)t[s]!==void 0&&e[s]!==void 0&&(r[s]=fC(t[s])(t[s],e[s]));return s=>{for(const o in r)n[o]=r[o](s);return n}}function epe(t,e){var n;const r=[],s={color:0,var:0,number:0};for(let o=0;o<e.values.length;o++){const i=e.types[o],a=t.indexes[i][s[i]],l=(n=t.values[a])!==null&&n!==void 0?n:0;r[o]=l,s[i]++}return r}const tpe=(t,e)=>{const n=wu.createTransformer(e),r=rd(t),s=rd(e);return r.indexes.var.length===s.indexes.var.length&&r.indexes.color.length===s.indexes.color.length&&r.indexes.number.length>=s.indexes.number.length?Dx.has(t)&&!s.values.length||Dx.has(e)&&!r.values.length?Qhe(t,e):Jo(jL(epe(r,s),s.values),n):um(t,e)};function KL(t,e,n){return typeof t=="number"&&typeof e=="number"&&typeof n=="number"?S0(t,e,n):fC(t)(t,e)}function npe(t,e,n){const r=[],s=n||KL,o=t.length-1;for(let i=0;i<o;i++){let a=s(t[i],t[i+1]);if(e){const l=Array.isArray(e)?e[i]||Ws:e;a=Jo(l,a)}r.push(a)}return r}function rpe(t,e,{clamp:n=!0,ease:r,mixer:s}={}){const o=t.length;if(Sx(o===e.length),o===1)return()=>e[0];if(o===2&&t[0]===t[1])return()=>e[1];t[0]>t[o-1]&&(t=[...t].reverse(),e=[...e].reverse());const i=npe(e,r,s),a=i.length,l=u=>{let c=0;if(a>1)for(;c<t.length-2&&!(u<t[c+1]);c++);const d=HL(t[c],t[c+1],u);return i[c](d)};return n?u=>l(Ql(t[0],t[o-1],u)):l}function spe(t,e){const n=t[t.length-1];for(let r=1;r<=e;r++){const s=HL(0,e,r);t.push(S0(n,1,s))}}function ope(t){const e=[0];return spe(e,t.length-1),e}function ipe(t,e){return t.map(n=>n*e)}function ape(t,e){return t.map(()=>e||BL).splice(0,t.length-1)}function cm({duration:t=300,keyframes:e,times:n,ease:r="easeInOut"}){const s=Uhe(r)?r.map(ZI):ZI(r),o={done:!1,value:e[0]},i=ipe(n&&n.length===e.length?n:ope(e),t),a=rpe(i,e,{ease:Array.isArray(s)?s:ape(e,s)});return{calculatedDuration:t,next:l=>(o.value=a(l),o.done=l>=t,o)}}const t2=2e4;function lpe(t){let e=0;const n=50;let r=t.next(e);for(;!r.done&&e<t2;)e+=n,r=t.next(e);return e>=t2?1/0:e}const upe=t=>{const e=({timestamp:n})=>t(n);return{start:()=>rn.update(e,!0),stop:()=>am(e),now:()=>lm.isProcessing?lm.timestamp:Dl.now()}},cpe={decay:YI,inertia:YI,tween:cm,keyframes:cm,spring:zL},dpe=t=>t/100;class hC extends LL{constructor({KeyframeResolver:e=aC,...n}){super(n),this.holdTime=null,this.startTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:a}=this.options;a&&a()};const{name:r,motionValue:s,keyframes:o}=this.options,i=(a,l)=>this.onKeyframesResolved(a,l);r&&s&&s.owner?this.resolver=s.owner.resolveKeyframes(o,i,r,s):this.resolver=new e(o,i,r,s),this.resolver.scheduleResolve()}initPlayback(e){const{type:n="keyframes",repeat:r=0,repeatDelay:s=0,repeatType:o,velocity:i=0}=this.options,a=cpe[n]||cm;let l,u;a!==cm&&typeof e[0]!="number"&&(l=Jo(dpe,KL(e[0],e[1])),e=[0,100]);const c=a({...this.options,keyframes:e});o==="mirror"&&(u=a({...this.options,keyframes:[...e].reverse(),velocity:-i})),c.calculatedDuration===null&&(c.calculatedDuration=lpe(c));const{calculatedDuration:d}=c,f=d+s,h=f*(r+1)-s;return{generator:c,mirroredGenerator:u,mapPercentToKeyframes:l,calculatedDuration:d,resolvedDuration:f,totalDuration:h}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,n=!1){const{resolved:r}=this;if(!r){const{keyframes:w}=this.options;return{done:!0,value:w[w.length-1]}}const{finalKeyframe:s,generator:o,mirroredGenerator:i,mapPercentToKeyframes:a,keyframes:l,calculatedDuration:u,totalDuration:c,resolvedDuration:d}=r;if(this.startTime===null)return o.next(0);const{delay:f,repeat:h,repeatType:p,repeatDelay:g,onUpdate:v}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-c/this.speed,this.startTime)),n?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const m=this.currentTime-f*(this.speed>=0?1:-1),b=this.speed>=0?m<0:m>c;this.currentTime=Math.max(m,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=c);let x=this.currentTime,y=o;if(h){const w=Math.min(this.currentTime,c)/d;let I=Math.floor(w),N=w%1;!N&&w>=1&&(N=1),N===1&&I--,I=Math.min(I,h+1),!!(I%2)&&(p==="reverse"?(N=1-N,g&&(N-=g/d)):p==="mirror"&&(y=i)),x=Ql(0,1,N)*d}const $=b?{done:!1,value:l[0]}:y.next(x);a&&($.value=a($.value));let{done:C}=$;!b&&u!==null&&(C=this.speed>=0?this.currentTime>=c:this.currentTime<=0);const k=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&C);return k&&s!==void 0&&($.value=k0(l,this.options,s)),v&&v($.value),k&&this.finish(),$}get duration(){const{resolved:e}=this;return e?ei(e.calculatedDuration):0}get time(){return ei(this.currentTime)}set time(e){e=Xi(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const n=this.playbackSpeed!==e;this.playbackSpeed=e,n&&(this.time=ei(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=upe,onPlay:n}=this.options;this.driver||(this.driver=e(s=>this.tick(s))),n&&n();const r=this.driver.now();this.holdTime!==null?this.startTime=r-this.holdTime:(!this.startTime||this.state==="finished")&&(this.startTime=r),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const XL=t=>Array.isArray(t)&&typeof t[0]=="number";function qL(t){return!!(!t||typeof t=="string"&&t in pC||XL(t)||Array.isArray(t)&&t.every(qL))}const nc=([t,e,n,r])=>`cubic-bezier(${t}, ${e}, ${n}, ${r})`,pC={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:nc([0,.65,.55,1]),circOut:nc([.55,0,1,.45]),backIn:nc([.31,.01,.66,-.59]),backOut:nc([.33,1.53,.69,.99])};function fpe(t){return YL(t)||pC.easeOut}function YL(t){if(t)return XL(t)?nc(t):Array.isArray(t)?t.map(fpe):pC[t]}function hpe(t,e,n,{delay:r=0,duration:s=300,repeat:o=0,repeatType:i="loop",ease:a,times:l}={}){const u={[e]:n};l&&(u.offset=l);const c=YL(a);return Array.isArray(c)&&(u.easing=c),t.animate(u,{delay:r,duration:s,easing:Array.isArray(c)?"linear":c,fill:"both",iterations:o+1,direction:i==="reverse"?"alternate":"normal"})}const ppe=OL(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),mpe=new Set(["opacity","clipPath","filter","transform"]),dm=10,gpe=2e4;function vpe(t){return t.type==="spring"||t.name==="backgroundColor"||!qL(t.ease)}function bpe(t,e){const n=new hC({...e,keyframes:t,repeat:0,delay:0,isGenerator:!0});let r={done:!1,value:t[0]};const s=[];let o=0;for(;!r.done&&o<gpe;)r=n.sample(o),s.push(r.value),o+=dm;return{times:void 0,keyframes:s,duration:o-dm,ease:"linear"}}class n2 extends LL{constructor(e){super(e);const{name:n,motionValue:r,keyframes:s}=this.options;this.resolver=new PL(s,(o,i)=>this.onKeyframesResolved(o,i),n,r),this.resolver.scheduleResolve()}initPlayback(e,n){var r;let{duration:s=300,times:o,ease:i,type:a,motionValue:l,name:u}=this.options;if(!(!((r=l.owner)===null||r===void 0)&&r.current))return!1;if(vpe(this.options)){const{onComplete:d,onUpdate:f,motionValue:h,...p}=this.options,g=bpe(e,p);e=g.keyframes,e.length===1&&(e[1]=e[0]),s=g.duration,o=g.times,i=g.ease,a="keyframes"}const c=hpe(l.owner.current,u,e,{...this.options,duration:s,times:o,ease:i});return c.startTime=Dl.now(),this.pendingTimeline?(c.timeline=this.pendingTimeline,this.pendingTimeline=void 0):c.onfinish=()=>{const{onComplete:d}=this.options;l.set(k0(e,this.options,n)),d&&d(),this.cancel(),this.resolveFinishedPromise()},{animation:c,duration:s,times:o,type:a,ease:i,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:n}=e;return ei(n)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:n}=e;return ei(n.currentTime||0)}set time(e){const{resolved:n}=this;if(!n)return;const{animation:r}=n;r.currentTime=Xi(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:n}=e;return n.playbackRate}set speed(e){const{resolved:n}=this;if(!n)return;const{animation:r}=n;r.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:n}=e;return n.playState}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:n}=this;if(!n)return Ws;const{animation:r}=n;r.timeline=e,r.onfinish=null}return Ws}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:n}=e;n.playState==="finished"&&this.updateFinishedPromise(),n.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:n}=e;n.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;const{resolved:e}=this;if(!e)return;const{animation:n,keyframes:r,duration:s,type:o,ease:i,times:a}=e;if(!(n.playState==="idle"||n.playState==="finished")){if(this.time){const{motionValue:l,onUpdate:u,onComplete:c,...d}=this.options,f=new hC({...d,keyframes:r,duration:s,type:o,ease:i,times:a,isGenerator:!0}),h=Xi(this.time);l.setWithVelocity(f.sample(h-dm).value,f.sample(h).value,dm)}this.cancel()}}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:n,name:r,repeatDelay:s,repeatType:o,damping:i,type:a}=e;return ppe()&&r&&mpe.has(r)&&n&&n.owner&&n.owner.current instanceof HTMLElement&&!n.owner.getProps().onUpdate&&!s&&o!=="mirror"&&i!==0&&a!=="inertia"}}function xpe(t,e){let n;const r=()=>{const{currentTime:s}=e,i=(s===null?0:s.value)/100;n!==i&&t(i),n=i};return rn.update(r,!0),()=>am(r)}const ype=OL(()=>window.ScrollTimeline!==void 0);class wpe{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}then(e,n){return Promise.all(this.animations).then(e).catch(n)}getAll(e){return this.animations[0][e]}setAll(e,n){for(let r=0;r<this.animations.length;r++)this.animations[r][e]=n}attachTimeline(e){const n=this.animations.map(r=>{if(ype()&&r.attachTimeline)r.attachTimeline(e);else return r.pause(),xpe(s=>{r.time=r.duration*s},e)});return()=>{n.forEach((r,s)=>{r&&r(),this.animations[s].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get duration(){let e=0;for(let n=0;n<this.animations.length;n++)e=Math.max(e,this.animations[n].duration);return e}runAll(e){this.animations.forEach(n=>n[e]())}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}const $pe=(t,e,n,r={},s,o)=>i=>{const a=yL(r,t)||{},l=a.delay||r.delay||0;let{elapsed:u=0}=r;u=u-Xi(l);let c={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:e.getVelocity(),...a,delay:-u,onUpdate:f=>{e.set(f),a.onUpdate&&a.onUpdate(f)},onComplete:()=>{i(),a.onComplete&&a.onComplete()},name:t,motionValue:e,element:o?void 0:s};Jfe(a)||(c={...c,...Zfe(t,c)}),c.duration&&(c.duration=Xi(c.duration)),c.repeatDelay&&(c.repeatDelay=Xi(c.repeatDelay)),c.from!==void 0&&(c.keyframes[0]=c.from);let d=!1;if((c.type===!1||c.duration===0&&!c.repeatDelay)&&(c.duration=0,c.delay===0&&(d=!0)),d&&!o&&e.get()!==void 0){const f=k0(c.keyframes,a);if(f!==void 0)return rn.update(()=>{c.onUpdate(f),c.onComplete()}),new wpe([])}return!o&&n2.supports(c)?new n2(c):new hC(c)};function fm(t){return!!(Bn(t)&&t.add)}function Cpe(t,e){t.indexOf(e)===-1&&t.push(e)}function kpe(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}class QL{constructor(){this.subscriptions=[]}add(e){return Cpe(this.subscriptions,e),()=>kpe(this.subscriptions,e)}notify(e,n,r){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](e,n,r);else for(let o=0;o<s;o++){const i=this.subscriptions[o];i&&i(e,n,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const r2=30,Spe=t=>!isNaN(parseFloat(t));class Ipe{constructor(e,n={}){this.version="11.2.10",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(r,s=!0)=>{const o=Dl.now();this.updatedAt!==o&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),s&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=n.owner}setCurrent(e){this.current=e,this.updatedAt=Dl.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=Spe(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,n){this.events[e]||(this.events[e]=new QL);const r=this.events[e].add(n);return e==="change"?()=>{r(),rn.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,n){this.passiveEffect=e,this.stopPassiveEffect=n}set(e,n=!0){!n||!this.passiveEffect?this.updateAndNotify(e,n):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,n,r){this.set(n),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-r}jump(e,n=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=Dl.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>r2)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,r2);return ML(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(e){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=e(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function hm(t,e){return new Ipe(t,e)}function Tpe(t,e,n){t.hasValue(e)?t.getValue(e).set(n):t.addValue(e,hm(n))}function Epe(t,e){const n=C0(t,e);let{transitionEnd:r={},transition:s={},...o}=n||{};o={...o,...r};for(const i in o){const a=kfe(o[i]);Tpe(t,i,a)}}function Npe(t){return t.getProps()[Q3]}function Rpe({protectedKeys:t,needsAnimating:e},n){const r=t.hasOwnProperty(n)&&e[n]!==!0;return e[n]=!1,r}function ZL(t,e,{delay:n=0,transitionOverride:r,type:s}={}){var o;let{transition:i=t.getDefaultTransition(),transitionEnd:a,...l}=e;const u=t.getValue("willChange");r&&(i=r);const c=[],d=s&&t.animationState&&t.animationState.getState()[s];for(const f in l){const h=t.getValue(f,(o=t.latestValues[f])!==null&&o!==void 0?o:null),p=l[f];if(p===void 0||d&&Rpe(d,f))continue;const g={delay:n,elapsed:0,...yL(i||{},f)};let v=!1;if(window.HandoffAppearAnimations){const b=Npe(t);if(b){const x=window.HandoffAppearAnimations(b,f,h,rn);x!==null&&(g.elapsed=x,v=!0)}}h.start($pe(f,h,p,t.shouldReduceMotion&&za.has(f)?{type:!1}:g,t,v));const m=h.animation;m&&(fm(u)&&(u.add(f),m.then(()=>u.remove(f))),c.push(m))}return a&&Promise.all(c).then(()=>{rn.update(()=>{a&&Epe(t,a)})}),c}function Ax(t,e,n={}){var r;const s=C0(t,e,n.type==="exit"?(r=t.presenceContext)===null||r===void 0?void 0:r.custom:void 0);let{transition:o=t.getDefaultTransition()||{}}=s||{};n.transitionOverride&&(o=n.transitionOverride);const i=s?()=>Promise.all(ZL(t,s,n)):()=>Promise.resolve(),a=t.variantChildren&&t.variantChildren.size?(u=0)=>{const{delayChildren:c=0,staggerChildren:d,staggerDirection:f}=o;return Dpe(t,e,c+u,d,f,n)}:()=>Promise.resolve(),{when:l}=o;if(l){const[u,c]=l==="beforeChildren"?[i,a]:[a,i];return u().then(()=>c())}else return Promise.all([i(),a(n.delay)])}function Dpe(t,e,n=0,r=0,s=1,o){const i=[],a=(t.variantChildren.size-1)*r,l=s===1?(u=0)=>u*r:(u=0)=>a-u*r;return Array.from(t.variantChildren).sort(Ape).forEach((u,c)=>{u.notify("AnimationStart",e),i.push(Ax(u,e,{...o,delay:n+l(c)}).then(()=>u.notify("AnimationComplete",e)))}),Promise.all(i)}function Ape(t,e){return t.sortNodePosition(e)}function Fpe(t,e,n={}){t.notify("AnimationStart",e);let r;if(Array.isArray(e)){const s=e.map(o=>Ax(t,o,n));r=Promise.all(s)}else if(typeof e=="string")r=Ax(t,e,n);else{const s=typeof e=="function"?C0(t,e,n.custom):e;r=Promise.all(ZL(t,s,n))}return r.then(()=>{rn.postRender(()=>{t.notify("AnimationComplete",e)})})}const Ppe=[...Y$].reverse(),Ope=Y$.length;function Lpe(t){return e=>Promise.all(e.map(({animation:n,options:r})=>Fpe(t,n,r)))}function Mpe(t){let e=Lpe(t);const n=zpe();let r=!0;const s=l=>(u,c)=>{var d;const f=C0(t,c,l==="exit"?(d=t.presenceContext)===null||d===void 0?void 0:d.custom:void 0);if(f){const{transition:h,transitionEnd:p,...g}=f;u={...u,...g,...p}}return u};function o(l){e=l(t)}function i(l){const u=t.getProps(),c=t.getVariantContext(!0)||{},d=[],f=new Set;let h={},p=1/0;for(let v=0;v<Ope;v++){const m=Ppe[v],b=n[m],x=u[m]!==void 0?u[m]:c[m],y=td(x),$=m===l?b.isActive:null;$===!1&&(p=v);let C=x===c[m]&&x!==u[m]&&y;if(C&&r&&t.manuallyAnimateOnMount&&(C=!1),b.protectedKeys={...h},!b.isActive&&$===null||!x&&!b.prevProp||w0(x)||typeof x=="boolean")continue;let w=_pe(b.prevProp,x)||m===l&&b.isActive&&!C&&y||v>p&&y,I=!1;const N=Array.isArray(x)?x:[x];let E=N.reduce(s(m),{});$===!1&&(E={});const{prevResolvedValues:R={}}=b,S={...R,...E},T=F=>{w=!0,f.has(F)&&(I=!0,f.delete(F)),b.needsAnimating[F]=!0;const L=t.getValue(F);L&&(L.liveStyle=!1)};for(const F in S){const L=E[F],G=R[F];if(h.hasOwnProperty(F))continue;let P=!1;Cx(L)&&Cx(G)?P=!xL(L,G):P=L!==G,P?L!=null?T(F):f.add(F):L!==void 0&&f.has(F)?T(F):b.protectedKeys[F]=!0}b.prevProp=x,b.prevResolvedValues=E,b.isActive&&(h={...h,...E}),r&&t.blockInitialAnimation&&(w=!1),w&&(!C||I)&&d.push(...N.map(F=>({animation:F,options:{type:m}})))}if(f.size){const v={};f.forEach(m=>{const b=t.getBaseTarget(m),x=t.getValue(m);x&&(x.liveStyle=!0),v[m]=b??null}),d.push({animation:v})}let g=!!d.length;return r&&(u.initial===!1||u.initial===u.animate)&&!t.manuallyAnimateOnMount&&(g=!1),r=!1,g?e(d):Promise.resolve()}function a(l,u){var c;if(n[l].isActive===u)return Promise.resolve();(c=t.variantChildren)===null||c===void 0||c.forEach(f=>{var h;return(h=f.animationState)===null||h===void 0?void 0:h.setActive(l,u)}),n[l].isActive=u;const d=i(l);for(const f in n)n[f].protectedKeys={};return d}return{animateChanges:i,setActive:a,setAnimateFunction:o,getState:()=>n}}function _pe(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!xL(e,t):!1}function ki(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function zpe(){return{animate:ki(!0),whileInView:ki(),whileHover:ki(),whileTap:ki(),whileDrag:ki(),whileFocus:ki(),exit:ki()}}class Vpe extends yu{constructor(e){super(e),e.animationState||(e.animationState=Mpe(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();this.unmount(),w0(e)&&(this.unmount=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:n}=this.node.prevProps||{};e!==n&&this.updateAnimationControlsSubscription()}unmount(){}}let Bpe=0;class Wpe extends yu{constructor(){super(...arguments),this.id=Bpe++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:n}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const s=this.node.animationState.setActive("exit",!e);n&&!e&&s.then(()=>n(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const Upe={animation:{Feature:Vpe},exit:{Feature:Wpe}},s2=()=>({min:0,max:0}),JL=()=>({x:s2(),y:s2()});function Gpe({top:t,left:e,right:n,bottom:r}){return{x:{min:e,max:n},y:{min:t,max:r}}}function Hpe(t,e){if(!e)return t;const n=e({x:t.left,y:t.top}),r=e({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}function jpe(t,e){return Gpe(Hpe(t.getBoundingClientRect(),e))}const Fx={current:null},eM={current:!1};function Kpe(){if(eM.current=!0,!!j$)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>Fx.current=t.matches;t.addListener(e),e()}else Fx.current=!1}function Xpe(t,e,n){const{willChange:r}=e;for(const s in e){const o=e[s],i=n[s];if(Bn(o))t.addValue(s,o),fm(r)&&r.add(s);else if(Bn(i))t.addValue(s,hm(o,{owner:t})),fm(r)&&r.remove(s);else if(i!==o)if(t.hasValue(s)){const a=t.getValue(s);a.liveStyle===!0?a.jump(o):a.hasAnimated||a.set(o)}else{const a=t.getStaticValue(s);t.addValue(s,hm(a!==void 0?a:o,{owner:t}))}}for(const s in n)e[s]===void 0&&t.removeValue(s);return e}const o2=new WeakMap,qpe=[...SL,Tn,wu],Ype=t=>qpe.find(kL(t)),tM=Object.keys(nd),Qpe=tM.length,i2=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],Zpe=Q$.length;function nM(t){if(t)return t.options.allowProjection!==!1?t.projection:nM(t.parent)}class Jpe{scrapeMotionValuesFromProps(e,n,r){return{}}constructor({parent:e,props:n,presenceContext:r,reducedMotionConfig:s,blockInitialAnimation:o,visualState:i},a={}){this.resolveKeyframes=(f,h,p,g)=>new this.KeyframeResolver(f,h,p,g,this),this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=aC,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>rn.render(this.render,!1,!0);const{latestValues:l,renderState:u}=i;this.latestValues=l,this.baseTarget={...l},this.initialValues=n.initial?{...l}:{},this.renderState=u,this.parent=e,this.props=n,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=s,this.options=a,this.blockInitialAnimation=!!o,this.isControllingVariants=$0(n),this.isVariantNode=eL(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:c,...d}=this.scrapeMotionValuesFromProps(n,{},this);for(const f in d){const h=d[f];l[f]!==void 0&&Bn(h)&&(h.set(l[f],!1),fm(c)&&c.add(f))}}mount(e){this.current=e,o2.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,r)=>this.bindToMotionValue(r,n)),eM.current||Kpe(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:Fx.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){var e;o2.delete(this.current),this.projection&&this.projection.unmount(),am(this.notifyUpdate),am(this.render),this.valueSubscriptions.forEach(n=>n()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const n in this.events)this.events[n].clear();for(const n in this.features)(e=this.features[n])===null||e===void 0||e.unmount();this.current=null}bindToMotionValue(e,n){const r=za.has(e),s=n.on("change",i=>{this.latestValues[e]=i,this.props.onUpdate&&rn.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0)}),o=n.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(e,()=>{s(),o(),n.owner&&n.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}loadFeatures({children:e,...n},r,s,o){let i,a;for(let l=0;l<Qpe;l++){const u=tM[l],{isEnabled:c,Feature:d,ProjectionNode:f,MeasureLayout:h}=nd[u];f&&(i=f),c(n)&&(!this.features[u]&&d&&(this.features[u]=new d(this)),h&&(a=h))}if((this.type==="html"||this.type==="svg")&&!this.projection&&i){const{layoutId:l,layout:u,drag:c,dragConstraints:d,layoutScroll:f,layoutRoot:h}=n;this.projection=new i(this.latestValues,n["data-framer-portal-id"]?void 0:nM(this.parent)),this.projection.setOptions({layoutId:l,layout:u,alwaysMeasureLayout:!!c||d&&J3(d),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof u=="string"?u:"both",initialPromotionConfig:o,layoutScroll:f,layoutRoot:h})}return a}updateFeatures(){for(const e in this.features){const n=this.features[e];n.isMounted?n.update():(n.mount(),n.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):JL()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,n){this.latestValues[e]=n}update(e,n){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let r=0;r<i2.length;r++){const s=i2[r];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const o="on"+s,i=e[o];i&&(this.propEventSubscriptions[s]=this.on(s,i))}this.prevMotionValues=Xpe(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(e=!1){if(e)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const r=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(r.initial=this.props.initial),r}const n={};for(let r=0;r<Zpe;r++){const s=Q$[r],o=this.props[s];(td(o)||o===!1)&&(n[s]=o)}return n}addVariantChild(e){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(e),()=>n.variantChildren.delete(e)}addValue(e,n){const r=this.values.get(e);n!==r&&(r&&this.removeValue(e),this.bindToMotionValue(e,n),this.values.set(e,n),this.latestValues[e]=n.get())}removeValue(e){this.values.delete(e);const n=this.valueSubscriptions.get(e);n&&(n(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,n){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&n!==void 0&&(r=hm(n===null?void 0:n,{owner:this}),this.addValue(e,r)),r}readValue(e,n){var r;let s=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(r=this.getBaseTargetFromProps(this.props,e))!==null&&r!==void 0?r:this.readValueFromInstance(this.current,e,this.options);return s!=null&&(typeof s=="string"&&($L(s)||wL(s))?s=parseFloat(s):!Ype(s)&&wu.test(n)&&(s=FL(e,n)),this.setBaseTarget(e,Bn(s)?s.get():s)),Bn(s)?s.get():s}setBaseTarget(e,n){this.baseTarget[e]=n}getBaseTarget(e){var n;const{initial:r}=this.props;let s;if(typeof r=="string"||typeof r=="object"){const i=iC(this.props,r,(n=this.presenceContext)===null||n===void 0?void 0:n.custom);i&&(s=i[e])}if(r&&s!==void 0)return s;const o=this.getBaseTargetFromProps(this.props,e);return o!==void 0&&!Bn(o)?o:this.initialValues[e]!==void 0&&s===void 0?void 0:this.baseTarget[e]}on(e,n){return this.events[e]||(this.events[e]=new QL),this.events[e].add(n)}notify(e,...n){this.events[e]&&this.events[e].notify(...n)}}class rM extends Jpe{constructor(){super(...arguments),this.KeyframeResolver=PL}sortInstanceNodePosition(e,n){return e.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(e,n){return e.style?e.style[n]:void 0}removeValueFromRenderState(e,{vars:n,style:r}){delete n[e],delete r[e]}}function eme(t){return window.getComputedStyle(t)}class tme extends rM{constructor(){super(...arguments),this.type="html"}readValueFromInstance(e,n){if(za.has(n)){const r=uC(n);return r&&r.default||0}else{const r=eme(e),s=(sL(n)?r.getPropertyValue(n):r[n])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(e,{transformPagePoint:n}){return jpe(e,n)}build(e,n,r,s){tC(e,n,r,s.transformTemplate)}scrapeMotionValuesFromProps(e,n,r){return oC(e,n,r)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Bn(e)&&(this.childSubscription=e.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}renderInstance(e,n,r,s){uL(e,n,r,s)}}class nme extends rM{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(e,n){return e[n]}readValueFromInstance(e,n){if(za.has(n)){const r=uC(n);return r&&r.default||0}return n=cL.has(n)?n:q$(n),e.getAttribute(n)}measureInstanceViewportBox(){return JL()}scrapeMotionValuesFromProps(e,n,r){return fL(e,n,r)}build(e,n,r,s){rC(e,n,r,this.isSVGTag,s.transformTemplate)}renderInstance(e,n,r,s){dL(e,n,r,s)}mount(e){this.isSVGTag=sC(e.tagName),super.mount(e)}}const rme=(t,e)=>Z$(t)?new nme(e,{enableHardwareAcceleration:!1}):new tme(e,{allowProjection:t!==A.Fragment,enableHardwareAcceleration:!0}),Px=Zde(Rfe);function sM(){const t=A.useRef(!1);return K$(()=>(t.current=!0,()=>{t.current=!1}),[]),t}function sme(){const t=sM(),[e,n]=A.useState(0),r=A.useCallback(()=>{t.current&&n(e+1)},[e]);return[A.useCallback(()=>rn.postRender(r),[r]),e]}class ome extends A.Component{getSnapshotBeforeUpdate(e){const n=this.props.childRef.current;if(n&&e.isPresent&&!this.props.isPresent){const r=this.props.sizeRef.current;r.height=n.offsetHeight||0,r.width=n.offsetWidth||0,r.top=n.offsetTop,r.left=n.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function ime({children:t,isPresent:e}){const n=A.useId(),r=A.useRef(null),s=A.useRef({width:0,height:0,top:0,left:0}),{nonce:o}=A.useContext(G$);return A.useInsertionEffect(()=>{const{width:i,height:a,top:l,left:u}=s.current;if(e||!r.current||!i||!a)return;r.current.dataset.motionPopId=n;const c=document.createElement("style");return o&&(c.nonce=o),document.head.appendChild(c),c.sheet&&c.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${i}px !important;
            height: ${a}px !important;
            top: ${l}px !important;
            left: ${u}px !important;
          }
        `),()=>{document.head.removeChild(c)}},[e]),Y.jsx(ome,{isPresent:e,childRef:r,sizeRef:s,children:A.cloneElement(t,{ref:r})})}const Nv=({children:t,initial:e,isPresent:n,onExitComplete:r,custom:s,presenceAffectsLayout:o,mode:i})=>{const a=hL(ame),l=A.useId(),u=A.useMemo(()=>({id:l,initial:e,isPresent:n,custom:s,onExitComplete:c=>{a.set(c,!0);for(const d of a.values())if(!d)return;r&&r()},register:c=>(a.set(c,!1),()=>a.delete(c))}),o?[Math.random()]:[n]);return A.useMemo(()=>{a.forEach((c,d)=>a.set(d,!1))},[n]),A.useEffect(()=>{!n&&!a.size&&r&&r()},[n]),i==="popLayout"&&(t=Y.jsx(ime,{isPresent:n,children:t})),Y.jsx(H$.Provider,{value:u,children:t})};function ame(){return new Map}function lme(t){return A.useEffect(()=>()=>t(),[])}const Ei=t=>t.key||"";function ume(t,e){t.forEach(n=>{const r=Ei(n);e.set(r,n)})}function cme(t){const e=[];return A.Children.forEach(t,n=>{A.isValidElement(n)&&e.push(n)}),e}const oM=({children:t,custom:e,initial:n=!0,onExitComplete:r,exitBeforeEnter:s,presenceAffectsLayout:o=!0,mode:i="sync"})=>{const a=A.useContext(tL).forceRender||sme()[0],l=sM(),u=cme(t);let c=u;const d=A.useRef(new Map).current,f=A.useRef(c),h=A.useRef(new Map).current,p=A.useRef(!0);if(K$(()=>{p.current=!1,ume(u,h),f.current=c}),lme(()=>{p.current=!0,h.clear(),d.clear()}),p.current)return Y.jsx(Y.Fragment,{children:c.map(b=>Y.jsx(Nv,{isPresent:!0,initial:n?void 0:!1,presenceAffectsLayout:o,mode:i,children:b},Ei(b)))});c=[...c];const g=f.current.map(Ei),v=u.map(Ei),m=g.length;for(let b=0;b<m;b++){const x=g[b];v.indexOf(x)===-1&&!d.has(x)&&d.set(x,void 0)}return i==="wait"&&d.size&&(c=[]),d.forEach((b,x)=>{if(v.indexOf(x)!==-1)return;const y=h.get(x);if(!y)return;const $=g.indexOf(x);let C=b;if(!C){const k=()=>{d.delete(x);const w=Array.from(h.keys()).filter(I=>!v.includes(I));if(w.forEach(I=>h.delete(I)),f.current=u.filter(I=>{const N=Ei(I);return N===x||w.includes(N)}),!d.size){if(l.current===!1)return;a(),r&&r()}};C=Y.jsx(Nv,{isPresent:!1,onExitComplete:k,custom:e,presenceAffectsLayout:o,mode:i,children:y},Ei(y)),d.set(x,C)}c.splice($,0,C)}),c=c.map(b=>{const x=b.key;return d.has(x)?b:Y.jsx(Nv,{isPresent:!0,presenceAffectsLayout:o,mode:i,children:b},Ei(b))}),Y.jsx(Y.Fragment,{children:d.size?c:c.map(b=>A.cloneElement(b))})};function Ox({children:t,features:e,strict:n=!1}){const[,r]=A.useState(!Rv(e)),s=A.useRef(void 0);if(!Rv(e)){const{renderer:o,...i}=e;s.current=o,$x(i)}return A.useEffect(()=>{Rv(e)&&e().then(({renderer:o,...i})=>{$x(i),s.current=o,r(!0)})},[]),Y.jsx(X$.Provider,{value:{renderer:s.current,strict:n},children:t})}function Rv(t){return typeof t=="function"}const Lx={renderer:rme,...Upe,...Kfe};function Io(t){return A.forwardRef(t)}var I0=(t,e,n=!0)=>{if(!e)return[t,{}];const r=e.reduce((s,o)=>o in t?{...s,[o]:t[o]}:s,{});return n?[Object.keys(t).filter(o=>!e.includes(o)).reduce((o,i)=>({...o,[i]:t[i]}),{}),r]:[t,r]},dme={default:"bg-default text-default-foreground",primary:"bg-primary text-primary-foreground",secondary:"bg-secondary text-secondary-foreground",success:"bg-success text-success-foreground",warning:"bg-warning text-warning-foreground",danger:"bg-danger text-danger-foreground",foreground:"bg-foreground text-background"},fme={default:"shadow-lg shadow-default/50 bg-default text-default-foreground",primary:"shadow-lg shadow-primary/40 bg-primary text-primary-foreground",secondary:"shadow-lg shadow-secondary/40 bg-secondary text-secondary-foreground",success:"shadow-lg shadow-success/40 bg-success text-success-foreground",warning:"shadow-lg shadow-warning/40 bg-warning text-warning-foreground",danger:"shadow-lg shadow-danger/40 bg-danger text-danger-foreground",foreground:"shadow-lg shadow-foreground/40 bg-foreground text-background"},hme={default:"bg-transparent border-default text-foreground",primary:"bg-transparent border-primary text-primary",secondary:"bg-transparent border-secondary text-secondary",success:"bg-transparent border-success text-success",warning:"bg-transparent border-warning text-warning",danger:"bg-transparent border-danger text-danger",foreground:"bg-transparent border-foreground text-foreground"},pme={default:"bg-default/40 text-default-foreground",primary:"bg-primary/20 text-primary",secondary:"bg-secondary/20 text-secondary",success:"bg-success/20 text-success-600 dark:text-success",warning:"bg-warning/20 text-warning-600 dark:text-warning",danger:"bg-danger/20 text-danger dark:text-danger-500",foreground:"bg-foreground/10 text-foreground"},mme={default:"border-default bg-default-100 text-default-foreground",primary:"border-default bg-default-100 text-primary",secondary:"border-default bg-default-100 text-secondary",success:"border-default bg-default-100 text-success",warning:"border-default bg-default-100 text-warning",danger:"border-default bg-default-100 text-danger",foreground:"border-default bg-default-100 text-foreground"},gme={default:"bg-transparent text-default-foreground",primary:"bg-transparent text-primary",secondary:"bg-transparent text-secondary",success:"bg-transparent text-success",warning:"bg-transparent text-warning",danger:"bg-transparent text-danger",foreground:"bg-transparent text-foreground"},vme={default:"border-default text-default-foreground hover:!bg-default",primary:"border-primary text-primary hover:!text-primary-foreground hover:!bg-primary",secondary:"border-secondary text-secondary hover:text-secondary-foreground hover:!bg-secondary",success:"border-success text-success hover:!text-success-foreground hover:!bg-success",warning:"border-warning text-warning hover:!text-warning-foreground hover:!bg-warning",danger:"border-danger text-danger hover:!text-danger-foreground hover:!bg-danger",foreground:"border-foreground text-foreground hover:!bg-foreground"},Ie={solid:dme,shadow:fme,bordered:hme,flat:pme,faded:mme,light:gme,ghost:vme},Sh=["small","medium","large"],a2={theme:{opacity:["disabled"],spacing:["divider"],borderWidth:Sh,borderRadius:Sh},classGroups:{shadow:[{shadow:Sh}],"font-size":[{text:["tiny",...Sh]}],"bg-image":["bg-stripe-gradient"]}},l2=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,cr=t=>!t||typeof t!="object"||Object.keys(t).length===0,bme=(t,e)=>JSON.stringify(t)===JSON.stringify(e);function iM(t,e){t.forEach(function(n){Array.isArray(n)?iM(n,e):e.push(n)})}function aM(t){let e=[];return iM(t,e),e}var lM=(...t)=>aM(t).filter(Boolean),uM=(t,e)=>{let n={},r=Object.keys(t),s=Object.keys(e);for(let o of r)if(s.includes(o)){let i=t[o],a=e[o];typeof i=="object"&&typeof a=="object"?n[o]=uM(i,a):Array.isArray(i)||Array.isArray(a)?n[o]=lM(a,i):n[o]=a+" "+i}else n[o]=t[o];for(let o of s)r.includes(o)||(n[o]=e[o]);return n},u2=t=>!t||typeof t!="string"?t:t.replace(/\s+/g," ").trim();function xme(){for(var t=0,e,n,r="";t<arguments.length;)(e=arguments[t++])&&(n=cM(e))&&(r&&(r+=" "),r+=n);return r}function cM(t){if(typeof t=="string")return t;for(var e,n="",r=0;r<t.length;r++)t[r]&&(e=cM(t[r]))&&(n&&(n+=" "),n+=e);return n}var mC="-";function yme(t){var e=$me(t),n=t.conflictingClassGroups,r=t.conflictingClassGroupModifiers,s=r===void 0?{}:r;function o(a){var l=a.split(mC);return l[0]===""&&l.length!==1&&l.shift(),dM(l,e)||wme(a)}function i(a,l){var u=n[a]||[];return l&&s[a]?[].concat(u,s[a]):u}return{getClassGroupId:o,getConflictingClassGroupIds:i}}function dM(t,e){var i;if(t.length===0)return e.classGroupId;var n=t[0],r=e.nextPart.get(n),s=r?dM(t.slice(1),r):void 0;if(s)return s;if(e.validators.length!==0){var o=t.join(mC);return(i=e.validators.find(function(a){var l=a.validator;return l(o)}))==null?void 0:i.classGroupId}}var c2=/^\[(.+)\]$/;function wme(t){if(c2.test(t)){var e=c2.exec(t)[1],n=e==null?void 0:e.substring(0,e.indexOf(":"));if(n)return"arbitrary.."+n}}function $me(t){var e=t.theme,n=t.prefix,r={nextPart:new Map,validators:[]},s=kme(Object.entries(t.classGroups),n);return s.forEach(function(o){var i=o[0],a=o[1];Mx(a,r,i,e)}),r}function Mx(t,e,n,r){t.forEach(function(s){if(typeof s=="string"){var o=s===""?e:d2(e,s);o.classGroupId=n;return}if(typeof s=="function"){if(Cme(s)){Mx(s(r),e,n,r);return}e.validators.push({validator:s,classGroupId:n});return}Object.entries(s).forEach(function(i){var a=i[0],l=i[1];Mx(l,d2(e,a),n,r)})})}function d2(t,e){var n=t;return e.split(mC).forEach(function(r){n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n}function Cme(t){return t.isThemeGetter}function kme(t,e){return e?t.map(function(n){var r=n[0],s=n[1],o=s.map(function(i){return typeof i=="string"?e+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(function(a){var l=a[0],u=a[1];return[e+l,u]})):i});return[r,o]}):t}function Sme(t){if(t<1)return{get:function(){},set:function(){}};var e=0,n=new Map,r=new Map;function s(o,i){n.set(o,i),e++,e>t&&(e=0,r=n,n=new Map)}return{get:function(i){var a=n.get(i);if(a!==void 0)return a;if((a=r.get(i))!==void 0)return s(i,a),a},set:function(i,a){n.has(i)?n.set(i,a):s(i,a)}}}var fM="!";function Ime(t){var e=t.separator||":",n=e.length===1,r=e[0],s=e.length;return function(i){for(var a=[],l=0,u=0,c,d=0;d<i.length;d++){var f=i[d];if(l===0){if(f===r&&(n||i.slice(d,d+s)===e)){a.push(i.slice(u,d)),u=d+s;continue}if(f==="/"){c=d;continue}}f==="["?l++:f==="]"&&l--}var h=a.length===0?i:i.substring(u),p=h.startsWith(fM),g=p?h.substring(1):h,v=c&&c>u?c-u:void 0;return{modifiers:a,hasImportantModifier:p,baseClassName:g,maybePostfixModifierPosition:v}}}function Tme(t){if(t.length<=1)return t;var e=[],n=[];return t.forEach(function(r){var s=r[0]==="[";s?(e.push.apply(e,n.sort().concat([r])),n=[]):n.push(r)}),e.push.apply(e,n.sort()),e}function Eme(t){return{cache:Sme(t.cacheSize),splitModifiers:Ime(t),...yme(t)}}var Nme=/\s+/;function Rme(t,e){var n=e.splitModifiers,r=e.getClassGroupId,s=e.getConflictingClassGroupIds,o=new Set;return t.trim().split(Nme).map(function(i){var a=n(i),l=a.modifiers,u=a.hasImportantModifier,c=a.baseClassName,d=a.maybePostfixModifierPosition,f=r(d?c.substring(0,d):c),h=!!d;if(!f){if(!d)return{isTailwindClass:!1,originalClassName:i};if(f=r(c),!f)return{isTailwindClass:!1,originalClassName:i};h=!1}var p=Tme(l).join(":"),g=u?p+fM:p;return{isTailwindClass:!0,modifierId:g,classGroupId:f,originalClassName:i,hasPostfixModifier:h}}).reverse().filter(function(i){if(!i.isTailwindClass)return!0;var a=i.modifierId,l=i.classGroupId,u=i.hasPostfixModifier,c=a+l;return o.has(c)?!1:(o.add(c),s(l,u).forEach(function(d){return o.add(a+d)}),!0)}).reverse().map(function(i){return i.originalClassName}).join(" ")}function _x(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r,s,o,i=a;function a(u){var c=e[0],d=e.slice(1),f=d.reduce(function(h,p){return p(h)},c());return r=Eme(f),s=r.cache.get,o=r.cache.set,i=l,l(u)}function l(u){var c=s(u);if(c)return c;var d=Rme(u,r);return o(u,d),d}return function(){return i(xme.apply(null,arguments))}}function pt(t){var e=function(r){return r[t]||[]};return e.isThemeGetter=!0,e}var hM=/^\[(?:([a-z-]+):)?(.+)\]$/i,Dme=/^\d+\/\d+$/,Ame=new Set(["px","full","screen"]),Fme=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Pme=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Ome=/^-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/;function ss(t){return Wi(t)||Ame.has(t)||Dme.test(t)||zx(t)}function zx(t){return Va(t,"length",Bme)}function Lme(t){return Va(t,"size",pM)}function Mme(t){return Va(t,"position",pM)}function _me(t){return Va(t,"url",Wme)}function Ih(t){return Va(t,"number",Wi)}function Wi(t){return!Number.isNaN(Number(t))}function zme(t){return t.endsWith("%")&&Wi(t.slice(0,-1))}function zu(t){return f2(t)||Va(t,"number",f2)}function _e(t){return hM.test(t)}function Vu(){return!0}function Eo(t){return Fme.test(t)}function Vme(t){return Va(t,"",Ume)}function Va(t,e,n){var r=hM.exec(t);return r?r[1]?r[1]===e:n(r[2]):!1}function Bme(t){return Pme.test(t)}function pM(){return!1}function Wme(t){return t.startsWith("url(")}function f2(t){return Number.isInteger(Number(t))}function Ume(t){return Ome.test(t)}function Vx(){var t=pt("colors"),e=pt("spacing"),n=pt("blur"),r=pt("brightness"),s=pt("borderColor"),o=pt("borderRadius"),i=pt("borderSpacing"),a=pt("borderWidth"),l=pt("contrast"),u=pt("grayscale"),c=pt("hueRotate"),d=pt("invert"),f=pt("gap"),h=pt("gradientColorStops"),p=pt("gradientColorStopPositions"),g=pt("inset"),v=pt("margin"),m=pt("opacity"),b=pt("padding"),x=pt("saturate"),y=pt("scale"),$=pt("sepia"),C=pt("skew"),k=pt("space"),w=pt("translate"),I=function(){return["auto","contain","none"]},N=function(){return["auto","hidden","clip","visible","scroll"]},E=function(){return["auto",_e,e]},R=function(){return[_e,e]},S=function(){return["",ss]},T=function(){return["auto",Wi,_e]},F=function(){return["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"]},L=function(){return["solid","dashed","dotted","double","none"]},G=function(){return["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter"]},P=function(){return["start","end","center","between","around","evenly","stretch"]},z=function(){return["","0",_e]},U=function(){return["auto","avoid","all","avoid-page","page","left","right","column"]},K=function(){return[Wi,Ih]},Q=function(){return[Wi,_e]};return{cacheSize:500,theme:{colors:[Vu],spacing:[ss],blur:["none","",Eo,_e],brightness:K(),borderColor:[t],borderRadius:["none","","full",Eo,_e],borderSpacing:R(),borderWidth:S(),contrast:K(),grayscale:z(),hueRotate:Q(),invert:z(),gap:R(),gradientColorStops:[t],gradientColorStopPositions:[zme,zx],inset:E(),margin:E(),opacity:K(),padding:R(),saturate:K(),scale:K(),sepia:z(),skew:Q(),space:R(),translate:R()},classGroups:{aspect:[{aspect:["auto","square","video",_e]}],container:["container"],columns:[{columns:[Eo]}],"break-after":[{"break-after":U()}],"break-before":[{"break-before":U()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none"]}],clear:[{clear:["left","right","both","none"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[].concat(F(),[_e])}],overflow:[{overflow:N()}],"overflow-x":[{"overflow-x":N()}],"overflow-y":[{"overflow-y":N()}],overscroll:[{overscroll:I()}],"overscroll-x":[{"overscroll-x":I()}],"overscroll-y":[{"overscroll-y":I()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[g]}],"inset-x":[{"inset-x":[g]}],"inset-y":[{"inset-y":[g]}],start:[{start:[g]}],end:[{end:[g]}],top:[{top:[g]}],right:[{right:[g]}],bottom:[{bottom:[g]}],left:[{left:[g]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",zu]}],basis:[{basis:E()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",_e]}],grow:[{grow:z()}],shrink:[{shrink:z()}],order:[{order:["first","last","none",zu]}],"grid-cols":[{"grid-cols":[Vu]}],"col-start-end":[{col:["auto",{span:["full",zu]},_e]}],"col-start":[{"col-start":T()}],"col-end":[{"col-end":T()}],"grid-rows":[{"grid-rows":[Vu]}],"row-start-end":[{row:["auto",{span:[zu]},_e]}],"row-start":[{"row-start":T()}],"row-end":[{"row-end":T()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",_e]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",_e]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal"].concat(P())}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal"].concat(P(),["baseline"])}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[].concat(P(),["baseline"])}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[b]}],px:[{px:[b]}],py:[{py:[b]}],ps:[{ps:[b]}],pe:[{pe:[b]}],pt:[{pt:[b]}],pr:[{pr:[b]}],pb:[{pb:[b]}],pl:[{pl:[b]}],m:[{m:[v]}],mx:[{mx:[v]}],my:[{my:[v]}],ms:[{ms:[v]}],me:[{me:[v]}],mt:[{mt:[v]}],mr:[{mr:[v]}],mb:[{mb:[v]}],ml:[{ml:[v]}],"space-x":[{"space-x":[k]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[k]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit",_e,e]}],"min-w":[{"min-w":["min","max","fit",_e,ss]}],"max-w":[{"max-w":["0","none","full","min","max","fit","prose",{screen:[Eo]},Eo,_e]}],h:[{h:[_e,e,"auto","min","max","fit"]}],"min-h":[{"min-h":["min","max","fit",_e,ss]}],"max-h":[{"max-h":[_e,e,"min","max","fit"]}],"font-size":[{text:["base",Eo,zx]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Ih]}],"font-family":[{font:[Vu]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",_e]}],"line-clamp":[{"line-clamp":["none",Wi,Ih]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",_e,ss]}],"list-image":[{"list-image":["none",_e]}],"list-style-type":[{list:["none","disc","decimal",_e]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[m]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[m]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[].concat(L(),["wavy"])}],"text-decoration-thickness":[{decoration:["auto","from-font",ss]}],"underline-offset":[{"underline-offset":["auto",_e,ss]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],indent:[{indent:R()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",_e]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",_e]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[m]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[].concat(F(),[Mme])}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",Lme]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},_me]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[p]}],"gradient-via-pos":[{via:[p]}],"gradient-to-pos":[{to:[p]}],"gradient-from":[{from:[h]}],"gradient-via":[{via:[h]}],"gradient-to":[{to:[h]}],rounded:[{rounded:[o]}],"rounded-s":[{"rounded-s":[o]}],"rounded-e":[{"rounded-e":[o]}],"rounded-t":[{"rounded-t":[o]}],"rounded-r":[{"rounded-r":[o]}],"rounded-b":[{"rounded-b":[o]}],"rounded-l":[{"rounded-l":[o]}],"rounded-ss":[{"rounded-ss":[o]}],"rounded-se":[{"rounded-se":[o]}],"rounded-ee":[{"rounded-ee":[o]}],"rounded-es":[{"rounded-es":[o]}],"rounded-tl":[{"rounded-tl":[o]}],"rounded-tr":[{"rounded-tr":[o]}],"rounded-br":[{"rounded-br":[o]}],"rounded-bl":[{"rounded-bl":[o]}],"border-w":[{border:[a]}],"border-w-x":[{"border-x":[a]}],"border-w-y":[{"border-y":[a]}],"border-w-s":[{"border-s":[a]}],"border-w-e":[{"border-e":[a]}],"border-w-t":[{"border-t":[a]}],"border-w-r":[{"border-r":[a]}],"border-w-b":[{"border-b":[a]}],"border-w-l":[{"border-l":[a]}],"border-opacity":[{"border-opacity":[m]}],"border-style":[{border:[].concat(L(),["hidden"])}],"divide-x":[{"divide-x":[a]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[a]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[m]}],"divide-style":[{divide:L()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:[""].concat(L())}],"outline-offset":[{"outline-offset":[_e,ss]}],"outline-w":[{outline:[ss]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:S()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[m]}],"ring-offset-w":[{"ring-offset":[ss]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",Eo,Vme]}],"shadow-color":[{shadow:[Vu]}],opacity:[{opacity:[m]}],"mix-blend":[{"mix-blend":G()}],"bg-blend":[{"bg-blend":G()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",Eo,_e]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[c]}],invert:[{invert:[d]}],saturate:[{saturate:[x]}],sepia:[{sepia:[$]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[c]}],"backdrop-invert":[{"backdrop-invert":[d]}],"backdrop-opacity":[{"backdrop-opacity":[m]}],"backdrop-saturate":[{"backdrop-saturate":[x]}],"backdrop-sepia":[{"backdrop-sepia":[$]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[i]}],"border-spacing-x":[{"border-spacing-x":[i]}],"border-spacing-y":[{"border-spacing-y":[i]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",_e]}],duration:[{duration:Q()}],ease:[{ease:["linear","in","out","in-out",_e]}],delay:[{delay:Q()}],animate:[{animate:["none","spin","ping","pulse","bounce",_e]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[y]}],"scale-x":[{"scale-x":[y]}],"scale-y":[{"scale-y":[y]}],rotate:[{rotate:[zu,_e]}],"translate-x":[{"translate-x":[w]}],"translate-y":[{"translate-y":[w]}],"skew-x":[{"skew-x":[C]}],"skew-y":[{"skew-y":[C]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",_e]}],accent:[{accent:["auto",t]}],appearance:["appearance-none"],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",_e]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":R()}],"scroll-mx":[{"scroll-mx":R()}],"scroll-my":[{"scroll-my":R()}],"scroll-ms":[{"scroll-ms":R()}],"scroll-me":[{"scroll-me":R()}],"scroll-mt":[{"scroll-mt":R()}],"scroll-mr":[{"scroll-mr":R()}],"scroll-mb":[{"scroll-mb":R()}],"scroll-ml":[{"scroll-ml":R()}],"scroll-p":[{"scroll-p":R()}],"scroll-px":[{"scroll-px":R()}],"scroll-py":[{"scroll-py":R()}],"scroll-ps":[{"scroll-ps":R()}],"scroll-pe":[{"scroll-pe":R()}],"scroll-pt":[{"scroll-pt":R()}],"scroll-pr":[{"scroll-pr":R()}],"scroll-pb":[{"scroll-pb":R()}],"scroll-pl":[{"scroll-pl":R()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","pinch-zoom","manipulation",{pan:["x","left","right","y","up","down"]}]}],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",_e]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[ss,Ih]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}}function Gme(t,e){for(var n in e)mM(t,n,e[n]);return t}var Hme=Object.prototype.hasOwnProperty,jme=new Set(["string","number","boolean"]);function mM(t,e,n){if(!Hme.call(t,e)||jme.has(typeof n)||n===null){t[e]=n;return}if(Array.isArray(n)&&Array.isArray(t[e])){t[e]=t[e].concat(n);return}if(typeof n=="object"&&typeof t[e]=="object"){if(t[e]===null){t[e]=n;return}for(var r in n)mM(t[e],r,n[r])}}function Kme(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return typeof t=="function"?_x.apply(void 0,[Vx,t].concat(n)):_x.apply(void 0,[function(){return Gme(Vx(),t)}].concat(n))}var Xme=_x(Vx),qme={twMerge:!0,twMergeConfig:{},responsiveVariants:!1},gM=t=>t||void 0,sd=(...t)=>gM(aM(t).filter(Boolean).join(" ")),Dv=null,pm={},Bx=!1,Bu=(...t)=>e=>e.twMerge?((!Dv||Bx)&&(Bx=!1,Dv=cr(pm)?Xme:Kme(pm)),gM(Dv(sd(t)))):sd(t),h2=(t,e)=>{for(let n in e)t.hasOwnProperty(n)?t[n]=sd(t[n],e[n]):t[n]=e[n];return t},Yme=(t,e)=>{let{extend:n=null,slots:r={},variants:s={},compoundVariants:o=[],compoundSlots:i=[],defaultVariants:a={}}=t,l={...qme,...e},u=n!=null&&n.base?sd(n.base,t==null?void 0:t.base):t==null?void 0:t.base,c=n!=null&&n.variants&&!cr(n.variants)?uM(s,n.variants):s,d=n!=null&&n.defaultVariants&&!cr(n.defaultVariants)?{...n.defaultVariants,...a}:a;!cr(l.twMergeConfig)&&!bme(l.twMergeConfig,pm)&&(Bx=!0,pm=l.twMergeConfig);let f=cr(n==null?void 0:n.slots),h=cr(r)?{}:{base:sd(t==null?void 0:t.base,f&&(n==null?void 0:n.base)),...r},p=f?h:h2({...n==null?void 0:n.slots},cr(h)?{base:t==null?void 0:t.base}:h),g=m=>{if(cr(c)&&cr(r)&&f)return Bu(u,m==null?void 0:m.class,m==null?void 0:m.className)(l);if(o&&!Array.isArray(o))throw new TypeError(`The "compoundVariants" prop must be an array. Received: ${typeof o}`);if(i&&!Array.isArray(i))throw new TypeError(`The "compoundSlots" prop must be an array. Received: ${typeof i}`);let b=(R,S,T=[],F)=>{let L=T;if(typeof S=="string")L=L.concat(u2(S).split(" ").map(G=>`${R}:${G}`));else if(Array.isArray(S))L=L.concat(S.reduce((G,P)=>G.concat(`${R}:${P}`),[]));else if(typeof S=="object"&&typeof F=="string"){for(let G in S)if(S.hasOwnProperty(G)&&G===F){let P=S[G];if(P&&typeof P=="string"){let z=u2(P);L[F]?L[F]=L[F].concat(z.split(" ").map(U=>`${R}:${U}`)):L[F]=z.split(" ").map(U=>`${R}:${U}`)}else Array.isArray(P)&&P.length>0&&(L[F]=P.reduce((z,U)=>z.concat(`${R}:${U}`),[]))}}return L},x=(R,S=c,T=null,F=null)=>{var L;let G=S[R];if(!G||cr(G))return null;let P=(L=F==null?void 0:F[R])!=null?L:m==null?void 0:m[R];if(P===null)return null;let z=l2(P),U=Array.isArray(l.responsiveVariants)&&l.responsiveVariants.length>0||l.responsiveVariants===!0,K=d==null?void 0:d[R],Q=[];if(typeof z=="object"&&U)for(let[te,J]of Object.entries(z)){let re=G[J];if(te==="initial"){K=J;continue}Array.isArray(l.responsiveVariants)&&!l.responsiveVariants.includes(te)||(Q=b(te,re,Q,T))}let Z=G[z]||G[l2(K)];return typeof Q=="object"&&typeof T=="string"&&Q[T]?h2(Q,Z):Q.length>0?(Q.push(Z),Q):Z},y=()=>c?Object.keys(c).map(R=>x(R,c)):null,$=(R,S)=>{if(!c||typeof c!="object")return null;let T=new Array;for(let F in c){let L=x(F,c,R,S),G=R==="base"&&typeof L=="string"?L:L&&L[R];G&&(T[T.length]=G)}return T},C={};for(let R in m)m[R]!==void 0&&(C[R]=m[R]);let k=(R,S)=>{var T;let F=typeof(m==null?void 0:m[R])=="object"?{[R]:(T=m[R])==null?void 0:T.initial}:{};return{...d,...C,...F,...S}},w=(R=[],S)=>{let T=[];for(let{class:F,className:L,...G}of R){let P=!0;for(let[z,U]of Object.entries(G)){let K=k(z,S);if(Array.isArray(U)){if(!U.includes(K[z])){P=!1;break}}else if(K[z]!==U){P=!1;break}}P&&(F&&T.push(F),L&&T.push(L))}return T},I=R=>{let S=w(o,R),T=w(n==null?void 0:n.compoundVariants,R);return lM(T,S)},N=R=>{let S=I(R);if(!Array.isArray(S))return S;let T={};for(let F of S)if(typeof F=="string"&&(T.base=Bu(T.base,F)(l)),typeof F=="object")for(let[L,G]of Object.entries(F))T[L]=Bu(T[L],G)(l);return T},E=R=>{if(i.length<1)return null;let S={};for(let{slots:T=[],class:F,className:L,...G}of i){if(!cr(G)){let P=!0;for(let z of Object.keys(G)){let U=k(z,R)[z];if(U===void 0||(Array.isArray(G[z])?!G[z].includes(U):G[z]!==U)){P=!1;break}}if(!P)continue}for(let P of T)S[P]=S[P]||[],S[P].push([F,L])}return S};if(!cr(r)||!f){let R={};if(typeof p=="object"&&!cr(p))for(let S of Object.keys(p))R[S]=T=>{var F,L;return Bu(p[S],$(S,T),((F=N(T))!=null?F:[])[S],((L=E(T))!=null?L:[])[S],T==null?void 0:T.class,T==null?void 0:T.className)(l)};return R}return Bu(u,y(),I(),m==null?void 0:m.class,m==null?void 0:m.className)(l)},v=()=>{if(!(!c||typeof c!="object"))return Object.keys(c)};return g.variantKeys=v(),g.extend=n,g.base=u,g.slots=p,g.variants=c,g.defaultVariants=d,g.compoundSlots=i,g.compoundVariants=o,g},$u=(t,e)=>{var n,r,s;return Yme(t,{...e,twMerge:(n=void 0)!=null?n:!0,twMergeConfig:{theme:{...(r=void 0)==null?void 0:r.theme,...a2.theme},classGroups:{...(s=void 0)==null?void 0:s.classGroups,...a2.classGroups}}})},gC=["outline-none","data-[focus-visible=true]:z-10","data-[focus-visible=true]:outline-2","data-[focus-visible=true]:outline-focus","data-[focus-visible=true]:outline-offset-2"],vM=["outline-none","group-data-[focus-visible=true]:z-10","group-data-[focus-visible=true]:ring-2","group-data-[focus-visible=true]:ring-focus","group-data-[focus-visible=true]:ring-offset-2","group-data-[focus-visible=true]:ring-offset-background"],qa={default:["[&+.border-medium.border-default]:ms-[calc(theme(borderWidth.medium)*-1)]"],primary:["[&+.border-medium.border-primary]:ms-[calc(theme(borderWidth.medium)*-1)]"],secondary:["[&+.border-medium.border-secondary]:ms-[calc(theme(borderWidth.medium)*-1)]"],success:["[&+.border-medium.border-success]:ms-[calc(theme(borderWidth.medium)*-1)]"],warning:["[&+.border-medium.border-warning]:ms-[calc(theme(borderWidth.medium)*-1)]"],danger:["[&+.border-medium.border-danger]:ms-[calc(theme(borderWidth.medium)*-1)]"]},p2=$u({slots:{base:"group relative max-w-fit inline-flex items-center justify-start cursor-pointer touch-none tap-highlight-transparent",wrapper:["px-1","relative","inline-flex","items-center","justify-start","flex-shrink-0","overflow-hidden","bg-default-200","rounded-full",...vM],thumb:["z-10","flex","items-center","justify-center","bg-white","shadow-small","rounded-full","origin-right"],startContent:"z-0 absolute left-1.5 rtl:right-1.5 rtl:left-[unset] text-current",endContent:"z-0 absolute right-1.5 rtl:left-1.5 rtl:right-[unset] text-default-600",thumbIcon:"text-black",label:"relative text-foreground select-none"},variants:{color:{default:{wrapper:["group-data-[selected=true]:bg-default-400","group-data-[selected=true]:text-default-foreground"]},primary:{wrapper:["group-data-[selected=true]:bg-primary","group-data-[selected=true]:text-primary-foreground"]},secondary:{wrapper:["group-data-[selected=true]:bg-secondary","group-data-[selected=true]:text-secondary-foreground"]},success:{wrapper:["group-data-[selected=true]:bg-success","group-data-[selected=true]:text-success-foreground"]},warning:{wrapper:["group-data-[selected=true]:bg-warning","group-data-[selected=true]:text-warning-foreground"]},danger:{wrapper:["group-data-[selected=true]:bg-danger","data-[selected=true]:text-danger-foreground"]}},size:{sm:{wrapper:"w-10 h-6 mr-2 rtl:ml-2 rtl:mr-[unset]",thumb:["w-4 h-4 text-tiny","group-data-[selected=true]:ml-4 rtl:group-data-[selected=true]:ml-0 rtl:group-data-[selected=true]:mr-4"],endContent:"text-tiny",startContent:"text-tiny",label:"text-small"},md:{wrapper:"w-12 h-7 mr-2 rtl:ml-2 rtl:mr-[unset]",thumb:["w-5 h-5 text-small","group-data-[selected=true]:ml-5 rtl:group-data-[selected=true]:ml-0 rtl:group-data-[selected=true]:mr-5"],endContent:"text-small",startContent:"text-small",label:"text-medium"},lg:{wrapper:"w-14 h-8 mr-2 rtl:ml-2 rtl:mr-[unset]",thumb:["w-6 h-6 text-medium","group-data-[selected=true]:ml-6 rtl:group-data-[selected=true]:ml-0 rtl:group-data-[selected=true]:mr-6"],endContent:"text-medium",startContent:"text-medium",label:"text-large"}},isDisabled:{true:{base:"opacity-disabled pointer-events-none"}},disableAnimation:{true:{wrapper:"transition-none",thumb:"transition-none"},false:{wrapper:"transition-background",thumb:"transition-all",startContent:["opacity-0","scale-50","transition-transform-opacity","group-data-[selected=true]:scale-100","group-data-[selected=true]:opacity-100"],endContent:["opacity-100","transition-transform-opacity","group-data-[selected=true]:translate-x-3","group-data-[selected=true]:opacity-0"]}}},defaultVariants:{color:"primary",size:"md",isDisabled:!1},compoundVariants:[{disableAnimation:!1,size:"sm",class:{thumb:["group-data-[pressed=true]:w-5","group-data-[selected]:group-data-[pressed]:ml-3"]}},{disableAnimation:!1,size:"md",class:{thumb:["group-data-[pressed=true]:w-6","group-data-[selected]:group-data-[pressed]:ml-4"]}},{disableAnimation:!1,size:"lg",class:{thumb:["group-data-[pressed=true]:w-7","group-data-[selected]:group-data-[pressed]:ml-5"]}}]}),m2=$u({slots:{base:"relative inline-flex flex-col gap-2 items-center justify-center",wrapper:"relative flex",circle1:["absolute","w-full","h-full","rounded-full","animate-spinner-ease-spin","border-2","border-solid","border-t-transparent","border-l-transparent","border-r-transparent"],circle2:["absolute","w-full","h-full","rounded-full","opacity-75","animate-spinner-linear-spin","border-2","border-dotted","border-t-transparent","border-l-transparent","border-r-transparent"],label:"text-foreground dark:text-foreground-dark font-regular"},variants:{size:{sm:{wrapper:"w-5 h-5",circle1:"border-2",circle2:"border-2",label:"text-small"},md:{wrapper:"w-8 h-8",circle1:"border-3",circle2:"border-3",label:"text-medium"},lg:{wrapper:"w-10 h-10",circle1:"border-3",circle2:"border-3",label:"text-large"}},color:{current:{circle1:"border-b-current",circle2:"border-b-current"},white:{circle1:"border-b-white",circle2:"border-b-white"},default:{circle1:"border-b-default",circle2:"border-b-default"},primary:{circle1:"border-b-primary",circle2:"border-b-primary"},secondary:{circle1:"border-b-secondary",circle2:"border-b-secondary"},success:{circle1:"border-b-success",circle2:"border-b-success"},warning:{circle1:"border-b-warning",circle2:"border-b-warning"},danger:{circle1:"border-b-danger",circle2:"border-b-danger"}},labelColor:{foreground:{label:"text-foreground"},primary:{label:"text-primary"},secondary:{label:"text-secondary"},success:{label:"text-success"},warning:{label:"text-warning"},danger:{label:"text-danger"}}},defaultVariants:{size:"md",color:"primary",labelColor:"foreground"}}),g2=$u({slots:{wrapper:["flex","w-screen","h-[100dvh]","fixed","inset-0","z-50","overflow-x-auto","justify-center"],base:["flex","flex-col","relative","bg-white","z-50","w-full","box-border","bg-content1","outline-none","mx-1","my-1","sm:mx-6","sm:my-16"],backdrop:"z-50",header:"flex py-4 px-6 flex-initial text-large font-semibold",body:"flex flex-1 flex-col gap-3 px-6 py-2",footer:"flex flex-row gap-2 px-6 py-4 justify-end",closeButton:["absolute","appearance-none","outline-none","select-none","top-1","right-1","rtl:left-1","rtl:right-[unset]","p-2","text-foreground-500","rounded-full","hover:bg-default-100","active:bg-default-200","tap-highlight-transparent",...gC]},variants:{size:{xs:{base:"max-w-xs"},sm:{base:"max-w-sm"},md:{base:"max-w-md"},lg:{base:"max-w-lg"},xl:{base:"max-w-xl"},"2xl":{base:"max-w-2xl"},"3xl":{base:"max-w-3xl"},"4xl":{base:"max-w-4xl"},"5xl":{base:"max-w-5xl"},full:{base:"my-0 mx-0 sm:mx-0 sm:my-0 max-w-full h-[100dvh] !rounded-none"}},radius:{none:{base:"rounded-none"},sm:{base:"rounded-small"},md:{base:"rounded-medium"},lg:{base:"rounded-large"}},placement:{auto:{wrapper:"items-end sm:items-center"},center:{wrapper:"items-center sm:items-center"},top:{wrapper:"items-start sm:items-start"},"top-center":{wrapper:"items-start sm:items-center"},bottom:{wrapper:"items-end sm:items-end"},"bottom-center":{wrapper:"items-end sm:items-center"}},shadow:{sm:{base:"shadow-small"},md:{base:"shadow-medium"},lg:{base:"shadow-large"}},backdrop:{transparent:{backdrop:"hidden"},opaque:{backdrop:"bg-overlay/50 backdrop-opacity-disabled"},blur:{backdrop:"backdrop-blur-md backdrop-saturate-150 bg-overlay/30"}},scrollBehavior:{normal:{base:"overflow-y-hidden"},inside:{base:"max-h-[calc(100%_-_7.5rem)]",body:"overflow-y-auto"},outside:{wrapper:"items-start sm:items-start overflow-y-auto",base:"my-16"}},disableAnimation:{false:{wrapper:["[--scale-enter:100%]","[--scale-exit:100%]","[--slide-enter:0px]","[--slide-exit:80px]","sm:[--scale-enter:100%]","sm:[--scale-exit:103%]","sm:[--slide-enter:0px]","sm:[--slide-exit:0px]"]}}},defaultVariants:{size:"md",radius:"lg",shadow:"sm",placement:"auto",backdrop:"opaque",scrollBehavior:"normal"},compoundVariants:[{backdrop:["opaque","blur"],class:{backdrop:"w-screen h-screen fixed inset-0"}}]}),v2=$u({slots:{base:"group flex flex-col",label:["absolute","z-10","pointer-events-none","origin-top-left","rtl:origin-top-right","subpixel-antialiased","block","text-small","text-foreground-500"],mainWrapper:"h-full",inputWrapper:"relative w-full inline-flex tap-highlight-transparent flex-row items-center shadow-sm px-3 gap-3",innerWrapper:"inline-flex w-full items-center h-full box-border",input:["w-full font-normal bg-transparent !outline-none placeholder:text-foreground-500 focus-visible:outline-none","data-[has-start-content=true]:ps-1.5","data-[has-end-content=true]:pe-1.5"],clearButton:["p-2","-m-2","z-10","hidden","absolute","right-3","rtl:right-auto","rtl:left-3","appearance-none","outline-none","select-none","opacity-0","hover:!opacity-100","cursor-pointer","active:!opacity-70","rounded-full",...gC],helperWrapper:"hidden group-data-[has-helper=true]:flex p-1 relative flex-col gap-1.5",description:"text-tiny text-foreground-400",errorMessage:"text-tiny text-danger"},variants:{variant:{flat:{inputWrapper:["bg-default-100","data-[hover=true]:bg-default-200","group-data-[focus=true]:bg-default-100"]},faded:{inputWrapper:["bg-default-100","border-medium","border-default-200","data-[hover=true]:border-default-400"],value:"group-data-[has-value=true]:text-default-foreground"},bordered:{inputWrapper:["border-medium","border-default-200","data-[hover=true]:border-default-400","group-data-[focus=true]:border-default-foreground"]},underlined:{inputWrapper:["!px-1","!pb-0","!gap-0","relative","box-border","border-b-medium","shadow-[0_1px_0px_0_rgba(0,0,0,0.05)]","border-default-200","!rounded-none","hover:border-default-300","after:content-['']","after:w-0","after:origin-center","after:bg-default-foreground","after:absolute","after:left-1/2","after:-translate-x-1/2","after:-bottom-[2px]","after:h-[2px]","group-data-[focus=true]:after:w-full"],innerWrapper:"pb-1",label:"group-data-[filled-within=true]:text-foreground"}},color:{default:{},primary:{},secondary:{},success:{},warning:{},danger:{}},size:{sm:{label:"text-tiny",inputWrapper:"h-8 min-h-8 px-2 rounded-small",input:"text-small",clearButton:"text-medium"},md:{inputWrapper:"h-10 min-h-10 rounded-medium",input:"text-small",clearButton:"text-large"},lg:{inputWrapper:"h-12 min-h-12 rounded-large",input:"text-medium",clearButton:"text-large"}},radius:{none:{inputWrapper:"rounded-none"},sm:{inputWrapper:"rounded-small"},md:{inputWrapper:"rounded-medium"},lg:{inputWrapper:"rounded-large"},full:{inputWrapper:"rounded-full"}},labelPlacement:{outside:{mainWrapper:"flex flex-col"},"outside-left":{base:"flex-row items-center flex-nowrap data-[has-helper=true]:items-start",inputWrapper:"flex-1",mainWrapper:"flex flex-col",label:"relative text-foreground pr-2 rtl:pr-0 rtl:pl-2"},inside:{label:"text-tiny cursor-text",inputWrapper:"flex-col items-start justify-center gap-0",innerWrapper:"group-data-[has-label=true]:items-end"}},fullWidth:{true:{base:"w-full"}},isClearable:{true:{input:"peer pr-6 rtl:pr-0 rtl:pl-6",clearButton:"peer-data-[filled=true]:opacity-70 peer-data-[filled=true]:block"}},isDisabled:{true:{base:"opacity-disabled pointer-events-none",inputWrapper:"pointer-events-none",label:"pointer-events-none"}},isInvalid:{true:{label:"!text-danger",input:"!placeholder:text-danger !text-danger"}},isRequired:{true:{label:"after:content-['*'] after:text-danger after:ml-0.5 rtl:after:ml-[unset] rtl:after:mr-0.5"}},isMultiline:{true:{label:"relative",inputWrapper:"!h-auto",innerWrapper:"items-start group-data-[has-label=true]:items-start",input:"resize-none data-[hide-scroll=true]:scrollbar-hide"}},disableAnimation:{true:{input:"transition-none",inputWrapper:"transition-none",label:"transition-none"},false:{inputWrapper:"transition-background motion-reduce:transition-none !duration-150",label:["will-change-auto","!duration-200","!ease-out","motion-reduce:transition-none","transition-[transform,color,left,opacity]"],clearButton:["transition-opacity","motion-reduce:transition-none"]}}},defaultVariants:{variant:"flat",color:"default",size:"md",fullWidth:!0,labelPlacement:"inside",isDisabled:!1,isMultiline:!1},compoundVariants:[{variant:"flat",color:"default",class:{input:"group-data-[has-value=true]:text-default-foreground"}},{variant:"flat",color:"primary",class:{inputWrapper:["bg-primary-50","data-[hover=true]:bg-primary-100","text-primary","group-data-[focus=true]:bg-primary-50","placeholder:text-primary"],input:"placeholder:text-primary",label:"text-primary"}},{variant:"flat",color:"secondary",class:{inputWrapper:["bg-secondary-50","text-secondary","data-[hover=true]:bg-secondary-100","group-data-[focus=true]:bg-secondary-50","placeholder:text-secondary"],input:"placeholder:text-secondary",label:"text-secondary"}},{variant:"flat",color:"success",class:{inputWrapper:["bg-success-50","text-success-600","dark:text-success","placeholder:text-success-600","dark:placeholder:text-success","data-[hover=true]:bg-success-100","group-data-[focus=true]:bg-success-50"],input:"placeholder:text-success-600 dark:placeholder:text-success",label:"text-success-600 dark:text-success"}},{variant:"flat",color:"warning",class:{inputWrapper:["bg-warning-50","text-warning-600","dark:text-warning","placeholder:text-warning-600","dark:placeholder:text-warning","data-[hover=true]:bg-warning-100","group-data-[focus=true]:bg-warning-50"],input:"placeholder:text-warning-600 dark:placeholder:text-warning",label:"text-warning-600 dark:text-warning"}},{variant:"flat",color:"danger",class:{inputWrapper:["bg-danger-50","text-danger","dark:text-danger-500","placeholder:text-danger","dark:placeholder:text-danger-500","data-[hover=true]:bg-danger-100","group-data-[focus=true]:bg-danger-50"],input:"placeholder:text-danger dark:placeholder:text-danger-500",label:"text-danger dark:text-danger-500"}},{variant:"faded",color:"primary",class:{label:"text-primary",inputWrapper:"data-[hover=true]:border-primary focus-within:border-primary"}},{variant:"faded",color:"secondary",class:{label:"text-secondary",inputWrapper:"data-[hover=true]:border-secondary focus-within:border-secondary"}},{variant:"faded",color:"success",class:{label:"text-success",inputWrapper:"data-[hover=true]:border-success focus-within:border-success"}},{variant:"faded",color:"warning",class:{label:"text-warning",inputWrapper:"data-[hover=true]:border-warning focus-within:border-warning"}},{variant:"faded",color:"danger",class:{label:"text-danger",inputWrapper:"data-[hover=true]:border-danger focus-within:border-danger"}},{variant:"underlined",color:"default",class:{input:"group-data-[has-value=true]:text-foreground"}},{variant:"underlined",color:"primary",class:{inputWrapper:"after:bg-primary",label:"text-primary"}},{variant:"underlined",color:"secondary",class:{inputWrapper:"after:bg-secondary",label:"text-secondary"}},{variant:"underlined",color:"success",class:{inputWrapper:"after:bg-success",label:"text-success"}},{variant:"underlined",color:"warning",class:{inputWrapper:"after:bg-warning",label:"text-warning"}},{variant:"underlined",color:"danger",class:{inputWrapper:"after:bg-danger",label:"text-danger"}},{variant:"bordered",color:"primary",class:{inputWrapper:"group-data-[focus=true]:border-primary",label:"text-primary"}},{variant:"bordered",color:"secondary",class:{inputWrapper:"group-data-[focus=true]:border-secondary",label:"text-secondary"}},{variant:"bordered",color:"success",class:{inputWrapper:"group-data-[focus=true]:border-success",label:"text-success"}},{variant:"bordered",color:"warning",class:{inputWrapper:"group-data-[focus=true]:border-warning",label:"text-warning"}},{variant:"bordered",color:"danger",class:{inputWrapper:"group-data-[focus=true]:border-danger",label:"text-danger"}},{labelPlacement:"inside",color:"default",class:{label:"group-data-[filled-within=true]:text-default-600"}},{labelPlacement:"outside",color:"default",class:{label:"group-data-[filled-within=true]:text-foreground"}},{radius:"full",size:["sm"],class:{inputWrapper:"px-3"}},{radius:"full",size:"md",class:{inputWrapper:"px-4"}},{radius:"full",size:"lg",class:{inputWrapper:"px-5"}},{disableAnimation:!1,variant:["faded","bordered"],class:{inputWrapper:"transition-colors motion-reduce:transition-none"}},{disableAnimation:!1,variant:"underlined",class:{inputWrapper:"after:transition-width motion-reduce:after:transition-none"}},{variant:["flat","faded"],class:{inputWrapper:[...vM]}},{isInvalid:!0,variant:"flat",class:{inputWrapper:["!bg-danger-50","data-[hover=true]:!bg-danger-100","group-data-[focus=true]:!bg-danger-50"]}},{isInvalid:!0,variant:"bordered",class:{inputWrapper:"!border-danger group-data-[focus=true]:!border-danger"}},{isInvalid:!0,variant:"underlined",class:{inputWrapper:"after:!bg-danger"}},{labelPlacement:"inside",size:"sm",class:{inputWrapper:"h-12 py-1.5 px-3"}},{labelPlacement:"inside",size:"md",class:{inputWrapper:"h-14 py-2"}},{labelPlacement:"inside",size:"lg",class:{label:"text-small",inputWrapper:"h-16 py-2.5 gap-0"}},{labelPlacement:"inside",size:"sm",variant:["bordered","faded"],class:{inputWrapper:"py-1"}},{labelPlacement:["inside","outside"],class:{label:["group-data-[filled-within=true]:pointer-events-auto"]}},{labelPlacement:["outside","outside-left"],class:{input:"h-full"}},{labelPlacement:"outside",isMultiline:!1,class:{base:"group relative justify-end",label:["pb-0","z-20","top-1/2","-translate-y-1/2","group-data-[filled-within=true]:left-0"]}},{labelPlacement:["inside"],class:{label:["group-data-[filled-within=true]:scale-85"]}},{labelPlacement:["inside"],variant:"flat",class:{innerWrapper:"pb-0.5"}},{variant:"underlined",size:"sm",class:{innerWrapper:"pb-1"}},{variant:"underlined",size:["md","lg"],class:{innerWrapper:"pb-1.5"}},{labelPlacement:"inside",size:["sm","md"],class:{label:"text-small"}},{labelPlacement:"inside",isMultiline:!1,size:"sm",class:{label:["group-data-[filled-within=true]:-translate-y-[calc(50%_+_theme(fontSize.tiny)/2_-_8px)]"]}},{labelPlacement:"inside",isMultiline:!1,size:"md",class:{label:["group-data-[filled-within=true]:-translate-y-[calc(50%_+_theme(fontSize.small)/2_-_6px)]"]}},{labelPlacement:"inside",isMultiline:!1,size:"lg",class:{label:["text-medium","group-data-[filled-within=true]:-translate-y-[calc(50%_+_theme(fontSize.small)/2_-_8px)]"]}},{labelPlacement:"inside",variant:["faded","bordered"],isMultiline:!1,size:"sm",class:{label:["group-data-[filled-within=true]:-translate-y-[calc(50%_+_theme(fontSize.tiny)/2_-_8px_-_theme(borderWidth.medium))]"]}},{labelPlacement:"inside",variant:["faded","bordered"],isMultiline:!1,size:"md",class:{label:["group-data-[filled-within=true]:-translate-y-[calc(50%_+_theme(fontSize.small)/2_-_6px_-_theme(borderWidth.medium))]"]}},{labelPlacement:"inside",variant:["faded","bordered"],isMultiline:!1,size:"lg",class:{label:["text-medium","group-data-[filled-within=true]:-translate-y-[calc(50%_+_theme(fontSize.small)/2_-_8px_-_theme(borderWidth.medium))]"]}},{labelPlacement:"inside",variant:"underlined",isMultiline:!1,size:"sm",class:{label:["group-data-[filled-within=true]:-translate-y-[calc(50%_+_theme(fontSize.tiny)/2_-_5px)]"]}},{labelPlacement:"inside",variant:"underlined",isMultiline:!1,size:"md",class:{label:["group-data-[filled-within=true]:-translate-y-[calc(50%_+_theme(fontSize.small)/2_-_3.5px)]"]}},{labelPlacement:"inside",variant:"underlined",size:"lg",isMultiline:!1,class:{label:["text-medium","group-data-[filled-within=true]:-translate-y-[calc(50%_+_theme(fontSize.small)/2_-_4px)]"]}},{labelPlacement:"outside",size:"sm",isMultiline:!1,class:{label:["left-2","text-tiny","group-data-[filled-within=true]:-translate-y-[calc(100%_+_theme(fontSize.tiny)/2_+_16px)]"],base:"data-[has-label=true]:mt-[calc(theme(fontSize.small)_+_8px)]"}},{labelPlacement:"outside",size:"md",isMultiline:!1,class:{label:["left-3","rtl:left-auto","rtl:right-3","text-small","group-data-[filled-within=true]:-translate-y-[calc(100%_+_theme(fontSize.small)/2_+_20px)]"],base:"data-[has-label=true]:mt-[calc(theme(fontSize.small)_+_10px)]"}},{labelPlacement:"outside",size:"lg",isMultiline:!1,class:{label:["left-3","rtl:left-auto","rtl:right-3","text-medium","group-data-[filled-within=true]:-translate-y-[calc(100%_+_theme(fontSize.small)/2_+_24px)]"],base:"data-[has-label=true]:mt-[calc(theme(fontSize.small)_+_12px)]"}},{labelPlacement:"outside-left",size:"sm",class:{label:"group-data-[has-helper=true]:pt-2"}},{labelPlacement:"outside-left",size:"md",class:{label:"group-data-[has-helper=true]:pt-3"}},{labelPlacement:"outside-left",size:"lg",class:{label:"group-data-[has-helper=true]:pt-4"}},{labelPlacement:["outside","outside-left"],isMultiline:!0,class:{inputWrapper:"py-2"}},{labelPlacement:"outside",isMultiline:!0,class:{label:"pb-1.5"}},{labelPlacement:"inside",isMultiline:!0,class:{label:"pb-0.5",input:"pt-0"}},{isMultiline:!0,disableAnimation:!1,class:{input:"transition-height !duration-100 motion-reduce:transition-none"}},{labelPlacement:["inside","outside"],class:{label:["pe-2","max-w-full","text-ellipsis","overflow-hidden"]}},{isMultiline:!0,radius:"full",class:{inputWrapper:"data-[has-multiple-rows=true]:rounded-large"}}]}),Qme=$u({base:["z-0","group","relative","inline-flex","items-center","justify-center","box-border","appearance-none","outline-none","select-none","whitespace-nowrap","min-w-max","font-normal","subpixel-antialiased","overflow-hidden","tap-highlight-transparent","data-[pressed=true]:scale-[0.97]",...gC],variants:{variant:{solid:"",bordered:"border-medium bg-transparent",light:"bg-transparent",flat:"",faded:"border-medium",shadow:"",ghost:"border-medium bg-transparent"},size:{sm:"px-3 min-w-16 h-8 text-tiny gap-2 rounded-small",md:"px-4 min-w-20 h-10 text-small gap-2 rounded-medium",lg:"px-6 min-w-24 h-12 text-medium gap-3 rounded-large"},color:{default:"",primary:"",secondary:"",success:"",warning:"",danger:""},radius:{none:"rounded-none",sm:"rounded-small",md:"rounded-medium",lg:"rounded-large",full:"rounded-full"},fullWidth:{true:"w-full"},isDisabled:{true:"opacity-disabled pointer-events-none"},isInGroup:{true:"[&:not(:first-child):not(:last-child)]:rounded-none"},isIconOnly:{true:"px-0 !gap-0",false:"[&>svg]:max-w-[theme(spacing.8)]"},disableAnimation:{true:"!transition-none",false:"transition-transform-colors-opacity motion-reduce:transition-none"}},defaultVariants:{size:"md",variant:"solid",color:"default",fullWidth:!1,isDisabled:!1,isInGroup:!1},compoundVariants:[{variant:"solid",color:"default",class:Ie.solid.default},{variant:"solid",color:"primary",class:Ie.solid.primary},{variant:"solid",color:"secondary",class:Ie.solid.secondary},{variant:"solid",color:"success",class:Ie.solid.success},{variant:"solid",color:"warning",class:Ie.solid.warning},{variant:"solid",color:"danger",class:Ie.solid.danger},{variant:"shadow",color:"default",class:Ie.shadow.default},{variant:"shadow",color:"primary",class:Ie.shadow.primary},{variant:"shadow",color:"secondary",class:Ie.shadow.secondary},{variant:"shadow",color:"success",class:Ie.shadow.success},{variant:"shadow",color:"warning",class:Ie.shadow.warning},{variant:"shadow",color:"danger",class:Ie.shadow.danger},{variant:"bordered",color:"default",class:Ie.bordered.default},{variant:"bordered",color:"primary",class:Ie.bordered.primary},{variant:"bordered",color:"secondary",class:Ie.bordered.secondary},{variant:"bordered",color:"success",class:Ie.bordered.success},{variant:"bordered",color:"warning",class:Ie.bordered.warning},{variant:"bordered",color:"danger",class:Ie.bordered.danger},{variant:"flat",color:"default",class:Ie.flat.default},{variant:"flat",color:"primary",class:Ie.flat.primary},{variant:"flat",color:"secondary",class:Ie.flat.secondary},{variant:"flat",color:"success",class:Ie.flat.success},{variant:"flat",color:"warning",class:Ie.flat.warning},{variant:"flat",color:"danger",class:Ie.flat.danger},{variant:"faded",color:"default",class:Ie.faded.default},{variant:"faded",color:"primary",class:Ie.faded.primary},{variant:"faded",color:"secondary",class:Ie.faded.secondary},{variant:"faded",color:"success",class:Ie.faded.success},{variant:"faded",color:"warning",class:Ie.faded.warning},{variant:"faded",color:"danger",class:Ie.faded.danger},{variant:"light",color:"default",class:[Ie.light.default,"data-[hover=true]:bg-default/40"]},{variant:"light",color:"primary",class:[Ie.light.primary,"data-[hover=true]:bg-primary/20"]},{variant:"light",color:"secondary",class:[Ie.light.secondary,"data-[hover=true]:bg-secondary/20"]},{variant:"light",color:"success",class:[Ie.light.success,"data-[hover=true]:bg-success/20"]},{variant:"light",color:"warning",class:[Ie.light.warning,"data-[hover=true]:bg-warning/20"]},{variant:"light",color:"danger",class:[Ie.light.danger,"data-[hover=true]:bg-danger/20"]},{variant:"ghost",color:"default",class:Ie.ghost.default},{variant:"ghost",color:"primary",class:Ie.ghost.primary},{variant:"ghost",color:"secondary",class:Ie.ghost.secondary},{variant:"ghost",color:"success",class:Ie.ghost.success},{variant:"ghost",color:"warning",class:Ie.ghost.warning},{variant:"ghost",color:"danger",class:Ie.ghost.danger},{isInGroup:!0,class:"rounded-none first:rounded-s-medium last:rounded-e-medium"},{isInGroup:!0,size:"sm",class:"rounded-none first:rounded-s-small last:rounded-e-small"},{isInGroup:!0,size:"md",class:"rounded-none first:rounded-s-medium last:rounded-e-medium"},{isInGroup:!0,size:"lg",class:"rounded-none first:rounded-s-large last:rounded-e-large"},{isInGroup:!0,isRounded:!0,class:"rounded-none first:rounded-s-full last:rounded-e-full"},{isInGroup:!0,radius:"none",class:"rounded-none first:rounded-s-none last:rounded-e-none"},{isInGroup:!0,radius:"sm",class:"rounded-none first:rounded-s-small last:rounded-e-small"},{isInGroup:!0,radius:"md",class:"rounded-none first:rounded-s-medium last:rounded-e-medium"},{isInGroup:!0,radius:"lg",class:"rounded-none first:rounded-s-large last:rounded-e-large"},{isInGroup:!0,radius:"full",class:"rounded-none first:rounded-s-full last:rounded-e-full"},{isInGroup:!0,variant:["ghost","bordered"],color:"default",className:qa.default},{isInGroup:!0,variant:["ghost","bordered"],color:"primary",className:qa.primary},{isInGroup:!0,variant:["ghost","bordered"],color:"secondary",className:qa.secondary},{isInGroup:!0,variant:["ghost","bordered"],color:"success",className:qa.success},{isInGroup:!0,variant:["ghost","bordered"],color:"warning",className:qa.warning},{isInGroup:!0,variant:["ghost","bordered"],color:"danger",className:qa.danger},{isIconOnly:!0,size:"sm",class:"min-w-8 w-8 h-8"},{isIconOnly:!0,size:"md",class:"min-w-10 w-10 h-10"},{isIconOnly:!0,size:"lg",class:"min-w-12 w-12 h-12"},{variant:["solid","faded","flat","bordered","shadow"],class:"data-[hover=true]:opacity-hover"}]});$u({base:"inline-flex items-center justify-center h-auto",variants:{fullWidth:{true:"w-full"}},defaultVariants:{fullWidth:!1}});let Zme=class{isDefaultPrevented(){return this.nativeEvent.defaultPrevented}preventDefault(){this.defaultPrevented=!0,this.nativeEvent.preventDefault()}stopPropagation(){this.nativeEvent.stopPropagation(),this.isPropagationStopped=()=>!0}isPropagationStopped(){return!1}persist(){}constructor(e,n){this.nativeEvent=n,this.target=n.target,this.currentTarget=n.currentTarget,this.relatedTarget=n.relatedTarget,this.bubbles=n.bubbles,this.cancelable=n.cancelable,this.defaultPrevented=n.defaultPrevented,this.eventPhase=n.eventPhase,this.isTrusted=n.isTrusted,this.timeStamp=n.timeStamp,this.type=e}};function bM(t){let e=A.useRef({isFocused:!1,observer:null});bt(()=>{const r=e.current;return()=>{r.observer&&(r.observer.disconnect(),r.observer=null)}},[]);let n=kt(r=>{t==null||t(r)});return A.useCallback(r=>{if(r.target instanceof HTMLButtonElement||r.target instanceof HTMLInputElement||r.target instanceof HTMLTextAreaElement||r.target instanceof HTMLSelectElement){e.current.isFocused=!0;let s=r.target,o=i=>{e.current.isFocused=!1,s.disabled&&n(new Zme("blur",i)),e.current.observer&&(e.current.observer.disconnect(),e.current.observer=null)};s.addEventListener("focusout",o,{once:!0}),e.current.observer=new MutationObserver(()=>{if(e.current.isFocused&&s.disabled){var i;(i=e.current.observer)===null||i===void 0||i.disconnect();let a=s===document.activeElement?null:document.activeElement;s.dispatchEvent(new FocusEvent("blur",{relatedTarget:a})),s.dispatchEvent(new FocusEvent("focusout",{bubbles:!0,relatedTarget:a}))}}),e.current.observer.observe(s,{attributes:!0,attributeFilter:["disabled"]})}},[n])}function xM(t){let{isDisabled:e,onFocus:n,onBlur:r,onFocusChange:s}=t;const o=A.useCallback(l=>{if(l.target===l.currentTarget)return r&&r(l),s&&s(!1),!0},[r,s]),i=bM(o),a=A.useCallback(l=>{const u=ve(l.target);l.target===l.currentTarget&&u.activeElement===l.target&&(n&&n(l),s&&s(!0),i(l))},[s,n,i]);return{focusProps:{onFocus:!e&&(n||s||r)?a:void 0,onBlur:!e&&(r||s)?o:void 0}}}let Cu=null,Wx=new Set,xc=new Map,va=!1,Ux=!1;const Jme={Tab:!0,Escape:!0};function vC(t,e){for(let n of Wx)n(t,e)}function ege(t){return!(t.metaKey||!Qr()&&t.altKey||t.ctrlKey||t.key==="Control"||t.key==="Shift"||t.key==="Meta")}function mm(t){va=!0,ege(t)&&(Cu="keyboard",vC("keyboard",t))}function Fr(t){Cu="pointer",(t.type==="mousedown"||t.type==="pointerdown")&&(va=!0,vC("pointer",t))}function yM(t){$s(t)&&(va=!0,Cu="virtual")}function wM(t){t.target===window||t.target===document||(!va&&!Ux&&(Cu="virtual",vC("virtual",t)),va=!1,Ux=!1)}function $M(){va=!1,Ux=!0}function Gx(t){if(typeof window>"u"||xc.get(je(t)))return;const e=je(t),n=ve(t);let r=e.HTMLElement.prototype.focus;e.HTMLElement.prototype.focus=function(){va=!0,r.apply(this,arguments)},n.addEventListener("keydown",mm,!0),n.addEventListener("keyup",mm,!0),n.addEventListener("click",yM,!0),e.addEventListener("focus",wM,!0),e.addEventListener("blur",$M,!1),typeof PointerEvent<"u"?(n.addEventListener("pointerdown",Fr,!0),n.addEventListener("pointermove",Fr,!0),n.addEventListener("pointerup",Fr,!0)):(n.addEventListener("mousedown",Fr,!0),n.addEventListener("mousemove",Fr,!0),n.addEventListener("mouseup",Fr,!0)),e.addEventListener("beforeunload",()=>{CM(t)},{once:!0}),xc.set(e,{focus:r})}const CM=(t,e)=>{const n=je(t),r=ve(t);e&&r.removeEventListener("DOMContentLoaded",e),xc.has(n)&&(n.HTMLElement.prototype.focus=xc.get(n).focus,r.removeEventListener("keydown",mm,!0),r.removeEventListener("keyup",mm,!0),r.removeEventListener("click",yM,!0),n.removeEventListener("focus",wM,!0),n.removeEventListener("blur",$M,!1),typeof PointerEvent<"u"?(r.removeEventListener("pointerdown",Fr,!0),r.removeEventListener("pointermove",Fr,!0),r.removeEventListener("pointerup",Fr,!0)):(r.removeEventListener("mousedown",Fr,!0),r.removeEventListener("mousemove",Fr,!0),r.removeEventListener("mouseup",Fr,!0)),xc.delete(n))};function tge(t){const e=ve(t);let n;return e.readyState!=="loading"?Gx(t):(n=()=>{Gx(t)},e.addEventListener("DOMContentLoaded",n)),()=>CM(t,n)}typeof document<"u"&&tge();function kM(){return Cu!=="pointer"}function nge(){return Cu}const rge=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function sge(t,e,n){var r;const s=typeof window<"u"?je(n==null?void 0:n.target).HTMLInputElement:HTMLInputElement,o=typeof window<"u"?je(n==null?void 0:n.target).HTMLTextAreaElement:HTMLTextAreaElement,i=typeof window<"u"?je(n==null?void 0:n.target).HTMLElement:HTMLElement,a=typeof window<"u"?je(n==null?void 0:n.target).KeyboardEvent:KeyboardEvent;return t=t||(n==null?void 0:n.target)instanceof s&&!rge.has(n==null||(r=n.target)===null||r===void 0?void 0:r.type)||(n==null?void 0:n.target)instanceof o||(n==null?void 0:n.target)instanceof i&&(n==null?void 0:n.target.isContentEditable),!(t&&e==="keyboard"&&n instanceof a&&!Jme[n.key])}function oge(t,e,n){Gx(),A.useEffect(()=>{let r=(s,o)=>{sge(!!(n!=null&&n.isTextInput),s,o)&&t(kM())};return Wx.add(r),()=>{Wx.delete(r)}},e)}function ige(t){let{isDisabled:e,onBlurWithin:n,onFocusWithin:r,onFocusWithinChange:s}=t,o=A.useRef({isFocusWithin:!1}),i=A.useCallback(u=>{o.current.isFocusWithin&&!u.currentTarget.contains(u.relatedTarget)&&(o.current.isFocusWithin=!1,n&&n(u),s&&s(!1))},[n,s,o]),a=bM(i),l=A.useCallback(u=>{!o.current.isFocusWithin&&document.activeElement===u.target&&(r&&r(u),s&&s(!0),o.current.isFocusWithin=!0,a(u))},[r,s,a]);return e?{focusWithinProps:{onFocus:void 0,onBlur:void 0}}:{focusWithinProps:{onFocus:l,onBlur:i}}}function b2(t){if(!t)return;let e=!0;return n=>{let r={...n,preventDefault(){n.preventDefault()},isDefaultPrevented(){return n.isDefaultPrevented()},stopPropagation(){console.error("stopPropagation is now the default behavior for events in React Spectrum. You can use continuePropagation() to revert this behavior.")},continuePropagation(){e=!1}};t(r),e&&n.stopPropagation()}}function age(t){return{keyboardProps:t.isDisabled?{}:{onKeyDown:b2(t.onKeyDown),onKeyUp:b2(t.onKeyUp)}}}function lge(t){const e=ve(t);if(nge()==="virtual"){let n=e.activeElement;_a(()=>{e.activeElement===n&&t.isConnected&&nn(t)})}else nn(t)}function uge(t,e){return!t||!e?!1:e.some(n=>n.contains(t))}class bC{get size(){return this.fastMap.size}getTreeNode(e){return this.fastMap.get(e)}addTreeNode(e,n,r){let s=this.fastMap.get(n??null);if(!s)return;let o=new x2({scopeRef:e});s.addChild(o),o.parent=s,this.fastMap.set(e,o),r&&(o.nodeToRestore=r)}addNode(e){this.fastMap.set(e.scopeRef,e)}removeTreeNode(e){if(e===null)return;let n=this.fastMap.get(e);if(!n)return;let r=n.parent;for(let o of this.traverse())o!==n&&n.nodeToRestore&&o.nodeToRestore&&n.scopeRef&&n.scopeRef.current&&uge(o.nodeToRestore,n.scopeRef.current)&&(o.nodeToRestore=n.nodeToRestore);let s=n.children;r&&(r.removeChild(n),s.size>0&&s.forEach(o=>r&&r.addChild(o))),this.fastMap.delete(n.scopeRef)}*traverse(e=this.root){if(e.scopeRef!=null&&(yield e),e.children.size>0)for(let n of e.children)yield*this.traverse(n)}clone(){var e;let n=new bC;var r;for(let s of this.traverse())n.addTreeNode(s.scopeRef,(r=(e=s.parent)===null||e===void 0?void 0:e.scopeRef)!==null&&r!==void 0?r:null,s.nodeToRestore);return n}constructor(){this.fastMap=new Map,this.root=new x2({scopeRef:null}),this.fastMap.set(null,this.root)}}class x2{addChild(e){this.children.add(e),e.parent=this}removeChild(e){this.children.delete(e),e.parent=void 0}constructor(e){this.children=new Set,this.contain=!1,this.scopeRef=e.scopeRef}}new bC;function od(t={}){let{autoFocus:e=!1,isTextInput:n,within:r}=t,s=A.useRef({isFocused:!1,isFocusVisible:e||kM()}),[o,i]=A.useState(!1),[a,l]=A.useState(()=>s.current.isFocused&&s.current.isFocusVisible),u=A.useCallback(()=>l(s.current.isFocused&&s.current.isFocusVisible),[]),c=A.useCallback(h=>{s.current.isFocused=h,i(h),u()},[u]);oge(h=>{s.current.isFocusVisible=h,u()},[],{isTextInput:n});let{focusProps:d}=xM({isDisabled:r,onFocusChange:c}),{focusWithinProps:f}=ige({isDisabled:!r,onFocusWithinChange:c});return{isFocused:o,isFocusVisible:a,focusProps:r?f:d}}let cge=Ze.createContext(null);function dge(t){let e=A.useContext(cge)||{};Df(e,t);let{ref:n,...r}=e;return r}function fge(t,e){let{focusProps:n}=xM(t),{keyboardProps:r}=age(t),s=tt(n,r),o=dge(e),i=t.isDisabled?{}:o,a=A.useRef(t.autoFocus);return A.useEffect(()=>{a.current&&e.current&&lge(e.current),a.current=!1},[e]),{focusableProps:tt({...s,tabIndex:t.excludeFromTabOrder&&!t.isDisabled?-1:void 0},i)}}let vl="default",Hx="",Qh=new WeakMap;function y2(t){if(Rf()){if(vl==="default"){const e=ve(t);Hx=e.documentElement.style.webkitUserSelect,e.documentElement.style.webkitUserSelect="none"}vl="disabled"}else(t instanceof HTMLElement||t instanceof SVGElement)&&(Qh.set(t,t.style.userSelect),t.style.userSelect="none")}function Th(t){if(Rf()){if(vl!=="disabled")return;vl="restoring",setTimeout(()=>{_a(()=>{if(vl==="restoring"){const e=ve(t);e.documentElement.style.webkitUserSelect==="none"&&(e.documentElement.style.webkitUserSelect=Hx||""),Hx="",vl="default"}})},300)}else if((t instanceof HTMLElement||t instanceof SVGElement)&&t&&Qh.has(t)){let e=Qh.get(t);t.style.userSelect==="none"&&(t.style.userSelect=e),t.getAttribute("style")===""&&t.removeAttribute("style"),Qh.delete(t)}}const SM=Ze.createContext({register:()=>{}});SM.displayName="PressResponderContext";function hge(t){let e=A.useContext(SM);if(e){let{register:n,...r}=e;t=tt(r,t),n()}return Df(e,t.ref),t}var Eh=new WeakMap;let Nh=class{continuePropagation(){tm(this,Eh,!1)}get shouldStopPropagation(){return V3(this,Eh)}constructor(e,n,r){XO(this,Eh,{writable:!0,value:void 0}),tm(this,Eh,!0),this.type=e,this.pointerType=n,this.target=r.currentTarget,this.shiftKey=r.shiftKey,this.metaKey=r.metaKey,this.ctrlKey=r.ctrlKey,this.altKey=r.altKey}};const w2=Symbol("linkClicked");function xC(t){let{onPress:e,onPressChange:n,onPressStart:r,onPressEnd:s,onPressUp:o,isDisabled:i,isPressed:a,preventFocusOnPress:l,shouldCancelOnPointerExit:u,allowTextSelectionOnPress:c,ref:d,...f}=hge(t),[h,p]=A.useState(!1),g=A.useRef({isPressed:!1,ignoreEmulatedMouseEvents:!1,ignoreClickAfterPress:!1,didFirePressStart:!1,isTriggeringEvent:!1,activePointerId:null,target:null,isOverTarget:!1,pointerType:null}),{addGlobalListener:v,removeAllGlobalListeners:m}=ZO(),b=kt((w,I)=>{let N=g.current;if(i||N.didFirePressStart)return!1;let E=!0;if(N.isTriggeringEvent=!0,r){let R=new Nh("pressstart",I,w);r(R),E=R.shouldStopPropagation}return n&&n(!0),N.isTriggeringEvent=!1,N.didFirePressStart=!0,p(!0),E}),x=kt((w,I,N=!0)=>{let E=g.current;if(!E.didFirePressStart)return!1;E.ignoreClickAfterPress=!0,E.didFirePressStart=!1,E.isTriggeringEvent=!0;let R=!0;if(s){let S=new Nh("pressend",I,w);s(S),R=S.shouldStopPropagation}if(n&&n(!1),p(!1),e&&N&&!i){let S=new Nh("press",I,w);e(S),R&&(R=S.shouldStopPropagation)}return E.isTriggeringEvent=!1,R}),y=kt((w,I)=>{let N=g.current;if(i)return!1;if(o){N.isTriggeringEvent=!0;let E=new Nh("pressup",I,w);return o(E),N.isTriggeringEvent=!1,E.shouldStopPropagation}return!0}),$=kt(w=>{let I=g.current;I.isPressed&&I.target&&(I.isOverTarget&&I.pointerType!=null&&x(Qs(I.target,w),I.pointerType,!1),I.isPressed=!1,I.isOverTarget=!1,I.activePointerId=null,I.pointerType=null,m(),c||Th(I.target))}),C=kt(w=>{u&&$(w)}),k=A.useMemo(()=>{let w=g.current,I={onKeyDown(E){if(Av(E.nativeEvent,E.currentTarget)&&E.currentTarget.contains(E.target)){var R;C2(E.target,E.key)&&E.preventDefault();let S=!0;if(!w.isPressed&&!E.repeat){w.target=E.currentTarget,w.isPressed=!0,S=b(E,"keyboard");let T=E.currentTarget,F=L=>{Av(L,T)&&!L.repeat&&T.contains(L.target)&&w.target&&y(Qs(w.target,L),"keyboard")};v(ve(E.currentTarget),"keyup",ws(F,N),!0)}S&&E.stopPropagation(),E.metaKey&&Qr()&&((R=w.metaKeyEvents)===null||R===void 0||R.set(E.key,E.nativeEvent))}else E.key==="Meta"&&(w.metaKeyEvents=new Map)},onClick(E){if(!(E&&!E.currentTarget.contains(E.target))&&E&&E.button===0&&!w.isTriggeringEvent&&!ma.isOpening){let R=!0;if(i&&E.preventDefault(),!w.ignoreClickAfterPress&&!w.ignoreEmulatedMouseEvents&&!w.isPressed&&(w.pointerType==="virtual"||$s(E.nativeEvent))){!i&&!l&&nn(E.currentTarget);let S=b(E,"virtual"),T=y(E,"virtual"),F=x(E,"virtual");R=S&&T&&F}w.ignoreEmulatedMouseEvents=!1,w.ignoreClickAfterPress=!1,R&&E.stopPropagation()}}},N=E=>{var R;if(w.isPressed&&w.target&&Av(E,w.target)){var S;C2(E.target,E.key)&&E.preventDefault();let F=E.target;x(Qs(w.target,E),"keyboard",w.target.contains(F)),m(),E.key!=="Enter"&&yC(w.target)&&w.target.contains(F)&&!E[w2]&&(E[w2]=!0,ma(w.target,E,!1)),w.isPressed=!1,(S=w.metaKeyEvents)===null||S===void 0||S.delete(E.key)}else if(E.key==="Meta"&&(!((R=w.metaKeyEvents)===null||R===void 0)&&R.size)){var T;let F=w.metaKeyEvents;w.metaKeyEvents=void 0;for(let L of F.values())(T=w.target)===null||T===void 0||T.dispatchEvent(new KeyboardEvent("keyup",L))}};if(typeof PointerEvent<"u"){I.onPointerDown=T=>{if(T.button!==0||!T.currentTarget.contains(T.target))return;if(t3(T.nativeEvent)){w.pointerType="virtual";return}Fv(T.currentTarget)&&T.preventDefault(),w.pointerType=T.pointerType;let F=!0;w.isPressed||(w.isPressed=!0,w.isOverTarget=!0,w.activePointerId=T.pointerId,w.target=T.currentTarget,!i&&!l&&nn(T.currentTarget),c||y2(w.target),F=b(T,w.pointerType),v(ve(T.currentTarget),"pointermove",E,!1),v(ve(T.currentTarget),"pointerup",R,!1),v(ve(T.currentTarget),"pointercancel",S,!1)),F&&T.stopPropagation()},I.onMouseDown=T=>{T.currentTarget.contains(T.target)&&T.button===0&&(Fv(T.currentTarget)&&T.preventDefault(),T.stopPropagation())},I.onPointerUp=T=>{!T.currentTarget.contains(T.target)||w.pointerType==="virtual"||T.button===0&&Ya(T,T.currentTarget)&&y(T,w.pointerType||T.pointerType)};let E=T=>{T.pointerId===w.activePointerId&&(w.target&&Ya(T,w.target)?!w.isOverTarget&&w.pointerType!=null&&(w.isOverTarget=!0,b(Qs(w.target,T),w.pointerType)):w.target&&w.isOverTarget&&w.pointerType!=null&&(w.isOverTarget=!1,x(Qs(w.target,T),w.pointerType,!1),C(T)))},R=T=>{T.pointerId===w.activePointerId&&w.isPressed&&T.button===0&&w.target&&(Ya(T,w.target)&&w.pointerType!=null?x(Qs(w.target,T),w.pointerType):w.isOverTarget&&w.pointerType!=null&&x(Qs(w.target,T),w.pointerType,!1),w.isPressed=!1,w.isOverTarget=!1,w.activePointerId=null,w.pointerType=null,m(),c||Th(w.target))},S=T=>{$(T)};I.onDragStart=T=>{T.currentTarget.contains(T.target)&&$(T)}}else{I.onMouseDown=S=>{if(S.button!==0||!S.currentTarget.contains(S.target))return;if(Fv(S.currentTarget)&&S.preventDefault(),w.ignoreEmulatedMouseEvents){S.stopPropagation();return}w.isPressed=!0,w.isOverTarget=!0,w.target=S.currentTarget,w.pointerType=$s(S.nativeEvent)?"virtual":"mouse",!i&&!l&&nn(S.currentTarget),b(S,w.pointerType)&&S.stopPropagation(),v(ve(S.currentTarget),"mouseup",E,!1)},I.onMouseEnter=S=>{if(!S.currentTarget.contains(S.target))return;let T=!0;w.isPressed&&!w.ignoreEmulatedMouseEvents&&w.pointerType!=null&&(w.isOverTarget=!0,T=b(S,w.pointerType)),T&&S.stopPropagation()},I.onMouseLeave=S=>{if(!S.currentTarget.contains(S.target))return;let T=!0;w.isPressed&&!w.ignoreEmulatedMouseEvents&&w.pointerType!=null&&(w.isOverTarget=!1,T=x(S,w.pointerType,!1),C(S)),T&&S.stopPropagation()},I.onMouseUp=S=>{S.currentTarget.contains(S.target)&&!w.ignoreEmulatedMouseEvents&&S.button===0&&y(S,w.pointerType||"mouse")};let E=S=>{if(S.button===0){if(w.isPressed=!1,m(),w.ignoreEmulatedMouseEvents){w.ignoreEmulatedMouseEvents=!1;return}w.target&&Ya(S,w.target)&&w.pointerType!=null?x(Qs(w.target,S),w.pointerType):w.target&&w.isOverTarget&&w.pointerType!=null&&x(Qs(w.target,S),w.pointerType,!1),w.isOverTarget=!1}};I.onTouchStart=S=>{if(!S.currentTarget.contains(S.target))return;let T=pge(S.nativeEvent);if(!T)return;w.activePointerId=T.identifier,w.ignoreEmulatedMouseEvents=!0,w.isOverTarget=!0,w.isPressed=!0,w.target=S.currentTarget,w.pointerType="touch",!i&&!l&&nn(S.currentTarget),c||y2(w.target),b(S,w.pointerType)&&S.stopPropagation(),v(je(S.currentTarget),"scroll",R,!0)},I.onTouchMove=S=>{if(!S.currentTarget.contains(S.target))return;if(!w.isPressed){S.stopPropagation();return}let T=$2(S.nativeEvent,w.activePointerId),F=!0;T&&Ya(T,S.currentTarget)?!w.isOverTarget&&w.pointerType!=null&&(w.isOverTarget=!0,F=b(S,w.pointerType)):w.isOverTarget&&w.pointerType!=null&&(w.isOverTarget=!1,F=x(S,w.pointerType,!1),C(S)),F&&S.stopPropagation()},I.onTouchEnd=S=>{if(!S.currentTarget.contains(S.target))return;if(!w.isPressed){S.stopPropagation();return}let T=$2(S.nativeEvent,w.activePointerId),F=!0;T&&Ya(T,S.currentTarget)&&w.pointerType!=null?(y(S,w.pointerType),F=x(S,w.pointerType)):w.isOverTarget&&w.pointerType!=null&&(F=x(S,w.pointerType,!1)),F&&S.stopPropagation(),w.isPressed=!1,w.activePointerId=null,w.isOverTarget=!1,w.ignoreEmulatedMouseEvents=!0,w.target&&!c&&Th(w.target),m()},I.onTouchCancel=S=>{S.currentTarget.contains(S.target)&&(S.stopPropagation(),w.isPressed&&$(S))};let R=S=>{w.isPressed&&S.target.contains(w.target)&&$({currentTarget:w.target,shiftKey:!1,ctrlKey:!1,metaKey:!1,altKey:!1})};I.onDragStart=S=>{S.currentTarget.contains(S.target)&&$(S)}}return I},[v,i,l,m,c,$,C,x,b,y]);return A.useEffect(()=>()=>{var w;c||Th((w=g.current.target)!==null&&w!==void 0?w:void 0)},[c]),{isPressed:a||h,pressProps:tt(f,k)}}function yC(t){return t.tagName==="A"&&t.hasAttribute("href")}function Av(t,e){const{key:n,code:r}=t,s=e,o=s.getAttribute("role");return(n==="Enter"||n===" "||n==="Spacebar"||r==="Space")&&!(s instanceof je(s).HTMLInputElement&&!IM(s,n)||s instanceof je(s).HTMLTextAreaElement||s.isContentEditable)&&!((o==="link"||!o&&yC(s))&&n!=="Enter")}function pge(t){const{targetTouches:e}=t;return e.length>0?e[0]:null}function $2(t,e){const n=t.changedTouches;for(let r=0;r<n.length;r++){const s=n[r];if(s.identifier===e)return s}return null}function Qs(t,e){return{currentTarget:t,shiftKey:e.shiftKey,ctrlKey:e.ctrlKey,metaKey:e.metaKey,altKey:e.altKey}}function mge(t){let e=0,n=0;return t.width!==void 0?e=t.width/2:t.radiusX!==void 0&&(e=t.radiusX),t.height!==void 0?n=t.height/2:t.radiusY!==void 0&&(n=t.radiusY),{top:t.clientY-n,right:t.clientX+e,bottom:t.clientY+n,left:t.clientX-e}}function gge(t,e){return!(t.left>e.right||e.left>t.right||t.top>e.bottom||e.top>t.bottom)}function Ya(t,e){let n=e.getBoundingClientRect(),r=mge(t);return gge(n,r)}function Fv(t){return!(t instanceof HTMLElement)||!t.hasAttribute("draggable")}function C2(t,e){return t instanceof HTMLInputElement?!IM(t,e):t instanceof HTMLButtonElement?t.type!=="submit"&&t.type!=="reset":!yC(t)}const vge=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function IM(t,e){return t.type==="checkbox"||t.type==="radio"?e===" ":vge.has(t.type)}let bge=class{isDefaultPrevented(){return this.nativeEvent.defaultPrevented}preventDefault(){this.defaultPrevented=!0,this.nativeEvent.preventDefault()}stopPropagation(){this.nativeEvent.stopPropagation(),this.isPropagationStopped=()=>!0}isPropagationStopped(){return!1}persist(){}constructor(e,n){this.nativeEvent=n,this.target=n.target,this.currentTarget=n.currentTarget,this.relatedTarget=n.relatedTarget,this.bubbles=n.bubbles,this.cancelable=n.cancelable,this.defaultPrevented=n.defaultPrevented,this.eventPhase=n.eventPhase,this.isTrusted=n.isTrusted,this.timeStamp=n.timeStamp,this.type=e}};function xge(t){let e=A.useRef({isFocused:!1,observer:null});bt(()=>{const r=e.current;return()=>{r.observer&&(r.observer.disconnect(),r.observer=null)}},[]);let n=kt(r=>{t==null||t(r)});return A.useCallback(r=>{if(r.target instanceof HTMLButtonElement||r.target instanceof HTMLInputElement||r.target instanceof HTMLTextAreaElement||r.target instanceof HTMLSelectElement){e.current.isFocused=!0;let s=r.target,o=i=>{e.current.isFocused=!1,s.disabled&&n(new bge("blur",i)),e.current.observer&&(e.current.observer.disconnect(),e.current.observer=null)};s.addEventListener("focusout",o,{once:!0}),e.current.observer=new MutationObserver(()=>{if(e.current.isFocused&&s.disabled){var i;(i=e.current.observer)===null||i===void 0||i.disconnect();let a=s===document.activeElement?null:document.activeElement;s.dispatchEvent(new FocusEvent("blur",{relatedTarget:a})),s.dispatchEvent(new FocusEvent("focusout",{bubbles:!0,relatedTarget:a}))}}),e.current.observer.observe(s,{attributes:!0,attributeFilter:["disabled"]})}},[n])}let yge=new Set,yc=new Map,ba=!1,jx=!1;function wC(t,e){for(let n of yge)n(t,e)}function wge(t){return!(t.metaKey||!Qr()&&t.altKey||t.ctrlKey||t.key==="Control"||t.key==="Shift"||t.key==="Meta")}function gm(t){ba=!0,wge(t)&&wC("keyboard",t)}function Pr(t){(t.type==="mousedown"||t.type==="pointerdown")&&(ba=!0,wC("pointer",t))}function TM(t){$s(t)&&(ba=!0)}function EM(t){t.target===window||t.target===document||(!ba&&!jx&&wC("virtual",t),ba=!1,jx=!1)}function NM(){ba=!1,jx=!0}function k2(t){if(typeof window>"u"||yc.get(je(t)))return;const e=je(t),n=ve(t);let r=e.HTMLElement.prototype.focus;e.HTMLElement.prototype.focus=function(){ba=!0,r.apply(this,arguments)},n.addEventListener("keydown",gm,!0),n.addEventListener("keyup",gm,!0),n.addEventListener("click",TM,!0),e.addEventListener("focus",EM,!0),e.addEventListener("blur",NM,!1),typeof PointerEvent<"u"?(n.addEventListener("pointerdown",Pr,!0),n.addEventListener("pointermove",Pr,!0),n.addEventListener("pointerup",Pr,!0)):(n.addEventListener("mousedown",Pr,!0),n.addEventListener("mousemove",Pr,!0),n.addEventListener("mouseup",Pr,!0)),e.addEventListener("beforeunload",()=>{RM(t)},{once:!0}),yc.set(e,{focus:r})}const RM=(t,e)=>{const n=je(t),r=ve(t);e&&r.removeEventListener("DOMContentLoaded",e),yc.has(n)&&(n.HTMLElement.prototype.focus=yc.get(n).focus,r.removeEventListener("keydown",gm,!0),r.removeEventListener("keyup",gm,!0),r.removeEventListener("click",TM,!0),n.removeEventListener("focus",EM,!0),n.removeEventListener("blur",NM,!1),typeof PointerEvent<"u"?(r.removeEventListener("pointerdown",Pr,!0),r.removeEventListener("pointermove",Pr,!0),r.removeEventListener("pointerup",Pr,!0)):(r.removeEventListener("mousedown",Pr,!0),r.removeEventListener("mousemove",Pr,!0),r.removeEventListener("mouseup",Pr,!0)),yc.delete(n))};function $ge(t){const e=ve(t);let n;return e.readyState!=="loading"?k2(t):(n=()=>{k2(t)},e.addEventListener("DOMContentLoaded",n)),()=>RM(t,n)}typeof document<"u"&&$ge();function Cge(t){let{isDisabled:e,onBlurWithin:n,onFocusWithin:r,onFocusWithinChange:s}=t,o=A.useRef({isFocusWithin:!1}),i=A.useCallback(u=>{o.current.isFocusWithin&&!u.currentTarget.contains(u.relatedTarget)&&(o.current.isFocusWithin=!1,n&&n(u),s&&s(!1))},[n,s,o]),a=xge(i),l=A.useCallback(u=>{!o.current.isFocusWithin&&document.activeElement===u.target&&(r&&r(u),s&&s(!0),o.current.isFocusWithin=!0,a(u))},[r,s,a]);return e?{focusWithinProps:{onFocus:void 0,onBlur:void 0}}:{focusWithinProps:{onFocus:l,onBlur:i}}}let vm=!1,Pv=0;function Kx(){vm=!0,setTimeout(()=>{vm=!1},50)}function S2(t){t.pointerType==="touch"&&Kx()}function kge(){if(!(typeof document>"u"))return typeof PointerEvent<"u"?document.addEventListener("pointerup",S2):document.addEventListener("touchend",Kx),Pv++,()=>{Pv--,!(Pv>0)&&(typeof PointerEvent<"u"?document.removeEventListener("pointerup",S2):document.removeEventListener("touchend",Kx))}}function $C(t){let{onHoverStart:e,onHoverChange:n,onHoverEnd:r,isDisabled:s}=t,[o,i]=A.useState(!1),a=A.useRef({isHovered:!1,ignoreEmulatedMouseEvents:!1,pointerType:"",target:null}).current;A.useEffect(kge,[]);let{hoverProps:l,triggerHoverEnd:u}=A.useMemo(()=>{let c=(h,p)=>{if(a.pointerType=p,s||p==="touch"||a.isHovered||!h.currentTarget.contains(h.target))return;a.isHovered=!0;let g=h.currentTarget;a.target=g,e&&e({type:"hoverstart",target:g,pointerType:p}),n&&n(!0),i(!0)},d=(h,p)=>{if(a.pointerType="",a.target=null,p==="touch"||!a.isHovered)return;a.isHovered=!1;let g=h.currentTarget;r&&r({type:"hoverend",target:g,pointerType:p}),n&&n(!1),i(!1)},f={};return typeof PointerEvent<"u"?(f.onPointerEnter=h=>{vm&&h.pointerType==="mouse"||c(h,h.pointerType)},f.onPointerLeave=h=>{!s&&h.currentTarget.contains(h.target)&&d(h,h.pointerType)}):(f.onTouchStart=()=>{a.ignoreEmulatedMouseEvents=!0},f.onMouseEnter=h=>{!a.ignoreEmulatedMouseEvents&&!vm&&c(h,"mouse"),a.ignoreEmulatedMouseEvents=!1},f.onMouseLeave=h=>{!s&&h.currentTarget.contains(h.target)&&d(h,"mouse")}),{hoverProps:f,triggerHoverEnd:d}},[e,n,r,s,a]);return A.useEffect(()=>{s&&u({currentTarget:a.target},a.pointerType)},[s]),{hoverProps:l,isHovered:o}}var Sge=t=>Y.jsx("svg",{"aria-hidden":"true",focusable:"false",height:"1em",role:"presentation",viewBox:"0 0 24 24",width:"1em",...t,children:Y.jsx("path",{d:"M12 2a10 10 0 1010 10A10.016 10.016 0 0012 2zm3.36 12.3a.754.754 0 010 1.06.748.748 0 01-1.06 0l-2.3-2.3-2.3 2.3a.748.748 0 01-1.06 0 .754.754 0 010-1.06l2.3-2.3-2.3-2.3A.75.75 0 019.7 8.64l2.3 2.3 2.3-2.3a.75.75 0 011.06 1.06l-2.3 2.3z",fill:"currentColor"})}),Ige=t=>Y.jsx("svg",{"aria-hidden":"true",fill:"none",focusable:"false",height:"1em",role:"presentation",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,viewBox:"0 0 24 24",width:"1em",...t,children:Y.jsx("path",{d:"M18 6L6 18M6 6l12 12"})}),no={ease:[.36,.66,.4,1],easeIn:[.4,0,1,1],easeOut:[0,0,.2,1],easeInOut:[.4,0,.2,1],spring:[.155,1.105,.295,1.12],springOut:[.57,-.15,.62,.07],softSpring:[.16,1.11,.3,1.02]},Tge={scaleSpring:{enter:{transform:"scale(1)",opacity:1,transition:{type:"spring",bounce:0,duration:.2}},exit:{transform:"scale(0.85)",opacity:0,transition:{type:"easeOut",duration:.15}}},scaleSpringOpacity:{initial:{opacity:0,transform:"scale(0.8)"},enter:{opacity:1,transform:"scale(1)",transition:{type:"spring",bounce:0,duration:.3}},exit:{opacity:0,transform:"scale(0.96)",transition:{type:"easeOut",bounce:0,duration:.15}}},scale:{enter:{scale:1},exit:{scale:.95}},scaleFadeIn:{enter:{transform:"scale(1)",opacity:1,transition:{duration:.25,ease:no.easeIn}},exit:{transform:"scale(0.95)",opacity:0,transition:{duration:.2,ease:no.easeOut}}},scaleInOut:{enter:{transform:"scale(1)",opacity:1,transition:{duration:.4,ease:no.ease}},exit:{transform:"scale(1.03)",opacity:0,transition:{duration:.3,ease:no.ease}}},fade:{enter:{opacity:1,transition:{duration:.4,ease:no.ease}},exit:{opacity:0,transition:{duration:.3,ease:no.ease}}},collapse:{enter:{opacity:1,height:"auto",transition:{height:{type:"spring",bounce:0,duration:.3},opacity:{easings:"ease",duration:.4}}},exit:{opacity:0,height:0,transition:{easings:"ease",duration:.3}}}},CC=globalThis!=null&&globalThis.document?A.useLayoutEffect:A.useEffect,[Lve,Ege]=M$({name:"ButtonGroupContext",strict:!1});function DM(t,e){let{elementType:n="button",isDisabled:r,onPress:s,onPressStart:o,onPressEnd:i,onPressChange:a,preventFocusOnPress:l,allowFocusWhenDisabled:u,onClick:c,href:d,target:f,rel:h,type:p="button",allowTextSelectionOnPress:g}=t,v;n==="button"?v={type:p,disabled:r}:v={role:"button",tabIndex:r?void 0:0,href:n==="a"&&r?void 0:d,target:n==="a"?f:void 0,type:n==="input"?p:void 0,disabled:n==="input"?r:void 0,"aria-disabled":!r||n==="input"?void 0:r,rel:n==="a"?h:void 0};let{pressProps:m,isPressed:b}=xC({onPressStart:o,onPressEnd:i,onPressChange:a,onPress:s,isDisabled:r,preventFocusOnPress:l,allowTextSelectionOnPress:g,ref:e}),{focusableProps:x}=fge(t,e);u&&(x.tabIndex=r?-1:x.tabIndex);let y=tt(x,m,b0(t,{labelable:!0}));return{isPressed:b,buttonProps:tt(v,y,{"aria-haspopup":t["aria-haspopup"],"aria-expanded":t["aria-expanded"],"aria-controls":t["aria-controls"],"aria-pressed":t["aria-pressed"],onClick:$=>{c==null||c($)}})}}var AM=t=>{const{ripples:e=[],motionProps:n,color:r="currentColor",style:s,onClear:o}=t;return Y.jsx(Y.Fragment,{children:e.map(i=>{const a=ace(.01*i.size,.2,i.size>100?.75:.5);return Y.jsx(Ox,{features:Lx,children:Y.jsx(oM,{mode:"popLayout",children:Y.jsx(Px.span,{animate:{transform:"scale(2)",opacity:0},className:"nextui-ripple",exit:{opacity:0},initial:{transform:"scale(0)",opacity:.35},style:{position:"absolute",backgroundColor:r,borderRadius:"100%",transformOrigin:"center",pointerEvents:"none",overflow:"hidden",inset:0,zIndex:0,top:i.y,left:i.x,width:`${i.size}px`,height:`${i.size}px`,...s},transition:{duration:a},onAnimationComplete:()=>{o(i.key)},...n})})},i.key)})})};AM.displayName="NextUI.Ripple";var Nge=AM;function Rge(t={}){const[e,n]=A.useState([]),r=A.useCallback(o=>{const i=o.currentTarget,a=Math.max(i.clientWidth,i.clientHeight),l=i.getBoundingClientRect();n(u=>[...u,{key:ice(u.length.toString()),size:a,x:o.clientX-l.left-a/2,y:o.clientY-l.top-a/2}])},[]),s=A.useCallback(o=>{n(i=>i.filter(a=>a.key!==o))},[]);return{ripples:e,onClick:r,onClear:s,...t}}function Dge(t){var e,n,r,s,o,i,a,l,u;const c=Ege(),d=g0(),f=!!c,{ref:h,as:p,children:g,startContent:v,endContent:m,autoFocus:b,className:x,spinner:y,isLoading:$=!1,disableRipple:C=!1,fullWidth:k=(e=c==null?void 0:c.fullWidth)!=null?e:!1,radius:w=c==null?void 0:c.radius,size:I=(n=c==null?void 0:c.size)!=null?n:"md",color:N=(r=c==null?void 0:c.color)!=null?r:"default",variant:E=(s=c==null?void 0:c.variant)!=null?s:"solid",disableAnimation:R=(i=(o=c==null?void 0:c.disableAnimation)!=null?o:d==null?void 0:d.disableAnimation)!=null?i:!1,isDisabled:S=(a=c==null?void 0:c.isDisabled)!=null?a:!1,isIconOnly:T=(l=c==null?void 0:c.isIconOnly)!=null?l:!1,spinnerPlacement:F="start",onPress:L,onClick:G,...P}=t,z=p||"button",U=typeof z=="string",K=ao(h),Q=(u=C||(d==null?void 0:d.disableRipple))!=null?u:R,{isFocusVisible:Z,isFocused:te,focusProps:J}=od({autoFocus:b}),re=S||$,le=A.useMemo(()=>Qme({size:I,color:N,variant:E,radius:w,fullWidth:k,isDisabled:re,isInGroup:f,disableAnimation:R,isIconOnly:T,className:x}),[I,N,E,w,k,re,f,T,R,x]),{onClick:pe,onClear:oe,ripples:xe}=Rge(),$e=A.useCallback(yt=>{Q||re||R||K.current&&pe(yt)},[Q,re,R,K,pe]),{buttonProps:Oe,isPressed:We}=DM({elementType:p,isDisabled:re,onPress:L,onClick:ws(G,$e),...P},K),{isHovered:Qe,hoverProps:Le}=$C({isDisabled:re}),Pe=A.useCallback((yt={})=>({"data-disabled":Ne(re),"data-focus":Ne(te),"data-pressed":Ne(We),"data-focus-visible":Ne(Z),"data-hover":Ne(Qe),"data-loading":Ne($),...tt(Oe,J,Le,gx(P,{enabled:U}),gx(yt))}),[$,re,te,We,U,Z,Qe,Oe,J,Le,P]),Ke=yt=>A.isValidElement(yt)?A.cloneElement(yt,{"aria-hidden":!0,focusable:!1,tabIndex:-1}):null,Ue=Ke(v),Ce=Ke(m),Tt=A.useMemo(()=>({sm:"sm",md:"sm",lg:"md"})[I],[I]),lr=A.useCallback(()=>({ripples:xe,onClear:oe}),[xe,oe]);return{Component:z,children:g,domRef:K,spinner:y,styles:le,startContent:Ue,endContent:Ce,isLoading:$,spinnerPlacement:F,spinnerSize:Tt,disableRipple:Q,getButtonProps:Pe,getRippleProps:lr,isIconOnly:T}}function Age(t){const[e,n]=I0(t,m2.variantKeys),{children:r,className:s,classNames:o,label:i,...a}=e,l=A.useMemo(()=>m2({...n}),[m0(n)]),u=wt(o==null?void 0:o.base,s),c=i||r,d=A.useMemo(()=>c&&typeof c=="string"?c:a["aria-label"]?"":"Loading",[r,c,a["aria-label"]]),f=A.useCallback(()=>({"aria-label":d,className:l.base({class:u}),...a}),[d,l,u,a]);return{label:c,slots:l,classNames:o,getSpinnerProps:f}}var FM=Io((t,e)=>{const{slots:n,classNames:r,label:s,getSpinnerProps:o}=Age({...t});return Y.jsxs("div",{ref:e,...o(),children:[Y.jsxs("div",{className:n.wrapper({class:r==null?void 0:r.wrapper}),children:[Y.jsx("i",{className:n.circle1({class:r==null?void 0:r.circle1})}),Y.jsx("i",{className:n.circle2({class:r==null?void 0:r.circle2})})]}),s&&Y.jsx("span",{className:n.label({class:r==null?void 0:r.label}),children:s})]})});FM.displayName="NextUI.Spinner";var Fge=FM,PM=Io((t,e)=>{const{Component:n,domRef:r,children:s,styles:o,spinnerSize:i,spinner:a=Y.jsx(Fge,{color:"current",size:i}),spinnerPlacement:l,startContent:u,endContent:c,isLoading:d,disableRipple:f,getButtonProps:h,getRippleProps:p,isIconOnly:g}=Dge({...t,ref:e});return Y.jsxs(n,{ref:r,className:o,...h(),children:[u,d&&l==="start"&&a,d&&g?null:s,d&&l==="end"&&a,c,!f&&Y.jsx(Nge,{...p()})]})});PM.displayName="NextUI.Button";var Wu=PM;let Pge=new Set,wc=new Map,xa=!1,Xx=!1;function T0(t,e){for(let n of Pge)n(t,e)}function Oge(t){return!(t.metaKey||!Qr()&&t.altKey||t.ctrlKey||t.key==="Control"||t.key==="Shift"||t.key==="Meta")}function bm(t){xa=!0,Oge(t)&&T0("keyboard",t)}function Or(t){(t.type==="mousedown"||t.type==="pointerdown")&&(xa=!0,T0("pointer",t))}function OM(t){$s(t)&&(xa=!0)}function LM(t){t.target===window||t.target===document||(!xa&&!Xx&&T0("virtual",t),xa=!1,Xx=!1)}function MM(){xa=!1,Xx=!0}function I2(t){if(typeof window>"u"||wc.get(je(t)))return;const e=je(t),n=ve(t);let r=e.HTMLElement.prototype.focus;e.HTMLElement.prototype.focus=function(){xa=!0,r.apply(this,arguments)},n.addEventListener("keydown",bm,!0),n.addEventListener("keyup",bm,!0),n.addEventListener("click",OM,!0),e.addEventListener("focus",LM,!0),e.addEventListener("blur",MM,!1),typeof PointerEvent<"u"?(n.addEventListener("pointerdown",Or,!0),n.addEventListener("pointermove",Or,!0),n.addEventListener("pointerup",Or,!0)):(n.addEventListener("mousedown",Or,!0),n.addEventListener("mousemove",Or,!0),n.addEventListener("mouseup",Or,!0)),e.addEventListener("beforeunload",()=>{_M(t)},{once:!0}),wc.set(e,{focus:r})}const _M=(t,e)=>{const n=je(t),r=ve(t);e&&r.removeEventListener("DOMContentLoaded",e),wc.has(n)&&(n.HTMLElement.prototype.focus=wc.get(n).focus,r.removeEventListener("keydown",bm,!0),r.removeEventListener("keyup",bm,!0),r.removeEventListener("click",OM,!0),n.removeEventListener("focus",LM,!0),n.removeEventListener("blur",MM,!1),typeof PointerEvent<"u"?(r.removeEventListener("pointerdown",Or,!0),r.removeEventListener("pointermove",Or,!0),r.removeEventListener("pointerup",Or,!0)):(r.removeEventListener("mousedown",Or,!0),r.removeEventListener("mousemove",Or,!0),r.removeEventListener("mouseup",Or,!0)),wc.delete(n))};function Lge(t){const e=ve(t);let n;return e.readyState!=="loading"?I2(t):(n=()=>{I2(t)},e.addEventListener("DOMContentLoaded",n)),()=>_M(t,n)}typeof document<"u"&&Lge();function Mge(t){T0(t,null)}function _ge(t,e,n){let{validationBehavior:r,focus:s}=t;bt(()=>{if(r==="native"&&(n!=null&&n.current)){let l=e.realtimeValidation.isInvalid?e.realtimeValidation.validationErrors.join(" ")||"Invalid value.":"";n.current.setCustomValidity(l),n.current.hasAttribute("title")||(n.current.title=""),e.realtimeValidation.isInvalid||e.updateValidation(Vge(n.current))}});let o=kt(()=>{e.resetValidation()}),i=kt(l=>{var u;e.displayValidation.isInvalid||e.commitValidation();let c=n==null||(u=n.current)===null||u===void 0?void 0:u.form;if(!l.defaultPrevented&&n&&c&&Bge(c)===n.current){var d;s?s():(d=n.current)===null||d===void 0||d.focus(),Mge("keyboard")}l.preventDefault()}),a=kt(()=>{e.commitValidation()});A.useEffect(()=>{let l=n==null?void 0:n.current;if(!l)return;let u=l.form;return l.addEventListener("invalid",i),l.addEventListener("change",a),u==null||u.addEventListener("reset",o),()=>{l.removeEventListener("invalid",i),l.removeEventListener("change",a),u==null||u.removeEventListener("reset",o)}},[n,i,a,o,r])}function zge(t){let e=t.validity;return{badInput:e.badInput,customError:e.customError,patternMismatch:e.patternMismatch,rangeOverflow:e.rangeOverflow,rangeUnderflow:e.rangeUnderflow,stepMismatch:e.stepMismatch,tooLong:e.tooLong,tooShort:e.tooShort,typeMismatch:e.typeMismatch,valueMissing:e.valueMissing,valid:e.valid}}function Vge(t){return{isInvalid:!t.validity.valid,validationDetails:zge(t),validationErrors:t.validationMessage?[t.validationMessage]:[]}}function Bge(t){for(let e=0;e<t.elements.length;e++){let n=t.elements[e];if(!n.validity.valid)return n}return null}const zM={badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valueMissing:!1,valid:!0},VM={...zM,customError:!0,valid:!1},Uu={isInvalid:!1,validationDetails:zM,validationErrors:[]},Wge=A.createContext({}),T2="__formValidationState"+Date.now();function Uge(t){if(t[T2]){let{realtimeValidation:e,displayValidation:n,updateValidation:r,resetValidation:s,commitValidation:o}=t[T2];return{realtimeValidation:e,displayValidation:n,updateValidation:r,resetValidation:s,commitValidation:o}}return Gge(t)}function Gge(t){let{isInvalid:e,validationState:n,name:r,value:s,builtinValidation:o,validate:i,validationBehavior:a="aria"}=t;n&&(e||(e=n==="invalid"));let l=e!==void 0?{isInvalid:e,validationErrors:[],validationDetails:VM}:null,u=A.useMemo(()=>E2(Hge(i,s)),[i,s]);o!=null&&o.validationDetails.valid&&(o=null);let c=A.useContext(Wge),d=A.useMemo(()=>r?Array.isArray(r)?r.flatMap(N=>qx(c[N])):qx(c[r]):[],[c,r]),[f,h]=A.useState(c),[p,g]=A.useState(!1);c!==f&&(h(c),g(!1));let v=A.useMemo(()=>E2(p?[]:d),[p,d]),m=A.useRef(Uu),[b,x]=A.useState(Uu),y=A.useRef(Uu),$=()=>{if(!C)return;k(!1);let N=u||o||m.current;Ov(N,y.current)||(y.current=N,x(N))},[C,k]=A.useState(!1);return A.useEffect($),{realtimeValidation:l||v||u||o||Uu,displayValidation:a==="native"?l||v||b:l||v||u||o||b,updateValidation(N){a==="aria"&&!Ov(b,N)?x(N):m.current=N},resetValidation(){let N=Uu;Ov(N,y.current)||(y.current=N,x(N)),a==="native"&&k(!1),g(!0)},commitValidation(){a==="native"&&k(!0),g(!0)}}}function qx(t){return t?Array.isArray(t)?t:[t]:[]}function Hge(t,e){if(typeof t=="function"){let n=t(e);if(n&&typeof n!="boolean")return qx(n)}return[]}function E2(t){return t.length?{isInvalid:!0,validationErrors:t,validationDetails:VM}:null}function Ov(t,e){return t===e?!0:t&&e&&t.isInvalid===e.isInvalid&&t.validationErrors.length===e.validationErrors.length&&t.validationErrors.every((n,r)=>n===e.validationErrors[r])&&Object.entries(t.validationDetails).every(([n,r])=>e.validationDetails[n]===r)}let bl="default",Yx="",Zh=new WeakMap;function N2(t){if(Rf()){if(bl==="default"){const e=ve(t);Yx=e.documentElement.style.webkitUserSelect,e.documentElement.style.webkitUserSelect="none"}bl="disabled"}else(t instanceof HTMLElement||t instanceof SVGElement)&&(Zh.set(t,t.style.userSelect),t.style.userSelect="none")}function Rh(t){if(Rf()){if(bl!=="disabled")return;bl="restoring",setTimeout(()=>{_a(()=>{if(bl==="restoring"){const e=ve(t);e.documentElement.style.webkitUserSelect==="none"&&(e.documentElement.style.webkitUserSelect=Yx||""),Yx="",bl="default"}})},300)}else if((t instanceof HTMLElement||t instanceof SVGElement)&&t&&Zh.has(t)){let e=Zh.get(t);t.style.userSelect==="none"&&(t.style.userSelect=e),t.getAttribute("style")===""&&t.removeAttribute("style"),Zh.delete(t)}}const BM=Ze.createContext({register:()=>{}});BM.displayName="PressResponderContext";function jge(t){let e=A.useContext(BM);if(e){let{register:n,...r}=e;t=tt(r,t),n()}return Df(e,t.ref),t}var Dh=new WeakMap;class Ah{continuePropagation(){tm(this,Dh,!1)}get shouldStopPropagation(){return V3(this,Dh)}constructor(e,n,r){XO(this,Dh,{writable:!0,value:void 0}),tm(this,Dh,!0),this.type=e,this.pointerType=n,this.target=r.currentTarget,this.shiftKey=r.shiftKey,this.metaKey=r.metaKey,this.ctrlKey=r.ctrlKey,this.altKey=r.altKey}}const R2=Symbol("linkClicked");function D2(t){let{onPress:e,onPressChange:n,onPressStart:r,onPressEnd:s,onPressUp:o,isDisabled:i,isPressed:a,preventFocusOnPress:l,shouldCancelOnPointerExit:u,allowTextSelectionOnPress:c,ref:d,...f}=jge(t),[h,p]=A.useState(!1),g=A.useRef({isPressed:!1,ignoreEmulatedMouseEvents:!1,ignoreClickAfterPress:!1,didFirePressStart:!1,isTriggeringEvent:!1,activePointerId:null,target:null,isOverTarget:!1,pointerType:null}),{addGlobalListener:v,removeAllGlobalListeners:m}=ZO(),b=kt((w,I)=>{let N=g.current;if(i||N.didFirePressStart)return!1;let E=!0;if(N.isTriggeringEvent=!0,r){let R=new Ah("pressstart",I,w);r(R),E=R.shouldStopPropagation}return n&&n(!0),N.isTriggeringEvent=!1,N.didFirePressStart=!0,p(!0),E}),x=kt((w,I,N=!0)=>{let E=g.current;if(!E.didFirePressStart)return!1;E.ignoreClickAfterPress=!0,E.didFirePressStart=!1,E.isTriggeringEvent=!0;let R=!0;if(s){let S=new Ah("pressend",I,w);s(S),R=S.shouldStopPropagation}if(n&&n(!1),p(!1),e&&N&&!i){let S=new Ah("press",I,w);e(S),R&&(R=S.shouldStopPropagation)}return E.isTriggeringEvent=!1,R}),y=kt((w,I)=>{let N=g.current;if(i)return!1;if(o){N.isTriggeringEvent=!0;let E=new Ah("pressup",I,w);return o(E),N.isTriggeringEvent=!1,E.shouldStopPropagation}return!0}),$=kt(w=>{let I=g.current;I.isPressed&&I.target&&(I.isOverTarget&&I.pointerType!=null&&x(Zs(I.target,w),I.pointerType,!1),I.isPressed=!1,I.isOverTarget=!1,I.activePointerId=null,I.pointerType=null,m(),c||Rh(I.target))}),C=kt(w=>{u&&$(w)}),k=A.useMemo(()=>{let w=g.current,I={onKeyDown(E){if(Lv(E.nativeEvent,E.currentTarget)&&E.currentTarget.contains(E.target)){var R;F2(E.target,E.key)&&E.preventDefault();let S=!0;if(!w.isPressed&&!E.repeat){w.target=E.currentTarget,w.isPressed=!0,S=b(E,"keyboard");let T=E.currentTarget,F=L=>{Lv(L,T)&&!L.repeat&&T.contains(L.target)&&w.target&&y(Zs(w.target,L),"keyboard")};v(ve(E.currentTarget),"keyup",ws(F,N),!0)}S&&E.stopPropagation(),E.metaKey&&Qr()&&((R=w.metaKeyEvents)===null||R===void 0||R.set(E.key,E.nativeEvent))}else E.key==="Meta"&&(w.metaKeyEvents=new Map)},onClick(E){if(!(E&&!E.currentTarget.contains(E.target))&&E&&E.button===0&&!w.isTriggeringEvent&&!ma.isOpening){let R=!0;if(i&&E.preventDefault(),!w.ignoreClickAfterPress&&!w.ignoreEmulatedMouseEvents&&!w.isPressed&&(w.pointerType==="virtual"||$s(E.nativeEvent))){!i&&!l&&nn(E.currentTarget);let S=b(E,"virtual"),T=y(E,"virtual"),F=x(E,"virtual");R=S&&T&&F}w.ignoreEmulatedMouseEvents=!1,w.ignoreClickAfterPress=!1,R&&E.stopPropagation()}}},N=E=>{var R;if(w.isPressed&&w.target&&Lv(E,w.target)){var S;F2(E.target,E.key)&&E.preventDefault();let F=E.target;x(Zs(w.target,E),"keyboard",w.target.contains(F)),m(),E.key!=="Enter"&&kC(w.target)&&w.target.contains(F)&&!E[R2]&&(E[R2]=!0,ma(w.target,E,!1)),w.isPressed=!1,(S=w.metaKeyEvents)===null||S===void 0||S.delete(E.key)}else if(E.key==="Meta"&&(!((R=w.metaKeyEvents)===null||R===void 0)&&R.size)){var T;let F=w.metaKeyEvents;w.metaKeyEvents=void 0;for(let L of F.values())(T=w.target)===null||T===void 0||T.dispatchEvent(new KeyboardEvent("keyup",L))}};if(typeof PointerEvent<"u"){I.onPointerDown=T=>{if(T.button!==0||!T.currentTarget.contains(T.target))return;if(t3(T.nativeEvent)){w.pointerType="virtual";return}Mv(T.currentTarget)&&T.preventDefault(),w.pointerType=T.pointerType;let F=!0;w.isPressed||(w.isPressed=!0,w.isOverTarget=!0,w.activePointerId=T.pointerId,w.target=T.currentTarget,!i&&!l&&nn(T.currentTarget),c||N2(w.target),F=b(T,w.pointerType),v(ve(T.currentTarget),"pointermove",E,!1),v(ve(T.currentTarget),"pointerup",R,!1),v(ve(T.currentTarget),"pointercancel",S,!1)),F&&T.stopPropagation()},I.onMouseDown=T=>{T.currentTarget.contains(T.target)&&T.button===0&&(Mv(T.currentTarget)&&T.preventDefault(),T.stopPropagation())},I.onPointerUp=T=>{!T.currentTarget.contains(T.target)||w.pointerType==="virtual"||T.button===0&&Qa(T,T.currentTarget)&&y(T,w.pointerType||T.pointerType)};let E=T=>{T.pointerId===w.activePointerId&&(w.target&&Qa(T,w.target)?!w.isOverTarget&&w.pointerType!=null&&(w.isOverTarget=!0,b(Zs(w.target,T),w.pointerType)):w.target&&w.isOverTarget&&w.pointerType!=null&&(w.isOverTarget=!1,x(Zs(w.target,T),w.pointerType,!1),C(T)))},R=T=>{T.pointerId===w.activePointerId&&w.isPressed&&T.button===0&&w.target&&(Qa(T,w.target)&&w.pointerType!=null?x(Zs(w.target,T),w.pointerType):w.isOverTarget&&w.pointerType!=null&&x(Zs(w.target,T),w.pointerType,!1),w.isPressed=!1,w.isOverTarget=!1,w.activePointerId=null,w.pointerType=null,m(),c||Rh(w.target))},S=T=>{$(T)};I.onDragStart=T=>{T.currentTarget.contains(T.target)&&$(T)}}else{I.onMouseDown=S=>{if(S.button!==0||!S.currentTarget.contains(S.target))return;if(Mv(S.currentTarget)&&S.preventDefault(),w.ignoreEmulatedMouseEvents){S.stopPropagation();return}w.isPressed=!0,w.isOverTarget=!0,w.target=S.currentTarget,w.pointerType=$s(S.nativeEvent)?"virtual":"mouse",!i&&!l&&nn(S.currentTarget),b(S,w.pointerType)&&S.stopPropagation(),v(ve(S.currentTarget),"mouseup",E,!1)},I.onMouseEnter=S=>{if(!S.currentTarget.contains(S.target))return;let T=!0;w.isPressed&&!w.ignoreEmulatedMouseEvents&&w.pointerType!=null&&(w.isOverTarget=!0,T=b(S,w.pointerType)),T&&S.stopPropagation()},I.onMouseLeave=S=>{if(!S.currentTarget.contains(S.target))return;let T=!0;w.isPressed&&!w.ignoreEmulatedMouseEvents&&w.pointerType!=null&&(w.isOverTarget=!1,T=x(S,w.pointerType,!1),C(S)),T&&S.stopPropagation()},I.onMouseUp=S=>{S.currentTarget.contains(S.target)&&!w.ignoreEmulatedMouseEvents&&S.button===0&&y(S,w.pointerType||"mouse")};let E=S=>{if(S.button===0){if(w.isPressed=!1,m(),w.ignoreEmulatedMouseEvents){w.ignoreEmulatedMouseEvents=!1;return}w.target&&Qa(S,w.target)&&w.pointerType!=null?x(Zs(w.target,S),w.pointerType):w.target&&w.isOverTarget&&w.pointerType!=null&&x(Zs(w.target,S),w.pointerType,!1),w.isOverTarget=!1}};I.onTouchStart=S=>{if(!S.currentTarget.contains(S.target))return;let T=Kge(S.nativeEvent);if(!T)return;w.activePointerId=T.identifier,w.ignoreEmulatedMouseEvents=!0,w.isOverTarget=!0,w.isPressed=!0,w.target=S.currentTarget,w.pointerType="touch",!i&&!l&&nn(S.currentTarget),c||N2(w.target),b(S,w.pointerType)&&S.stopPropagation(),v(je(S.currentTarget),"scroll",R,!0)},I.onTouchMove=S=>{if(!S.currentTarget.contains(S.target))return;if(!w.isPressed){S.stopPropagation();return}let T=A2(S.nativeEvent,w.activePointerId),F=!0;T&&Qa(T,S.currentTarget)?!w.isOverTarget&&w.pointerType!=null&&(w.isOverTarget=!0,F=b(S,w.pointerType)):w.isOverTarget&&w.pointerType!=null&&(w.isOverTarget=!1,F=x(S,w.pointerType,!1),C(S)),F&&S.stopPropagation()},I.onTouchEnd=S=>{if(!S.currentTarget.contains(S.target))return;if(!w.isPressed){S.stopPropagation();return}let T=A2(S.nativeEvent,w.activePointerId),F=!0;T&&Qa(T,S.currentTarget)&&w.pointerType!=null?(y(S,w.pointerType),F=x(S,w.pointerType)):w.isOverTarget&&w.pointerType!=null&&(F=x(S,w.pointerType,!1)),F&&S.stopPropagation(),w.isPressed=!1,w.activePointerId=null,w.isOverTarget=!1,w.ignoreEmulatedMouseEvents=!0,w.target&&!c&&Rh(w.target),m()},I.onTouchCancel=S=>{S.currentTarget.contains(S.target)&&(S.stopPropagation(),w.isPressed&&$(S))};let R=S=>{w.isPressed&&S.target.contains(w.target)&&$({currentTarget:w.target,shiftKey:!1,ctrlKey:!1,metaKey:!1,altKey:!1})};I.onDragStart=S=>{S.currentTarget.contains(S.target)&&$(S)}}return I},[v,i,l,m,c,$,C,x,b,y]);return A.useEffect(()=>()=>{var w;c||Rh((w=g.current.target)!==null&&w!==void 0?w:void 0)},[c]),{isPressed:a||h,pressProps:tt(f,k)}}function kC(t){return t.tagName==="A"&&t.hasAttribute("href")}function Lv(t,e){const{key:n,code:r}=t,s=e,o=s.getAttribute("role");return(n==="Enter"||n===" "||n==="Spacebar"||r==="Space")&&!(s instanceof je(s).HTMLInputElement&&!WM(s,n)||s instanceof je(s).HTMLTextAreaElement||s.isContentEditable)&&!((o==="link"||!o&&kC(s))&&n!=="Enter")}function Kge(t){const{targetTouches:e}=t;return e.length>0?e[0]:null}function A2(t,e){const n=t.changedTouches;for(let r=0;r<n.length;r++){const s=n[r];if(s.identifier===e)return s}return null}function Zs(t,e){return{currentTarget:t,shiftKey:e.shiftKey,ctrlKey:e.ctrlKey,metaKey:e.metaKey,altKey:e.altKey}}function Xge(t){let e=0,n=0;return t.width!==void 0?e=t.width/2:t.radiusX!==void 0&&(e=t.radiusX),t.height!==void 0?n=t.height/2:t.radiusY!==void 0&&(n=t.radiusY),{top:t.clientY-n,right:t.clientX+e,bottom:t.clientY+n,left:t.clientX-e}}function qge(t,e){return!(t.left>e.right||e.left>t.right||t.top>e.bottom||e.top>t.bottom)}function Qa(t,e){let n=e.getBoundingClientRect(),r=Xge(t);return qge(n,r)}function Mv(t){return!(t instanceof HTMLElement)||!t.hasAttribute("draggable")}function F2(t,e){return t instanceof HTMLInputElement?!WM(t,e):t instanceof HTMLButtonElement?t.type!=="submit"&&t.type!=="reset":!kC(t)}const Yge=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function WM(t,e){return t.type==="checkbox"||t.type==="radio"?e===" ":Yge.has(t.type)}let Qge=class{isDefaultPrevented(){return this.nativeEvent.defaultPrevented}preventDefault(){this.defaultPrevented=!0,this.nativeEvent.preventDefault()}stopPropagation(){this.nativeEvent.stopPropagation(),this.isPropagationStopped=()=>!0}isPropagationStopped(){return!1}persist(){}constructor(e,n){this.nativeEvent=n,this.target=n.target,this.currentTarget=n.currentTarget,this.relatedTarget=n.relatedTarget,this.bubbles=n.bubbles,this.cancelable=n.cancelable,this.defaultPrevented=n.defaultPrevented,this.eventPhase=n.eventPhase,this.isTrusted=n.isTrusted,this.timeStamp=n.timeStamp,this.type=e}};function Zge(t){let e=A.useRef({isFocused:!1,observer:null});bt(()=>{const r=e.current;return()=>{r.observer&&(r.observer.disconnect(),r.observer=null)}},[]);let n=kt(r=>{t==null||t(r)});return A.useCallback(r=>{if(r.target instanceof HTMLButtonElement||r.target instanceof HTMLInputElement||r.target instanceof HTMLTextAreaElement||r.target instanceof HTMLSelectElement){e.current.isFocused=!0;let s=r.target,o=i=>{e.current.isFocused=!1,s.disabled&&n(new Qge("blur",i)),e.current.observer&&(e.current.observer.disconnect(),e.current.observer=null)};s.addEventListener("focusout",o,{once:!0}),e.current.observer=new MutationObserver(()=>{if(e.current.isFocused&&s.disabled){var i;(i=e.current.observer)===null||i===void 0||i.disconnect();let a=s===document.activeElement?null:document.activeElement;s.dispatchEvent(new FocusEvent("blur",{relatedTarget:a})),s.dispatchEvent(new FocusEvent("focusout",{bubbles:!0,relatedTarget:a}))}}),e.current.observer.observe(s,{attributes:!0,attributeFilter:["disabled"]})}},[n])}function Jge(t){let{isDisabled:e,onFocus:n,onBlur:r,onFocusChange:s}=t;const o=A.useCallback(l=>{if(l.target===l.currentTarget)return r&&r(l),s&&s(!1),!0},[r,s]),i=Zge(o),a=A.useCallback(l=>{const u=ve(l.target);l.target===l.currentTarget&&u.activeElement===l.target&&(n&&n(l),s&&s(!0),i(l))},[s,n,i]);return{focusProps:{onFocus:!e&&(n||s||r)?a:void 0,onBlur:!e&&(r||s)?o:void 0}}}let Mf=null,e0e=new Set,$c=new Map,ya=!1,Qx=!1;function SC(t,e){for(let n of e0e)n(t,e)}function t0e(t){return!(t.metaKey||!Qr()&&t.altKey||t.ctrlKey||t.key==="Control"||t.key==="Shift"||t.key==="Meta")}function xm(t){ya=!0,t0e(t)&&(Mf="keyboard",SC("keyboard",t))}function Lr(t){Mf="pointer",(t.type==="mousedown"||t.type==="pointerdown")&&(ya=!0,SC("pointer",t))}function UM(t){$s(t)&&(ya=!0,Mf="virtual")}function GM(t){t.target===window||t.target===document||(!ya&&!Qx&&(Mf="virtual",SC("virtual",t)),ya=!1,Qx=!1)}function HM(){ya=!1,Qx=!0}function P2(t){if(typeof window>"u"||$c.get(je(t)))return;const e=je(t),n=ve(t);let r=e.HTMLElement.prototype.focus;e.HTMLElement.prototype.focus=function(){ya=!0,r.apply(this,arguments)},n.addEventListener("keydown",xm,!0),n.addEventListener("keyup",xm,!0),n.addEventListener("click",UM,!0),e.addEventListener("focus",GM,!0),e.addEventListener("blur",HM,!1),typeof PointerEvent<"u"?(n.addEventListener("pointerdown",Lr,!0),n.addEventListener("pointermove",Lr,!0),n.addEventListener("pointerup",Lr,!0)):(n.addEventListener("mousedown",Lr,!0),n.addEventListener("mousemove",Lr,!0),n.addEventListener("mouseup",Lr,!0)),e.addEventListener("beforeunload",()=>{jM(t)},{once:!0}),$c.set(e,{focus:r})}const jM=(t,e)=>{const n=je(t),r=ve(t);e&&r.removeEventListener("DOMContentLoaded",e),$c.has(n)&&(n.HTMLElement.prototype.focus=$c.get(n).focus,r.removeEventListener("keydown",xm,!0),r.removeEventListener("keyup",xm,!0),r.removeEventListener("click",UM,!0),n.removeEventListener("focus",GM,!0),n.removeEventListener("blur",HM,!1),typeof PointerEvent<"u"?(r.removeEventListener("pointerdown",Lr,!0),r.removeEventListener("pointermove",Lr,!0),r.removeEventListener("pointerup",Lr,!0)):(r.removeEventListener("mousedown",Lr,!0),r.removeEventListener("mousemove",Lr,!0),r.removeEventListener("mouseup",Lr,!0)),$c.delete(n))};function n0e(t){const e=ve(t);let n;return e.readyState!=="loading"?P2(t):(n=()=>{P2(t)},e.addEventListener("DOMContentLoaded",n)),()=>jM(t,n)}typeof document<"u"&&n0e();function r0e(){return Mf}function O2(t){if(!t)return;let e=!0;return n=>{let r={...n,preventDefault(){n.preventDefault()},isDefaultPrevented(){return n.isDefaultPrevented()},stopPropagation(){console.error("stopPropagation is now the default behavior for events in React Spectrum. You can use continuePropagation() to revert this behavior.")},continuePropagation(){e=!1}};t(r),e&&n.stopPropagation()}}function s0e(t){return{keyboardProps:t.isDisabled?{}:{onKeyDown:O2(t.onKeyDown),onKeyUp:O2(t.onKeyUp)}}}function o0e(t){const e=ve(t);if(r0e()==="virtual"){let n=e.activeElement;_a(()=>{e.activeElement===n&&t.isConnected&&nn(t)})}else nn(t)}let i0e=Ze.createContext(null);function a0e(t){let e=A.useContext(i0e)||{};Df(e,t);let{ref:n,...r}=e;return r}function l0e(t,e){let{focusProps:n}=Jge(t),{keyboardProps:r}=s0e(t),s=tt(n,r),o=a0e(e),i=t.isDisabled?{}:o,a=A.useRef(t.autoFocus);return A.useEffect(()=>{a.current&&e.current&&o0e(e.current),a.current=!1},[e]),{focusableProps:tt({...s,tabIndex:t.excludeFromTabOrder&&!t.isDisabled?-1:void 0},i)}}function u0e(t,e,n){let{isDisabled:r=!1,isReadOnly:s=!1,value:o,name:i,children:a,"aria-label":l,"aria-labelledby":u,validationState:c="valid",isInvalid:d}=t,f=C=>{C.stopPropagation(),e.setSelected(C.target.checked)},h=a!=null,p=l!=null||u!=null;!h&&!p&&console.warn("If you do not provide children, you must specify an aria-label for accessibility");let{pressProps:g,isPressed:v}=D2({isDisabled:r}),{pressProps:m,isPressed:b}=D2({isDisabled:r||s,onPress(){e.toggle()}}),{focusableProps:x}=l0e(t,n),y=tt(g,x),$=b0(t,{labelable:!0});return n3(n,e.isSelected,e.setSelected),{labelProps:tt(m,{onClick:C=>C.preventDefault()}),inputProps:tt($,{"aria-invalid":d||c==="invalid"||void 0,"aria-errormessage":t["aria-errormessage"],"aria-controls":t["aria-controls"],"aria-readonly":s||void 0,onChange:f,disabled:r,...o==null?{}:{value:o},name:i,type:"checkbox",...y}),isSelected:e.isSelected,isPressed:v||b,isDisabled:r,isReadOnly:s,isInvalid:d||c==="invalid"}}function c0e(t){let{id:e,label:n,"aria-labelledby":r,"aria-label":s,labelElementType:o="label"}=t;e=em(e);let i=em(),a={};n?(r=r?`${i} ${r}`:i,a={id:i,htmlFor:o==="label"?e:void 0}):!r&&!s&&console.warn("If you do not provide a visible label, you must specify an aria-label or aria-labelledby attribute for accessibility");let l=JO({id:e,"aria-label":s,"aria-labelledby":r});return{labelProps:a,fieldProps:l}}function d0e(t){let{description:e,errorMessage:n,isInvalid:r,validationState:s}=t,{labelProps:o,fieldProps:i}=c0e(t),a=vx([!!e,!!n,r,s]),l=vx([!!e,!!n,r,s]);return i=tt(i,{"aria-describedby":[a,l,t["aria-describedby"]].filter(Boolean).join(" ")||void 0}),{labelProps:o,fieldProps:i,descriptionProps:{id:a},errorMessageProps:{id:l}}}function f0e(t={}){let{isReadOnly:e}=t,[n,r]=B$(t.isSelected,t.defaultSelected||!1,t.onChange);function s(i){e||r(i)}function o(){e||r(!n)}return{isSelected:n,setSelected:s,toggle:o}}function L2(t,e=[]){const n=A.useRef(t);return CC(()=>{n.current=t}),A.useCallback((...r)=>{var s;return(s=n.current)==null?void 0:s.call(n,...r)},e)}let h0e=class{isDefaultPrevented(){return this.nativeEvent.defaultPrevented}preventDefault(){this.defaultPrevented=!0,this.nativeEvent.preventDefault()}stopPropagation(){this.nativeEvent.stopPropagation(),this.isPropagationStopped=()=>!0}isPropagationStopped(){return!1}persist(){}constructor(e,n){this.nativeEvent=n,this.target=n.target,this.currentTarget=n.currentTarget,this.relatedTarget=n.relatedTarget,this.bubbles=n.bubbles,this.cancelable=n.cancelable,this.defaultPrevented=n.defaultPrevented,this.eventPhase=n.eventPhase,this.isTrusted=n.isTrusted,this.timeStamp=n.timeStamp,this.type=e}};function p0e(t){let e=A.useRef({isFocused:!1,observer:null});bt(()=>{const r=e.current;return()=>{r.observer&&(r.observer.disconnect(),r.observer=null)}},[]);let n=kt(r=>{t==null||t(r)});return A.useCallback(r=>{if(r.target instanceof HTMLButtonElement||r.target instanceof HTMLInputElement||r.target instanceof HTMLTextAreaElement||r.target instanceof HTMLSelectElement){e.current.isFocused=!0;let s=r.target,o=i=>{e.current.isFocused=!1,s.disabled&&n(new h0e("blur",i)),e.current.observer&&(e.current.observer.disconnect(),e.current.observer=null)};s.addEventListener("focusout",o,{once:!0}),e.current.observer=new MutationObserver(()=>{if(e.current.isFocused&&s.disabled){var i;(i=e.current.observer)===null||i===void 0||i.disconnect();let a=s===document.activeElement?null:document.activeElement;s.dispatchEvent(new FocusEvent("blur",{relatedTarget:a})),s.dispatchEvent(new FocusEvent("focusout",{bubbles:!0,relatedTarget:a}))}}),e.current.observer.observe(s,{attributes:!0,attributeFilter:["disabled"]})}},[n])}function m0e(t){let{isDisabled:e,onBlurWithin:n,onFocusWithin:r,onFocusWithinChange:s}=t,o=A.useRef({isFocusWithin:!1}),i=A.useCallback(u=>{o.current.isFocusWithin&&!u.currentTarget.contains(u.relatedTarget)&&(o.current.isFocusWithin=!1,n&&n(u),s&&s(!1))},[n,s,o]),a=p0e(i),l=A.useCallback(u=>{!o.current.isFocusWithin&&document.activeElement===u.target&&(r&&r(u),s&&s(!0),o.current.isFocusWithin=!0,a(u))},[r,s,a]);return e?{focusWithinProps:{onFocus:void 0,onBlur:void 0}}:{focusWithinProps:{onFocus:l,onBlur:i}}}const M2={border:0,clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"};function g0e(t={}){let{style:e,isFocusable:n}=t,[r,s]=A.useState(!1),{focusWithinProps:o}=m0e({isDisabled:!n,onFocusWithinChange:a=>s(a)}),i=A.useMemo(()=>r?e:e?{...M2,...e}:M2,[r]);return{visuallyHiddenProps:{...o,style:i}}}function v0e(t){let{children:e,elementType:n="div",isFocusable:r,style:s,...o}=t,{visuallyHiddenProps:i}=g0e(t);return Ze.createElement(n,tt(o,i),e)}function b0e(t,e,n){let{labelProps:r,inputProps:s,isSelected:o,isPressed:i,isDisabled:a,isReadOnly:l}=u0e(t,e,n);return{labelProps:r,inputProps:{...s,role:"switch",checked:o},isSelected:o,isPressed:i,isDisabled:a,isReadOnly:l}}function x0e(t={}){var e,n;const r=g0(),[s,o]=I0(t,p2.variantKeys),{ref:i,as:a,name:l,value:u="",isReadOnly:c=!1,autoFocus:d=!1,startContent:f,endContent:h,defaultSelected:p,isSelected:g,children:v,thumbIcon:m,className:b,classNames:x,onChange:y,onValueChange:$,...C}=s,k=a||"label",w=A.useRef(null),I=A.useRef(null),N=(n=(e=t.disableAnimation)!=null?e:r==null?void 0:r.disableAnimation)!=null?n:!1,E=A.useId(),R=A.useMemo(()=>{const Ce=C["aria-label"]||typeof v=="string"?v:void 0;return{name:l,value:u,children:v,autoFocus:d,defaultSelected:p,isSelected:g,isDisabled:!!t.isDisabled,isReadOnly:c,"aria-label":Ce,"aria-labelledby":C["aria-labelledby"]||E,onChange:$}},[u,l,E,v,d,c,g,p,t.isDisabled,C["aria-label"],C["aria-labelledby"],$]),S=f0e(R);CC(()=>{if(!I.current)return;const Ce=!!I.current.checked;S.setSelected(Ce)},[I.current]);const{inputProps:T,isPressed:F,isReadOnly:L}=b0e(R,S,I),{focusProps:G,isFocused:P,isFocusVisible:z}=od({autoFocus:T.autoFocus}),{hoverProps:U,isHovered:K}=$C({isDisabled:T.disabled}),Q=R.isDisabled||L,[Z,te]=A.useState(!1),{pressProps:J}=xC({isDisabled:Q,onPressStart(Ce){Ce.pointerType!=="keyboard"&&te(!0)},onPressEnd(Ce){Ce.pointerType!=="keyboard"&&te(!1)}}),re=Q?!1:Z||F,le=T.checked,pe=T.disabled,oe=A.useMemo(()=>p2({...o,disableAnimation:N}),[m0(o),N]),xe=wt(x==null?void 0:x.base,b),$e=Ce=>({...tt(U,J,C,Ce),ref:w,className:oe.base({class:wt(xe,Ce==null?void 0:Ce.className)}),"data-disabled":Ne(pe),"data-selected":Ne(le),"data-readonly":Ne(L),"data-focus":Ne(P),"data-focus-visible":Ne(z),"data-hover":Ne(K),"data-pressed":Ne(re)}),Oe=A.useCallback((Ce={})=>({...Ce,"aria-hidden":!0,className:wt(oe.wrapper({class:wt(x==null?void 0:x.wrapper,Ce==null?void 0:Ce.className)}))}),[oe,x==null?void 0:x.wrapper]),We=(Ce={})=>({...tt(T,G,Ce),ref:hce(I,i),id:T.id,onChange:ws(y,T.onChange)}),Qe=A.useCallback((Ce={})=>({...Ce,className:oe.thumb({class:wt(x==null?void 0:x.thumb,Ce==null?void 0:Ce.className)})}),[oe,x==null?void 0:x.thumb]),Le=A.useCallback((Ce={})=>({...Ce,id:E,className:oe.label({class:wt(x==null?void 0:x.label,Ce==null?void 0:Ce.className)})}),[oe,x==null?void 0:x.label,pe,le]),Pe=A.useCallback((Ce={includeStateProps:!1})=>tt({width:"1em",height:"1em",className:oe.thumbIcon({class:wt(x==null?void 0:x.thumbIcon)})},Ce.includeStateProps?{isSelected:le}:{}),[oe,x==null?void 0:x.thumbIcon,le]),Ke=A.useCallback((Ce={})=>({width:"1em",height:"1em",...Ce,className:oe.startContent({class:wt(x==null?void 0:x.startContent,Ce==null?void 0:Ce.className)})}),[oe,x==null?void 0:x.startContent,le]),Ue=A.useCallback((Ce={})=>({width:"1em",height:"1em",...Ce,className:oe.endContent({class:wt(x==null?void 0:x.endContent,Ce==null?void 0:Ce.className)})}),[oe,x==null?void 0:x.endContent,le]);return{Component:k,slots:oe,classNames:x,domRef:w,children:v,thumbIcon:m,startContent:f,endContent:h,isHovered:K,isSelected:le,isPressed:re,isFocused:P,isFocusVisible:z,isDisabled:pe,getBaseProps:$e,getWrapperProps:Oe,getInputProps:We,getLabelProps:Le,getThumbProps:Qe,getThumbIconProps:Pe,getStartContentProps:Ke,getEndContentProps:Ue}}var KM=Io((t,e)=>{const{Component:n,children:r,startContent:s,endContent:o,thumbIcon:i,getBaseProps:a,getInputProps:l,getWrapperProps:u,getThumbProps:c,getThumbIconProps:d,getLabelProps:f,getStartContentProps:h,getEndContentProps:p}=x0e({...t,ref:e}),g=typeof i=="function"?i(d({includeStateProps:!0})):i&&A.cloneElement(i,d()),v=s&&A.cloneElement(s,h()),m=o&&A.cloneElement(o,p());return Y.jsxs(n,{...a(),children:[Y.jsx(v0e,{elementType:"span",children:Y.jsx("input",{...l()})}),Y.jsxs("span",{...u(),children:[s&&v,Y.jsx("span",{...c(),children:i&&g}),o&&m]}),r&&Y.jsx("span",{...f(),children:r})]})});KM.displayName="NextUI.Switch";var y0e=KM;function w0e(t,e,n){let[r,s]=A.useState(t||e),o=A.useRef(t!==void 0),i=t!==void 0;A.useEffect(()=>{let u=o.current;u!==i&&console.warn(`WARN: A component changed from ${u?"controlled":"uncontrolled"} to ${i?"controlled":"uncontrolled"}.`),o.current=i},[i]);let a=i?t:r,l=A.useCallback((u,...c)=>{let d=(f,...h)=>{n&&(Object.is(a,f)||n(f,...h)),i||(a=f)};typeof u=="function"?(console.warn("We can not support a function callback. See Github Issues for details https://github.com/adobe/react-spectrum/issues/2320"),s((h,...p)=>{let g=u(i?a:h,...p);return d(g,...c),i?h:g})):(i||s(u),d(u,...c))},[i,a,n]);return[a,l]}class $0e{isDefaultPrevented(){return this.nativeEvent.defaultPrevented}preventDefault(){this.defaultPrevented=!0,this.nativeEvent.preventDefault()}stopPropagation(){this.nativeEvent.stopPropagation(),this.isPropagationStopped=()=>!0}isPropagationStopped(){return!1}persist(){}constructor(e,n){this.nativeEvent=n,this.target=n.target,this.currentTarget=n.currentTarget,this.relatedTarget=n.relatedTarget,this.bubbles=n.bubbles,this.cancelable=n.cancelable,this.defaultPrevented=n.defaultPrevented,this.eventPhase=n.eventPhase,this.isTrusted=n.isTrusted,this.timeStamp=n.timeStamp,this.type=e}}function C0e(t){let e=A.useRef({isFocused:!1,observer:null});bt(()=>{const r=e.current;return()=>{r.observer&&(r.observer.disconnect(),r.observer=null)}},[]);let n=kt(r=>{t==null||t(r)});return A.useCallback(r=>{if(r.target instanceof HTMLButtonElement||r.target instanceof HTMLInputElement||r.target instanceof HTMLTextAreaElement||r.target instanceof HTMLSelectElement){e.current.isFocused=!0;let s=r.target,o=i=>{e.current.isFocused=!1,s.disabled&&n(new $0e("blur",i)),e.current.observer&&(e.current.observer.disconnect(),e.current.observer=null)};s.addEventListener("focusout",o,{once:!0}),e.current.observer=new MutationObserver(()=>{if(e.current.isFocused&&s.disabled){var i;(i=e.current.observer)===null||i===void 0||i.disconnect();let a=s===document.activeElement?null:document.activeElement;s.dispatchEvent(new FocusEvent("blur",{relatedTarget:a})),s.dispatchEvent(new FocusEvent("focusout",{bubbles:!0,relatedTarget:a}))}}),e.current.observer.observe(s,{attributes:!0,attributeFilter:["disabled"]})}},[n])}function k0e(t){let{isDisabled:e,onFocus:n,onBlur:r,onFocusChange:s}=t;const o=A.useCallback(l=>{if(l.target===l.currentTarget)return r&&r(l),s&&s(!1),!0},[r,s]),i=C0e(o),a=A.useCallback(l=>{const u=ve(l.target);l.target===l.currentTarget&&u.activeElement===l.target&&(n&&n(l),s&&s(!0),i(l))},[s,n,i]);return{focusProps:{onFocus:!e&&(n||s||r)?a:void 0,onBlur:!e&&(r||s)?o:void 0}}}let _f=null,S0e=new Set,Cc=new Map,wa=!1,Zx=!1;function IC(t,e){for(let n of S0e)n(t,e)}function I0e(t){return!(t.metaKey||!Qr()&&t.altKey||t.ctrlKey||t.key==="Control"||t.key==="Shift"||t.key==="Meta")}function ym(t){wa=!0,I0e(t)&&(_f="keyboard",IC("keyboard",t))}function Mr(t){_f="pointer",(t.type==="mousedown"||t.type==="pointerdown")&&(wa=!0,IC("pointer",t))}function XM(t){$s(t)&&(wa=!0,_f="virtual")}function qM(t){t.target===window||t.target===document||(!wa&&!Zx&&(_f="virtual",IC("virtual",t)),wa=!1,Zx=!1)}function YM(){wa=!1,Zx=!0}function _2(t){if(typeof window>"u"||Cc.get(je(t)))return;const e=je(t),n=ve(t);let r=e.HTMLElement.prototype.focus;e.HTMLElement.prototype.focus=function(){wa=!0,r.apply(this,arguments)},n.addEventListener("keydown",ym,!0),n.addEventListener("keyup",ym,!0),n.addEventListener("click",XM,!0),e.addEventListener("focus",qM,!0),e.addEventListener("blur",YM,!1),typeof PointerEvent<"u"?(n.addEventListener("pointerdown",Mr,!0),n.addEventListener("pointermove",Mr,!0),n.addEventListener("pointerup",Mr,!0)):(n.addEventListener("mousedown",Mr,!0),n.addEventListener("mousemove",Mr,!0),n.addEventListener("mouseup",Mr,!0)),e.addEventListener("beforeunload",()=>{QM(t)},{once:!0}),Cc.set(e,{focus:r})}const QM=(t,e)=>{const n=je(t),r=ve(t);e&&r.removeEventListener("DOMContentLoaded",e),Cc.has(n)&&(n.HTMLElement.prototype.focus=Cc.get(n).focus,r.removeEventListener("keydown",ym,!0),r.removeEventListener("keyup",ym,!0),r.removeEventListener("click",XM,!0),n.removeEventListener("focus",qM,!0),n.removeEventListener("blur",YM,!1),typeof PointerEvent<"u"?(r.removeEventListener("pointerdown",Mr,!0),r.removeEventListener("pointermove",Mr,!0),r.removeEventListener("pointerup",Mr,!0)):(r.removeEventListener("mousedown",Mr,!0),r.removeEventListener("mousemove",Mr,!0),r.removeEventListener("mouseup",Mr,!0)),Cc.delete(n))};function T0e(t){const e=ve(t);let n;return e.readyState!=="loading"?_2(t):(n=()=>{_2(t)},e.addEventListener("DOMContentLoaded",n)),()=>QM(t,n)}typeof document<"u"&&T0e();function E0e(){return _f}function z2(t){if(!t)return;let e=!0;return n=>{let r={...n,preventDefault(){n.preventDefault()},isDefaultPrevented(){return n.isDefaultPrevented()},stopPropagation(){console.error("stopPropagation is now the default behavior for events in React Spectrum. You can use continuePropagation() to revert this behavior.")},continuePropagation(){e=!1}};t(r),e&&n.stopPropagation()}}function N0e(t){return{keyboardProps:t.isDisabled?{}:{onKeyDown:z2(t.onKeyDown),onKeyUp:z2(t.onKeyUp)}}}function R0e(t){const e=ve(t);if(E0e()==="virtual"){let n=e.activeElement;_a(()=>{e.activeElement===n&&t.isConnected&&nn(t)})}else nn(t)}let D0e=Ze.createContext(null);function A0e(t){let e=A.useContext(D0e)||{};Df(e,t);let{ref:n,...r}=e;return r}function F0e(t,e){let{focusProps:n}=k0e(t),{keyboardProps:r}=N0e(t),s=tt(n,r),o=A0e(e),i=t.isDisabled?{}:o,a=A.useRef(t.autoFocus);return A.useEffect(()=>{a.current&&e.current&&R0e(e.current),a.current=!1},[e]),{focusableProps:tt({...s,tabIndex:t.excludeFromTabOrder&&!t.isDisabled?-1:void 0},i)}}function P0e(t,e){let{inputElementType:n="input",isDisabled:r=!1,isRequired:s=!1,isReadOnly:o=!1,type:i="text",validationBehavior:a="aria"}=t,[l,u]=B$(t.value,t.defaultValue||"",t.onChange),{focusableProps:c}=F0e(t,e),d=Uge({...t,value:l}),{isInvalid:f,validationErrors:h,validationDetails:p}=d.displayValidation,{labelProps:g,fieldProps:v,descriptionProps:m,errorMessageProps:b}=d0e({...t,isInvalid:f,errorMessage:t.errorMessage||h}),x=b0(t,{labelable:!0});const y={type:i,pattern:t.pattern};return n3(e,l,u),_ge(t,d,e),A.useEffect(()=>{if(e.current instanceof je(e.current).HTMLTextAreaElement){let $=e.current;Object.defineProperty($,"defaultValue",{get:()=>$.value,set:()=>{},configurable:!0})}},[e]),{labelProps:g,inputProps:tt(x,n==="input"&&y,{disabled:r,readOnly:o,required:s&&a==="native","aria-required":s&&a==="aria"||void 0,"aria-invalid":f||void 0,"aria-errormessage":t["aria-errormessage"],"aria-activedescendant":t["aria-activedescendant"],"aria-autocomplete":t["aria-autocomplete"],"aria-haspopup":t["aria-haspopup"],value:l,onChange:$=>u($.target.value),autoComplete:t.autoComplete,autoCapitalize:t.autoCapitalize,maxLength:t.maxLength,minLength:t.minLength,name:t.name,placeholder:t.placeholder,inputMode:t.inputMode,onCopy:t.onCopy,onCut:t.onCut,onPaste:t.onPaste,onCompositionEnd:t.onCompositionEnd,onCompositionStart:t.onCompositionStart,onCompositionUpdate:t.onCompositionUpdate,onSelect:t.onSelect,onBeforeInput:t.onBeforeInput,onInput:t.onInput,...c,...v}),descriptionProps:m,errorMessageProps:b,isInvalid:f,validationErrors:h,validationDetails:p}}function O0e(t){var e,n,r,s;const o=g0(),[i,a]=I0(t,v2.variantKeys),{ref:l,as:u,type:c,label:d,baseRef:f,wrapperRef:h,description:p,className:g,classNames:v,autoFocus:m,startContent:b,endContent:x,onClear:y,onChange:$,validationState:C,validationBehavior:k=(e=o==null?void 0:o.validationBehavior)!=null?e:"aria",innerWrapperRef:w,onValueChange:I=()=>{},...N}=i,E=A.useCallback(Ee=>{I(Ee??"")},[I]),[R,S]=A.useState(!1),T=u||"div",F=(r=(n=t.disableAnimation)!=null?n:o==null?void 0:o.disableAnimation)!=null?r:!1,L=ao(l),G=ao(f),P=ao(h),z=ao(w),[U,K]=w0e(i.value,(s=i.defaultValue)!=null?s:"",E),Q=["date","time","month","week","range"].includes(c),Z=!cce(U)||Q,te=Z||R,J=wt(v==null?void 0:v.base,g,Z?"is-filled":""),re=t.isMultiline,le=A.useCallback(()=>{var Ee;K(""),y==null||y(),(Ee=L.current)==null||Ee.focus()},[K,y]);CC(()=>{L.current&&K(L.current.value)},[L.current]);const{labelProps:pe,inputProps:oe,isInvalid:xe,validationErrors:$e,validationDetails:Oe,descriptionProps:We,errorMessageProps:Qe}=P0e({...t,validationBehavior:k,autoCapitalize:t.autoCapitalize,value:U,"aria-label":oce(t["aria-label"],t.label,t.placeholder),inputElementType:re?"textarea":"input",onChange:K},L),{isFocusVisible:Le,isFocused:Pe,focusProps:Ke}=od({autoFocus:m,isTextInput:!0}),{isHovered:Ue,hoverProps:Ce}=$C({isDisabled:!!(t!=null&&t.isDisabled)}),{focusProps:Tt,isFocusVisible:lr}=od(),{focusWithinProps:yt}=Cge({onFocusWithinChange:S}),{pressProps:Ss}=xC({isDisabled:!!(t!=null&&t.isDisabled),onPress:le}),on=C==="invalid"||t.isInvalid||xe,Bt=A.useMemo(()=>{var Ee;return(!t.labelPlacement||t.labelPlacement==="inside")&&!d?"outside":(Ee=t.labelPlacement)!=null?Ee:"inside"},[t.labelPlacement,d]),Cr=typeof i.errorMessage=="function"?i.errorMessage({isInvalid:on,validationErrors:$e,validationDetails:Oe}):i.errorMessage||($e==null?void 0:$e.join(" ")),kr=!!y||t.isClearable,ts=!!d||!!p||!!Cr,ur=!!i.placeholder,Ba=!!d,wi=!!p||!!Cr,Vf=Bt==="outside"||Bt==="outside-left",Wa=Bt==="inside",Ua=L.current?(!L.current.value||L.current.value===""||!U||U==="")&&ur:!1,N0=Bt==="outside-left",qs=!!b,p_=Vf?Bt==="outside-left"||ur||Bt==="outside"&&qs:!1,m_=Bt==="outside"&&!ur&&!qs,Wt=A.useMemo(()=>v2({...a,isInvalid:on,labelPlacement:Bt,isClearable:kr,disableAnimation:F}),[m0(a),on,Bt,kr,qs,F]),g_=A.useCallback((Ee={})=>({ref:G,className:Wt.base({class:J}),"data-slot":"base","data-filled":Ne(Z||ur||qs||Ua),"data-filled-within":Ne(te||ur||qs||Ua),"data-focus-within":Ne(R),"data-focus-visible":Ne(Le),"data-readonly":Ne(t.isReadOnly),"data-focus":Ne(Pe),"data-hover":Ne(Ue),"data-required":Ne(t.isRequired),"data-invalid":Ne(on),"data-disabled":Ne(t.isDisabled),"data-has-elements":Ne(ts),"data-has-helper":Ne(wi),"data-has-label":Ne(Ba),"data-has-value":Ne(!Ua),...yt,...Ee}),[Wt,J,Z,Pe,Ue,on,wi,Ba,ts,Ua,qs,R,Le,te,ur,yt,t.isReadOnly,t.isRequired,t.isDisabled]),v_=A.useCallback((Ee={})=>({"data-slot":"label",className:Wt.label({class:v==null?void 0:v.label}),...pe,...Ee}),[Wt,pe,v==null?void 0:v.label]),b_=A.useCallback((Ee={})=>({ref:L,"data-slot":"input","data-filled":Ne(Z),"data-filled-within":Ne(te),"data-has-start-content":Ne(qs),"data-has-end-content":Ne(!!x),className:Wt.input({class:wt(v==null?void 0:v.input,Z?"is-filled":"")}),...tt(Ke,oe,gx(N,{enabled:!0,labelable:!0,omitEventNames:new Set(Object.keys(oe))}),Ee),"aria-readonly":Ne(t.isReadOnly),onChange:ws(oe.onChange,$)}),[Wt,U,Ke,oe,N,Z,te,qs,x,v==null?void 0:v.input,t.isReadOnly,t.isRequired,$]),x_=A.useCallback((Ee={})=>({ref:P,"data-slot":"input-wrapper","data-hover":Ne(Ue),"data-focus-visible":Ne(Le),"data-focus":Ne(Pe),className:Wt.inputWrapper({class:wt(v==null?void 0:v.inputWrapper,Z?"is-filled":"")}),...tt(Ee,Ce),onClick:ku=>{L.current&&ku.currentTarget===ku.target&&L.current.focus()},style:{cursor:"text",...Ee.style}}),[Wt,Ue,Le,Pe,U,v==null?void 0:v.inputWrapper]),y_=A.useCallback((Ee={})=>({...Ee,ref:z,"data-slot":"inner-wrapper",onClick:ku=>{L.current&&ku.currentTarget===ku.target&&L.current.focus()},className:Wt.innerWrapper({class:wt(v==null?void 0:v.innerWrapper,Ee==null?void 0:Ee.className)})}),[Wt,v==null?void 0:v.innerWrapper]),w_=A.useCallback((Ee={})=>({...Ee,"data-slot":"main-wrapper",className:Wt.mainWrapper({class:wt(v==null?void 0:v.mainWrapper,Ee==null?void 0:Ee.className)})}),[Wt,v==null?void 0:v.mainWrapper]),$_=A.useCallback((Ee={})=>({...Ee,"data-slot":"helper-wrapper",className:Wt.helperWrapper({class:wt(v==null?void 0:v.helperWrapper,Ee==null?void 0:Ee.className)})}),[Wt,v==null?void 0:v.helperWrapper]),C_=A.useCallback((Ee={})=>({...Ee,...We,"data-slot":"description",className:Wt.description({class:wt(v==null?void 0:v.description,Ee==null?void 0:Ee.className)})}),[Wt,v==null?void 0:v.description]),k_=A.useCallback((Ee={})=>({...Ee,...Qe,"data-slot":"error-message",className:Wt.errorMessage({class:wt(v==null?void 0:v.errorMessage,Ee==null?void 0:Ee.className)})}),[Wt,Qe,v==null?void 0:v.errorMessage]),S_=A.useCallback((Ee={})=>({...Ee,role:"button",tabIndex:0,"data-slot":"clear-button","data-focus-visible":Ne(lr),className:Wt.clearButton({class:wt(v==null?void 0:v.clearButton,Ee==null?void 0:Ee.className)}),...tt(Ss,Tt)}),[Wt,lr,Ss,Tt,v==null?void 0:v.clearButton]);return{Component:T,classNames:v,domRef:L,label:d,description:p,startContent:b,endContent:x,labelPlacement:Bt,isClearable:kr,hasHelper:wi,hasStartContent:qs,isLabelOutside:p_,isOutsideLeft:N0,isLabelOutsideAsPlaceholder:m_,shouldLabelBeOutside:Vf,shouldLabelBeInside:Wa,hasPlaceholder:ur,isInvalid:on,errorMessage:Cr,getBaseProps:g_,getLabelProps:v_,getInputProps:b_,getMainWrapperProps:w_,getInputWrapperProps:x_,getInnerWrapperProps:y_,getHelperWrapperProps:$_,getDescriptionProps:C_,getErrorMessageProps:k_,getClearButtonProps:S_}}var ZM=Io((t,e)=>{const{Component:n,label:r,description:s,isClearable:o,startContent:i,endContent:a,labelPlacement:l,hasHelper:u,isOutsideLeft:c,shouldLabelBeOutside:d,errorMessage:f,isInvalid:h,getBaseProps:p,getLabelProps:g,getInputProps:v,getInnerWrapperProps:m,getInputWrapperProps:b,getMainWrapperProps:x,getHelperWrapperProps:y,getDescriptionProps:$,getErrorMessageProps:C,getClearButtonProps:k}=O0e({...t,ref:e}),w=r?Y.jsx("label",{...g(),children:r}):null,I=A.useMemo(()=>o?Y.jsx("span",{...k(),children:a||Y.jsx(Sge,{})}):a,[o,k]),N=A.useMemo(()=>u?Y.jsx("div",{...y(),children:h&&f?Y.jsx("div",{...C(),children:f}):s?Y.jsx("div",{...$(),children:s}):null}):null,[u,h,f,s,y,C,$]),E=A.useMemo(()=>Y.jsxs("div",{...m(),children:[i,Y.jsx("input",{...v()}),I]}),[i,I,v,m]),R=A.useMemo(()=>d?Y.jsxs("div",{...x(),children:[Y.jsxs("div",{...b(),children:[c?null:w,E]}),N]}):Y.jsxs(Y.Fragment,{children:[Y.jsxs("div",{...b(),children:[w,E]}),N]}),[l,N,d,w,E,f,s,x,b,C,$]);return Y.jsxs(n,{...p(),children:[c?w:null,R]})});ZM.displayName="NextUI.Input";var L0e=ZM;let zf=null,M0e=new Set,kc=new Map,$a=!1,Jx=!1;function TC(t,e){for(let n of M0e)n(t,e)}function _0e(t){return!(t.metaKey||!Qr()&&t.altKey||t.ctrlKey||t.key==="Control"||t.key==="Shift"||t.key==="Meta")}function wm(t){$a=!0,_0e(t)&&(zf="keyboard",TC("keyboard",t))}function _r(t){zf="pointer",(t.type==="mousedown"||t.type==="pointerdown")&&($a=!0,TC("pointer",t))}function JM(t){$s(t)&&($a=!0,zf="virtual")}function e_(t){t.target===window||t.target===document||(!$a&&!Jx&&(zf="virtual",TC("virtual",t)),$a=!1,Jx=!1)}function t_(){$a=!1,Jx=!0}function V2(t){if(typeof window>"u"||kc.get(je(t)))return;const e=je(t),n=ve(t);let r=e.HTMLElement.prototype.focus;e.HTMLElement.prototype.focus=function(){$a=!0,r.apply(this,arguments)},n.addEventListener("keydown",wm,!0),n.addEventListener("keyup",wm,!0),n.addEventListener("click",JM,!0),e.addEventListener("focus",e_,!0),e.addEventListener("blur",t_,!1),typeof PointerEvent<"u"?(n.addEventListener("pointerdown",_r,!0),n.addEventListener("pointermove",_r,!0),n.addEventListener("pointerup",_r,!0)):(n.addEventListener("mousedown",_r,!0),n.addEventListener("mousemove",_r,!0),n.addEventListener("mouseup",_r,!0)),e.addEventListener("beforeunload",()=>{n_(t)},{once:!0}),kc.set(e,{focus:r})}const n_=(t,e)=>{const n=je(t),r=ve(t);e&&r.removeEventListener("DOMContentLoaded",e),kc.has(n)&&(n.HTMLElement.prototype.focus=kc.get(n).focus,r.removeEventListener("keydown",wm,!0),r.removeEventListener("keyup",wm,!0),r.removeEventListener("click",JM,!0),n.removeEventListener("focus",e_,!0),n.removeEventListener("blur",t_,!1),typeof PointerEvent<"u"?(r.removeEventListener("pointerdown",_r,!0),r.removeEventListener("pointermove",_r,!0),r.removeEventListener("pointerup",_r,!0)):(r.removeEventListener("mousedown",_r,!0),r.removeEventListener("mousemove",_r,!0),r.removeEventListener("mouseup",_r,!0)),kc.delete(n))};function z0e(t){const e=ve(t);let n;return e.readyState!=="loading"?V2(t):(n=()=>{V2(t)},e.addEventListener("DOMContentLoaded",n)),()=>n_(t,n)}typeof document<"u"&&z0e();function V0e(){return zf}function B2(t){const e=ve(t);if(V0e()==="virtual"){let n=e.activeElement;_a(()=>{e.activeElement===n&&t.isConnected&&nn(t)})}else nn(t)}const B0e=Ze.createContext(null);function W0e(){let t=A.useContext(B0e),e=t==null?void 0:t.setContain;bt(()=>{e==null||e(!0)},[e])}function U0e(t,e){let{role:n="dialog"}=t,r=vx();r=t["aria-label"]?void 0:r;let s=A.useRef(!1);return A.useEffect(()=>{if(e.current&&!e.current.contains(document.activeElement)){B2(e.current);let o=setTimeout(()=>{document.activeElement===e.current&&(s.current=!0,e.current&&(e.current.blur(),B2(e.current)),s.current=!1)},500);return()=>{clearTimeout(o)}}},[e]),W0e(),{dialogProps:{...b0(t,{labelable:!0}),role:n,tabIndex:-1,"aria-labelledby":t["aria-labelledby"]||r,onBlur:o=>{s.current&&o.stopPropagation()}},titleProps:{id:r}}}var[G0e,E0]=M$({name:"ModalContext",errorMessage:"useModalContext: `context` is undefined. Seems you forgot to wrap all popover components within `<Modal />`"}),r_=Io((t,e)=>{const{as:n,children:r,className:s,...o}=t,{slots:i,classNames:a,bodyId:l,setBodyMounted:u}=E0(),c=ao(e),d=n||"div";return A.useEffect(()=>(u(!0),()=>u(!1)),[u]),Y.jsx(d,{ref:c,className:i.body({class:wt(a==null?void 0:a.body,s)}),id:l,...o,children:r})});r_.displayName="NextUI.ModalBody";var s_=r_,H0e={enter:{scale:"var(--scale-enter)",y:"var(--slide-enter)",opacity:1,transition:{scale:{duration:.4,ease:no.ease},opacity:{duration:.4,ease:no.ease},y:{type:"spring",bounce:0,duration:.6}}},exit:{scale:"var(--scale-exit)",y:"var(--slide-exit)",opacity:0,transition:{duration:.3,ease:no.ease}}},o_=Io((t,e)=>{const{as:n,children:r,role:s="dialog",...o}=t,{Component:i,domRef:a,slots:l,classNames:u,motionProps:c,backdrop:d,closeButton:f,hideCloseButton:h,disableAnimation:p,getDialogProps:g,getBackdropProps:v,getCloseButtonProps:m,onClose:b}=E0(),x=n||i||"div",{dialogProps:y}=U0e({role:s},a),$=A.isValidElement(f)?A.cloneElement(f,m()):Y.jsx("button",{...m(),children:Y.jsx(Ige,{})}),C=A.useCallback(E=>{E.key==="Tab"&&E.nativeEvent.isComposing&&(E.stopPropagation(),E.preventDefault())},[]),k=g(tt(y,o)),w=Y.jsxs(x,{...k,onKeyDown:ws(k.onKeyDown,C),children:[Y.jsx(PI,{onDismiss:b}),!h&&$,typeof r=="function"?r(b):r,Y.jsx(PI,{onDismiss:b})]}),I=A.useMemo(()=>d==="transparent"?null:p?Y.jsx("div",{...v()}):Y.jsx(Ox,{features:Lx,children:Y.jsx(Px.div,{animate:"enter",exit:"exit",initial:"exit",variants:Tge.fade,...v()})}),[d,p,v]),N=p?Y.jsx("div",{className:l.wrapper({class:u==null?void 0:u.wrapper}),"data-slot":"wrapper",children:w}):Y.jsx(Ox,{features:Lx,children:Y.jsx(Px.div,{animate:"enter",className:l.wrapper({class:u==null?void 0:u.wrapper}),"data-slot":"wrapper",exit:"exit",initial:"exit",variants:H0e,...c,children:w})});return Y.jsxs("div",{tabIndex:-1,children:[I,N]})});o_.displayName="NextUI.ModalContent";var j0e=o_,i_=Io((t,e)=>{const{as:n,children:r,className:s,...o}=t,{slots:i,classNames:a}=E0(),l=ao(e),u=n||"footer";return Y.jsx(u,{ref:l,className:i.footer({class:wt(a==null?void 0:a.footer,s)}),...o,children:r})});i_.displayName="NextUI.ModalFooter";var K0e=i_,a_=Io((t,e)=>{const{as:n,children:r,className:s,...o}=t,{slots:i,classNames:a,headerId:l,setHeaderMounted:u}=E0(),c=ao(e),d=n||"header";return A.useEffect(()=>(u(!0),()=>u(!1)),[u]),Y.jsx(d,{ref:c,className:i.header({class:wt(a==null?void 0:a.header,s)}),id:l,...o,children:r})});a_.displayName="NextUI.ModalHeader";var l_=a_;function X0e(t={shouldBlockScroll:!0},e,n){let{overlayProps:r,underlayProps:s}=Dde({...t,isOpen:e.isOpen,onClose:e.close},n);return Fde({isDisabled:!e.isOpen||!t.shouldBlockScroll}),_de(),A.useEffect(()=>{if(e.isOpen&&n.current)return Lde([n.current])},[e.isOpen,n]),{modalProps:tt(r),underlayProps:s}}function q0e(t){let[e,n]=B$(t.isOpen,t.defaultOpen||!1,t.onOpenChange);const r=A.useCallback(()=>{n(!0)},[n]),s=A.useCallback(()=>{n(!1)},[n]),o=A.useCallback(()=>{n(!e)},[n,e]);return{isOpen:e,setOpen:n,open:r,close:s,toggle:o}}function Y0e(t){var e,n,r;const s=g0(),[o,i]=I0(t,g2.variantKeys),{ref:a,as:l,className:u,classNames:c,isOpen:d,defaultOpen:f,onOpenChange:h,motionProps:p,closeButton:g,isDismissable:v=!0,hideCloseButton:m=!1,shouldBlockScroll:b=!0,portalContainer:x,isKeyboardDismissDisabled:y=!1,onClose:$,...C}=o,k=l||"section",w=ao(a),I=A.useRef(null),[N,E]=A.useState(!1),[R,S]=A.useState(!1),T=(n=(e=t.disableAnimation)!=null?e:s==null?void 0:s.disableAnimation)!=null?n:!1,F=A.useId(),L=A.useId(),G=A.useId(),P=q0e({isOpen:d,defaultOpen:f,onOpenChange:oe=>{h==null||h(oe),oe||$==null||$()}}),{modalProps:z,underlayProps:U}=X0e({isDismissable:v,shouldBlockScroll:b,isKeyboardDismissDisabled:y},P,w),{buttonProps:K}=DM({onPress:P.close},I),{isFocusVisible:Q,focusProps:Z}=od(),te=wt(c==null?void 0:c.base,u),J=A.useMemo(()=>g2({...i,disableAnimation:T}),[m0(i),T]),re=(oe={},xe=null)=>({ref:Lce(xe,w),...tt(z,C,oe),className:J.base({class:wt(te,oe.className)}),id:F,"data-open":Ne(P.isOpen),"data-dismissable":Ne(v),"aria-modal":Ne(!0),"aria-labelledby":N?L:void 0,"aria-describedby":R?G:void 0}),le=A.useCallback((oe={})=>({className:J.backdrop({class:c==null?void 0:c.backdrop}),onClick:()=>P.close(),...U,...oe}),[J,c,U]),pe=()=>({role:"button",tabIndex:0,"aria-label":"Close","data-focus-visible":Ne(Q),className:J.closeButton({class:c==null?void 0:c.closeButton}),...tt(K,Z)});return{Component:k,slots:J,domRef:w,headerId:L,bodyId:G,motionProps:p,classNames:c,isDismissable:v,closeButton:g,hideCloseButton:m,portalContainer:x,shouldBlockScroll:b,backdrop:(r=t.backdrop)!=null?r:"opaque",isOpen:P.isOpen,onClose:P.close,disableAnimation:T,setBodyMounted:S,setHeaderMounted:E,getDialogProps:re,getBackdropProps:le,getCloseButtonProps:pe}}var u_=Io((t,e)=>{const{children:n,...r}=t,s=Y0e({...r,ref:e}),o=Y.jsx(Mde,{disableFocusManagement:!0,portalContainer:s.portalContainer,children:n});return Y.jsx(G0e,{value:s,children:s.disableAnimation&&s.isOpen?o:Y.jsx(oM,{children:s.isOpen?o:null})})});u_.displayName="NextUI.Modal";var Q0e=u_;function Z0e(t,e,n){let[r,s]=A.useState(t||e),o=A.useRef(t!==void 0),i=t!==void 0;A.useEffect(()=>{let u=o.current;u!==i&&console.warn(`WARN: A component changed from ${u?"controlled":"uncontrolled"} to ${i?"controlled":"uncontrolled"}.`),o.current=i},[i]);let a=i?t:r,l=A.useCallback((u,...c)=>{let d=(f,...h)=>{n&&(Object.is(a,f)||n(f,...h)),i||(a=f)};typeof u=="function"?(console.warn("We can not support a function callback. See Github Issues for details https://github.com/adobe/react-spectrum/issues/2320"),s((h,...p)=>{let g=u(i?a:h,...p);return d(g,...c),i?h:g})):(i||s(u),d(u,...c))},[i,a,n]);return[a,l]}function J0e(t={}){const{id:e,defaultOpen:n,isOpen:r,onClose:s,onOpen:o,onChange:i=()=>{}}=t,a=L2(o),l=L2(s),[u,c]=Z0e(r,n||!1,i),d=A.useId(),f=e||d,h=r!==void 0,p=A.useCallback(()=>{h||c(!1),l==null||l()},[h,l]),g=A.useCallback(()=>{h||c(!0),a==null||a()},[h,a]),v=A.useCallback(()=>{(u?p:g)()},[u,g,p]);return{isOpen:!!u,onOpen:g,onClose:p,onOpenChange:v,isControlled:h,getButtonProps:(m={})=>({...m,"aria-expanded":u,"aria-controls":f,onClick:ws(m.onClick,v)}),getDisclosureProps:(m={})=>({...m,hidden:!u,id:f})}}/*!
 * cookie
 * Copyright(c) 2012-2014 Roman Shtylman
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */var c_=tve,W2=nve,eve=Object.prototype.toString,Fh=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function tve(t,e){if(typeof t!="string")throw new TypeError("argument str must be a string");for(var n={},r=e||{},s=r.decode||rve,o=0;o<t.length;){var i=t.indexOf("=",o);if(i===-1)break;var a=t.indexOf(";",o);if(a===-1)a=t.length;else if(a<i){o=t.lastIndexOf(";",i-1)+1;continue}var l=t.slice(o,i).trim();if(n[l]===void 0){var u=t.slice(i+1,a).trim();u.charCodeAt(0)===34&&(u=u.slice(1,-1)),n[l]=ive(u,s)}o=a+1}return n}function nve(t,e,n){var r=n||{},s=r.encode||sve;if(typeof s!="function")throw new TypeError("option encode is invalid");if(!Fh.test(t))throw new TypeError("argument name is invalid");var o=s(e);if(o&&!Fh.test(o))throw new TypeError("argument val is invalid");var i=t+"="+o;if(r.maxAge!=null){var a=r.maxAge-0;if(isNaN(a)||!isFinite(a))throw new TypeError("option maxAge is invalid");i+="; Max-Age="+Math.floor(a)}if(r.domain){if(!Fh.test(r.domain))throw new TypeError("option domain is invalid");i+="; Domain="+r.domain}if(r.path){if(!Fh.test(r.path))throw new TypeError("option path is invalid");i+="; Path="+r.path}if(r.expires){var l=r.expires;if(!ove(l)||isNaN(l.valueOf()))throw new TypeError("option expires is invalid");i+="; Expires="+l.toUTCString()}if(r.httpOnly&&(i+="; HttpOnly"),r.secure&&(i+="; Secure"),r.partitioned&&(i+="; Partitioned"),r.priority){var u=typeof r.priority=="string"?r.priority.toLowerCase():r.priority;switch(u){case"low":i+="; Priority=Low";break;case"medium":i+="; Priority=Medium";break;case"high":i+="; Priority=High";break;default:throw new TypeError("option priority is invalid")}}if(r.sameSite){var c=typeof r.sameSite=="string"?r.sameSite.toLowerCase():r.sameSite;switch(c){case!0:i+="; SameSite=Strict";break;case"lax":i+="; SameSite=Lax";break;case"strict":i+="; SameSite=Strict";break;case"none":i+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}}return i}function rve(t){return t.indexOf("%")!==-1?decodeURIComponent(t):t}function sve(t){return encodeURIComponent(t)}function ove(t){return eve.call(t)==="[object Date]"||t instanceof Date}function ive(t,e){try{return e(t)}catch{return t}}function ave(){const t=typeof global>"u"?void 0:global.TEST_HAS_DOCUMENT_COOKIE;return typeof t=="boolean"?t:typeof document=="object"&&typeof document.cookie=="string"}function lve(t){return typeof t=="string"?c_(t):typeof t=="object"&&t!==null?t:{}}function _v(t,e={}){const n=uve(t);if(!e.doNotParse)try{return JSON.parse(n)}catch{}return t}function uve(t){return t&&t[0]==="j"&&t[1]===":"?t.substr(2):t}class cve{constructor(e,n={}){this.changeListeners=[],this.HAS_DOCUMENT_COOKIE=!1,this.update=()=>{if(!this.HAS_DOCUMENT_COOKIE)return;const s=this.cookies;this.cookies=c_(document.cookie),this._checkChanges(s)};const r=typeof document>"u"?"":document.cookie;this.cookies=lve(e||r),this.defaultSetOptions=n,this.HAS_DOCUMENT_COOKIE=ave()}_emitChange(e){for(let n=0;n<this.changeListeners.length;++n)this.changeListeners[n](e)}_checkChanges(e){new Set(Object.keys(e).concat(Object.keys(this.cookies))).forEach(r=>{e[r]!==this.cookies[r]&&this._emitChange({name:r,value:_v(this.cookies[r])})})}_startPolling(){this.pollingInterval=setInterval(this.update,300)}_stopPolling(){this.pollingInterval&&clearInterval(this.pollingInterval)}get(e,n={}){return n.doNotUpdate||this.update(),_v(this.cookies[e],n)}getAll(e={}){e.doNotUpdate||this.update();const n={};for(let r in this.cookies)n[r]=_v(this.cookies[r],e);return n}set(e,n,r){r?r=Object.assign(Object.assign({},this.defaultSetOptions),r):r=this.defaultSetOptions;const s=typeof n=="string"?n:JSON.stringify(n);this.cookies=Object.assign(Object.assign({},this.cookies),{[e]:s}),this.HAS_DOCUMENT_COOKIE&&(document.cookie=W2(e,s,r)),this._emitChange({name:e,value:n,options:r})}remove(e,n){const r=n=Object.assign(Object.assign(Object.assign({},this.defaultSetOptions),n),{expires:new Date(1970,1,1,0,0,1),maxAge:0});this.cookies=Object.assign({},this.cookies),delete this.cookies[e],this.HAS_DOCUMENT_COOKIE&&(document.cookie=W2(e,"",r)),this._emitChange({name:e,value:void 0,options:n})}addChangeListener(e){this.changeListeners.push(e),this.HAS_DOCUMENT_COOKIE&&this.changeListeners.length===1&&(typeof window=="object"&&"cookieStore"in window?window.cookieStore.addEventListener("change",this.update):this._startPolling())}removeChangeListener(e){const n=this.changeListeners.indexOf(e);n>=0&&this.changeListeners.splice(n,1),this.HAS_DOCUMENT_COOKIE&&this.changeListeners.length===0&&(typeof window=="object"&&"cookieStore"in window?window.cookieStore.removeEventListener("change",this.update):this._stopPolling())}}const dve=A.createContext(new cve);var d_={exports:{}},Je={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var U2;function fve(){if(U2)return Je;U2=1;var t=typeof Symbol=="function"&&Symbol.for,e=t?Symbol.for("react.element"):60103,n=t?Symbol.for("react.portal"):60106,r=t?Symbol.for("react.fragment"):60107,s=t?Symbol.for("react.strict_mode"):60108,o=t?Symbol.for("react.profiler"):60114,i=t?Symbol.for("react.provider"):60109,a=t?Symbol.for("react.context"):60110,l=t?Symbol.for("react.async_mode"):60111,u=t?Symbol.for("react.concurrent_mode"):60111,c=t?Symbol.for("react.forward_ref"):60112,d=t?Symbol.for("react.suspense"):60113,f=t?Symbol.for("react.suspense_list"):60120,h=t?Symbol.for("react.memo"):60115,p=t?Symbol.for("react.lazy"):60116,g=t?Symbol.for("react.block"):60121,v=t?Symbol.for("react.fundamental"):60117,m=t?Symbol.for("react.responder"):60118,b=t?Symbol.for("react.scope"):60119;function x($){if(typeof $=="object"&&$!==null){var C=$.$$typeof;switch(C){case e:switch($=$.type,$){case l:case u:case r:case o:case s:case d:return $;default:switch($=$&&$.$$typeof,$){case a:case c:case p:case h:case i:return $;default:return C}}case n:return C}}}function y($){return x($)===u}return Je.AsyncMode=l,Je.ConcurrentMode=u,Je.ContextConsumer=a,Je.ContextProvider=i,Je.Element=e,Je.ForwardRef=c,Je.Fragment=r,Je.Lazy=p,Je.Memo=h,Je.Portal=n,Je.Profiler=o,Je.StrictMode=s,Je.Suspense=d,Je.isAsyncMode=function($){return y($)||x($)===l},Je.isConcurrentMode=y,Je.isContextConsumer=function($){return x($)===a},Je.isContextProvider=function($){return x($)===i},Je.isElement=function($){return typeof $=="object"&&$!==null&&$.$$typeof===e},Je.isForwardRef=function($){return x($)===c},Je.isFragment=function($){return x($)===r},Je.isLazy=function($){return x($)===p},Je.isMemo=function($){return x($)===h},Je.isPortal=function($){return x($)===n},Je.isProfiler=function($){return x($)===o},Je.isStrictMode=function($){return x($)===s},Je.isSuspense=function($){return x($)===d},Je.isValidElementType=function($){return typeof $=="string"||typeof $=="function"||$===r||$===u||$===o||$===s||$===d||$===f||typeof $=="object"&&$!==null&&($.$$typeof===p||$.$$typeof===h||$.$$typeof===i||$.$$typeof===a||$.$$typeof===c||$.$$typeof===v||$.$$typeof===m||$.$$typeof===b||$.$$typeof===g)},Je.typeOf=x,Je}d_.exports=fve();var hve=d_.exports,f_=hve,pve={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},mve={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},h_={};h_[f_.ForwardRef]=pve;h_[f_.Memo]=mve;function gve(){return typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"}function vve(t){const e=A.useContext(dve);if(!e)throw new Error("Missing <CookiesProvider>");const[n,r]=A.useState(()=>e.getAll({doNotUpdate:!0}));gve()&&A.useLayoutEffect(()=>{function a(){const l=e.getAll({doNotUpdate:!0});bve(t||null,l,n)&&r(l)}return e.addChangeListener(a),()=>{e.removeChangeListener(a)}},[e,n]);const s=A.useMemo(()=>e.set.bind(e),[e]),o=A.useMemo(()=>e.remove.bind(e),[e]),i=A.useMemo(()=>e.update.bind(e),[e]);return[n,s,o,i]}function bve(t,e,n){if(!t)return!0;for(let r of t)if(e[r]!==n[r])return!0;return!1}const G2=1e3,xve=(t,e)=>Y.jsxs(Y.Fragment,{children:[Y.jsx(l_,{className:"flex flex-col gap-1",children:"You Won!"}),Y.jsxs(s_,{children:[Y.jsx("p",{children:"Congratulations!"}),Y.jsxs("p",{children:["You have successfully eradicated the virus from the grid in ",t," generations."]}),Y.jsxs("p",{children:["level: ",e]})]})]}),yve=()=>Y.jsxs(Y.Fragment,{children:[Y.jsx(l_,{className:"flex flex-col gap-1",children:"You Lost!"}),Y.jsxs(s_,{children:[Y.jsx("p",{children:"Ouch!"}),Y.jsx("p",{children:"The virus has destroyed you..."})]})]}),Ph=t=>{switch(t){case _i:return"Easy";case pc:return"Medium";case mc:return"Hard";default:return"Unknown"}};function wve(){const t=A.useRef(null),e=A.useRef(null),{isOpen:n,onOpen:r,onOpenChange:s}=J0e(),o=A.useRef(null),[i,a]=vve(["difficulty"]),[l,u]=A.useState(i.difficulty||_i),[c,d]=A.useState(!1);e.current||(e.current=new sce,e.current.bindEvents()),window.gameEngine=e.current;const[f,h]=A.useState(0);e.current.onUpdateCallback=()=>{h(f+1)};const p=e.current,[g,v]=A.useState(0),m=[],b=p.grid.arraySync(),x=p.activeCells.arraySync(),y=p.virusCells.arraySync(),$=([R,S])=>{p.onCellClick([R,S])},C=R=>{o.current&&clearInterval(o.current),o.current=setInterval(()=>{p.step(),v(g+1),(p.hasWon||p.hasLost)&&r()},R)};A.useEffect(()=>(C(G2),()=>{o.current&&clearInterval(o.current)}),[e.current]);const k=R=>R>999?(R/1e3).toFixed(0)+"K":R;for(let R=0;R<p.grid.shape[0];R++){const S=[];for(let T=0;T<p.grid.shape[1];T++)S.push(Y.jsxs("td",{className:sh({active:x[R][T]===1,focused:p.focusedCell[0]===R&&p.focusedCell[1]===T,virus:y[R][T]===1}),onClick:()=>$([R,T]),children:[y[R][T]===1&&k(b[R][T]),x[R][T]===1&&k(b[R][T])]},T));m.push(Y.jsx("tr",{children:S},R))}const w=A.useCallback(()=>{var R;C(G2),(R=e.current)==null||R.resetGame()},[]),I=A.useCallback(()=>{e.current&&(e.current.virusMoveRate=1),C(10)},[]);A.useEffect(()=>{p.difficulty=l,p.resetGame(),document.querySelectorAll("table")[0].focus(),a("difficulty",l)},[l,p,t]);const N=A.useCallback(R=>{p.leaveTrail=R,d(R)},[p]);A.useEffect(()=>{const R=S=>{S.key.toLowerCase()==="t"&&N(!c)};return document.addEventListener("keydown",R),()=>{document.removeEventListener("keydown",R)}},[c,N]);const E=A.useCallback(R=>{p.trailSize=parseInt(R)},[p]);return Y.jsxs(Y.Fragment,{children:[Y.jsxs("div",{className:"top-left-bar",children:[Y.jsxs("p",{className:"generation",children:["Generation ",p.generation]}),p.stats.wasFocusedCellEaten&&Y.jsxs("p",{children:["Your active cell was eaten!",Y.jsx("br",{}),"Click one of your other cells to continue."]}),Y.jsxs("div",{className:"difficulty mt-4",children:[Y.jsx("p",{className:"mb-2",children:"Difficulty:"}),Y.jsx(Wu,{onClick:()=>u(_i),className:sh("mr-1",{selected:l==_i}),children:Ph(_i)}),Y.jsx(Wu,{onClick:()=>u(pc),className:sh("mr-1",{selected:l==pc}),children:Ph(pc)}),Y.jsx(Wu,{onClick:()=>u(mc),className:sh({selected:l==mc}),children:Ph(mc)})]}),Y.jsxs("div",{className:"leave-trail mt-4",children:[Y.jsxs(y0e,{isSelected:c,onValueChange:N,children:["Trail Wall Mode ",Y.jsx("span",{className:"keyboard-shortcut",children:"t"}),Y.jsx("br",{})]}),c&&Y.jsxs("div",{children:[Y.jsx("p",{children:"Tail size:"}),Y.jsx(L0e,{type:"number",defaultValue:p.trailSize.toString(),onValueChange:E})]}),Y.jsx("p",{className:"text-xs text-slate-500",children:"Leave trail when around virus to help slow growth."})]})]}),Y.jsx("div",{className:"top-right-bar",children:Y.jsxs("div",{className:"stats",children:[Y.jsxs("p",{children:["You: ",p.stats.activeCellCount]}),Y.jsxs("p",{children:["Virus: ",p.stats.virusCellCount]})]})}),Y.jsxs("div",{className:"bottom-left-bar",children:[Y.jsx("h2",{children:"Instructions:"}),Y.jsx("p",{children:"Use mouse to change active cell."}),Y.jsx("p",{children:"Use arrows to move around."}),Y.jsx("p",{children:"Collect numbers and use these to fight the virus."}),Y.jsx("br",{}),Y.jsx("p",{children:"Eradicate the virus to win!"}),Y.jsx("br",{}),Y.jsxs("p",{className:"text-xs",children:["Like the repo on Github:",Y.jsx("br",{}),Y.jsx("a",{href:"https://github.com/antoineMoPa/grid",target:"_blank",children:"https://github.com/antoineMoPa/grid"})]})]}),Y.jsx("div",{className:"bottom-right-bar",children:Y.jsx(Wu,{className:"surrender",onClick:I,children:"Surrender"})}),Y.jsx("table",{ref:t,children:Y.jsx("tbody",{children:m})}),Y.jsx(Y.Fragment,{children:Y.jsx(Q0e,{isOpen:n,onOpenChange:s,onClose:w,children:Y.jsx(j0e,{children:R=>Y.jsxs(Y.Fragment,{children:[p.hasWon&&xve(p.generation,Ph(l)),p.hasLost&&yve(),Y.jsx(K0e,{children:Y.jsx(Wu,{color:"primary",onPress:R,children:"Play Again"})})]})})})})]})}zv.createRoot(document.getElementById("root")).render(Y.jsx(Ze.StrictMode,{children:Y.jsx(wve,{})}));
