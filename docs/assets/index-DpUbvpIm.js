var c_=Object.defineProperty;var d_=(t,e,n)=>e in t?c_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Ft=(t,e,n)=>(d_(t,typeof e!="symbol"?e+"":e,n),n);function f_(t,e){for(var n=0;n<e.length;n++){const s=e[n];if(typeof s!="string"&&!Array.isArray(s)){for(const r in s)if(r!=="default"&&!(r in t)){const o=Object.getOwnPropertyDescriptor(s,r);o&&Object.defineProperty(t,r,o.get?o:{enumerable:!0,get:()=>s[r]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}})();var va=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function lm(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function h_(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(s){var r=Object.getOwnPropertyDescriptor(t,s);Object.defineProperty(n,s,r.get?r:{enumerable:!0,get:function(){return t[s]}})}),n}var PT={exports:{}},um={},OT={exports:{}},De={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qc=Symbol.for("react.element"),p_=Symbol.for("react.portal"),m_=Symbol.for("react.fragment"),g_=Symbol.for("react.strict_mode"),x_=Symbol.for("react.profiler"),y_=Symbol.for("react.provider"),v_=Symbol.for("react.context"),b_=Symbol.for("react.forward_ref"),w_=Symbol.for("react.suspense"),$_=Symbol.for("react.memo"),C_=Symbol.for("react.lazy"),dC=Symbol.iterator;function k_(t){return t===null||typeof t!="object"?null:(t=dC&&t[dC]||t["@@iterator"],typeof t=="function"?t:null)}var LT={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},MT=Object.assign,_T={};function Hl(t,e,n){this.props=t,this.context=e,this.refs=_T,this.updater=n||LT}Hl.prototype.isReactComponent={};Hl.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Hl.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function zT(){}zT.prototype=Hl.prototype;function Mv(t,e,n){this.props=t,this.context=e,this.refs=_T,this.updater=n||LT}var _v=Mv.prototype=new zT;_v.constructor=Mv;MT(_v,Hl.prototype);_v.isPureReactComponent=!0;var fC=Array.isArray,VT=Object.prototype.hasOwnProperty,zv={current:null},BT={key:!0,ref:!0,__self:!0,__source:!0};function WT(t,e,n){var s,r={},o=null,i=null;if(e!=null)for(s in e.ref!==void 0&&(i=e.ref),e.key!==void 0&&(o=""+e.key),e)VT.call(e,s)&&!BT.hasOwnProperty(s)&&(r[s]=e[s]);var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];r.children=l}if(t&&t.defaultProps)for(s in a=t.defaultProps,a)r[s]===void 0&&(r[s]=a[s]);return{$$typeof:qc,type:t,key:o,ref:i,props:r,_owner:zv.current}}function S_(t,e){return{$$typeof:qc,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Vv(t){return typeof t=="object"&&t!==null&&t.$$typeof===qc}function I_(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var hC=/\/+/g;function x0(t,e){return typeof t=="object"&&t!==null&&t.key!=null?I_(""+t.key):e.toString(36)}function $h(t,e,n,s,r){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var i=!1;if(t===null)i=!0;else switch(o){case"string":case"number":i=!0;break;case"object":switch(t.$$typeof){case qc:case p_:i=!0}}if(i)return i=t,r=r(i),t=s===""?"."+x0(i,0):s,fC(r)?(n="",t!=null&&(n=t.replace(hC,"$&/")+"/"),$h(r,e,n,"",function(u){return u})):r!=null&&(Vv(r)&&(r=S_(r,n+(!r.key||i&&i.key===r.key?"":(""+r.key).replace(hC,"$&/")+"/")+t)),e.push(r)),1;if(i=0,s=s===""?".":s+":",fC(t))for(var a=0;a<t.length;a++){o=t[a];var l=s+x0(o,a);i+=$h(o,e,n,l,r)}else if(l=k_(t),typeof l=="function")for(t=l.call(t),a=0;!(o=t.next()).done;)o=o.value,l=s+x0(o,a++),i+=$h(o,e,n,l,r);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return i}function Nf(t,e,n){if(t==null)return t;var s=[],r=0;return $h(t,s,"","",function(o){return e.call(n,o,r++)}),s}function T_(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Gn={current:null},Ch={transition:null},E_={ReactCurrentDispatcher:Gn,ReactCurrentBatchConfig:Ch,ReactCurrentOwner:zv};function UT(){throw Error("act(...) is not supported in production builds of React.")}De.Children={map:Nf,forEach:function(t,e,n){Nf(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Nf(t,function(){e++}),e},toArray:function(t){return Nf(t,function(e){return e})||[]},only:function(t){if(!Vv(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};De.Component=Hl;De.Fragment=m_;De.Profiler=x_;De.PureComponent=Mv;De.StrictMode=g_;De.Suspense=w_;De.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=E_;De.act=UT;De.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var s=MT({},t.props),r=t.key,o=t.ref,i=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,i=zv.current),e.key!==void 0&&(r=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)VT.call(e,l)&&!BT.hasOwnProperty(l)&&(s[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];s.children=a}return{$$typeof:qc,type:t.type,key:r,ref:o,props:s,_owner:i}};De.createContext=function(t){return t={$$typeof:v_,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:y_,_context:t},t.Consumer=t};De.createElement=WT;De.createFactory=function(t){var e=WT.bind(null,t);return e.type=t,e};De.createRef=function(){return{current:null}};De.forwardRef=function(t){return{$$typeof:b_,render:t}};De.isValidElement=Vv;De.lazy=function(t){return{$$typeof:C_,_payload:{_status:-1,_result:t},_init:T_}};De.memo=function(t,e){return{$$typeof:$_,type:t,compare:e===void 0?null:e}};De.startTransition=function(t){var e=Ch.transition;Ch.transition={};try{t()}finally{Ch.transition=e}};De.unstable_act=UT;De.useCallback=function(t,e){return Gn.current.useCallback(t,e)};De.useContext=function(t){return Gn.current.useContext(t)};De.useDebugValue=function(){};De.useDeferredValue=function(t){return Gn.current.useDeferredValue(t)};De.useEffect=function(t,e){return Gn.current.useEffect(t,e)};De.useId=function(){return Gn.current.useId()};De.useImperativeHandle=function(t,e,n){return Gn.current.useImperativeHandle(t,e,n)};De.useInsertionEffect=function(t,e){return Gn.current.useInsertionEffect(t,e)};De.useLayoutEffect=function(t,e){return Gn.current.useLayoutEffect(t,e)};De.useMemo=function(t,e){return Gn.current.useMemo(t,e)};De.useReducer=function(t,e,n){return Gn.current.useReducer(t,e,n)};De.useRef=function(t){return Gn.current.useRef(t)};De.useState=function(t){return Gn.current.useState(t)};De.useSyncExternalStore=function(t,e,n){return Gn.current.useSyncExternalStore(t,e,n)};De.useTransition=function(){return Gn.current.useTransition()};De.version="18.3.1";OT.exports=De;var D=OT.exports;const Xe=lm(D);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var N_=D,R_=Symbol.for("react.element"),A_=Symbol.for("react.fragment"),D_=Object.prototype.hasOwnProperty,F_=N_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,P_={key:!0,ref:!0,__self:!0,__source:!0};function GT(t,e,n){var s,r={},o=null,i=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(i=e.ref);for(s in e)D_.call(e,s)&&!P_.hasOwnProperty(s)&&(r[s]=e[s]);if(t&&t.defaultProps)for(s in e=t.defaultProps,e)r[s]===void 0&&(r[s]=e[s]);return{$$typeof:R_,type:t,key:o,ref:i,props:r,_owner:F_.current}}um.Fragment=A_;um.jsx=GT;um.jsxs=GT;PT.exports=um;var j=PT.exports,Ix={},HT={exports:{}},xs={},jT={exports:{}},KT={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(P,L){var G=P.length;P.push(L);e:for(;0<G;){var X=G-1>>>1,Q=P[X];if(0<r(Q,L))P[X]=L,P[G]=Q,G=X;else break e}}function n(P){return P.length===0?null:P[0]}function s(P){if(P.length===0)return null;var L=P[0],G=P.pop();if(G!==L){P[0]=G;e:for(var X=0,Q=P.length,Z=Q>>>1;X<Z;){var te=2*(X+1)-1,ee=P[te],se=te+1,le=P[se];if(0>r(ee,G))se<Q&&0>r(le,ee)?(P[X]=le,P[se]=G,X=se):(P[X]=ee,P[te]=G,X=te);else if(se<Q&&0>r(le,G))P[X]=le,P[se]=G,X=se;else break e}}return L}function r(P,L){var G=P.sortIndex-L.sortIndex;return G!==0?G:P.id-L.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var i=Date,a=i.now();t.unstable_now=function(){return i.now()-a}}var l=[],u=[],c=1,d=null,f=3,h=!1,p=!1,g=!1,y=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(P){for(var L=n(u);L!==null;){if(L.callback===null)s(u);else if(L.startTime<=P)s(u),L.sortIndex=L.expirationTime,e(l,L);else break;L=n(u)}}function b(P){if(g=!1,v(P),!p)if(n(l)!==null)p=!0,M($);else{var L=n(u);L!==null&&U(b,L.startTime-P)}}function $(P,L){p=!1,g&&(g=!1,m(w),w=-1),h=!0;var G=f;try{for(v(L),d=n(l);d!==null&&(!(d.expirationTime>L)||P&&!E());){var X=d.callback;if(typeof X=="function"){d.callback=null,f=d.priorityLevel;var Q=X(d.expirationTime<=L);L=t.unstable_now(),typeof Q=="function"?d.callback=Q:d===n(l)&&s(l),v(L)}else s(l);d=n(l)}if(d!==null)var Z=!0;else{var te=n(u);te!==null&&U(b,te.startTime-L),Z=!1}return Z}finally{d=null,f=G,h=!1}}var C=!1,k=null,w=-1,I=5,R=-1;function E(){return!(t.unstable_now()-R<I)}function A(){if(k!==null){var P=t.unstable_now();R=P;var L=!0;try{L=k(!0,P)}finally{L?S():(C=!1,k=null)}}else C=!1}var S;if(typeof x=="function")S=function(){x(A)};else if(typeof MessageChannel<"u"){var T=new MessageChannel,F=T.port2;T.port1.onmessage=A,S=function(){F.postMessage(null)}}else S=function(){y(A,0)};function M(P){k=P,C||(C=!0,S())}function U(P,L){w=y(function(){P(t.unstable_now())},L)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(P){P.callback=null},t.unstable_continueExecution=function(){p||h||(p=!0,M($))},t.unstable_forceFrameRate=function(P){0>P||125<P?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<P?Math.floor(1e3/P):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(P){switch(f){case 1:case 2:case 3:var L=3;break;default:L=f}var G=f;f=L;try{return P()}finally{f=G}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(P,L){switch(P){case 1:case 2:case 3:case 4:case 5:break;default:P=3}var G=f;f=P;try{return L()}finally{f=G}},t.unstable_scheduleCallback=function(P,L,G){var X=t.unstable_now();switch(typeof G=="object"&&G!==null?(G=G.delay,G=typeof G=="number"&&0<G?X+G:X):G=X,P){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=G+Q,P={id:c++,callback:L,priorityLevel:P,startTime:G,expirationTime:Q,sortIndex:-1},G>X?(P.sortIndex=G,e(u,P),n(l)===null&&P===n(u)&&(g?(m(w),w=-1):g=!0,U(b,G-X))):(P.sortIndex=Q,e(l,P),p||h||(p=!0,M($))),P},t.unstable_shouldYield=E,t.unstable_wrapCallback=function(P){var L=f;return function(){var G=f;f=L;try{return P.apply(this,arguments)}finally{f=G}}}})(KT);jT.exports=KT;var O_=jT.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var L_=D,ms=O_;function re(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var XT=new Set,mc={};function ba(t,e){kl(t,e),kl(t+"Capture",e)}function kl(t,e){for(mc[t]=e,t=0;t<e.length;t++)XT.add(e[t])}var oo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Tx=Object.prototype.hasOwnProperty,M_=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,pC={},mC={};function __(t){return Tx.call(mC,t)?!0:Tx.call(pC,t)?!1:M_.test(t)?mC[t]=!0:(pC[t]=!0,!1)}function z_(t,e,n,s){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return s?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function V_(t,e,n,s){if(e===null||typeof e>"u"||z_(t,e,n,s))return!0;if(s)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Hn(t,e,n,s,r,o,i){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=s,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=i}var fn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){fn[t]=new Hn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];fn[e]=new Hn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){fn[t]=new Hn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){fn[t]=new Hn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){fn[t]=new Hn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){fn[t]=new Hn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){fn[t]=new Hn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){fn[t]=new Hn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){fn[t]=new Hn(t,5,!1,t.toLowerCase(),null,!1,!1)});var Bv=/[\-:]([a-z])/g;function Wv(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Bv,Wv);fn[e]=new Hn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Bv,Wv);fn[e]=new Hn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Bv,Wv);fn[e]=new Hn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){fn[t]=new Hn(t,1,!1,t.toLowerCase(),null,!1,!1)});fn.xlinkHref=new Hn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){fn[t]=new Hn(t,1,!1,t.toLowerCase(),null,!0,!0)});function Uv(t,e,n,s){var r=fn.hasOwnProperty(e)?fn[e]:null;(r!==null?r.type!==0:s||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(V_(e,n,r,s)&&(n=null),s||r===null?__(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=n===null?r.type===3?!1:"":n:(e=r.attributeName,s=r.attributeNamespace,n===null?t.removeAttribute(e):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,s?t.setAttributeNS(s,e,n):t.setAttribute(e,n))))}var mo=L_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Rf=Symbol.for("react.element"),Xa=Symbol.for("react.portal"),qa=Symbol.for("react.fragment"),Gv=Symbol.for("react.strict_mode"),Ex=Symbol.for("react.profiler"),qT=Symbol.for("react.provider"),YT=Symbol.for("react.context"),Hv=Symbol.for("react.forward_ref"),Nx=Symbol.for("react.suspense"),Rx=Symbol.for("react.suspense_list"),jv=Symbol.for("react.memo"),Eo=Symbol.for("react.lazy"),QT=Symbol.for("react.offscreen"),gC=Symbol.iterator;function yu(t){return t===null||typeof t!="object"?null:(t=gC&&t[gC]||t["@@iterator"],typeof t=="function"?t:null)}var Ct=Object.assign,y0;function Ou(t){if(y0===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);y0=e&&e[1]||""}return`
`+y0+t}var v0=!1;function b0(t,e){if(!t||v0)return"";v0=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var s=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){s=u}t.call(e.prototype)}else{try{throw Error()}catch(u){s=u}t()}}catch(u){if(u&&s&&typeof u.stack=="string"){for(var r=u.stack.split(`
`),o=s.stack.split(`
`),i=r.length-1,a=o.length-1;1<=i&&0<=a&&r[i]!==o[a];)a--;for(;1<=i&&0<=a;i--,a--)if(r[i]!==o[a]){if(i!==1||a!==1)do if(i--,a--,0>a||r[i]!==o[a]){var l=`
`+r[i].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=i&&0<=a);break}}}finally{v0=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Ou(t):""}function B_(t){switch(t.tag){case 5:return Ou(t.type);case 16:return Ou("Lazy");case 13:return Ou("Suspense");case 19:return Ou("SuspenseList");case 0:case 2:case 15:return t=b0(t.type,!1),t;case 11:return t=b0(t.type.render,!1),t;case 1:return t=b0(t.type,!0),t;default:return""}}function Ax(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case qa:return"Fragment";case Xa:return"Portal";case Ex:return"Profiler";case Gv:return"StrictMode";case Nx:return"Suspense";case Rx:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case YT:return(t.displayName||"Context")+".Consumer";case qT:return(t._context.displayName||"Context")+".Provider";case Hv:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case jv:return e=t.displayName||null,e!==null?e:Ax(t.type)||"Memo";case Eo:e=t._payload,t=t._init;try{return Ax(t(e))}catch{}}return null}function W_(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ax(e);case 8:return e===Gv?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Jo(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function ZT(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function U_(t){var e=ZT(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),s=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(i){s=""+i,o.call(this,i)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(i){s=""+i},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Af(t){t._valueTracker||(t._valueTracker=U_(t))}function JT(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),s="";return t&&(s=ZT(t)?t.checked?"true":"false":t.value),t=s,t!==n?(e.setValue(t),!0):!1}function Vh(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Dx(t,e){var n=e.checked;return Ct({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function xC(t,e){var n=e.defaultValue==null?"":e.defaultValue,s=e.checked!=null?e.checked:e.defaultChecked;n=Jo(e.value!=null?e.value:n),t._wrapperState={initialChecked:s,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function e2(t,e){e=e.checked,e!=null&&Uv(t,"checked",e,!1)}function Fx(t,e){e2(t,e);var n=Jo(e.value),s=e.type;if(n!=null)s==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(s==="submit"||s==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Px(t,e.type,n):e.hasOwnProperty("defaultValue")&&Px(t,e.type,Jo(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function yC(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!(s!=="submit"&&s!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Px(t,e,n){(e!=="number"||Vh(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Lu=Array.isArray;function dl(t,e,n,s){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&s&&(t[n].defaultSelected=!0)}else{for(n=""+Jo(n),e=null,r=0;r<t.length;r++){if(t[r].value===n){t[r].selected=!0,s&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function Ox(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(re(91));return Ct({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function vC(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(re(92));if(Lu(n)){if(1<n.length)throw Error(re(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Jo(n)}}function t2(t,e){var n=Jo(e.value),s=Jo(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),s!=null&&(t.defaultValue=""+s)}function bC(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function n2(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Lx(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?n2(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Df,s2=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,s,r){MSApp.execUnsafeLocalFunction(function(){return t(e,n,s,r)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Df=Df||document.createElement("div"),Df.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Df.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function gc(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var qu={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},G_=["Webkit","ms","Moz","O"];Object.keys(qu).forEach(function(t){G_.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),qu[e]=qu[t]})});function r2(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||qu.hasOwnProperty(t)&&qu[t]?(""+e).trim():e+"px"}function o2(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var s=n.indexOf("--")===0,r=r2(n,e[n],s);n==="float"&&(n="cssFloat"),s?t.setProperty(n,r):t[n]=r}}var H_=Ct({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Mx(t,e){if(e){if(H_[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(re(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(re(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(re(61))}if(e.style!=null&&typeof e.style!="object")throw Error(re(62))}}function _x(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var zx=null;function Kv(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Vx=null,fl=null,hl=null;function wC(t){if(t=Zc(t)){if(typeof Vx!="function")throw Error(re(280));var e=t.stateNode;e&&(e=pm(e),Vx(t.stateNode,t.type,e))}}function i2(t){fl?hl?hl.push(t):hl=[t]:fl=t}function a2(){if(fl){var t=fl,e=hl;if(hl=fl=null,wC(t),e)for(t=0;t<e.length;t++)wC(e[t])}}function l2(t,e){return t(e)}function u2(){}var w0=!1;function c2(t,e,n){if(w0)return t(e,n);w0=!0;try{return l2(t,e,n)}finally{w0=!1,(fl!==null||hl!==null)&&(u2(),a2())}}function xc(t,e){var n=t.stateNode;if(n===null)return null;var s=pm(n);if(s===null)return null;n=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(t=t.type,s=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!s;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(re(231,e,typeof n));return n}var Bx=!1;if(oo)try{var vu={};Object.defineProperty(vu,"passive",{get:function(){Bx=!0}}),window.addEventListener("test",vu,vu),window.removeEventListener("test",vu,vu)}catch{Bx=!1}function j_(t,e,n,s,r,o,i,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(c){this.onError(c)}}var Yu=!1,Bh=null,Wh=!1,Wx=null,K_={onError:function(t){Yu=!0,Bh=t}};function X_(t,e,n,s,r,o,i,a,l){Yu=!1,Bh=null,j_.apply(K_,arguments)}function q_(t,e,n,s,r,o,i,a,l){if(X_.apply(this,arguments),Yu){if(Yu){var u=Bh;Yu=!1,Bh=null}else throw Error(re(198));Wh||(Wh=!0,Wx=u)}}function wa(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function d2(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function $C(t){if(wa(t)!==t)throw Error(re(188))}function Y_(t){var e=t.alternate;if(!e){if(e=wa(t),e===null)throw Error(re(188));return e!==t?null:t}for(var n=t,s=e;;){var r=n.return;if(r===null)break;var o=r.alternate;if(o===null){if(s=r.return,s!==null){n=s;continue}break}if(r.child===o.child){for(o=r.child;o;){if(o===n)return $C(r),t;if(o===s)return $C(r),e;o=o.sibling}throw Error(re(188))}if(n.return!==s.return)n=r,s=o;else{for(var i=!1,a=r.child;a;){if(a===n){i=!0,n=r,s=o;break}if(a===s){i=!0,s=r,n=o;break}a=a.sibling}if(!i){for(a=o.child;a;){if(a===n){i=!0,n=o,s=r;break}if(a===s){i=!0,s=o,n=r;break}a=a.sibling}if(!i)throw Error(re(189))}}if(n.alternate!==s)throw Error(re(190))}if(n.tag!==3)throw Error(re(188));return n.stateNode.current===n?t:e}function f2(t){return t=Y_(t),t!==null?h2(t):null}function h2(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=h2(t);if(e!==null)return e;t=t.sibling}return null}var p2=ms.unstable_scheduleCallback,CC=ms.unstable_cancelCallback,Q_=ms.unstable_shouldYield,Z_=ms.unstable_requestPaint,Pt=ms.unstable_now,J_=ms.unstable_getCurrentPriorityLevel,Xv=ms.unstable_ImmediatePriority,m2=ms.unstable_UserBlockingPriority,Uh=ms.unstable_NormalPriority,e4=ms.unstable_LowPriority,g2=ms.unstable_IdlePriority,cm=null,Tr=null;function t4(t){if(Tr&&typeof Tr.onCommitFiberRoot=="function")try{Tr.onCommitFiberRoot(cm,t,void 0,(t.current.flags&128)===128)}catch{}}var rr=Math.clz32?Math.clz32:r4,n4=Math.log,s4=Math.LN2;function r4(t){return t>>>=0,t===0?32:31-(n4(t)/s4|0)|0}var Ff=64,Pf=4194304;function Mu(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Gh(t,e){var n=t.pendingLanes;if(n===0)return 0;var s=0,r=t.suspendedLanes,o=t.pingedLanes,i=n&268435455;if(i!==0){var a=i&~r;a!==0?s=Mu(a):(o&=i,o!==0&&(s=Mu(o)))}else i=n&~r,i!==0?s=Mu(i):o!==0&&(s=Mu(o));if(s===0)return 0;if(e!==0&&e!==s&&!(e&r)&&(r=s&-s,o=e&-e,r>=o||r===16&&(o&4194240)!==0))return e;if(s&4&&(s|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=s;0<e;)n=31-rr(e),r=1<<n,s|=t[n],e&=~r;return s}function o4(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function i4(t,e){for(var n=t.suspendedLanes,s=t.pingedLanes,r=t.expirationTimes,o=t.pendingLanes;0<o;){var i=31-rr(o),a=1<<i,l=r[i];l===-1?(!(a&n)||a&s)&&(r[i]=o4(a,e)):l<=e&&(t.expiredLanes|=a),o&=~a}}function Ux(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function x2(){var t=Ff;return Ff<<=1,!(Ff&4194240)&&(Ff=64),t}function $0(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Yc(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-rr(e),t[e]=n}function a4(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var s=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-rr(n),o=1<<r;e[r]=0,s[r]=-1,t[r]=-1,n&=~o}}function qv(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var s=31-rr(n),r=1<<s;r&e|t[s]&e&&(t[s]|=e),n&=~r}}var Ze=0;function y2(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var v2,Yv,b2,w2,$2,Gx=!1,Of=[],zo=null,Vo=null,Bo=null,yc=new Map,vc=new Map,Ao=[],l4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function kC(t,e){switch(t){case"focusin":case"focusout":zo=null;break;case"dragenter":case"dragleave":Vo=null;break;case"mouseover":case"mouseout":Bo=null;break;case"pointerover":case"pointerout":yc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":vc.delete(e.pointerId)}}function bu(t,e,n,s,r,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:s,nativeEvent:o,targetContainers:[r]},e!==null&&(e=Zc(e),e!==null&&Yv(e)),t):(t.eventSystemFlags|=s,e=t.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),t)}function u4(t,e,n,s,r){switch(e){case"focusin":return zo=bu(zo,t,e,n,s,r),!0;case"dragenter":return Vo=bu(Vo,t,e,n,s,r),!0;case"mouseover":return Bo=bu(Bo,t,e,n,s,r),!0;case"pointerover":var o=r.pointerId;return yc.set(o,bu(yc.get(o)||null,t,e,n,s,r)),!0;case"gotpointercapture":return o=r.pointerId,vc.set(o,bu(vc.get(o)||null,t,e,n,s,r)),!0}return!1}function C2(t){var e=Ri(t.target);if(e!==null){var n=wa(e);if(n!==null){if(e=n.tag,e===13){if(e=d2(n),e!==null){t.blockedOn=e,$2(t.priority,function(){b2(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function kh(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Hx(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var s=new n.constructor(n.type,n);zx=s,n.target.dispatchEvent(s),zx=null}else return e=Zc(n),e!==null&&Yv(e),t.blockedOn=n,!1;e.shift()}return!0}function SC(t,e,n){kh(t)&&n.delete(e)}function c4(){Gx=!1,zo!==null&&kh(zo)&&(zo=null),Vo!==null&&kh(Vo)&&(Vo=null),Bo!==null&&kh(Bo)&&(Bo=null),yc.forEach(SC),vc.forEach(SC)}function wu(t,e){t.blockedOn===e&&(t.blockedOn=null,Gx||(Gx=!0,ms.unstable_scheduleCallback(ms.unstable_NormalPriority,c4)))}function bc(t){function e(r){return wu(r,t)}if(0<Of.length){wu(Of[0],t);for(var n=1;n<Of.length;n++){var s=Of[n];s.blockedOn===t&&(s.blockedOn=null)}}for(zo!==null&&wu(zo,t),Vo!==null&&wu(Vo,t),Bo!==null&&wu(Bo,t),yc.forEach(e),vc.forEach(e),n=0;n<Ao.length;n++)s=Ao[n],s.blockedOn===t&&(s.blockedOn=null);for(;0<Ao.length&&(n=Ao[0],n.blockedOn===null);)C2(n),n.blockedOn===null&&Ao.shift()}var pl=mo.ReactCurrentBatchConfig,Hh=!0;function d4(t,e,n,s){var r=Ze,o=pl.transition;pl.transition=null;try{Ze=1,Qv(t,e,n,s)}finally{Ze=r,pl.transition=o}}function f4(t,e,n,s){var r=Ze,o=pl.transition;pl.transition=null;try{Ze=4,Qv(t,e,n,s)}finally{Ze=r,pl.transition=o}}function Qv(t,e,n,s){if(Hh){var r=Hx(t,e,n,s);if(r===null)D0(t,e,s,jh,n),kC(t,s);else if(u4(r,t,e,n,s))s.stopPropagation();else if(kC(t,s),e&4&&-1<l4.indexOf(t)){for(;r!==null;){var o=Zc(r);if(o!==null&&v2(o),o=Hx(t,e,n,s),o===null&&D0(t,e,s,jh,n),o===r)break;r=o}r!==null&&s.stopPropagation()}else D0(t,e,s,null,n)}}var jh=null;function Hx(t,e,n,s){if(jh=null,t=Kv(s),t=Ri(t),t!==null)if(e=wa(t),e===null)t=null;else if(n=e.tag,n===13){if(t=d2(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return jh=t,null}function k2(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(J_()){case Xv:return 1;case m2:return 4;case Uh:case e4:return 16;case g2:return 536870912;default:return 16}default:return 16}}var Fo=null,Zv=null,Sh=null;function S2(){if(Sh)return Sh;var t,e=Zv,n=e.length,s,r="value"in Fo?Fo.value:Fo.textContent,o=r.length;for(t=0;t<n&&e[t]===r[t];t++);var i=n-t;for(s=1;s<=i&&e[n-s]===r[o-s];s++);return Sh=r.slice(t,1<s?1-s:void 0)}function Ih(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Lf(){return!0}function IC(){return!1}function ys(t){function e(n,s,r,o,i){this._reactName=n,this._targetInst=r,this.type=s,this.nativeEvent=o,this.target=i,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(o):o[a]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?Lf:IC,this.isPropagationStopped=IC,this}return Ct(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Lf)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Lf)},persist:function(){},isPersistent:Lf}),e}var jl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Jv=ys(jl),Qc=Ct({},jl,{view:0,detail:0}),h4=ys(Qc),C0,k0,$u,dm=Ct({},Qc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:eb,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==$u&&($u&&t.type==="mousemove"?(C0=t.screenX-$u.screenX,k0=t.screenY-$u.screenY):k0=C0=0,$u=t),C0)},movementY:function(t){return"movementY"in t?t.movementY:k0}}),TC=ys(dm),p4=Ct({},dm,{dataTransfer:0}),m4=ys(p4),g4=Ct({},Qc,{relatedTarget:0}),S0=ys(g4),x4=Ct({},jl,{animationName:0,elapsedTime:0,pseudoElement:0}),y4=ys(x4),v4=Ct({},jl,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),b4=ys(v4),w4=Ct({},jl,{data:0}),EC=ys(w4),$4={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},C4={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},k4={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function S4(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=k4[t])?!!e[t]:!1}function eb(){return S4}var I4=Ct({},Qc,{key:function(t){if(t.key){var e=$4[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Ih(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?C4[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:eb,charCode:function(t){return t.type==="keypress"?Ih(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Ih(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),T4=ys(I4),E4=Ct({},dm,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),NC=ys(E4),N4=Ct({},Qc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:eb}),R4=ys(N4),A4=Ct({},jl,{propertyName:0,elapsedTime:0,pseudoElement:0}),D4=ys(A4),F4=Ct({},dm,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),P4=ys(F4),O4=[9,13,27,32],tb=oo&&"CompositionEvent"in window,Qu=null;oo&&"documentMode"in document&&(Qu=document.documentMode);var L4=oo&&"TextEvent"in window&&!Qu,I2=oo&&(!tb||Qu&&8<Qu&&11>=Qu),RC=" ",AC=!1;function T2(t,e){switch(t){case"keyup":return O4.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function E2(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ya=!1;function M4(t,e){switch(t){case"compositionend":return E2(e);case"keypress":return e.which!==32?null:(AC=!0,RC);case"textInput":return t=e.data,t===RC&&AC?null:t;default:return null}}function _4(t,e){if(Ya)return t==="compositionend"||!tb&&T2(t,e)?(t=S2(),Sh=Zv=Fo=null,Ya=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return I2&&e.locale!=="ko"?null:e.data;default:return null}}var z4={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function DC(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!z4[t.type]:e==="textarea"}function N2(t,e,n,s){i2(s),e=Kh(e,"onChange"),0<e.length&&(n=new Jv("onChange","change",null,n,s),t.push({event:n,listeners:e}))}var Zu=null,wc=null;function V4(t){V2(t,0)}function fm(t){var e=Ja(t);if(JT(e))return t}function B4(t,e){if(t==="change")return e}var R2=!1;if(oo){var I0;if(oo){var T0="oninput"in document;if(!T0){var FC=document.createElement("div");FC.setAttribute("oninput","return;"),T0=typeof FC.oninput=="function"}I0=T0}else I0=!1;R2=I0&&(!document.documentMode||9<document.documentMode)}function PC(){Zu&&(Zu.detachEvent("onpropertychange",A2),wc=Zu=null)}function A2(t){if(t.propertyName==="value"&&fm(wc)){var e=[];N2(e,wc,t,Kv(t)),c2(V4,e)}}function W4(t,e,n){t==="focusin"?(PC(),Zu=e,wc=n,Zu.attachEvent("onpropertychange",A2)):t==="focusout"&&PC()}function U4(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return fm(wc)}function G4(t,e){if(t==="click")return fm(e)}function H4(t,e){if(t==="input"||t==="change")return fm(e)}function j4(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ur=typeof Object.is=="function"?Object.is:j4;function $c(t,e){if(ur(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),s=Object.keys(e);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var r=n[s];if(!Tx.call(e,r)||!ur(t[r],e[r]))return!1}return!0}function OC(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function LC(t,e){var n=OC(t);t=0;for(var s;n;){if(n.nodeType===3){if(s=t+n.textContent.length,t<=e&&s>=e)return{node:n,offset:e-t};t=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=OC(n)}}function D2(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?D2(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function F2(){for(var t=window,e=Vh();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Vh(t.document)}return e}function nb(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function K4(t){var e=F2(),n=t.focusedElem,s=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&D2(n.ownerDocument.documentElement,n)){if(s!==null&&nb(n)){if(e=s.start,t=s.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var r=n.textContent.length,o=Math.min(s.start,r);s=s.end===void 0?o:Math.min(s.end,r),!t.extend&&o>s&&(r=s,s=o,o=r),r=LC(n,o);var i=LC(n,s);r&&i&&(t.rangeCount!==1||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==i.node||t.focusOffset!==i.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),t.removeAllRanges(),o>s?(t.addRange(e),t.extend(i.node,i.offset)):(e.setEnd(i.node,i.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var X4=oo&&"documentMode"in document&&11>=document.documentMode,Qa=null,jx=null,Ju=null,Kx=!1;function MC(t,e,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Kx||Qa==null||Qa!==Vh(s)||(s=Qa,"selectionStart"in s&&nb(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),Ju&&$c(Ju,s)||(Ju=s,s=Kh(jx,"onSelect"),0<s.length&&(e=new Jv("onSelect","select",null,e,n),t.push({event:e,listeners:s}),e.target=Qa)))}function Mf(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Za={animationend:Mf("Animation","AnimationEnd"),animationiteration:Mf("Animation","AnimationIteration"),animationstart:Mf("Animation","AnimationStart"),transitionend:Mf("Transition","TransitionEnd")},E0={},P2={};oo&&(P2=document.createElement("div").style,"AnimationEvent"in window||(delete Za.animationend.animation,delete Za.animationiteration.animation,delete Za.animationstart.animation),"TransitionEvent"in window||delete Za.transitionend.transition);function hm(t){if(E0[t])return E0[t];if(!Za[t])return t;var e=Za[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in P2)return E0[t]=e[n];return t}var O2=hm("animationend"),L2=hm("animationiteration"),M2=hm("animationstart"),_2=hm("transitionend"),z2=new Map,_C="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ai(t,e){z2.set(t,e),ba(e,[t])}for(var N0=0;N0<_C.length;N0++){var R0=_C[N0],q4=R0.toLowerCase(),Y4=R0[0].toUpperCase()+R0.slice(1);ai(q4,"on"+Y4)}ai(O2,"onAnimationEnd");ai(L2,"onAnimationIteration");ai(M2,"onAnimationStart");ai("dblclick","onDoubleClick");ai("focusin","onFocus");ai("focusout","onBlur");ai(_2,"onTransitionEnd");kl("onMouseEnter",["mouseout","mouseover"]);kl("onMouseLeave",["mouseout","mouseover"]);kl("onPointerEnter",["pointerout","pointerover"]);kl("onPointerLeave",["pointerout","pointerover"]);ba("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ba("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ba("onBeforeInput",["compositionend","keypress","textInput","paste"]);ba("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ba("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ba("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var _u="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Q4=new Set("cancel close invalid load scroll toggle".split(" ").concat(_u));function zC(t,e,n){var s=t.type||"unknown-event";t.currentTarget=n,q_(s,e,void 0,t),t.currentTarget=null}function V2(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var s=t[n],r=s.event;s=s.listeners;e:{var o=void 0;if(e)for(var i=s.length-1;0<=i;i--){var a=s[i],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==o&&r.isPropagationStopped())break e;zC(r,a,u),o=l}else for(i=0;i<s.length;i++){if(a=s[i],l=a.instance,u=a.currentTarget,a=a.listener,l!==o&&r.isPropagationStopped())break e;zC(r,a,u),o=l}}}if(Wh)throw t=Wx,Wh=!1,Wx=null,t}function ft(t,e){var n=e[Zx];n===void 0&&(n=e[Zx]=new Set);var s=t+"__bubble";n.has(s)||(B2(e,t,2,!1),n.add(s))}function A0(t,e,n){var s=0;e&&(s|=4),B2(n,t,s,e)}var _f="_reactListening"+Math.random().toString(36).slice(2);function Cc(t){if(!t[_f]){t[_f]=!0,XT.forEach(function(n){n!=="selectionchange"&&(Q4.has(n)||A0(n,!1,t),A0(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[_f]||(e[_f]=!0,A0("selectionchange",!1,e))}}function B2(t,e,n,s){switch(k2(e)){case 1:var r=d4;break;case 4:r=f4;break;default:r=Qv}n=r.bind(null,e,n,t),r=void 0,!Bx||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),s?r!==void 0?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):r!==void 0?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function D0(t,e,n,s,r){var o=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var i=s.tag;if(i===3||i===4){var a=s.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(i===4)for(i=s.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;i=i.return}for(;a!==null;){if(i=Ri(a),i===null)return;if(l=i.tag,l===5||l===6){s=o=i;continue e}a=a.parentNode}}s=s.return}c2(function(){var u=o,c=Kv(n),d=[];e:{var f=z2.get(t);if(f!==void 0){var h=Jv,p=t;switch(t){case"keypress":if(Ih(n)===0)break e;case"keydown":case"keyup":h=T4;break;case"focusin":p="focus",h=S0;break;case"focusout":p="blur",h=S0;break;case"beforeblur":case"afterblur":h=S0;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=TC;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=m4;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=R4;break;case O2:case L2:case M2:h=y4;break;case _2:h=D4;break;case"scroll":h=h4;break;case"wheel":h=P4;break;case"copy":case"cut":case"paste":h=b4;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=NC}var g=(e&4)!==0,y=!g&&t==="scroll",m=g?f!==null?f+"Capture":null:f;g=[];for(var x=u,v;x!==null;){v=x;var b=v.stateNode;if(v.tag===5&&b!==null&&(v=b,m!==null&&(b=xc(x,m),b!=null&&g.push(kc(x,b,v)))),y)break;x=x.return}0<g.length&&(f=new h(f,p,null,n,c),d.push({event:f,listeners:g}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",h=t==="mouseout"||t==="pointerout",f&&n!==zx&&(p=n.relatedTarget||n.fromElement)&&(Ri(p)||p[io]))break e;if((h||f)&&(f=c.window===c?c:(f=c.ownerDocument)?f.defaultView||f.parentWindow:window,h?(p=n.relatedTarget||n.toElement,h=u,p=p?Ri(p):null,p!==null&&(y=wa(p),p!==y||p.tag!==5&&p.tag!==6)&&(p=null)):(h=null,p=u),h!==p)){if(g=TC,b="onMouseLeave",m="onMouseEnter",x="mouse",(t==="pointerout"||t==="pointerover")&&(g=NC,b="onPointerLeave",m="onPointerEnter",x="pointer"),y=h==null?f:Ja(h),v=p==null?f:Ja(p),f=new g(b,x+"leave",h,n,c),f.target=y,f.relatedTarget=v,b=null,Ri(c)===u&&(g=new g(m,x+"enter",p,n,c),g.target=v,g.relatedTarget=y,b=g),y=b,h&&p)t:{for(g=h,m=p,x=0,v=g;v;v=La(v))x++;for(v=0,b=m;b;b=La(b))v++;for(;0<x-v;)g=La(g),x--;for(;0<v-x;)m=La(m),v--;for(;x--;){if(g===m||m!==null&&g===m.alternate)break t;g=La(g),m=La(m)}g=null}else g=null;h!==null&&VC(d,f,h,g,!1),p!==null&&y!==null&&VC(d,y,p,g,!0)}}e:{if(f=u?Ja(u):window,h=f.nodeName&&f.nodeName.toLowerCase(),h==="select"||h==="input"&&f.type==="file")var $=B4;else if(DC(f))if(R2)$=H4;else{$=U4;var C=W4}else(h=f.nodeName)&&h.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&($=G4);if($&&($=$(t,u))){N2(d,$,n,c);break e}C&&C(t,f,u),t==="focusout"&&(C=f._wrapperState)&&C.controlled&&f.type==="number"&&Px(f,"number",f.value)}switch(C=u?Ja(u):window,t){case"focusin":(DC(C)||C.contentEditable==="true")&&(Qa=C,jx=u,Ju=null);break;case"focusout":Ju=jx=Qa=null;break;case"mousedown":Kx=!0;break;case"contextmenu":case"mouseup":case"dragend":Kx=!1,MC(d,n,c);break;case"selectionchange":if(X4)break;case"keydown":case"keyup":MC(d,n,c)}var k;if(tb)e:{switch(t){case"compositionstart":var w="onCompositionStart";break e;case"compositionend":w="onCompositionEnd";break e;case"compositionupdate":w="onCompositionUpdate";break e}w=void 0}else Ya?T2(t,n)&&(w="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(w="onCompositionStart");w&&(I2&&n.locale!=="ko"&&(Ya||w!=="onCompositionStart"?w==="onCompositionEnd"&&Ya&&(k=S2()):(Fo=c,Zv="value"in Fo?Fo.value:Fo.textContent,Ya=!0)),C=Kh(u,w),0<C.length&&(w=new EC(w,t,null,n,c),d.push({event:w,listeners:C}),k?w.data=k:(k=E2(n),k!==null&&(w.data=k)))),(k=L4?M4(t,n):_4(t,n))&&(u=Kh(u,"onBeforeInput"),0<u.length&&(c=new EC("onBeforeInput","beforeinput",null,n,c),d.push({event:c,listeners:u}),c.data=k))}V2(d,e)})}function kc(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Kh(t,e){for(var n=e+"Capture",s=[];t!==null;){var r=t,o=r.stateNode;r.tag===5&&o!==null&&(r=o,o=xc(t,n),o!=null&&s.unshift(kc(t,o,r)),o=xc(t,e),o!=null&&s.push(kc(t,o,r))),t=t.return}return s}function La(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function VC(t,e,n,s,r){for(var o=e._reactName,i=[];n!==null&&n!==s;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===s)break;a.tag===5&&u!==null&&(a=u,r?(l=xc(n,o),l!=null&&i.unshift(kc(n,l,a))):r||(l=xc(n,o),l!=null&&i.push(kc(n,l,a)))),n=n.return}i.length!==0&&t.push({event:e,listeners:i})}var Z4=/\r\n?/g,J4=/\u0000|\uFFFD/g;function BC(t){return(typeof t=="string"?t:""+t).replace(Z4,`
`).replace(J4,"")}function zf(t,e,n){if(e=BC(e),BC(t)!==e&&n)throw Error(re(425))}function Xh(){}var Xx=null,qx=null;function Yx(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Qx=typeof setTimeout=="function"?setTimeout:void 0,ez=typeof clearTimeout=="function"?clearTimeout:void 0,WC=typeof Promise=="function"?Promise:void 0,tz=typeof queueMicrotask=="function"?queueMicrotask:typeof WC<"u"?function(t){return WC.resolve(null).then(t).catch(nz)}:Qx;function nz(t){setTimeout(function(){throw t})}function F0(t,e){var n=e,s=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(s===0){t.removeChild(r),bc(e);return}s--}else n!=="$"&&n!=="$?"&&n!=="$!"||s++;n=r}while(n);bc(e)}function Wo(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function UC(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Kl=Math.random().toString(36).slice(2),Sr="__reactFiber$"+Kl,Sc="__reactProps$"+Kl,io="__reactContainer$"+Kl,Zx="__reactEvents$"+Kl,sz="__reactListeners$"+Kl,rz="__reactHandles$"+Kl;function Ri(t){var e=t[Sr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[io]||n[Sr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=UC(t);t!==null;){if(n=t[Sr])return n;t=UC(t)}return e}t=n,n=t.parentNode}return null}function Zc(t){return t=t[Sr]||t[io],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ja(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(re(33))}function pm(t){return t[Sc]||null}var Jx=[],el=-1;function li(t){return{current:t}}function ht(t){0>el||(t.current=Jx[el],Jx[el]=null,el--)}function it(t,e){el++,Jx[el]=t.current,t.current=e}var ei={},Nn=li(ei),Jn=li(!1),Xi=ei;function Sl(t,e){var n=t.type.contextTypes;if(!n)return ei;var s=t.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var r={},o;for(o in n)r[o]=e[o];return s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function es(t){return t=t.childContextTypes,t!=null}function qh(){ht(Jn),ht(Nn)}function GC(t,e,n){if(Nn.current!==ei)throw Error(re(168));it(Nn,e),it(Jn,n)}function W2(t,e,n){var s=t.stateNode;if(e=e.childContextTypes,typeof s.getChildContext!="function")return n;s=s.getChildContext();for(var r in s)if(!(r in e))throw Error(re(108,W_(t)||"Unknown",r));return Ct({},n,s)}function Yh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ei,Xi=Nn.current,it(Nn,t),it(Jn,Jn.current),!0}function HC(t,e,n){var s=t.stateNode;if(!s)throw Error(re(169));n?(t=W2(t,e,Xi),s.__reactInternalMemoizedMergedChildContext=t,ht(Jn),ht(Nn),it(Nn,t)):ht(Jn),it(Jn,n)}var Xr=null,mm=!1,P0=!1;function U2(t){Xr===null?Xr=[t]:Xr.push(t)}function oz(t){mm=!0,U2(t)}function ui(){if(!P0&&Xr!==null){P0=!0;var t=0,e=Ze;try{var n=Xr;for(Ze=1;t<n.length;t++){var s=n[t];do s=s(!0);while(s!==null)}Xr=null,mm=!1}catch(r){throw Xr!==null&&(Xr=Xr.slice(t+1)),p2(Xv,ui),r}finally{Ze=e,P0=!1}}return null}var tl=[],nl=0,Qh=null,Zh=0,Ss=[],Is=0,qi=null,Zr=1,Jr="";function Ci(t,e){tl[nl++]=Zh,tl[nl++]=Qh,Qh=t,Zh=e}function G2(t,e,n){Ss[Is++]=Zr,Ss[Is++]=Jr,Ss[Is++]=qi,qi=t;var s=Zr;t=Jr;var r=32-rr(s)-1;s&=~(1<<r),n+=1;var o=32-rr(e)+r;if(30<o){var i=r-r%5;o=(s&(1<<i)-1).toString(32),s>>=i,r-=i,Zr=1<<32-rr(e)+r|n<<r|s,Jr=o+t}else Zr=1<<o|n<<r|s,Jr=t}function sb(t){t.return!==null&&(Ci(t,1),G2(t,1,0))}function rb(t){for(;t===Qh;)Qh=tl[--nl],tl[nl]=null,Zh=tl[--nl],tl[nl]=null;for(;t===qi;)qi=Ss[--Is],Ss[Is]=null,Jr=Ss[--Is],Ss[Is]=null,Zr=Ss[--Is],Ss[Is]=null}var hs=null,ds=null,gt=!1,er=null;function H2(t,e){var n=Fs(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function jC(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,hs=t,ds=Wo(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,hs=t,ds=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=qi!==null?{id:Zr,overflow:Jr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Fs(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,hs=t,ds=null,!0):!1;default:return!1}}function ey(t){return(t.mode&1)!==0&&(t.flags&128)===0}function ty(t){if(gt){var e=ds;if(e){var n=e;if(!jC(t,e)){if(ey(t))throw Error(re(418));e=Wo(n.nextSibling);var s=hs;e&&jC(t,e)?H2(s,n):(t.flags=t.flags&-4097|2,gt=!1,hs=t)}}else{if(ey(t))throw Error(re(418));t.flags=t.flags&-4097|2,gt=!1,hs=t}}}function KC(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;hs=t}function Vf(t){if(t!==hs)return!1;if(!gt)return KC(t),gt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Yx(t.type,t.memoizedProps)),e&&(e=ds)){if(ey(t))throw j2(),Error(re(418));for(;e;)H2(t,e),e=Wo(e.nextSibling)}if(KC(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(re(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){ds=Wo(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}ds=null}}else ds=hs?Wo(t.stateNode.nextSibling):null;return!0}function j2(){for(var t=ds;t;)t=Wo(t.nextSibling)}function Il(){ds=hs=null,gt=!1}function ob(t){er===null?er=[t]:er.push(t)}var iz=mo.ReactCurrentBatchConfig;function Cu(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(re(309));var s=n.stateNode}if(!s)throw Error(re(147,t));var r=s,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(i){var a=r.refs;i===null?delete a[o]:a[o]=i},e._stringRef=o,e)}if(typeof t!="string")throw Error(re(284));if(!n._owner)throw Error(re(290,t))}return t}function Bf(t,e){throw t=Object.prototype.toString.call(e),Error(re(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function XC(t){var e=t._init;return e(t._payload)}function K2(t){function e(m,x){if(t){var v=m.deletions;v===null?(m.deletions=[x],m.flags|=16):v.push(x)}}function n(m,x){if(!t)return null;for(;x!==null;)e(m,x),x=x.sibling;return null}function s(m,x){for(m=new Map;x!==null;)x.key!==null?m.set(x.key,x):m.set(x.index,x),x=x.sibling;return m}function r(m,x){return m=jo(m,x),m.index=0,m.sibling=null,m}function o(m,x,v){return m.index=v,t?(v=m.alternate,v!==null?(v=v.index,v<x?(m.flags|=2,x):v):(m.flags|=2,x)):(m.flags|=1048576,x)}function i(m){return t&&m.alternate===null&&(m.flags|=2),m}function a(m,x,v,b){return x===null||x.tag!==6?(x=B0(v,m.mode,b),x.return=m,x):(x=r(x,v),x.return=m,x)}function l(m,x,v,b){var $=v.type;return $===qa?c(m,x,v.props.children,b,v.key):x!==null&&(x.elementType===$||typeof $=="object"&&$!==null&&$.$$typeof===Eo&&XC($)===x.type)?(b=r(x,v.props),b.ref=Cu(m,x,v),b.return=m,b):(b=Fh(v.type,v.key,v.props,null,m.mode,b),b.ref=Cu(m,x,v),b.return=m,b)}function u(m,x,v,b){return x===null||x.tag!==4||x.stateNode.containerInfo!==v.containerInfo||x.stateNode.implementation!==v.implementation?(x=W0(v,m.mode,b),x.return=m,x):(x=r(x,v.children||[]),x.return=m,x)}function c(m,x,v,b,$){return x===null||x.tag!==7?(x=Wi(v,m.mode,b,$),x.return=m,x):(x=r(x,v),x.return=m,x)}function d(m,x,v){if(typeof x=="string"&&x!==""||typeof x=="number")return x=B0(""+x,m.mode,v),x.return=m,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Rf:return v=Fh(x.type,x.key,x.props,null,m.mode,v),v.ref=Cu(m,null,x),v.return=m,v;case Xa:return x=W0(x,m.mode,v),x.return=m,x;case Eo:var b=x._init;return d(m,b(x._payload),v)}if(Lu(x)||yu(x))return x=Wi(x,m.mode,v,null),x.return=m,x;Bf(m,x)}return null}function f(m,x,v,b){var $=x!==null?x.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return $!==null?null:a(m,x,""+v,b);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Rf:return v.key===$?l(m,x,v,b):null;case Xa:return v.key===$?u(m,x,v,b):null;case Eo:return $=v._init,f(m,x,$(v._payload),b)}if(Lu(v)||yu(v))return $!==null?null:c(m,x,v,b,null);Bf(m,v)}return null}function h(m,x,v,b,$){if(typeof b=="string"&&b!==""||typeof b=="number")return m=m.get(v)||null,a(x,m,""+b,$);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Rf:return m=m.get(b.key===null?v:b.key)||null,l(x,m,b,$);case Xa:return m=m.get(b.key===null?v:b.key)||null,u(x,m,b,$);case Eo:var C=b._init;return h(m,x,v,C(b._payload),$)}if(Lu(b)||yu(b))return m=m.get(v)||null,c(x,m,b,$,null);Bf(x,b)}return null}function p(m,x,v,b){for(var $=null,C=null,k=x,w=x=0,I=null;k!==null&&w<v.length;w++){k.index>w?(I=k,k=null):I=k.sibling;var R=f(m,k,v[w],b);if(R===null){k===null&&(k=I);break}t&&k&&R.alternate===null&&e(m,k),x=o(R,x,w),C===null?$=R:C.sibling=R,C=R,k=I}if(w===v.length)return n(m,k),gt&&Ci(m,w),$;if(k===null){for(;w<v.length;w++)k=d(m,v[w],b),k!==null&&(x=o(k,x,w),C===null?$=k:C.sibling=k,C=k);return gt&&Ci(m,w),$}for(k=s(m,k);w<v.length;w++)I=h(k,m,w,v[w],b),I!==null&&(t&&I.alternate!==null&&k.delete(I.key===null?w:I.key),x=o(I,x,w),C===null?$=I:C.sibling=I,C=I);return t&&k.forEach(function(E){return e(m,E)}),gt&&Ci(m,w),$}function g(m,x,v,b){var $=yu(v);if(typeof $!="function")throw Error(re(150));if(v=$.call(v),v==null)throw Error(re(151));for(var C=$=null,k=x,w=x=0,I=null,R=v.next();k!==null&&!R.done;w++,R=v.next()){k.index>w?(I=k,k=null):I=k.sibling;var E=f(m,k,R.value,b);if(E===null){k===null&&(k=I);break}t&&k&&E.alternate===null&&e(m,k),x=o(E,x,w),C===null?$=E:C.sibling=E,C=E,k=I}if(R.done)return n(m,k),gt&&Ci(m,w),$;if(k===null){for(;!R.done;w++,R=v.next())R=d(m,R.value,b),R!==null&&(x=o(R,x,w),C===null?$=R:C.sibling=R,C=R);return gt&&Ci(m,w),$}for(k=s(m,k);!R.done;w++,R=v.next())R=h(k,m,w,R.value,b),R!==null&&(t&&R.alternate!==null&&k.delete(R.key===null?w:R.key),x=o(R,x,w),C===null?$=R:C.sibling=R,C=R);return t&&k.forEach(function(A){return e(m,A)}),gt&&Ci(m,w),$}function y(m,x,v,b){if(typeof v=="object"&&v!==null&&v.type===qa&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case Rf:e:{for(var $=v.key,C=x;C!==null;){if(C.key===$){if($=v.type,$===qa){if(C.tag===7){n(m,C.sibling),x=r(C,v.props.children),x.return=m,m=x;break e}}else if(C.elementType===$||typeof $=="object"&&$!==null&&$.$$typeof===Eo&&XC($)===C.type){n(m,C.sibling),x=r(C,v.props),x.ref=Cu(m,C,v),x.return=m,m=x;break e}n(m,C);break}else e(m,C);C=C.sibling}v.type===qa?(x=Wi(v.props.children,m.mode,b,v.key),x.return=m,m=x):(b=Fh(v.type,v.key,v.props,null,m.mode,b),b.ref=Cu(m,x,v),b.return=m,m=b)}return i(m);case Xa:e:{for(C=v.key;x!==null;){if(x.key===C)if(x.tag===4&&x.stateNode.containerInfo===v.containerInfo&&x.stateNode.implementation===v.implementation){n(m,x.sibling),x=r(x,v.children||[]),x.return=m,m=x;break e}else{n(m,x);break}else e(m,x);x=x.sibling}x=W0(v,m.mode,b),x.return=m,m=x}return i(m);case Eo:return C=v._init,y(m,x,C(v._payload),b)}if(Lu(v))return p(m,x,v,b);if(yu(v))return g(m,x,v,b);Bf(m,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,x!==null&&x.tag===6?(n(m,x.sibling),x=r(x,v),x.return=m,m=x):(n(m,x),x=B0(v,m.mode,b),x.return=m,m=x),i(m)):n(m,x)}return y}var Tl=K2(!0),X2=K2(!1),Jh=li(null),ep=null,sl=null,ib=null;function ab(){ib=sl=ep=null}function lb(t){var e=Jh.current;ht(Jh),t._currentValue=e}function ny(t,e,n){for(;t!==null;){var s=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),t===n)break;t=t.return}}function ml(t,e){ep=t,ib=sl=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Yn=!0),t.firstContext=null)}function Vs(t){var e=t._currentValue;if(ib!==t)if(t={context:t,memoizedValue:e,next:null},sl===null){if(ep===null)throw Error(re(308));sl=t,ep.dependencies={lanes:0,firstContext:t}}else sl=sl.next=t;return e}var Ai=null;function ub(t){Ai===null?Ai=[t]:Ai.push(t)}function q2(t,e,n,s){var r=e.interleaved;return r===null?(n.next=n,ub(e)):(n.next=r.next,r.next=n),e.interleaved=n,ao(t,s)}function ao(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var No=!1;function cb(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Y2(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function no(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Uo(t,e,n){var s=t.updateQueue;if(s===null)return null;if(s=s.shared,Ve&2){var r=s.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),s.pending=e,ao(t,n)}return r=s.interleaved,r===null?(e.next=e,ub(s)):(e.next=r.next,r.next=e),s.interleaved=e,ao(t,n)}function Th(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,qv(t,n)}}function qC(t,e){var n=t.updateQueue,s=t.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var r=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?r=o=i:o=o.next=i,n=n.next}while(n!==null);o===null?r=o=e:o=o.next=e}else r=o=e;n={baseState:s.baseState,firstBaseUpdate:r,lastBaseUpdate:o,shared:s.shared,effects:s.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function tp(t,e,n,s){var r=t.updateQueue;No=!1;var o=r.firstBaseUpdate,i=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var l=a,u=l.next;l.next=null,i===null?o=u:i.next=u,i=l;var c=t.alternate;c!==null&&(c=c.updateQueue,a=c.lastBaseUpdate,a!==i&&(a===null?c.firstBaseUpdate=u:a.next=u,c.lastBaseUpdate=l))}if(o!==null){var d=r.baseState;i=0,c=u=l=null,a=o;do{var f=a.lane,h=a.eventTime;if((s&f)===f){c!==null&&(c=c.next={eventTime:h,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=t,g=a;switch(f=e,h=n,g.tag){case 1:if(p=g.payload,typeof p=="function"){d=p.call(h,d,f);break e}d=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=g.payload,f=typeof p=="function"?p.call(h,d,f):p,f==null)break e;d=Ct({},d,f);break e;case 2:No=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,f=r.effects,f===null?r.effects=[a]:f.push(a))}else h={eventTime:h,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},c===null?(u=c=h,l=d):c=c.next=h,i|=f;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;f=a,a=f.next,f.next=null,r.lastBaseUpdate=f,r.shared.pending=null}}while(!0);if(c===null&&(l=d),r.baseState=l,r.firstBaseUpdate=u,r.lastBaseUpdate=c,e=r.shared.interleaved,e!==null){r=e;do i|=r.lane,r=r.next;while(r!==e)}else o===null&&(r.shared.lanes=0);Qi|=i,t.lanes=i,t.memoizedState=d}}function YC(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var s=t[e],r=s.callback;if(r!==null){if(s.callback=null,s=n,typeof r!="function")throw Error(re(191,r));r.call(s)}}}var Jc={},Er=li(Jc),Ic=li(Jc),Tc=li(Jc);function Di(t){if(t===Jc)throw Error(re(174));return t}function db(t,e){switch(it(Tc,e),it(Ic,t),it(Er,Jc),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Lx(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Lx(e,t)}ht(Er),it(Er,e)}function El(){ht(Er),ht(Ic),ht(Tc)}function Q2(t){Di(Tc.current);var e=Di(Er.current),n=Lx(e,t.type);e!==n&&(it(Ic,t),it(Er,n))}function fb(t){Ic.current===t&&(ht(Er),ht(Ic))}var bt=li(0);function np(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var O0=[];function hb(){for(var t=0;t<O0.length;t++)O0[t]._workInProgressVersionPrimary=null;O0.length=0}var Eh=mo.ReactCurrentDispatcher,L0=mo.ReactCurrentBatchConfig,Yi=0,wt=null,Kt=null,en=null,sp=!1,ec=!1,Ec=0,az=0;function vn(){throw Error(re(321))}function pb(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!ur(t[n],e[n]))return!1;return!0}function mb(t,e,n,s,r,o){if(Yi=o,wt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Eh.current=t===null||t.memoizedState===null?dz:fz,t=n(s,r),ec){o=0;do{if(ec=!1,Ec=0,25<=o)throw Error(re(301));o+=1,en=Kt=null,e.updateQueue=null,Eh.current=hz,t=n(s,r)}while(ec)}if(Eh.current=rp,e=Kt!==null&&Kt.next!==null,Yi=0,en=Kt=wt=null,sp=!1,e)throw Error(re(300));return t}function gb(){var t=Ec!==0;return Ec=0,t}function yr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return en===null?wt.memoizedState=en=t:en=en.next=t,en}function Bs(){if(Kt===null){var t=wt.alternate;t=t!==null?t.memoizedState:null}else t=Kt.next;var e=en===null?wt.memoizedState:en.next;if(e!==null)en=e,Kt=t;else{if(t===null)throw Error(re(310));Kt=t,t={memoizedState:Kt.memoizedState,baseState:Kt.baseState,baseQueue:Kt.baseQueue,queue:Kt.queue,next:null},en===null?wt.memoizedState=en=t:en=en.next=t}return en}function Nc(t,e){return typeof e=="function"?e(t):e}function M0(t){var e=Bs(),n=e.queue;if(n===null)throw Error(re(311));n.lastRenderedReducer=t;var s=Kt,r=s.baseQueue,o=n.pending;if(o!==null){if(r!==null){var i=r.next;r.next=o.next,o.next=i}s.baseQueue=r=o,n.pending=null}if(r!==null){o=r.next,s=s.baseState;var a=i=null,l=null,u=o;do{var c=u.lane;if((Yi&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),s=u.hasEagerState?u.eagerState:t(s,u.action);else{var d={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=d,i=s):l=l.next=d,wt.lanes|=c,Qi|=c}u=u.next}while(u!==null&&u!==o);l===null?i=s:l.next=a,ur(s,e.memoizedState)||(Yn=!0),e.memoizedState=s,e.baseState=i,e.baseQueue=l,n.lastRenderedState=s}if(t=n.interleaved,t!==null){r=t;do o=r.lane,wt.lanes|=o,Qi|=o,r=r.next;while(r!==t)}else r===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function _0(t){var e=Bs(),n=e.queue;if(n===null)throw Error(re(311));n.lastRenderedReducer=t;var s=n.dispatch,r=n.pending,o=e.memoizedState;if(r!==null){n.pending=null;var i=r=r.next;do o=t(o,i.action),i=i.next;while(i!==r);ur(o,e.memoizedState)||(Yn=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),n.lastRenderedState=o}return[o,s]}function Z2(){}function J2(t,e){var n=wt,s=Bs(),r=e(),o=!ur(s.memoizedState,r);if(o&&(s.memoizedState=r,Yn=!0),s=s.queue,xb(nE.bind(null,n,s,t),[t]),s.getSnapshot!==e||o||en!==null&&en.memoizedState.tag&1){if(n.flags|=2048,Rc(9,tE.bind(null,n,s,r,e),void 0,null),nn===null)throw Error(re(349));Yi&30||eE(n,e,r)}return r}function eE(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=wt.updateQueue,e===null?(e={lastEffect:null,stores:null},wt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function tE(t,e,n,s){e.value=n,e.getSnapshot=s,sE(e)&&rE(t)}function nE(t,e,n){return n(function(){sE(e)&&rE(t)})}function sE(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!ur(t,n)}catch{return!0}}function rE(t){var e=ao(t,1);e!==null&&or(e,t,1,-1)}function QC(t){var e=yr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Nc,lastRenderedState:t},e.queue=t,t=t.dispatch=cz.bind(null,wt,t),[e.memoizedState,t]}function Rc(t,e,n,s){return t={tag:t,create:e,destroy:n,deps:s,next:null},e=wt.updateQueue,e===null?(e={lastEffect:null,stores:null},wt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(s=n.next,n.next=t,t.next=s,e.lastEffect=t)),t}function oE(){return Bs().memoizedState}function Nh(t,e,n,s){var r=yr();wt.flags|=t,r.memoizedState=Rc(1|e,n,void 0,s===void 0?null:s)}function gm(t,e,n,s){var r=Bs();s=s===void 0?null:s;var o=void 0;if(Kt!==null){var i=Kt.memoizedState;if(o=i.destroy,s!==null&&pb(s,i.deps)){r.memoizedState=Rc(e,n,o,s);return}}wt.flags|=t,r.memoizedState=Rc(1|e,n,o,s)}function ZC(t,e){return Nh(8390656,8,t,e)}function xb(t,e){return gm(2048,8,t,e)}function iE(t,e){return gm(4,2,t,e)}function aE(t,e){return gm(4,4,t,e)}function lE(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function uE(t,e,n){return n=n!=null?n.concat([t]):null,gm(4,4,lE.bind(null,e,t),n)}function yb(){}function cE(t,e){var n=Bs();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&pb(e,s[1])?s[0]:(n.memoizedState=[t,e],t)}function dE(t,e){var n=Bs();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&pb(e,s[1])?s[0]:(t=t(),n.memoizedState=[t,e],t)}function fE(t,e,n){return Yi&21?(ur(n,e)||(n=x2(),wt.lanes|=n,Qi|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Yn=!0),t.memoizedState=n)}function lz(t,e){var n=Ze;Ze=n!==0&&4>n?n:4,t(!0);var s=L0.transition;L0.transition={};try{t(!1),e()}finally{Ze=n,L0.transition=s}}function hE(){return Bs().memoizedState}function uz(t,e,n){var s=Ho(t);if(n={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null},pE(t))mE(e,n);else if(n=q2(t,e,n,s),n!==null){var r=Vn();or(n,t,s,r),gE(n,e,s)}}function cz(t,e,n){var s=Ho(t),r={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null};if(pE(t))mE(e,r);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var i=e.lastRenderedState,a=o(i,n);if(r.hasEagerState=!0,r.eagerState=a,ur(a,i)){var l=e.interleaved;l===null?(r.next=r,ub(e)):(r.next=l.next,l.next=r),e.interleaved=r;return}}catch{}finally{}n=q2(t,e,r,s),n!==null&&(r=Vn(),or(n,t,s,r),gE(n,e,s))}}function pE(t){var e=t.alternate;return t===wt||e!==null&&e===wt}function mE(t,e){ec=sp=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function gE(t,e,n){if(n&4194240){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,qv(t,n)}}var rp={readContext:Vs,useCallback:vn,useContext:vn,useEffect:vn,useImperativeHandle:vn,useInsertionEffect:vn,useLayoutEffect:vn,useMemo:vn,useReducer:vn,useRef:vn,useState:vn,useDebugValue:vn,useDeferredValue:vn,useTransition:vn,useMutableSource:vn,useSyncExternalStore:vn,useId:vn,unstable_isNewReconciler:!1},dz={readContext:Vs,useCallback:function(t,e){return yr().memoizedState=[t,e===void 0?null:e],t},useContext:Vs,useEffect:ZC,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Nh(4194308,4,lE.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Nh(4194308,4,t,e)},useInsertionEffect:function(t,e){return Nh(4,2,t,e)},useMemo:function(t,e){var n=yr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var s=yr();return e=n!==void 0?n(e):e,s.memoizedState=s.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},s.queue=t,t=t.dispatch=uz.bind(null,wt,t),[s.memoizedState,t]},useRef:function(t){var e=yr();return t={current:t},e.memoizedState=t},useState:QC,useDebugValue:yb,useDeferredValue:function(t){return yr().memoizedState=t},useTransition:function(){var t=QC(!1),e=t[0];return t=lz.bind(null,t[1]),yr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var s=wt,r=yr();if(gt){if(n===void 0)throw Error(re(407));n=n()}else{if(n=e(),nn===null)throw Error(re(349));Yi&30||eE(s,e,n)}r.memoizedState=n;var o={value:n,getSnapshot:e};return r.queue=o,ZC(nE.bind(null,s,o,t),[t]),s.flags|=2048,Rc(9,tE.bind(null,s,o,n,e),void 0,null),n},useId:function(){var t=yr(),e=nn.identifierPrefix;if(gt){var n=Jr,s=Zr;n=(s&~(1<<32-rr(s)-1)).toString(32)+n,e=":"+e+"R"+n,n=Ec++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=az++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},fz={readContext:Vs,useCallback:cE,useContext:Vs,useEffect:xb,useImperativeHandle:uE,useInsertionEffect:iE,useLayoutEffect:aE,useMemo:dE,useReducer:M0,useRef:oE,useState:function(){return M0(Nc)},useDebugValue:yb,useDeferredValue:function(t){var e=Bs();return fE(e,Kt.memoizedState,t)},useTransition:function(){var t=M0(Nc)[0],e=Bs().memoizedState;return[t,e]},useMutableSource:Z2,useSyncExternalStore:J2,useId:hE,unstable_isNewReconciler:!1},hz={readContext:Vs,useCallback:cE,useContext:Vs,useEffect:xb,useImperativeHandle:uE,useInsertionEffect:iE,useLayoutEffect:aE,useMemo:dE,useReducer:_0,useRef:oE,useState:function(){return _0(Nc)},useDebugValue:yb,useDeferredValue:function(t){var e=Bs();return Kt===null?e.memoizedState=t:fE(e,Kt.memoizedState,t)},useTransition:function(){var t=_0(Nc)[0],e=Bs().memoizedState;return[t,e]},useMutableSource:Z2,useSyncExternalStore:J2,useId:hE,unstable_isNewReconciler:!1};function Zs(t,e){if(t&&t.defaultProps){e=Ct({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function sy(t,e,n,s){e=t.memoizedState,n=n(s,e),n=n==null?e:Ct({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var xm={isMounted:function(t){return(t=t._reactInternals)?wa(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var s=Vn(),r=Ho(t),o=no(s,r);o.payload=e,n!=null&&(o.callback=n),e=Uo(t,o,r),e!==null&&(or(e,t,r,s),Th(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var s=Vn(),r=Ho(t),o=no(s,r);o.tag=1,o.payload=e,n!=null&&(o.callback=n),e=Uo(t,o,r),e!==null&&(or(e,t,r,s),Th(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Vn(),s=Ho(t),r=no(n,s);r.tag=2,e!=null&&(r.callback=e),e=Uo(t,r,s),e!==null&&(or(e,t,s,n),Th(e,t,s))}};function JC(t,e,n,s,r,o,i){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(s,o,i):e.prototype&&e.prototype.isPureReactComponent?!$c(n,s)||!$c(r,o):!0}function xE(t,e,n){var s=!1,r=ei,o=e.contextType;return typeof o=="object"&&o!==null?o=Vs(o):(r=es(e)?Xi:Nn.current,s=e.contextTypes,o=(s=s!=null)?Sl(t,r):ei),e=new e(n,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=xm,t.stateNode=e,e._reactInternals=t,s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=o),e}function ek(t,e,n,s){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,s),e.state!==t&&xm.enqueueReplaceState(e,e.state,null)}function ry(t,e,n,s){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs={},cb(t);var o=e.contextType;typeof o=="object"&&o!==null?r.context=Vs(o):(o=es(e)?Xi:Nn.current,r.context=Sl(t,o)),r.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(sy(t,e,o,n),r.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&xm.enqueueReplaceState(r,r.state,null),tp(t,n,r,s),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308)}function Nl(t,e){try{var n="",s=e;do n+=B_(s),s=s.return;while(s);var r=n}catch(o){r=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:r,digest:null}}function z0(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function oy(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var pz=typeof WeakMap=="function"?WeakMap:Map;function yE(t,e,n){n=no(-1,n),n.tag=3,n.payload={element:null};var s=e.value;return n.callback=function(){ip||(ip=!0,my=s),oy(t,e)},n}function vE(t,e,n){n=no(-1,n),n.tag=3;var s=t.type.getDerivedStateFromError;if(typeof s=="function"){var r=e.value;n.payload=function(){return s(r)},n.callback=function(){oy(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){oy(t,e),typeof s!="function"&&(Go===null?Go=new Set([this]):Go.add(this));var i=e.stack;this.componentDidCatch(e.value,{componentStack:i!==null?i:""})}),n}function tk(t,e,n){var s=t.pingCache;if(s===null){s=t.pingCache=new pz;var r=new Set;s.set(e,r)}else r=s.get(e),r===void 0&&(r=new Set,s.set(e,r));r.has(n)||(r.add(n),t=Ez.bind(null,t,e,n),e.then(t,t))}function nk(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function sk(t,e,n,s,r){return t.mode&1?(t.flags|=65536,t.lanes=r,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=no(-1,1),e.tag=2,Uo(n,e,1))),n.lanes|=1),t)}var mz=mo.ReactCurrentOwner,Yn=!1;function Pn(t,e,n,s){e.child=t===null?X2(e,null,n,s):Tl(e,t.child,n,s)}function rk(t,e,n,s,r){n=n.render;var o=e.ref;return ml(e,r),s=mb(t,e,n,s,o,r),n=gb(),t!==null&&!Yn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,lo(t,e,r)):(gt&&n&&sb(e),e.flags|=1,Pn(t,e,s,r),e.child)}function ok(t,e,n,s,r){if(t===null){var o=n.type;return typeof o=="function"&&!Ib(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=o,bE(t,e,o,s,r)):(t=Fh(n.type,null,s,e,e.mode,r),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&r)){var i=o.memoizedProps;if(n=n.compare,n=n!==null?n:$c,n(i,s)&&t.ref===e.ref)return lo(t,e,r)}return e.flags|=1,t=jo(o,s),t.ref=e.ref,t.return=e,e.child=t}function bE(t,e,n,s,r){if(t!==null){var o=t.memoizedProps;if($c(o,s)&&t.ref===e.ref)if(Yn=!1,e.pendingProps=s=o,(t.lanes&r)!==0)t.flags&131072&&(Yn=!0);else return e.lanes=t.lanes,lo(t,e,r)}return iy(t,e,n,s,r)}function wE(t,e,n){var s=e.pendingProps,r=s.children,o=t!==null?t.memoizedState:null;if(s.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},it(ol,us),us|=n;else{if(!(n&1073741824))return t=o!==null?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,it(ol,us),us|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=o!==null?o.baseLanes:n,it(ol,us),us|=s}else o!==null?(s=o.baseLanes|n,e.memoizedState=null):s=n,it(ol,us),us|=s;return Pn(t,e,r,n),e.child}function $E(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function iy(t,e,n,s,r){var o=es(n)?Xi:Nn.current;return o=Sl(e,o),ml(e,r),n=mb(t,e,n,s,o,r),s=gb(),t!==null&&!Yn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,lo(t,e,r)):(gt&&s&&sb(e),e.flags|=1,Pn(t,e,n,r),e.child)}function ik(t,e,n,s,r){if(es(n)){var o=!0;Yh(e)}else o=!1;if(ml(e,r),e.stateNode===null)Rh(t,e),xE(e,n,s),ry(e,n,s,r),s=!0;else if(t===null){var i=e.stateNode,a=e.memoizedProps;i.props=a;var l=i.context,u=n.contextType;typeof u=="object"&&u!==null?u=Vs(u):(u=es(n)?Xi:Nn.current,u=Sl(e,u));var c=n.getDerivedStateFromProps,d=typeof c=="function"||typeof i.getSnapshotBeforeUpdate=="function";d||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(a!==s||l!==u)&&ek(e,i,s,u),No=!1;var f=e.memoizedState;i.state=f,tp(e,s,i,r),l=e.memoizedState,a!==s||f!==l||Jn.current||No?(typeof c=="function"&&(sy(e,n,c,s),l=e.memoizedState),(a=No||JC(e,n,a,s,f,l,u))?(d||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(e.flags|=4194308)):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=l),i.props=s,i.state=l,i.context=u,s=a):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{i=e.stateNode,Y2(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:Zs(e.type,a),i.props=u,d=e.pendingProps,f=i.context,l=n.contextType,typeof l=="object"&&l!==null?l=Vs(l):(l=es(n)?Xi:Nn.current,l=Sl(e,l));var h=n.getDerivedStateFromProps;(c=typeof h=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(a!==d||f!==l)&&ek(e,i,s,l),No=!1,f=e.memoizedState,i.state=f,tp(e,s,i,r);var p=e.memoizedState;a!==d||f!==p||Jn.current||No?(typeof h=="function"&&(sy(e,n,h,s),p=e.memoizedState),(u=No||JC(e,n,u,s,f,p,l)||!1)?(c||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(s,p,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(s,p,l)),typeof i.componentDidUpdate=="function"&&(e.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof i.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=p),i.props=s,i.state=p,i.context=l,s=u):(typeof i.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),s=!1)}return ay(t,e,n,s,o,r)}function ay(t,e,n,s,r,o){$E(t,e);var i=(e.flags&128)!==0;if(!s&&!i)return r&&HC(e,n,!1),lo(t,e,o);s=e.stateNode,mz.current=e;var a=i&&typeof n.getDerivedStateFromError!="function"?null:s.render();return e.flags|=1,t!==null&&i?(e.child=Tl(e,t.child,null,o),e.child=Tl(e,null,a,o)):Pn(t,e,a,o),e.memoizedState=s.state,r&&HC(e,n,!0),e.child}function CE(t){var e=t.stateNode;e.pendingContext?GC(t,e.pendingContext,e.pendingContext!==e.context):e.context&&GC(t,e.context,!1),db(t,e.containerInfo)}function ak(t,e,n,s,r){return Il(),ob(r),e.flags|=256,Pn(t,e,n,s),e.child}var ly={dehydrated:null,treeContext:null,retryLane:0};function uy(t){return{baseLanes:t,cachePool:null,transitions:null}}function kE(t,e,n){var s=e.pendingProps,r=bt.current,o=!1,i=(e.flags&128)!==0,a;if((a=i)||(a=t!==null&&t.memoizedState===null?!1:(r&2)!==0),a?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(r|=1),it(bt,r&1),t===null)return ty(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(i=s.children,t=s.fallback,o?(s=e.mode,o=e.child,i={mode:"hidden",children:i},!(s&1)&&o!==null?(o.childLanes=0,o.pendingProps=i):o=bm(i,s,0,null),t=Wi(t,s,n,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=uy(n),e.memoizedState=ly,t):vb(e,i));if(r=t.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return gz(t,e,i,s,a,r,n);if(o){o=s.fallback,i=e.mode,r=t.child,a=r.sibling;var l={mode:"hidden",children:s.children};return!(i&1)&&e.child!==r?(s=e.child,s.childLanes=0,s.pendingProps=l,e.deletions=null):(s=jo(r,l),s.subtreeFlags=r.subtreeFlags&14680064),a!==null?o=jo(a,o):(o=Wi(o,i,n,null),o.flags|=2),o.return=e,s.return=e,s.sibling=o,e.child=s,s=o,o=e.child,i=t.child.memoizedState,i=i===null?uy(n):{baseLanes:i.baseLanes|n,cachePool:null,transitions:i.transitions},o.memoizedState=i,o.childLanes=t.childLanes&~n,e.memoizedState=ly,s}return o=t.child,t=o.sibling,s=jo(o,{mode:"visible",children:s.children}),!(e.mode&1)&&(s.lanes=n),s.return=e,s.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=s,e.memoizedState=null,s}function vb(t,e){return e=bm({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Wf(t,e,n,s){return s!==null&&ob(s),Tl(e,t.child,null,n),t=vb(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function gz(t,e,n,s,r,o,i){if(n)return e.flags&256?(e.flags&=-257,s=z0(Error(re(422))),Wf(t,e,i,s)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=s.fallback,r=e.mode,s=bm({mode:"visible",children:s.children},r,0,null),o=Wi(o,r,i,null),o.flags|=2,s.return=e,o.return=e,s.sibling=o,e.child=s,e.mode&1&&Tl(e,t.child,null,i),e.child.memoizedState=uy(i),e.memoizedState=ly,o);if(!(e.mode&1))return Wf(t,e,i,null);if(r.data==="$!"){if(s=r.nextSibling&&r.nextSibling.dataset,s)var a=s.dgst;return s=a,o=Error(re(419)),s=z0(o,s,void 0),Wf(t,e,i,s)}if(a=(i&t.childLanes)!==0,Yn||a){if(s=nn,s!==null){switch(i&-i){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(s.suspendedLanes|i)?0:r,r!==0&&r!==o.retryLane&&(o.retryLane=r,ao(t,r),or(s,t,r,-1))}return Sb(),s=z0(Error(re(421))),Wf(t,e,i,s)}return r.data==="$?"?(e.flags|=128,e.child=t.child,e=Nz.bind(null,t),r._reactRetry=e,null):(t=o.treeContext,ds=Wo(r.nextSibling),hs=e,gt=!0,er=null,t!==null&&(Ss[Is++]=Zr,Ss[Is++]=Jr,Ss[Is++]=qi,Zr=t.id,Jr=t.overflow,qi=e),e=vb(e,s.children),e.flags|=4096,e)}function lk(t,e,n){t.lanes|=e;var s=t.alternate;s!==null&&(s.lanes|=e),ny(t.return,e,n)}function V0(t,e,n,s,r){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:r}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=s,o.tail=n,o.tailMode=r)}function SE(t,e,n){var s=e.pendingProps,r=s.revealOrder,o=s.tail;if(Pn(t,e,s.children,n),s=bt.current,s&2)s=s&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&lk(t,n,e);else if(t.tag===19)lk(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}s&=1}if(it(bt,s),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;n!==null;)t=n.alternate,t!==null&&np(t)===null&&(r=n),n=n.sibling;n=r,n===null?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),V0(e,!1,r,n,o);break;case"backwards":for(n=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&np(t)===null){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}V0(e,!0,n,null,o);break;case"together":V0(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Rh(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function lo(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Qi|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(re(153));if(e.child!==null){for(t=e.child,n=jo(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=jo(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function xz(t,e,n){switch(e.tag){case 3:CE(e),Il();break;case 5:Q2(e);break;case 1:es(e.type)&&Yh(e);break;case 4:db(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,r=e.memoizedProps.value;it(Jh,s._currentValue),s._currentValue=r;break;case 13:if(s=e.memoizedState,s!==null)return s.dehydrated!==null?(it(bt,bt.current&1),e.flags|=128,null):n&e.child.childLanes?kE(t,e,n):(it(bt,bt.current&1),t=lo(t,e,n),t!==null?t.sibling:null);it(bt,bt.current&1);break;case 19:if(s=(n&e.childLanes)!==0,t.flags&128){if(s)return SE(t,e,n);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),it(bt,bt.current),s)break;return null;case 22:case 23:return e.lanes=0,wE(t,e,n)}return lo(t,e,n)}var IE,cy,TE,EE;IE=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};cy=function(){};TE=function(t,e,n,s){var r=t.memoizedProps;if(r!==s){t=e.stateNode,Di(Er.current);var o=null;switch(n){case"input":r=Dx(t,r),s=Dx(t,s),o=[];break;case"select":r=Ct({},r,{value:void 0}),s=Ct({},s,{value:void 0}),o=[];break;case"textarea":r=Ox(t,r),s=Ox(t,s),o=[];break;default:typeof r.onClick!="function"&&typeof s.onClick=="function"&&(t.onclick=Xh)}Mx(n,s);var i;n=null;for(u in r)if(!s.hasOwnProperty(u)&&r.hasOwnProperty(u)&&r[u]!=null)if(u==="style"){var a=r[u];for(i in a)a.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(mc.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in s){var l=s[u];if(a=r!=null?r[u]:void 0,s.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(i in a)!a.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in l)l.hasOwnProperty(i)&&a[i]!==l[i]&&(n||(n={}),n[i]=l[i])}else n||(o||(o=[]),o.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(o=o||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(o=o||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(mc.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&ft("scroll",t),o||a===l||(o=[])):(o=o||[]).push(u,l))}n&&(o=o||[]).push("style",n);var u=o;(e.updateQueue=u)&&(e.flags|=4)}};EE=function(t,e,n,s){n!==s&&(e.flags|=4)};function ku(t,e){if(!gt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:s.sibling=null}}function bn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,s=0;if(e)for(var r=t.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags&14680064,s|=r.flags&14680064,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags,s|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=s,t.childLanes=n,e}function yz(t,e,n){var s=e.pendingProps;switch(rb(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return bn(e),null;case 1:return es(e.type)&&qh(),bn(e),null;case 3:return s=e.stateNode,El(),ht(Jn),ht(Nn),hb(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(t===null||t.child===null)&&(Vf(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,er!==null&&(yy(er),er=null))),cy(t,e),bn(e),null;case 5:fb(e);var r=Di(Tc.current);if(n=e.type,t!==null&&e.stateNode!=null)TE(t,e,n,s,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(e.stateNode===null)throw Error(re(166));return bn(e),null}if(t=Di(Er.current),Vf(e)){s=e.stateNode,n=e.type;var o=e.memoizedProps;switch(s[Sr]=e,s[Sc]=o,t=(e.mode&1)!==0,n){case"dialog":ft("cancel",s),ft("close",s);break;case"iframe":case"object":case"embed":ft("load",s);break;case"video":case"audio":for(r=0;r<_u.length;r++)ft(_u[r],s);break;case"source":ft("error",s);break;case"img":case"image":case"link":ft("error",s),ft("load",s);break;case"details":ft("toggle",s);break;case"input":xC(s,o),ft("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!o.multiple},ft("invalid",s);break;case"textarea":vC(s,o),ft("invalid",s)}Mx(n,o),r=null;for(var i in o)if(o.hasOwnProperty(i)){var a=o[i];i==="children"?typeof a=="string"?s.textContent!==a&&(o.suppressHydrationWarning!==!0&&zf(s.textContent,a,t),r=["children",a]):typeof a=="number"&&s.textContent!==""+a&&(o.suppressHydrationWarning!==!0&&zf(s.textContent,a,t),r=["children",""+a]):mc.hasOwnProperty(i)&&a!=null&&i==="onScroll"&&ft("scroll",s)}switch(n){case"input":Af(s),yC(s,o,!0);break;case"textarea":Af(s),bC(s);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(s.onclick=Xh)}s=r,e.updateQueue=s,s!==null&&(e.flags|=4)}else{i=r.nodeType===9?r:r.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=n2(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=i.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof s.is=="string"?t=i.createElement(n,{is:s.is}):(t=i.createElement(n),n==="select"&&(i=t,s.multiple?i.multiple=!0:s.size&&(i.size=s.size))):t=i.createElementNS(t,n),t[Sr]=e,t[Sc]=s,IE(t,e,!1,!1),e.stateNode=t;e:{switch(i=_x(n,s),n){case"dialog":ft("cancel",t),ft("close",t),r=s;break;case"iframe":case"object":case"embed":ft("load",t),r=s;break;case"video":case"audio":for(r=0;r<_u.length;r++)ft(_u[r],t);r=s;break;case"source":ft("error",t),r=s;break;case"img":case"image":case"link":ft("error",t),ft("load",t),r=s;break;case"details":ft("toggle",t),r=s;break;case"input":xC(t,s),r=Dx(t,s),ft("invalid",t);break;case"option":r=s;break;case"select":t._wrapperState={wasMultiple:!!s.multiple},r=Ct({},s,{value:void 0}),ft("invalid",t);break;case"textarea":vC(t,s),r=Ox(t,s),ft("invalid",t);break;default:r=s}Mx(n,r),a=r;for(o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="style"?o2(t,l):o==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&s2(t,l)):o==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&gc(t,l):typeof l=="number"&&gc(t,""+l):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(mc.hasOwnProperty(o)?l!=null&&o==="onScroll"&&ft("scroll",t):l!=null&&Uv(t,o,l,i))}switch(n){case"input":Af(t),yC(t,s,!1);break;case"textarea":Af(t),bC(t);break;case"option":s.value!=null&&t.setAttribute("value",""+Jo(s.value));break;case"select":t.multiple=!!s.multiple,o=s.value,o!=null?dl(t,!!s.multiple,o,!1):s.defaultValue!=null&&dl(t,!!s.multiple,s.defaultValue,!0);break;default:typeof r.onClick=="function"&&(t.onclick=Xh)}switch(n){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return bn(e),null;case 6:if(t&&e.stateNode!=null)EE(t,e,t.memoizedProps,s);else{if(typeof s!="string"&&e.stateNode===null)throw Error(re(166));if(n=Di(Tc.current),Di(Er.current),Vf(e)){if(s=e.stateNode,n=e.memoizedProps,s[Sr]=e,(o=s.nodeValue!==n)&&(t=hs,t!==null))switch(t.tag){case 3:zf(s.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&zf(s.nodeValue,n,(t.mode&1)!==0)}o&&(e.flags|=4)}else s=(n.nodeType===9?n:n.ownerDocument).createTextNode(s),s[Sr]=e,e.stateNode=s}return bn(e),null;case 13:if(ht(bt),s=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(gt&&ds!==null&&e.mode&1&&!(e.flags&128))j2(),Il(),e.flags|=98560,o=!1;else if(o=Vf(e),s!==null&&s.dehydrated!==null){if(t===null){if(!o)throw Error(re(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(re(317));o[Sr]=e}else Il(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;bn(e),o=!1}else er!==null&&(yy(er),er=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(s=s!==null,s!==(t!==null&&t.memoizedState!==null)&&s&&(e.child.flags|=8192,e.mode&1&&(t===null||bt.current&1?Yt===0&&(Yt=3):Sb())),e.updateQueue!==null&&(e.flags|=4),bn(e),null);case 4:return El(),cy(t,e),t===null&&Cc(e.stateNode.containerInfo),bn(e),null;case 10:return lb(e.type._context),bn(e),null;case 17:return es(e.type)&&qh(),bn(e),null;case 19:if(ht(bt),o=e.memoizedState,o===null)return bn(e),null;if(s=(e.flags&128)!==0,i=o.rendering,i===null)if(s)ku(o,!1);else{if(Yt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(i=np(t),i!==null){for(e.flags|=128,ku(o,!1),s=i.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=n,n=e.child;n!==null;)o=n,t=s,o.flags&=14680066,i=o.alternate,i===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=i.childLanes,o.lanes=i.lanes,o.child=i.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=i.memoizedProps,o.memoizedState=i.memoizedState,o.updateQueue=i.updateQueue,o.type=i.type,t=i.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return it(bt,bt.current&1|2),e.child}t=t.sibling}o.tail!==null&&Pt()>Rl&&(e.flags|=128,s=!0,ku(o,!1),e.lanes=4194304)}else{if(!s)if(t=np(i),t!==null){if(e.flags|=128,s=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),ku(o,!0),o.tail===null&&o.tailMode==="hidden"&&!i.alternate&&!gt)return bn(e),null}else 2*Pt()-o.renderingStartTime>Rl&&n!==1073741824&&(e.flags|=128,s=!0,ku(o,!1),e.lanes=4194304);o.isBackwards?(i.sibling=e.child,e.child=i):(n=o.last,n!==null?n.sibling=i:e.child=i,o.last=i)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=Pt(),e.sibling=null,n=bt.current,it(bt,s?n&1|2:n&1),e):(bn(e),null);case 22:case 23:return kb(),s=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==s&&(e.flags|=8192),s&&e.mode&1?us&1073741824&&(bn(e),e.subtreeFlags&6&&(e.flags|=8192)):bn(e),null;case 24:return null;case 25:return null}throw Error(re(156,e.tag))}function vz(t,e){switch(rb(e),e.tag){case 1:return es(e.type)&&qh(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return El(),ht(Jn),ht(Nn),hb(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return fb(e),null;case 13:if(ht(bt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(re(340));Il()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return ht(bt),null;case 4:return El(),null;case 10:return lb(e.type._context),null;case 22:case 23:return kb(),null;case 24:return null;default:return null}}var Uf=!1,kn=!1,bz=typeof WeakSet=="function"?WeakSet:Set,de=null;function rl(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(s){kt(t,e,s)}else n.current=null}function dy(t,e,n){try{n()}catch(s){kt(t,e,s)}}var uk=!1;function wz(t,e){if(Xx=Hh,t=F2(),nb(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var r=s.anchorOffset,o=s.focusNode;s=s.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var i=0,a=-1,l=-1,u=0,c=0,d=t,f=null;t:for(;;){for(var h;d!==n||r!==0&&d.nodeType!==3||(a=i+r),d!==o||s!==0&&d.nodeType!==3||(l=i+s),d.nodeType===3&&(i+=d.nodeValue.length),(h=d.firstChild)!==null;)f=d,d=h;for(;;){if(d===t)break t;if(f===n&&++u===r&&(a=i),f===o&&++c===s&&(l=i),(h=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=h}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(qx={focusedElem:t,selectionRange:n},Hh=!1,de=e;de!==null;)if(e=de,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,de=t;else for(;de!==null;){e=de;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var g=p.memoizedProps,y=p.memoizedState,m=e.stateNode,x=m.getSnapshotBeforeUpdate(e.elementType===e.type?g:Zs(e.type,g),y);m.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var v=e.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(re(163))}}catch(b){kt(e,e.return,b)}if(t=e.sibling,t!==null){t.return=e.return,de=t;break}de=e.return}return p=uk,uk=!1,p}function tc(t,e,n){var s=e.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var r=s=s.next;do{if((r.tag&t)===t){var o=r.destroy;r.destroy=void 0,o!==void 0&&dy(e,n,o)}r=r.next}while(r!==s)}}function ym(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var s=n.create;n.destroy=s()}n=n.next}while(n!==e)}}function fy(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function NE(t){var e=t.alternate;e!==null&&(t.alternate=null,NE(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Sr],delete e[Sc],delete e[Zx],delete e[sz],delete e[rz])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function RE(t){return t.tag===5||t.tag===3||t.tag===4}function ck(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||RE(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function hy(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Xh));else if(s!==4&&(t=t.child,t!==null))for(hy(t,e,n),t=t.sibling;t!==null;)hy(t,e,n),t=t.sibling}function py(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(s!==4&&(t=t.child,t!==null))for(py(t,e,n),t=t.sibling;t!==null;)py(t,e,n),t=t.sibling}var ln=null,Js=!1;function So(t,e,n){for(n=n.child;n!==null;)AE(t,e,n),n=n.sibling}function AE(t,e,n){if(Tr&&typeof Tr.onCommitFiberUnmount=="function")try{Tr.onCommitFiberUnmount(cm,n)}catch{}switch(n.tag){case 5:kn||rl(n,e);case 6:var s=ln,r=Js;ln=null,So(t,e,n),ln=s,Js=r,ln!==null&&(Js?(t=ln,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):ln.removeChild(n.stateNode));break;case 18:ln!==null&&(Js?(t=ln,n=n.stateNode,t.nodeType===8?F0(t.parentNode,n):t.nodeType===1&&F0(t,n),bc(t)):F0(ln,n.stateNode));break;case 4:s=ln,r=Js,ln=n.stateNode.containerInfo,Js=!0,So(t,e,n),ln=s,Js=r;break;case 0:case 11:case 14:case 15:if(!kn&&(s=n.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){r=s=s.next;do{var o=r,i=o.destroy;o=o.tag,i!==void 0&&(o&2||o&4)&&dy(n,e,i),r=r.next}while(r!==s)}So(t,e,n);break;case 1:if(!kn&&(rl(n,e),s=n.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=n.memoizedProps,s.state=n.memoizedState,s.componentWillUnmount()}catch(a){kt(n,e,a)}So(t,e,n);break;case 21:So(t,e,n);break;case 22:n.mode&1?(kn=(s=kn)||n.memoizedState!==null,So(t,e,n),kn=s):So(t,e,n);break;default:So(t,e,n)}}function dk(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new bz),e.forEach(function(s){var r=Rz.bind(null,t,s);n.has(s)||(n.add(s),s.then(r,r))})}}function Xs(t,e){var n=e.deletions;if(n!==null)for(var s=0;s<n.length;s++){var r=n[s];try{var o=t,i=e,a=i;e:for(;a!==null;){switch(a.tag){case 5:ln=a.stateNode,Js=!1;break e;case 3:ln=a.stateNode.containerInfo,Js=!0;break e;case 4:ln=a.stateNode.containerInfo,Js=!0;break e}a=a.return}if(ln===null)throw Error(re(160));AE(o,i,r),ln=null,Js=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(u){kt(r,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)DE(e,t),e=e.sibling}function DE(t,e){var n=t.alternate,s=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Xs(e,t),gr(t),s&4){try{tc(3,t,t.return),ym(3,t)}catch(g){kt(t,t.return,g)}try{tc(5,t,t.return)}catch(g){kt(t,t.return,g)}}break;case 1:Xs(e,t),gr(t),s&512&&n!==null&&rl(n,n.return);break;case 5:if(Xs(e,t),gr(t),s&512&&n!==null&&rl(n,n.return),t.flags&32){var r=t.stateNode;try{gc(r,"")}catch(g){kt(t,t.return,g)}}if(s&4&&(r=t.stateNode,r!=null)){var o=t.memoizedProps,i=n!==null?n.memoizedProps:o,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&o.type==="radio"&&o.name!=null&&e2(r,o),_x(a,i);var u=_x(a,o);for(i=0;i<l.length;i+=2){var c=l[i],d=l[i+1];c==="style"?o2(r,d):c==="dangerouslySetInnerHTML"?s2(r,d):c==="children"?gc(r,d):Uv(r,c,d,u)}switch(a){case"input":Fx(r,o);break;case"textarea":t2(r,o);break;case"select":var f=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!o.multiple;var h=o.value;h!=null?dl(r,!!o.multiple,h,!1):f!==!!o.multiple&&(o.defaultValue!=null?dl(r,!!o.multiple,o.defaultValue,!0):dl(r,!!o.multiple,o.multiple?[]:"",!1))}r[Sc]=o}catch(g){kt(t,t.return,g)}}break;case 6:if(Xs(e,t),gr(t),s&4){if(t.stateNode===null)throw Error(re(162));r=t.stateNode,o=t.memoizedProps;try{r.nodeValue=o}catch(g){kt(t,t.return,g)}}break;case 3:if(Xs(e,t),gr(t),s&4&&n!==null&&n.memoizedState.isDehydrated)try{bc(e.containerInfo)}catch(g){kt(t,t.return,g)}break;case 4:Xs(e,t),gr(t);break;case 13:Xs(e,t),gr(t),r=t.child,r.flags&8192&&(o=r.memoizedState!==null,r.stateNode.isHidden=o,!o||r.alternate!==null&&r.alternate.memoizedState!==null||($b=Pt())),s&4&&dk(t);break;case 22:if(c=n!==null&&n.memoizedState!==null,t.mode&1?(kn=(u=kn)||c,Xs(e,t),kn=u):Xs(e,t),gr(t),s&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!c&&t.mode&1)for(de=t,c=t.child;c!==null;){for(d=de=c;de!==null;){switch(f=de,h=f.child,f.tag){case 0:case 11:case 14:case 15:tc(4,f,f.return);break;case 1:rl(f,f.return);var p=f.stateNode;if(typeof p.componentWillUnmount=="function"){s=f,n=f.return;try{e=s,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(g){kt(s,n,g)}}break;case 5:rl(f,f.return);break;case 22:if(f.memoizedState!==null){hk(d);continue}}h!==null?(h.return=f,de=h):hk(d)}c=c.sibling}e:for(c=null,d=t;;){if(d.tag===5){if(c===null){c=d;try{r=d.stateNode,u?(o=r.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(a=d.stateNode,l=d.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=r2("display",i))}catch(g){kt(t,t.return,g)}}}else if(d.tag===6){if(c===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(g){kt(t,t.return,g)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;c===d&&(c=null),d=d.return}c===d&&(c=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Xs(e,t),gr(t),s&4&&dk(t);break;case 21:break;default:Xs(e,t),gr(t)}}function gr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(RE(n)){var s=n;break e}n=n.return}throw Error(re(160))}switch(s.tag){case 5:var r=s.stateNode;s.flags&32&&(gc(r,""),s.flags&=-33);var o=ck(t);py(t,o,r);break;case 3:case 4:var i=s.stateNode.containerInfo,a=ck(t);hy(t,a,i);break;default:throw Error(re(161))}}catch(l){kt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function $z(t,e,n){de=t,FE(t)}function FE(t,e,n){for(var s=(t.mode&1)!==0;de!==null;){var r=de,o=r.child;if(r.tag===22&&s){var i=r.memoizedState!==null||Uf;if(!i){var a=r.alternate,l=a!==null&&a.memoizedState!==null||kn;a=Uf;var u=kn;if(Uf=i,(kn=l)&&!u)for(de=r;de!==null;)i=de,l=i.child,i.tag===22&&i.memoizedState!==null?pk(r):l!==null?(l.return=i,de=l):pk(r);for(;o!==null;)de=o,FE(o),o=o.sibling;de=r,Uf=a,kn=u}fk(t)}else r.subtreeFlags&8772&&o!==null?(o.return=r,de=o):fk(t)}}function fk(t){for(;de!==null;){var e=de;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:kn||ym(5,e);break;case 1:var s=e.stateNode;if(e.flags&4&&!kn)if(n===null)s.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:Zs(e.type,n.memoizedProps);s.componentDidUpdate(r,n.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&YC(e,o,s);break;case 3:var i=e.updateQueue;if(i!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}YC(e,i,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var d=c.dehydrated;d!==null&&bc(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(re(163))}kn||e.flags&512&&fy(e)}catch(f){kt(e,e.return,f)}}if(e===t){de=null;break}if(n=e.sibling,n!==null){n.return=e.return,de=n;break}de=e.return}}function hk(t){for(;de!==null;){var e=de;if(e===t){de=null;break}var n=e.sibling;if(n!==null){n.return=e.return,de=n;break}de=e.return}}function pk(t){for(;de!==null;){var e=de;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{ym(4,e)}catch(l){kt(e,n,l)}break;case 1:var s=e.stateNode;if(typeof s.componentDidMount=="function"){var r=e.return;try{s.componentDidMount()}catch(l){kt(e,r,l)}}var o=e.return;try{fy(e)}catch(l){kt(e,o,l)}break;case 5:var i=e.return;try{fy(e)}catch(l){kt(e,i,l)}}}catch(l){kt(e,e.return,l)}if(e===t){de=null;break}var a=e.sibling;if(a!==null){a.return=e.return,de=a;break}de=e.return}}var Cz=Math.ceil,op=mo.ReactCurrentDispatcher,bb=mo.ReactCurrentOwner,zs=mo.ReactCurrentBatchConfig,Ve=0,nn=null,Vt=null,dn=0,us=0,ol=li(0),Yt=0,Ac=null,Qi=0,vm=0,wb=0,nc=null,Xn=null,$b=0,Rl=1/0,Kr=null,ip=!1,my=null,Go=null,Gf=!1,Po=null,ap=0,sc=0,gy=null,Ah=-1,Dh=0;function Vn(){return Ve&6?Pt():Ah!==-1?Ah:Ah=Pt()}function Ho(t){return t.mode&1?Ve&2&&dn!==0?dn&-dn:iz.transition!==null?(Dh===0&&(Dh=x2()),Dh):(t=Ze,t!==0||(t=window.event,t=t===void 0?16:k2(t.type)),t):1}function or(t,e,n,s){if(50<sc)throw sc=0,gy=null,Error(re(185));Yc(t,n,s),(!(Ve&2)||t!==nn)&&(t===nn&&(!(Ve&2)&&(vm|=n),Yt===4&&Do(t,dn)),ts(t,s),n===1&&Ve===0&&!(e.mode&1)&&(Rl=Pt()+500,mm&&ui()))}function ts(t,e){var n=t.callbackNode;i4(t,e);var s=Gh(t,t===nn?dn:0);if(s===0)n!==null&&CC(n),t.callbackNode=null,t.callbackPriority=0;else if(e=s&-s,t.callbackPriority!==e){if(n!=null&&CC(n),e===1)t.tag===0?oz(mk.bind(null,t)):U2(mk.bind(null,t)),tz(function(){!(Ve&6)&&ui()}),n=null;else{switch(y2(s)){case 1:n=Xv;break;case 4:n=m2;break;case 16:n=Uh;break;case 536870912:n=g2;break;default:n=Uh}n=BE(n,PE.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function PE(t,e){if(Ah=-1,Dh=0,Ve&6)throw Error(re(327));var n=t.callbackNode;if(gl()&&t.callbackNode!==n)return null;var s=Gh(t,t===nn?dn:0);if(s===0)return null;if(s&30||s&t.expiredLanes||e)e=lp(t,s);else{e=s;var r=Ve;Ve|=2;var o=LE();(nn!==t||dn!==e)&&(Kr=null,Rl=Pt()+500,Bi(t,e));do try{Iz();break}catch(a){OE(t,a)}while(!0);ab(),op.current=o,Ve=r,Vt!==null?e=0:(nn=null,dn=0,e=Yt)}if(e!==0){if(e===2&&(r=Ux(t),r!==0&&(s=r,e=xy(t,r))),e===1)throw n=Ac,Bi(t,0),Do(t,s),ts(t,Pt()),n;if(e===6)Do(t,s);else{if(r=t.current.alternate,!(s&30)&&!kz(r)&&(e=lp(t,s),e===2&&(o=Ux(t),o!==0&&(s=o,e=xy(t,o))),e===1))throw n=Ac,Bi(t,0),Do(t,s),ts(t,Pt()),n;switch(t.finishedWork=r,t.finishedLanes=s,e){case 0:case 1:throw Error(re(345));case 2:ki(t,Xn,Kr);break;case 3:if(Do(t,s),(s&130023424)===s&&(e=$b+500-Pt(),10<e)){if(Gh(t,0)!==0)break;if(r=t.suspendedLanes,(r&s)!==s){Vn(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=Qx(ki.bind(null,t,Xn,Kr),e);break}ki(t,Xn,Kr);break;case 4:if(Do(t,s),(s&4194240)===s)break;for(e=t.eventTimes,r=-1;0<s;){var i=31-rr(s);o=1<<i,i=e[i],i>r&&(r=i),s&=~o}if(s=r,s=Pt()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*Cz(s/1960))-s,10<s){t.timeoutHandle=Qx(ki.bind(null,t,Xn,Kr),s);break}ki(t,Xn,Kr);break;case 5:ki(t,Xn,Kr);break;default:throw Error(re(329))}}}return ts(t,Pt()),t.callbackNode===n?PE.bind(null,t):null}function xy(t,e){var n=nc;return t.current.memoizedState.isDehydrated&&(Bi(t,e).flags|=256),t=lp(t,e),t!==2&&(e=Xn,Xn=n,e!==null&&yy(e)),t}function yy(t){Xn===null?Xn=t:Xn.push.apply(Xn,t)}function kz(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var s=0;s<n.length;s++){var r=n[s],o=r.getSnapshot;r=r.value;try{if(!ur(o(),r))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Do(t,e){for(e&=~wb,e&=~vm,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-rr(e),s=1<<n;t[n]=-1,e&=~s}}function mk(t){if(Ve&6)throw Error(re(327));gl();var e=Gh(t,0);if(!(e&1))return ts(t,Pt()),null;var n=lp(t,e);if(t.tag!==0&&n===2){var s=Ux(t);s!==0&&(e=s,n=xy(t,s))}if(n===1)throw n=Ac,Bi(t,0),Do(t,e),ts(t,Pt()),n;if(n===6)throw Error(re(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ki(t,Xn,Kr),ts(t,Pt()),null}function Cb(t,e){var n=Ve;Ve|=1;try{return t(e)}finally{Ve=n,Ve===0&&(Rl=Pt()+500,mm&&ui())}}function Zi(t){Po!==null&&Po.tag===0&&!(Ve&6)&&gl();var e=Ve;Ve|=1;var n=zs.transition,s=Ze;try{if(zs.transition=null,Ze=1,t)return t()}finally{Ze=s,zs.transition=n,Ve=e,!(Ve&6)&&ui()}}function kb(){us=ol.current,ht(ol)}function Bi(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,ez(n)),Vt!==null)for(n=Vt.return;n!==null;){var s=n;switch(rb(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&qh();break;case 3:El(),ht(Jn),ht(Nn),hb();break;case 5:fb(s);break;case 4:El();break;case 13:ht(bt);break;case 19:ht(bt);break;case 10:lb(s.type._context);break;case 22:case 23:kb()}n=n.return}if(nn=t,Vt=t=jo(t.current,null),dn=us=e,Yt=0,Ac=null,wb=vm=Qi=0,Xn=nc=null,Ai!==null){for(e=0;e<Ai.length;e++)if(n=Ai[e],s=n.interleaved,s!==null){n.interleaved=null;var r=s.next,o=n.pending;if(o!==null){var i=o.next;o.next=r,s.next=i}n.pending=s}Ai=null}return t}function OE(t,e){do{var n=Vt;try{if(ab(),Eh.current=rp,sp){for(var s=wt.memoizedState;s!==null;){var r=s.queue;r!==null&&(r.pending=null),s=s.next}sp=!1}if(Yi=0,en=Kt=wt=null,ec=!1,Ec=0,bb.current=null,n===null||n.return===null){Yt=1,Ac=e,Vt=null;break}e:{var o=t,i=n.return,a=n,l=e;if(e=dn,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=a,d=c.tag;if(!(c.mode&1)&&(d===0||d===11||d===15)){var f=c.alternate;f?(c.updateQueue=f.updateQueue,c.memoizedState=f.memoizedState,c.lanes=f.lanes):(c.updateQueue=null,c.memoizedState=null)}var h=nk(i);if(h!==null){h.flags&=-257,sk(h,i,a,o,e),h.mode&1&&tk(o,u,e),e=h,l=u;var p=e.updateQueue;if(p===null){var g=new Set;g.add(l),e.updateQueue=g}else p.add(l);break e}else{if(!(e&1)){tk(o,u,e),Sb();break e}l=Error(re(426))}}else if(gt&&a.mode&1){var y=nk(i);if(y!==null){!(y.flags&65536)&&(y.flags|=256),sk(y,i,a,o,e),ob(Nl(l,a));break e}}o=l=Nl(l,a),Yt!==4&&(Yt=2),nc===null?nc=[o]:nc.push(o),o=i;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var m=yE(o,l,e);qC(o,m);break e;case 1:a=l;var x=o.type,v=o.stateNode;if(!(o.flags&128)&&(typeof x.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(Go===null||!Go.has(v)))){o.flags|=65536,e&=-e,o.lanes|=e;var b=vE(o,a,e);qC(o,b);break e}}o=o.return}while(o!==null)}_E(n)}catch($){e=$,Vt===n&&n!==null&&(Vt=n=n.return);continue}break}while(!0)}function LE(){var t=op.current;return op.current=rp,t===null?rp:t}function Sb(){(Yt===0||Yt===3||Yt===2)&&(Yt=4),nn===null||!(Qi&268435455)&&!(vm&268435455)||Do(nn,dn)}function lp(t,e){var n=Ve;Ve|=2;var s=LE();(nn!==t||dn!==e)&&(Kr=null,Bi(t,e));do try{Sz();break}catch(r){OE(t,r)}while(!0);if(ab(),Ve=n,op.current=s,Vt!==null)throw Error(re(261));return nn=null,dn=0,Yt}function Sz(){for(;Vt!==null;)ME(Vt)}function Iz(){for(;Vt!==null&&!Q_();)ME(Vt)}function ME(t){var e=VE(t.alternate,t,us);t.memoizedProps=t.pendingProps,e===null?_E(t):Vt=e,bb.current=null}function _E(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=vz(n,e),n!==null){n.flags&=32767,Vt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Yt=6,Vt=null;return}}else if(n=yz(n,e,us),n!==null){Vt=n;return}if(e=e.sibling,e!==null){Vt=e;return}Vt=e=t}while(e!==null);Yt===0&&(Yt=5)}function ki(t,e,n){var s=Ze,r=zs.transition;try{zs.transition=null,Ze=1,Tz(t,e,n,s)}finally{zs.transition=r,Ze=s}return null}function Tz(t,e,n,s){do gl();while(Po!==null);if(Ve&6)throw Error(re(327));n=t.finishedWork;var r=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(re(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if(a4(t,o),t===nn&&(Vt=nn=null,dn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Gf||(Gf=!0,BE(Uh,function(){return gl(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=zs.transition,zs.transition=null;var i=Ze;Ze=1;var a=Ve;Ve|=4,bb.current=null,wz(t,n),DE(n,t),K4(qx),Hh=!!Xx,qx=Xx=null,t.current=n,$z(n),Z_(),Ve=a,Ze=i,zs.transition=o}else t.current=n;if(Gf&&(Gf=!1,Po=t,ap=r),o=t.pendingLanes,o===0&&(Go=null),t4(n.stateNode),ts(t,Pt()),e!==null)for(s=t.onRecoverableError,n=0;n<e.length;n++)r=e[n],s(r.value,{componentStack:r.stack,digest:r.digest});if(ip)throw ip=!1,t=my,my=null,t;return ap&1&&t.tag!==0&&gl(),o=t.pendingLanes,o&1?t===gy?sc++:(sc=0,gy=t):sc=0,ui(),null}function gl(){if(Po!==null){var t=y2(ap),e=zs.transition,n=Ze;try{if(zs.transition=null,Ze=16>t?16:t,Po===null)var s=!1;else{if(t=Po,Po=null,ap=0,Ve&6)throw Error(re(331));var r=Ve;for(Ve|=4,de=t.current;de!==null;){var o=de,i=o.child;if(de.flags&16){var a=o.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(de=u;de!==null;){var c=de;switch(c.tag){case 0:case 11:case 15:tc(8,c,o)}var d=c.child;if(d!==null)d.return=c,de=d;else for(;de!==null;){c=de;var f=c.sibling,h=c.return;if(NE(c),c===u){de=null;break}if(f!==null){f.return=h,de=f;break}de=h}}}var p=o.alternate;if(p!==null){var g=p.child;if(g!==null){p.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(g!==null)}}de=o}}if(o.subtreeFlags&2064&&i!==null)i.return=o,de=i;else e:for(;de!==null;){if(o=de,o.flags&2048)switch(o.tag){case 0:case 11:case 15:tc(9,o,o.return)}var m=o.sibling;if(m!==null){m.return=o.return,de=m;break e}de=o.return}}var x=t.current;for(de=x;de!==null;){i=de;var v=i.child;if(i.subtreeFlags&2064&&v!==null)v.return=i,de=v;else e:for(i=x;de!==null;){if(a=de,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:ym(9,a)}}catch($){kt(a,a.return,$)}if(a===i){de=null;break e}var b=a.sibling;if(b!==null){b.return=a.return,de=b;break e}de=a.return}}if(Ve=r,ui(),Tr&&typeof Tr.onPostCommitFiberRoot=="function")try{Tr.onPostCommitFiberRoot(cm,t)}catch{}s=!0}return s}finally{Ze=n,zs.transition=e}}return!1}function gk(t,e,n){e=Nl(n,e),e=yE(t,e,1),t=Uo(t,e,1),e=Vn(),t!==null&&(Yc(t,1,e),ts(t,e))}function kt(t,e,n){if(t.tag===3)gk(t,t,n);else for(;e!==null;){if(e.tag===3){gk(e,t,n);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(Go===null||!Go.has(s))){t=Nl(n,t),t=vE(e,t,1),e=Uo(e,t,1),t=Vn(),e!==null&&(Yc(e,1,t),ts(e,t));break}}e=e.return}}function Ez(t,e,n){var s=t.pingCache;s!==null&&s.delete(e),e=Vn(),t.pingedLanes|=t.suspendedLanes&n,nn===t&&(dn&n)===n&&(Yt===4||Yt===3&&(dn&130023424)===dn&&500>Pt()-$b?Bi(t,0):wb|=n),ts(t,e)}function zE(t,e){e===0&&(t.mode&1?(e=Pf,Pf<<=1,!(Pf&130023424)&&(Pf=4194304)):e=1);var n=Vn();t=ao(t,e),t!==null&&(Yc(t,e,n),ts(t,n))}function Nz(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),zE(t,n)}function Rz(t,e){var n=0;switch(t.tag){case 13:var s=t.stateNode,r=t.memoizedState;r!==null&&(n=r.retryLane);break;case 19:s=t.stateNode;break;default:throw Error(re(314))}s!==null&&s.delete(e),zE(t,n)}var VE;VE=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Jn.current)Yn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Yn=!1,xz(t,e,n);Yn=!!(t.flags&131072)}else Yn=!1,gt&&e.flags&1048576&&G2(e,Zh,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;Rh(t,e),t=e.pendingProps;var r=Sl(e,Nn.current);ml(e,n),r=mb(null,e,s,t,r,n);var o=gb();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,es(s)?(o=!0,Yh(e)):o=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,cb(e),r.updater=xm,e.stateNode=r,r._reactInternals=e,ry(e,s,t,n),e=ay(null,e,s,!0,o,n)):(e.tag=0,gt&&o&&sb(e),Pn(null,e,r,n),e=e.child),e;case 16:s=e.elementType;e:{switch(Rh(t,e),t=e.pendingProps,r=s._init,s=r(s._payload),e.type=s,r=e.tag=Dz(s),t=Zs(s,t),r){case 0:e=iy(null,e,s,t,n);break e;case 1:e=ik(null,e,s,t,n);break e;case 11:e=rk(null,e,s,t,n);break e;case 14:e=ok(null,e,s,Zs(s.type,t),n);break e}throw Error(re(306,s,""))}return e;case 0:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:Zs(s,r),iy(t,e,s,r,n);case 1:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:Zs(s,r),ik(t,e,s,r,n);case 3:e:{if(CE(e),t===null)throw Error(re(387));s=e.pendingProps,o=e.memoizedState,r=o.element,Y2(t,e),tp(e,s,null,n);var i=e.memoizedState;if(s=i.element,o.isDehydrated)if(o={element:s,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){r=Nl(Error(re(423)),e),e=ak(t,e,s,n,r);break e}else if(s!==r){r=Nl(Error(re(424)),e),e=ak(t,e,s,n,r);break e}else for(ds=Wo(e.stateNode.containerInfo.firstChild),hs=e,gt=!0,er=null,n=X2(e,null,s,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Il(),s===r){e=lo(t,e,n);break e}Pn(t,e,s,n)}e=e.child}return e;case 5:return Q2(e),t===null&&ty(e),s=e.type,r=e.pendingProps,o=t!==null?t.memoizedProps:null,i=r.children,Yx(s,r)?i=null:o!==null&&Yx(s,o)&&(e.flags|=32),$E(t,e),Pn(t,e,i,n),e.child;case 6:return t===null&&ty(e),null;case 13:return kE(t,e,n);case 4:return db(e,e.stateNode.containerInfo),s=e.pendingProps,t===null?e.child=Tl(e,null,s,n):Pn(t,e,s,n),e.child;case 11:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:Zs(s,r),rk(t,e,s,r,n);case 7:return Pn(t,e,e.pendingProps,n),e.child;case 8:return Pn(t,e,e.pendingProps.children,n),e.child;case 12:return Pn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(s=e.type._context,r=e.pendingProps,o=e.memoizedProps,i=r.value,it(Jh,s._currentValue),s._currentValue=i,o!==null)if(ur(o.value,i)){if(o.children===r.children&&!Jn.current){e=lo(t,e,n);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var a=o.dependencies;if(a!==null){i=o.child;for(var l=a.firstContext;l!==null;){if(l.context===s){if(o.tag===1){l=no(-1,n&-n),l.tag=2;var u=o.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),ny(o.return,n,e),a.lanes|=n;break}l=l.next}}else if(o.tag===10)i=o.type===e.type?null:o.child;else if(o.tag===18){if(i=o.return,i===null)throw Error(re(341));i.lanes|=n,a=i.alternate,a!==null&&(a.lanes|=n),ny(i,n,e),i=o.sibling}else i=o.child;if(i!==null)i.return=o;else for(i=o;i!==null;){if(i===e){i=null;break}if(o=i.sibling,o!==null){o.return=i.return,i=o;break}i=i.return}o=i}Pn(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,s=e.pendingProps.children,ml(e,n),r=Vs(r),s=s(r),e.flags|=1,Pn(t,e,s,n),e.child;case 14:return s=e.type,r=Zs(s,e.pendingProps),r=Zs(s.type,r),ok(t,e,s,r,n);case 15:return bE(t,e,e.type,e.pendingProps,n);case 17:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:Zs(s,r),Rh(t,e),e.tag=1,es(s)?(t=!0,Yh(e)):t=!1,ml(e,n),xE(e,s,r),ry(e,s,r,n),ay(null,e,s,!0,t,n);case 19:return SE(t,e,n);case 22:return wE(t,e,n)}throw Error(re(156,e.tag))};function BE(t,e){return p2(t,e)}function Az(t,e,n,s){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Fs(t,e,n,s){return new Az(t,e,n,s)}function Ib(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Dz(t){if(typeof t=="function")return Ib(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Hv)return 11;if(t===jv)return 14}return 2}function jo(t,e){var n=t.alternate;return n===null?(n=Fs(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Fh(t,e,n,s,r,o){var i=2;if(s=t,typeof t=="function")Ib(t)&&(i=1);else if(typeof t=="string")i=5;else e:switch(t){case qa:return Wi(n.children,r,o,e);case Gv:i=8,r|=8;break;case Ex:return t=Fs(12,n,e,r|2),t.elementType=Ex,t.lanes=o,t;case Nx:return t=Fs(13,n,e,r),t.elementType=Nx,t.lanes=o,t;case Rx:return t=Fs(19,n,e,r),t.elementType=Rx,t.lanes=o,t;case QT:return bm(n,r,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case qT:i=10;break e;case YT:i=9;break e;case Hv:i=11;break e;case jv:i=14;break e;case Eo:i=16,s=null;break e}throw Error(re(130,t==null?t:typeof t,""))}return e=Fs(i,n,e,r),e.elementType=t,e.type=s,e.lanes=o,e}function Wi(t,e,n,s){return t=Fs(7,t,s,e),t.lanes=n,t}function bm(t,e,n,s){return t=Fs(22,t,s,e),t.elementType=QT,t.lanes=n,t.stateNode={isHidden:!1},t}function B0(t,e,n){return t=Fs(6,t,null,e),t.lanes=n,t}function W0(t,e,n){return e=Fs(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Fz(t,e,n,s,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=$0(0),this.expirationTimes=$0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=$0(0),this.identifierPrefix=s,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Tb(t,e,n,s,r,o,i,a,l){return t=new Fz(t,e,n,a,l),e===1?(e=1,o===!0&&(e|=8)):e=0,o=Fs(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:s,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},cb(o),t}function Pz(t,e,n){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Xa,key:s==null?null:""+s,children:t,containerInfo:e,implementation:n}}function WE(t){if(!t)return ei;t=t._reactInternals;e:{if(wa(t)!==t||t.tag!==1)throw Error(re(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(es(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(re(171))}if(t.tag===1){var n=t.type;if(es(n))return W2(t,n,e)}return e}function UE(t,e,n,s,r,o,i,a,l){return t=Tb(n,s,!0,t,r,o,i,a,l),t.context=WE(null),n=t.current,s=Vn(),r=Ho(n),o=no(s,r),o.callback=e??null,Uo(n,o,r),t.current.lanes=r,Yc(t,r,s),ts(t,s),t}function wm(t,e,n,s){var r=e.current,o=Vn(),i=Ho(r);return n=WE(n),e.context===null?e.context=n:e.pendingContext=n,e=no(o,i),e.payload={element:t},s=s===void 0?null:s,s!==null&&(e.callback=s),t=Uo(r,e,i),t!==null&&(or(t,r,i,o),Th(t,r,i)),i}function up(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function xk(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Eb(t,e){xk(t,e),(t=t.alternate)&&xk(t,e)}function Oz(){return null}var GE=typeof reportError=="function"?reportError:function(t){console.error(t)};function Nb(t){this._internalRoot=t}$m.prototype.render=Nb.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(re(409));wm(t,e,null,null)};$m.prototype.unmount=Nb.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Zi(function(){wm(null,t,null,null)}),e[io]=null}};function $m(t){this._internalRoot=t}$m.prototype.unstable_scheduleHydration=function(t){if(t){var e=w2();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Ao.length&&e!==0&&e<Ao[n].priority;n++);Ao.splice(n,0,t),n===0&&C2(t)}};function Rb(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Cm(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function yk(){}function Lz(t,e,n,s,r){if(r){if(typeof s=="function"){var o=s;s=function(){var u=up(i);o.call(u)}}var i=UE(e,s,t,0,null,!1,!1,"",yk);return t._reactRootContainer=i,t[io]=i.current,Cc(t.nodeType===8?t.parentNode:t),Zi(),i}for(;r=t.lastChild;)t.removeChild(r);if(typeof s=="function"){var a=s;s=function(){var u=up(l);a.call(u)}}var l=Tb(t,0,!1,null,null,!1,!1,"",yk);return t._reactRootContainer=l,t[io]=l.current,Cc(t.nodeType===8?t.parentNode:t),Zi(function(){wm(e,l,n,s)}),l}function km(t,e,n,s,r){var o=n._reactRootContainer;if(o){var i=o;if(typeof r=="function"){var a=r;r=function(){var l=up(i);a.call(l)}}wm(e,i,t,r)}else i=Lz(n,e,t,r,s);return up(i)}v2=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Mu(e.pendingLanes);n!==0&&(qv(e,n|1),ts(e,Pt()),!(Ve&6)&&(Rl=Pt()+500,ui()))}break;case 13:Zi(function(){var s=ao(t,1);if(s!==null){var r=Vn();or(s,t,1,r)}}),Eb(t,1)}};Yv=function(t){if(t.tag===13){var e=ao(t,134217728);if(e!==null){var n=Vn();or(e,t,134217728,n)}Eb(t,134217728)}};b2=function(t){if(t.tag===13){var e=Ho(t),n=ao(t,e);if(n!==null){var s=Vn();or(n,t,e,s)}Eb(t,e)}};w2=function(){return Ze};$2=function(t,e){var n=Ze;try{return Ze=t,e()}finally{Ze=n}};Vx=function(t,e,n){switch(e){case"input":if(Fx(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var s=n[e];if(s!==t&&s.form===t.form){var r=pm(s);if(!r)throw Error(re(90));JT(s),Fx(s,r)}}}break;case"textarea":t2(t,n);break;case"select":e=n.value,e!=null&&dl(t,!!n.multiple,e,!1)}};l2=Cb;u2=Zi;var Mz={usingClientEntryPoint:!1,Events:[Zc,Ja,pm,i2,a2,Cb]},Su={findFiberByHostInstance:Ri,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},_z={bundleType:Su.bundleType,version:Su.version,rendererPackageName:Su.rendererPackageName,rendererConfig:Su.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:mo.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=f2(t),t===null?null:t.stateNode},findFiberByHostInstance:Su.findFiberByHostInstance||Oz,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Hf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Hf.isDisabled&&Hf.supportsFiber)try{cm=Hf.inject(_z),Tr=Hf}catch{}}xs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Mz;xs.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Rb(e))throw Error(re(200));return Pz(t,e,null,n)};xs.createRoot=function(t,e){if(!Rb(t))throw Error(re(299));var n=!1,s="",r=GE;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=Tb(t,1,!1,null,null,n,!1,s,r),t[io]=e.current,Cc(t.nodeType===8?t.parentNode:t),new Nb(e)};xs.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(re(188)):(t=Object.keys(t).join(","),Error(re(268,t)));return t=f2(e),t=t===null?null:t.stateNode,t};xs.flushSync=function(t){return Zi(t)};xs.hydrate=function(t,e,n){if(!Cm(e))throw Error(re(200));return km(null,t,e,!0,n)};xs.hydrateRoot=function(t,e,n){if(!Rb(t))throw Error(re(405));var s=n!=null&&n.hydratedSources||null,r=!1,o="",i=GE;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(i=n.onRecoverableError)),e=UE(e,null,t,1,n??null,r,!1,o,i),t[io]=e.current,Cc(t),s)for(t=0;t<s.length;t++)n=s[t],r=n._getVersion,r=r(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,r]:e.mutableSourceEagerHydrationData.push(n,r);return new $m(e)};xs.render=function(t,e,n){if(!Cm(e))throw Error(re(200));return km(null,t,e,!1,n)};xs.unmountComponentAtNode=function(t){if(!Cm(t))throw Error(re(40));return t._reactRootContainer?(Zi(function(){km(null,null,t,!1,function(){t._reactRootContainer=null,t[io]=null})}),!0):!1};xs.unstable_batchedUpdates=Cb;xs.unstable_renderSubtreeIntoContainer=function(t,e,n,s){if(!Cm(n))throw Error(re(200));if(t==null||t._reactInternals===void 0)throw Error(re(38));return km(t,e,n,!1,s)};xs.version="18.3.1-next-f1338f8080-20240426";function HE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(HE)}catch(t){console.error(t)}}HE(),HT.exports=xs;var jE=HT.exports;const zz=lm(jE);var KE,vk=jE;KE=Ix.createRoot=vk.createRoot,Ix.hydrateRoot=vk.hydrateRoot;var XE={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(t){(function(){var e={}.hasOwnProperty;function n(){for(var o="",i=0;i<arguments.length;i++){var a=arguments[i];a&&(o=r(o,s(a)))}return o}function s(o){if(typeof o=="string"||typeof o=="number")return o;if(typeof o!="object")return"";if(Array.isArray(o))return n.apply(null,o);if(o.toString!==Object.prototype.toString&&!o.toString.toString().includes("[native code]"))return o.toString();var i="";for(var a in o)e.call(o,a)&&o[a]&&(i=r(i,a));return i}function r(o,i){return i?o?o+" "+i:o+i:o}t.exports?(n.default=n,t.exports=n):window.classNames=n})()})(XE);var Vz=XE.exports;const xr=lm(Vz);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bz=1e-7,Wz=1e-4;class qE{constructor(e,n){this.backend=e,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,n){this.dataIdsCount++,this.data.set(e,n)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class Ab{refCount(e){return Kn("refCount")}incRef(e){return Kn("incRef")}timerAvailable(){return!0}time(e){return Kn("time")}read(e){return Kn("read")}readSync(e){return Kn("readSync")}readToGPU(e,n){return Kn("readToGPU")}numDataIds(){return Kn("numDataIds")}disposeData(e,n){return Kn("disposeData")}write(e,n,s){return Kn("write")}move(e,n,s,r,o){return Kn("move")}createTensorFromGPUData(e,n,s){return Kn("createTensorFromGPUData")}memory(){return Kn("memory")}floatPrecision(){return Kn("floatPrecision")}epsilon(){return this.floatPrecision()===32?Bz:Wz}dispose(){return Kn("dispose")}}function Kn(t){throw new Error(`'${t}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uz(t){let e=t.length,n=0;for(;e>0;)n=Math.random()*e|0,e--,Ga(t,e,n)}function Ji(t,e,n){return Math.max(t,Math.min(e,n))}function Db(t){return t%2===0?t:t+1}function Ga(t,e,n){const s=t[e];t[e]=t[n],t[n]=s}function Gz(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];return e}function N(t,e){if(!t)throw new Error(typeof e=="string"?e:e())}function Fb(t,e,n=""){N(He(t,e),()=>n+` Shapes ${t} and ${e} must match`)}function YE(t){N(t!=null,()=>"The input to the tensor constructor must be a non-null value.")}function Y(t){if(t.length===0)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}function He(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function Al(t){return t%1===0}function vy(t){const e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function xl(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function bk(t,e=r=>0,n,s){return new Promise((r,o)=>{let i=0;const a=()=>{if(t()){r();return}i++;const l=e(i);if(n!=null&&i>=n){o();return}s!=null?s(a,l):setTimeout(a,l)};a()})}function QE(t,e){let n=1,s=-1;for(let o=0;o<t.length;++o)if(t[o]>=0)n*=t[o];else if(t[o]===-1){if(s!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${s} and dim ${o}`);s=o}else if(t[o]<0)throw Error(`Shapes can not be < 0. Found ${t[o]} at dim ${o}`);if(s===-1){if(e>0&&e!==n)throw Error(`Size(${e}) must match the product of shape ${t}`);return t}if(n===0)throw Error(`Cannot infer the missing size in [${t}] when there are 0 elements`);if(e%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${n}`);const r=t.slice();return r[s]=e/n,r}function Ne(t,e){const n=e.length;return t=t==null?e.map((s,r)=>r):[].concat(t),N(t.every(s=>s>=-n&&s<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${t}`),N(t.every(s=>Al(s)),()=>`All values in axis param must be integers but got axis ${t}`),t.map(s=>s<0?n+s:s)}function ci(t,e){const n=[],s=[],r=e!=null&&Array.isArray(e)&&e.length===0,o=e==null||r?null:Ne(e,t).sort();let i=0;for(let a=0;a<t.length;++a){if(o!=null){if(o[i]===a&&t[a]!==1)throw new Error(`Can't squeeze axis ${a} since its dim '${t[a]}' is not 1`);(o[i]==null||o[i]>a)&&t[a]===1&&(n.push(t[a]),s.push(a)),o[i]<=a&&i++}t[a]!==1&&(n.push(t[a]),s.push(a))}return{newShape:n,keptDims:s}}function hn(t,e){return St(t,e)}function St(t,e){let n=null;if(t==null||t==="float32")n=new Float32Array(e);else if(t==="int32")n=new Int32Array(e);else if(t==="bool")n=new Uint8Array(e);else if(t==="string")n=new Array(e);else throw new Error(`Unknown data type ${t}`);return n}function Hz(t,e){for(let n=0;n<t.length;n++){const s=t[n];if(isNaN(s)||!isFinite(s))throw Error(`A tensor of type ${e} being uploaded contains ${s}.`)}}function jz(t){return t==="bool"||t==="complex64"||t==="float32"||t==="int32"||t==="string"}function ZE(t,e){return!(e==="complex64"||e==="float32"&&t!=="complex64"||e==="int32"&&t!=="float32"&&t!=="complex64"||e==="bool"&&t==="bool")}function cp(t){if(t==="float32"||t==="int32")return 4;if(t==="complex64")return 8;if(t==="bool")return 1;throw new Error(`Unknown dtype ${t}`)}function Kz(t){if(t==null)return 0;let e=0;return t.forEach(n=>e+=n.length),e}function ed(t){return typeof t=="string"||t instanceof String}function Xz(t){return typeof t=="boolean"}function by(t){return typeof t=="number"}function Xl(t){return Array.isArray(t)?Xl(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray?"int32":by(t)?"float32":ed(t)?"string":Xz(t)?"bool":"float32"}function wy(t){return!!(t&&t.constructor&&t.call&&t.apply)}function $y(t,e){for(let n=e;n<t;++n)if(t%n===0)return n;return t}function me(t){const e=t.length;if(e<2)return[];const n=new Array(e-1);n[e-2]=t[e-1];for(let s=e-3;s>=0;--s)n[s]=n[s+1]*t[s+1];return n}function JE(t,e,n,s=!1){const r=new Array;if(e.length===1){const o=e[0]*(s?2:1);for(let i=0;i<o;i++)r[i]=n[t+i]}else{const o=e[0],i=e.slice(1),a=i.reduce((l,u)=>l*u)*(s?2:1);for(let l=0;l<o;l++)r[l]=JE(t+l*a,i,n,s)}return r}function ir(t,e,n=!1){if(t.length===0)return e[0];const s=t.reduce((r,o)=>r*o)*(n?2:1);if(s===0)return[];if(s!==e.length)throw new Error(`[${t}] does not match the input size ${e.length}${n?" for a complex tensor":""}.`);return JE(0,t,e,n)}function qz(t,e){if(Array.isArray(t))return t;if(e==="float32")return t instanceof Float32Array?t:new Float32Array(t);if(e==="int32")return t instanceof Int32Array?t:new Int32Array(t);if(e==="bool"||e==="string")return Uint8Array.from(new Int32Array(t));throw new Error(`Unknown dtype ${e}`)}function Pb(t,e){const n=pn(t,e);for(let s=0;s<n.length;s++)n[s]=1;return n}function pn(t,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool")return new Uint8Array(t);throw new Error(`Unknown data type ${e}`)}function eN(t,e){const n=t.reduce((s,r)=>s*r,1);if(e==null||e==="float32")return ir(t,new Float32Array(n));if(e==="int32")return ir(t,new Int32Array(n));if(e==="bool")return ir(t,new Uint8Array(n));throw new Error(`Unknown data type ${e}`)}function go(t){t.forEach(e=>{N(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${t}].`)})}function Nr(t,e,n){if(e===0)return 0;if(e===1)return t[0];let s=t[t.length-1];for(let r=0;r<t.length-1;++r)s+=n[r]*t[r];return s}function ql(t,e,n){if(e===0)return[];if(e===1)return[t];const s=new Array(e);for(let r=0;r<s.length-1;++r)s[r]=Math.floor(t/n[r]),t-=s[r]*n[r];return s[s.length-1]=t,s}function Ob(t){return t&&t.then&&typeof t.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wk="tfjsflags";class Yz{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=Qz,this.populateURLFlags()}setPlatform(e,n){this.platform!=null&&(K().getBool("IS_TEST")||K().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=n}registerFlag(e,n,s){if(this.flagRegistry[e]={evaluationFn:n,setHook:s},this.urlFlags[e]!=null){const r=this.urlFlags[e];K().getBool("IS_TEST")||K().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${r}.`),this.set(e,r)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const n=this.evaluateFlag(e);if(Ob(n))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=n,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,n){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=n,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(n)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);wk in e&&e[wk].split(",").forEach(s=>{const[r,o]=s.split(":");this.urlFlags[r]=Jz(r,o)})}}function Qz(t){const e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...s)=>(Zz(e,s[0],s[1]),s.join("="))),e}function Zz(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}function Jz(t,e){const n=e.toLowerCase();return n==="true"||n==="false"?n==="true":`${+n}`===n?+n:e}function K(){return tN}let tN=null;function eV(t){tN=t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let U0;function nN(){if(U0==null){let t;if(typeof window<"u")t=window;else if(typeof global<"u")t=global;else if(typeof process<"u")t=process;else if(typeof self<"u")t=self;else throw new Error("Could not find a global object");U0=t}return U0}function tV(){const t=nN();return t._tfGlobals==null&&(t._tfGlobals=new Map),t._tfGlobals}function Lb(t,e){const n=tV();if(n.has(t))return n.get(t);{const s=e();return n.set(t,s),n.get(t)}}const Sm="Abs",td="Acos",nd="Acosh",Yl="Add",Mb="AddN",_b="All",zb="Any",Im="ArgMax",Tm="ArgMin",sd="Asin",rd="Asinh",od="Atan",id="Atanh",ad="Atan2",Em="AvgPool",Vb="AvgPoolGrad",Nm="AvgPool3D",Bb="AvgPool3DGrad",Rm="BatchMatMul",Am="BatchToSpaceND",Wb="Bincount",Ub="BitwiseAnd",nV="BroadcastTo",sN="BroadcastArgs",ld="Cast",ud="Ceil",cd="ClipByValue",Gb="Complex",Dm="ComplexAbs",Fm="Concat",Pm="Conv2D",Hb="Conv2DBackpropFilter",Om="Conv2DBackpropInput",Lm="Conv3D",jb="Conv3DBackpropFilterV2",Kb="Conv3DBackpropInputV2",dd="Cos",fd="Cosh",Xb="Cumprod",Mm="Cumsum",qb="CropAndResize",Yb="DenseBincount",Qb="DepthToSpace",_m="DepthwiseConv2dNative",Zb="DepthwiseConv2dNativeBackpropFilter",Jb="DepthwiseConv2dNativeBackpropInput",rN="Diag",zm="Dilation2D",Cy="Dilation2DBackpropInput",ky="Dilation2DBackpropFilter",sV="Draw",hd="RealDiv",e1="Einsum",pd="Elu",t1="EluGrad",md="Erf",Vm="Equal",gd="Exp",Bm="ExpandDims",xd="Expm1",n1="FFT",s1="Fill",r1="FlipLeftRight",yd="Floor",vd="FloorDiv",Wm="FusedBatchNorm",Um="GatherV2",oN="GatherNd",Gm="Greater",bd="GreaterEqual",wd="Identity",o1="IFFT",i1="Imag",$d="IsFinite",Cd="IsInf",kd="IsNan",Hm="LeakyRelu",jm="Less",Km="LessEqual",iN="LinSpace",Sd="Log",Id="Log1p",Xm="LogicalAnd",qm="LogicalNot",Ym="LogicalOr",rV="LogSoftmax",Qm="LRN",a1="LRNGrad",Zm="Max",Td="Maximum",Jm="MaxPool",l1="MaxPoolGrad",eg="MaxPool3D",u1="MaxPool3DGrad",aN="MaxPoolWithArgmax",tg="Mean",ng="Min",Ed="Minimum",sg="MirrorPad",Nd="Mod",lN="Multinomial",Rd="Multiply",rg="Neg",og="NotEqual",c1="NonMaxSuppressionV3",d1="NonMaxSuppressionV4",f1="NonMaxSuppressionV5",ig="OnesLike",ag="OneHot",lg="Pack",ug="PadV2",Ad="Pow",cg="Prelu",dg="Prod",uN="RaggedGather",cN="RaggedRange",dN="RaggedTensorToTensor",h1="Range",p1="Real",Dd="Reciprocal",Fd="Relu",fg="Reshape",hg="ResizeNearestNeighbor",m1="ResizeNearestNeighborGrad",pg="ResizeBilinear",g1="ResizeBilinearGrad",Pd="Relu6",mg="Reverse",Od="Round",Ld="Rsqrt",fN="ScatterNd",hN="TensorScatterUpdate",pN="SearchSorted",gg="Select",Md="Selu",xg="Slice",_d="Sin",zd="Sinh",Vd="Sign",Bd="Sigmoid",Wd="Softplus",Ud="Sqrt",yg="Sum",vg="SpaceToBatchND",bg="SplitV",wg="Softmax",mN="SparseFillEmptyRows",gN="SparseReshape",xN="SparseSegmentMean",yN="SparseSegmentSum",vN="SparseToDense",Gd="SquaredDifference",x1="Square",y1="StaticRegexReplace",v1="StridedSlice",bN="StringNGrams",wN="StringSplit",$N="StringToHashBucketFast",Hd="Sub",jd="Tan",Kd="Tanh",Xd="Tile",b1="TopK",w1="Transform",yl="Transpose",$1="Unique",$g="Unpack",Cg="UnsortedSegmentSum",kg="ZerosLike",qd="Step",oV="FromPixels",C1="RotateWithOffset",dp="_FusedMatMul",fp="FusedConv2D",CN="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cs(...t){K().getBool("IS_TEST")||K().getBool("PROD")||console.warn(...t)}function iV(...t){K().getBool("IS_TEST")||K().getBool("PROD")||console.log(...t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hp=Lb("kernelRegistry",()=>new Map),Sy=Lb("gradRegistry",()=>new Map);function $k(t,e){const n=SN(t,e);return hp.get(n)}function Ck(t){return Sy.get(t)}function kk(t){const e=hp.entries(),n=[];for(;;){const{done:s,value:r}=e.next();if(s)break;const[o,i]=r,[a]=o.split("_");a===t&&n.push(i)}return n}function kN(t){const{kernelName:e,backendName:n}=t,s=SN(e,n);hp.has(s)&&cs(`The kernel '${e}' for backend '${n}' is already registered`),hp.set(s,t)}function aV(t){const{kernelName:e}=t;Sy.has(e)&&K().getBool("DEBUG")&&cs(`Overriding the gradient for '${e}'`),Sy.set(e,t)}function SN(t,e){return`${e}_${t}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IN(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray}var TN=ut,Ps=null;try{Ps=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function ut(t,e,n){this.low=t|0,this.high=e|0,this.unsigned=!!n}ut.prototype.__isLong__;Object.defineProperty(ut.prototype,"__isLong__",{value:!0});function is(t){return(t&&t.__isLong__)===!0}ut.isLong=is;var Sk={},Ik={};function $a(t,e){var n,s,r;return e?(t>>>=0,(r=0<=t&&t<256)&&(s=Ik[t],s)?s:(n=ct(t,(t|0)<0?-1:0,!0),r&&(Ik[t]=n),n)):(t|=0,(r=-128<=t&&t<128)&&(s=Sk[t],s)?s:(n=ct(t,t<0?-1:0,!1),r&&(Sk[t]=n),n))}ut.fromInt=$a;function Os(t,e){if(isNaN(t))return e?Fi:Ls;if(e){if(t<0)return Fi;if(t>=EN)return AN}else{if(t<=-Ek)return Qn;if(t+1>=Ek)return RN}return t<0?Os(-t,e).neg():ct(t%Dl|0,t/Dl|0,e)}ut.fromNumber=Os;function ct(t,e,n){return new ut(t,e,n)}ut.fromBits=ct;var pp=Math.pow;function k1(t,e,n){if(t.length===0)throw Error("empty string");if(t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return Ls;if(typeof e=="number"?(n=e,e=!1):e=!!e,n=n||10,n<2||36<n)throw RangeError("radix");var s;if((s=t.indexOf("-"))>0)throw Error("interior hyphen");if(s===0)return k1(t.substring(1),e,n).neg();for(var r=Os(pp(n,8)),o=Ls,i=0;i<t.length;i+=8){var a=Math.min(8,t.length-i),l=parseInt(t.substring(i,i+a),n);if(a<8){var u=Os(pp(n,a));o=o.mul(u).add(Os(l))}else o=o.mul(r),o=o.add(Os(l))}return o.unsigned=e,o}ut.fromString=k1;function hr(t,e){return typeof t=="number"?Os(t,e):typeof t=="string"?k1(t,e):ct(t.low,t.high,typeof e=="boolean"?e:t.unsigned)}ut.fromValue=hr;var Tk=65536,lV=1<<24,Dl=Tk*Tk,EN=Dl*Dl,Ek=EN/2,Nk=$a(lV),Ls=$a(0);ut.ZERO=Ls;var Fi=$a(0,!0);ut.UZERO=Fi;var il=$a(1);ut.ONE=il;var NN=$a(1,!0);ut.UONE=NN;var Iy=$a(-1);ut.NEG_ONE=Iy;var RN=ct(-1,2147483647,!1);ut.MAX_VALUE=RN;var AN=ct(-1,-1,!0);ut.MAX_UNSIGNED_VALUE=AN;var Qn=ct(0,-2147483648,!1);ut.MIN_VALUE=Qn;var ie=ut.prototype;ie.toInt=function(){return this.unsigned?this.low>>>0:this.low};ie.toNumber=function(){return this.unsigned?(this.high>>>0)*Dl+(this.low>>>0):this.high*Dl+(this.low>>>0)};ie.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(Qn)){var n=Os(e),s=this.div(n),r=s.mul(n).sub(this);return s.toString(e)+r.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var o=Os(pp(e,6),this.unsigned),i=this,a="";;){var l=i.div(o),u=i.sub(l.mul(o)).toInt()>>>0,c=u.toString(e);if(i=l,i.isZero())return c+a;for(;c.length<6;)c="0"+c;a=""+c+a}};ie.getHighBits=function(){return this.high};ie.getHighBitsUnsigned=function(){return this.high>>>0};ie.getLowBits=function(){return this.low};ie.getLowBitsUnsigned=function(){return this.low>>>0};ie.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Qn)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,n=31;n>0&&!(e&1<<n);n--);return this.high!=0?n+33:n+1};ie.isZero=function(){return this.high===0&&this.low===0};ie.eqz=ie.isZero;ie.isNegative=function(){return!this.unsigned&&this.high<0};ie.isPositive=function(){return this.unsigned||this.high>=0};ie.isOdd=function(){return(this.low&1)===1};ie.isEven=function(){return(this.low&1)===0};ie.equals=function(e){return is(e)||(e=hr(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};ie.eq=ie.equals;ie.notEquals=function(e){return!this.eq(e)};ie.neq=ie.notEquals;ie.ne=ie.notEquals;ie.lessThan=function(e){return this.comp(e)<0};ie.lt=ie.lessThan;ie.lessThanOrEqual=function(e){return this.comp(e)<=0};ie.lte=ie.lessThanOrEqual;ie.le=ie.lessThanOrEqual;ie.greaterThan=function(e){return this.comp(e)>0};ie.gt=ie.greaterThan;ie.greaterThanOrEqual=function(e){return this.comp(e)>=0};ie.gte=ie.greaterThanOrEqual;ie.ge=ie.greaterThanOrEqual;ie.compare=function(e){if(is(e)||(e=hr(e)),this.eq(e))return 0;var n=this.isNegative(),s=e.isNegative();return n&&!s?-1:!n&&s?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};ie.comp=ie.compare;ie.negate=function(){return!this.unsigned&&this.eq(Qn)?Qn:this.not().add(il)};ie.neg=ie.negate;ie.add=function(e){is(e)||(e=hr(e));var n=this.high>>>16,s=this.high&65535,r=this.low>>>16,o=this.low&65535,i=e.high>>>16,a=e.high&65535,l=e.low>>>16,u=e.low&65535,c=0,d=0,f=0,h=0;return h+=o+u,f+=h>>>16,h&=65535,f+=r+l,d+=f>>>16,f&=65535,d+=s+a,c+=d>>>16,d&=65535,c+=n+i,c&=65535,ct(f<<16|h,c<<16|d,this.unsigned)};ie.subtract=function(e){return is(e)||(e=hr(e)),this.add(e.neg())};ie.sub=ie.subtract;ie.multiply=function(e){if(this.isZero())return Ls;if(is(e)||(e=hr(e)),Ps){var n=Ps.mul(this.low,this.high,e.low,e.high);return ct(n,Ps.get_high(),this.unsigned)}if(e.isZero())return Ls;if(this.eq(Qn))return e.isOdd()?Qn:Ls;if(e.eq(Qn))return this.isOdd()?Qn:Ls;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(Nk)&&e.lt(Nk))return Os(this.toNumber()*e.toNumber(),this.unsigned);var s=this.high>>>16,r=this.high&65535,o=this.low>>>16,i=this.low&65535,a=e.high>>>16,l=e.high&65535,u=e.low>>>16,c=e.low&65535,d=0,f=0,h=0,p=0;return p+=i*c,h+=p>>>16,p&=65535,h+=o*c,f+=h>>>16,h&=65535,h+=i*u,f+=h>>>16,h&=65535,f+=r*c,d+=f>>>16,f&=65535,f+=o*u,d+=f>>>16,f&=65535,f+=i*l,d+=f>>>16,f&=65535,d+=s*c+r*u+o*l+i*a,d&=65535,ct(h<<16|p,d<<16|f,this.unsigned)};ie.mul=ie.multiply;ie.divide=function(e){if(is(e)||(e=hr(e)),e.isZero())throw Error("division by zero");if(Ps){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var n=(this.unsigned?Ps.div_u:Ps.div_s)(this.low,this.high,e.low,e.high);return ct(n,Ps.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?Fi:Ls;var s,r,o;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return Fi;if(e.gt(this.shru(1)))return NN;o=Fi}else{if(this.eq(Qn)){if(e.eq(il)||e.eq(Iy))return Qn;if(e.eq(Qn))return il;var i=this.shr(1);return s=i.div(e).shl(1),s.eq(Ls)?e.isNegative()?il:Iy:(r=this.sub(e.mul(s)),o=s.add(r.div(e)),o)}else if(e.eq(Qn))return this.unsigned?Fi:Ls;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();o=Ls}for(r=this;r.gte(e);){s=Math.max(1,Math.floor(r.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(s)/Math.LN2),l=a<=48?1:pp(2,a-48),u=Os(s),c=u.mul(e);c.isNegative()||c.gt(r);)s-=l,u=Os(s,this.unsigned),c=u.mul(e);u.isZero()&&(u=il),o=o.add(u),r=r.sub(c)}return o};ie.div=ie.divide;ie.modulo=function(e){if(is(e)||(e=hr(e)),Ps){var n=(this.unsigned?Ps.rem_u:Ps.rem_s)(this.low,this.high,e.low,e.high);return ct(n,Ps.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};ie.mod=ie.modulo;ie.rem=ie.modulo;ie.not=function(){return ct(~this.low,~this.high,this.unsigned)};ie.and=function(e){return is(e)||(e=hr(e)),ct(this.low&e.low,this.high&e.high,this.unsigned)};ie.or=function(e){return is(e)||(e=hr(e)),ct(this.low|e.low,this.high|e.high,this.unsigned)};ie.xor=function(e){return is(e)||(e=hr(e)),ct(this.low^e.low,this.high^e.high,this.unsigned)};ie.shiftLeft=function(e){return is(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?ct(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):ct(0,this.low<<e-32,this.unsigned)};ie.shl=ie.shiftLeft;ie.shiftRight=function(e){return is(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?ct(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):ct(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};ie.shr=ie.shiftRight;ie.shiftRightUnsigned=function(e){if(is(e)&&(e=e.toInt()),e&=63,e===0)return this;var n=this.high;if(e<32){var s=this.low;return ct(s>>>e|n<<32-e,n>>>e,this.unsigned)}else return e===32?ct(n,0,this.unsigned):ct(n>>>e-32,0,this.unsigned)};ie.shru=ie.shiftRightUnsigned;ie.shr_u=ie.shiftRightUnsigned;ie.toSigned=function(){return this.unsigned?ct(this.low,this.high,!1):this};ie.toUnsigned=function(){return this.unsigned?this:ct(this.low,this.high,!0)};ie.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};ie.toBytesLE=function(){var e=this.high,n=this.low;return[n&255,n>>>8&255,n>>>16&255,n>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};ie.toBytesBE=function(){var e=this.high,n=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,n>>>24,n>>>16&255,n>>>8&255,n&255]};ut.fromBytes=function(e,n,s){return s?ut.fromBytesLE(e,n):ut.fromBytesBE(e,n)};ut.fromBytesLE=function(e,n){return new ut(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,n)};ut.fromBytesBE=function(e,n){return new ut(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],n)};const DN=lm(TN),uV=f_({__proto__:null,default:DN},[TN]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ti=DN||uV;function Sg(t){return Ti.fromString(t,!0,16)}const FN=Sg("c3a5c85c97cb3127"),Si=Sg("b492b66fbe98f273"),Sn=Sg("9ae16a3b2f90404f");function Ty(t){return t.xor(t.shru(47))}function PN(t,e,n){const s=t.slice(e,e+n);return Ti.fromBytes(Array.from(s),!0,!0)}function nt(t,e){return PN(t,e,8)}function Rk(t,e){return PN(t,e,4)}function Xt(t,e){return e===0?t:t.shru(e).or(t.shl(64-e))}function Ko(t,e,n=Sg("9ddfea08eb382d69")){let s=t.xor(e).mul(n);s=s.xor(s.shru(47));let r=e.xor(s).mul(n);return r=r.xor(r.shru(47)),r=r.mul(n),r}function cV(t,e,n,s,r,o){r=r.add(t),o=Xt(o.add(r).add(s),21);const i=r;return r=r.add(e),r=r.add(n),o=o.add(Xt(r,44)),[r.add(s),o.add(i)]}function jf(t,e,n,s){return cV(nt(t,e),nt(t,e+8),nt(t,e+16),nt(t,e+24),n,s)}function dV(t,e=t.length){if(e>=8){const n=Sn.add(e*2),s=nt(t,0).add(Sn),r=nt(t,e-8),o=Xt(r,37).mul(n).add(s),i=Xt(s,25).add(r).mul(n);return Ko(o,i,n)}if(e>=4){const n=Sn.add(e*2),s=Rk(t,0);return Ko(s.shl(3).add(e),Rk(t,e-4),n)}if(e>0){const n=t[0],s=t[e>>1],r=t[e-1],o=n+(s<<8),i=e+(r<<2);return Ty(Sn.mul(o).xor(FN.mul(i))).mul(Sn)}return Sn}function fV(t,e=t.length){const n=Sn.add(e*2),s=nt(t,0).mul(Si),r=nt(t,8),o=nt(t,e-8).mul(n),i=nt(t,e-16).mul(Sn);return Ko(Xt(s.add(r),43).add(Xt(o,30)).add(i),s.add(Xt(r.add(Sn),18)).add(o),n)}function hV(t,e=t.length){const n=Sn.add(e*2),s=nt(t,0).mul(Sn),r=nt(t,8),o=nt(t,e-8).mul(n),i=nt(t,e-16).mul(Sn),a=Xt(s.add(r),43).add(Xt(o,30)).add(i),l=Ko(a,s.add(Xt(r.add(Sn),18)).add(o),n),u=nt(t,16).mul(n),c=nt(t,24),d=a.add(nt(t,e-32)).mul(n),f=l.add(nt(t,e-24)).mul(n);return Ko(Xt(u.add(c),43).add(Xt(d,30)).add(f),u.add(Xt(c.add(s),18)).add(d),n)}function pV(t,e=t.length){const n=Ti.fromNumber(81,!0);if(e<=32)return e<=16?dV(t,e):fV(t,e);if(e<=64)return hV(t,e);let s=n,r=n.mul(Si).add(113),o=Ty(r.mul(Sn).add(113)).mul(Sn),i=[Ti.UZERO,Ti.UZERO],a=[Ti.UZERO,Ti.UZERO];s=s.mul(Sn).add(nt(t,0));let l=0;const u=(e-1>>6)*64,c=u+(e-1&63)-63;do s=Xt(s.add(r).add(i[0]).add(nt(t,l+8)),37).mul(Si),r=Xt(r.add(i[1]).add(nt(t,l+48)),42).mul(Si),s=s.xor(a[1]),r=r.add(i[0]).add(nt(t,l+40)),o=Xt(o.add(a[0]),33).mul(Si),i=jf(t,l,i[1].mul(Si),s.add(a[0])),a=jf(t,l+32,o.add(a[1]),r.add(nt(t,l+16))),[o,s]=[s,o],l+=64;while(l!==u);const d=Si.add(o.and(255).shl(1));return l=c,a[0]=a[0].add(e-1&63),i[0]=i[0].add(a[0]),a[0]=a[0].add(i[0]),s=Xt(s.add(r).add(i[0]).add(nt(t,l+8)),37).mul(d),r=Xt(r.add(i[1]).add(nt(t,l+48)),42).mul(d),s=s.xor(a[1].mul(9)),r=r.add(i[0].mul(9).add(nt(t,l+40))),o=Xt(o.add(a[0]),33).mul(d),i=jf(t,l,i[1].mul(d),s.add(a[0])),a=jf(t,l+32,o.add(a[1]),r.add(nt(t,l+16))),[o,s]=[s,o],Ko(Ko(i[0],a[0],d).add(Ty(r).mul(FN)).add(o),Ko(i[1],a[1],d).add(s),d)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function di(t,e){return e==="string"?Xo(t):Ca([t],e)}function mV(t,e){return t instanceof Float32Array&&e==="float32"||t instanceof Int32Array&&e==="int32"||t instanceof Uint8Array&&e==="bool"}function Ca(t,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=ea(t)),K().getBool("DEBUG")&&Hz(t,e),mV(t,e))return t;if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool"){const n=new Uint8Array(t.length);for(let s=0;s<n.length;++s)Math.round(t[s])!==0&&(n[s]=1);return n}else throw new Error(`Unknown data type ${e}`)}function Ln(){return K().platform.now()}function Xo(t,e="utf-8"){return e=e||"utf-8",K().platform.encode(t,e)}function ti(t,e="utf-8"){return e=e||"utf-8",K().platform.decode(t,e)}function Ws(t){return K().platform.isTypedArray!=null?K().platform.isTypedArray(t):IN(t)}function ea(t,e=[],n=!1){if(e==null&&(e=[]),typeof t=="boolean"||typeof t=="number"||typeof t=="string"||Ob(t)||t==null||Ws(t)&&n)e.push(t);else if(Array.isArray(t)||Ws(t))for(let s=0;s<t.length;++s)ea(t[s],e,n);else{let s=-1;for(const r of Object.keys(t))/^([1-9]+[0-9]*|0)$/.test(r)&&(s=Math.max(s,Number(r)));for(let r=0;r<=s;r++)ea(t[r],e,n)}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gV{constructor(e,n){this.backendTimer=e,this.logger=n,n==null&&(this.logger=new yV)}profileKernel(e,n,s){let r;const o=()=>{r=s()};let i;const a=Ln();if(this.backendTimer.timerAvailable())i=this.backendTimer.time(o);else{o();for(const u of r)u.dataSync();i=Promise.resolve({kernelMs:Ln()-a})}if(K().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let u=0;u<r.length;u++){const c=r[u];c.data().then(d=>{xV(d,c.dtype,e)})}return{kernelName:e,outputs:r,inputs:n,timeMs:i.then(u=>u.kernelMs),extraInfo:i.then(u=>u.getExtraProfileInfo!=null?u.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:n,outputs:s,timeMs:r,inputs:o,extraInfo:i}=e;s.forEach(a=>{Promise.all([a.data(),r,i]).then(l=>{this.logger.logKernelProfile(n,a,l[0],l[1],o,l[2])})})}}function xV(t,e,n){if(e!=="float32")return!1;for(let s=0;s<t.length;s++){const r=t[s];if(isNaN(r)||!isFinite(r))return console.warn(`Found ${r} in the result of '${n}'`),!0}return!1}class yV{logKernelProfile(e,n,s,r,o,i){const a=typeof r=="number"?xl(`${r}ms`,9):r.error,l=xl(e,25),u=n.rank,c=n.size,d=xl(n.shape.toString(),14);let f="";for(const h in o){const p=o[h];if(p!=null){const g=p.shape||n.shape,y=g.length;f+=`${h}: ${y}D ${y>0?g:""} `}}console.log(`%c${l}	%c${a}	%c${u}D ${d}	%c${c}	%c${f}	%c${i}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vV(t,e,n){const s={},r={};for(let l=0;l<e.length;l++)s[e[l].id]=!0;for(let l=0;l<t.length;l++){const u=t[l],c=u.inputs;for(const d in c){const f=c[d];let h=!1;for(let p=0;p<e.length;p++)if(s[f.id]){u.outputs.forEach(g=>s[g.id]=!0),h=!0,r[u.id]=!0;break}if(h)break}}const o={};o[n.id]=!0;const i={};for(let l=t.length-1;l>=0;l--){const u=t[l],c=u.inputs;for(let d=0;d<u.outputs.length;d++)if(o[u.outputs[d].id]){for(const f in c)o[c[f].id]=!0,i[u.id]=!0;break}}const a=[];for(let l=0;l<t.length;l++){const u=t[l];if(r[u.id]&&i[u.id]){const c={};for(const f in u.inputs){const h=u.inputs[f];s[h.id]&&(c[f]=h)}const d=Object.assign({},u);d.inputs=c,d.outputs=u.outputs,a.push(d)}}return a}function bV(t,e,n,s){for(let r=e.length-1;r>=0;r--){const o=e[r],i=[];if(o.outputs.forEach(l=>{const u=t[l.id];u!=null?i.push(u):i.push(null)}),o.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${o.kernelName}.`);const a=o.gradient(i);for(const l in o.inputs){if(!(l in a))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(a)}.`);const u=n(()=>a[l]());if(u.dtype!=="float32")throw new Error(`Error in gradient for op ${o.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${u.dtype}'`);const c=o.inputs[l];if(!He(u.shape,c.shape))throw new Error(`Error in gradient for op ${o.kernelName}. The gradient of input '${l}' has shape '${u.shape}', which does not match the shape of the input '${c.shape}'`);if(t[c.id]==null)t[c.id]=u;else{const d=t[c.id];t[c.id]=s(d,u),d.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ak=20,Iu=3,G0=7;function wV(t,e,n,s){const r=me(e),o=$V(t,e,n,r),i=e.length,a=Ph(t,e,n,r,o),l=["Tensor"];return s&&(l.push(`  dtype: ${n}`),l.push(`  rank: ${i}`),l.push(`  shape: [${e}]`),l.push("  values:")),l.push(a.map(u=>"    "+u).join(`
`)),l.join(`
`)}function $V(t,e,n,s){const r=Y(e),o=s[s.length-1],i=new Array(o).fill(0),a=e.length,l=n==="complex64"?Vu(t):t;if(a>1)for(let u=0;u<r/o;u++){const c=u*o;for(let d=0;d<o;d++)i[d]=Math.max(i[d],zu(l[c+d],0,n).length)}return i}function zu(t,e,n){let s;return Array.isArray(t)?s=`${parseFloat(t[0].toFixed(G0))} + ${parseFloat(t[1].toFixed(G0))}j`:ed(t)?s=`'${t}'`:n==="bool"?s=ON(t):s=parseFloat(t.toFixed(G0)).toString(),xl(s,e)}function ON(t){return t===0?"false":"true"}function Ph(t,e,n,s,r,o=!0){const i=n==="complex64"?2:1,a=e[0],l=e.length;if(l===0){if(n==="complex64"){const g=Vu(t);return[zu(g[0],0,n)]}return n==="bool"?[ON(t[0])]:[t[0].toString()]}if(l===1){if(a>Ak){const y=Iu*i;let m=Array.from(t.slice(0,y)),x=Array.from(t.slice((a-Iu)*i,a*i));return n==="complex64"&&(m=Vu(m),x=Vu(x)),["["+m.map((v,b)=>zu(v,r[b],n)).join(", ")+", ..., "+x.map((v,b)=>zu(v,r[a-Iu+b],n)).join(", ")+"]"]}return["["+(n==="complex64"?Vu(t):Array.from(t)).map((y,m)=>zu(y,r[m],n)).join(", ")+"]"]}const u=e.slice(1),c=s.slice(1),d=s[0]*i,f=[];if(a>Ak){for(let g=0;g<Iu;g++){const y=g*d,m=y+d;f.push(...Ph(t.slice(y,m),u,n,c,r,!1))}f.push("...");for(let g=a-Iu;g<a;g++){const y=g*d,m=y+d;f.push(...Ph(t.slice(y,m),u,n,c,r,g===a-1))}}else for(let g=0;g<a;g++){const y=g*d,m=y+d;f.push(...Ph(t.slice(y,m),u,n,c,r,g===a-1))}const h=l===2?",":"";f[0]="["+(a>0?f[0]+h:"");for(let g=1;g<f.length-1;g++)f[g]=" "+f[g]+h;let p=`,
`;for(let g=2;g<l;g++)p+=`
`;return f[f.length-1]=" "+f[f.length-1]+"]"+(o?"":p),f}function Vu(t){const e=[];for(let n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sn{constructor(e,n,s){if(this.dtype=n,this.shape=e.slice(),this.size=Y(e),s!=null){const r=s.length;N(r===this.size,()=>`Length of values '${r}' does not match the size inferred by the shape '${this.size}'.`)}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=s||St(n,this.size),this.strides=me(e)}set(e,...n){n.length===0&&(n=[0]),N(n.length===this.rank,()=>`The number of provided coordinates (${n.length}) must match the rank (${this.rank})`);const s=this.locToIndex(n);this.values[s]=e}get(...e){e.length===0&&(e=[0]);let n=0;for(const r of e){if(r<0||r>=this.shape[n]){const o=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(o)}n++}let s=e[e.length-1];for(let r=0;r<e.length-1;++r)s+=this.strides[r]*e[r];return this.values[s]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let n=e[e.length-1];for(let s=0;s<e.length-1;++s)n+=this.strides[s]*e[s];return n}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const n=new Array(this.shape.length);for(let s=0;s<n.length-1;++s)n[s]=Math.floor(e/this.strides[s]),e-=n[s]*this.strides[s];return n[n.length-1]=e,n}get rank(){return this.shape.length}toTensor(){return tr().makeTensor(this.values,this.shape,this.dtype)}}let tr=null,Ha=null;function CV(t){tr=t}function kV(t){Ha=t}class zt{constructor(e,n,s,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=n||"float32",this.size=Y(e),this.strides=me(e),this.dataId=s,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return Ha.buffer(this.shape,this.dtype,e)}bufferSync(){return Ha.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return ir(this.shape,e,this.dtype==="complex64")}arraySync(){return ir(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=tr().read(this.dataId);if(this.dtype==="string"){const n=await e;try{return n.map(s=>ti(s))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),tr().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=tr().readSync(this.dataId);if(this.dtype==="string")try{return e.map(n=>ti(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await tr().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),tr().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return Ha.print(this,e)}clone(){return this.throwIfDisposed(),Ha.clone(this)}toString(e=!1){const n=this.dataSync();return wV(n,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),Ha.cast(this,e)}variable(e=!0,n,s){return this.throwIfDisposed(),tr().makeVariable(this,e,n,s)}}Object.defineProperty(zt,Symbol.hasInstance,{value:t=>!!t&&t.data!=null&&t.dataSync!=null&&t.throwIfDisposed!=null});function q(){return Lb("Tensor",()=>zt)}q();class mp extends zt{constructor(e,n,s,r){super(e.shape,e.dtype,e.dataId,r),this.trainable=n,this.name=s}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!He(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);tr().disposeTensor(this),this.dataId=e.dataId,tr().incRef(this,null)}dispose(){tr().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(mp,Symbol.hasInstance,{value:t=>t instanceof zt&&t.assign!=null&&t.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Dk;(function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"})(Dk||(Dk={}));var Ey;(function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"})(Ey||(Ey={}));var Ny;(function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"})(Ny||(Ny={}));var Ry;(function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"})(Ry||(Ry={}));var Ay;(function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"})(Ay||(Ay={}));const SV={float32:Ry,int32:Ey,bool:Ny,complex64:Ay};function ss(t,e){if(t==="string"||e==="string"){if(t==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${t} with ${e}`)}return SV[t][e]}function S1(t){return ss(t,"int32")}function LN(t){return t!=null&&typeof t=="object"&&"texture"in t&&t.texture instanceof WebGLTexture}function MN(t){return typeof GPUBuffer<"u"&&t!=null&&typeof t=="object"&&"buffer"in t&&t.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Et(t,e){if(t.dtype===e.dtype)return[t,e];const n=ss(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function _N(t){const e=[];return zN(t,e,new Set),e}function zN(t,e,n){if(t==null)return;if(t instanceof zt){e.push(t);return}if(!IV(t))return;const s=t;for(const r in s){const o=s[r];n.has(o)||(n.add(o),zN(o,e,n))}}function IV(t){return Array.isArray(t)||typeof t=="object"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H0(t){return t.kernelName!=null}class Fk{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class Fl{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new Fk}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const s=e[n];if(await this.initializeBackend(s).success){await this.setBackend(s);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:n}=this.initializeBackendsAndReturnBest();if(n)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:n}=this.initializeBackend(e);if(n)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,n,s=1){return e in this.registryFactory?(cs(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:n,priority:s},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:n,asyncInit:s}=this.initializeBackend(e);if(!(s?await n:n))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new gV(this.backendInstance),!0}setupRegisteredKernels(){kk(this.backendName).forEach(n=>{n.setupFunc!=null&&n.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){kk(e).forEach(s=>{s.disposeFunc!=null&&s.disposeFunc(this.registry[e])})}initializeBackend(e){const n=this.registryFactory[e];if(n==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const s=n.factory();if(s&&!(s instanceof Ab)&&typeof s.then=="function"){const r=++this.pendingBackendInitId,o=s.then(i=>r<this.pendingBackendInitId?!1:(this.registry[e]=i,this.pendingBackendInit=null,!0)).catch(i=>(r<this.pendingBackendInitId||(this.pendingBackendInit=null,cs(`Initialization of backend ${e} failed`),cs(i.stack||i.message)),!1));return this.pendingBackendInit=o,{success:o,asyncInit:!0}}else return this.registry[e]=s,{success:!0,asyncInit:!1}}catch(s){return cs(`Initialization of backend ${e} failed`),cs(s.stack||s.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,n)=>this.registryFactory[n].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const s=e[n],{success:r,asyncInit:o}=this.initializeBackend(s);if(o||r)return{name:s,asyncInit:o}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,n){const s=this.state.tensorInfo.get(n),r=s.backend,o=this.readSync(n),i=r.refCount(n);r.disposeData(n,!0),s.backend=e,e.move(n,o,s.shape,s.dtype,i),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,n){let s=null;if(n==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");n=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");s=e}let r;return this.scopedRun(()=>this.startScope(s),()=>this.endScope(r),()=>(r=n(),r instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r))}scopedRun(e,n,s){e();try{const r=s();return n(),r}catch(r){throw n(),r}}nextTensorId(){return Fl.nextTensorId++}nextVariableId(){return Fl.nextVariableId++}clone(e){const n=V.runKernel(wd,{x:e}),s={x:e},r=i=>({x:()=>{const a="float32",l={x:i},u={dtype:a};return V.runKernel(ld,l,u)}}),o=[];return this.addTapeNode(this.state.activeScope.name,s,[n],r,o,{}),n}runKernel(e,n,s){if(this.backendName==null&&this.backend,!($k(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:n,attrs:s})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,n,s){const r=this.backend.numDataIds();let o=0;s.forEach(l=>{o+=l.dtype==="complex64"?3:1});const i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],a=r-n-o-i;if(a>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${a} data ids) after running '${e}'`)}runKernelFunc(e){let n,s=[];const r=this.isTapeOn(),o=this.state.numBytes,i=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let a;this.backendName==null&&this.backend;let l;const u=H0(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(H0(e)){const{kernelName:p,inputs:g,attrs:y}=e;this.backendName==null&&this.backend;const m=$k(p,this.backendName);N(m!=null,()=>`Cannot find registered kernel '${p}' for backend '${this.backendName}'`),a=()=>{const x=this.backend.numDataIds();l=m.kernelFunc({inputs:g,attrs:y,backend:this.backend});const v=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(p,x,v);const b=v.map($=>$.rank!=null?$:this.makeTensorFromTensorInfo($));if(r){const $=this.getTensorsForGradient(p,g,b);s=this.saveTensorsForBackwardMode($)}return b}}else{const{forwardFunc:p}=e,g=y=>{r&&(s=y.map(m=>this.keep(this.clone(m))))};a=()=>{const y=this.backend.numDataIds();l=this.tidy(()=>p(this.backend,g));const m=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(u,y,m),m}}const{inputs:c,attrs:d}=e,f=H0(e)?null:e.backwardsFunc;let h;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?n=a():(h=this.profiler.profileKernel(u,c,()=>a()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(h),n=h.outputs)}),r&&this.addTapeNode(u,c,n,f,s,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:u,bytesAdded:this.state.numBytes-o,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-i,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(c).map(p=>c[p]!=null?c[p].shape:null),outputShapes:n.map(p=>p.shape),kernelTimeMs:h.timeMs,extraInfo:h.extraInfo}),Array.isArray(l)?n:n[0]}saveTensorsForBackwardMode(e){return e.map(s=>this.keep(this.clone(s)))}getTensorsForGradient(e,n,s){const r=Ck(e);if(r!=null){const o=r.inputsToSave||[],i=r.outputsToSave||[];let a;r.saveAllInputs?(N(Array.isArray(n),()=>"saveAllInputs is true, expected inputs to be an array."),a=Object.keys(n).map(u=>n[u])):a=o.map(u=>n[u]);const l=s.filter((u,c)=>i[c]);return a.concat(l)}return[]}makeTensor(e,n,s,r){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");s=s||"float32",r=r||this.backend;let o=e;s==="string"&&ed(e[0])&&(o=e.map(l=>Xo(l)));const i=r.write(o,n,s),a=new zt(n,s,i,this.nextTensorId());if(this.trackTensor(a,r),s==="string"){const l=this.state.tensorInfo.get(i),u=Kz(o);this.state.numBytes+=u-l.bytes,l.bytes=u}return a}makeTensorFromDataId(e,n,s,r){s=s||"float32";const o={dataId:e,shape:n,dtype:s};return this.makeTensorFromTensorInfo(o,r)}makeTensorFromTensorInfo(e,n){const{dataId:s,shape:r,dtype:o}=e,i=new zt(r,o,s,this.nextTensorId());return this.trackTensor(i,n),i}makeVariable(e,n=!0,s,r){s=s||this.nextVariableId().toString(),r!=null&&r!==e.dtype&&(e=e.cast(r));const o=new mp(e,n,s,this.nextTensorId());if(this.state.registeredVariables[o.name]!=null)throw new Error(`Variable with name ${o.name} was already registered`);return this.state.registeredVariables[o.name]=o,this.incRef(o,this.backend),o}trackTensor(e,n){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let s=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(s=e.size*cp(e.dtype)),this.state.numBytes+=s,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:n||this.backend,dtype:e.dtype,shape:e.shape,bytes:s})),e instanceof mp||this.track(e)}incRef(e,n){this.trackTensor(e,n),this.backend.incRef(e.dataId)}removeDataId(e,n){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===n&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const n=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=n.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const s=e.size*cp(e.dtype);this.state.numBytes-=s}n.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,n.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const n=this.state.registeredVariables[e];this.disposeVariable(n)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const n=this.state.numBytes,s=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(r=>r.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-s;for(const r of this.state.activeProfile.kernels)r.kernelTimeMs=await r.kernelTimeMs,r.extraInfo=await r.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,n,s,r,o,i){const a={id:this.state.nextTapeNodeId++,kernelName:e,inputs:n,outputs:s,saved:o},l=Ck(e);l!=null&&(r=l.gradFunc),r!=null&&(a.gradient=u=>(u=u.map((c,d)=>{if(c==null){const f=s[d],h=pn(f.size,f.dtype);return this.makeTensor(h,f.shape,f.dtype)}return c}),r(u.length>1?u:u[0],o,i))),this.state.activeTape.push(a)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(n.name=e),this.state.scopeStack.push(n),this.state.activeScope=n}endScope(e){const n=_N(e),s=new Set(n.map(o=>o.id));for(let o=0;o<this.state.activeScope.track.length;o++){const i=this.state.activeScope.track[o];!i.kept&&!s.has(i.id)&&i.dispose()}const r=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(o=>{!o.kept&&o.scopeId===r.id&&this.track(o)})}gradients(e,n,s,r=!1){if(N(n.length>0,()=>"gradients() received an empty list of xs."),s!=null&&s.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${s.dtype}'`);const o=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));N(o instanceof zt,()=>"The result y returned by f() must be a tensor.");const i=vV(this.state.activeTape,n,o);if(!r&&i.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const a={};a[o.id]=s??TV(o.shape),bV(a,i,u=>this.tidy(u),EV);const l=n.map(u=>a[u.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(u=>{for(const c of u.saved)c.dispose()}),this.state.activeTape=null),{value:o,grads:l}})}customGrad(e){return N(wy(e),()=>"The f passed in customGrad(f) must be a function."),(...n)=>{N(n.every(a=>a instanceof zt),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let s;const r={};n.forEach((a,l)=>{r[l]=a});const o=(a,l)=>(s=e(...n,l),N(s.value instanceof zt,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),N(wy(s.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),s.value),i=(a,l)=>{const u=s.gradFunc(a,l),c=Array.isArray(u)?u:[u];N(c.length===n.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),N(c.every(f=>f instanceof zt),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const d={};return c.forEach((f,h)=>{d[h]=()=>f}),d};return this.runKernelFunc({forwardFunc:o,backwardsFunc:i,inputs:r})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,n){return this.state.tensorInfo.get(e).backend.readToGPU(e,n)}async time(e){const n=Ln(),s=await this.backend.time(e);return s.wallMs=Ln()-n,s}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new Fk;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}Fl.nextTensorId=0;Fl.nextVariableId=0;function TV(t){const e=Pb(Y(t),"float32");return V.makeTensor(e,t,"float32")}function VN(){const t=nN();if(t._tfengine==null){const e=new Yz(t);t._tfengine=new Fl(e)}return eV(t._tfengine.ENV),CV(()=>t._tfengine),t._tfengine}const V=VN();function EV(t,e){const n={a:t,b:e};return V.runKernel(Yl,n)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NV(){return typeof navigator<"u"&&navigator!=null}function BN(t){if(t||NV()){if(t||(t=navigator),t.product==="ReactNative")return!0;const e=t.userAgent||t.vendor||(typeof window<"u"?window.opera:"");if(!e){const n=t;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function WN(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wn=K();Wn.registerFlag("DEBUG",()=>!1,t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});Wn.registerFlag("IS_BROWSER",()=>WN());Wn.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");Wn.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));Wn.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));Wn.registerFlag("PROD",()=>!1);Wn.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>Wn.getBool("DEBUG"));Wn.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);Wn.registerFlag("IS_TEST",()=>!1);Wn.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>Wn.getBool("DEBUG"));Wn.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);Wn.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);Wn.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ig(t,e){let n=t;if(Ws(t))return e==="string"?[]:[t.length];if(LN(t)){const r=t.channels||"RGBA";return[t.height,t.width*r.length]}else if(MN(t))return[t.buffer.size/(e==null?4:cp(e))];if(!Array.isArray(t))return[];const s=[];for(;Array.isArray(n)||Ws(n)&&e!=="string";)s.push(n.length),n=n[0];return Array.isArray(t)&&K().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&UN(t,s,[]),s}function UN(t,e,n){if(n=n||[],!Array.isArray(t)&&!Ws(t)){N(e.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}N(e.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${t.length} elements`),N(t.length===e[0],()=>`Element arr[${n.join("][")}] should have ${e[0]} elements, but has ${t.length} elements`);const s=e.slice(1);for(let r=0;r<t.length;++r)UN(t[r],s,n.concat(r))}function Pk(t,e,n,s){if(t!=="string_or_numeric"){if(t==null)throw new Error("Expected dtype cannot be null.");if(t!=="numeric"&&t!==e||t==="numeric"&&e==="string")throw new Error(`Argument '${n}' passed to '${s}' must be ${t} tensor, but got ${e} tensor`)}}function O(t,e,n,s="numeric"){if(t instanceof q())return Pk(s,t.dtype,e,n),t;let r=Xl(t);if(r!=="string"&&["bool","int32","float32"].indexOf(s)>=0&&(r=s),Pk(s,r,e,n),t==null||!Ws(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string"){const l=t==null?"null":t.constructor.name;throw new Error(`Argument '${e}' passed to '${n}' must be a Tensor or TensorLike, but got '${l}'`)}const o=Ig(t,r);!Ws(t)&&!Array.isArray(t)&&(t=[t]);const a=r!=="string"?Ca(t,r):ea(t,[],!0);return V.makeTensor(a,o,r)}function GN(t,e,n,s="numeric"){if(!Array.isArray(t))throw new Error(`Argument ${e} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return t.map((o,i)=>O(o,`${e}[${i}]`,n,s))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RV="__op";function W(t){const e=Object.keys(t);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let n=e[0];const s=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+RV;const r=(...o)=>{V.startScope(n);try{const i=s(...o);return Ob(i)&&console.error("Cannot return a Promise inside of tidy."),V.endScope(i),i}catch(i){throw V.endScope(null),i}};return Object.defineProperty(r,"name",{value:n,configurable:!0}),r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AV(t,e){const n=O(t,"real","complex"),s=O(e,"imag","complex");Fb(n.shape,s.shape,`real and imag shapes, ${n.shape} and ${s.shape}, must match in call to tf.complex().`);const r={real:n,imag:s};return V.runKernel(Gb,r)}const Pl=W({complex_:AV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tg(t,e,n,s){if(s==null)s=Xl(t);else if(s==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(MN(t)||LN(t)){if(s!=="float32"&&s!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${s}.`);return V.backend.createTensorFromGPUData(t,e||n,s)}if(!Ws(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){go(e);const r=Y(e),o=Y(n);N(r===o,()=>`Based on the provided shape, [${e}], the tensor should have ${r} values but has ${o}`);for(let i=0;i<n.length;++i){const a=n[i],l=i===n.length-1?a!==Y(e.slice(i)):!0;N(n[i]===e[i]||!l,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${e}). `)}}return!Ws(t)&&!Array.isArray(t)&&(t=[t]),e=e||n,t=s!=="string"?Ca(t,s):ea(t,[],!0),V.makeTensor(t,e,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fn(t,e,n){const s=Ig(t,n);return Tg(t,e,s,n)}class Ql{static join(e){return new Ql(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,e==null||(e instanceof Array||(e=[e]),e=e.map(s=>Ws(s)?s.buffer:s),e.length===0))return;this.bufferUniformSize=e[0].byteLength;let n=0;for(let s=0;s<e.length;s++){const r=e[s];s!==e.length-1&&r.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const o=n+r.byteLength;this.shards.push({buffer:r,start:n,end:o}),n=o}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(e=0,n=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,n=isNaN(Number(n))?0:n,e=Math.max(0,e),n=Math.min(this.byteLength,n),n<=e)return new ArrayBuffer(0);const s=this.findShardForByte(e);if(s===-1)throw new Error(`Could not find start shard for byte ${e}`);const r=n-e,o=new ArrayBuffer(r),i=new Uint8Array(o);let a=0;for(let l=s;l<this.shards.length;l++){const u=this.shards[l],d=e+a-u.start,f=a,p=Math.min(n,u.end)-u.start,g=new Uint8Array(u.buffer,d,p-d);if(i.set(g,f),a+=g.length,n<u.end)break}return o}findShardForByte(e){if(this.shards.length===0||e<0||e>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function n(r){return e<r.start?-1:e>=r.end?1:0}if(n(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const s=DV(this.shards,n);return s===-1?-1:(this.previousShardIndex=s,this.previousShardIndex)}}function DV(t,e){let n=0,s=t.length;for(;n<=s;){const r=Math.floor((s-n)/2)+n,o=e(t[r]);if(o===0)return r;o<0?s=r:n=r+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vr(){return V}function Ok(){return V.memory()}function H(t,e){return V.tidy(t,e)}function Ae(t){_N(t).forEach(n=>n.dispose())}function Rr(t){return V.keep(t)}function FV(t){return V.setBackend(t)}function HN(t,e,n=1){return V.registerBackend(t,e,n)}function PV(){return V.backend}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lk=4;async function Mk(t,e){const n=[],s=[],r=Array.isArray(t)?t.map(i=>i.name):Object.keys(t);for(let i=0;i<r.length;++i){const a=r[i],l=Array.isArray(t)?t[i].tensor:t[a];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${a}': ${l.dtype}`);const u={name:a,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const c=new Promise(async d=>{const f=await l.bytes(),h=f.reduce((y,m)=>y+m.length,0)+Lk*f.length,p=new Uint8Array(h);let g=0;for(let y=0;y<f.length;y++){const m=f[y],x=new Uint8Array(new Uint32Array([m.length]).buffer);p.set(x,g),g+=Lk,p.set(m,g),g+=m.length}d(p)});s.push(c)}else s.push(l.data());e!=null&&(u.group=e),n.push(u)}const o=await Promise.all(s);return{data:OV(o),specs:n}}function OV(t){if(t===null)throw new Error(`Invalid input value: ${JSON.stringify(t)}`);let e=0;const n=[];t.forEach(o=>{if(e+=o.byteLength,n.push(o.byteLength===o.buffer.byteLength?o:new o.constructor(o)),!(o instanceof Float32Array||o instanceof Int32Array||o instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${o.constructor.name}`)});const s=new Uint8Array(e);let r=0;return n.forEach(o=>{s.set(new Uint8Array(o.buffer),r),r+=o.byteLength}),s.buffer}const I1=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function _k(t){return I1?Buffer.byteLength(t,"utf8"):new Blob([t]).size}function LV(t){if(I1)return Buffer.from(t).toString("base64");const e=new Uint8Array(t);let n="";for(let s=0,r=e.length;s<r;s++)n+=String.fromCharCode(e[s]);return btoa(n)}function MV(t){if(I1){const s=Buffer.from(t,"base64");return s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength)}const e=atob(t),n=new Uint8Array(e.length);for(let s=0;s<e.length;++s)n.set([e.charCodeAt(s)],s);return n.buffer}function _V(t){return Ql.join(t)}function jN(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:t.modelTopology==null?0:_k(JSON.stringify(t.modelTopology)),weightSpecsBytes:t.weightSpecs==null?0:_k(JSON.stringify(t.weightSpecs)),weightDataBytes:t.weightData==null?0:new Ql(t.weightData).byteLength}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wn{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return wn.instance==null&&(wn.instance=new wn),wn.instance}static registerSaveRouter(e){wn.getInstance().saveRouters.push(e)}static registerLoadRouter(e){wn.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return wn.getHandlers(e,"save")}static getLoadHandlers(e,n){return wn.getHandlers(e,"load",n)}static getHandlers(e,n,s){const r=[];return(n==="load"?wn.getInstance().loadRouters:wn.getInstance().saveRouters).forEach(i=>{const a=i(e,s);a!==null&&r.push(a)}),r}}const zV=t=>wn.getSaveHandlers(t);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dy="tensorflowjs",Fy=1,Pi="models_store",Oo="model_info_store";function KN(){if(!K().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const t=typeof window>"u"?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function Py(t){const e=t.result;e.createObjectStore(Pi,{keyPath:"modelPath"}),e.createObjectStore(Oo,{keyPath:"modelPath"})}class ta{constructor(e){if(this.indexedDB=KN(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,n){return new Promise((s,r)=>{const o=this.indexedDB.open(Dy,Fy);o.onupgradeneeded=()=>Py(o),o.onsuccess=()=>{const i=o.result;if(n==null){const a=i.transaction(Pi,"readonly"),u=a.objectStore(Pi).get(this.modelPath);u.onsuccess=()=>{if(u.result==null)return i.close(),r(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));s(u.result.modelArtifacts)},u.onerror=c=>(i.close(),r(u.error)),a.oncomplete=()=>i.close()}else{n.weightData=Ql.join(n.weightData);const a=jN(n),l=i.transaction(Oo,"readwrite");let u=l.objectStore(Oo),c;try{c=u.put({modelPath:this.modelPath,modelArtifactsInfo:a})}catch(f){return r(f)}let d;c.onsuccess=()=>{d=i.transaction(Pi,"readwrite");const f=d.objectStore(Pi);let h;try{h=f.put({modelPath:this.modelPath,modelArtifacts:n,modelArtifactsInfo:a})}catch(p){return r(p)}h.onsuccess=()=>s({modelArtifactsInfo:a}),h.onerror=p=>{u=l.objectStore(Oo);const g=u.delete(this.modelPath);g.onsuccess=()=>(i.close(),r(h.error)),g.onerror=y=>(i.close(),r(h.error))}},c.onerror=f=>(i.close(),r(c.error)),l.oncomplete=()=>{d==null?i.close():d.oncomplete=()=>i.close()}}},o.onerror=i=>r(o.error)})}}ta.URL_SCHEME="indexeddb://";const XN=t=>K().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(ta.URL_SCHEME)?VV(t.slice(ta.URL_SCHEME.length)):null;wn.registerSaveRouter(XN);wn.registerLoadRouter(XN);function VV(t){return new ta(t)}function BV(t){return t.startsWith(ta.URL_SCHEME)?t.slice(ta.URL_SCHEME.length):t}class WV{constructor(){this.indexedDB=KN()}async listModels(){return new Promise((e,n)=>{const s=this.indexedDB.open(Dy,Fy);s.onupgradeneeded=()=>Py(s),s.onsuccess=()=>{const r=s.result,o=r.transaction(Oo,"readonly"),a=o.objectStore(Oo).getAll();a.onsuccess=()=>{const l={};for(const u of a.result)l[u.modelPath]=u.modelArtifactsInfo;e(l)},a.onerror=l=>(r.close(),n(a.error)),o.oncomplete=()=>r.close()},s.onerror=r=>n(s.error)})}async removeModel(e){return e=BV(e),new Promise((n,s)=>{const r=this.indexedDB.open(Dy,Fy);r.onupgradeneeded=()=>Py(r),r.onsuccess=()=>{const o=r.result,i=o.transaction(Oo,"readwrite"),a=i.objectStore(Oo),l=a.get(e);let u;l.onsuccess=()=>{if(l.result==null)return o.close(),s(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const c=a.delete(e),d=()=>{u=o.transaction(Pi,"readwrite");const h=u.objectStore(Pi).delete(e);h.onsuccess=()=>n(l.result.modelArtifactsInfo),h.onerror=p=>s(l.error)};c.onsuccess=d,c.onerror=f=>(d(),o.close(),s(l.error))}},l.onerror=c=>(o.close(),s(l.error)),i.oncomplete=()=>{u==null?o.close():u.oncomplete=()=>o.close()}},r.onerror=o=>s(r.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qr="/",ja="tensorflowjs_models",qN="info",UV="model_topology",GV="weight_specs",HV="weight_data",jV="model_metadata";function YN(t){return{info:[ja,t,qN].join(Qr),topology:[ja,t,UV].join(Qr),weightSpecs:[ja,t,GV].join(Qr),weightData:[ja,t,HV].join(Qr),modelMetadata:[ja,t,jV].join(Qr)}}function QN(t){for(const e of Object.values(t))window.localStorage.removeItem(e)}function KV(t){const e=t.split(Qr);if(e.length<3)throw new Error(`Invalid key format: ${t}`);return e.slice(1,e.length-1).join(Qr)}function XV(t){return t.startsWith(na.URL_SCHEME)?t.slice(na.URL_SCHEME.length):t}class na{constructor(e){if(!K().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=YN(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(e.modelTopology),s=JSON.stringify(e.weightSpecs),r=jN(e),o=Ql.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,s),this.LS.setItem(this.keys.weightData,LV(o));const i={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(i)),{modelArtifactsInfo:r}}catch{throw QN(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${r.modelTopologyBytes}, weightSpecsBytes=${r.weightSpecsBytes}, weightDataBytes=${r.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const n={},s=JSON.parse(this.LS.getItem(this.keys.topology));if(s==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);n.modelTopology=s;const r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(r==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);n.weightSpecs=r;const o=this.LS.getItem(this.keys.modelMetadata);if(o!=null){const a=JSON.parse(o);n.format=a.format,n.generatedBy=a.generatedBy,n.convertedBy=a.convertedBy,a.signature!=null&&(n.signature=a.signature),a.userDefinedMetadata!=null&&(n.userDefinedMetadata=a.userDefinedMetadata),a.modelInitializer!=null&&(n.modelInitializer=a.modelInitializer),a.initializerSignature!=null&&(n.initializerSignature=a.initializerSignature),a.trainingConfig!=null&&(n.trainingConfig=a.trainingConfig)}const i=this.LS.getItem(this.keys.weightData);if(i==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return n.weightData=MV(i),n}}na.URL_SCHEME="localstorage://";const ZN=t=>K().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(na.URL_SCHEME)?qV(t.slice(na.URL_SCHEME.length)):null;wn.registerSaveRouter(ZN);wn.registerLoadRouter(ZN);function qV(t){return new na(t)}class YV{constructor(){N(K().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),N(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},n=ja+Qr,s=Qr+qN;for(let r=0;r<this.LS.length;++r){const o=this.LS.key(r);if(o.startsWith(n)&&o.endsWith(s)){const i=KV(o);e[i]=JSON.parse(this.LS.getItem(o))}}return e}async removeModel(e){e=XV(e);const n=YN(e);if(this.LS.getItem(n.info)==null)throw new Error(`Cannot find model at path '${e}'`);const s=JSON.parse(this.LS.getItem(n.info));return QN(n),s}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zk="://";class wr{constructor(){this.managers={}}static getInstance(){return wr.instance==null&&(wr.instance=new wr),wr.instance}static registerManager(e,n){N(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(zk)&&(e=e.slice(0,e.indexOf(zk))),N(e.length>0,()=>"scheme must not be an empty string.");const s=wr.getInstance();N(s.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),s.managers[e]=n}static getManager(e){const n=wr.getInstance().managers[e];if(n==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return n}static getSchemes(){return Object.keys(wr.getInstance().managers)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class QV{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,n){return fetch(e,n)}now(){return performance.now()}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${n}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,n){return new TextDecoder(n).decode(e)}setTimeoutCustom(e,n){if(typeof window>"u"||!K().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,n);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},n),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",s=>{if(s.source===window&&s.data.name===this.messageName){s.stopPropagation();const r=this.functionRefs[s.data.index];r(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(e){return IN(e)}}if(K().get("IS_BROWSER")){K().setPlatform("browser",new QV);try{wr.registerManager(na.URL_SCHEME,new YV)}catch{}try{wr.registerManager(ta.URL_SCHEME,new WV)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZV={importFetch:()=>require("node-fetch")};let j0;class JV{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,n){return K().global.fetch!=null?K().global.fetch(e,n):(j0==null&&(j0=ZV.importFetch()),j0(e,n))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${n}`);return this.textEncoder.encode(e)}decode(e,n){return e.length===0?"":new this.util.TextDecoder(n).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}K().get("IS_NODE")&&!K().get("IS_BROWSER")&&K().setPlatform("node",new JV);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ee(t,e="float32",n){return e=e||"float32",go(t),new sn(t,e,n)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eB(t,e){const n=O(t,"x","cast");if(!jz(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&n.dtype!=="string"||e!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");const s={x:n},r={dtype:e};return V.runKernel(ld,s,r)}const ce=W({cast_:eB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tB(t){const n={x:O(t,"x","clone","string_or_numeric")};return V.runKernel(wd,n)}const Ui=W({clone_:tB});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nB(t,e=!1){console.log(t.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */VN();const sB={buffer:Ee,cast:ce,clone:Ui,print:nB};kV(sB);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rB(t,e){let n=O(t,"a","add"),s=O(e,"b","add");[n,s]=Et(n,s);const r={a:n,b:s};return V.runKernel(Yl,r)}const ne=W({add_:rB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oB(t,e){let n=O(t,"a","floorDiv"),s=O(e,"b","floorDiv");[n,s]=Et(n,s);const r={a:n,b:s};return V.runKernel(vd,r)}const JN=W({floorDiv_:oB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iB(t,e){let n=O(t,"a","div"),s=O(e,"b","div");if([n,s]=Et(n,s),n.dtype==="int32"&&s.dtype==="int32")return JN(n,s);const r={a:n,b:s},o={};return V.runKernel(hd,r,o)}const xe=W({div_:iB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aB(t,e){let n=O(t,"a","mul"),s=O(e,"b","mul");[n,s]=Et(n,s);const r={a:n,b:s};return V.runKernel(Rd,r)}const z=W({mul_:aB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lB(t){const e=O(t,"x","abs");if(e.dtype==="complex64"){const n={x:e};return V.runKernel(Dm,n)}else{const n={x:e};return V.runKernel(Sm,n)}}const Cn=W({abs_:lB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uB(t){const n={x:O(t,"x","acos")};return V.runKernel(td,n)}const cB=W({acos_:uB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dB(t){const n={x:O(t,"x","acosh")};return V.runKernel(nd,n)}const fB=W({acosh_:dB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hB(t,e=null,n=!1){const r={x:O(t,"x","all","bool")},o={axis:e,keepDims:n};return V.runKernel(_b,r,o)}const eR=W({all_:hB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pB(t,e=null,n=!1){const r={x:O(t,"x","any","bool")},o={axis:e,keepDims:n};return V.runKernel(zb,r,o)}const Oy=W({any_:pB});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mB(t,e=0){const s={x:O(t,"x","argMax")},r={axis:e};return V.runKernel(Im,s,r)}const Dc=W({argMax_:mB});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gB(t,e=0){const s={x:O(t,"x","argMin")},r={axis:e};return V.runKernel(Tm,s,r)}const xB=W({argMin_:gB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yB(t){const n={x:O(t,"x","asin")};return V.runKernel(sd,n)}const vB=W({asin_:yB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bB(t){const n={x:O(t,"x","asinh")};return V.runKernel(rd,n)}const wB=W({asinh_:bB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $B(t){const n={x:O(t,"x","atan")};return V.runKernel(od,n)}const CB=W({atan_:$B});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kB(t,e){let n=O(t,"a","atan2"),s=O(e,"b","atan2");[n,s]=Et(n,s);const r={a:n,b:s};return V.runKernel(ad,r)}const SB=W({atan2_:kB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IB(t){const n={x:O(t,"x","atanh")};return V.runKernel(id,n)}const TB=W({atanh_:IB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yd(t,e,n,s,r="NHWC",o){const i=t[3],a=[...e,i],l=yo(r);return rn(t,a,n,o,s,null,null,l)}function Gs(t,e,n,s,r,o,i="channelsLast"){const[a,l]=Fc(e);let u;if(i==="channelsLast")u=[a,l,t[3],t[3]];else if(i==="channelsFirst")u=[a,l,t[1],t[1]];else throw new Error(`Unknown dataFormat ${i}`);return rn(t,u,n,s,r,o,!1,i)}function xo(t,e,n,s,r,o,i="NDHWC"){const[a,l,u]=Ly(e);let c,d;if(i==="NDHWC")d="channelsLast",c=[a,l,u,t[4],t[4]];else if(i==="NCDHW")d="channelsFirst",c=[a,l,u,t[1],t[1]];else throw new Error(`Unknown dataFormat ${i}`);return fi(t,c,n,s,r,!1,d,o)}function rn(t,e,n,s,r,o,i=!1,a="channelsLast"){let[l,u,c,d]=[-1,-1,-1,-1];if(a==="channelsLast")[l,u,c,d]=t;else if(a==="channelsFirst")[l,d,u,c]=t;else throw new Error(`Unknown dataFormat ${a}`);const[f,h,,p]=e,[g,y]=Fc(n),[m,x]=Fc(s),v=vl(f,m),b=vl(h,x),{padInfo:$,outHeight:C,outWidth:k}=RB(r,u,c,g,y,v,b,o,a),w=i?p*d:p;let I;return a==="channelsFirst"?I=[l,w,C,k]:a==="channelsLast"&&(I=[l,C,k,w]),{batchSize:l,dataFormat:a,inHeight:u,inWidth:c,inChannels:d,outHeight:C,outWidth:k,outChannels:w,padInfo:$,strideHeight:g,strideWidth:y,filterHeight:f,filterWidth:h,effectiveFilterHeight:v,effectiveFilterWidth:b,dilationHeight:m,dilationWidth:x,inShape:t,outShape:I,filterShape:e}}function fi(t,e,n,s,r,o=!1,i="channelsLast",a){let[l,u,c,d,f]=[-1,-1,-1,-1,-1];if(i==="channelsLast")[l,u,c,d,f]=t;else if(i==="channelsFirst")[l,f,u,c,d]=t;else throw new Error(`Unknown dataFormat ${i}`);const[h,p,g,,y]=e,[m,x,v]=Ly(n),[b,$,C]=Ly(s),k=vl(h,b),w=vl(p,$),I=vl(g,C),{padInfo:R,outDepth:E,outHeight:A,outWidth:S}=AB(r,u,c,d,m,x,v,k,w,I,a),T=o?y*f:y;let F;return i==="channelsFirst"?F=[l,T,E,A,S]:i==="channelsLast"&&(F=[l,E,A,S,T]),{batchSize:l,dataFormat:i,inDepth:u,inHeight:c,inWidth:d,inChannels:f,outDepth:E,outHeight:A,outWidth:S,outChannels:T,padInfo:R,strideDepth:m,strideHeight:x,strideWidth:v,filterDepth:h,filterHeight:p,filterWidth:g,effectiveFilterDepth:k,effectiveFilterHeight:w,effectiveFilterWidth:I,dilationDepth:b,dilationHeight:$,dilationWidth:C,inShape:t,outShape:F,filterShape:e}}function EB(t,e,n,s,r){s==null&&(s=T1(t,e,n));const o=t[0],i=t[1],a=Pc((o-e+2*s)/n+1,r),l=Pc((i-e+2*s)/n+1,r);return[a,l]}function NB(t,e,n,s,r,o){r==null&&(r=T1(t,e[0],s[0]));const i=[0,0,0,n];for(let a=0;a<3;a++)t[a]+2*r>=e[a]&&(i[a]=Pc((t[a]-e[a]+2*r)/s[a]+1,o));return i}function T1(t,e,n,s=1){const r=vl(e,s);return Math.floor((t[0]*(n-1)-n+r)/2)}function Fc(t){return typeof t=="number"?[t,t,t]:t.length===2?[t[0],t[1],1]:t}function Ly(t){return typeof t=="number"?[t,t,t]:t}function vl(t,e){return e<=1?t:t+(t-1)*(e-1)}function RB(t,e,n,s,r,o,i,a,l){let u,c,d;if(typeof t=="number"){u={top:t,bottom:t,left:t,right:t,type:t===0?"VALID":"NUMBER"};const h=EB([e,n],o,s,t,a);c=h[0],d=h[1]}else if(t==="same"){c=Math.ceil(e/s),d=Math.ceil(n/r);const f=Math.max(0,(c-1)*s+o-e),h=Math.max(0,(d-1)*r+i-n),p=Math.floor(f/2),g=f-p,y=Math.floor(h/2),m=h-y;u={top:p,bottom:g,left:y,right:m,type:"SAME"}}else if(t==="valid")u={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((e-o+1)/s),d=Math.ceil((n-i+1)/r);else if(typeof t=="object"){const f=l==="channelsLast"?t[1][0]:t[2][0],h=l==="channelsLast"?t[1][1]:t[2][1],p=l==="channelsLast"?t[2][0]:t[3][0],g=l==="channelsLast"?t[2][1]:t[3][1];u={top:f,bottom:h,left:p,right:g,type:f===0&&h===0&&p===0&&g===0?"VALID":"EXPLICIT"},c=Pc((e-o+f+h)/s+1,a),d=Pc((n-i+p+g)/r+1,a)}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:u,outHeight:c,outWidth:d}}function AB(t,e,n,s,r,o,i,a,l,u,c){let d,f,h,p;if(t==="valid"&&(t=0),typeof t=="number"){d={top:t,bottom:t,left:t,right:t,front:t,back:t,type:t===0?"VALID":"NUMBER"};const y=NB([e,n,s,1],[a,l,u],1,[r,o,i],t,c);f=y[0],h=y[1],p=y[2]}else if(t==="same"){f=Math.ceil(e/r),h=Math.ceil(n/o),p=Math.ceil(s/i);const g=(f-1)*r+a-e,y=(h-1)*o+l-n,m=(p-1)*i+u-s,x=Math.floor(g/2),v=g-x,b=Math.floor(y/2),$=y-b,C=Math.floor(m/2),k=m-C;d={top:b,bottom:$,left:C,right:k,front:x,back:v,type:"SAME"}}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:d,outDepth:f,outHeight:h,outWidth:p}}function Pc(t,e){if(!e)return Math.trunc(t);switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error(`Unknown roundingMode ${e}`)}}function sa(t){const[e,n,s]=Fc(t);return e===1&&n===1&&s===1}function gn(t,e){return sa(t)||sa(e)}function ra(t){return Fc(t).every(e=>e>0)}function yo(t){if(t==="NHWC")return"channelsLast";if(t==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${t}`)}function jn(t,e,n){if(n!=null){if(typeof e=="string")throw Error(`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);if(typeof e=="number")N(Al(e),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);else if(typeof e=="object")e.forEach(s=>{s.forEach(r=>{N(Al(r),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${r}.`)})});else throw Error(`Error in ${t}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DB(t,e){const s={x:O(t,"x","reshape","string_or_numeric")},r={shape:e};return V.runKernel(fg,s,r)}const B=W({reshape_:DB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FB(t,e,n,s,r){const o=O(t,"x","avgPool","float32"),i=1;N(gn(n,i),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`);let a=o,l=!1;o.rank===3&&(l=!0,a=B(o,[1,o.shape[0],o.shape[1],o.shape[2]])),N(a.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${a.rank}.`),jn("avgPool",s,r);const u={x:a},c={filterSize:e,strides:n,pad:s,dimRoundingMode:r};let d=V.runKernel(Em,u,c);return d=ce(d,o.dtype),l?B(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const E1=W({avgPool_:FB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PB(t,e,n,s,r,o="NDHWC"){const i=O(t,"x","avgPool3d","float32");let a=i,l=!1;i.rank===4&&(l=!0,a=B(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),N(a.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${a.rank}.`),N(o==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${o}`),N(typeof n=="number"&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${n}'`),jn("avgPool3d",s,r);const u={x:a},c={filterSize:e,strides:n,pad:s,dimRoundingMode:r,dataFormat:o};let d=V.runKernel(Nm,u,c);return d=ce(d,a.dtype),l?B(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const OB=W({avgPool3d_:PB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LB(t,e=0){N(t.length>=1,()=>"Pass at least one tensor to concat");const n=GN(t,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(o=>{if(o.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${o.dtype}. `)}),n.length===1)return Ui(n[0]);const s=n,r={axis:e};return V.runKernel(Fm,s,r)}const Bn=W({concat_:LB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MB(t,e,n=!1,s=!1){let r=O(t,"a","matMul"),o=O(e,"b","matMul");[r,o]=Et(r,o);const i={a:r,b:o},a={transposeA:n,transposeB:s};return V.runKernel(Rm,i,a)}const Ue=W({matMul_:MB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _B(t){const n={x:O(t,"x","sigmoid","float32")};return V.runKernel(Bd,n)}const Zl=W({sigmoid_:_B});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zB(t,e,n){const s=O(t,"x","slice","string_or_numeric");if(s.rank===0)throw new Error("Slicing scalar is not possible");const r={x:s},o={begin:e,size:n};return V.runKernel(xg,r,o)}const st=W({slice_:zB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VB(t){const n={x:O(t,"x","tanh","float32")};return V.runKernel(Kd,n)}const Eg=W({tanh_:VB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BB(t,e,n){const s=O(t,"x","batchToSpaceND"),r=e.reduce((a,l)=>a*l);N(s.rank>=1+e.length,()=>`input rank is ${s.rank} but should be > than blockShape.length ${e.length}`),N(n.length===e.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${e.length}`),N(s.shape[0]%r===0,()=>`input tensor batch is ${s.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${r}`);const o={x:s},i={blockShape:e,crops:n};return V.runKernel(Am,o,i)}const N1=W({batchToSpaceND_:BB});function WB(t){let e;return t.rank===0||t.rank===1?e=B(t,[1,1,1,t.size]):t.rank===2?e=B(t,[1,1,t.shape[0],t.shape[1]]):t.rank===3?e=B(t,[1,t.shape[0],t.shape[1],t.shape[2]]):e=t,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UB(t,e,n,s,r,o){o==null&&(o=.001);const i=O(t,"x","batchNorm"),a=O(e,"mean","batchNorm"),l=O(n,"variance","batchNorm");let u;r!=null&&(u=O(r,"scale","batchNorm"));let c;s!=null&&(c=O(s,"offset","batchNorm")),N(a.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),N(c==null||a.rank===c.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),N(u==null||a.rank===u.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const f={x:WB(i),scale:u,offset:c,mean:a,variance:l},h={varianceEpsilon:o},p=V.runKernel(Wm,f,h);return B(p,i.shape)}const Ng=W({batchNorm_:UB});function GB(t,e,n,s,r,o){const i=O(t,"x","batchNorm"),a=O(e,"mean","batchNorm"),l=O(n,"variance","batchNorm");let u;r!=null&&(u=O(r,"scale","batchNorm"));let c;return s!=null&&(c=O(s,"offset","batchNorm")),N(i.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${i.rank}.`),N(a.rank===2||a.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${a.rank}.`),N(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),u!=null&&N(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${u.rank}.`),c!=null&&N(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${c.rank}.`),Ng(i,a,l,c,u,o)}const HB=W({batchNorm2d_:GB});function jB(t,e,n,s,r,o){const i=O(t,"x","batchNorm"),a=O(e,"mean","batchNorm"),l=O(n,"variance","batchNorm");let u;r!=null&&(u=O(r,"scale","batchNorm"));let c;return s!=null&&(c=O(s,"offset","batchNorm")),N(i.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${i.rank}.`),N(a.rank===3||a.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${a.rank}.`),N(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),u!=null&&N(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${u.rank}.`),c!=null&&N(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${c.rank}.`),Ng(i,a,l,c,u,o)}const KB=W({batchNorm3d_:jB});function XB(t,e,n,s,r,o){const i=O(t,"x","batchNorm"),a=O(e,"mean","batchNorm"),l=O(n,"variance","batchNorm");let u;r!=null&&(u=O(r,"scale","batchNorm"));let c;return s!=null&&(c=O(s,"offset","batchNorm")),N(i.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${i.rank}.`),N(a.rank===4||a.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${a.rank}.`),N(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),u!=null&&N(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${u.rank}.`),c!=null&&N(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${c.rank}.`),Ng(i,a,l,c,u,o)}const qB=W({batchNorm4d_:XB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YB(t,e,n){const s=O(t,"x","bincount"),r=O(e,"weights","bincount");N(s.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${s.dtype}`),N(n>=0,()=>`size must be non-negative, but got ${n}.`),N(r.size===s.size||r.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${s.shape}, weights shape: ${r.shape}.`);const o={x:s,weights:r},i={size:n};return V.runKernel(Wb,o,i)}const QB=W({bincount_:YB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZB(t,e){let n=O(t,"broadcastTo","x");const s=n.shape;if(go(e),e.length<n.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${n.rank}.`);if(e.length>n.rank){const u=n.shape.slice();for(;u.length<e.length;)u.unshift(1);n=B(n,u)}const r=n.shape,o=Array.from(e);for(let u=e.length-1;u>=0;u--)if(r[u]===e[u])o[u]=1;else if(n.shape[u]!==1)throw new Error(`broadcastTo(): [${s}] cannot be broadcast to [${e}].`);if(o.map((u,c)=>u>1?c:-1).filter(u=>u>=0).length===0)return Ui(n);const a={x:n},l={reps:o};return V.runKernel(Xd,a,l)}const rc=W({broadcastTo_:ZB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JB(t){const n={x:O(t,"x","ceil","float32")};return V.runKernel(ud,n)}const eW=W({ceil_:JB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rg(t,e,n){go(t),n=n||Xl(e);const s={shape:t,value:e,dtype:n};return V.runKernel(s1,{},s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tW(t,e,n){const s=O(t,"x","clipByValue");if(N(e<=n,()=>`Error in clip: min (${e}) must be less than or equal to max (${n}).`),e===n)return Rg(s.shape,e,s.dtype);const r={x:s},o={clipValueMin:e,clipValueMax:n};return V.runKernel(cd,r,o)}const gs=W({clipByValue_:tW});function nW(t){return Bn(t,0)}const sW=W({concat1d_:nW});function rW(t,e){return Bn(t,e)}const oW=W({concat2d_:rW});function iW(t,e){return Bn(t,e)}const aW=W({concat3d_:iW});function lW(t,e){return Bn(t,e)}const uW=W({concat4d_:lW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cW(t,e,n,s,r="NHWC",o=[1,1],i){const a=O(t,"x","conv2d","float32"),l=O(e,"filter","conv2d","float32");let u=a,c=!1;a.rank===3&&(c=!0,u=B(a,[1,a.shape[0],a.shape[1],a.shape[2]])),N(u.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${u.rank}.`),N(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),jn("conv2d",s,i);const d=r==="NHWC"?u.shape[3]:u.shape[1];N(d===l.shape[2],()=>`Error in conv2d: depth of input (${d}) must match input depth for filter ${l.shape[2]}.`),N(gn(n,o),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),N(ra(o),()=>"Error in conv2D: Dilated rates should be larger than 0."),N(ra(n),()=>"Error in conv2D: Strides should be larger than 0.");const f={x:u,filter:l},h={strides:n,pad:s,dataFormat:r,dilations:o,dimRoundingMode:i},p=V.runKernel(Pm,f,h);return c?B(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const oa=W({conv2d_:cW});function dW(t,e,n,s,r="NWC",o=1,i){const a=O(t,"x","conv1d"),l=O(e,"filter","conv1d");let u=a,c=!1;a.rank===2&&(c=!0,u=B(a,[1,a.shape[0],a.shape[1]])),N(u.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${u.rank}.`),N(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),jn("conv1d",s,i),N(u.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${u.shape[2]}) must match input depth for filter ${l.shape[1]}.`),N(gn(n,o),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${o}'`),N(ra(o),()=>"Error in conv1D: Dilated rates should be larger than 0."),N(ra(n),()=>"Error in conv1D: Stride should be larger than 0."),N(r==="NWC",()=>`Error in conv1d: got dataFormat of ${r} but only NWC is currently supported.`);const d=B(l,[1,l.shape[0],l.shape[1],l.shape[2]]),f=B(u,[u.shape[0],1,u.shape[1],u.shape[2]]),y=oa(f,d,[1,n],s,"NHWC",[1,o],i);return c?B(y,[y.shape[2],y.shape[3]]):B(y,[y.shape[0],y.shape[2],y.shape[3]])}const tR=W({conv1d_:dW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fW(t,e,n,s,r,o="NHWC",i){N(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let a=t,l=e,u=!1;e.rank===3&&(u=!0,l=B(e,[1,e.shape[0],e.shape[1],e.shape[2]]),a=[1,t[0],t[1],t[2]]),N(a.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${a.length}.`),N(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),N(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);const c=o==="NHWC"?a[3]:a[1],d=o==="NHWC"?l.shape[3]:l.shape[1];N(c===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${c}) must match input depth for filter ${n.shape[2]}.`),N(d===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${d}) must match output depth for filter ${n.shape[3]}.`),jn("conv2dDerInput",r,i);const f={dy:l,filter:n},h={strides:s,pad:r,dataFormat:o,dimRoundingMode:i,inputShape:a},p=V.runKernel(Om,f,h);return u?B(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const R1=W({conv2DBackpropInput_:fW});function hW(t,e,n,s,r,o){const i=O(t,"x","conv2dTranspose"),a=O(e,"filter","conv2dTranspose");return R1(n,i,a,s,r,"NHWC",o)}const nR=W({conv2dTranspose_:hW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pW(t,e,n,s,r="NDHWC",o=[1,1,1]){const i=O(t,"x","conv3d"),a=O(e,"filter","conv3d");let l=i,u=!1;i.rank===4&&(u=!0,l=B(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),N(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),N(a.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${a.rank}.`),N(l.shape[4]===a.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${a.shape[3]}.`),N(gn(n,o),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),N(r==="NDHWC",()=>`Error in conv3d: got dataFormat of ${r} but only NDHWC is currently supported.`),N(ra(o),()=>"Error in conv3D: Dilated rates should be larger than 0."),N(ra(n),()=>"Error in conv3D: Strides should be larger than 0.");const c={x:l,filter:a},d={strides:n,pad:s,dataFormat:r,dilations:o},f=V.runKernel(Lm,c,d);return u?B(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const mW=W({conv3d_:pW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gW(t,e,n,s,r){N(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let o=t,i=e,a=!1;e.rank===4&&(a=!0,i=B(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),o=[1,t[0],t[1],t[2],t[3]]);const l=o[4],u=i.shape[4];N(o.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${o.length}.`),N(i.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${i.rank}`),N(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),N(l===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[3]}.`),N(u===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${u}) must match output depth for filter ${n.shape[4]}.`);const c={dy:i,filter:n},d={pad:r,strides:s,inputShape:o},f=V.runKernel(Kb,c,d);return a?B(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const sR=W({conv3DBackpropInput_:gW});function xW(t,e,n,s,r){const o=O(t,"x","conv3dTranspose"),i=O(e,"filter","conv3dTranspose");return sR(n,o,i,s,r)}const yW=W({conv3dTranspose_:xW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vW(t){const n={x:O(t,"x","cos","float32")};return V.runKernel(dd,n)}const A1=W({cos_:vW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bW(t){const n={x:O(t,"x","cosh","float32")};return V.runKernel(fd,n)}const rR=W({cosh_:bW});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wW(t,e=0,n=!1,s=!1){const o={x:O(t,"x","cumprod")},i={axis:e,exclusive:n,reverse:s};return V.runKernel(Xb,o,i)}const My=W({cumprod_:wW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $W(t,e=0,n=!1,s=!1){const o={x:O(t,"x","cumsum")},i={axis:e,exclusive:n,reverse:s};return V.runKernel(Mm,o,i)}const oR=W({cumsum_:$W});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CW(t,e,n,s=!1){const r=O(t,"x","denseBincount"),o=O(e,"weights","denseBincount");N(r.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${r.dtype}`),N(r.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${r.rank}.`),N(n>=0,()=>`size must be non-negative, but got ${n}.`),N(o.size===r.size||o.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${r.shape}, weights shape: ${o.shape}.`);const i={x:r,weights:o},a={size:n,binaryOutput:s};return V.runKernel(Yb,i,a)}const Vk=W({denseBincount_:CW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kW(t,e,n="NHWC"){const s=O(t,"x","depthToSpace","float32"),r=n==="NHWC"?s.shape[1]:s.shape[2],o=n==="NHWC"?s.shape[2]:s.shape[3],i=n==="NHWC"?s.shape[3]:s.shape[1];N(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),N(r*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${r} and ${e}  for depthToSpace with input shape
    ${s.shape}`),N(o*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${o} and ${e} for depthToSpace with input shape
        ${s.shape}`),N(i%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${i} for depthToSpace with input shape ${s.shape}`);const a={x:s},l={blockSize:e,dataFormat:n};return V.runKernel(Qb,a,l)}const SW=W({depthToSpace_:kW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IW(t,e,n,s,r="NHWC",o=[1,1],i){const a=O(t,"x","depthwiseConv2d","float32"),l=O(e,"filter","depthwiseConv2d","float32");let u=a,c=!1;a.rank===3&&(c=!0,u=B(a,[1,a.shape[0],a.shape[1],a.shape[2]])),N(u.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${u.rank}.`),N(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const d=r==="NHWC"?u.shape[3]:u.shape[1];N(d===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${d}) must match the inChannels dimension in filter ${l.shape[2]}.`),jn("depthwiseConv2d",s,i);const f={x:u,filter:l},h={strides:n,pad:s,dataFormat:r,dilations:o,dimRoundingMode:i},p=V.runKernel(_m,f,h);return c?B(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const D1=W({depthwiseConv2d_:IW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TW(t,e,n,s,r=[1,1],o="NHWC"){const i=O(t,"x","dilation2d"),a=O(e,"filter","dilation2d");N(i.rank===3||i.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${i.rank}.`),N(a.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${a.rank}.`),N(o==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${o}`);let l=i,u=!1;i.rank===3&&(l=B(i,[1,i.shape[0],i.shape[1],i.shape[2]]),u=!0),N(l.shape[3]===a.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${l.shape[3]} vs ${a.shape[2]}`);const c={x:l,filter:a},d={strides:n,pad:s,dilations:r},f=V.runKernel(zm,c,d);return u?B(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const EW=W({dilation2d_:TW});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ol(t,e){const n=t.length,s=[];for(let r=0;r<n;r++){const o=n-1-r,i=t[o]||1;(e[e.length-1-r]||1)>1&&i===1&&s.unshift(o)}return s}function Ht(t,e){const n=[];for(let s=0;s<e.length;s++){const r=t[t.length-s-1],o=e.length-s-1,i=e[o];(r==null||r===1&&i>1)&&n.unshift(o)}return n}function Se(t,e){const n=Math.max(t.length,e.length),s=new Array(n);for(let r=0;r<n;r++){let o=t[t.length-r-1];o==null&&(o=1);let i=e[e.length-r-1];if(i==null&&(i=1),o===1)s[n-r-1]=i;else if(i===1)s[n-r-1]=o;else if(o!==i){const a=`Operands could not be broadcast together with shapes ${t} and ${e}.`;throw Error(a)}else s[n-r-1]=o}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NW(t,e){let n=O(t,"a","equal","string_or_numeric"),s=O(e,"b","equal","string_or_numeric");[n,s]=Et(n,s),Se(n.shape,s.shape);const r={a:n,b:s};return V.runKernel(Vm,r)}const Or=W({equal_:NW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RW(t,e,n){const s=O(e,"a","where"),r=O(n,"b","where"),o=O(t,"condition","where","bool"),i=Se(Se(o.shape,s.shape),r.shape),a=rc(o,i),l=rc(s,i),u=rc(r,i),c={condition:a,t:l,e:u};return V.runKernel(gg,c)}const En=W({where_:RW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AW(t){const n={x:O(t,"x","zerosLike")};return V.runKernel(kg,n)}const Le=W({zerosLike_:AW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DW(t,e){let n=O(t,"a","div"),s=O(e,"b","div");[n,s]=Et(n,s);const r=xe(n,s),o=Le(r),i=Or(s,o);return En(i,o,r)}const FW=W({divNoNan_:DW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PW(t,e){const n=O(t,"t1","dot"),s=O(e,"t2","dot");N((n.rank===1||n.rank===2)&&(s.rank===1||s.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${s.rank}.`);const r=n.rank===1?n.size:n.shape[1],o=s.rank===1?s.size:s.shape[0];if(N(r===o,()=>`Error in dot: inner dimensions of inputs must match, but got ${r} and ${o}.`),n.rank===1&&s.rank===1){const i=B(n,[1,-1]),a=B(s,[-1,1]),l=Ue(i,a);return B(l,[])}else if(n.rank===1&&s.rank===2){const i=B(n,[1,-1]),a=B(s,[s.shape[0],s.shape[1]]),l=Ue(i,a);return B(l,[l.size])}else if(n.rank===2&&s.rank===1){const i=B(s,[-1,1]),a=Ue(n,i);return B(a,[a.size])}else{const i=B(s,[s.shape[0],s.shape[1]]);return Ue(n,i)}}const OW=W({dot_:PW});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LW(t,...e){const n=e.map((r,o)=>O(r,`tensors${o}`,"einsum")),s={equation:t};return V.runKernel(e1,n,s)}const Tu=W({einsum_:LW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MW(t){const n={x:O(t,"x","elu","float32")};return V.runKernel(pd,n)}const Ag=W({elu_:MW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _W(t){let e=O(t,"x","erf");N(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=ce(e,"float32"));const n={x:e};return V.runKernel(md,n)}const iR=W({erf_:_W});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F1(t,e){for(let n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function aR(t,e,n){const s=t.length+e.length,r=[];let o=0,i=0;for(let a=0;a<s;a++)n.indexOf(a)===-1?r.push(t[o++]):r.push(e[i++]);return r}function Jt(t,e){const n=[],s=t.length;for(let o=0;o<s;o++)e.indexOf(o)===-1&&n.push(t[o]);const r=e.map(o=>t[o]);return[n,r]}function Lt(t,e){const n=e.map(s=>1);return aR(t,n,e)}function on(t,e,n){N(F1(e,n),()=>`${t} supports only inner-most axes for now. Got axes ${e} and rank-${n} input.`)}function vt(t,e){if(F1(t,e))return null;const n=[];for(let s=0;s<e;++s)t.indexOf(s)===-1&&n.push(s);return t.forEach(s=>n.push(s)),n}function hi(t){return t.map((e,n)=>[n,e]).sort((e,n)=>e[1]-n[1]).map(e=>e[0])}function Nt(t,e){const n=[];for(let s=e-t;s<e;++s)n.push(s);return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zW(t,e=null,n=!1){const r={x:O(t,"x","max")},o={reductionIndices:e,keepDims:n};return V.runKernel(Zm,r,o)}const ar=W({max_:zW});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VW(t,e=null,n=!1){const r={x:O(t,"x","min")},o={axis:e,keepDims:n};return V.runKernel(ng,r,o)}const gp=W({min_:VW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BW(t,e){let n=O(t,"base","pow"),s=O(e,"exp","pow");[n,s]=Et(n,s);const r={a:n,b:s};return V.runKernel(Ad,r)}const ia=W({pow_:BW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ge(t,e){if((Ws(t)&&e!=="string"||Array.isArray(t))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&Ws(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Tg(t,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WW(t){const n={x:O(t,"x","sqrt","float32")};return V.runKernel(Ud,n)}const mn=W({sqrt_:WW});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UW(t){const e=O(t,"x","square"),n={};return V.runKernel("Square",{x:e},n)}const at=W({square_:UW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GW(t,e=null,n=!1){let s=O(t,"x","sum");s.dtype==="bool"&&(s=ce(s,"int32"));const r={x:s},o={axis:e,keepDims:n};return V.runKernel(yg,r,o)}const ge=W({sum_:GW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HW(t,e="euclidean",n=null,s=!1){t=O(t,"x","norm");const r=lR(t,e,n);let o=r.shape;if(s){const i=Ne(n,t.shape);o=Lt(r.shape,i)}return B(r,o)}function lR(t,e,n=null){if(t.rank===0)return Cn(t);if(t.rank!==1&&n===null)return lR(B(t,[-1]),e,n);if(t.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(e===1)return ge(Cn(t),n);if(e===1/0)return ar(Cn(t),n);if(e===-1/0)return gp(Cn(t),n);if(e==="euclidean"||e===2)return mn(ge(ia(Cn(t),Ge(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(n)&&n.length===2){if(e===1)return ar(ge(Cn(t),n[0]),n[1]-1);if(e===1/0)return ar(ge(Cn(t),n[1]),n[0]);if(e===-1/0)return gp(ge(Cn(t),n[1]),n[0]);if(e==="fro"||e==="euclidean")return mn(ge(at(t),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const Dg=W({norm_:HW});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jW(t,e=null,n=!1){return Dg(t,"euclidean",e,n)}const KW=W({euclideanNorm_:jW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XW(t){const n={x:O(t,"x","exp")};return V.runKernel(gd,n)}const Lr=W({exp_:XW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qW(t,e=0){const n=O(t,"x","expandDims","string_or_numeric");N(e<=n.rank,()=>"Axis must be <= rank of the tensor");const s={input:n},r={dim:e};return V.runKernel(Bm,s,r)}const Mn=W({expandDims_:qW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YW(t){const n={x:O(t,"x","expm1")};return V.runKernel(xd,n)}const QW=W({expm1_:YW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZW(t,e){const n=O(t,"x","tile","string_or_numeric");N(n.rank===e.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${e}.`);const s={x:n},r={reps:e};return V.runKernel(Xd,s,r)}const sr=W({tile_:ZW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JW(t,e,n,s="float32"){e==null&&(e=t);const r=Ee([t,e],s),o=t<=e?t:e;for(let a=0;a<o;++a)r.set(1,a,a);const i=B(r.toTensor(),[t,e]);if(n==null)return i;if(n.length===1)return sr(Mn(i,0),[n[0],1,1]);if(n.length===2)return sr(Mn(Mn(i,0),0),[n[0],n[1],1,1]);if(n.length===3)return sr(Mn(Mn(Mn(i,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}const uR=W({eye_:JW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eU(t){const n={x:O(t,"x","floor","float32")};return V.runKernel(yd,n)}const Fg=W({floor_:eU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tU(t,e,n=0,s=0){const r=O(t,"x","gather"),o=O(e,"indices","gather","int32"),i={x:r,indices:o},a={axis:n,batchDims:s};return V.runKernel(Um,i,a)}const P1=W({gather_:tU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nU(t,e){let n=O(t,"a","greater","string_or_numeric"),s=O(e,"b","greater","string_or_numeric");[n,s]=Et(n,s),Se(n.shape,s.shape);const r={a:n,b:s};return V.runKernel(Gm,r)}const vs=W({greater_:nU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sU(t,e){let n=O(t,"a","greaterEqual","string_or_numeric"),s=O(e,"b","greaterEqual","string_or_numeric");[n,s]=Et(n,s),Se(n.shape,s.shape);const r={a:n,b:s};return V.runKernel(bd,r)}const ka=W({greaterEqual_:sU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rU(t){const n={input:O(t,"input","imag")};return V.runKernel(i1,n)}const O1=W({imag_:rU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oU(t){const n={x:O(t,"x","isFinite")};return V.runKernel($d,n)}const iU=W({isFinite_:oU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aU(t){const n={x:O(t,"x","isInf")};return V.runKernel(Cd,n)}const lU=W({isInf_:aU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uU(t){const n={x:O(t,"x","isNaN")};return V.runKernel(kd,n)}const cU=W({isNaN_:uU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dU(t,e=.2){const s={x:O(t,"x","leakyRelu")},r={alpha:e};return V.runKernel(Hm,s,r)}const L1=W({leakyRelu_:dU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fU(t,e){let n=O(t,"a","less","string_or_numeric"),s=O(e,"b","less","string_or_numeric");[n,s]=Et(n,s),Se(n.shape,s.shape);const r={a:n,b:s};return V.runKernel(jm,r)}const xp=W({less_:fU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hU(t,e){let n=O(t,"a","lessEqual","string_or_numeric"),s=O(e,"b","lessEqual","string_or_numeric");[n,s]=Et(n,s),Se(n.shape,s.shape);const r={a:n,b:s};return V.runKernel(Km,r)}const Jl=W({lessEqual_:hU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pU(t,e=5,n=1,s=1,r=.5){const o=O(t,"x","localResponseNormalization");N(o.rank===4||o.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${o.rank}.`),N(Al(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let i=o,a=!1;o.rank===3&&(a=!0,i=B(o,[1,o.shape[0],o.shape[1],o.shape[2]]));const l={x:i},u={depthRadius:e,bias:n,alpha:s,beta:r},c=V.runKernel(Qm,l,u);return a?B(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const mU=W({localResponseNormalization_:pU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gU(t){const n={x:O(t,"x","log","float32")};return V.runKernel(Sd,n)}const Mr=W({log_:gU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xU(t){const n={x:O(t,"x","log1p")};return V.runKernel(Id,n)}const cR=W({log1p_:xU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yU(t,e){N(wy(t),()=>"The f passed in variableGrads(f) must be a function"),N(e==null||Array.isArray(e)&&e.every(u=>u instanceof mp),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=e!=null;if(!n){e=[];for(const u in V.registeredVariables)e.push(V.registeredVariables[u])}const s=n?e.filter(u=>!u.trainable):null,r=e.length;e=e.filter(u=>u.trainable),N(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${r} variables is trainable.`);const o=!0,{value:i,grads:a}=V.gradients(t,e,null,o);N(a.some(u=>u!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),N(i.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${i.rank} tensor`);const l={};return e.forEach((u,c)=>{a[c]!=null&&(l[u.name]=a[c])}),s!=null&&s.forEach(u=>l[u.name]=null),{value:i,grads:l}}function Ll(t){return V.customGrad(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vU(t){const n={x:O(t,"x","neg")};return V.runKernel(rg,n)}const Tt=W({neg_:vU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bU(t){const n={x:O(t,"x","softplus")};return V.runKernel(Wd,n)}const Qd=W({softplus_:bU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wU(t){const e=O(t,"x","logSigmoid");return Ll(s=>({value:Tt(Qd(Tt(s))),gradFunc:i=>z(i,Zl(Tt(s)))}))(e)}const $U=W({logSigmoid_:wU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CU(t,e){let n=O(t,"a","sub"),s=O(e,"b","sub");[n,s]=Et(n,s);const r={a:n,b:s};return V.runKernel(Hd,r)}const ye=W({sub_:CU});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kU(t,e=-1){const n=O(t,"logits","logSoftmax");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${e}`);return Ll((r,o)=>{const a=ar(r,e,!0),l=ye(r,a),u=ye(ce(l,"float32"),Mr(ge(Lr(l),e,!0)));return o([u]),{value:u,gradFunc:(d,f)=>{const[h]=f,p=!0,g=Lr(h);return ye(d,z(ge(d,e,p),g))}}})(n)}const dR=W({logSoftmax_:kU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SU(t,e=null,n=!1){const s=O(t,"x","logSumExp"),r=Ne(e,s.shape),o=ar(s,r,!0),i=ye(s,o),a=Lr(i),l=ge(a,r),u=Mr(l),c=ne(B(o,u.shape),u);if(n){const d=Lt(c.shape,r);return B(c,d)}return c}const fR=W({logSumExp_:SU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IU(t,e){const n=O(t,"a","logicalAnd","bool"),s=O(e,"b","logicalAnd","bool");Se(n.shape,s.shape);const r={a:n,b:s};return V.runKernel(Xm,r)}const uo=W({logicalAnd_:IU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TU(t){const n={x:O(t,"x","logicalNot","bool")};return V.runKernel(qm,n)}const M1=W({logicalNot_:TU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EU(t,e){const n=O(t,"a","logicalOr","bool"),s=O(e,"b","logicalOr","bool");Se(n.shape,s.shape);const r={a:n,b:s};return V.runKernel(Ym,r)}const hR=W({logicalOr_:EU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NU(t,e){const n=O(t,"a","logicalXor","bool"),s=O(e,"b","logicalXor","bool");return Se(n.shape,s.shape),uo(hR(t,e),M1(uo(t,e)))}const RU=W({logicalXor_:NU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AU(t,e,n,s,r){const o=O(t,"x","maxPool"),i=1;let a=o,l=!1;o.rank===3&&(l=!0,a=B(o,[1,o.shape[0],o.shape[1],o.shape[2]])),N(a.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${a.rank}.`),N(gn(n,i),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),jn("maxPool",s,r);const u={x:a},c={filterSize:e,strides:n,pad:s,dimRoundingMode:r},d=V.runKernel(Jm,u,c);return l?B(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const _1=W({maxPool_:AU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DU(t,e=[1,1,1],n,s,r,o="NDHWC"){const i=O(t,"x","maxPool3d");let a=i,l=!1;i.rank===4&&(l=!0,a=B(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),N(a.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${a.rank}.`),N(o==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${o}`),jn("maxPool3d",s,r);const u={x:a},c={filterSize:e,strides:n,pad:s,dimRoundingMode:r,dataFormat:o},d=V.runKernel(eg,u,c);return l?B(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const FU=W({maxPool3d_:DU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PU(t,e){let n=O(t,"a","maximum"),s=O(e,"b","maximum");[n,s]=Et(n,s),n.dtype==="bool"&&(n=ce(n,"int32"),s=ce(s,"int32")),Se(n.shape,s.shape);const r={a:n,b:s};return V.runKernel(Td,r)}const pi=W({maximum_:PU});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OU(t,e=null,n=!1){const r={x:O(t,"x","mean")},o={axis:e,keepDims:n};return V.runKernel(tg,r,o)}const Ot=W({mean_:OU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xt(t,e="float32"){if(go(t),e==="complex64"){const s=xt(t,"float32"),r=xt(t,"float32");return Pl(s,r)}const n=pn(Y(t),e);return V.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vo(t,e="float32"){if(go(t),e==="complex64"){const s=vo(t,"float32"),r=xt(t,"float32");return Pl(s,r)}const n=Pb(Y(t),e);return V.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LU(t,e){let n=O(t,"a","minimum"),s=O(e,"b","minimum");[n,s]=Et(n,s),n.dtype==="bool"&&(n=ce(n,"int32"),s=ce(s,"int32")),Se(n.shape,s.shape);const r={a:n,b:s};return V.runKernel(Ed,r)}const Oc=W({minimum_:LU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MU(t,e,n){N(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const s=O(t,"x","mirrorPad");if(s.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");N(e.length===s.rank,()=>`Padding doesn't match input. Must be ${s.rank}. Got ${e.length}.`);const r=n==="reflect"?1:0;for(let a=0;a<s.rank;a++)N(e[a].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),N(e[a][0]>=0&&e[a][0]<=s.shape[a]-r&&e[a][1]>=0&&e[a][1]<=s.shape[a]-r,()=>`Padding in dimension ${a} cannot be greater than or equal to ${s.shape[a]-r} or less than 0 for input of shape ${s.shape}`);const o={paddings:e,mode:n},i={x:s};return V.runKernel(sg,i,o)}const _U=W({mirrorPad_:MU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zU(t,e){let n=O(t,"a","mod"),s=O(e,"b","mod");[n,s]=Et(n,s);const r={a:n,b:s};return V.runKernel(Nd,r)}const VU=W({mod_:zU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BU(t,e=null,n=!1){t=O(t,"x","moments");const s=Ne(e,t.shape),r=Ot(t,s,n);let o=r.shape;n||(o=Lt(r.shape,s));const i=at(ye(ce(t,"float32"),B(r,o))),a=Ot(i,s,n);return{mean:r,variance:a}}const z1=W({moments_:BU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WU(t,e){let n=O(t,"a","notEqual","string_or_numeric"),s=O(e,"b","notEqual","string_or_numeric");[n,s]=Et(n,s),Se(n.shape,s.shape);const r={a:n,b:s};return V.runKernel(og,r)}const yp=W({notEqual_:WU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UU(t,e,n=1,s=0,r="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const i={indices:O(t,"indices","oneHot","int32")},a={dtype:r,depth:e,onValue:n,offValue:s};return V.runKernel(ag,i,a)}const pR=W({oneHot_:UU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GU(t){const n={x:O(t,"x","onesLike")};return V.runKernel(ig,n)}const Us=W({onesLike_:GU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HU(t,e,n=0){const s=O(t,"x","pad");if(s.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const r={paddings:e,constantValue:n},o={x:s};return V.runKernel(ug,o,r)}const V1=W({pad_:HU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jU(t,e,n){const s=O(t,"x","spaceToBatchND");N(s.rank>=1+e.length,()=>`input rank ${s.rank} should be > than [blockShape] ${e.length}`),N(n.length===e.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${e.length}`),N(s.shape.reduce((i,a,l)=>l>0&&l<=e.length?i&&(a+n[l-1][0]+n[l-1][1])%e[l-1]===0:i,!0),()=>`input spatial dimensions ${s.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${e.toString()}`);const r={x:s},o={blockShape:e,paddings:n};return V.runKernel(vg,r,o)}const B1=W({spaceToBatchND_:jU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KU(t,e,n,s,r,o,i){r==null&&(r=[1,1]),o==null&&(o=1),s===0&&(s="valid");const a=O(t,"x","maxPool");let l=a,u=!1;a.rank===3&&(u=!0,l=B(a,[1,a.shape[0],a.shape[1],a.shape[2]])),N(gn(o,r),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${o} and dilations '${r}'`);const c=Gs(l.shape,e,o,r,s),d=[c.dilationHeight,c.dilationWidth];let f;s==="same"?f=qU([c.filterHeight,c.filterWidth],d):f=[[0,0],[0,0]];const h=d[0]===1&&d[1]===1,[p,g]=XU([c.inHeight,c.inWidth],d,f),y=h?s:"valid",m=h?l:B1(l,d,p),v=(n==="avg"?()=>E1(m,e,o,y,i):()=>_1(m,e,o,y,i))(),b=h?v:N1(v,d,g);return u?B(b,[b.shape[1],b.shape[2],b.shape[3]]):b}function XU(t,e,n){const s=n.map(c=>c[0]),r=n.map(c=>c[1]),o=t.concat(s,r),i=e.map((c,d)=>(c-o[d]%c)%c),a=r.map((c,d)=>c+i[d]),l=e.map((c,d)=>[s[d],a[d]]),u=e.map((c,d)=>[0,i[d]]);return[l,u]}function qU(t,e){const s=t.map((i,a)=>i+(i-1)*(e[a]-1)).map(i=>i-1),r=s.map(i=>Math.floor(i/2)),o=s.map((i,a)=>i-r[a]);return s.map((i,a)=>[r[a],o[a]])}const YU=W({pool_:KU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QU(t,e){const n=O(t,"x","prelu"),s=O(e,"alpha","prelu"),r={x:n,alpha:s};return V.runKernel(cg,r)}const W1=W({prelu_:QU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZU(t,e=null,n=!1){let s=O(t,"x","prod");s.dtype==="bool"&&(s=ce(s,"int32"));const r={x:s},o={axis:e,keepDims:n};return V.runKernel(dg,r,o)}const JU=W({prod_:ZU});var U1={exports:{}};U1.exports;(function(t){(function(e,n,s){function r(l){var u=this,c=a();u.next=function(){var d=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=d-(u.c=d|0)},u.c=1,u.s0=c(" "),u.s1=c(" "),u.s2=c(" "),u.s0-=c(l),u.s0<0&&(u.s0+=1),u.s1-=c(l),u.s1<0&&(u.s1+=1),u.s2-=c(l),u.s2<0&&(u.s2+=1),c=null}function o(l,u){return u.c=l.c,u.s0=l.s0,u.s1=l.s1,u.s2=l.s2,u}function i(l,u){var c=new r(l),d=u&&u.state,f=c.next;return f.int32=function(){return c.next()*4294967296|0},f.double=function(){return f()+(f()*2097152|0)*11102230246251565e-32},f.quick=f,d&&(typeof d=="object"&&o(d,c),f.state=function(){return o(c,{})}),f}function a(){var l=4022871197,u=function(c){c=String(c);for(var d=0;d<c.length;d++){l+=c.charCodeAt(d);var f=.02519603282416938*l;l=f>>>0,f-=l,f*=l,l=f>>>0,f-=l,l+=f*4294967296}return(l>>>0)*23283064365386963e-26};return u}n&&n.exports?n.exports=i:this.alea=i})(va,t)})(U1);var e6=U1.exports,G1={exports:{}};G1.exports;(function(t){(function(e,n,s){function r(a){var l=this,u="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var d=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^d^d>>>8},a===(a|0)?l.x=a:u+=a;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,l.next()}function o(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l}function i(a,l){var u=new r(a),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var f=u.next()>>>11,h=(u.next()>>>0)/4294967296,p=(f+h)/(1<<21);while(p===0);return p},d.int32=u.next,d.quick=d,c&&(typeof c=="object"&&o(c,u),d.state=function(){return o(u,{})}),d}n&&n.exports?n.exports=i:this.xor128=i})(va,t)})(G1);var t6=G1.exports,H1={exports:{}};H1.exports;(function(t){(function(e,n,s){function r(a){var l=this,u="";l.next=function(){var d=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(d^d<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,a===(a|0)?l.x=a:u+=a;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,c==u.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function o(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l.v=a.v,l.d=a.d,l}function i(a,l){var u=new r(a),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var f=u.next()>>>11,h=(u.next()>>>0)/4294967296,p=(f+h)/(1<<21);while(p===0);return p},d.int32=u.next,d.quick=d,c&&(typeof c=="object"&&o(c,u),d.state=function(){return o(u,{})}),d}n&&n.exports?n.exports=i:this.xorwow=i})(va,t)})(H1);var n6=H1.exports,j1={exports:{}};j1.exports;(function(t){(function(e,n,s){function r(a){var l=this;l.next=function(){var c=l.x,d=l.i,f,h;return f=c[d],f^=f>>>7,h=f^f<<24,f=c[d+1&7],h^=f^f>>>10,f=c[d+3&7],h^=f^f>>>3,f=c[d+4&7],h^=f^f<<7,f=c[d+7&7],f=f^f<<13,h^=f^f<<9,c[d]=h,l.i=d+1&7,h};function u(c,d){var f,h=[];if(d===(d|0))h[0]=d;else for(d=""+d,f=0;f<d.length;++f)h[f&7]=h[f&7]<<15^d.charCodeAt(f)+h[f+1&7]<<13;for(;h.length<8;)h.push(0);for(f=0;f<8&&h[f]===0;++f);for(f==8?h[7]=-1:h[f],c.x=h,c.i=0,f=256;f>0;--f)c.next()}u(l,a)}function o(a,l){return l.x=a.x.slice(),l.i=a.i,l}function i(a,l){a==null&&(a=+new Date);var u=new r(a),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var f=u.next()>>>11,h=(u.next()>>>0)/4294967296,p=(f+h)/(1<<21);while(p===0);return p},d.int32=u.next,d.quick=d,c&&(c.x&&o(c,u),d.state=function(){return o(u,{})}),d}n&&n.exports?n.exports=i:this.xorshift7=i})(va,t)})(j1);var s6=j1.exports,K1={exports:{}};K1.exports;(function(t){(function(e,n,s){function r(a){var l=this;l.next=function(){var c=l.w,d=l.X,f=l.i,h,p;return l.w=c=c+1640531527|0,p=d[f+34&127],h=d[f=f+1&127],p^=p<<13,h^=h<<17,p^=p>>>15,h^=h>>>12,p=d[f]=p^h,l.i=f,p+(c^c>>>16)|0};function u(c,d){var f,h,p,g,y,m=[],x=128;for(d===(d|0)?(h=d,d=null):(d=d+"\0",h=0,x=Math.max(x,d.length)),p=0,g=-32;g<x;++g)d&&(h^=d.charCodeAt((g+32)%d.length)),g===0&&(y=h),h^=h<<10,h^=h>>>15,h^=h<<4,h^=h>>>13,g>=0&&(y=y+1640531527|0,f=m[g&127]^=h+y,p=f==0?p+1:0);for(p>=128&&(m[(d&&d.length||0)&127]=-1),p=127,g=4*128;g>0;--g)h=m[p+34&127],f=m[p=p+1&127],h^=h<<13,f^=f<<17,h^=h>>>15,f^=f>>>12,m[p]=h^f;c.w=y,c.X=m,c.i=p}u(l,a)}function o(a,l){return l.i=a.i,l.w=a.w,l.X=a.X.slice(),l}function i(a,l){a==null&&(a=+new Date);var u=new r(a),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var f=u.next()>>>11,h=(u.next()>>>0)/4294967296,p=(f+h)/(1<<21);while(p===0);return p},d.int32=u.next,d.quick=d,c&&(c.X&&o(c,u),d.state=function(){return o(u,{})}),d}n&&n.exports?n.exports=i:this.xor4096=i})(va,t)})(K1);var r6=K1.exports,X1={exports:{}};X1.exports;(function(t){(function(e,n,s){function r(a){var l=this,u="";l.next=function(){var d=l.b,f=l.c,h=l.d,p=l.a;return d=d<<25^d>>>7^f,f=f-h|0,h=h<<24^h>>>8^p,p=p-d|0,l.b=d=d<<20^d>>>12^f,l.c=f=f-h|0,l.d=h<<16^f>>>16^p,l.a=p-d|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,a===Math.floor(a)?(l.a=a/4294967296|0,l.b=a|0):u+=a;for(var c=0;c<u.length+20;c++)l.b^=u.charCodeAt(c)|0,l.next()}function o(a,l){return l.a=a.a,l.b=a.b,l.c=a.c,l.d=a.d,l}function i(a,l){var u=new r(a),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var f=u.next()>>>11,h=(u.next()>>>0)/4294967296,p=(f+h)/(1<<21);while(p===0);return p},d.int32=u.next,d.quick=d,c&&(typeof c=="object"&&o(c,u),d.state=function(){return o(u,{})}),d}n&&n.exports?n.exports=i:this.tychei=i})(va,t)})(X1);var o6=X1.exports,mR={exports:{}};const i6={},a6=Object.freeze(Object.defineProperty({__proto__:null,default:i6},Symbol.toStringTag,{value:"Module"})),l6=h_(a6);(function(t){(function(e,n,s){var r=256,o=6,i=52,a="random",l=s.pow(r,o),u=s.pow(2,i),c=u*2,d=r-1,f;function h(b,$,C){var k=[];$=$==!0?{entropy:!0}:$||{};var w=m(y($.entropy?[b,v(n)]:b??x(),3),k),I=new p(k),R=function(){for(var E=I.g(o),A=l,S=0;E<u;)E=(E+S)*r,A*=r,S=I.g(1);for(;E>=c;)E/=2,A/=2,S>>>=1;return(E+S)/A};return R.int32=function(){return I.g(4)|0},R.quick=function(){return I.g(4)/4294967296},R.double=R,m(v(I.S),n),($.pass||C||function(E,A,S,T){return T&&(T.S&&g(T,I),E.state=function(){return g(I,{})}),S?(s[a]=E,A):E})(R,w,"global"in $?$.global:this==s,$.state)}function p(b){var $,C=b.length,k=this,w=0,I=k.i=k.j=0,R=k.S=[];for(C||(b=[C++]);w<r;)R[w]=w++;for(w=0;w<r;w++)R[w]=R[I=d&I+b[w%C]+($=R[w])],R[I]=$;(k.g=function(E){for(var A,S=0,T=k.i,F=k.j,M=k.S;E--;)A=M[T=d&T+1],S=S*r+M[d&(M[T]=M[F=d&F+A])+(M[F]=A)];return k.i=T,k.j=F,S})(r)}function g(b,$){return $.i=b.i,$.j=b.j,$.S=b.S.slice(),$}function y(b,$){var C=[],k=typeof b,w;if($&&k=="object")for(w in b)try{C.push(y(b[w],$-1))}catch{}return C.length?C:k=="string"?b:b+"\0"}function m(b,$){for(var C=b+"",k,w=0;w<C.length;)$[d&w]=d&(k^=$[d&w]*19)+C.charCodeAt(w++);return v($)}function x(){try{var b;return f&&(b=f.randomBytes)?b=b(r):(b=new Uint8Array(r),(e.crypto||e.msCrypto).getRandomValues(b)),v(b)}catch{var $=e.navigator,C=$&&$.plugins;return[+new Date,e,C,e.screen,v(n)]}}function v(b){return String.fromCharCode.apply(0,b)}if(m(s.random(),n),t.exports){t.exports=h;try{f=l6}catch{}}else s["seed"+a]=h})(typeof self<"u"?self:va,[],Math)})(mR);var u6=mR.exports,c6=e6,d6=t6,f6=n6,h6=s6,p6=r6,m6=o6,Sa=u6;Sa.alea=c6;Sa.xor128=d6;Sa.xorwow=f6;Sa.xorshift7=h6;Sa.xor4096=p6;Sa.tychei=m6;var q1=Sa;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gR{constructor(e,n,s,r,o){this.mean=e,this.stdDev=n,this.dtype=s,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const i=o||Math.random();this.random=q1.alea(i.toString())}nextValue(){if(!isNaN(this.nextVal)){const r=this.nextVal;return this.nextVal=NaN,r}let e,n,s=!1;for(;!s;){let r,o,i;do r=2*this.random()-1,o=2*this.random()-1,i=r*r+o*o;while(i>=1||i===0);const a=Math.sqrt(-2*Math.log(i)/i);e=this.mean+this.stdDev*r*a,n=this.mean+this.stdDev*o*a,(!this.truncated||this.isValidTruncated(e))&&(s=!0)}return(!this.truncated||this.isValidTruncated(n))&&(this.nextVal=this.convertValue(n)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class g6{constructor(e=0,n=1,s,r){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=n-e,this.dtype=s,r==null&&(r=Math.random()),typeof r=="number"&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${n} <= 1 and dtype is not float`);this.random=q1.alea(r)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x6(t,e=0,n=1,s,r){if(go(t),s!=null&&s==="bool")throw new Error(`Unsupported data type ${s}`);const o=new gR(e,n,s,!1,r),i=Ee(t,s);for(let a=0;a<i.values.length;a++)i.values[a]=o.nextValue();return i.toTensor()}const y6=W({randomNormal_:x6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v6(t,e=0,n=1,s="float32",r){go(t);const o=Ee(t,s),i=new g6(e,n,null,r);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const Zd=W({randomUniform_:v6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lc(t,e,n=1,s="float32"){if(n===0)throw new Error("Cannot have a step of zero");const r={start:t,stop:e,step:n,dtype:s};return V.runKernel(h1,{},r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b6(t){const n={input:O(t,"input","real")};return V.runKernel(p1,n)}const vp=W({real_:b6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w6(t){const n={x:O(t,"x","reciprocal")};return V.runKernel(Dd,n)}const $6=W({reciprocal_:w6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C6(t){const n={x:O(t,"x","relu")};return V.runKernel(Fd,n)}const Ia=W({relu_:C6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k6(t){const n={x:O(t,"x","relu6")};return V.runKernel(Pd,n)}const xR=W({relu6_:k6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S6(t,e){const s={x:O(t,"x","reverse")},r={dims:e};return V.runKernel(mg,s,r)}const aa=W({reverse_:S6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I6(t){const n={x:O(t,"x","round")};return V.runKernel(Od,n)}const yR=W({round_:I6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T6(t){const n={x:O(t,"x","rsqrt","float32")};return V.runKernel(Ld,n)}const vR=W({rsqrt_:T6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E6(t){const n={x:O(t,"x","selu")};return V.runKernel(Md,n)}const bR=W({selu_:E6});function N6(t,e,n,s,r,o=[1,1],i="NHWC"){const a=O(t,"x","separableConv2d"),l=O(e,"depthwiseFilter","separableConv2d"),u=O(n,"pointwiseFilter","separableConv2d");let c=a,d=!1;if(a.rank===3&&(d=!0,c=B(a,[1,a.shape[0],a.shape[1],a.shape[2]])),i==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");N(c.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${c.rank}.`),N(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),N(u.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),N(u.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${u.shape[0]}.`),N(u.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${u.shape[1]}.`);const f=l.shape[2],h=l.shape[3];N(u.shape[2]===f*h,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${f*h}, but got ${u.shape[2]}.`);const p=D1(c,l,s,r,i,o),y=oa(p,u,1,"valid",i);return d?B(y,[y.shape[1],y.shape[2],y.shape[3]]):y}const wR=W({separableConv2d_:N6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R6(t){const n={x:O(t,"x","sign")};return V.runKernel(Vd,n)}const A6=W({sign_:R6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D6(t){const n={x:O(t,"x","sin","float32")};return V.runKernel(_d,n)}const $R=W({sin_:D6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F6(t){const n={x:O(t,"x","sinh")};return V.runKernel(zd,n)}const CR=W({sinh_:F6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P6(t,e,n){const s=O(t,"x","slice1d");return N(s.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${s.rank} tensor`),st(s,[e],[n])}const Y1=W({slice1d_:P6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O6(t,e,n){const s=O(t,"x","slice2d");return N(s.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${s.rank} tensor`),st(s,e,n)}const kR=W({slice2d_:O6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L6(t,e,n){const s=O(t,"x","slice3d");return N(s.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${s.rank} tensor`),st(s,e,n)}const Q1=W({slice3d_:L6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M6(t,e,n){const s=O(t,"x","slice4d");return N(s.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${s.rank} tensor`),st(s,e,n)}const bp=W({slice4d_:M6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _6(t,e=-1){const n=O(t,"logits","softmax","float32");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${e}`);const s={logits:n},r={dim:e};return V.runKernel(wg,s,r)}const Z1=W({softmax_:_6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z6(t){N(t.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${t.dtype}.`);const e={input:t};return V.runKernel(n1,e)}const SR=W({fft_:z6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V6(t){N(t.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${t.dtype}.`);const e={input:t};return V.runKernel(o1,e)}const _y=W({ifft_:V6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B6(t){const e=t.shape[t.shape.length-1],n=t.size/e;let s;if(e<=2){const r=B(t,[n,e]);s=_y(r)}else{const r=[n,2*(e-1)],o=B(vp(t),[n,e]),i=B(O1(t),[n,e]),a=aa(st(o,[0,1],[n,e-2]),1),l=z(aa(st(i,[0,1],[n,e-2]),1),Ge(-1)),u=Bn([o,a],1),c=Bn([i,l],1),d=B(Pl(u,c),[r[0],r[1]]);s=_y(d)}if(s=vp(s),t.rank===3&&t.shape[0]!==0){const r=s,o=t.shape[0];s=B(s,[o,s.shape[0]/o,s.shape[1]]),r.dispose()}return s}const W6=W({irfft_:B6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U6(t,e,n=0){const r={x:O(t,"x","split")},o={numOrSizeSplits:e,axis:n};return V.runKernel(bg,r,o)}const ps=W({split_:U6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G6(t,e){N(t.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${t.dtype}`);let n=t.shape[t.shape.length-1];const s=t.size/n;let r;if(e!=null&&e<n){const p=t.shape.map(y=>0),g=t.shape.map(y=>y);g[t.shape.length-1]=e,r=st(t,p,g),n=e}else if(e!=null&&e>n){const p=t.shape.map(g=>g);p[t.shape.length-1]=e-n,r=Bn([t,xt(p)],t.shape.length-1),n=e}else r=t;const o=Le(r),i=B(Pl(r,o),[s,n]),a=SR(i),l=Math.floor(n/2)+1,u=vp(a),c=O1(a),d=ps(u,[l,n-l],u.shape.length-1),f=ps(c,[l,n-l],c.shape.length-1),h=r.shape.slice();return h[r.shape.length-1]=l,B(Pl(d[0],f[0]),h)}const H6=W({rfft_:G6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j6(t,e){let n=O(t,"a","squaredDifference"),s=O(e,"b","squaredDifference");[n,s]=Et(n,s),Se(n.shape,s.shape);const r={a:n,b:s},o={};return V.runKernel(Gd,r,o)}const K6=W({squaredDifference_:j6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X6(t,e){const n=O(t,"x","squeeze","string_or_numeric");return B(n,ci(n.shape,e).newShape)}const Jd=W({squeeze_:X6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q6(t,e=0){const n=GN(t,"tensors","stack","string_or_numeric");N(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&N(e<=n[0].rank,()=>"Axis must be <= rank of the tensor");const s=n,r={axis:e};return V.runKernel(lg,s,r)}const co=W({stack_:q6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y6(t,e=0){const s={x:O(t,"x","step")},r={alpha:e};return V.runKernel(qd,s,r)}const ef=W({step_:Y6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q6(t,e,n,s,r=0,o=0,i=0,a=0,l=0){const c={x:O(t,"x","stridedSlice","string_or_numeric")},d={begin:e,end:n,strides:s,beginMask:r,endMask:o,ellipsisMask:i,newAxisMask:a,shrinkAxisMask:l};return V.runKernel(v1,c,d)}const Z6=W({stridedSlice_:Q6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J6(t){const n={x:O(t,"x","tan","float32")};return V.runKernel(jd,n)}const eG=W({tan_:J6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zn(t,e){YE(t);const n=Ig(t,e);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Tg(t,null,n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K0(t,e,n){if(YE(t),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const s=Ig(t,n);if(s.length!==2&&s.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Tg(t,e,s,n)}function IR(t,e,n){const s=e.rank>1?e.shape[e.rank-1]:1,r=e.rank>1?e.rank-1:1,o=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${e.shape}, shape: ${t}, sliceDim: ${s}, and batchDim: ${r}.`;if(n.rank<r)throw new Error(o+` update.rank < ${r}. `);if(t.length<s+(n.rank-r))throw new Error(o+` Output shape length < ${s+(n.rank-r)}`);if(n.rank!==r+t.length-s)throw new Error(o+` update.rank != ${r+t.length-s}`);for(let i=0;i<r;++i)if(n.shape[i]!==e.shape[i])throw new Error(o+` updates.shape[${i}] (${n.shape[i]}) != indices.shape[${i}] (${e.shape[i]}).`);for(let i=0;i<n.rank-r;++i)if(n.shape[i+r]!==t[i+s])throw new Error(o+` updates.shape[${i+r}] (${n.shape[i+r]}) != shape[${i+r}] (${t[i+r]})`)}function tG(t,e,n){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(t.size===0)throw new Error(`Updates specified for empty output. updates shape: ${t.shape}`)}IR(n,e,t)}function Ta(t,e,n){const s=e.shape.length,r=s>1?e.shape[s-1]:1,o=n.length;let i=1;for(let d=r;d<o;++d)i*=n[d];const a=r<1?1:r,l=Y(e.shape)/a,u=[...me(n.slice(0,r)),1],c=Y(n);return{sliceRank:r,numUpdates:l,sliceSize:i,strides:u,outputSize:c}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nG(t,e=1,n=!0){const s=O(t,"x","topk");if(s.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const r=s.shape[s.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>r)throw new Error(`'k' passed to topk() must be <= the last dimension (${r}) but got ${e}`);const o={x:s},i={k:e,sorted:n},[a,l]=V.runKernel(b1,o,i);return{values:a,indices:l}}const sG=W({topk_:nG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rG(t,e=0,n=1,s,r){if(go(t),s!=null&&s==="bool")throw new Error("Unsupported data type $ { dtype }");const o=new gR(e,n,s,!0,r),i=Ee(t,s);for(let a=0;a<i.values.length;a++)i.values[a]=o.nextValue();return i.toTensor()}const TR=W({truncatedNormal_:rG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oG(t,e=0){const n=O(t,"x","unique","string_or_numeric");N(n.rank>0,()=>"The input tensor must be at least 1D");const s={x:n},r={axis:e},[o,i]=V.runKernel($1,s,r);return{values:o,indices:i}}const iG=W({unique_:oG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aG(t,e,n){const s=O(t,"x","unsortedSegmentSum"),r=O(e,"segmentIds","unsortedSegmentSum","int32");N(Al(n),()=>"numSegments must be of dtype int");const o={x:s,segmentIds:r},i={numSegments:n};return V.runKernel(Cg,o,i)}const ER=W({unsortedSegmentSum_:aG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lG(t,e=0){const n=O(t,"x","unstack","string_or_numeric");N(e>=-n.shape.length&&e<n.shape.length,()=>`Axis = ${e} is not in [-${n.shape.length}, ${n.shape.length})`);const s={value:n},r={axis:e};return V.runKernel($g,s,r)}const la=W({unstack_:lG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uG(t,e=!0,n,s){return V.makeVariable(t,e,n,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NR(t,e){const n=[];for(let o=0;o<e.length;o++)e[o]&&n.push(o);const s=Ee(t,"int32"),r=Ee([n.length,t.length],"int32");for(let o=0;o<n.length;o++){const i=s.indexToLoc(n[o]),a=o*t.length;r.values.set(i,a)}return r.toTensor()}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cG(t,e,n){const s=O(t,"x","transpose");if(e==null&&(e=s.shape.map((i,a)=>a).reverse()),N(s.rank===e.length,()=>`Error in transpose: rank of input ${s.rank} must match length of perm ${e}.`),e.forEach(i=>{N(i>=0&&i<s.rank,()=>`All entries in 'perm' must be between 0 and ${s.rank-1} but got ${e}`)}),s.rank<=1)return s.clone();const r={x:s},o={perm:e};return s.dtype==="complex64"?H(()=>{let i=vp(s),a=O1(s);return i=V.runKernel(yl,{x:i},o),a=V.runKernel(yl,{x:a},o),n&&(a=Tt(a)),Pl(i,a)}):V.runKernel(yl,r,o)}const Oe=W({transpose_:cG});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dG(t,e){if(e==null)return t.shape.slice();if(He(t.shape,e))return e;if(t.shape.length===e.length){const n=[];for(let s=0;s<t.shape.length;s++)e[s]==null&&t.shape[s]!=null?n.push(t.shape[s]):n.push(e[s]);return n}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fG(t,e,n,s){const r=O(t,"x","dropout");if(N(r.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${r.dtype} tensor instead.`),N(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return t instanceof zt?r.clone():r;const o=dG(r,n),i=1-e,a=xe(Fg(ne(Zd(o,0,1,"float32",s),i)),i);return z(r,a)}const hG=W({dropout_:fG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pG(t,e,n,s,r,o="NHWC",i){let a=t;t.rank===3&&(a=B(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=B(e,[1,e.shape[0],e.shape[1],e.shape[2]])),N(a.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${a.shape}.`),N(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),N(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);const u=o==="NHWC"?a.shape[3]:a.shape[1],c=o==="NHWC"?l.shape[3]:l.shape[1];N(u===n[2],()=>`Error in conv2dDerFilter: depth of input ${u}) must match input depth in filter (${n[2]}.`),N(c===n[3],()=>`Error in conv2dDerFilter: depth of dy (${c}) must match output depth for filter (${n[3]}).`),jn("conv2dDerFilter",r,i);const d={x:a,dy:l},f={strides:s,pad:r,dataFormat:o,dimRoundingMode:i,filterShape:n};return V.runKernel(Hb,d,f)}const J1=W({conv2DBackpropFilter_:pG});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ew(t,e,n){if(n==null||n==="linear")return t;if(n==="relu")return z(t,ef(e));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function tw(t,e){let n=e;const s=Ht(t.shape,e.shape);return s.length>0&&(n=ge(n,s)),B(n,t.shape)}function nw(t,e,n,s){if(e==="linear")return t;if(e==="relu")return Ia(t);if(e==="elu")return Ag(t);if(e==="relu6")return xR(t);if(e==="prelu")return W1(t,n);if(e==="leakyrelu")return L1(t,s);if(e==="sigmoid")return Zl(t);throw new Error(`Unknown fused activation ${e}.`)}const sw=(t,e)=>!(t>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mG({x:t,filter:e,strides:n,pad:s,dataFormat:r="NHWC",dilations:o=[1,1],dimRoundingMode:i,bias:a,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:c}){if(l=l||"linear",sw(V.state.gradientDepth,l)===!1){N(r==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${r} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let C=oa(t,e,n,s,r,o,i);return a!=null&&(C=ne(C,a)),nw(C,l,u,c)}const d=O(t,"x","conv2d","float32"),f=O(e,"filter","conv2d","float32");let h=d,p=!1;d.rank===3&&(p=!0,h=B(d,[1,d.shape[0],d.shape[1],d.shape[2]])),N(h.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${h.rank}.`),N(f.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${f.rank}.`),jn("fused conv2d",s,i);const g=r==="NHWC"?h.shape[3]:h.shape[1];N(f.shape[2]===g,()=>`Error in conv2d: depth of input (${g}) must match input depth for filter ${f.shape[2]}.`),N(gn(n,o),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`);const y=rn(h.shape,f.shape,n,o,s,i);let m;a!=null&&(m=O(a,"bias","fused conv2d"),[m]=Et(m,d),r==="NHWC"?Se(y.outShape,m.shape):(N(m.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${m.shape.length}.`),N(m.shape.length===0||m.shape[0]===y.outChannels||m.shape[0]===1,()=>`Error in fused conv2d: bias shape (${m.shape}) is not compatible with the number of output channels (${y.outChannels})`)));let x;if(u!=null){const C=u.shape;if(N(C.length<=1||C.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${C.length}.`),C.length===1)N(C[0]===1||C[0]===y.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${C}) is not compatible with the number of output channels (${y.outChannels}).`);else if(C.length===3)try{Se(C,y.outShape)}catch{const w=`Error in fused conv2d: PReLU activation weights (${C}) is not compatible with the output shape of the conv2d (${y.outShape}).`;throw Error(w)}x=O(u,"prelu weights","fused conv2d")}const v=(C,k)=>{N(r==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${r} but only NHWC is currently supported.`);const[w,I,R,E]=k,A=ew(C,R,l);N(sa(o),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${o}'`);const S=R1(I.shape,A,w,n,s),T=J1(I,A,w.shape,n,s),F=[S,T];if(E!=null){const M=tw(E,A);F.push(M)}return F},b={x:h,filter:f,bias:m,preluActivationWeights:x},$={strides:n,pad:s,dataFormat:r,dilations:o,dimRoundingMode:i,activation:l,leakyreluAlpha:c};return a==null?Ll((k,w,I)=>{let R=V.runKernel(fp,b,$);return I([w,k,R]),p&&(R=B(R,[R.shape[1],R.shape[2],R.shape[3]])),{value:R,gradFunc:v}})(h,f):Ll((k,w,I,R)=>{let E=V.runKernel(fp,b,$);return R([w,k,E,I]),p&&(E=B(E,[E.shape[1],E.shape[2],E.shape[3]])),{value:E,gradFunc:v}})(h,f,m)}const gG=W({fusedConv2d_:mG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xG(t,e,n,s,r,o=[1,1],i){let a=t;t.rank===3&&(a=B(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=B(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={x:a,dy:l},c={strides:s,pad:r,dimRoundingMode:i,dilations:o,filterShape:n};return V.runKernel(Zb,u,c)}const yG=W({depthwiseConv2dNativeBackpropFilter_:xG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vG(t,e,n,s,r,o=[1,1],i){let a=e,l=!1;e.rank===3&&(l=!0,a=B(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={dy:a,filter:n},c={strides:s,pad:r,dimRoundingMode:i,dilations:o,inputShape:t},d=V.runKernel(Jb,u,c);return l?B(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const bG=W({depthwiseConv2dNativeBackpropInput_:vG});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wG({a:t,b:e,transposeA:n=!1,transposeB:s=!1,bias:r,activation:o="linear",preluActivationWeights:i,leakyreluAlpha:a=.2}){if(sw(V.state.gradientDepth,o)===!1){let E=Ue(t,e,n,s);return r!=null&&(E=ne(E,r)),nw(E,o,i,a)}let l=O(t,"a","fused matMul"),u=O(e,"b","fused matMul");[l,u]=Et(l,u);const c=n?l.shape[l.rank-2]:l.shape[l.rank-1],d=s?u.shape[u.rank-1]:u.shape[u.rank-2],f=n?l.shape[l.rank-1]:l.shape[l.rank-2],h=s?u.shape[u.rank-2]:u.shape[u.rank-1],p=l.shape.slice(0,-2),g=u.shape.slice(0,-2),y=Y(p),m=Y(g);N(c===d,()=>`Error in fused matMul: inner shapes (${c}) and (${d}) of Tensors with shapes ${l.shape} and ${u.shape} and transposeA=${n} and transposeB=${s} must match.`);const v=Se(l.shape.slice(0,-2),u.shape.slice(0,-2)).concat([f,h]),b=n?B(l,[y,c,f]):B(l,[y,f,c]),$=s?B(u,[m,h,d]):B(u,[m,d,h]);let C;r!=null&&(C=O(r,"bias","fused matMul"),[C]=Et(C,l),Se(v,C.shape));let k;i!=null&&(k=O(i,"prelu weights","fused matMul"));const w=(E,A)=>{const[S,T,F,M]=A,U=ew(B(E,F.shape),F,o);let P,L;if(!n&&!s?(P=Ue(U,T,!1,!0),L=Ue(S,U,!0,!1)):!n&&s?(P=Ue(U,T,!1,!1),L=Ue(U,S,!0,!1)):n&&!s?(P=Ue(T,U,!1,!0),L=Ue(S,U,!1,!1)):(P=Ue(T,U,!0,!0),L=Ue(U,S,!0,!0)),r!=null){const G=tw(M,U);return[P,L,G]}else return[P,L]},I={a:b,b:$,bias:C,preluActivationWeights:k},R={transposeA:n,transposeB:s,activation:o,leakyreluAlpha:a};return r==null?Ll((A,S,T)=>{const F=V.runKernel(dp,I,R);return T([A,S,F]),{value:B(F,v),gradFunc:w}})(b,$):Ll((A,S,T,F)=>{const M=V.runKernel(dp,I,R);return F([A,S,M,T]),{value:B(M,v),gradFunc:w}})(b,$,C)}const Bk=W({fusedMatMul_:wG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $G(t,e,n,s,r="bilinear",o=0){const i=O(t,"image","cropAndResize"),a=O(e,"boxes","cropAndResize","float32"),l=O(n,"boxInd","cropAndResize","int32"),u=a.shape[0];N(i.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${i.rank}.`),N(a.rank===2&&a.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${u},4] but had shape ${a.shape}.`),N(l.rank===1&&l.shape[0]===u,()=>`Error in cropAndResize: boxInd must be have size [${u}] but had shape ${a.shape}.`),N(s.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${s.length}.`),N(s[0]>=1&&s[1]>=1,()=>`cropSize must be atleast [1,1], but was ${s}`),N(r==="bilinear"||r==="nearest",()=>`method must be bilinear or nearest, but was ${r}`);const c={image:i,boxes:a,boxInd:l},d={method:r,extrapolationValue:o,cropSize:s};return V.runKernel(qb,c,d)}const CG=W({cropAndResize_:$G});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kG(t){const e=O(t,"image","flipLeftRight","float32");N(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const n={image:e};return V.runKernel(r1,n,{})}const SG=W({flipLeftRight_:kG});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IG(t){const e=O(t,"image","grayscaleToRGB"),n=e.rank-1,s=e.shape[n];N(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),N(s===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${s}.`);const r=new Array(e.rank);return r.fill(1,0,n),r[n]=3,sr(e,r)}const TG=W({grayscaleToRGB_:IG});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EG(t){const e=O(t,"image","RGBToGrayscale"),n=e.rank-1,s=e.shape[n];N(e.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${e.rank}.`),N(s===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${s}.`);const r=e.dtype,o=ce(e,"float32"),i=Zn([.2989,.587,.114]);let a;switch(e.rank){case 2:a=Tu("ij,j->i",o,i);break;case 3:a=Tu("ijk,k->ij",o,i);break;case 4:a=Tu("ijkl,l->ijk",o,i);break;case 5:a=Tu("ijklm,m->ijkl",o,i);break;case 6:a=Tu("ijklmn,n->ijklm",o,i);break;default:throw new Error("Not a valid tensor rank.")}return a=Mn(a,-1),ce(a,r)}const NG=W({rgbToGrayscale_:EG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RG(t,e,n=0,s=.5){const r=O(t,"image","rotateWithOffset","float32");N(r.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${r.rank}.`);const o={image:r},i={radians:e,fillValue:n,center:s};return V.runKernel(C1,o,i)}const AG=W({rotateWithOffset_:RG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eu(t,e,n,s,r,o){s==null&&(s=.5),r==null&&(r=Number.NEGATIVE_INFINITY),o==null&&(o=0);const i=t.shape[0];return n=Math.min(n,i),N(0<=s&&s<=1,()=>`iouThreshold must be in [0, 1], but was '${s}'`),N(t.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${t.rank}'`),N(t.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${t.shape[1]}`),N(e.rank===1,()=>"scores must be a 1D tensor"),N(e.shape[0]===i,()=>`scores has incompatible shape with boxes. Expected ${i}, but was ${e.shape[0]}`),N(0<=o&&o<=1,()=>`softNmsSigma must be in [0, 1], but was '${o}'`),{maxOutputSize:n,iouThreshold:s,scoreThreshold:r,softNmsSigma:o}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DG(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY){const o=O(t,"boxes","nonMaxSuppression","float32"),i=O(e,"scores","nonMaxSuppression","float32"),a=eu(o,i,n,s,r);n=a.maxOutputSize,s=a.iouThreshold,r=a.scoreThreshold;const l={maxOutputSize:n,iouThreshold:s,scoreThreshold:r};return V.runKernel(c1,{boxes:o,scores:i},l)}const FG=W({nonMaxSuppression_:DG});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PG(t,e,n){const s=OG(t,e,n),r=s<0?-(s+1):s;t.splice(r,0,e)}function OG(t,e,n){return MG(t,e,n||LG)}function LG(t,e){return t>e?1:t<e?-1:0}function MG(t,e,n){let s=0,r=t.length,o=0,i=!1;for(;s<r;){o=s+(r-s>>>1);const a=n(e,t[o]);a>0?s=o+1:(r=o,i=!a)}return i?s:-s-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rw(t,e,n,s,r){return aw(t,e,n,s,r,0)}function ow(t,e,n,s,r,o){return aw(t,e,n,s,r,0,!1,o,!0)}function iw(t,e,n,s,r,o){return aw(t,e,n,s,r,o,!0)}function aw(t,e,n,s,r,o,i=!1,a=!1,l=!1){const u=[];for(let y=0;y<e.length;y++)e[y]>r&&u.push({score:e[y],boxIndex:y,suppressBeginIndex:0});u.sort(Wk);const c=o>0?-.5/o:0,d=[],f=[];for(;d.length<n&&u.length>0;){const y=u.pop(),{score:m,boxIndex:x,suppressBeginIndex:v}=y;if(m<r)break;let b=!1;for(let $=d.length-1;$>=v;--$){const C=_G(t,x,d[$]);if(C>=s){b=!0;break}if(y.score=y.score*zG(s,c,C),y.score<=r)break}y.suppressBeginIndex=d.length,b||(y.score===m?(d.push(x),f.push(y.score)):y.score>r&&PG(u,y,Wk))}const h=d.length,p=n-h;a&&p>0&&(d.push(...new Array(p).fill(0)),f.push(...new Array(p).fill(0)));const g={selectedIndices:d};return i&&(g.selectedScores=f),l&&(g.validOutputs=h),g}function _G(t,e,n){const s=t.subarray(e*4,e*4+4),r=t.subarray(n*4,n*4+4),o=Math.min(s[0],s[2]),i=Math.min(s[1],s[3]),a=Math.max(s[0],s[2]),l=Math.max(s[1],s[3]),u=Math.min(r[0],r[2]),c=Math.min(r[1],r[3]),d=Math.max(r[0],r[2]),f=Math.max(r[1],r[3]),h=(a-o)*(l-i),p=(d-u)*(f-c);if(h<=0||p<=0)return 0;const g=Math.max(o,u),y=Math.max(i,c),m=Math.min(a,d),x=Math.min(l,f),v=Math.max(m-g,0)*Math.max(x-y,0);return v/(h+p-v)}function zG(t,e,n){const s=Math.exp(e*n*n);return n<=t?s:0}function Wk(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function VG(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY){const o=O(t,"boxes","nonMaxSuppressionAsync"),i=O(e,"scores","nonMaxSuppressionAsync"),a=eu(o,i,n,s,r);n=a.maxOutputSize,s=a.iouThreshold,r=a.scoreThreshold;const l=await Promise.all([o.data(),i.data()]),u=l[0],c=l[1],{selectedIndices:d}=rw(u,c,n,s,r);return o!==t&&o.dispose(),i!==e&&i.dispose(),Zn(d,"int32")}const BG=VG;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WG(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,o=0){const i=O(t,"boxes","nonMaxSuppression"),a=O(e,"scores","nonMaxSuppression"),l=eu(i,a,n,s,r,o);n=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold,o=l.softNmsSigma;const u={boxes:i,scores:a},c={maxOutputSize:n,iouThreshold:s,scoreThreshold:r,softNmsSigma:o},d=V.runKernel(f1,u,c);return{selectedIndices:d[0],selectedScores:d[1]}}const UG=W({nonMaxSuppressionWithScore_:WG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function GG(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,o=0){const i=O(t,"boxes","nonMaxSuppressionAsync"),a=O(e,"scores","nonMaxSuppressionAsync"),l=eu(i,a,n,s,r,o);n=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold,o=l.softNmsSigma;const u=await Promise.all([i.data(),a.data()]),c=u[0],d=u[1],{selectedIndices:f,selectedScores:h}=iw(c,d,n,s,r,o);return i!==t&&i.dispose(),a!==e&&a.dispose(),{selectedIndices:Zn(f,"int32"),selectedScores:Zn(h)}}const HG=GG;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jG(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,o=!1){const i=O(t,"boxes","nonMaxSuppression"),a=O(e,"scores","nonMaxSuppression"),l=eu(i,a,n,s,r,null),u=l.maxOutputSize,c=l.iouThreshold,d=l.scoreThreshold,f={boxes:i,scores:a},h={maxOutputSize:u,iouThreshold:c,scoreThreshold:d,padToMaxOutputSize:o},p=V.runKernel(d1,f,h);return{selectedIndices:p[0],validOutputs:p[1]}}const KG=W({nonMaxSuppressionPadded_:jG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function XG(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,o=!1){const i=O(t,"boxes","nonMaxSuppressionAsync"),a=O(e,"scores","nonMaxSuppressionAsync"),l=eu(i,a,n,s,r,null),u=l.maxOutputSize,c=l.iouThreshold,d=l.scoreThreshold,[f,h]=await Promise.all([i.data(),a.data()]),{selectedIndices:p,validOutputs:g}=ow(f,h,u,c,d,o);return i!==t&&i.dispose(),a!==e&&a.dispose(),{selectedIndices:Zn(p,"int32"),validOutputs:Ge(g,"int32")}}const qG=XG;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YG(t,e,n=!1,s=!1){const r=O(t,"images","resizeBilinear");N(r.rank===3||r.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${r.rank}.`),N(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),N(s===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let o=r,i=!1;r.rank===3&&(i=!0,o=B(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const a={images:o},l={alignCorners:n,halfPixelCenters:s,size:e},u=V.runKernel(pg,a,l);return i?B(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const RR=W({resizeBilinear_:YG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QG(t,e,n=!1,s=!1){const r=O(t,"images","resizeNearestNeighbor");N(r.rank===3||r.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${r.rank}.`),N(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),N(r.dtype==="float32"||r.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),N(s===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let o=r,i=!1;r.rank===3&&(i=!0,o=B(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const a={images:o},l={alignCorners:n,halfPixelCenters:s,size:e},u=V.runKernel(hg,a,l);return i?B(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const AR=W({resizeNearestNeighbor_:QG});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZG(t,e="binary",n=!1,s=.5){const r=O(t,"image","threshold"),o=.2989,i=.587,a=.114,l=r.shape[0]*r.shape[1];let u=z(Zn([s]),255),c,d,f,h;if(N(r.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${r.rank}.`),N(r.shape[2]===3||r.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${r.shape[2]}.`),N(r.dtype==="int32"||r.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${r.dtype}.`),N(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),r.shape[2]===3){[c,d,f]=ps(r,[1,1,1],-1);const y=z(c,o),m=z(d,i),x=z(f,a);h=ne(ne(y,m),x)}else h=t;if(e==="otsu"){const y=QB(ce(yR(h),"int32"),Fn([]),256);u=JG(y,l)}const p=n?Jl(h,u):vs(h,u);return ce(z(p,255),"int32")}function JG(t,e){let n=Zn([-1]),s=Zn([0]),r=Zn([0]),o,i,a,l,u,c;for(let d=0;d<t.size-1;d++){o=st(t,0,d+1),i=st(t,d+1),u=xe(ge(o),e),c=xe(ge(i),e);const f=ge(z(o,Lc(0,o.size)));a=xe(f,ge(o));const h=Rg(i.shape,o.size),p=ne(Lc(0,i.size),h),g=z(i,p);l=xe(ge(g),ge(i));const y=ye(a,l),m=ye(a,l),x=z(u,c);r=z(z(x,y),m);const v=vs(r,s);s=En(v,r,s),n=En(v,Zn([d]),n)}return n}const e5=W({threshold_:ZG});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t5(t,e,n="nearest",s="constant",r=0,o){const i=O(t,"image","transform","float32"),a=O(e,"transforms","transform","float32");N(i.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${i.rank}.`),N(a.rank===2&&(a.shape[0]===i.shape[0]||a.shape[0]===1)&&a.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),N(o==null||o.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${o}.`);const l={image:i,transforms:a},u={interpolation:n,fillMode:s,fillValue:r,outputShape:o};return V.runKernel(w1,l,u)}const n5=W({transform_:t5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s5(t,e,n){const s=O(t,"a","bandPart");N(s.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${s.rank}.`);const r=s.shape,[o,i]=s.shape.slice(-2);let a,l;typeof e=="number"?(N(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),N(e<=o,()=>`bandPart(): numLower (${e}) must not be greater than the number of rows (${o}).`),a=O(e<0?o:e,"numLower","bandPart")):(N(e.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),a=En(xp(e,0),o,Oc(e,o))),typeof n=="number"?(N(n%1===0,()=>`bandPart(): numUpper must be an integer, got ${n}.`),N(n<=i,()=>`bandPart(): numUpper (${n}) must not be greater than the number of columns (${i}).`),l=O(n<0?i:n,"numUpper","bandPart")):(N(n.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),l=En(xp(n,0),i,Oc(n,i)));const u=B(Lc(0,o,1,"int32"),[-1,1]),c=Lc(0,i,1,"int32"),d=ye(u,c),f=uo(Jl(d,a),ka(d,Tt(l))),h=xt([o,i],s.dtype);return B(co(la(B(s,[-1,o,i])).map(p=>En(f,p,h))),r)}const r5=W({bandPart_:s5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o5(t){let e;if(Array.isArray(t)){e=!1,N(t!=null&&t.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const r=t[0].shape[0];for(let o=1;o<t.length;++o)N(t[o].shape[0]===r,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${t[o].shape[0]} vs. ${r})`)}else e=!0,t=ps(t,t.shape[0],0).map(r=>Jd(r,[0]));N(t.length<=t[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${t.length}) exceeds number of dimensions (${t[0].shape[0]}).`);const n=[],s=t;for(let r=0;r<t.length;++r)n.push(V.tidy(()=>{let o=s[r];if(r>0)for(let i=0;i<r;++i){const a=z(ge(z(n[i],o)),n[i]);o=ye(o,a)}return xe(o,Dg(o,"euclidean"))}));return e?co(n,0):n}const i5=W({gramSchmidt_:o5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a5(t,e=!1){if(N(t.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${t.rank}`),t.rank===2)return Uk(t,e);{const n=t.shape.slice(0,t.shape.length-2).reduce((l,u)=>l*u),s=la(B(t,[n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),r=[],o=[];s.forEach(l=>{const[u,c]=Uk(l,e);r.push(u),o.push(c)});const i=B(co(r,0),t.shape),a=B(co(o,0),t.shape);return[i,a]}}function Uk(t,e=!1){return V.tidy(()=>{N(t.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${t.shape.length}D Tensor.`);const n=t.shape[0],s=t.shape[1];let r=uR(n),o=Ui(t);const i=K0([[1]],[1,1]);let a=Ui(i);const l=n>=s?s:n;for(let u=0;u<l;++u){const c=o,d=a,f=r;[a,o,r]=V.tidy(()=>{const h=st(o,[u,u],[n-u,1]),p=Dg(h),g=st(o,[u,u],[1,1]),y=En(vs(g,0),K0([[-1]]),K0([[1]])),m=ye(g,z(y,p)),x=xe(h,m);x.shape[0]===1?a=Ui(i):a=Bn([i,st(x,[1,0],[x.shape[0]-1,x.shape[1]])],0);const v=Tt(xe(Ue(y,m),p)),b=st(o,[u,0],[n-u,s]),$=z(v,a),C=Oe(a);if(u===0)o=ye(b,Ue($,Ue(C,b)));else{const I=ye(b,Ue($,Ue(C,b)));o=Bn([st(o,[0,0],[u,s]),I],0)}const k=Oe($),w=st(r,[0,u],[n,r.shape[1]-u]);if(u===0)r=ye(w,Ue(Ue(w,a),k));else{const I=ye(w,Ue(Ue(w,a),k));r=Bn([st(r,[0,0],[n,u]),I],1)}return[a,o,r]}),Ae([c,d,f])}return!e&&n>s&&(r=st(r,[0,0],[n,s]),o=st(o,[0,0],[s,s])),[r,o]})}const l5=W({qr_:a5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eo={flipLeftRight:SG,grayscaleToRGB:TG,resizeNearestNeighbor:AR,resizeBilinear:RR,rgbToGrayscale:NG,rotateWithOffset:AG,cropAndResize:CG,nonMaxSuppression:FG,nonMaxSuppressionAsync:BG,nonMaxSuppressionWithScore:UG,nonMaxSuppressionWithScoreAsync:HG,nonMaxSuppressionPadded:KG,nonMaxSuppressionPaddedAsync:qG,threshold:e5,transform:n5},u5={bandPart:r5,gramSchmidt:i5,qr:l5};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c5=new Map,d5=new Map;class tu{getClassName(){return this.constructor.className}static fromConfig(e,n){return new e(n)}}class Ds{constructor(){this.classNameMap={}}static getMap(){return Ds.instance==null&&(Ds.instance=new Ds),Ds.instance}static register(e){Ds.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function J(t,e,n){N(t.className!=null,()=>"Class being registered does not have the static className property defined."),N(typeof t.className=="string",()=>"className is required to be a string, but got type "+typeof t.className),N(t.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof e>"u"&&(e="Custom"),typeof n>"u"&&(n=t.className);const s=n,r=e+">"+s;return Ds.register(t),c5.set(r,t),d5.set(t,r),t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mi extends tu{minimize(e,n=!1,s){const{value:r,grads:o}=this.computeGradients(e,s);if(s!=null){const i=s.map(a=>({name:a.name,tensor:o[a.name]}));this.applyGradients(i)}else this.applyGradients(o);return Ae(o),n?r:(r.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,n){return yU(e,n)}dispose(){this.iterations_!=null&&Ae(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:Ge(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(mi,Symbol.hasInstance,{value:t=>t.minimize!=null&&t.computeGradients!=null&&t.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class DR extends mi{static get className(){return"Adadelta"}constructor(e,n,s=null){super(),this.learningRate=e,this.rho=n,this.epsilon=s,this.accumulatedGrads=[],this.accumulatedUpdates=[],s==null&&(this.epsilon=V.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const o=V.registeredVariables[s],i=!1;this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accum_grad`,variable:H(()=>Le(o).variable(i))}),this.accumulatedUpdates[r]==null&&(this.accumulatedUpdates[r]={originalName:`${s}/accum_var`,variable:H(()=>Le(o).variable(i))});const a=Array.isArray(e)?e[r].tensor:e[s];if(a==null)return;const l=this.accumulatedGrads[r].variable,u=this.accumulatedUpdates[r].variable;H(()=>{const c=ne(z(l,this.rho),z(at(a),1-this.rho)),d=z(xe(mn(ne(u,this.epsilon)),mn(ne(l,this.epsilon))),a),f=ne(z(u,this.rho),z(at(d),1-this.rho));l.assign(c),u.assign(f);const h=ne(z(d,-this.learningRate),o);o.assign(h)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(Ae(this.accumulatedGrads.map(e=>e.variable)),Ae(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=e.length/2,s=!1;this.accumulatedGrads=e.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedUpdates=e.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.rho,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class FR extends mi{static get className(){return"Adagrad"}constructor(e,n=.1){super(),this.learningRate=e,this.initialAccumulatorValue=n,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const o=V.registeredVariables[s];this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accumulator`,variable:H(()=>Rg(o.shape,this.initialAccumulatorValue).variable(!1))});const i=Array.isArray(e)?e[r].tensor:e[s];if(i==null)return;const a=this.accumulatedGrads[r].variable;H(()=>{const l=ne(a,at(i));a.assign(l);const u=ne(z(xe(i,mn(ne(l,V.backend.epsilon()))),-this.learningRate),o);o.assign(u)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&Ae(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulatedGrads=e.map(s=>({originalName:s.name,variable:s.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,n){return new e(n.learningRate,n.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class PR extends mi{static get className(){return"Adam"}constructor(e,n,s,r=null){super(),this.learningRate=e,this.beta1=n,this.beta2=s,this.epsilon=r,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],H(()=>{this.accBeta1=Ge(n).variable(),this.accBeta2=Ge(s).variable()}),r==null&&(this.epsilon=V.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);H(()=>{const s=ye(1,this.accBeta1),r=ye(1,this.accBeta2);n.forEach((o,i)=>{const a=V.registeredVariables[o],l=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:`${o}/m`,variable:H(()=>Le(a).variable(l))}),this.accumulatedSecondMoment[i]==null&&(this.accumulatedSecondMoment[i]={originalName:`${o}/v`,variable:H(()=>Le(a).variable(l))});const u=Array.isArray(e)?e[i].tensor:e[o];if(u==null)return;const c=this.accumulatedFirstMoment[i].variable,d=this.accumulatedSecondMoment[i].variable,f=ne(z(c,this.beta1),z(u,1-this.beta1)),h=ne(z(d,this.beta2),z(at(u),1-this.beta2)),p=xe(f,s),g=xe(h,r);c.assign(f),d.assign(h);const y=ne(z(xe(p,ne(mn(g),this.epsilon)),-this.learningRate),a);a.assign(y)}),this.accBeta1.assign(z(this.accBeta1,this.beta1)),this.accBeta2.assign(z(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Ae(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&Ae(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e),H(()=>{this.accBeta1.assign(ia(this.beta1,this.iterations_+1)),this.accBeta2.assign(ia(this.beta2,this.iterations_+1))});const n=e.length/2,s=!1;this.accumulatedFirstMoment=e.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedSecondMoment=e.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class OR extends mi{static get className(){return"Adamax"}constructor(e,n,s,r=null,o=0){super(),this.learningRate=e,this.beta1=n,this.beta2=s,this.epsilon=r,this.decay=o,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],H(()=>{this.iteration=Ge(0).variable(),this.accBeta1=Ge(n).variable()}),r==null&&(this.epsilon=V.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);H(()=>{const s=ye(1,this.accBeta1),r=xe(-this.learningRate,ne(z(this.iteration,this.decay),1));n.forEach((o,i)=>{const a=V.registeredVariables[o],l=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:`${o}/m`,variable:Le(a).variable(l)}),this.accumulatedWeightedInfNorm[i]==null&&(this.accumulatedWeightedInfNorm[i]={originalName:`${o}/v`,variable:Le(a).variable(l)});const u=Array.isArray(e)?e[i].tensor:e[o];if(u==null)return;const c=this.accumulatedFirstMoment[i].variable,d=this.accumulatedWeightedInfNorm[i].variable,f=ne(z(c,this.beta1),z(u,1-this.beta1)),h=z(d,this.beta2),p=Cn(u),g=pi(h,p);c.assign(f),d.assign(g);const y=ne(z(xe(r,s),xe(f,ne(g,this.epsilon))),a);a.assign(y)}),this.iteration.assign(ne(this.iteration,1)),this.accBeta1.assign(z(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Ae(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&Ae(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lw extends mi{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const o=Array.isArray(e)?e[r].tensor:e[s];if(o==null)return;const i=V.registeredVariables[s];H(()=>{const a=ne(z(this.c,o),i);i.assign(a)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=Rr(Ge(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,n){return new e(n.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class LR extends lw{static get className(){return"Momentum"}constructor(e,n,s=!1){super(e),this.learningRate=e,this.momentum=n,this.useNesterov=s,this.accumulations=[],this.m=Ge(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const o=V.registeredVariables[s];this.accumulations[r]==null&&(this.accumulations[r]={originalName:`${s}/momentum`,variable:H(()=>Le(o).variable(!1))});const i=this.accumulations[r].variable,a=Array.isArray(e)?e[r].tensor:e[s];a!=null&&H(()=>{let l;const u=ne(z(this.m,i),a);this.useNesterov?l=ne(z(this.c,ne(a,z(u,this.m))),o):l=ne(z(this.c,u),o),i.assign(u),o.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&Ae(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulations=e.map(s=>({originalName:s.name,variable:s.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,n){return new e(n.learningRate,n.momentum,n.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class MR extends mi{static get className(){return"RMSProp"}constructor(e,n=.9,s=0,r=null,o=!1){if(super(),this.learningRate=e,this.decay=n,this.momentum=s,this.epsilon=r,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=o,r==null&&(this.epsilon=V.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const o=V.registeredVariables[s],i=!1;this.accumulatedMeanSquares[r]==null&&(this.accumulatedMeanSquares[r]={originalName:`${s}/rms`,variable:H(()=>Le(o).variable(i))}),this.accumulatedMoments[r]==null&&(this.accumulatedMoments[r]={originalName:`${s}/momentum`,variable:H(()=>Le(o).variable(i))}),this.accumulatedMeanGrads[r]==null&&this.centered&&(this.accumulatedMeanGrads[r]={originalName:`${s}/mg`,variable:H(()=>Le(o).variable(i))});const a=Array.isArray(e)?e[r].tensor:e[s];if(a==null)return;const l=this.accumulatedMeanSquares[r].variable,u=this.accumulatedMoments[r].variable;H(()=>{const c=ne(z(l,this.decay),z(at(a),1-this.decay));if(this.centered){const d=this.accumulatedMeanGrads[r].variable,f=ne(z(d,this.decay),z(a,1-this.decay)),h=xe(z(a,this.learningRate),mn(ye(c,ne(at(f),this.epsilon)))),p=ne(z(u,this.momentum),h);l.assign(c),d.assign(f),u.assign(p);const g=ye(o,p);o.assign(g)}else{const d=ne(z(l,this.decay),z(at(a),1-this.decay)),f=ne(z(u,this.momentum),xe(z(a,this.learningRate),mn(ne(d,this.epsilon))));l.assign(d),u.assign(f);const h=ye(o,f);o.assign(h)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&Ae(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&Ae(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&Ae(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=this.centered?e.length/3:e.length/2,s=!1;this.accumulatedMeanSquares=e.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedMoments=e.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.centered&&(this.accumulatedMeanGrads=e.slice(n*2,n*3).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,n){return new e(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const f5=[DR,FR,PR,OR,LR,MR,lw];function h5(){for(const t of f5)J(t)}function uw(t,e){const n=t.shape.length,s=e.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(s<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${s}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[s-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[s-1]} vs. ${n}`);if(Y(t.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${t.shape}.`);const r=e.shape,o=r[r.length-1];let i=1;for(let d=0;d<r.length-1;++d)i*=r[d];const a=t.shape,l=r.slice();l.pop();let u=1;for(let d=o;d<n;++d)u*=a[d],l.push(a[d]);const c=[...me(t.shape).map(d=>d/u),1].slice(0,o);return[l,i,u,c]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zy=-2,p5=-1;function cw(t,e,n){const s=t.shape.length;N(s===e.length,()=>`Error in slice${s}D: Length of begin ${e} must match the rank of the array (${s}).`),N(s===n.length,()=>`Error in slice${s}D: Length of size ${n} must match the rank of the array (${s}).`);for(let r=0;r<s;++r)N(e[r]+n[r]<=t.shape[r],()=>`Error in slice${s}D: begin[${r}] + size[${r}] (${e[r]+n[r]}) would overflow input.shape[${r}] (${t.shape[r]})`)}function m5(t){const e=[];let n=0;for(;t>0;)t&1&&e.push(n),t/=2,n++;return e}function dw(t,e,n){const s=[];for(let r=0;r<t.length;r++)s[r]=Math.ceil((e[r]-t[r])/n[r]);return s}function _R(t,e,n,s){const r=[...t];for(let o=r.length;o<s.length;o++)r.push(1);for(let o=0;o<n;o++)o===0?r[e]=1:(r.splice(e,0,1),r.pop());return r}function zR(t,e,n){return n<=t?n:n-(e-1)}function VR(t,e){const n=[];for(let s=0;s<t;s++)n.push(e+s);return n}function g5(t,e,n,s,r,o,i,a,l){const u=t.length;let c=new Array(u),d=new Array(u),f=new Array(u);if(e.length&&n>0){const h=e[0],p=n+1;c=BR(i,h,p,s,t),d=WR(a,h,p,r,t),f=_R(o,h,p,t)}else for(let h=0;h<u;h++)c[h]=GR(i,s,o,t,h,l),d[h]=HR(a,r,o,t,h,l),f[h]=UR(o,h,l);return{begin:c,end:d,strides:f}}function BR(t,e,n,s,r){const o=[...r],i=VR(n,e);for(let a=0;a<o.length;a++)if(i.indexOf(a)>-1)o[a]=0;else{const l=zR(e,n,a);let u=s[l];t&1<<l&&(u=0),o[a]=u}return o}function WR(t,e,n,s,r){const o=[...r],i=VR(n,e);for(let a=0;a<o.length;a++)if(i.indexOf(a)>-1)o[a]=Number.MAX_SAFE_INTEGER;else{const l=zR(e,n,a);let u=s[l];t&1<<l&&(u=Number.MAX_SAFE_INTEGER),o[a]=u}for(let a=0;a<o.length;a++){const l=r[a];o[a]<0&&(o[a]+=l),o[a]=Ji(0,o[a],r[a])}return o}function UR(t,e,n){let s=t[e];return(n&1<<e||s==null)&&(s=1),s}function GR(t,e,n,s,r,o){let i=e[r];const a=n[r]||1;(t&1<<r||o&1<<r||i==null)&&(a>0?i=Number.MIN_SAFE_INTEGER:i=Number.MAX_SAFE_INTEGER);const l=s[r];return i<0&&(i+=l),i=Ji(0,i,l-1),i}function HR(t,e,n,s,r,o){let i=e[r];const a=n[r]||1;(t&1<<r||o&1<<r||i==null)&&(a>0?i=Number.MAX_SAFE_INTEGER:i=Number.MIN_SAFE_INTEGER);const l=s[r];return i<0&&(i+=l),a>0?i=Ji(0,i,l):i=Ji(-1,i,l-1),i}function fw(t,e,n){let s=n.length;for(let r=0;r<n.length;r++)if(n[r]>1){s=r;break}for(let r=s+1;r<n.length;r++)if(e[r]>0||n[r]!==t[r])return!1;return!0}function hw(t,e){let n=t.length>0?t[t.length-1]:1;for(let s=0;s<t.length-1;s++)n+=t[s]*e[s];return n}function Pg(t,e,n){let s;const r=t.shape.length;typeof e=="number"?s=[e,...new Array(r-1).fill(0)]:e.length<r?s=e.concat(new Array(r-e.length).fill(0)):s=e.slice(),s.forEach(i=>{N(i!==-1,()=>"slice() does not support negative begin indexing.")});let o;return n==null?o=new Array(r).fill(-1):typeof n=="number"?o=[n,...new Array(r-1).fill(-1)]:n.length<r?o=n.concat(new Array(r-n.length).fill(-1)):o=n,o=o.map((i,a)=>i>=0?i:(N(i===-1,()=>`Negative size values should be exactly -1 but got ${i} for the slice() size at index ${a}.`),t.shape[a]-s[a])),[s,o]}function pw(t,e,n,s,r,o,i,a,l){let u;if(s==null?(u=new Array(e.length),u.fill(1)):u=s,i!=null&&i&i-1)throw new Error("Multiple ellipses in slice is not allowed.");let c=!1;const d={dims:u.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:n.slice(),strides:u.slice(),beginMask:r,endMask:o,ellipsisMask:i,newAxisMask:a,shrinkAxisMask:l};for(let v=0;v<d.dims;v++)c&&1<<v&a&&d.numAddAxisAfterEllipsis++,1<<v&i&&(c=!0);c||(d.ellipsisMask|=1<<d.dims,d.dims++);const f={dims:t.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};x5(d,f);let h=!0,p=!0,g=!0;const y=[],m=[];for(let v=0;v<t.length;++v){if(f.strides[v]===0)throw Error(`strides[${v}] must be non-zero`);const b=!!(f.shrinkAxisMask&1<<v),$=t[v];if($===-1){y.push(b?1:-1);continue}const C=[f.beginMask&1<<v,f.endMask&1<<v],k=[f.strides[v]>0?0:-1,f.strides[v]>0?$:$-1];if(b&&f.strides[v]<=0)throw Error("only stride 1 allowed on non-range indexing.");g=g&&f.strides[v]===1;const w=!!(f.beginMask&1<<v&&f.endMask&1<<v);if(f.beginValid&&f.endValid){if(b){const A=f.begin[v]<0?$+f.begin[v]:f.begin[v];if(f.begin[v]=A,f.end[v]=f.begin[v]+1,A<0||A>=$)throw Error(`slice index ${f.begin[v]} of dimension ${v} out of bounds.`)}else f.begin[v]=Gk(f.begin[v],0,f.strides[v],$,C,k),f.end[v]=Gk(f.end[v],1,f.strides[v],$,C,k);const E=f.strides[v]===1&&f.begin[v]===0&&f.end[v]===$;h=h&&E,p=p&&(v===0&&f.strides[v]===1||E)}else h=h&&f.strides[v]===1&&w,p=p&&(v===0&&f.strides[v]===1||w);let I,R=!1;if(f.beginValid&&f.endValid?(I=f.end[v]-f.begin[v],R=!0):b?(I=1,R=!0):w&&$>=0&&(f.strides[v]<0?I=-$:I=$,R=!0),R){let E;I===0||I<0!=f.strides[v]<0?E=0:E=Math.trunc(I/f.strides[v])+(I%f.strides[v]!==0?1:0),y.push(E)}else y.push(-1)}for(let v=0;v<f.finalShapeGatherIndices.length;++v){const b=f.finalShapeGatherIndices[v];b>=0?m.push(y[b]):b===zy&&m.push(1)}return{finalShapeSparse:m.filter((v,b)=>f.finalShapeGatherIndices[b]!==zy),finalShape:m,isIdentity:h,sliceDim0:p,isSimpleSlice:g,begin:f.begin,end:f.end,strides:f.strides}}function x5(t,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let n=0;e.beginValid=t.begin!=null,e.endValid=t.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let s=0;s<t.dims;s++)if(1<<s&t.ellipsisMask){const r=Math.min(e.dims-(t.dims-s)+1+t.numAddAxisAfterEllipsis,e.dims);for(;n<r;n++)e.begin[n]=0,e.end[n]=0,e.strides[n]=1,e.beginMask|=1<<n,e.endMask|=1<<n,e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[n]=s}else if(1<<s&t.newAxisMask)e.finalShapeGatherIndices.push(zy),e.finalShapeGatherIndicesSparse.push(-1);else{if(n===e.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${e.dims} dims, ${e.begin.length}.`);t.begin!=null&&(e.begin[n]=t.begin[s]),t.end!=null&&(e.end[n]=t.end[s]),e.strides[n]=t.strides[s],t.beginMask&1<<s&&(e.beginMask|=1<<n),t.endMask&1<<s&&(e.endMask|=1<<n),t.shrinkAxisMask&1<<s?(e.finalShapeGatherIndices.push(p5),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<n):(e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(s)),e.inputShapeGatherIndicesSparse[n]=s,n++}}function Gk(t,e,n,s,r,o){if(r[e])return n>0?o[e]:o[e+1&1];{const i=t<0?s+t:t;return i<o[0]?o[0]:i>o[1]?o[1]:i}}const y5=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:cw,computeFlatOffset:hw,computeOutShape:dw,getNormalizedAxes:g5,isSliceContinous:fw,maskToAxes:m5,parseSliceParams:Pg,sliceInfo:pw,startForAxis:GR,startIndicesWithElidedDims:BR,stopForAxis:HR,stopIndicesWithElidedDims:WR,stridesForAxis:UR,stridesWithElidedDims:_R},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class v5{static sgd(e){return new lw(e)}static momentum(e,n,s=!1){return new LR(e,n,s)}static rmsprop(e,n=.9,s=0,r=null,o=!1){return new MR(e,n,s,r,o)}static adam(e=.001,n=.9,s=.999,r=null){return new PR(e,n,s,r)}static adadelta(e=.001,n=.95,s=null){return new DR(e,n,s)}static adamax(e=.002,n=.9,s=.999,r=null,o=0){return new OR(e,n,s,r,o)}static adagrad(e,n=.1){return new FR(e,n)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ma=v5;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b5=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:t=>t();function jR(){return new Promise(t=>b5(()=>t()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mw(t,e){const n=t[0].length;t.forEach((r,o)=>{N(r.length===n,()=>`Error in concat${n}D: rank of tensors[${o}] must be the same as the rank of the rest (${n})`)}),N(e>=0&&e<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const s=t[0];t.forEach((r,o)=>{for(let i=0;i<n;i++)N(i===e||r[i]===s[i],()=>`Error in concat${n}D: Shape of tensors[${o}] (${r}) does not match the shape of the rest (${s}) along the non-concatenated axis ${o}.`)})}function Ar(t,e){const n=t[0].slice();for(let s=1;s<t.length;s++)n[e]+=t[s][e];return n}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var nr;(function(t){t[t.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",t[t.VALUE_ROWIDS=1]="VALUE_ROWIDS",t[t.ROW_LENGTHS=2]="ROW_LENGTHS",t[t.ROW_SPLITS=3]="ROW_SPLITS",t[t.ROW_LIMITS=4]="ROW_LIMITS",t[t.ROW_STARTS=5]="ROW_STARTS"})(nr||(nr={}));function KR(t,e,n){let s=new Array;if(n==null&&e==null)return s;if(e==null)for(;s.length<t+n.length;)s.push(-1);else s=e.slice();if(n==null)return s;if(t+n.length!==s.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${t+n.length}, but shape.rank = ${s.length}`);for(let r=1;r<n.length;++r){const o=n[r],i=s[s.length-n.length+r],a=s[i];if(o>=0)if(a>=0){if(a!==o)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${r+t}] = ${o} but shape[${r+t}] = ${a}`)}else s[i]=o}return s}function XR(t){const e={FIRST_DIM_SIZE:nr.FIRST_DIM_SIZE,VALUE_ROWIDS:nr.VALUE_ROWIDS,ROW_LENGTHS:nr.ROW_LENGTHS,ROW_SPLITS:nr.ROW_SPLITS,ROW_LIMITS:nr.ROW_LIMITS,ROW_STARTS:nr.ROW_STARTS},n=[];for(const s of t)if(s in e)n.push(e[s]);else break;return n}function qR(t){return t.length===0?0:t[0]===nr.FIRST_DIM_SIZE?t.length-1:t.length}function YR(t,e){if(t==null||e==null)return;const n=t.length,s=e.length;if(n>=s)throw new Error(`defaultValue.shape=${t} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${s})`);for(let r=0;r<Math.min(n,s-1);++r){const o=t[r],i=e[r+1];if(o>=0&&i>=0&&o!==1&&o!==i)throw new Error(`defaultValue.shape=${t}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${r-t.length}] = ${o} but ragged tensor input.flatValues.shape[${r-t.length}] = ${i}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gw=30;function Og(t){return t<=gw?t:$y(t,Math.floor(Math.sqrt(t)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xw(t,e,n){const s=n*(typeof t=="number"?t:t[0]),r=e*(typeof t=="number"?t:t[1]);return[s,r]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tf(t,e,n,s=!0){let r=[];if(s)r=r.concat(e.slice(0)),r.push(t[0]/n),r=r.concat(t.slice(1));else{r=r.concat(t[0]);const o=e.length;for(let i=0;i<o;++i)r=r.concat([t[i+1]/e[i],e[i]]);r=r.concat(t.slice(o+1))}return r}function nf(t,e,n=!0){const s=[];if(n){s.push(e);for(let r=e+1;r<t;++r)r<=2*e?(s.push(r),s.push(r-(e+1))):s.push(r)}else{const r=[],o=[];for(let i=1;i<t;++i)i>=e*2+1||i%2===1?o.push(i):r.push(i);s.push(...r),s.push(0),s.push(...o)}return s}function sf(t,e,n,s=!0){const r=[];s?r.push(t[0]/n):r.push(t[0]*n);for(let o=1;o<t.length;++o)o<=e.length?s?r.push(e[o-1]*t[o]):r.push(t[o]/e[o-1]):r.push(t[o]);return r}function yw(t,e){const n=[0];for(let s=0;s<e;++s)n.push(t[s][0]);return n}function vw(t,e,n){const s=t.slice(0,1);for(let r=0;r<n;++r)s.push(t[r+1]-e[r][0]-e[r][1]);return s}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lg=1.7580993408473768,Mg=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bw=.3275911,ww=.254829592,$w=-.284496736,Cw=1.421413741,kw=-1.453152027,Sw=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fo(t,e){if(t.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${t.length}, imag: ${e.length}.`);const n=new Float32Array(t.length*2);for(let s=0;s<n.length;s+=2)n[s]=t[s/2],n[s+1]=e[s/2];return n}function QR(t){const e=new Float32Array(t.length/2),n=new Float32Array(t.length/2);for(let s=0;s<t.length;s+=2)e[s/2]=t[s],n[s/2]=t[s+1];return{real:e,imag:n}}function ZR(t){const e=Math.ceil(t.length/4),n=new Float32Array(e),s=new Float32Array(e);for(let r=0;r<t.length;r+=4)n[Math.floor(r/4)]=t[r],s[Math.floor(r/4)]=t[r+1];return{real:n,imag:s}}function JR(t){const e=Math.floor(t.length/4),n=new Float32Array(e),s=new Float32Array(e);for(let r=2;r<t.length;r+=4)n[Math.floor(r/4)]=t[r],s[Math.floor(r/4)]=t[r+1];return{real:n,imag:s}}function Iw(t,e){const n=t[e*2],s=t[e*2+1];return{real:n,imag:s}}function eA(t,e,n,s){t[s*2]=e,t[s*2+1]=n}function tA(t,e){const n=new Float32Array(t/2),s=new Float32Array(t/2);for(let r=0;r<Math.ceil(t/2);r++){const o=(e?2:-2)*Math.PI*(r/t);n[r]=Math.cos(o),s[r]=Math.sin(o)}return{real:n,imag:s}}function nA(t,e,n){const s=(n?2:-2)*Math.PI*(t/e),r=Math.cos(s),o=Math.sin(s);return{real:r,imag:o}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X0="->",w5=/->/g,Hk=",",jk="...";function Tw(t,e){t=t.replace(/\s/g,"");const n=(t.length-t.replace(w5,"").length)/X0.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${X0}").`);const[s,r]=t.split(X0);N(s.indexOf(jk)===-1,()=>`The ellipsis notation ("${jk}") is not supported yet.`);const o=s.split(Hk),i=o.length;if(e!==i)throw new Error(`Expected ${i} input tensors, received ${e}`);if(i>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const a=[];for(let f=0;f<r.length;++f){const h=r[f];if(!o.some(p=>p.indexOf(h)!==-1))throw new Error(`Output subscripts contain the label ${h} not present in the input subscripts.`);a.indexOf(h)===-1&&a.push(h)}for(let f=0;f<s.length;++f){const h=s[f];a.indexOf(h)===-1&&h!==Hk&&a.push(h)}const l=new Array(o.length);for(let f=0;f<i;++f){if(new Set(o[f].split("")).size!==o[f].length)throw new Error(`Found duplicate axes in input component ${o[f]}. Support for duplicate axes in input is not implemented yet.`);l[f]=[];for(let h=0;h<o[f].length;++h)l[f].push(a.indexOf(o[f][h]))}const u=a.length,c=r.length,d=[];for(let f=c;f<u;++f)d.push(f);return{allDims:a,summedDims:d,idDims:l}}function Ew(t,e){let n=new Array(t);n.fill(-1);for(let r=0;r<e.length;++r)n[e[r]]=r;const s=[];for(let r=0;r<t;++r)n[r]===-1&&s.push(r);return n=n.filter(r=>r!==-1),{permutationIndices:n,expandDims:s}}function Nw(t,e,n){const s=new Array(t);for(let r=0;r<n.length;++r){const o=n[r].shape;for(let i=0;i<e[r].length;++i)s[e[r][i]]===void 0?s[e[r][i]]=o[i]:N(s[e[r][i]]===o[i],()=>`Expected dimension ${s[e[r][i]]} at axis ${i} of input shaped ${JSON.stringify(o)}, but got dimension ${o[i]}`)}}function Rw(t,e){const n=t,s=[];let r=0;t.length===0&&n.push(-1),r=t.length+1;for(let i=0;i<r;++i)s.push([]);const o=[];for(let i=0;i<n.length;++i){const a=n[i],l=$5(e,a);for(const u of l)o.indexOf(u)===-1&&(s[i].push(u),o.push(u))}return{path:n,steps:s}}function Aw(t){return t.every((e,n)=>e===n)}function $5(t,e){const n=[];for(let s=0;s<t.length;++s)(t[s].length===0||t[s].indexOf(e)!==-1||e===-1)&&n.push(s);return n}function Dw(t,e,n=0){let s=[];if(typeof e=="number")N(t.shape[n]%e===0,()=>"Number of splits must evenly divide the axis."),s=new Array(e).fill(t.shape[n]/e);else{const r=e.reduce((i,a)=>(a===-1&&(i+=1),i),0);N(r<=1,()=>"There should be only one negative value in split array.");const o=e.indexOf(-1);if(o!==-1){const i=e.reduce((a,l)=>l>0?a+l:a);e[o]=t.shape[n]-i}N(t.shape[n]===e.reduce((i,a)=>i+a),()=>"The sum of sizes must match the size of the axis dimension."),s=e}return s}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sA(t){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${t}`}function rA(t,e){return`indices(${t}, 0) is invalid: ${e} < 0`}function oA(t,e,n){return`indices(${t}, 0) is invalid: ${e} >= ${n}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iA(t,e){return`only one output dimension may be -1, not both ${t} and ${e}`}function aA(t,e){return`size ${t} must be non-negative, not ${e}`}function lA(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function uA(t,e){const n=Y(t),s=Y(e);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${s}. inputShape=${t} outputShape= ${e}`}function cA(t,e){const n=Y(t),s=Y(e);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${s}. inputShape=${t} outputShape=${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vy(){return"segment ids must be >= 0"}function dA(){return"segment ids are not increasing"}function fA(t,e){return`Segment id ${t} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function hA(t,e,n){return`Bad: indices[${t}] == ${e} out of range [0, ${n})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pA(t,e){let n=!1,s;for(t<=gw?(s=t,n=!0):s=$y(t,Math.floor(Math.sqrt(t)));!n;)s>e||s===t?n=!0:s=$y(t,s+1);return s}function mA(t,e,n){const s=[],r=t.length;for(let o=0;o<r;o++)o!==e?s.push(t[o]):s.push(n);return s}function Fw(t,e,n,s){const r=e.shape.length,o=t.shape.length;if(s!==0&&(s<-r||s>r))throw new Error(`Expect batchDims in the range of [-${r}, ${r}], but got ${s}`);if(s<0&&(s+=r),s>o)throw new Error(`batchDims (${s}) must be less than rank(x) (
    ${o}).`);if(n<s)throw new Error(`batchDims (${s}) must be less than or equal to axis (${n}).`);for(let d=0;d<s;++d)if(t.shape[d]!==e.shape[d])throw new Error(`x.shape[${d}]: ${t.shape[d]} should be equal to indices.shape[${d}]: ${e.shape[d]}.`);const i=t.shape[n],a=[];let l=1,u=1,c=1;for(let d=0;d<s;++d)a.push(t.shape[d]),l*=t.shape[d];for(let d=s;d<n;d++)a.push(t.shape[d]),u*=t.shape[d];for(let d=s;d<r;d++)a.push(e.shape[d]);for(let d=n+1;d<o;d++)a.push(t.shape[d]),c*=t.shape[d];return{batchSize:l,sliceSize:c,outerSize:u,dimSize:i,outputShape:a}}const C5=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:Fw,computeOutShape:mA,segOpComputeOptimalWindowSize:pA},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ho(t){try{return t.map(e=>ti(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function gA(t){return t.map(e=>Xo(e))}const k5=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:ww,ERF_A2:$w,ERF_A3:Cw,ERF_A4:kw,ERF_A5:Sw,ERF_P:bw,PARALLELIZE_THRESHOLD:gw,get RowPartitionType(){return nr},SELU_SCALE:Mg,SELU_SCALEALPHA:Lg,applyActivation:nw,assertAndGetBroadcastShape:Se,assertAxesAreInnerMostDims:on,assertParamsConsistent:mw,assignToTypedArray:eA,axesAreInnerMostDims:F1,calculateShapes:Ta,checkEinsumDimSizes:Nw,checkPadOnDimRoundingMode:jn,combineLocations:aR,combineRaggedTensorToTensorShapes:KR,complexWithEvenIndex:ZR,complexWithOddIndex:JR,computeConv2DInfo:rn,computeConv3DInfo:fi,computeDefaultPad:T1,computeDilation2DInfo:Yd,computeOptimalWindowSize:Og,computeOutAndReduceShapes:Jt,computeOutShape:Ar,computePool2DInfo:Gs,computePool3DInfo:xo,convertConv2DDataFormat:yo,decodeEinsumEquation:Tw,eitherStridesOrDilationsAreOne:gn,expandShapeToKeepDim:Lt,exponent:nA,exponents:tA,fromStringArrayToUint8:gA,fromUint8ToStringArray:ho,getAxesPermutation:vt,getBroadcastDims:Ol,getComplexWithIndex:Iw,getEinsumComputePath:Rw,getEinsumPermutation:Ew,getFusedBiasGradient:tw,getFusedDyActivation:ew,getImageCenter:xw,getInnerMostAxes:Nt,getPermuted:nf,getRaggedRank:qR,getReductionAxes:Ht,getReshaped:tf,getReshapedPermuted:sf,getRowPartitionTypesHelper:XR,getSliceBeginCoords:yw,getSliceSize:vw,getSparseFillEmptyRowsIndicesDenseShapeMismatch:sA,getSparseFillEmptyRowsNegativeIndexErrorMessage:rA,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:oA,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:lA,getSparseReshapeInputOutputMismatchErrorMessage:cA,getSparseReshapeInputOutputMultipleErrorMessage:uA,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:iA,getSparseReshapeNegativeOutputDimErrorMessage:aA,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:hA,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:Vy,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:dA,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:fA,getUndoAxesPermutation:hi,isIdentityPermutation:Aw,log:iV,mergeRealAndImagArrays:fo,prepareAndValidate:uw,prepareSplitSize:Dw,segment_util:C5,shouldFuse:sw,slice_util:y5,splitRealAndImagArrays:QR,stridesOrDilationsArePositive:ra,tupleValuesAreOne:sa,upcastType:ss,validateDefaultValueShape:YR,validateInput:tG,validateUpdateShape:IR,warn:cs},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */h5();/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xA={kernelName:Sm,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>z(t,ef(ce(n,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S5={kernelName:td,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=at(ce(n,"float32")),r=mn(ye(Ge(1),s));return Tt(xe(t,r))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I5={kernelName:nd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=mn(ye(at(ce(n,"float32")),1));return xe(t,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T5={kernelName:Yl,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Se(n.shape,s.shape);return{a:()=>{let a=t;const l=Ht(n.shape,r);return l.length>0&&(a=ge(a,l)),B(a,n.shape)},b:()=>{let a=t;const l=Ht(s.shape,r);return l.length>0&&(a=ge(a,l)),B(a,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E5={kernelName:Mb,saveAllInputs:!0,gradFunc:(t,e)=>{const n={};return e.forEach((s,r)=>{n[r]=()=>t.clone()}),n}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N5={kernelName:Im,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Le(n)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R5={kernelName:Tm,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Le(n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A5={kernelName:sd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>xe(t,mn(ye(Ge(1),at(ce(n,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D5={kernelName:rd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=mn(ne(Ge(1),at(ce(n,"float32"))));return xe(t,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F5={kernelName:ad,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Se(n.shape,s.shape);return{a:()=>{const a=ne(at(n),at(s));let l=z(t,xe(s,a));const u=Ht(n.shape,r);return u.length>0&&(l=ge(l,u)),B(l,n.shape)},b:()=>{const a=ne(at(n),at(s));let l=Tt(z(t,xe(n,a)));const u=Ht(s.shape,r);return u.length>0&&(l=ge(l,u)),B(l,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P5={kernelName:od,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>xe(t,ne(at(ce(n,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O5={kernelName:id,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>xe(t,ye(Ge(1),at(ce(n,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L5(t,e,n,s,r,o){const i=O(t,"dy","avgPool3dGrad"),a=O(e,"input","avgPool3dGrad");let l=i,u=a,c=!1;a.rank===4&&(c=!0,l=B(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]]),u=B(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),N(l.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`),N(u.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${u.rank}.`),jn("avgPool3dGrad",r,o);const d={dy:l,input:u},f={filterSize:n,strides:s,pad:r,dimRoundingMode:o},h=V.runKernel(Bb,d,f);return c?B(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const M5=W({avgPool3dGrad_:L5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _5={kernelName:Nm,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{filterSize:r,strides:o,pad:i,dimRoundingMode:a}=n;return{x:()=>M5(t,s,r,o,i,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z5(t,e,n,s,r){const o=O(t,"dy","avgPoolGrad"),i=O(e,"input","avgPoolGrad");N(i.rank===o.rank,()=>`Rank of input (${i.rank}) does not match rank of dy (${o.rank})`);let a=i,l=o,u=!1;i.rank===3&&(u=!0,a=B(i,[1,i.shape[0],i.shape[1],i.shape[2]]),l=B(o,[1,o.shape[0],o.shape[1],o.shape[2]])),N(l.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),N(a.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${a.rank}.`);const c={dy:l,input:a},d={filterSize:n,strides:s,pad:r},f=V.runKernel(Vb,c,d);return u?B(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const V5=W({avgPoolGrad_:z5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const B5={kernelName:Em,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{filterSize:r,strides:o,pad:i}=n;return{x:()=>V5(t,s,r,o,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W5={kernelName:Rm,inputsToSave:["a","b"],gradFunc:(t,e,n)=>{const[s,r]=e,{transposeA:o,transposeB:i}=n;return!o&&!i?{a:()=>Ue(t,r,!1,!0),b:()=>Ue(s,t,!0,!1)}:!o&&i?{a:()=>Ue(t,r,!1,!1),b:()=>Ue(t,s,!0,!1)}:o&&!i?{a:()=>Ue(r,t,!1,!0),b:()=>Ue(s,t,!1,!1)}:{a:()=>Ue(r,t,!0,!0),b:()=>Ue(t,s,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U5={kernelName:Am,gradFunc:(t,e,n)=>{const{blockShape:s,crops:r}=n;return{x:()=>B1(t,s,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G5={kernelName:nV,gradFunc:(t,e,n)=>{const s=n,r=s.inputShape,o=s.shape,i=Array.from(o);for(let l=r.length-1;l>=0;l--)if(r[l]===o[l])i[l]=1;else if(r[l]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${o}].`);const a=[];for(let l=0;l<i.length;l++)i[l]>1&&a.push(l);return{x:()=>ge(t,a,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H5={kernelName:ld,gradFunc:t=>({x:()=>t.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j5={kernelName:ud,gradFunc:t=>({x:()=>Le(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K5={kernelName:cd,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{clipValueMin:r,clipValueMax:o}=n;return{x:()=>En(uo(ka(s,r),Jl(s,o)),t,Le(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X5={kernelName:Dm,inputsToSave:["x"],gradFunc:xA.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q5={kernelName:Fm,saveAllInputs:!0,gradFunc:(t,e,n)=>{const s=e.map(l=>l.shape),{axis:r}=n,o=Ne(r,e[0].shape)[0],i=s.map(l=>l[o]);return ps(t,i,o).map(l=>()=>l)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Y5={kernelName:Pm,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[s,r]=e,{dilations:o,strides:i,pad:a,dataFormat:l}=n;return N(sa(o),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${o}'`),{x:()=>R1(s.shape,t,r,i,a,l),filter:()=>J1(s,t,r.shape,i,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q5={kernelName:Om,inputsToSave:["dy","filter"],gradFunc:(t,e,n)=>{const[s,r]=e,{strides:o,pad:i,dataFormat:a,dimRoundingMode:l}=n;return{dy:()=>oa(t,r,o,i,a,1,l),filter:()=>J1(t,s,r.shape,o,i,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z5(t,e,n,s,r){let o=t;t.rank===4&&(o=B(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]));let i=e;i.rank===4&&(i=B(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),N(o.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${o.shape}.`),N(i.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${i.shape}.`),N(n.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${n}.`),N(o.shape[4]===n[3],()=>`Error in conv3dDerFilter: depth of input ${o.shape[4]}) must match input depth in filter (${n[3]}.`),N(i.shape[4]===n[4],()=>`Error in conv3dDerFilter: depth of dy (${i.shape[4]}) must match output depth for filter (${n[4]}).`);const a={x:o,dy:i},l={strides:s,pad:r,filterShape:n};return V.runKernel(jb,a,l)}const J5=W({conv3DBackpropFilter_:Z5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eH={kernelName:Lm,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:s,strides:r,pad:o}=n;N(sa(s),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`);const[i,a]=e;return{x:()=>sR(i.shape,t,a,r,o),filter:()=>J5(i,t,a.shape,r,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tH={kernelName:dd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>z(Tt($R(ce(n,"float32"))),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nH={kernelName:fd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>z(CR(ce(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sH={kernelName:Mm,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:r,exclusive:o,reverse:i}=n;return{x:()=>{const a=vt([r],s.rank);let l=oR(t,r,o,!i);return a!=null&&(l=Oe(l,a)),l}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rH={kernelName:_m,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:s,strides:r,pad:o,dimRoundingMode:i}=n,a=s??[1,1];N(sa(a),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`);const[l,u]=e;return N(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`),N(u.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${u.rank}.`),N(l.shape[3]===u.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${u.shape[2]}.`),N(gn(r,a),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${r} and dilations '${a}'.`),jn("depthwiseConv2d",o,i),{x:()=>bG(l.shape,t,u,r,o,a,i),filter:()=>yG(l,t,u.shape,r,o,a,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oH={kernelName:zm,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[s,r]=e,o={x:s,filter:r,dy:t},i={x:s,filter:r,dy:t};return{x:()=>V.runKernel(Cy,o,n),filter:()=>V.runKernel(ky,i,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iH={kernelName:pd,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e,s={dy:t,y:n};return{x:()=>V.runKernel(t1,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aH={kernelName:md,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,s=z(Lr(Tt(at(n))),2/Math.sqrt(Math.PI));return{x:()=>z(t,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lH={kernelName:gd,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>z(t,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uH={kernelName:Bm,inputsToSave:["input"],gradFunc:(t,e)=>{const[n]=e;return{input:()=>B(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cH={kernelName:xd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>z(t,Lr(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dH={kernelName:yd,gradFunc:t=>({x:()=>Le(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fH={kernelName:vd,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Se(n.shape,s.shape);return{a:()=>{const a=xe(t,ce(s,"float32")),l=Ht(n.shape,r);return l.length>0?B(ge(a,l),n.shape):a},b:()=>{let a=z(t,ce(n,"float32"));const l=Ht(s.shape,r);l.length>0&&(a=B(ge(a,l),s.shape));const u=at(s);return Tt(xe(a,ce(u,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hH={kernelName:Wm,inputsToSave:["x","mean","variance","scale"],gradFunc:(t,e,n)=>{const{varianceEpsilon:s}=n,[r,o,i,a]=e,l=a??Ge(1),u=Ht(o.shape,r.shape),c=[];if(o.rank===1){for(let b=0;b<r.shape.length-1;++b)c.push(r.shape[b]);c.push(1)}const d=ye(r,o),f=z(t,l),h=vR(ne(i,Ge(s))),p=z(z(z(h,h),h),Ge(-.5));return{x:()=>o.rank===1?B(z(z(t,sr(B(h,[1,1,1,o.shape[0]]),c)),l),r.shape):B(z(z(t,h),l),r.shape),mean:()=>{let b=z(z(h,Ge(-1)),f);return o.rank===1&&(b=ge(b,u)),B(b,o.shape)},variance:()=>{let b=z(z(p,d),f);return o.rank===1&&(b=ge(b,u)),B(b,o.shape)},scale:()=>{const b=z(d,h);let $=z(t,b);return o.rank===1&&($=ge($,u)),B($,o.shape)},offset:()=>{let b=t;return o.rank===1&&(b=ge(b,u)),B(b,o.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pH={kernelName:Um,inputsToSave:["x","indices"],gradFunc:(t,e,n)=>{const[s,r]=e,{axis:o,batchDims:i}=n,a=Ne(o,s.shape)[0],l=(u,c,d)=>()=>{const f=u.shape,h=c.size,p=f.slice(0,a),g=p.length,y=f.slice(o,f.length).slice(1),m=y.length,x=Kk(0,g),v=Kk(g+1,g+1+m),b=Xk([p,[h],y]),$=B(d,b),C=B(c,[h]),k=Xk([[g],x,v]),w=Oe($,k);let I=ER(w,C,u.shape[a]);const R=hi(k);return I=Oe(I,R),I};if(i===1){const u=s.shape[0],c=s.split(u,0);return{x:()=>co(c.map((h,p)=>l(h,r.slice(p,1),t.slice(p,1))())).reshape(s.shape),indices:()=>r}}else return{x:l(s,r,t),indices:()=>r}}};function Kk(t,e){const n=[];for(let s=t;s<e;++s)n.push(s);return n}function Xk(t){const e=[];for(let n=0;n<t.length;++n)for(let s=0;s<t[n].length;++s)e.push(t[n][s]);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mH={kernelName:bd,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>Le(n),b:()=>Le(s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gH={kernelName:wd,gradFunc:t=>({x:()=>ce(t,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xH={kernelName:$d,gradFunc:t=>({x:()=>Le(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yH={kernelName:Cd,gradFunc:t=>({x:()=>Le(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vH={kernelName:kd,gradFunc:t=>({x:()=>Le(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bH={kernelName:Hm,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{alpha:r}=n,o=vs(s,0);return{x:()=>En(o,t,z(t,r))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wH={kernelName:Id,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>xe(t,ne(n,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $H={kernelName:Sd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>xe(t,ce(n,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CH={kernelName:rV,inputsToSave:[],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s]=e,{axis:r}=n;return{logits:()=>{const i=Lr(s);return ye(t,z(ge(t,r,!0),i))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kH(t,e,n,s=5,r=1,o=1,i=.5){const a={x:t,y:e,dy:n},l={depthRadius:s,bias:r,alpha:o,beta:i};return V.runKernel(a1,a,l)}const SH=W({localResponseNormalizationBackprop_:kH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IH={kernelName:Qm,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,r]=e,{depthRadius:o,bias:i,alpha:a,beta:l}=n;return{x:()=>SH(s,r,t,o,i,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yA(t,e,n,s){return e.rank<n.rank&&(e=B(e,Lt(e.shape,s))),t.rank<n.rank&&(t=B(t,Lt(t.shape,s))),{x:()=>z(t,ce(Or(n,e),t.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qk={kernelName:Zm,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const s=n,{reductionIndices:r}=s,o=e[0],i=e[1],a=Ne(r,o.shape),l=yA(t,i,o,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TH={kernelName:Td,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>z(t,ce(ka(n,s),"float32")),b:()=>z(t,ce(xp(n,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EH(t,e,n,s,r,o,i){const a=O(t,"dy","maxPool3dGrad"),l=O(e,"input","maxPool3dGrad"),u=O(n,"output","maxPool3dGrad");let c=a,d=l,f=u,h=!1;l.rank===4&&(h=!0,c=B(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]]),d=B(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),f=B(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]])),N(c.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${c.rank}.`),N(d.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${d.rank}.`),N(f.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${f.rank}.`),jn("maxPool3dGrad",o,i);const p={dy:c,input:d,output:f},g={filterSize:s,strides:r,pad:o,dimRoundingMode:i},y=V.runKernel(u1,p,g);return h?B(y,[y.shape[1],y.shape[2],y.shape[3],y.shape[4]]):y}const NH=W({maxPool3dGrad_:EH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RH={kernelName:eg,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,r]=e,{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=n;return{x:()=>NH(t,s,r,o,i,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AH(t,e,n,s,r,o,i){const a=O(t,"dy","maxPoolGrad"),l=O(e,"input","maxPoolGrad"),u=O(n,"output","maxPoolGrad");N(l.rank===a.rank,()=>`Rank of input (${l.rank}) does not match rank of dy (${a.rank})`),N(a.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${a.rank}.`),N(l.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`),jn("maxPoolGrad",o,i);const c={dy:a,input:l,output:u},d={filterSize:s,strides:r,pad:o,dimRoundingMode:i};return V.runKernel(l1,c,d)}const DH=W({maxPoolGrad_:AH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FH={kernelName:Jm,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,r]=e,{filterSize:o,strides:i,pad:a}=n;return{x:()=>DH(t,s,r,o,i,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PH={kernelName:tg,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:r}=n,o=Ne(r,s.shape),a=Jt(s.shape,o)[1],l=Y(a);return{x:()=>{const c=s.shape.slice();o.forEach(h=>{c[h]=1});const d=B(t,c);return xe(z(d,vo(s.shape,"float32")),l)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OH={kernelName:ng,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const s=n,{axis:r}=s,[o,i]=e,a=Ne(r,o.shape),l=yA(t,i,o,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LH={kernelName:Ed,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>z(t,ce(Jl(n,s),"float32")),b:()=>z(t,ce(vs(n,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MH={kernelName:sg,inputsToSave:["x"],gradFunc:(t,e,n)=>{const s=e[0],{paddings:r}=n,o=r.map(i=>i[0]);return{x:()=>st(t,o,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _H={kernelName:Nd,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Se(n.shape,s.shape);return{a:()=>{const a=Ht(n.shape,r);return a.length>0?B(ge(t,a),n.shape):t},b:()=>{const a=z(t,Tt(Fg(xe(n,s)))),l=Ht(s.shape,r);return l.length>0?B(ge(a,l),s.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zH={kernelName:Rd,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Se(n.shape,s.shape);return{a:()=>{const a=z(t,ce(s,"float32")),l=Ht(n.shape,r);return l.length>0?B(ge(a,l),n.shape):a},b:()=>{const a=z(t,ce(n,"float32")),l=Ht(s.shape,r);return l.length>0?B(ge(a,l),s.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VH={kernelName:rg,gradFunc:t=>({x:()=>Tt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BH={kernelName:ag,inputsToSave:["indices"],gradFunc:(t,e)=>{const n=e[0];return{indices:()=>xt(n.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WH={kernelName:ig,gradFunc:t=>({x:()=>Le(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UH={kernelName:lg,saveAllInputs:!0,gradFunc:(t,e,n)=>{const{axis:s}=n;return la(t,s).map(o=>()=>o)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yk={kernelName:ug,inputsToSave:["x"],gradFunc:(t,e,n)=>{const s=e[0],{paddings:r}=n,o=r.map(i=>i[0]);return{x:()=>st(t,o,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GH={kernelName:Ad,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(t,e)=>{const[n,s,r]=e,o=n,i=s,a=Se(o.shape,i.shape);return{a:()=>{const c=ce(i,"float32");let d=z(t,z(c,ia(o,ye(c,Ge(1)))));const f=Ht(o.shape,a);return f.length>0&&(d=ge(d,f)),B(d,o.shape)},b:()=>{const c=vs(o,0),d=En(c,Mr(o),Le(o));let f=z(t,z(r,d));const h=Ht(i.shape,a);return h.length>0&&(f=ge(f,h)),B(f,i.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HH={kernelName:cg,inputsToSave:["x","alpha"],gradFunc:(t,e)=>{const[n,s]=e,r=vs(n,0);return{x:()=>En(r,t,z(t,s)),alpha:()=>{let o=En(r,Le(t),z(t,n));const i=Ht(s.shape,t.shape);return i.length>0&&(o=ge(o,i)),B(o,s.shape)}}}};/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jH(t,e,n){const s=t.shape.slice();s[n]=1;const r=B(e,s),o=My(t,n,!0,!1),i=My(t,n,!0,!0),a=z(o,i);return z(r,a)}function KH(t,e,n){const s=t.shape.length,r=s-n.length,o=vt(n,s);let i=t;o!=null&&(i=Oe(t,o));const a=i.shape.slice(),u=a.splice(s-n.length,n.length).reduce((f,h)=>f*h,1);a.push(u);const c=i.reshape(a);let d=jH(c,e,r);if(d=d.reshape(i.shape),o!=null){const f=hi(o);d=Oe(d,f)}return d}const XH={kernelName:dg,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:r}=n;let o=[];return r==null?o=s.shape.map((i,a)=>a):typeof r=="number"?o=[r]:o=r,{x:()=>KH(s,t,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qH={kernelName:hd,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Se(n.shape,s.shape);return{a:()=>{const a=xe(t,ce(s,"float32")),l=Ht(n.shape,r);return l.length>0?B(ge(a,l),n.shape):a},b:()=>{let a=z(t,ce(n,"float32"));const l=Ht(s.shape,r);l.length>0&&(a=B(ge(a,l),s.shape));const u=at(s);return Tt(xe(a,ce(u,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YH={kernelName:Dd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>xe(t,Tt(at(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QH={kernelName:Pd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,s=z(Jl(n,6),ef(n));return{x:()=>z(t,ce(s,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZH={kernelName:Fd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>z(t,ce(ef(n),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JH={kernelName:fg,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>B(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e7={kernelName:pg,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[s]=e,r={dy:t,images:s};return{images:()=>V.runKernel(g1,r,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t7={kernelName:hg,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[s]=e,r={dy:t,images:s};return{images:()=>V.runKernel(m1,r,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n7={kernelName:mg,gradFunc:(t,e,n)=>{const{dims:s}=n,r=Ne(s,t.shape);return{x:()=>aa(t,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s7={kernelName:Od,gradFunc:t=>({x:()=>Le(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r7={kernelName:Ld,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Tt(xe(t,z(ia(n,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o7={kernelName:gg,inputsToSave:["condition"],gradFunc:(t,e)=>{const[n]=e;return{condition:()=>ce(Le(n),"float32"),t:()=>z(t,ce(n,t.dtype)),e:()=>z(t,ce(M1(n),t.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i7={kernelName:Md,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=vs(n,Ge(0)),r=Ge(Lg),o=Ge(Mg),i=z(t,o),a=z(z(t,r),Lr(ce(n,"float32")));return En(s,i,a)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a7={kernelName:Bd,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>z(t,z(n,ye(Ge(1),n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l7={kernelName:Vd,gradFunc:t=>({x:()=>Le(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u7={kernelName:_d,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>z(A1(ce(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c7={kernelName:zd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>z(rR(ce(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d7={kernelName:xg,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{begin:r,size:o}=n,i=s.shape,[a,l]=Pg(s,r,o),u=[];for(let c=0;c<t.rank;c++)u.push([a[c],i[c]-a[c]-l[c]]);return{x:()=>V1(t,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const f7={kernelName:wg,outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s]=e,{dim:r}=n,o=!0,i=z(t,s);return{logits:()=>ye(i,z(ge(i,[r],o),s))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h7={kernelName:Wd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>z(t,Zl(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qk={kernelName:vg,gradFunc:(t,e,n)=>{const{blockShape:s,paddings:r}=n;return{x:()=>N1(t,s,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zk={kernelName:bg,gradFunc:(t,e,n)=>{const{axis:s}=n;return{x:()=>Bn(t,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p7={kernelName:Ud,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>xe(t,z(mn(ce(n,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m7={kernelName:x1,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>z(t,z(ce(n,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g7={kernelName:Gd,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Ge(2);return{a:()=>z(t,z(r,ye(n,s))),b:()=>z(t,z(r,ye(s,n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x7={kernelName:qd,gradFunc:t=>({x:()=>Le(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y7={kernelName:Hd,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Se(n.shape,s.shape);return{a:()=>{let a=t;const l=Ht(n.shape,r);return l.length>0&&(a=ge(a,l)),B(a,n.shape)},b:()=>{let a=t;const l=Ht(s.shape,r);return l.length>0&&(a=ge(a,l)),B(Tt(a),s.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v7={kernelName:yg,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,r=s.shape.slice(),{axis:o}=n;Ne(o,s.shape).forEach(u=>{r[u]=1});const a=B(t,r),l=z(a,vo(s.shape,"float32"));return{x:()=>l}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b7={kernelName:jd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>xe(t,at(A1(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w7={kernelName:Kd,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>z(ye(Ge(1),at(n)),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $7={kernelName:Xd,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{reps:r}=n;return{x:()=>{let i=Le(s);if(s.rank===1)for(let a=0;a<r[0];++a)i=ne(i,st(t,[a*s.shape[0]],[s.shape[0]]));else if(s.rank===2)for(let a=0;a<r[0];++a)for(let l=0;l<r[1];++l)i=ne(i,st(t,[a*s.shape[0],l*s.shape[1]],[s.shape[0],s.shape[1]]));else if(s.rank===3)for(let a=0;a<r[0];++a)for(let l=0;l<r[1];++l)for(let u=0;u<r[2];++u)i=ne(i,st(t,[a*s.shape[0],l*s.shape[1],u*s.shape[2]],[s.shape[0],s.shape[1],s.shape[2]]));else if(s.rank===4)for(let a=0;a<r[0];++a)for(let l=0;l<r[1];++l)for(let u=0;u<r[2];++u)for(let c=0;c<r[3];++c)i=ne(i,st(t,[a*s.shape[0],l*s.shape[1],u*s.shape[2],c*s.shape[3]],[s.shape[0],s.shape[1],s.shape[2],s.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${s.rank} tensors yet.`);return i}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C7={kernelName:yl,gradFunc:(t,e,n)=>{const s=n,{perm:r}=s,o=hi(r);return{x:()=>Oe(t,o)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k7={kernelName:$g,gradFunc:(t,e,n)=>{const s=n,{axis:r}=s;return{value:()=>co(t,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S7={kernelName:Cg,inputsToSave:["segmentIds"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>I7(t,n)}}};function I7(t,e){const n=pi(e,Le(e)),s=P1(t,n);let r=ka(e,Ge(0,"int32"));const o=s.rank-r.rank;for(let a=0;a<o;++a)r=Mn(r,a+1);r=uo(r,vo(s.shape,"bool"));const i=Le(s);return En(r,s,i)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T7={kernelName:kg,gradFunc:t=>({x:()=>Le(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E7=[xA,S5,I5,T5,E5,N5,R5,A5,D5,F5,P5,O5,_5,B5,W5,U5,G5,H5,j5,K5,X5,q5,Q5,Y5,eH,tH,nH,sH,rH,oH,qH,iH,aH,lH,uH,cH,fH,dH,hH,pH,mH,gH,xH,yH,vH,bH,wH,$H,CH,IH,qk,qk,TH,RH,FH,PH,OH,LH,MH,_H,zH,VH,BH,WH,UH,Yk,Yk,GH,HH,XH,YH,QH,ZH,JH,e7,t7,n7,s7,r7,o7,i7,a7,l7,u7,c7,d7,f7,h7,Qk,Qk,Zk,Zk,p7,g7,m7,x7,y7,v7,b7,w7,$7,C7,k7,S7,T7];for(const t of E7)aV(t);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.abs=function(){return this.throwIfDisposed(),Cn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.acos=function(){return this.throwIfDisposed(),cB(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.acosh=function(){return this.throwIfDisposed(),fB(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.add=function(t){return this.throwIfDisposed(),ne(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.all=function(t,e){return this.throwIfDisposed(),eR(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.any=function(t,e){return this.throwIfDisposed(),Oy(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.argMax=function(t){return this.throwIfDisposed(),Dc(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.argMin=function(t){return this.throwIfDisposed(),xB(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.asScalar=function(){return this.throwIfDisposed(),N(this.size===1,()=>"The array must have only 1 element."),B(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.asType=function(t){return this.throwIfDisposed(),ce(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.as1D=function(){return this.throwIfDisposed(),B(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.as2D=function(t,e){return this.throwIfDisposed(),B(this,[t,e])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.as3D=function(t,e,n){return this.throwIfDisposed(),B(this,[t,e,n])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.as4D=function(t,e,n,s){return this.throwIfDisposed(),B(this,[t,e,n,s])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.as5D=function(t,e,n,s,r){return this.throwIfDisposed(),B(this,[t,e,n,s,r])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.asin=function(){return this.throwIfDisposed(),vB(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.asinh=function(){return this.throwIfDisposed(),wB(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.atan=function(){return this.throwIfDisposed(),CB(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.atan2=function(t){return this.throwIfDisposed(),SB(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.atanh=function(){return this.throwIfDisposed(),TB(this)};q().prototype.avgPool=function(t,e,n,s){return this.throwIfDisposed(),E1(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),N1(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.batchNorm=function(t,e,n,s,r){return this.throwIfDisposed(),Ng(this,t,e,n,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.broadcastTo=function(t){return this.throwIfDisposed(),rc(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.cast=function(t){return this.throwIfDisposed(),ce(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.ceil=function(){return this.throwIfDisposed(),eW(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.clipByValue=function(t,e){return this.throwIfDisposed(),gs(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.concat=function(t,e){return this.throwIfDisposed(),t instanceof zt&&(t=[t]),Bn([this,...t],e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.conv1d=function(t,e,n,s,r,o){return this.throwIfDisposed(),tR(this,t,e,n,s,r,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.conv2dTranspose=function(t,e,n,s,r){return this.throwIfDisposed(),nR(this,t,e,n,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.conv2d=function(t,e,n,s,r,o){return this.throwIfDisposed(),oa(this,t,e,n,s,r,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.cos=function(){return this.throwIfDisposed(),A1(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.cosh=function(){return this.throwIfDisposed(),rR(this)};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.cumprod=function(t,e,n){return this.throwIfDisposed(),My(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.cumsum=function(t,e,n){return this.throwIfDisposed(),oR(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),SW(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.depthwiseConv2d=function(t,e,n,s,r,o){return this.throwIfDisposed(),D1(this,t,e,n,s,r,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.dilation2d=function(t,e,n,s,r){return this.throwIfDisposed(),EW(this,t,e,n,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.divNoNan=function(t){return this.throwIfDisposed(),FW(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.div=function(t){return this.throwIfDisposed(),xe(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.dot=function(t){return this.throwIfDisposed(),OW(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.elu=function(){return this.throwIfDisposed(),Ag(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.equal=function(t){return this.throwIfDisposed(),Or(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.erf=function(){return this.throwIfDisposed(),iR(this)};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.euclideanNorm=function(t,e){return this.throwIfDisposed(),KW(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.exp=function(){return this.throwIfDisposed(),Lr(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.expandDims=function(t){return this.throwIfDisposed(),Mn(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.expm1=function(){return this.throwIfDisposed(),QW(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.fft=function(){return this.throwIfDisposed(),SR(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.flatten=function(){return this.throwIfDisposed(),B(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.floor=function(){return this.throwIfDisposed(),Fg(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.floorDiv=function(t){return this.throwIfDisposed(),JN(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.gather=function(t,e,n){return this.throwIfDisposed(),P1(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.greaterEqual=function(t){return this.throwIfDisposed(),ka(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.greater=function(t){return this.throwIfDisposed(),vs(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.ifft=function(){return this.throwIfDisposed(),_y(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.irfft=function(){return this.throwIfDisposed(),W6(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.isFinite=function(){return this.throwIfDisposed(),iU(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.isInf=function(){return this.throwIfDisposed(),lU(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.isNaN=function(){return this.throwIfDisposed(),cU(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.leakyRelu=function(t){return this.throwIfDisposed(),L1(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.lessEqual=function(t){return this.throwIfDisposed(),Jl(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.less=function(t){return this.throwIfDisposed(),xp(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.localResponseNormalization=function(t,e,n,s){return this.throwIfDisposed(),mU(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.logSigmoid=function(){return this.throwIfDisposed(),$U(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.logSoftmax=function(t){return this.throwIfDisposed(),dR(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.logSumExp=function(t,e){return this.throwIfDisposed(),fR(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.log=function(){return this.throwIfDisposed(),Mr(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.log1p=function(){return this.throwIfDisposed(),cR(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.logicalAnd=function(t){return this.throwIfDisposed(),uo(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.logicalNot=function(){return this.throwIfDisposed(),M1(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.logicalOr=function(t){return this.throwIfDisposed(),hR(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.logicalXor=function(t){return this.throwIfDisposed(),RU(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.matMul=function(t,e,n){return this.throwIfDisposed(),Ue(this,t,e,n)};q().prototype.maxPool=function(t,e,n,s){return this.throwIfDisposed(),_1(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.max=function(t,e){return this.throwIfDisposed(),ar(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.maximum=function(t){return this.throwIfDisposed(),pi(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.mean=function(t,e){return this.throwIfDisposed(),Ot(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.min=function(t,e){return this.throwIfDisposed(),gp(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.minimum=function(t){return this.throwIfDisposed(),Oc(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.mirrorPad=function(t,e){return this.throwIfDisposed(),_U(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.mod=function(t){return this.throwIfDisposed(),VU(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.mul=function(t){return this.throwIfDisposed(),z(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.neg=function(){return this.throwIfDisposed(),Tt(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.norm=function(t,e,n){return this.throwIfDisposed(),Dg(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.notEqual=function(t){return this.throwIfDisposed(),yp(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.oneHot=function(t,e=1,n=0){return this.throwIfDisposed(),pR(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.onesLike=function(){return this.throwIfDisposed(),Us(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.pad=function(t,e){return this.throwIfDisposed(),V1(this,t,e)};q().prototype.pool=function(t,e,n,s,r,o){return this.throwIfDisposed(),YU(this,t,e,n,s,r,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.pow=function(t){return this.throwIfDisposed(),ia(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.prelu=function(t){return this.throwIfDisposed(),W1(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.prod=function(t,e){return this.throwIfDisposed(),JU(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.reciprocal=function(){return this.throwIfDisposed(),$6(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.relu=function(){return this.throwIfDisposed(),Ia(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.relu6=function(){return this.throwIfDisposed(),xR(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.reshapeAs=function(t){return this.throwIfDisposed(),B(this,t.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.reshape=function(t){return this.throwIfDisposed(),B(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.resizeBilinear=function(t,e,n){return this.throwIfDisposed(),RR(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.resizeNearestNeighbor=function(t,e,n){return this.throwIfDisposed(),AR(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.reverse=function(t){return this.throwIfDisposed(),aa(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.rfft=function(){return this.throwIfDisposed(),H6(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.round=function(){return this.throwIfDisposed(),yR(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.rsqrt=function(){return this.throwIfDisposed(),vR(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.selu=function(){return this.throwIfDisposed(),bR(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.separableConv2d=function(t,e,n,s,r,o){return this.throwIfDisposed(),wR(this,t,e,n,s,r,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.sigmoid=function(){return this.throwIfDisposed(),Zl(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.sign=function(){return this.throwIfDisposed(),A6(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.sin=function(){return this.throwIfDisposed(),$R(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.sinh=function(){return this.throwIfDisposed(),CR(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.slice=function(t,e){return this.throwIfDisposed(),st(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.softmax=function(t){return this.throwIfDisposed(),Z1(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.softplus=function(){return this.throwIfDisposed(),Qd(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),B1(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.split=function(t,e){return this.throwIfDisposed(),ps(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.sqrt=function(){return this.throwIfDisposed(),mn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.square=function(){return this.throwIfDisposed(),at(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.squaredDifference=function(t){return this.throwIfDisposed(),K6(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.squeeze=function(t){return this.throwIfDisposed(),Jd(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.stack=function(t,e){this.throwIfDisposed();const n=t instanceof zt?[this,t]:[this,...t];return co(n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.step=function(t){return this.throwIfDisposed(),ef(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.stridedSlice=function(t,e,n,s,r,o,i,a){return this.throwIfDisposed(),Z6(this,t,e,n,s,r,o,i,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.sub=function(t){return this.throwIfDisposed(),ye(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.sum=function(t,e){return this.throwIfDisposed(),ge(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.tan=function(){return this.throwIfDisposed(),eG(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.tanh=function(){return this.throwIfDisposed(),Eg(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.tile=function(t){return this.throwIfDisposed(),sr(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.toBool=function(){return this.throwIfDisposed(),ce(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.toFloat=function(){return this.throwIfDisposed(),ce(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.toInt=function(){return this.throwIfDisposed(),ce(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.topk=function(t,e){return this.throwIfDisposed(),sG(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.transpose=function(t){return this.throwIfDisposed(),Oe(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.unique=function(t){return this.throwIfDisposed(),iG(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),ER(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.unstack=function(t){return this.throwIfDisposed(),la(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.where=function(t,e){return this.throwIfDisposed(),En(t,this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.zerosLike=function(){return this.throwIfDisposed(),Le(this)};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class $r extends Error{constructor(e){super(e),Object.setPrototypeOf(this,$r.prototype)}}class Ms extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Ms.prototype)}}class _ extends Error{constructor(e){super(e),Object.setPrototypeOf(this,_.prototype)}}class Te extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Te.prototype)}}class Pw extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Pw.prototype)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class vA{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let n;return this.cache.has(e)&&(n=this.cache.get(e),this.cache.delete(e),this.cache.set(e,n)),n}put(e,n){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){const s=this.cache.keys().next().value;this.cache.delete(s)}this.cache.set(e,n)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${e}.`);if(this.maxEntries>e)for(let n=0;n<this.maxEntries-e;n++){const s=this.cache.keys().next().value;this.cache.delete(s)}this.maxEntries=e}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ua(t,e){if(Array.isArray(t)){let n=[];for(let s=0;s<e;s++)n=n.concat(t);return n}else{const n=new Array(e);return n.fill(t),n}}function Cr(t,e){if(!t)throw new Pw(e)}function Jk(t,e){let n=0;for(const s of t)s===e&&n++;return n}function _n(t){return t.length===1?t[0]:t}function Ke(t){return Array.isArray(t)?t:[t]}function qr(t){const n=t.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return n[0]!=="_"?n:"private"+n}function Ei(t){return t.length<=1||t.indexOf("_")===-1?t:t.replace(/[_]+(\w|$)/g,(e,n)=>n.toUpperCase())}let ws={};function Ow(t){if(t==null)return null;const e={};return e.className=t.getClassName(),e.config=t.getConfig(),e}function By(t){if(!(t==null||typeof t!="object"))if(Array.isArray(t))t.forEach(e=>By(e));else{const e=Object.keys(t);for(const n of e){const s=t[n];s!=null&&typeof s=="object"&&(!Array.isArray(s)&&s.type==="ndarray"&&typeof s.value=="number"?t[n]=s.value:By(s))}}}function rf(t,e={},n={},s="object",r=!1){if(typeof t=="string"){const o=t;let i;if(o in n)i=n[o];else if(o in ws)i=ws[o];else if(i=e[o],i==null)throw new _(`Unknown ${s}: ${t}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return i}else{const o=t;if(o.className==null||o.config==null)throw new _(`${s}: Improper config format: ${JSON.stringify(o)}.
'className' and 'config' must set.`);const i=o.className;let a,l;if(i in n?[a,l]=n[i]:i in ws?[a,l]=ws.className:i in e&&([a,l]=e[i]),a==null)throw new _(`Unknown ${s}: ${i}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(l!=null){const u={};for(const h of Object.keys(ws))u[h]=ws[h];for(const h of Object.keys(n))u[h]=n[h];const c=o.config;c.customObjects=u;const d=Object.assign({},ws);for(const h of Object.keys(n))ws[h]=n[h];By(o.config);const f=l(a,o.config,n,r);return ws=Object.assign({},d),f}else{const u=Object.assign({},ws);for(const d of Object.keys(n))ws[d]=n[d];const c=new a(o.config);return ws=Object.assign({},u),c}}}function N7(t,e){return t<e?-1:t>e?1:0}function Kf(t,e){return-1*N7(t,e)}function qo(t){if(t==null)return t;const e=[];for(const n of t)e.indexOf(n)===-1&&e.push(n);return e}function R7(t){if(t==null)throw new _(`Invalid value in obj: ${JSON.stringify(t)}`);for(const e in t)if(t.hasOwnProperty(e))return!1;return!0}function Ea(t,e,n){if(n!=null&&t.indexOf(n)<0)throw new _(`${n} is not a valid ${e}.  Valid values are ${t} or null/undefined.`)}function Lw(t,e,n=0,s=1/0){return Cr(n>=0),Cr(s>=n),Array.isArray(t)&&t.length>=n&&t.length<=s&&t.every(r=>typeof r===e)}function Qt(t,e){Array.isArray(t)?(N(t.length>0,()=>`${e} is unexpectedly an empty array.`),t.forEach((n,s)=>Qt(n,`element ${s+1} of ${e}`))):N(Number.isInteger(t)&&t>0,()=>`Expected ${e} to be a positive integer, but got ${bA(t)}.`)}function bA(t){return t===null?"null":Array.isArray(t)?"["+t.map(e=>bA(e)).join(",")+"]":typeof t=="string"?`"${t}"`:`${t}`}function A7(t,e,n){let s=n!=null?n():Ln(),r;return(...i)=>{const a=n!=null?n():Ln();return a-s<e||(s=a,r=t(...i)),r}}function wA(t){return t==="relu"?"relu":t==="linear"?"linear":t==="elu"?"elu":null}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let D7=0;function $A(){return D7++}const Xf={};function _g(t=""){return t in Xf||(Xf[t]=0),Xf[t]+=1,t+Xf[t].toString()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const F7=["channelsFirst","channelsLast"],P7=["nearest","bilinear"],O7=["valid","same","causal"],L7=["max","avg"],M7=["sum","mul","concat","ave"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const _a=new Map;function Rt(t){Ea(F7,"DataFormat",t)}function _7(t){Ea(P7,"InterpolationFormat",t)}function bs(t){Ea(O7,"PaddingMode",t)}function CA(t){Ea(L7,"PoolMode",t)}const oc=[],eS="/";function Gi(t,e){oc.push(t);try{const n=e();return oc.pop(),n}catch(n){throw oc.pop(),n}}function z7(){return oc.length===0?"":oc.join(eS)+eS}function kA(t){if(!IA(t))throw new Error("Not a valid tensor name: '"+t+"'");return z7()+t}function SA(t){if(!IA(t))throw new Error("Not a valid tensor name: '"+t+"'");_a.has(t)||_a.set(t,0);const e=_a.get(t);if(_a.set(t,_a.get(t)+1),e>0){const n=`${t}_${e}`;return _a.set(n,1),n}else return t}const V7=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function IA(t){return!!t.match(V7)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function B7(t){return t===parseInt(t.toString(),10)}function Yo(t,e,n){e==null&&(e=0),n==null&&(n=t.length);let s=1;for(let r=e;r<n;++r)s*=t[r];return s}function Ml(t){if(t.length===0)return Number.NaN;let e=Number.POSITIVE_INFINITY;for(let n=0;n<t.length;n++){const s=t[n];s<e&&(e=s)}return e}function ni(t){if(t.length===0)return Number.NaN;let e=Number.NEGATIVE_INFINITY;for(let n=0;n<t.length;n++){const s=t[n];s>e&&(e=s)}return e}function cr(t,e){if(e<t)throw new _(`end (${e}) < begin (${t}) is forbidden.`);const n=[];for(let s=t;s<e;++s)n.push(s);return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let q0;function Bt(){return q0==null&&(q0=PV().epsilon()),q0}function dr(){return"channelsLast"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Dr(t,e){return ce(t,e)}function of(t,e=-1){const n=t.shape.slice();return e<0&&(e=n.length+e+1),n.splice(e,0,1),B(t,n)}function W7(t,e){return H(()=>{if(t.shape.length!==2)throw new _(`repeat() expects a rank-2 tensor, but received a rank-${t.shape.length} tensor.`);const n=of(t,1);return Wy(n,[1,e,1])})}function U7(t){const e=[Yo(t.shape)];return B(t,e)}function G7(t){if(t.rank<=1)throw new _(`batchFlatten requires a minimum rank of 2. Got rank: ${t.rank}.`);const e=[t.shape[0],Yo(t.shape,1)];return B(t,e)}function Hi(t,e,n){return H(()=>{switch(t.rank){case 1:return Y1(t,e,n);case 2:return kR(t,[e,0],[n,t.shape[1]]);case 3:return Q1(t,[e,0,0],[n,t.shape[1],t.shape[2]]);case 4:return bp(t,[e,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3]]);case 5:return st(t,[e,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4]]);case 6:return st(t,[e,0,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4],t.shape[5]]);default:throw new _(`sliceAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}})}function Y0(t,e,n){return H(()=>{switch(t.rank){case 1:return Y1(t,e,n);case 2:return kR(t,[0,e],[t.shape[0],n]);case 3:return Q1(t,[0,0,e],[t.shape[0],t.shape[1],n]);case 4:return bp(t,[0,0,0,e],[t.shape[0],t.shape[1],t.shape[2],n]);default:throw new _(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function qf(t,e,n,s){return H(()=>{switch(t.rank){case 1:return Y1(t,e,n);case 2:switch(s){case 1:return Hi(t,e,n);case 2:return Y0(t,e,n);default:throw new _(`The axis is not within the rank of the tensor ${s}`)}case 3:switch(s){case 1:return Hi(t,e,n);case 2:return Q1(t,[0,e,0],[t.shape[0],n,t.shape[2]]);case 3:return Y0(t,e,n);default:throw new _(`The axis is not within the rank of the tensor ${s}`)}case 4:switch(s){case 1:return Hi(t,e,n);case 2:return bp(t,[0,e,0,0],[t.shape[0],n,t.shape[2],t.shape[3]]);case 3:return bp(t,[0,0,e,0],[t.shape[0],t.shape[1],n,t.shape[3]]);case 4:return Y0(t,e,n);default:throw new _(`The axis is not within the rank of the tensor ${s}`)}default:throw new _(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function Mw(t,e=-1){let n;return e<0&&(n=t[0].rank,n!==0?e=n:e=0),e===t[0].rank&&(e=-1),Bn(t,e)}function tS(t,e){switch(t.rank){case 1:return sW([t,e]);case 2:return oW([t,e],0);case 3:return aW([t,e],0);case 4:return uW([t,e],0);default:throw new _(`concatAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}}function Wy(t,e){if(Array.isArray(e)||(e=[e]),t.rank!==e.length)throw new _(`The length of input n (${e.length}) does not match the number of dimensions in input x (${t.rank})`);return sr(t,e)}function zg(t,e=0,n=1,s,r){return y6(t,e,n,s,r)}function Fr(t,e,n,s){if(t.rank<2||e.rank<2)throw new Te(`dot requires both inputs to be rank >= 2 but got x shape = ${t.shape} and y shape = ${e.shape}`);if(e.rank>=3){const r=t.shape.slice(-1)[0],o=e.shape.slice(-2)[0];if(r!==o)throw new Te(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${t.shape} and  y shape = ${e.shape}`)}if(t.rank===2&&e.rank===2)return Bk({a:t,b:e,transposeA:!1,transposeB:!1,bias:s?Uy(t.rank,s,dr()):null,activation:n});{const r=t.shape.slice(),o=r.pop();t=B(t,[-1,o]);const i=e.shape.slice(),a=i.pop(),l=i.pop(),u=[...i,a],c=Array.from({length:e.rank},(p,g)=>g===0?e.rank-2:g<=e.rank-2?g-1:g);e=B(Oe(e,c),[l,-1]);const d=[...r,...u];return B(Bk({a:t,b:e,transposeA:!1,transposeB:!1,bias:s?Uy(t.rank,s,dr()):null,activation:n}),d)}}function TA(t,e,n){return H(()=>(Array.isArray(e)?e=Zn(e,"int32"):e=ce(e,"int32"),P1(t,e,n)))}function af(t){return z(t,t)}function Uy(t,e,n){const s=e.shape;if(e.rank!==1&&e.rank!==t)throw new _(`Unexpected bias dimensions: ${e.rank}; expected it to be 1 or ${t}`);if(t===5){if(n==="channelsFirst")return s.length===1?B(e,[1,s[0],1,1,1]):B(e,[1,s[3],s[0],s[1],s[2]]);if(n==="channelsLast")return s.length===1?B(e,[1,1,1,1,s[0]]):B(e,[1].concat(s))}else if(t===4){if(n==="channelsFirst")return s.length===1?B(e,[1,s[0],1,1]):B(e,[1,s[2],s[0],s[1]]);if(n==="channelsLast")return s.length===1?B(e,[1,1,1,s[0]]):B(e,[1].concat(s))}else if(t===3){if(n==="channelsFirst")return s.length===1?B(e,[1,s[0],1]):B(e,[1,s[1],s[0]]);if(n==="channelsLast")return s.length===1?B(e,[1,1,s[0]]):B(e,[1].concat(s))}else if(t<3)return e;throw new _(`Unsupported input rank by biasAdd: ${e.rank}`)}function pr(t,e,n){return H(()=>(n==null&&(n=dr()),Rt(n),ne(t,Uy(t.rank,e,n))))}function H7(t,e=1){if(e!==1)throw new Te(`Support for alpha values other than 1 (${e}) is not implemented yet.`);return Ag(t)}function j7(t){return H(()=>xe(t,ne(Cn(t),1)))}function EA(t,e,n,s){return H(()=>hG(t,e,n,s))}function K7(t){return H(()=>{const e=ne(.5,z(.2,t));return gs(e,0,1)})}function lf(t,e,n=!1){return n?t():e()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const X7=["fanIn","fanOut","fanAvg"],q7=["normal","uniform","truncatedNormal"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Y7(t){Ea(X7,"FanMode",t)}function Q7(t){Ea(q7,"Distribution",t)}class Hs extends tu{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class NA extends Hs{apply(e,n){return xt(e,n)}}NA.className="Zeros";J(NA);class _w extends Hs{apply(e,n){return vo(e,n)}}_w.className="Ones";J(_w);class RA extends Hs{constructor(e){if(super(),typeof e!="object")throw new _(`Expected argument of type ConstantConfig but got ${e}`);if(e.value===void 0)throw new _(`config must have value set but got ${e}`);this.value=e.value}apply(e,n){return H(()=>z(Ge(this.value),vo(e,n)))}getConfig(){return{value:this.value}}}RA.className="Constant";J(RA);class AA extends Hs{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,n){return Zd(e,this.minval,this.maxval,n,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}AA.className="RandomUniform";J(AA);class DA extends Hs{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Te(`randomNormal does not support dType ${n}.`);return zg(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}DA.className="RandomNormal";J(DA);class FA extends Hs{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Te(`truncatedNormal does not support dType ${n}.`);return TR(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}FA.className="TruncatedNormal";J(FA);class PA extends Hs{constructor(e){super(),this.gain=e.gain!=null?e.gain:1}apply(e,n){return H(()=>{if(e.length!==2||e[0]!==e[1])throw new _("Identity matrix initializer can only be used for 2D square matrices.");return z(this.gain,uR(e[0]))})}getConfig(){return{gain:this.gain}}}PA.className="Identity";J(PA);function Z7(t,e="channelsLast"){let n,s;if(Rt(e),t.length===2)n=t[0],s=t[1];else if([3,4,5].indexOf(t.length)!==-1){if(e==="channelsFirst"){const r=Yo(t,2);n=t[1]*r,s=t[0]*r}else if(e==="channelsLast"){const r=Yo(t,0,t.length-2);n=t[t.length-2]*r,s=t[t.length-1]*r}}else{const r=Yo(t);n=Math.sqrt(r),s=Math.sqrt(r)}return[n,s]}class rs extends Hs{constructor(e){if(super(),e.scale<0)throw new _(`scale must be a positive float. Got: ${e.scale}`);this.scale=e.scale==null?1:e.scale,this.mode=e.mode==null?"fanIn":e.mode,Y7(this.mode),this.distribution=e.distribution==null?"normal":e.distribution,Q7(this.distribution),this.seed=e.seed}apply(e,n){const s=Z7(e),r=s[0],o=s[1];let i=this.scale;if(this.mode==="fanIn"?i/=Math.max(1,r):this.mode==="fanOut"?i/=Math.max(1,o):i/=Math.max(1,(r+o)/2),this.distribution==="normal"){const a=Math.sqrt(i);if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Te(`${this.getClassName()} does not support dType ${n}.`);return TR(e,0,a,n,this.seed)}else{const a=Math.sqrt(3*i);return Zd(e,-a,a,n,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}rs.className="VarianceScaling";J(rs);class zw extends rs{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return rs.className}}zw.className="GlorotUniform";J(zw);class Vw extends rs{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return rs.className}}Vw.className="GlorotNormal";J(Vw);class Bw extends rs{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return rs.className}}Bw.className="HeNormal";J(Bw);class Ww extends rs{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return rs.className}}Ww.className="HeUniform";J(Ww);class Uw extends rs{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return rs.className}}Uw.className="LeCunNormal";J(Uw);class Gw extends rs{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return rs.className}}Gw.className="LeCunUniform";J(Gw);class OA extends Hs{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=e.gain==null?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,n){return H(()=>{if(e.length<2)throw new Te("Shape must be at least 2D.");if(n!=="int32"&&n!=="float32"&&n!==void 0)throw new TypeError(`Unsupported data type ${n}.`);n=n;const s=Y(e.slice(0,-1)),r=e[e.length-1],o=s*r;o>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${o}) elements: Slowness may result.`);const i=[Math.max(r,s),Math.min(r,s)],a=zg(i,0,1,n,this.seed),l=u5.qr(a,!1);let u=l[0];const d=l[1].flatten().stridedSlice([0],[Math.min(r,s)*Math.min(r,s)],[Math.min(r,s)+1]);return u=z(u,d.sign()),s<r&&(u=u.transpose()),z(Ge(this.gain),u.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}}OA.className="Orthogonal";J(OA);const nS={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function sS(t,e={}){return rf(t,Ds.getMap().classNameMap,e,"initializer")}function yt(t){return Ow(t)}function pt(t){if(typeof t=="string"){const e=t in nS?nS[t]:t;if(e==="GlorotNormal")return new Vw;if(e==="GlorotUniform")return new zw;if(e==="HeNormal")return new Bw;if(e==="HeUniform")return new Ww;if(e==="LeCunNormal")return new Uw;if(e==="LeCunUniform")return new Gw;{const n={};return n.className=e,n.config={},sS(n)}}else return t instanceof Hs?t:sS(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Gy(t){return Array.isArray(t)&&Array.isArray(t[0])}function wp(t){return t.length===0?[]:Array.isArray(t[0])?t:[t]}function ve(t){let e;if(Array.isArray(t)){if(t.length!==1)throw new _(`Expected Tensor length to be 1; got ${t.length}`);e=t[0]}else e=t;return e}function _e(t){if(Array.isArray(t)&&Array.isArray(t[0])){if(t.length===1)return t=t,t[0];throw new _(`Expected exactly 1 Shape; got ${t.length}`)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function $p(t){let e=0;for(const n of t)n.shape.length===0?e+=1:e+=n.shape.reduce((s,r)=>s*r);return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const rS="Variable";class J7{constructor(e,n="float32",s=rS,r=!0,o=null){this.dtype=n??"float32",this.shape=e.shape,this.id=$A(),s=s??rS,this.originalName=kA(s),this.name=SA(this.originalName),this.trainable_=r,this.constraint=o,this.val=uG(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),e8(this.val,e),this.val.id!==e.id&&(this.val.assign(e),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}}function e8(t,e){if(t.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(t.shape)+" vs. "+JSON.stringify(e.shape))}function Hy(t){return t.map(e=>e.read())}function Hw(t){t.forEach(e=>{e[0].write(e[1])})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Wt{constructor(e){this.dtype=e.dtype,this.shape=e.shape,e.shape!=null?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}class _r{constructor(e,n,s,r,o,i,a){this.dtype=e,this.shape=n,this.sourceLayer=s,this.inputs=r,this.callArgs=o,this.outputTensorIndex=a,this.id=$A(),i!=null&&(this.originalName=kA(i),this.name=SA(this.originalName)),this.rank=n.length}}let t8=0;class Vg{constructor(e,n){this.callArgs=n,this.id=t8++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(const s of e.inboundLayers)s!=null&&s.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){const e=[];for(const n of this.inboundLayers)n!=null?e.push(n.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let n8=0;class Re extends tu{constructor(e={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=n8++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let n=e.name;if(!n){const s=this.getClassName();n=qr(s)+"_"+_g(s)}if(this.name=n,this.trainable_=e.trainable==null?!0:e.trainable,e.inputShape!=null||e.batchInputShape!=null){let s;if(e.batchInputShape!=null)s=e.batchInputShape;else if(e.inputShape!=null){let o=null;e.batchSize!=null&&(o=e.batchSize),s=[o].concat(e.inputShape)}this.batchInputShape=s;let r=e.dtype;r==null&&(r=e.inputDType),r==null&&(r="float32"),this.dtype=r}e.weights!=null?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,n){return e.name+"_ib-"+n.toString()}getNodeAtIndex(e,n){if(this.inboundNodes.length===0)throw new Ms(`The layer has never been called and thus has no defined ${n}.`);if(this.inboundNodes.length<=e)throw new _(`Asked to get ${n} at node ${e}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[e]}getInputAt(e){return _n(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return _n(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new $r(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new $r(`Layer ${this.name} is not connected, no input to return.`);return _n(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new $r(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new $r(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return _n(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(n=>n.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){const n=Ke(e);if(this.inputSpec==null||this.inputSpec.length===0)return;const s=Ke(this.inputSpec);if(n.length!==s.length)throw new _(`Layer ${this.name} expects ${s.length} inputs, but it received ${n.length} input tensors. Input received: ${e}`);for(let r=0;r<n.length;r++){const o=n[r],i=s[r];if(i==null)continue;const a=o.rank;if(i.ndim!=null&&a!==i.ndim)throw new _(`Input ${r} is incompatible with layer ${this.name}: expected ndim=${i.ndim}, found ndim=${a}`);if(i.maxNDim!=null&&a>i.maxNDim)throw new _(`Input ${r} is incompatible with layer ${this.name}: expected max_ndim=${i.maxNDim}, found ndim=${a}`);if(i.minNDim!=null&&a<i.minNDim)throw new _(`Input ${r} is incompatible with layer ${this.name}: expected min_ndim=${i.minNDim}, found ndim=${a}.`);if(i.dtype!=null&&o.dtype!==i.dtype)throw new _(`Input ${r} is incompatible with layer ${this.name} : expected dtype=${i.dtype}, found dtype=${o.dtype}.`);if(i.axes){const l=o.shape;for(const u in i.axes){const c=Number(u),d=i.axes[u],f=c>=0?l[c]:l[l.length+c];if(d!=null&&[d,null].indexOf(f)===-1)throw new _(`Input ${r} is incompatible with layer ${this.name}: expected axis ${c} of input shape to have value ${d} but got shape ${l}.`)}}if(i.shape!=null)for(let l=0;l<i.shape.length;++l){const u=i.shape[l],c=o.shape[l];if(u!=null&&c!=null&&u!==c)throw new _(`Input ${r} is incompatible with layer ${this.name}: expected shape=${i.shape}, found shape=${o.shape}.`)}}}call(e,n){return e}invokeCallHook(e,n){this._callHook!=null&&this._callHook(e,n)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,n){n=n||{},this.assertNotDisposed();const s=Ke(e),r=o8(e),o=i8(e);if(r===o)throw new _("Arguments to apply() must be all SymbolicTensors or all Tensors");return Gi(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);const i=[];for(const a of Ke(e))i.push(a.shape);this.build(_n(i)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&o&&(this._refCount=1)}if(this.assertInputCompatibility(e),o){let i=this.call(e,n);this.supportsMasking&&this.setMaskMetadata(e,i);const a=Ke(i),l=[];for(let u of a)s.indexOf(u)!==-1&&(u=u.clone()),l.push(u);if(i=_n(l),this.activityRegularizer!=null)throw new Te("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return i}else{const i=s8(e),a=this.computeOutputShape(i);let l;const u=r8(e);if(this.warnOnIncompatibleInputShape(Array.isArray(e)?i[0]:i),a!=null&&a.length>0&&Array.isArray(a[0])?l=a.map((c,d)=>new _r(u,c,this,Ke(e),n,this.name,d)):l=new _r(u,a,this,Ke(e),n,this.name),this.addInboundNode(e,l,null,null,i,a,n),this._refCount++,this.activityRegularizer!=null)throw new Te("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return l}})}warnOnIncompatibleInputShape(e){if(this.batchInputShape!=null)if(e.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(e)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let n=!1;this.batchInputShape.forEach((s,r)=>{s!=null&&e[r]!=null&&e[r]!==s&&(n=!0)}),n&&console.warn(`The shape of the input tensor (${JSON.stringify(e)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new $r(`The layer ${this.name} has never been called and thus has no defined output shape.`);const e=[];for(const n of this.inboundNodes){const s=JSON.stringify(n.outputShapes);e.indexOf(s)===-1&&e.push(s)}if(e.length===1){const n=this.inboundNodes[0].outputShapes;return Array.isArray(n)&&Array.isArray(n[0])&&n.length===1?n[0]:n}else throw new $r(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new Ms(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return $p(this.weights)}build(e){this.built=!0}getWeights(e=!1){return Hy(e?this.trainableWeights:this.weights)}setWeights(e){H(()=>{const n=this.weights;if(n.length!==e.length)throw new _(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${e.length}, but the layer was expecting ${n.length} weights. Provided weights: ${e}...`);if(n.length===0)return;const s=[],r=Hy(n);for(let o=0;o<r.length;++o){const i=r[o],a=n[o],l=e[o];if(!He(i.shape,l.shape))throw new _(`Layer weight shape ${i.shape} not compatible with provided weight shape ${l.shape}`);s.push([a,l])}Hw(s)})}addWeight(e,n,s,r,o,i,a,l){if(this._addedWeightNames.indexOf(e)!==-1)throw new _(`Duplicate weight name ${e} for layer ${this.name}`);this._addedWeightNames.push(e),s==null&&(s="float32"),this.fastWeightInitDuringBuild&&(r=l!=null?l():pt("zeros"));const u=r.apply(n,s),c=new J7(u,s,e,i,a);return u.dispose(),o!=null&&this.addLoss(()=>o.apply(c.read())),i==null&&(i=!0),i?this._trainableWeights.push(c):this._nonTrainableWeights.push(c),c}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){e==null||Array.isArray(e)&&e.length===0||(e=Ke(e),this._losses!==void 0&&this._losses!==null&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,n){if(!this.supportsMasking){if(n!=null)if(Array.isArray(n))n.forEach(s=>{if(s!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return n}setMaskMetadata(e,n,s){if(!this.supportsMasking)return;const r=this.computeMask(e,s),o=Ke(n),i=Ke(r);if(o.length!==i.length)throw new Error(`${this.name} outputs ${o.length} tensors but ${o.length} masks for those tensors`);for(let a=0;a<o.length;a++)o[a].kerasMask=i[a]}addInboundNode(e,n,s,r,o,i,a=null){const l=Ke(e);n=Ke(n),s=Ke(s),r=Ke(r),o=wp(o),i=wp(i);const u=[],c=[],d=[];for(const f of l)u.push(f.sourceLayer),c.push(f.nodeIndex),d.push(f.tensorIndex);new Vg({outboundLayer:this,inboundLayers:u,nodeIndices:c,tensorIndices:d,inputTensors:l,outputTensors:n,inputMasks:s,outputMasks:r,inputShapes:o,outputShapes:i},a);for(let f=0;f<n.length;f++)n[f].sourceLayer=this,n[f].nodeIndex=this.inboundNodes.length-1,n[f].tensorIndex=f}getConfig(){const e={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(e.batchInputShape=this.batchInputShape),this.dtype!=null&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let e=0;return--this._refCount===0&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}function s8(t){t=Ke(t);const e=[];for(const n of t)e.push(n.shape);return _n(e)}function r8(t){return"float32"}function LA(t,e,n){if((e==null||n!=null&&n>0)&&(e=t.sourceLayer,n=t.nodeIndex),e.inboundNodes.length===0)return[t];{const s=e.inboundNodes[n];if(s.inboundLayers.length===0)return s.inputTensors;{const r=[];for(let o=0;o<s.inboundLayers.length;o++){const i=s.inputTensors[o],a=s.inboundLayers[o],l=s.nodeIndices[o],u=LA(i,a,l);for(const c of u)r.indexOf(c)===-1&&r.push(c)}return r}}}function o8(t){let e=!0;for(const n of Ke(t))if(!(n instanceof _r)){e=!1;break}return e}function i8(t){let e=!0;for(const n of Ke(t))if(n instanceof _r){e=!1;break}return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class uf extends Re{constructor(e){if(super({dtype:e.dtype,name:e.name!=null?e.name:_g("input").toString()}),e.batchSize==null&&(e.batchSize=null),e.sparse==null&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new _("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let n=e.batchInputShape;if(n==null){if(e.inputShape==null)throw new _("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");n=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new _("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const s=e.dtype||"float32";this.batchInputShape=n,this.dtype=s,this.inputSpec=[{shape:n}];const r=new _r(this.dtype,this.batchInputShape,this,[],{},this.name);r.nodeIndex=0,r.tensorIndex=0,new Vg({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[r],outputTensors:[r],inputMasks:[null],outputMasks:[null],inputShapes:[n],outputShapes:[n]})}apply(e,n){throw new _(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}uf.className="InputLayer";J(uf);function a8(t){if(t.batchShape==null&&t.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(t.batchShape!=null&&t.shape!=null)throw new _("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=t.batchShape;t.shape!=null&&e==null&&(e=[null].concat(t.shape));let n=t.dtype;return n==null&&(n="float32"),new uf({batchInputShape:e,name:t.name,dtype:n,sparse:t.sparse}).inboundNodes[0].outputTensors[0]}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function l8(t,e){if(t.dtype==null||t.dtype===e.dtype)return e;try{return ce(e,t.dtype)}catch{throw new _(`The dtype of the feed (${e.dtype}) can not be cast to the dtype of the key '${t.name}' (${t.dtype}).`)}}class Lo{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof Lo)for(const n in e.id2Value)this.id2Value[n]=e.id2Value[n],n in e.id2Mask&&(this.id2Mask[n]=e.id2Mask[n]);else{if(e==null)return;for(const n of e)this.add(n.key,n.value)}}add(e,n,s){if(this.id2Value[e.id]==null)this.id2Value[e.id]=l8(e,n),this.name2Id[e.name]=e.id,s!=null&&(this.id2Mask[e.id]=s);else throw new _(`Duplicate key: name=${e.name}, id=${e.id}`);return this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return this.id2Value[e.id]!=null}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof _r){if(this.id2Value[e.id]==null)throw new _(`Nonexistent key: ${e.name}`);return this.id2Value[e.id]}else{const n=this.name2Id[e];if(n==null)throw new _(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Value[n]}}getMask(e){if(e instanceof _r){if(this.id2Value[e.id]==null)throw new _(`Nonexistent key: ${e.name}`);return this.id2Mask[e.id]}else{const n=this.name2Id[e];if(n==null)throw new _(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Mask[n]}}disposeMasks(){this.id2Mask!=null&&Ae(this.id2Mask)}}const Cp=new vA,kp=new vA;function u8(t){Cp!=null&&Cp.setMaxEntries(t),kp!=null&&kp.setMaxEntries(t)}function Bu(t,e,n,s){const r=n==null?!1:n.training,o=Array.isArray(t),i=o?t:[t],a=i.map(p=>p.name),l=[],u=e.names();for(const p of a)u.indexOf(p)!==-1?l.push(e.getValue(p)):l.push(null);const c=a.join(",")+"|"+e.names().sort().join(",");let d=Cp.get(c),f;if(d==null){const p=c8(i,e);d=p.sorted,f=p.recipientCounts,Cp.put(c,d),kp.put(c,f)}f={},r||Object.assign(f,kp.get(c));const h=new Lo(e);for(let p=0;p<d.length;++p){const g=d[p],y=g.sourceLayer;if(y instanceof uf)continue;const m=[],x=[],v=[];let b=!1;for(const I of g.inputs){const R=h.getValue(I),E=h.getMask(I);m.push(R),x.push(E),E!=null&&(b=!0),r||(f[I.name]--,f[I.name]===0&&!e.hasKey(I)&&a.indexOf(I.name)===-1&&!R.isDisposed&&I.sourceLayer.stateful!==!0&&v.push(R))}b&&(n=n||{},n.mask=x[0]);const $=Ke(y.apply(m,n));let C=null;y.supportsMasking&&(C=y.computeMask(m,x));const k=f8(g),w=Array.isArray(k)?k:[k];for(let I=0;I<w.length;++I){h.hasKey(w[I])||h.add(w[I],$[I],Array.isArray(C)?C[0]:C);const R=a.indexOf(w[I].name);R!==-1&&(l[R]=$[I])}r||Ae(v)}return h.disposeMasks(),o?l:l[0]}function c8(t,e){N(t!=null&&t.length>0,()=>"Expected at least one fetch, got none");let n=[],s={};if(t.length===1){const r=oS(t[0],e);n=r.sorted,s=r.recipientMap}else{const r=new Set;for(const o of t){const{sorted:i,recipientMap:a}=oS(o,e);for(const l of i)r.has(l.name)||(n.push(l),r.add(l.name));for(const l in a)s[l]==null&&(s[l]=new Set),a[l].forEach(u=>s[l].add(u))}}return{sorted:n,recipientCounts:d8(s)}}function d8(t){const e={};for(const n in t)e[n]=t[n].size;return e}function oS(t,e){const n=new Set,s=[],r={};for(const a of e.names())n.add(a);const o=[],i=[];for(o.push(t);o.length>0;){const a=o[o.length-1];if(n.has(a.name)){o.pop();continue}const l=i[i.length-1]===o.length-1;if(a.inputs.length===0||l)o.pop(),s.push(a),n.add(a.name),l&&i.pop();else{i.push(o.length-1);for(const u of a.inputs)r[u.name]==null&&(r[u.name]=new Set),r[u.name].add(a.name),!n.has(u.name)&&o.push(u)}}return{sorted:s,recipientMap:r}}function f8(t){let e;if(t.sourceLayer.inboundNodes.length===1)e=t.sourceLayer.output;else{let n=null;for(let s=0;s<t.sourceLayer.inboundNodes.length;++s)for(const r of t.sourceLayer.inboundNodes[s].outputTensors)if(r.id===t.id){n=s;break}e=t.sourceLayer.getOutputAt(n)}return e}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h8=K();h8.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,u8);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function jw(t,e){return H(()=>mn(ge(z(t,t),e,!0)))}class cf extends tu{getConfig(){return{}}}class MA extends cf{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return H(()=>{const n=jw(e,this.axis),s=gs(n,0,this.maxValue);return z(e,xe(s,ne(Bt(),n)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}MA.className="MaxNorm";J(MA);class _A extends cf{constructor(e){super(),this.defaultAxis=0,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return H(()=>xe(e,ne(Bt(),jw(e,this.axis))))}getConfig(){return{axis:this.axis}}}_A.className="UnitNorm";J(_A);class zA extends cf{apply(e){return Ia(e)}}zA.className="NonNeg";J(zA);class VA extends cf{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=e.minValue!=null?e.minValue:this.defaultMinValue,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.rate=e.rate!=null?e.rate:this.defaultRate,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return H(()=>{const n=jw(e,this.axis),s=ne(z(this.rate,gs(n,this.minValue,this.maxValue)),z(1-this.rate,n));return z(e,xe(s,ne(Bt(),n)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}VA.className="MinMaxNorm";J(VA);const iS={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function Ut(t){return Ow(t)}function aS(t,e={}){return rf(t,Ds.getMap().classNameMap,e,"constraint")}function Gt(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in iS?iS[t]:t,config:{}};return aS(n)}else return t instanceof cf?t:aS(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function bi(t){if(t==null)return;const e=[],n=[],s=[];for(const r in t){const o=t[r];if(typeof o!="number"){const i=o;e.push(i.data()),n.push(r),s.push(i)}}if(e.length>0){const r=await Promise.all(e);for(let o=0;o<r.length;++o)t[n[o]]=r[o][0];Ae(s)}}function BA(t){if(t!=null)for(const e in t){const n=t[e];typeof n!="number"&&n.dispose()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var lS;(function(t){t[t.SILENT=0]="SILENT",t[t.VERBOSE=1]="VERBOSE"})(lS||(lS={}));const p8=125;class Mc{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,n){}async onEpochEnd(e,n){}async onBatchBegin(e,n){}async onBatchEnd(e,n){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}}class m8{constructor(e,n=10){e==null&&(e=[]),this.callbacks=e,this.queueLength=n}append(e){this.callbacks.push(e)}setParams(e){for(const n of this.callbacks)n.setParams(e)}setModel(e){for(const n of this.callbacks)n.setModel(e)}async onEpochBegin(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onEpochBegin(e,n)}async onEpochEnd(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onEpochEnd(e,n)}async onBatchBegin(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onBatchBegin(e,n)}async onBatchEnd(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onBatchEnd(e,n)}async onTrainBegin(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainBegin(e)}async onTrainEnd(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainEnd(e)}}class g8 extends Mc{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,n){n==null&&(n={});const s=n.size==null?0:n.size;this.seen+=s;for(const r in n){const o=n[r];if(typeof o=="number")this.totals.hasOwnProperty(r)||(this.totals[r]=0),this.totals[r]=this.totals[r]+o*s;else{let i;r in this.totals?i=this.totals[r]:this.totals[r]=0;const a=H(()=>ne(this.totals[r],z(o,s)));this.totals[r]=a,i!=null&&i.dispose()}}}async onEpochEnd(e,n){if(n!=null)for(const s of this.params.metrics)this.totals[s]!=null&&(typeof this.totals[s]=="number"?n[s]=this.totals[s]/this.seen:H(()=>{const r=z(xe(1,this.seen),this.totals[s]);n[s]=r,this.totals[s].dispose(),Rr(n[s])}))}}class x8 extends Mc{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,n){n==null&&(n={}),this.epoch.push(e);for(const s in n)this.history[s]==null&&(this.history[s]=[]),this.history[s].push(n[s])}async syncData(){const e=[],n=[],s=[];for(const o in this.history){const i=this.history[o];for(let a=0;a<i.length;++a)if(typeof i[a]!="number"){const l=i[a];e.push(l.data()),n.push(o),s.push(a)}}const r=await Promise.all(e);for(let o=0;o<r.length;++o)this.history[n[o]][s[o]].dispose(),this.history[n[o]][s[o]]=r[o][0]}}class y8 extends Mc{constructor(e,n){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||jR,this.yieldEvery=n||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=p8),this.yieldEvery==="never"&&e.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");by(this.yieldEvery)&&(this.maybeWait=A7(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,n,s){const r=[];this.yield!=null&&(await bi(s),r.push(this.yield(e,n,s))),r.push(this.nextFrameFunc()),await Promise.all(r)}async onEpochBegin(e,n){this.currentEpoch=e,this.epochBegin!=null&&(await bi(n),await this.epochBegin(e,n))}async onEpochEnd(e,n){const s=[];this.epochEnd!=null&&(await bi(n),s.push(this.epochEnd(e,n))),this.yieldEvery==="epoch"&&s.push(this.nextFrameFunc()),await Promise.all(s)}async onBatchBegin(e,n){this.batchBegin!=null&&(await bi(n),await this.batchBegin(e,n))}async onBatchEnd(e,n){const s=[];this.batchEnd!=null&&(await bi(n),s.push(this.batchEnd(e,n))),this.yieldEvery==="batch"?s.push(this.nextFrameFunc()):by(this.yieldEvery)&&s.push(this.maybeWait(this.currentEpoch,e,n)),await Promise.all(s)}async onTrainBegin(e){this.trainBegin!=null&&(await bi(e),await this.trainBegin(e))}async onTrainEnd(e){this.trainEnd!=null&&(await bi(e),await this.trainEnd(e))}}function WA(t,e){return t==null&&(t={}),t instanceof Mc?[t]:Array.isArray(t)&&t[0]instanceof Mc?t:Ke(t).map(s=>new y8(s,e))}class ks{constructor(){}static registerCallbackConstructor(e,n){N(e>=0&&Number.isInteger(e),()=>`Verbosity level is expected to be an integer >= 0, but got ${e}`),ks.checkForDuplicate(n),ks.constructors[e]==null&&(ks.constructors[e]=[]),ks.constructors[e].push(n)}static checkForDuplicate(e){for(const n in ks.constructors)ks.constructors[+n].forEach(r=>{if(r===e)throw new _("Duplicate callback constructor.")})}static clear(){ks.constructors={}}static createCallbacks(e){const n=[];for(const s in ks.constructors){const r=+s;e>=r&&n.push(...ks.constructors[r])}return n.map(s=>new s)}}ks.constructors={};function UA(t,e,n,s,r,o,i,a,l){const u=new x8,c=[new g8,...ks.createCallbacks(e)];t!=null&&c.push(...t),c.push(u);const d=new m8(c);return d.setParams({epochs:n,initialEpoch:s,samples:r,steps:o,batchSize:i,verbose:e,doValidation:a,metrics:l}),{callbackList:d,history:u}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function so(t,e={},n=!1){return rf(t,Ds.getMap().classNameMap,e,"layer",n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Sp(t,e){return H(()=>{t.dtype!=="float32"&&(t=ce(t,"float32"));const n=ge(af(t),e,!0),s=Rg(n.shape,Bt()),r=mn(pi(n,s));return xe(t,r)})}function Bg(t,e){return H(()=>Ot(af(ye(e,t)),-1))}function Kw(t,e){return H(()=>Ot(Cn(ye(e,t)),-1))}function Xw(t,e){return H(()=>{const n=ye(t,e),s=gs(Cn(t),Bt(),Number.MAX_VALUE),r=Cn(xe(n,s));return z(100,Ot(r,-1))})}function v8(t,e){return H(()=>{const n=gs(e,Bt(),Number.MAX_VALUE),s=Mr(ne(1,n)),r=gs(t,Bt(),Number.MAX_VALUE),o=Mr(ne(1,r));return Ot(af(ye(s,o)),-1)})}function b8(t,e){return H(()=>{const n=pi(0,ye(1,z(t,e)));return Ot(af(n),-1)})}function w8(t,e){return H(()=>{const n=pi(0,ye(1,z(t,e)));return Ot(n,-1)})}function $8(t,e){return H(()=>{const n=ge(z(t,e),-1),s=ar(z(ye(1,t),e),-1);return pi(0,ne(1,ye(s,n)))})}function C8(t,e){return H(()=>{const n=Math.log(2),s=ye(e,t),r=ye(ne(s,Qd(z(-2,s))),n);return Ot(r,-1)})}function _c(t,e,n=!1){return H(()=>{if(n)e=Z1(e);else{const s=ge(e,e.shape.length-1,!0);e=xe(e,s)}return e=gs(e,Bt(),1-Bt()),Tt(ge(z(ce(t,"float32"),Mr(e)),e.shape.length-1))})}function Ip(t,e,n=!1){return H(()=>{const s=ce(Fg(U7(t)),"int32");e=gs(e,Bt(),1-Bt());const r=e.shape,o=B(pR(s,r[r.length-1]),r);return _c(o,e,n)})}function k8(t,e){if(!He(t.shape,e.shape))throw new _(`logits and labels must have the same shape, but got shapes ${JSON.stringify(t.shape)} and ${JSON.stringify(e.shape)}`);return H(()=>{const n=Ia(e),s=Tt(Cn(e));return ne(ye(n,z(e,t)),cR(Lr(s)))})}function Wg(t,e){return H(()=>{let n;return n=gs(e,Bt(),1-Bt()),n=Mr(xe(n,ye(1,n))),Ot(k8(t,n),-1)})}function S8(t,e){return H(()=>{const n=gs(t,Bt(),1),s=gs(e,Bt(),1);return ge(z(t,Mr(xe(n,s))),-1)})}function I8(t,e){return H(()=>{const n=Mr(ne(Bt(),e));return Ot(ye(e,z(t,n)),-1)})}function GA(t,e){return H(()=>{const n=Sp(t,-1),s=Sp(e,-1),r=z(n,s);return Tt(ge(r,-1))})}const Tp={meanSquaredError:Bg,meanAbsoluteError:Kw,meanAbsolutePercentageError:Xw,meanSquaredLogarithmicError:v8,squaredHinge:b8,hinge:w8,categoricalHinge:$8,logcosh:C8,categoricalCrossentropy:_c,sparseCategoricalCrossentropy:Ip,binaryCrossentropy:Wg,kullbackLeiblerDivergence:S8,poisson:I8,cosineProximity:GA};function Q0(t){if(typeof t=="string"){if(t in Tp)return Tp[t];let e=`Unknown loss ${t}`;throw t.toLowerCase().includes("softmaxcrossentropy")&&(e=`Unknown loss ${t}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new _(e)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function HA(t,e){return H(()=>{const n=z(.5,Us(e)),s=Dr(vs(e,n),t.dtype);return Ot(Or(t,s),-1)})}function jA(t,e){return H(()=>Dr(Or(Dc(t,-1),Dc(e,-1)),"float32"))}function T8(t,e){return H(()=>ce(ge(uo(Or(t,1),Or(e,1))),"float32"))}function E8(t,e){return H(()=>ce(ge(uo(Or(t,0),Or(e,1))),"float32"))}function N8(t,e){return H(()=>{const n=T8(t,e),s=E8(t,e),r=ne(n,s);return ce(En(vs(r,0),xe(n,r),0),"float32")})}function R8(t,e){return Wg(t,e)}function A8(t,e){return t.rank===e.rank&&(t=Jd(t,[t.rank-1])),e=Dc(e,-1),e.dtype!==t.dtype&&(e=ce(e,t.dtype)),ce(Or(t,e),"float32")}const D8=Bg,F8=Bg,P8=Kw,O8=Kw,L8=Xw,M8=Xw,KA=_c,_8=GA,XA=Ip,Ep={binaryAccuracy:HA,categoricalAccuracy:jA,precision:N8,categoricalCrossentropy:KA,sparseCategoricalCrossentropy:XA,mse:D8,MSE:F8,mae:P8,MAE:O8,mape:L8,MAPE:M8,cosine:_8};function z8(t){if(typeof t=="string"&&t in Ep)return Ep[t];if(typeof t!="string"&&t!=null)return t;throw new _(`Unknown metric ${t}`)}function Yf(t){if(Cr(t!==null,`Unknown LossOrMetricFn ${t}`),typeof t=="string")return t;{let e;for(const n of Object.keys(Tp))if(Tp[n]===t){e=n;break}if(e!==void 0)return e;for(const n of Object.keys(Ep))if(Ep[n]===t){e=n;break}return e!==void 0?e:t.name}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function V8(t){const e={Adagrad:()=>Ma.adagrad(.01),Adadelta:()=>Ma.adadelta(1,.95,Bt()),Adam:()=>Ma.adam(.001,.9,.999,Bt()),Adamax:()=>Ma.adamax(.002,.9,.999,Bt(),0),RMSProp:()=>Ma.rmsprop(.001,.9,0,Bt()),SGD:()=>Ma.sgd(.01)};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,t in e)return e[t]();throw new _(`Unknown Optimizer ${t}`)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const uS=1*1024*1024;function cS(t,e,n=!1){if(t==null||typeof t!="object"||Object.getPrototypeOf(t)!==Object.prototype||!jy(t))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const s=JSON.stringify(t);s.length>uS&&console.warn(`User-defined metadata of model "${e}" is too large in size (length=${s.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${uS}.`)}}function jy(t){if(t===null)return!0;if(typeof t=="object")if(Object.getPrototypeOf(t)===Object.prototype){const e=Object.keys(t);for(const n of e)if(typeof n!="string"||!jy(t[n]))return!1;return!0}else if(Array.isArray(t)){for(const e of t)if(!jy(e))return!1;return!0}else return!1;else{const e=typeof t;return e==="string"||e==="number"||e==="boolean"}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function B8(t,e,n,s=console.log){const r=U8(t),o=["Layer (type)","Input Shape","Output shape","Param #"];r?(e=e||90,n=n||[.32,.61,.89,1]):(e=e||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map(c=>Math.floor(e*c)));let i;if(!r){o.push("Receives inputs"),i=[];for(const c in t.nodesByDepth)i.push(...t.nodesByDepth[c])}s("_".repeat(e)),Np(o,n,s),s("=".repeat(e));const a=t.layers;for(let c=0;c<a.length;++c)r?G8(a[c],n,s):H8(a[c],n,i,s),s((c===a.length-1?"=":"_").repeat(e));t.checkTrainableWeightsConsistency();const l=W8(t),u=$p(t.nonTrainableWeights);s(`Total params: ${l+u}`),s(`Trainable params: ${l}`),s(`Non-trainable params: ${u}`),s("_".repeat(e))}function W8(t){let e;return t.collectedTrainableWeights!=null?e=$p(t.collectedTrainableWeights):e=$p(t.trainableWeights),e}function U8(t){let e=!0;const n=[],s=[];for(const r in t.nodesByDepth)n.push(t.nodesByDepth[r]);for(const r of n){if(r.length>1||r.length===1&&r[0].inboundLayers.length>1){e=!1;break}s.push(...r)}if(e)for(const r of t.layers){let o=!1;for(const i of r.inboundNodes)if(s.indexOf(i)!==-1)if(o){e=!1;break}else o=!0;if(!e)break}return e}function Np(t,e,n=console.log){let s="";for(let r=0;r<t.length;++r)r>0&&(s=s.slice(0,s.length-1)+" "),s+=t[r],s=s.slice(0,e[r]),s+=" ".repeat(e[r]-s.length);n(s)}function G8(t,e,n){let s,r;try{r=t.inboundNodes.map(l=>JSON.stringify(l.inputShapes)).join(",")}catch{r="multiple"}try{s=JSON.stringify(t.outputShape)}catch{s="multiple"}const o=t.name,i=t.getClassName(),a=[`${o} (${i})`,r,s,t.countParams().toString()];Np(a,e,n)}function H8(t,e,n,s){let r,o;try{o=t.inboundNodes.map(d=>JSON.stringify(d.inputShapes)).join(",")}catch{o="multiple"}try{r=JSON.stringify(t.outputShape)}catch{r="multiple"}const i=[];for(const d of t.inboundNodes)if(!(n!=null&&n.length>0&&n.indexOf(d)===-1))for(let f=0;f<d.inboundLayers.length;++f){const h=d.inboundLayers[f].name,p=d.nodeIndices[f],g=d.tensorIndices[f];i.push(`${h}[${p}][${g}]`)}const a=t.name,l=t.getClassName(),u=i.length===0?"":i[0],c=[`${a} (${l})`,o,r,t.countParams().toString(),u];Np(c,e,s);for(let d=1;d<i.length;++d)Np(["","","","",i[d]],e,s)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function qA(t,e,n){return(t==="inboundNodes"||t==="outputLayers"||t==="inputLayers")&&e===0&&typeof n=="string"}function Ky(t,e){if(t===null)return null;if(typeof t=="string")return Ei(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],s=t.length;for(let r=0;r<s;++r){const o=t[r];qA(e,r,o)?n.push(o):n.push(Ky(o,e))}return n}else{const n={};for(const s of Object.keys(t)){const r=t[s];if(s==="name"&&typeof r=="string")n[s]=r;else{const o=Ei(s);n[o]=Ky(r,o)}}return n}}function Xy(t,e){if(t==null)return null;if(typeof t=="string")return qr(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],s=t.length;for(let r=0;r<s;++r){const o=t[r];qA(e,r,o)?n.push(o):n.push(Xy(o,e))}return n}else{const n={};for(const s of Object.keys(t)){const r=t[s],o=qr(s);(s==="name"||s==="className")&&typeof r=="string"?n[o]=r:n[o]=Xy(r,s)}return n}}/** @license See the LICENSE file. */const YA="4.20.0";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const j8=t=>{const e=Object.keys(t);if(e.length===0)return!1;const n=e[0].split("/");return!isNaN(parseInt(n[n.length-1],10))};class Qs extends Re{constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,this.name==null){const x=this.getClassName().toLowerCase();this.name=_g(x)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],qo(this.inputs).length!==this.inputs.length)throw new _(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(x=>x.name)}`);qo(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(x=>x.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const x of this.outputs){const v=x.sourceLayer,b=x.nodeIndex,$=x.tensorIndex;this.outputLayers.push(v),this.outputLayersNodeIndices.push(b),this.outputLayersTensorIndices.push($)}for(const x of this.inputs){const v=x.sourceLayer,b=x.nodeIndex,$=x.tensorIndex;Cr(b===0,"input layer has >1 nodes"),Cr($===0,"input layer has >1 tensors"),this.inputLayers.push(v),this.inputLayersNodeIndices.push(b),this.inputLayersTensorIndices.push($)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let x=0;x<this.inputLayers.length;x++){const v=this.inputLayers[x];if(!(v instanceof uf))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${e.inputs}. Input ${x} (0-based) originates from layer type ${v.getClassName()}.`);this.inputNames.push(v.name),this.feedInputShapes.push(v.batchInputShape),this.feedInputNames.push(v.name)}for(const x of this.outputLayers)this.outputNames.push(x.name);this.internalInputShapes=this.inputs.map(x=>x.shape),this.internalOutputShapes=this.outputs.map(x=>x.shape);const n={},s={},r={},o={},i={},a=[],l=(x,v,b,$,C,k)=>{($==null||C==null||k==null)&&($=x.sourceLayer,C=x.nodeIndex,k=x.tensorIndex);const w=$.inboundNodes[C];if(b.indexOf(w)!==-1)throw new Ms(`The tensor ${x.name} at layer "${$.name}" is part of a cycle.`);if(v.indexOf(w)!==-1)return;this.containerNodes.add(Qs.nodeKey($,C)),$.id in i||(i[$.id]=Object.keys(i).length),b.indexOf(w)===-1&&b.push(w);const I=w.inboundLayers.length;for(let R=0;R<I;R++){const E=w.inputTensors[R],A=w.inboundLayers[R],S=w.nodeIndices[R],T=w.tensorIndices[R];l(E,v,b,A,S,T)}for(v.push(w);b.indexOf(w)>=0;)b.splice(b.indexOf(w),1);a.push(w)},u=[],c=[];for(const x of this.outputs)l(x,u,c);const d=a.slice().reverse();for(const x of d){s[x.id]=x,x.id in n||(n[x.id]=0);let v=n[x.id];const b=r[x.outboundLayer.id]==null?0:r[x.outboundLayer.id];v=Math.max(v,b),r[x.outboundLayer.id]=v,o[x.outboundLayer.id]=x.outboundLayer,n[x.id]=v;for(let $=0;$<x.inboundLayers.length;$++){const C=x.inboundLayers[$],k=x.nodeIndices[$],w=C.inboundNodes[k],I=n[w.id]==null?0:n[w.id];n[w.id]=Math.max(v+1,I),s[w.id]=w}}const f={};for(const x in n){const v=n[x];v in f||(f[v]=[]),f[v].push(s[x])}const h={};for(const x in r){const v=r[x];v in h||(h[v]=[]),h[v].push(o[x])}let p=Object.keys(h).map(x=>parseInt(x,10)).sort(Kf);this.layers=[];for(const x of p){const v=h[x];v.sort((b,$)=>{const C=i[b.id],k=i[$.id];return C<k?-1:C>k?1:0});for(const b of v)b instanceof Qs&&this.internalContainerRefs.push(b),this.layers.push(b)}this.layersByDepth=h,p=Object.keys(f).map(x=>parseInt(x,10)).sort(Kf);const g=this.inputs.slice(),y=[];for(const x of p)for(const v of f[x]){const b=v.outboundLayer;if(b!=null){for(const $ of v.inputTensors)if(g.indexOf($)===-1)throw new Ms(`Graph disconnected: cannot obtain value for tensor ${$} at layer "${b.name}". The following previous layers were accessed without issue: ${y}`);for(const $ of v.outputTensors)g.push($);y.push(b.name)}}this.nodesByDepth=f;const m=this.layers.map(x=>x.name);for(const x of m){const v=m.filter(b=>b===x).length;if(v!==1)throw new Ms(`The name "${x}" is used ${v} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(m))}this.outboundNodes=[],this.inboundNodes=[],new Vg({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(x=>null),outputMasks:this.outputs.map(x=>null),inputShapes:this.inputs.map(x=>x.shape),outputShapes:this.outputs.map(x=>x.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const e={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(const n of this.layers)e.numDisposedVariables+=n.dispose().numDisposedVariables;for(const n of this.internalContainerRefs)e.numDisposedVariables+=n.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach(n=>{n._trainableWeights.forEach(s=>s.trainable=e)}),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new _("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(const n of this.layers)e=e.concat(n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.layers)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const s of this.layers)n.push(...s.trainableWeights);return n.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e,n=!0){const s={};let r=0;const o=j8(e);o&&this.parseWeights(e);for(const a of this.layers)for(const[l,u]of a.weights.entries()){const c=o?`${u.name.split("/").slice(0,-1).join("/")+"/"}${l}`:u.originalName;if(s[c]!=null)throw new _(`Duplicate weight name: ${c}`);s[c]=u,r++}const i=[];for(const a in e){let l=a;if(s[a]==null){const u=a.split("/");l=u.slice(0,-2).concat([u[u.length-1]]).join("/")}if(s[l]!=null)i.push([s[l],e[a]]);else if(n)throw new _(`Provided weight data has no target variable: ${a}`);delete s[l]}if(n){const a=[];for(const l in s)a.push(l);if(a.length>0)throw new _(`${a.length} of ${r} weights are not set: ${a}`)}Hw(i)}parseWeights(e){for(const n in Object.keys(e)){const s=n.split("/"),r=["vars","layer_checkpoint_dependencies"],o=s.map(i=>i.startsWith("_")?i.slice(1):i).filter(i=>!r.includes(i)).join("/");o!==n&&(e[o]=e[n],delete e[n])}}updatedConfig(){const e=this.getConfig(),n={};return n.className=this.getClassName(),n.config=e,n.kerasVersion=`tfjs-layers ${YA}`,n.backend="TensorFlow.js",n}toJSON(e,n=!0){const s=Xy(this.updatedConfig());return n?JSON.stringify(s):s}call(e,n){return H(()=>{e=Ke(e);const s=new Lo;for(let r=0;r<this.inputs.length;++r)s.add(this.inputs[r],e[r]);return Bu(this.outputs,s,n)})}computeMask(e,n){return H(()=>{e=Ke(e);let s;return n==null?s=ua(null,e.length):s=Ke(n),this.runInternalGraph(e,s)[1]})}computeOutputShape(e){const n=wp(e);if(n.length!==this.inputLayers.length)throw new _(`Invalid inputShape argument ${e}: model has ${this.inputLayers.length} tensor inputs.`);const s={};for(let a=0;a<n.length;a++){const l=this.inputLayers[a],u=n[a],c=l.name+"_0_0";s[c]=u}const r=Object.keys(this.nodesByDepth).map(a=>parseInt(a,10)).sort(Kf);if(r.length>1)for(const a of r){const l=this.nodesByDepth[a];for(const u of l){const c=u.outboundLayer;if(this.inputLayers.map(g=>g.id).indexOf(c.id)!==-1)continue;const d=[];for(let g=0;g<u.inboundLayers.length;g++){const y=u.inboundLayers[g],m=u.nodeIndices[g],x=u.tensorIndices[g],v=`${y.name}_${m}_${x}`,b=s[v];d.push(b)}const f=c.computeOutputShape(_n(d)),h=wp(f),p=c.inboundNodes.indexOf(u);for(let g=0;g<h.length;g++){const y=`${c.name}_${p}_${g}`;s[y]=h[g]}}}const o=[],i=[];for(let a=0;a<this.outputLayers.length;a++){const l=this.outputLayers[a],u=this.outputLayersNodeIndices[a],c=this.outputLayersTensorIndices[a],d=`${l.name}_${u}_${c}`;i.push(d)}for(let a=0;a<i.length;a++){const l=i[a];Cr(l in s),o.push(s[l])}return _n(o)}runInternalGraph(e,n){n==null&&(n=ua(null,e.length));const s={};for(let l=0;l<this.inputs.length;++l){const u=this.inputs[l],c=e[l],d=n[l];s[u.id]=[c,d]}const r=Object.keys(this.nodesByDepth).map(l=>parseInt(l,10)).sort(Kf);for(const l of r){const u=this.nodesByDepth[l];for(const c of u){const d=c.outboundLayer,f=c.inputTensors,h=c.outputTensors,p=new Array;for(const g of f)g.id in s&&p.push(s[g.id]);if(p.length===f.length){let g={},y,m,x,v;if(c.callArgs!=null&&(g=c.callArgs),p.length===1){const[b,$]=p[0];g.mask==null&&(g.mask=$),x=Ke(d.call(b,g)),v=Ke(d.computeMask(b,$)),y=[b],m=[$]}else y=p.map(b=>b[0]),m=p.map(b=>b[1]),g.mask==null&&(g.mask=m),x=Ke(d.call(y,g)),v=Ke(d.computeMask(y,m));if(d.activityRegularizer)throw new Te("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let b=0;b<h.length;++b){const $=h[b],C=x[b],k=v[b];s[$.id]=[C,k]}}}}const o=[],i=[],a=[];for(const l of this.outputs){Cr(l.id in s,`Could not compute output ${l.name} : ${l.id}`);const[u,c]=s[l.id];a.push(u.shape),o.push(u),i.push(c)}return[o,i,a]}buildNodeConversionMap(e){const n={};let s;for(const r of this.layers){s=r instanceof Qs?1:0;for(let o=0;o<r.inboundNodes.length;o++){const i=Qs.nodeKey(r,o);this.containerNodes.has(i)&&(n[i]=s,s+=1)}}return n}getLayer(e,n){if(n!=null)return this.findLayer(n);if(e==null)throw new _("Provide either a layer name or layer index");if(typeof e=="number")return this.findLayer(e);for(const s of this.layers)if(s.name===e)return s;throw new _(`No such layer: ${e}`)}findLayer(e){if(this.layers.length<=e)throw new _(`Was asked to retrieve layer at index ${e}, but model only has ${this.layers.length} layer(s).`);return this.layers[e]}calculateLosses(){return H(()=>{const e=[];for(const n of this.layers)for(let s=0;s<n.inboundNodes.length;++s){const r=Qs.nodeKey(n,s);this.containerNodes.has(r)&&e.push(...n.calculateLosses())}return e})}getConfig(){const e={name:this.name},n=this.buildNodeConversionMap(this.layers),s=[];for(const i of this.layers){const a=i.getClassName(),l=i.getConfig(),u=[];for(let d=0;d<i.inboundNodes.length;d++){const f=i.inboundNodes[d],h=Qs.nodeKey(i,d);let p={};if(this.containerNodes.has(h)){if(f.callArgs)try{JSON.stringify(f.callArgs),p=f.callArgs}catch{console.warn(`Layer ${i.name} was passed non-serializable keyword arguments: ${f.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),p={}}if(f.inboundLayers.length>0){const g=[];for(let y=0;y<f.inboundLayers.length;y++){const m=f.inboundLayers[y],x=f.nodeIndices[y],v=f.tensorIndices[y],b=Qs.nodeKey(m,x);let $=n[b];$==null&&($=0),g.push([m.name,$,v,p])}u.push(g)}}}const c={};c.name=i.name,c.className=a,c.config=l,c.inboundNodes=u,s.push(c)}e.layers=s;const r=[];for(let i=0;i<this.inputLayers.length;i++){const a=this.inputLayers[i],l=this.inputLayersNodeIndices[i],u=Qs.nodeKey(a,l);if(!this.containerNodes.has(u))continue;let c=n[u];c==null&&(c=0);const d=this.inputLayersTensorIndices[i];r.push([a.name,c,d])}e.inputLayers=r;const o=[];for(let i=0;i<this.outputLayers.length;i++){const a=this.outputLayers[i],l=this.outputLayersNodeIndices[i],u=Qs.nodeKey(a,l);if(!this.containerNodes.has(u))continue;let c=n[u];c==null&&(c=0);const d=this.outputLayersTensorIndices[i];o.push([a.name,c,d])}return e.outputLayers=o,e}static fromConfig(e,n,s={},r=!1){const o={},i={};function a(y,m){y.name in i?i[y.name].push(m):i[y.name]=[m]}function l(y,m){const x=[];let v;for(const b of m){const $=b[0],C=b[1],k=b[2];if(v=b[3]==null?{}:b[3],!($ in o)){a(y,m);return}const w=o[$];if(w.inboundNodes.length<=C){a(y,m);return}const I=w.inboundNodes[C];x.push(I.outputTensors[k])}x.length>0&&y.apply(_n(x),v)}function u(y){const m=y.name,x=so(y,n.customObjects!=null?n.customObjects:{});x.setFastWeightInitDuringBuild(r),o[m]=x,y.inboundNodes.forEach(b=>{if(!(b instanceof Array))throw new _(`Corrupted configuration, expected array for nodeData: ${b}`);a(x,b)})}const c=n.name,d=n.layers;for(const y of d)u(y);for(;!R7(i);)for(const y of d){const m=o[y.name];if(m.name in i){const x=i[m.name];delete i[m.name];for(const v of x)l(m,v)}}const f=[],h=[],p=n.inputLayers;for(const y of p){const m=y[0],x=y[1],v=y[2];Cr(m in o);const $=o[m].inboundNodes[x].outputTensors;f.push($[v])}const g=n.outputLayers;for(const y of g){const m=y[0],x=y[1],v=y[2];Cr(m in o);const $=o[m].inboundNodes[x].outputTensors;h.push($[v])}return new e({inputs:f,outputs:h,name:c})}get stateful(){if(this._stateful)throw new _("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const e of this.layers)if(e.stateful)return!0;return!1}resetStates(){H(()=>{this.layers.forEach(e=>{e.stateful&&e.resetStates()})})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function K8(t,e,n){const s=e.length;if(t==null||Array.isArray(t)&&t.length===0)return e.map(r=>null);if(s===1)return Array.isArray(t)&&t.length===1?t:typeof t=="object"&&e[0]in t?[t[e[0]]]:[t];if(Array.isArray(t)){if(t.length!==s)throw new Error(`Provided ${n} is an array of ${t.length} element(s), but the model has ${s} outputs. Make sure a set of weights is provided for each model output.`);return t}else if(typeof t=="object"&&Object.keys(t).length>0&&typeof t[Object.keys(t)[0]]=="object"){const r=[];return e.forEach(o=>{o in t?r.push(t[o]):r.push(null)}),r}else throw new Error(`The model has multiple (${s}) outputs, so ${n} must be either an array with ${s} elements or an object with ${e} keys. Provided ${n} not understood: ${JSON.stringify(t)}`)}function QA(t,e){return K8(t,e,"classWeight")}async function ZA(t,e,n,s){if(n!=null){const r=H(()=>{if(t.shape.length===1)return Ui(t);if(t.shape.length===2){if(t.shape[1]>1)return Dc(t,1);if(t.shape[1]===1)return B(t,[t.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${t.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${t.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),o=Array.from(await r.data());Ae(r);const i=[];return o.forEach(a=>{if(n[a]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${a} exists in the data but not in classWeight`);i.push(n[a])}),Zn(i,"float32")}else return null}function X8(t,e){return z(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const q8=32;function JA(t,e){let n,s;const r=e;n=r.xs,s=r.ys,N(n!=null&&s!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${e}`);const o=dS("input",t.inputNames,n),i=dS("output",t.outputNames,s),a=o[0].shape[0];N(o.length===t.inputs.length,()=>`LayersModel has ${t.inputs.length} inputs, but the dataset provides ${o.length} inputs.  (Expected input keys: ${JSON.stringify(t.inputNames)})`),N(i.length===t.outputs.length,()=>`LayersModel has ${t.outputs.length} outputs, but the dataset provides ${i.length} outputs.  (Expected output keys: ${JSON.stringify(t.outputNames)})`);for(let l=0;l<o.length;l++)N(o[l].shape[0]===a,()=>`Batch size mismatch: input ${t.inputNames[l]} has ${o[l].shape[0]}; expected  ${a} based on input ${t.inputNames[0]}.`);for(let l=0;l<i.length;l++)N(i[l].shape[0]===a,()=>`Batch size mismatch: output ${t.outputNames[l]} has ${i[l].shape[0]}; expected  ${a} based on input ${t.inputNames[0]}.`);return{xs:o,ys:i}}function dS(t,e,n){if(n instanceof zt)return[n];if(Array.isArray(n))return N(n.length===e.length,()=>`Received an array of ${n.length} Tensors, but expected ${e.length} to match the ${t} keys ${e}.`),n;{const s=[];for(const r of e){if(n[r]==null)throw new _(`The feature data generated by the dataset lacks the required ${t} key '${r}'.`);s.push(n[r])}return s}}function Y8(t){if(t.length===3)throw new Te("Validation with sample weights is not implemented yet.");return{xs:t[0],ys:t[1]}}async function Q8(t,e,n){const s=n.batchesPerEpoch!=null;if(N(t.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),N(n!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),N(n.epochs!=null&&n.epochs>0&&Number.isInteger(n.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${n.epochs}`),N(!s||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${n.batchesPerEpoch}`),N(n.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0;try{const r=n.validationData!=null;let o,i;if(r)if(fS(n.validationData))N(n.validationBatches==null||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${n.validationBatches}`);else{const y=Y8(n.validationData);o=y.xs,i=y.ys}const a=t.makeTrainFunction(),l=t.getDedupedMetricsNames();let u;r?u=l.slice().concat(l.map(y=>"val_"+y)):u=l.slice();const c=WA(n.callbacks,n.yieldEvery),d=n.verbose==null?1:n.verbose,{callbackList:f,history:h}=UA(c,d,n.epochs,null,null,Z8(e,n),null,r,u);f.setModel(t),t.history=h,await f.onTrainBegin(),t.stopTraining_=!1;let p=n.initialEpoch==null?0:n.initialEpoch,g=await e.iterator();for(;p<n.epochs;){const y={};await f.onEpochBegin(p);let m=0,x=0;for(s||(g=await e.iterator());!s||m<n.batchesPerEpoch;){const v=await g.next();if(s&&v.done){console.warn(`You provided \`batchesPerEpoch\` as ${n.batchesPerEpoch}, but your dataset iterator ran out of data after ${m} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${n.batchesPerEpoch*n.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(v.value!=null){const{xs:b,ys:$}=JA(t,v.value),C={};C.batch=x,C.size=b[0].shape[0],await f.onBatchBegin(x,C);const k=[];if(n.classWeight!=null){const R=QA(n.classWeight,t.outputNames);for(let E=0;E<R.length;++E)k.push(await ZA($[E],null,R[E]))}const w=b.concat($).concat(k),I=a(w);Ae(w);for(let R=0;R<l.length;++R){const E=l[R],A=I[R];C[E]=A,Rr(A)}await f.onBatchEnd(x,C),BA(C),x++,m++}if(s?m>=n.batchesPerEpoch:v.done){if(r){let b;fS(n.validationData)?b=Ke(await t.evaluateDataset(n.validationData,{batches:n.validationBatches})):b=Ke(t.evaluate(o,i,{batchSize:n.validationBatchSize==null?q8:n.validationBatchSize,verbose:0}));for(let $=0;$<t.metricsNames.length;++$)y[`val_${t.metricsNames[$]}`]=b[$]}break}if(t.stopTraining_)break}if(await f.onEpochEnd(p,y),p++,t.stopTraining_)break}return await f.onTrainEnd(),await t.history.syncData(),t.history}finally{t.isTraining=!1}}function Z8(t,e){let n=null;return e.batchesPerEpoch!=null?n=e.batchesPerEpoch:Number.isFinite(t.size)&&(n=t.size),n}function fS(t){return typeof t.iterator=="function"}function J8(t){return typeof t.next=="function"}async function ej(t,e,n){n=n||{};const s=n.batches!=null,r=t.testFunction;let o=[];if(n.verbose>0)throw new Te("Verbose mode is not implemented yet.");N(!s||n.batches>0&&Number.isInteger(n.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(n.batches)}`);const i=J8(e)?e:await e.iterator();let a=0,l=0;for(;!s||l<n.batches;){const u=await i.next();if(o=H(()=>{if(u.value){const{xs:c,ys:d}=JA(t,u.value),f=c.concat(d),h=H(()=>r(f));if(Ae(f),l===0)for(let g=0;g<h.length;++g)o.push(Ge(0));const p=f[0].shape[0];for(let g=0;g<h.length;++g){const y=h[g],m=o[g];o[g]=H(()=>ne(o[g],z(p,y))),l>0&&Ae(m)}Ae(h),a+=p,++l}return o}),u.done){s&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let u=0;u<o.length;++u){const c=o[u];o[u]=xe(o[u],a),Ae(c)}return _n(o)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Z0(t){N(t>0&&Number.isInteger(t),()=>`batchSize is required to be a positive integer, but got ${t}`)}function Eu(t,e,n){return t==null?[null]:Array.isArray(t)?t.map(s=>Hi(s,e,n-e)):Hi(t,e,n-e)}function qy(t,e){return H(()=>t==null?null:Array.isArray(t)?t.map(n=>qy(n,e)):TA(t,e.dtype==="int32"?e:ce(e,"int32")))}function J0(t,e){const n=[];let s=0,r=null;for(;s<t;)r=s+e,r>=t&&(r=t),n.push([s,r]),s=r;return n}function eD(t){const e=[];t instanceof zt&&(t=[t]);for(let n=0;n<t.length;++n){const s=t[n];if(s.rank===1)e.push(of(s,1));else{if(s.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(s)}}return e}function qs(t,e){if(t==null)return;const n=[];if(e instanceof zt)n.push(e.id);else if(Array.isArray(e))e.forEach(r=>n.push(r.id));else if(e!=null)for(const r in e){const o=e[r];n.push(o.id)}const s=[];if(t instanceof zt)n.indexOf(t.id)===-1&&s.push(t);else if(Array.isArray(t))t.forEach(r=>{n.indexOf(r.id)===-1&&s.push(r)});else if(t!=null)for(const r in t){const o=t[r];n.indexOf(o.id)===-1&&s.push(o)}s.forEach(r=>{r.isDisposed||r.dispose()})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function tj(t){return t instanceof zt}function Yy(t){return Array.isArray(t)}function hS(t){return!tj(t)&&!Yy(t)}function pS(t,e,n,s=!0,r=""){if(e==null||e.length===0){if(t!=null){let i=!1;if(Yy(t)&&t.length>0)i=!0;else if(hS(t)){for(const a in t)if(t.hasOwnProperty(a)){i=!0;break}}else i=!0;if(i)throw new _(`Error when checking model ${r} expected no data, but got ${t}`)}return[]}if(t==null)return e.map(i=>null);let o;if(hS(t)){t=t,o=[];for(const i of e){if(t[i]==null)throw new _(`No data provided for "${i}". Need data for each key in: ${e}`);o.push(t[i])}}else if(Yy(t)){if(t=t,t.length!==e.length)throw new _(`Error when checking model ${r}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${e.length} Tensor(s), but instead got the following list of Tensor(s): ${t}`);o=t}else{if(t=t,e.length>1)throw new _(`The model ${r} expects ${e.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${t.shape}`);o=[t]}if(o=eD(o),n!=null)for(let i=0;i<e.length;++i){if(n[i]==null)continue;const a=o[i];if(a.shape.length!==n[i].length)throw new _(`Error when checking ${r}: expected ${e[i]} to have ${n[i].length} dimension(s). but got array with shape ${a.shape}`);for(let l=0;l<n[i].length;++l){if(l===0&&!s)continue;const u=a.shape[l],c=n[i][l];if(c!=null&&c>=0&&u!==c)throw new _(`${r} expected a batch of elements where each example has shape [${n[i].slice(1,n[i].length)}] (i.e.,tensor shape [*,${n[i].slice(1,n[i].length)}]) but the ${r} received an input with ${a.shape[0]} examples, each with shape [${a.shape.slice(1,a.shape.length)}] (tensor shape [${a.shape}])`)}}return o}function nj(t,e,n){const s=qo(t.map(o=>o.shape[0]));s.sort();const r=qo(e.map(o=>o.shape[0]));if(r.sort(),s.length>1)throw new _(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map(o=>o.shape))}`);if(r.length>1)throw new _(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(o=>o.shape))}`);if(s.length>0&&r.length>0&&!He(s,r))throw new _(`Input Tensors should have the same number of samples as target Tensors. Found ${s[0]} input sample(s) and ${r[0]} target sample(s).`)}function sj(t,e,n){const s=[Bg,Wg,_c];for(let r=0;r<t.length;++r){const o=t[r],i=e[r],a=n[r];if(i!=null){if(i===_c&&o.shape[o.shape.length-1]===1)throw new _(`You are passing a target array of shape ${o.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(s.indexOf(i)!==-1){const l=o.shape.slice(1),u=a.slice(1);for(let c=0;c<l.length;++c){const d=l[c],f=u[c];if(f!=null&&d!==f)throw new _(`A target Tensor with shape ${o.shape} was passed for an output of shape ${a}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function mS(t,e,n,s=!0,r=""){let o;if(Array.isArray(t)){if(t.length!==e.length)throw new _(`Error when checking model ${r}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${e.length} Tensor(s), but instead got ${t.length} Tensors(s).`);o=t}else{if(e.length>1)throw new _(`The model expects ${e.length} ${r} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(t.shape)}.`);o=[t]}if(n!=null)for(let i=0;i<e.length;++i){if(n[i]==null)continue;const a=o[i];if(a.shape.length!==n[i].length)throw new _(`Error when checking ${r}: expected ${e[i]} to have ${n[i].length} dimension(s), but got array with shape ${JSON.stringify(a.shape)}`);for(let l=0;l<n[i].length;++l){if(l===0&&!s)continue;const u=a.shape[l],c=n[i][l];if(c!=null&&c!==u)throw new _(`Error when checking ${r}: expected ${e[i]} to have shape ${JSON.stringify(n[i])} but got array with shape ${JSON.stringify(a.shape)}.`)}}}function rj(t,e){if(t==null||Array.isArray(t)&&t.length===0)return e.map(s=>[]);let n;if(typeof t=="string"||typeof t=="function")n=[t];else if(Array.isArray(t)||typeof t=="object")n=t;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${t}`);if(Array.isArray(n))return e.map(s=>n);{const s=[];for(const r of e){let o=n.hasOwnProperty(r)?n[r]:[];Array.isArray(o)||(o=[o]),s.push(o)}return s}}const oj="layers-model";class bl extends Qs{constructor(e){super(e),this.isTraining=!1}summary(e,n,s=console.log){if(!this.built)throw new _("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");B8(this,e,n,s)}compile(e){if(e.loss==null&&(e.loss=[]),this.loss=e.loss,typeof e.optimizer=="string")this.optimizer_=V8(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof mi))throw new _("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let n=[];if(!Array.isArray(e.loss)&&typeof e.loss!="string"&&typeof e.loss!="function"){e.loss=e.loss;for(const i in e.loss)if(this.outputNames.indexOf(i)===-1)throw new _(`Unknown entry in loss dictionary: "${i}". Only expected the following keys: ${this.outputNames}`);for(const i of this.outputNames)e.loss[i]==null&&console.warn(`Output "${i}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${i} during training`),n.push(Q0(e.loss[i]))}else if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new _(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);n=e.loss.map(a=>Q0(a))}else{const i=Q0(e.loss);this.outputs.forEach(a=>{n.push(i)})}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let i=0;i<this.outputs.length;++i){const a=this.internalOutputShapes[i],l=this.outputNames[i];this.feedOutputNames.push(l),this.feedOutputShapes.push(a),this.feedLossFns.push(this.lossFunctions[i])}const s=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],Gi("loss",()=>{for(let i=0;i<this.outputs.length;++i){if(s.indexOf(i)!==-1)continue;const a=this.lossFunctions[i];this.outputs.length>1&&(this.metricsTensors.push([a,i]),this.metricsNames.push(this.outputNames[i]+"_loss"))}});const r=rj(e.metrics,this.outputNames),o=(i,a,l)=>{this.outputNames.length>1&&(a=this.outputNames[i]+"_"+a),this.metricsNames.push(a),this.metricsTensors.push([l,i])};Gi("metric",()=>{for(let i=0;i<this.outputs.length;++i){if(s.indexOf(i)!==-1)continue;const a=r[i];(u=>{const c="";let d,f,h;for(const p of u){if(typeof p=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(p)!==-1){const y=this.internalOutputShapes[i];y[y.length-1]===1||this.lossFunctions[i]===Wg?["accuracy","acc"].indexOf(p)!==-1?f=HA:["crossentropy","ce"].indexOf(p)!==-1&&(f=R8):this.lossFunctions[i]===Ip?["accuracy","acc"].indexOf(p)!==-1?f=A8:["crossentropy","ce"].indexOf(p)!==-1&&(f=XA):["accuracy","acc"].indexOf(p)!==-1?f=jA:["crossentropy","ce"].indexOf(p)!==-1&&(f=KA);let m;["accuracy","acc"].indexOf(p)!==-1?m="acc":["crossentropy","ce"].indexOf(p)!==-1&&(m="ce"),h=f,d=c+m}else h=z8(p),d=c+Yf(p);let g;Gi(d,()=>{g=h}),o(i,d,g)}})(a)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,n,s={}){const r=s.batchSize==null?32:s.batchSize;Z0(r);const i=this.standardizeUserDataXY(e,n,!0,r);try{const a=i[0].concat(i[1]);this.makeTestFunction();const l=this.testFunction,u=this.testLoop(l,a,r,s.verbose,s.steps);return _n(u)}finally{qs(i[0],e),qs(i[1],n)}}async evaluateDataset(e,n){return this.makeTestFunction(),ej(this,e,n)}checkNumSamples(e,n,s,r="steps"){let o;if(s!=null){if(o=null,n!=null)throw new _(`If ${r} is set, batchSize must be null or undefined.Got batchSize = ${n}`)}else if(e!=null)Array.isArray(e)?o=e[0].shape[0]:o=e.shape[0];else throw new _(`Either the input data should have a defined shape, or ${r} shoud be specified.`);return o}execute(e,n){if(Array.isArray(n)&&n.length===0)throw new _("`outputs` is an empty Array, which is not allowed.");const s=Array.isArray(n),r=s?n:[n],o=this.retrieveSymbolicTensors(r),i=new Lo;if(e instanceof zt&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new _(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let l=0;l<this.inputs.length;++l)i.add(this.inputs[l],e[l])}else for(const l of this.inputs){const u=e[l.name];if(u==null)throw new _(`No value is provided for the model's input ${l.name}`);i.add(l,u)}const a=Bu(o,i);return s?a:a[0]}retrieveSymbolicTensors(e){const n=ua(null,e.length);let s=e.length;for(const r of this.layers){const o=Array.isArray(r.output)?r.output:[r.output],i=o.map(a=>a.name);for(let a=0;a<e.length;++a){const l=i.indexOf(e[a]);if(l!==-1&&(n[a]=o[l],s--),s===0)break}if(s===0)break}if(s>0){const r=[];throw n.forEach((o,i)=>{o==null&&r.push(e[i])}),new _(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(r)}`)}return n}predictLoop(e,n=32,s=!1){return H(()=>{const r=this.checkNumSamples(e);if(s)throw new Te("Verbose predictLoop() is not implemented yet.");const o=J0(r,n),i=this.outputs.map(a=>[]);for(let a=0;a<o.length;++a)H(()=>{const u=o[a][0],c=o[a][1],d=Eu(e,u,c),f=[];if(Array.isArray(d))for(let p=0;p<d.length;++p)f.push({key:this.inputs[p],value:d[p]});else f.push({key:this.inputs[0],value:d});const h=new Lo(f);return Bu(this.outputs,h)}).forEach((u,c)=>i[c].push(u));return _n(i.map(a=>Bn(a,0)))})}predict(e,n={}){const s=eD(e);mS(s,this.inputNames,this.feedInputShapes,!1);try{const r=n.batchSize==null?32:n.batchSize;return Z0(r),this.predictLoop(s,r)}finally{qs(s,e)}}predictOnBatch(e){mS(e,this.inputNames,this.feedInputShapes,!0);const n=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,n)}standardizeUserDataXY(e,n,s=!0,r){if(this.optimizer_==null)throw new Ms("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const o=[];for(let i=0;i<this.feedOutputShapes.length;++i){const a=this.feedOutputShapes[i];this.feedLossFns[i]===Ip?o.push(a.slice(0,a.length-1).concat([1])):o.push(a)}if(e=pS(e,this.feedInputNames,this.feedInputShapes,!1,"input"),n=pS(n,this.feedOutputNames,o,!1,"target"),nj(e,n),sj(n,this.feedLossFns,this.feedOutputShapes),this.stateful&&r!=null&&r>0&&e[0].shape[0]%r!==0)throw new _(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${r}. Found: ${e[0].shape[0]} sample(s).`);return[e,n]}async standardizeUserData(e,n,s,r,o=!0,i){const[a,l]=this.standardizeUserDataXY(e,n,o,i);if(s!=null)throw new Error("sample weight is not supported yet.");let u=null;if(r!=null){const c=QA(r,this.outputNames);u=[];for(let d=0;d<c.length;++d)u.push(await ZA(l[d],null,c[d]))}return[a,l,u]}testLoop(e,n,s,r=0,o){return H(()=>{const i=this.checkNumSamples(n,s,o,"steps"),a=[];if(r>0)throw new Te("Verbose mode is not implemented yet.");if(o!=null)throw new Te("steps mode in testLoop() is not implemented yet");{const l=J0(i,s),u=Zn(cr(0,i));for(let c=0;c<l.length;++c){const d=l[c][0],f=l[c][1],h=Hi(u,d,f-d),p=qy(n,h),g=e(p);if(c===0)for(let y=0;y<g.length;++y)a.push(Ge(0));for(let y=0;y<g.length;++y){const m=g[y];a[y]=ne(a[y],z(f-d,m))}}for(let c=0;c<a.length;++c)a[c]=xe(a[c],i)}return a})}getDedupedMetricsNames(){const e=this.metricsNames,n=[];for(let s=0;s<e.length;++s){const r=e[s];let o=r;if(Jk(e,r)>1){const i=Jk(e.slice(0,s),r);o+=`_${i}`}n.push(o)}return n}makeTrainFunction(){return e=>{const n=[],s=e.slice(0,this.inputs.length),r=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),o=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),i=[],a=()=>{const d=[];for(let g=0;g<this.inputs.length;++g)d.push({key:this.inputs[g],value:s[g]});const f=new Lo(d),h=Bu(this.outputs,f,{training:!0});let p;for(let g=0;g<this.lossFunctions.length;++g){const y=this.lossFunctions[g];let m=y(r[g],h[g]);o[g]!=null&&(m=X8(m,o[g]));const x=Ot(m);n.push(x),g===0?p=m:p=ne(p,m)}for(let g=0;g<this.metricsTensors.length;++g){let y;if(this.outputs.length>1&&g<this.outputs.length)y=n[g];else{const m=this.metricsTensors[g][0],x=this.metricsTensors[g][1];y=Ot(m(r[x],h[x]))}Rr(y),i.push(y)}return p=Ot(p),this.calculateLosses().forEach(g=>{p=ne(p,g)}),p},l=this.collectedTrainableWeights.map(d=>d.read());return[this.optimizer_.minimize(a,!0,l)].concat(i)}}makeTestFunction(){this.testFunction=e=>H(()=>{const n=[];let s;const r=e.slice(0,this.inputs.length),o=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=[];for(let u=0;u<this.inputs.length;++u)i.push({key:this.inputs[u],value:r[u]});const a=new Lo(i),l=Bu(this.outputs,a);for(let u=0;u<this.lossFunctions.length;++u){const c=this.lossFunctions[u],d=Ot(c(o[u],l[u]));u===0?s=d:s=ne(s,d),n.push(s)}for(let u=0;u<this.metricsTensors.length;++u){const c=this.metricsTensors[u][0],d=this.metricsTensors[u][1],f=Ot(c(o[d],l[d]));n.push(f)}return n})}async fit(e,n,s={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let r,o,i,a,l,u,c,d,f;try{const h=s.batchSize==null?32:s.batchSize;Z0(h);const g=await this.standardizeUserData(e,n,s.sampleWeight,s.classWeight,!1,h);r=g[0],o=g[1],f=g[2];let y=!1,m;if(s.validationData!=null&&s.validationData.length>0){if(y=!0,s.validationData.length===2)l=s.validationData[0],u=s.validationData[1];else throw s.validationData.length===3?new Te("validationData including sample weights is not supported yet."):new _(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${s.validationData} is invalid.`);const R=await this.standardizeUserData(l,u,null,null,!0,h);c=R[0],d=R[1],m=c.concat(d)}else if(s.validationSplit!=null&&s.validationSplit>0&&s.validationSplit<1){y=!0;const I=Math.floor(r[0].shape[0]*(1-s.validationSplit)),R=r[0].shape[0];c=Eu(r,I,R),i=r,r=Eu(r,0,I),d=Eu(o,I,R),a=o,o=Eu(o,0,I),m=c.concat(d)}else s.validationSteps!=null&&(y=!0);const x=r.concat(o).concat(f);this.checkTrainableWeightsConsistency();const v=this.makeTrainFunction(),b=this.getDedupedMetricsNames();let $,C;y?(this.makeTestFunction(),$=this.testFunction,C=b.slice().concat(b.map(I=>"val_"+I))):($=null,m=[],C=b.slice());const k=WA(s.callbacks,s.yieldEvery);return await this.fitLoop(v,x,b,h,s.epochs,s.verbose,k,$,m,s.shuffle,C,s.initialEpoch,null,null)}finally{this.isTraining=!1,qs(r,e),qs(o,n),qs(i,e),qs(a,n),qs(c,l),qs(d,u),f!=null&&Ae(f)}}async fitLoop(e,n,s,r,o,i,a,l,u,c,d,f,h,p){r==null&&(r=32),o==null&&(o=1),c==null&&(c=!0),f==null&&(f=0);let g=!1;if(l!=null&&u!=null&&(g=!0),p!=null&&(g=!0,h==null))throw new _("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const y=this.checkNumSamples(n,r,h,"steps_per_epoch");let m;y!=null&&(m=cr(0,y)),i==null&&(i=1);const{callbackList:x,history:v}=UA(a,i,o,f,y,h,r,g,d);x.setModel(this),this.history=v,await x.onTrainBegin(),this.stopTraining_=!1;for(let b=f;b<o;++b){await x.onEpochBegin(b);const $={};if(h!=null)throw new Te("stepsPerEpoch mode is not implemented yet.");{if(c==="batch")throw new Te("batch shuffling is not implemneted yet");c&&Uz(m);const C=Zn(m),k=J0(y,r);for(let w=0;w<k.length;++w){const I={};if(await x.onBatchBegin(w,I),H(()=>{const R=k[w][0],E=k[w][1],A=Hi(C,R,E-R);I.batch=w,I.size=E-R;const S=qy(n,A),T=e(S);for(let F=0;F<s.length;++F){const M=s[F],U=T[F];I[M]=U,Rr(U)}if(w===k.length-1&&g){const F=this.testLoop(l,u,r);for(let M=0;M<s.length;++M){const U=s[M],P=F[M];Rr(P),$["val_"+U]=P}}}),await x.onBatchEnd(w,I),BA(I),this.stopTraining_)break}C.dispose()}if(await x.onEpochEnd(b,$),this.stopTraining_)break}return await x.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,n){return Q8(this,e,n)}async trainOnBatch(e,n){const s=await this.standardizeUserData(e,n),r=s[0],o=s[1],a=this.makeTrainFunction()(r.concat(o)),l=[];for(const u of a){const c=await u.data();l.push(c[0])}return Ae(a),qs(s[0],e),qs(s[1],n),_n(l)}getNamedWeights(e){const n=[],s=e!=null&&e.trainableOnly,r=s?this.trainableWeights:this.weights,o=this.getWeights(s);for(let i=0;i<r.length;++i)s&&!r[i].trainable||n.push({name:r[i].originalName,tensor:o[i]});return n}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){const e=super.dispose();if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const n=Ok().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=n-Ok().numTensors}return e}getLossIdentifiers(){let e;if(typeof this.loss=="string")e=qr(this.loss);else if(Array.isArray(this.loss)){for(const n of this.loss)if(typeof n!="string")throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(n=>qr(n))}else{const n=Object.keys(this.loss);e={};const s=this.loss;for(const r of n)if(typeof s[r]=="string")e[r]=qr(s[r]);else throw new Error("Serialization of non-string loss is not supported.")}return e}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[qr(Yf(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>qr(Yf(e)));{const e={};for(const n in this.metrics)e[n]=qr(Yf(this.metrics[n]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(e.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(e.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(e.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const n=Ky(e.optimizer_config),s=so(n);let r;if(typeof e.loss=="string")r=Ei(e.loss);else if(Array.isArray(e.loss))r=e.loss.map(i=>Ei(i));else if(e.loss!=null){r={};for(const i in e.loss)r[i]=Ei(e.loss[i])}let o;if(Array.isArray(e.metrics))o=e.metrics.map(i=>Ei(i));else if(e.metrics!=null){o={};for(const i in e.metrics)o[i]=Ei(e.metrics[i])}this.compile({loss:r,metrics:o,optimizer:s})}async save(e,n){if(typeof e=="string"){const u=zV(e);if(u.length===0)throw new _(`Cannot find any save handlers for URL '${e}'`);if(u.length>1)throw new _(`Found more than one (${u.length}) save handlers for URL '${e}'`);e=u[0]}if(e.save==null)throw new _("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const s=await Mk(this.getNamedWeights(n)),a={modelTopology:this.toJSON(null,!1),format:oj,generatedBy:`TensorFlow.js tfjs-layers v${YA}`,convertedBy:null};if((n==null?!1:n.includeOptimizer)&&this.optimizer!=null){a.trainingConfig=this.getTrainingConfig();const u="optimizer",{data:c,specs:d}=await Mk(await this.optimizer.getWeights(),u);s.specs.push(...d),s.data=_V([s.data,c])}return this.userDefinedMetadata!=null&&(cS(this.userDefinedMetadata,this.name,!0),a.userDefinedMetadata=this.userDefinedMetadata),a.weightData=s.data,a.weightSpecs=s.specs,e.save(a)}setUserDefinedMetadata(e){cS(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}bl.className="Model";J(bl);class tD extends bl{}tD.className="Functional";J(tD);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class zc extends bl{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=e.name!=null?e.name:_g("sequential_"),e.layers!=null)for(const n of e.layers)this.add(n)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(s=>s<0))throw new _(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(e){const n=e instanceof zc||e instanceof bl;let s;if(n){if(s=e,s.outputs.length!==1)throw new _("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(s.inputs.length!==1)throw new _("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(e.inboundNodes.length===0){if(e.batchInputShape==null)throw new _("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const r=a8({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(r)}if(n)this.outputs=s.outputs,this.inputs=s.inputs;else{if(e.inboundNodes.length!==1)throw new _(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${e.name} which has ${e.inboundNodes.length} pre-existing inbound connections.`);if(e.inboundNodes[0].outputTensors.length!==1)throw new _("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=LA(this.outputs[0])}this.inboundNodes=[],new Vg({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:ua(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(r=>r.shape),outputShapes:this.outputs[0].shape})}else{const r=e.apply(this.outputs[0]);if(Array.isArray(r))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[r],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,n){return this.model==null&&this.build(),this.model.call(e,n)}build(e){if(_e(e),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new bl({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,n,s=console.log){this.built||this.build(),super.summary(e,n,s)}setWeights(e){this.model==null&&this.build(),this.model.setWeights(e)}evaluate(e,n,s={}){if(!this.built)throw new Ms("The model needs to be compiled before being used.");return this.model.evaluate(e,n,s)}async evaluateDataset(e,n){if(!this.built)throw new Ms("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,n)}predict(e,n={}){return this.model==null&&this.build(),this.model.predict(e,n)}predictOnBatch(e){return this.model==null&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,n,s={}){if(!this.built)throw new Ms("The model needs to be compiled before being used.");return this.model.fit(e,n,s)}async fitDataset(e,n){if(!this.built)throw new Ms("The model needs to be compiled before being used.");return this.model.fitDataset(e,n)}async trainOnBatch(e,n){return this.model.trainOnBatch(e,n)}static fromConfig(e,n,s={},r=!1){let o,i={};if(n instanceof Array){if(n[0].className==null||n[0].className==="Merge")throw new _("Legacy serialization format not supported yet.");o=n}else N(n.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),o=n.layers,delete n.layers,i=n;const a=new e(i);if(!(a instanceof zc))throw new Te(`Sequential.fromConfig called on non-Sequential input: ${a}`);for(const l of o){const c=so(l,void 0,r);r&&c.setFastWeightInitDuringBuild(!0),a.add(c)}return a}set stopTraining(e){if(this.model==null)throw new _("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(this.model==null)throw new _("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const e=[];for(const n of this.layers){const s={};s.className=n.getClassName(),s.config=n.getConfig(),e.push(s)}return{name:this.name,layers:e}}}zc.className="Sequential";J(zc);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let xn=class extends tu{getConfig(){return{}}};class nD extends xn{apply(e,n=1){return H7(e,n)}}nD.className="elu";J(nD);class sD extends xn{apply(e){return bR(e)}}sD.className="selu";J(sD);class rD extends xn{apply(e){return Ia(e)}}rD.className="relu";J(rD);class oD extends xn{apply(e){return H(()=>Oc(6,Ia(e)))}}oD.className="relu6";J(oD);class iD extends xn{apply(e){return e}}iD.className="linear";J(iD);class aD extends xn{apply(e){return Zl(e)}}aD.className="sigmoid";J(aD);class lD extends xn{apply(e){return K7(e)}}lD.className="hardSigmoid";J(lD);class uD extends xn{apply(e){return Qd(e)}}uD.className="softplus";J(uD);class cD extends xn{apply(e){return j7(e)}}cD.className="softsign";J(cD);class dD extends xn{apply(e){return Eg(e)}}dD.className="tanh";J(dD);let qw=class extends xn{apply(e,n=-1){return Z1(e,n)}};qw.className="softmax";J(qw);class fD extends xn{apply(e,n=-1){return dR(e,n)}}fD.className="logSoftmax";J(fD);class hD extends xn{apply(e){return H(()=>H(()=>{const n=Math.sqrt(2),s=z(.5,ne(1,iR(xe(e,n))));return z(e,s)}))}}hD.className="gelu";J(hD);class pD extends xn{apply(e){return H(()=>z(.5,z(e,ne(1,Eg(z(mn(xe(2,Math.PI)),ne(e,z(.044715,ia(e,3)))))))))}}pD.className="gelu_new";J(pD);class mD extends xn{apply(e){return H(()=>z(e,Eg(Qd(e))))}}mD.className="mish";J(mD);class gD extends xn{apply(e,n=1){return H(()=>z(Zl(z(e,n)),e))}}gD.className="swish";J(gD);function si(t){return t.getClassName()}function ex(t,e={}){return rf(t,Ds.getMap().classNameMap,e,"activation")}function ri(t){if(t==null){const e={};return e.className="linear",e.config={},ex(e)}if(typeof t=="string"){const e={};return e.className=t,e.config={},ex(e)}else return t instanceof xn?t:ex(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ij(t){if(t!=null&&typeof t!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${t}`)}class xD extends tu{}class yD extends xD{constructor(e){super(),ij(e),this.l1=e==null||e.l1==null?.01:e.l1,this.l2=e==null||e.l2==null?.01:e.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(e){return H(()=>{let n=xt([1]);return this.hasL1&&(n=ne(n,ge(z(this.l1,Cn(e))))),this.hasL2&&(n=ne(n,ge(z(this.l2,af(e))))),B(n,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,n){return new e({l1:n.l1,l2:n.l2})}}yD.className="L1L2";J(yD);const gS={l1l2:"L1L2"};function tt(t){return Ow(t)}function xS(t,e={}){return rf(t,Ds.getMap().classNameMap,e,"regularizer")}function mt(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in gS?gS[t]:t,config:{}};return xS(n)}else return t instanceof xD?t:xS(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class vD extends Re{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null&&(this.maxValue=e.maxValue)}call(e,n){e=ve(e);let s=Ia(e);return this.maxValue!=null&&(s=gs(s,0,this.maxValue)),s}computeOutputShape(e){return e}getConfig(){const e={maxValue:this.maxValue},n=super.getConfig();return Object.assign(e,n),e}}vD.className="ReLU";J(vD);class bD extends Re{constructor(e){super(e??{}),this.DEFAULT_ALPHA=.3,e==null&&(e={}),this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const s=ve(e);return L1(s,this.alpha)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}}bD.className="LeakyReLU";J(bD);class wD extends Re{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",e==null&&(e={}),this.supportsMasking=!0,this.alphaInitializer=pt(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=mt(e.alphaRegularizer),this.alphaConstraint=Gt(e.alphaConstraint),e.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if(typeof e.sharedAxes=="number")this.sharedAxes=[e.sharedAxes];else throw new _(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`)}build(e){e=_e(e);const n=e.slice(1);if(this.sharedAxes!=null)for(const r of this.sharedAxes)n[r-1]=1;this.alpha=this.addWeight("alpha",n,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const s={};if(this.sharedAxes!=null)for(let r=1;r<e.length;++r)s[r]=e[r];this.inputSpec=[new Wt({ndim:e.length,axes:s})],this.built=!0}call(e,n){return e=ve(e),W1(e,this.alpha.read())}getConfig(){const e={alphaInitializer:yt(this.alphaInitializer),alphaRegularizer:tt(this.alphaRegularizer),alphaConstraint:Ut(this.alphaConstraint),sharedAxes:this.sharedAxes},n=super.getConfig();return Object.assign(e,n),e}}wD.className="PReLU";J(wD);let $D=class extends Re{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA=1,e==null&&(e={}),e.alpha!=null&&e.alpha!==this.DEFAULT_ALPHA)throw new Te(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const s=ve(e);return Ag(s)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}};$D.className="ELU";J($D);class CD extends Re{constructor(e){super(e??{}),this.DEFAULT_THETA=1,e==null&&(e={}),this.theta=e.theta==null?this.DEFAULT_THETA:e.theta}call(e,n){const s=ve(e);return z(s,ce(vs(s,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){const e={theta:this.theta},n=super.getConfig();return Object.assign(e,n),e}}CD.className="ThresholdedReLU";J(CD);class kD extends Re{constructor(e){super(e??{}),this.DEFAULT_AXIS=1,e==null&&(e={}),this.softmax=new qw().apply,this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis}call(e,n){return H(()=>{let s=ve(e);const r=n.mask;if(r!=null){const o=z(ye(vo(s.shape),ce(r,s.dtype)),Ge(-1e9));s=ne(s,o)}return this.axis instanceof Array?this.axis.length>1?Lr(ye(s,fR(s,this.axis,!0))):this.softmax(s,this.axis[0]):this.softmax(s,this.axis)})}computeOutputShape(e){return e}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}kD.className="Softmax";J(kD);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function wl(t,e,n){if(typeof t=="number")return ua(t,e);if(t.length!==e)throw new _(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${t.length} elements.`);for(let s=0;s<e;++s){const r=t[s];if(!B7(r))throw new _(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${JSON.stringify(t)} including a non-integer number ${r}`)}return t}function lr(t,e,n,s,r=1){if(t==null)return t;const o=e+(e-1)*(r-1);let i;return n==="same"?i=t:i=t-o+1,Math.floor((i+s-1)/s)}function kr(t,e,n,s){if(t==null)return null;if(s==="valid")t=t*e+ni([n-e,0]);else if(s==="same")t=t*e;else throw new _(`Unsupport padding mode: ${s}.`);return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Yw(t,e){return H(()=>(Rt(e),e==="channelsFirst"?Oe(t,[0,2,3,1]):t))}function SD(t,e){return H(()=>(Rt(e),e==="channelsFirst"?Oe(t,[0,2,3,4,1]):t))}function aj(t,e,n,s=1,r="valid",o,i=1){return H(()=>{if(o==null&&(o=dr()),Rt(o),t.shape.length!==3)throw new _(`The input of a conv1dWithBias operation should be 3, but is ${t.shape.length} instead.`);if(e.shape.length!==3)throw new _(`The kernel for a conv1dWithBias operation should be 3, but is ${e.shape.length} instead`);if(n!=null&&n.shape.length!==1)throw new _(`The bias for a conv1dWithBias operation should be 1, but is ${n.shape.length} instead`);if(o==="channelsFirst"&&(t=Oe(t,[0,2,1])),r==="causal")throw new Te("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let a=tR(t,e,s,r==="same"?"same":"valid","NWC",i);return n!=null&&(a=pr(a,n)),a})}function yS(t,e,n,s=[1,1],r="valid",o,i,a=null){return H(()=>{if(o==null&&(o=dr()),Rt(o),t.rank!==3&&t.rank!==4)throw new _(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${t.rank}.`);if(e.rank!==3&&e.rank!==4)throw new _(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${t.rank}.`);let l=Yw(t,o);if(r==="causal")throw new Te("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=gG({x:l,filter:e,strides:s,pad:r==="same"?"same":"valid",dilations:i,dataFormat:"NHWC",bias:n,activation:a}),o==="channelsFirst"&&(l=Oe(l,[0,3,1,2])),l})}function lj(t,e,n,s=[1,1,1],r="valid",o,i){return H(()=>{if(o==null&&(o=dr()),Rt(o),t.rank!==4&&t.rank!==5)throw new _(`conv3dWithBias expects input to be of rank 4 or 5, but received ${t.rank}.`);if(e.rank!==4&&e.rank!==5)throw new _(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${t.rank}.`);let a=SD(t,o);if(r==="causal")throw new Te("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return a=mW(a,e,s,r==="same"?"same":"valid","NDHWC",i),n!=null&&(a=pr(a,n)),o==="channelsFirst"&&(a=Oe(a,[0,4,1,2,3])),a})}class Ug extends Re{constructor(e,n){if(super(n),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",Ug.verifyArgs(n),this.rank=e,Qt(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new Te(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=wl(n.kernelSize,e,"kernelSize"),this.strides=wl(n.strides==null?1:n.strides,e,"strides"),this.padding=n.padding==null?"valid":n.padding,bs(this.padding),this.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,Rt(this.dataFormat),this.activation=ri(n.activation),this.useBias=n.useBias==null?!0:n.useBias,this.biasInitializer=pt(n.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=Gt(n.biasConstraint),this.biasRegularizer=mt(n.biasRegularizer),this.activityRegularizer=mt(n.activityRegularizer),this.dilationRate=wl(n.dilationRate==null?1:n.dilationRate,e,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new _(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new _(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new _(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(e){if(Cr("kernelSize"in e,"required key 'kernelSize' not in config"),typeof e.kernelSize!="number"&&!Lw(e.kernelSize,"number",1,3))throw new _(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(e.kernelSize)}.`)}getConfig(){const e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:si(this.activation),useBias:this.useBias,biasInitializer:yt(this.biasInitializer),biasRegularizer:tt(this.biasRegularizer),activityRegularizer:tt(this.activityRegularizer),biasConstraint:Ut(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}class nu extends Ug{constructor(e,n){super(e,n),this.kernel=null,nu.verifyArgs(n),this.filters=n.filters,Qt(this.filters,"filters"),this.kernelInitializer=pt(n.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=Gt(n.kernelConstraint),this.kernelRegularizer=mt(n.kernelRegularizer)}build(e){e=_e(e);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new _(`The channel dimension of the input should be defined. Found ${e[n]}`);const s=e[n],r=this.kernelSize.concat([s,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[n]:s}}],this.built=!0}call(e,n){return H(()=>{e=ve(e);let s;const r=this.bias==null?null:this.bias.read(),o=wA(this.activation.getClassName());if(o!=null&&this.rank===2)s=yS(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate,o);else{if(this.rank===1)s=aj(e,this.kernel.read(),r,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)s=yS(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)s=lj(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new Te("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(s=this.activation.apply(s))}return s})}computeOutputShape(e){e=_e(e);const n=[],s=this.dataFormat==="channelsLast"?e.slice(1,e.length-1):e.slice(2);for(let o=0;o<s.length;++o){const i=lr(s[o],this.kernelSize[o],this.padding,this.strides[o],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[o]);n.push(i)}let r=[e[0]];return this.dataFormat==="channelsLast"?(r=r.concat(n),r.push(this.filters)):(r.push(this.filters),r=r.concat(n)),r}getConfig(){const e={filters:this.filters,kernelInitializer:yt(this.kernelInitializer),kernelRegularizer:tt(this.kernelRegularizer),kernelConstraint:Ut(this.kernelConstraint)},n=super.getConfig();return Object.assign(e,n),e}static verifyArgs(e){if(!("filters"in e)||typeof e.filters!="number"||e.filters<1)throw new _(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(e.filters)}`)}}class df extends nu{constructor(e){super(2,e),df.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!Lw(e.kernelSize,"number",1,2))throw new _(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(e.kernelSize)}.`)}}df.className="Conv2D";J(df);class ff extends nu{constructor(e){super(3,e),ff.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!(Array.isArray(e.kernelSize)&&(e.kernelSize.length===1||e.kernelSize.length===3)))throw new _(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(e.kernelSize)}.`)}}ff.className="Conv3D";J(ff);class ID extends df{constructor(e){if(super(e),this.inputSpec=[new Wt({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new _(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=_e(e),e.length!==4)throw new _("Input should have rank 4; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new _("The channel dimension of the inputs should be defined. Found `None`.");const s=e[n],r=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Wt({ndim:4,axes:{[n]:s}})],this.built=!0}call(e,n){return H(()=>{let s=ve(e);if(s.shape.length!==4)throw new _(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const r=s.shape,o=r[0];let i,a;this.dataFormat==="channelsFirst"?(i=2,a=3):(i=1,a=2);const l=r[i],u=r[a],c=this.kernelSize[0],d=this.kernelSize[1],f=this.strides[0],h=this.strides[1],p=kr(l,f,c,this.padding),g=kr(u,h,d,this.padding),y=[o,p,g,this.filters];this.dataFormat!=="channelsLast"&&(s=Oe(s,[0,2,3,1]));let m=nR(s,this.kernel.read(),y,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(m=Oe(m,[0,3,1,2])),this.bias!=null&&(m=pr(m,this.bias.read(),this.dataFormat)),this.activation!=null&&(m=this.activation.apply(m)),m})}computeOutputShape(e){e=_e(e);const n=e.slice();let s,r,o;this.dataFormat==="channelsFirst"?(s=1,r=2,o=3):(s=3,r=1,o=2);const i=this.kernelSize[0],a=this.kernelSize[1],l=this.strides[0],u=this.strides[1];return n[s]=this.filters,n[r]=kr(n[r],l,i,this.padding),n[o]=kr(n[o],u,a,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}ID.className="Conv2DTranspose";J(ID);class TD extends ff{constructor(e){if(super(e),this.inputSpec=[new Wt({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new _(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=_e(e),e.length!==5)throw new _("Input should have rank 5; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new _("The channel dimension of the inputs should be defined. Found `None`.");const s=e[n],r=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Wt({ndim:5,axes:{[n]:s}})],this.built=!0}call(e,n){return H(()=>{let s=ve(e);if(s.shape.length!==5)throw new _(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const r=s.shape,o=r[0];let i,a,l;this.dataFormat==="channelsFirst"?(l=2,i=3,a=4):(l=1,i=2,a=3);const u=r[l],c=r[i],d=r[a],f=this.kernelSize[0],h=this.kernelSize[1],p=this.kernelSize[2],g=this.strides[0],y=this.strides[1],m=this.strides[2],x=kr(u,g,f,this.padding),v=kr(c,y,h,this.padding),b=kr(d,m,p,this.padding),$=[o,x,v,b,this.filters];this.dataFormat!=="channelsLast"&&(s=Oe(s,[0,2,3,4,1]));let C=yW(s,this.kernel.read(),$,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(C=Oe(C,[0,4,1,2,3])),this.bias!==null&&(C=pr(C,this.bias.read(),this.dataFormat)),this.activation!==null&&(C=this.activation.apply(C)),C})}computeOutputShape(e){e=_e(e);const n=e.slice();let s,r,o,i;this.dataFormat==="channelsFirst"?(s=1,r=2,o=3,i=4):(s=4,r=1,o=2,i=3);const a=this.kernelSize[0],l=this.kernelSize[1],u=this.kernelSize[2],c=this.strides[0],d=this.strides[1],f=this.strides[2];return n[s]=this.filters,n[r]=kr(n[r],c,a,this.padding),n[o]=kr(n[o],d,l,this.padding),n[i]=kr(n[i],f,u,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}TD.className="Conv3DTranspose";J(TD);class ED extends nu{constructor(e,n){if(super(e,n),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,n.filters==null)throw new _("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(n.kernelInitializer!=null||n.kernelRegularizer!=null||n.kernelConstraint!=null)throw new _("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(n.padding!=null&&n.padding!=="same"&&n.padding!=="valid")throw new _(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(n.padding)}`);this.depthMultiplier=n.depthMultiplier==null?1:n.depthMultiplier,this.depthwiseInitializer=pt(n.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=mt(n.depthwiseRegularizer),this.depthwiseConstraint=Gt(n.depthwiseConstraint),this.pointwiseInitializer=pt(n.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=mt(n.pointwiseRegularizer),this.pointwiseConstraint=Gt(n.pointwiseConstraint)}build(e){if(e=_e(e),e.length<this.rank+2)throw new _(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null||e[n]<0)throw new _(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[n])}`);const s=e[n],r=this.kernelSize.concat([s,this.depthMultiplier]),o=[];for(let a=0;a<this.rank;++a)o.push(1);o.push(s*this.depthMultiplier,this.filters);const i=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,i,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",o,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,i,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,i,this.biasConstraint):this.bias=null,this.inputSpec=[new Wt({ndim:this.rank+2,axes:{[n]:s}})],this.built=!0}call(e,n){return H(()=>{e=ve(e);let s;if(this.rank===1)throw new Te("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(e=Oe(e,[0,2,3,1])),s=wR(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(s=pr(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),this.dataFormat==="channelsFirst"&&(s=Oe(s,[0,3,1,2])),s})}getConfig(){const e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=yt(this.depthwiseInitializer),e.pointwiseInitializer=yt(this.pointwiseInitializer),e.depthwiseRegularizer=tt(this.depthwiseRegularizer),e.pointwiseRegularizer=tt(this.pointwiseRegularizer),e.depthwiseConstraint=Ut(this.depthwiseConstraint),e.pointwiseConstraint=Ut(this.pointwiseConstraint),e}}ED.className="SeparableConv";class ND extends ED{constructor(e){super(2,e)}}ND.className="SeparableConv2D";J(ND);class Gg extends nu{constructor(e){super(1,e),Gg.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){const e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!Lw(e.kernelSize,"number",1,1))throw new _(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(e.kernelSize)}.`)}}Gg.className="Conv1D";J(Gg);class RD extends Re{constructor(e){super(e),typeof e.cropping=="number"?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]=="number"?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=e.dataFormat===void 0?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return this.dataFormat==="channelsFirst"?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,n){return H(()=>{if(e=ve(e),this.dataFormat==="channelsLast"){const s=qf(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return qf(s,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const s=qf(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return qf(s,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const e={cropping:this.cropping,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}RD.className="Cropping2D";J(RD);class AD extends Re{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=e.size==null?this.DEFAULT_SIZE:e.size,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Rt(this.dataFormat),this.interpolation=e.interpolation==null?"nearest":e.interpolation,_7(this.interpolation)}computeOutputShape(e){if(this.dataFormat==="channelsFirst"){const n=e[2]==null?null:this.size[0]*e[2],s=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],n,s]}else{const n=e[1]==null?null:this.size[0]*e[1],s=e[2]==null?null:this.size[1]*e[2];return[e[0],n,s,e[3]]}}call(e,n){return H(()=>{let s=ve(e);const r=s.shape;if(this.dataFormat==="channelsFirst"){s=Oe(s,[0,2,3,1]);const o=this.size[0]*r[2],i=this.size[1]*r[3],a=this.interpolation==="nearest"?eo.resizeNearestNeighbor(s,[o,i]):eo.resizeBilinear(s,[o,i]);return Oe(a,[0,3,1,2])}else{const o=this.size[0]*r[1],i=this.size[1]*r[2];return this.interpolation==="nearest"?eo.resizeNearestNeighbor(s,[o,i]):eo.resizeBilinear(s,[o,i])}})}getConfig(){const e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},n=super.getConfig();return Object.assign(e,n),e}}AD.className="UpSampling2D";J(AD);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function uj(t,e,n=[1,1],s="valid",r,o){return H(()=>{r==null&&(r=dr()),Rt(r);let i=Yw(t,r);if(t.rank!==4)throw new _(`Input for depthwiseConv2d is required to be 4-D, but is instead ${t.rank}-D`);if(e.rank!==4)throw new _(`depthwiseKernel is required to be 4-D, but is instead ${e.rank}-D`);return i=D1(i,e,n,s==="same"?"same":"valid","NHWC",o),r==="channelsFirst"&&(i=Oe(i,[0,3,1,2])),i})}class DD extends Ug{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=pt(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=Gt(e.depthwiseConstraint),this.depthwiseRegularizer=mt(e.depthwiseRegularizer)}build(e){if(e=_e(e),e.length<4)throw new _(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);const n=this.dataFormat==="channelsFirst"?1:3;if(e[n]==null||e[n]<0)throw new _(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[n]}).`);const s=e[n],r=[this.kernelSize[0],this.kernelSize[1],s,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[s*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return H(()=>{e=ve(e);let s=uj(e,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(s=pr(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),s})}computeOutputShape(e){e=_e(e);const n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2],r=this.dataFormat==="channelsFirst"?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,o=lr(n,this.kernelSize[0],this.padding,this.strides[0]),i=lr(s,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[e[0],r,o,i]:[e[0],o,i,r]}getConfig(){const e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=yt(this.depthwiseInitializer),e.depthwiseRegularizer=tt(this.depthwiseRegularizer),e.depthwiseConstraint=Ut(this.depthwiseRegularizer),e}}DD.className="DepthwiseConv2D";J(DD);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function FD(t,e,n,s){if(Array.isArray(t)){if(e!=null||n!=null)throw new _("When inputs is an array, neither initialState or constants should be provided");s!=null&&(n=t.slice(t.length-s,t.length),t=t.slice(0,t.length-s)),t.length>1&&(e=t.slice(1,t.length)),t=t[0]}function r(o){return o==null||Array.isArray(o)?o:[o]}return e=r(e),n=r(n),{inputs:t,initialState:e,constants:n}}function PD(t,e,n,s=!1,r,o,i=!1,a=!1){return H(()=>{const l=e.shape.length;if(l<3)throw new _(`Input should be at least 3D, but is ${l}D.`);const u=[1,0].concat(cr(2,l));e=Oe(e,u),i&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),r!=null&&(r=ce(ce(r,"bool"),"float32"),r.rank===l-1&&(r=Mn(r,-1)),r=Oe(r,u)),s&&(e=aa(e,0),r!=null&&(r=aa(r,0)));const c=[];let d,f=n;const h=e.shape[0],p=la(e);let g;r!=null&&(g=la(r));for(let m=0;m<h;++m){const x=p[m],v=H(()=>t(x,f));if(r==null)d=v[0],f=v[1];else{const b=H(()=>{const $=g[m],C=ye(Us($),$),k=ne(z(v[0],$),z(f[0],C)),w=f.map((I,R)=>ne(z(v[1][R],$),z(I,C)));return{output:k,newStates:w}});d=b.output,f=b.newStates}a&&c.push(d)}let y;return a&&(y=co(c,1)),[d,y,f]})}class gi extends Re{constructor(e){super(e);let n;if(e.cell==null)throw new _("cell property is missing for the constructor of RNN.");if(Array.isArray(e.cell)?n=new Jw({cells:e.cell}):n=e.cell,n.stateSize==null)throw new _("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=n,this.returnSequences=e.returnSequences==null?!1:e.returnSequences,this.returnState=e.returnState==null?!1:e.returnState,this.goBackwards=e.goBackwards==null?!1:e.goBackwards,this._stateful=e.stateful==null?!1:e.stateful,this.unroll=e.unroll==null?!1:e.unroll,this.supportsMasking=!0,this.inputSpec=[new Wt({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return cr(0,e).map(n=>null)}else return this.states_}setStates(e){this.states_=e}computeOutputShape(e){Gy(e)&&(e=e[0]),e=e;let n=this.cell.stateSize;Array.isArray(n)||(n=[n]);const s=n[0];let r;if(this.returnSequences?r=[e[0],e[1],s]:r=[e[0],s],this.returnState){const o=[];for(const i of n)o.push([e[0],i]);return[r].concat(o)}else return r}computeMask(e,n){return H(()=>{Array.isArray(n)&&(n=n[0]);const s=this.returnSequences?n:null;if(this.returnState){const r=this.states.map(o=>null);return[s].concat(r)}else return s})}get states(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,n=[];for(let s=0;s<e;++s)n.push(null);return n}else return this.states_}set states(e){this.states_=e}build(e){if(this.numConstants!=null)throw new Te("Constants support is not implemented in RNN yet.");Gy(e)&&(e=e[0]),e=e;const n=this.stateful?e[0]:null,s=e.slice(2);this.inputSpec[0]=new Wt({shape:[n,null,...s]});const r=[e[0]].concat(e.slice(2));this.cell.build(r);let o;if(Array.isArray(this.cell.stateSize)?o=this.cell.stateSize:o=[this.cell.stateSize],this.stateSpec!=null){if(!He(this.stateSpec.map(i=>i.shape[i.shape.length-1]),o))throw new _(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=o.map(i=>new Wt({shape:[null,i]}));this.stateful&&this.resetStates()}resetStates(e,n=!1){H(()=>{if(!this.stateful)throw new $r("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape[0];if(s==null)throw new _("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>xt([s,r])):this.states_=[xt([s,this.cell.stateSize])];else if(e==null)Ae(this.states_),this.keptStates!=null&&(Ae(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>xt([s,r])):this.states_[0]=xt([s,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new _(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n===!0?this.keptStates.push(this.states_.slice()):Ae(this.states_);for(let r=0;r<this.states_.length;++r){const o=e[r],i=Array.isArray(this.cell.stateSize)?this.cell.stateSize[r]:this.cell.stateSize,a=[s,i];if(!He(o.shape,a))throw new _(`State ${r} is incompatible with layer ${this.name}: expected shape=${a}, received shape=${o.shape}`);this.states_[r]=o}}this.states_=this.states_.map(r=>Rr(r.clone()))})}apply(e,n){let s=n==null?null:n.initialState,r=n==null?null:n.constants;n==null&&(n={});const o=FD(e,s,r,this.numConstants);e=o.inputs,s=o.initialState,r=o.constants;let i=[],a=[];if(s!=null){n.initialState=s,i=i.concat(s),this.stateSpec=[];for(const u of s)this.stateSpec.push(new Wt({shape:u.shape}));a=a.concat(this.stateSpec)}if(r!=null&&(n.constants=r,i=i.concat(r),this.numConstants=r.length),i[0]instanceof _r){const u=[e].concat(i),c=this.inputSpec.concat(a),d=this.inputSpec;this.inputSpec=c;const f=super.apply(u,n);return this.inputSpec=d,f}else return super.apply(e,n)}call(e,n){return H(()=>{const s=n==null?null:n.mask,r=n==null?null:n.training;let o=n==null?null:n.initialState;e=ve(e),o==null&&(this.stateful?o=this.states_:o=this.getInitialState(e));const i=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(o.length!==i)throw new _(`RNN Layer has ${i} state(s) but was passed ${o.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const a={training:r},u=PD((p,g)=>{const y=this.cell.call([p].concat(g),a);return[y[0],y.slice(1)]},e,o,this.goBackwards,s,null,this.unroll,this.returnSequences),c=u[0],d=u[1],f=u[2];this.stateful&&this.resetStates(f,r);const h=this.returnSequences?d:c;return this.returnState?[h].concat(f):h})}getInitialState(e){return H(()=>{let n=xt(e.shape);return n=ge(n,[1,2]),n=of(n),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(s=>s>1?Wy(n,[1,s]):n):this.cell.stateSize>1?[Wy(n,[1,this.cell.stateSize])]:[n]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){const e=super.getConfig(),n={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(n.numConstants=this.numConstants);const s=this.cell.getConfig();return this.getClassName()===gi.className&&(n.cell={className:this.cell.getClassName(),config:s}),Object.assign(Object.assign(Object.assign({},s),e),n)}static fromConfig(e,n,s={}){const r=n.cell,o=so(r,s);return new e(Object.assign(n,{cell:o}))}}gi.className="RNN";J(gi);class Hg extends Re{}class Qw extends Hg{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,Qt(this.units,"units"),this.activation=ri(e.activation==null?this.DEFAULT_ACTIVATION:e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=pt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=pt(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=pt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=mt(e.kernelRegularizer),this.recurrentRegularizer=mt(e.recurrentRegularizer),this.biasRegularizer=mt(e.biasRegularizer),this.kernelConstraint=Gt(e.kernelConstraint),this.recurrentConstraint=Gt(e.recurrentConstraint),this.biasConstraint=Gt(e.biasConstraint),this.dropout=Ml([1,ni([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Ml([1,ni([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=_e(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return H(()=>{if(e=e,e.length!==2)throw new _(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let s=e[1];e=e[0];const r=n.training==null?!1:n.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=oi({ones:()=>Us(e),rate:this.dropout,training:r,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=oi({ones:()=>Us(s),rate:this.recurrentDropout,training:r,dropoutFunc:this.dropoutFunc}));let o;const i=this.dropoutMask,a=this.recurrentDropoutMask;i!=null?o=Fr(z(e,i),this.kernel.read()):o=Fr(e,this.kernel.read()),this.bias!=null&&(o=pr(o,this.bias.read())),a!=null&&(s=z(s,a));let l=ne(o,Fr(s,this.recurrentKernel.read()));return this.activation!=null&&(l=this.activation.apply(l)),[l,l]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:si(this.activation),useBias:this.useBias,kernelInitializer:yt(this.kernelInitializer),recurrentInitializer:yt(this.recurrentInitializer),biasInitializer:yt(this.biasInitializer),kernelRegularizer:tt(this.kernelRegularizer),recurrentRegularizer:tt(this.recurrentRegularizer),biasRegularizer:tt(this.biasRegularizer),activityRegularizer:tt(this.activityRegularizer),kernelConstraint:Ut(this.kernelConstraint),recurrentConstraint:Ut(this.recurrentConstraint),biasConstraint:Ut(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),n)}}Qw.className="SimpleRNNCell";J(Qw);class OD extends gi{constructor(e){e.cell=new Qw(e),super(e)}call(e,n){return H(()=>{this.cell.dropoutMask!=null&&(Ae(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Ae(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,r=n==null?null:n.training,o=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:o})})}static fromConfig(e,n){return new e(n)}}OD.className="SimpleRNN";J(OD);class Zw extends Hg{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new _("GRUCell does not support reset_after parameter set to true.");this.units=e.units,Qt(this.units,"units"),this.activation=ri(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=ri(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=pt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=pt(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=pt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=mt(e.kernelRegularizer),this.recurrentRegularizer=mt(e.recurrentRegularizer),this.biasRegularizer=mt(e.biasRegularizer),this.kernelConstraint=Gt(e.kernelConstraint),this.recurrentConstraint=Gt(e.recurrentConstraint),this.biasConstraint=Gt(e.biasConstraint),this.dropout=Ml([1,ni([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Ml([1,ni([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=_e(e);const n=e[e.length-1];this.kernel=this.addWeight("kernel",[n,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return H(()=>{if(e=e,e.length!==2)throw new _(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);const s=n.training==null?!1:n.training;let r=e[1];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=oi({ones:()=>Us(e),rate:this.dropout,training:s,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=oi({ones:()=>Us(r),rate:this.recurrentDropout,training:s,count:3,dropoutFunc:this.dropoutFunc}));const o=this.dropoutMask,i=this.recurrentDropoutMask;let a,l,u;0<this.dropout&&this.dropout<1&&(e=z(e,o[0]));let c=Fr(e,this.kernel.read());this.useBias&&(c=pr(c,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(r=z(r,i[0]));const d=this.recurrentKernel.read(),[f,h]=ps(d,[2*this.units,this.units],d.rank-1),p=Fr(r,f),[g,y,m]=ps(c,3,c.rank-1),[x,v]=ps(p,2,p.rank-1);a=this.recurrentActivation.apply(ne(g,x)),l=this.recurrentActivation.apply(ne(y,v));const b=Fr(z(l,r),h);u=this.activation.apply(ne(m,b));const $=ne(z(a,r),z(ne(1,Tt(a)),u));return[$,$]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:si(this.activation),recurrentActivation:si(this.recurrentActivation),useBias:this.useBias,kernelInitializer:yt(this.kernelInitializer),recurrentInitializer:yt(this.recurrentInitializer),biasInitializer:yt(this.biasInitializer),kernelRegularizer:tt(this.kernelRegularizer),recurrentRegularizer:tt(this.recurrentRegularizer),biasRegularizer:tt(this.biasRegularizer),activityRegularizer:tt(this.activityRegularizer),kernelConstraint:Ut(this.kernelConstraint),recurrentConstraint:Ut(this.recurrentConstraint),biasConstraint:Ut(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),n)}}Zw.className="GRUCell";J(Zw);class LD extends gi{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new Zw(e),super(e)}call(e,n){return H(()=>{this.cell.dropoutMask!=null&&(Ae(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Ae(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,r=n==null?null:n.training,o=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:o})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}LD.className="GRU";J(LD);class jg extends Hg{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,Qt(this.units,"units"),this.activation=ri(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=ri(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=pt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=pt(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=pt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=mt(e.kernelRegularizer),this.recurrentRegularizer=mt(e.recurrentRegularizer),this.biasRegularizer=mt(e.biasRegularizer),this.kernelConstraint=Gt(e.kernelConstraint),this.recurrentConstraint=Gt(e.recurrentConstraint),this.biasConstraint=Gt(e.biasConstraint),this.dropout=Ml([1,ni([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Ml([1,ni([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var n;e=_e(e);const s=e[e.length-1];this.kernel=this.addWeight("kernel",[s,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let r;if(this.useBias){if(this.unitForgetBias){const o=this.biasInitializer,i=this.units;r=new(n=class extends Hs{apply(l,u){const c=o.apply([i]),d=new _w().apply([i]),f=o.apply([i*2]);return tS(tS(c,d),f)}},n.className="CustomInit",n)}else r=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,r,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,n){return H(()=>{const s=n.training==null?!1:n.training;if(e=e,e.length!==3)throw new _(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let r=e[1];const o=e[2];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=oi({ones:()=>Us(e),rate:this.dropout,training:s,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=oi({ones:()=>Us(r),rate:this.recurrentDropout,training:s,count:4,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,a=this.recurrentDropoutMask;let l,u,c,d;0<this.dropout&&this.dropout<1&&(e=z(e,i[0]));let f=Fr(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(r=z(r,a[0])),f=ne(f,Fr(r,this.recurrentKernel.read())),this.useBias&&(f=pr(f,this.bias.read()));const[h,p,g,y]=ps(f,4,f.rank-1);l=this.recurrentActivation.apply(h),u=this.recurrentActivation.apply(p),c=ne(z(u,o),z(l,this.activation.apply(g))),d=this.recurrentActivation.apply(y);const m=z(d,this.activation.apply(c));return[m,m,c]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:si(this.activation),recurrentActivation:si(this.recurrentActivation),useBias:this.useBias,kernelInitializer:yt(this.kernelInitializer),recurrentInitializer:yt(this.recurrentInitializer),biasInitializer:yt(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:tt(this.kernelRegularizer),recurrentRegularizer:tt(this.recurrentRegularizer),biasRegularizer:tt(this.biasRegularizer),activityRegularizer:tt(this.activityRegularizer),kernelConstraint:Ut(this.kernelConstraint),recurrentConstraint:Ut(this.recurrentConstraint),biasConstraint:Ut(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),n)}}jg.className="LSTMCell";J(jg);class MD extends gi{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new jg(e),super(e)}call(e,n){return H(()=>{this.cell.dropoutMask!=null&&(Ae(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Ae(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,r=n==null?null:n.training,o=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:o})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}MD.className="LSTM";J(MD);class Jw extends Hg{constructor(e){super(e),this.cells=e.cells}get stateSize(){const e=[];for(const n of this.cells.slice().reverse())Array.isArray(n.stateSize)?e.push(...n.stateSize):e.push(n.stateSize);return e}call(e,n){return H(()=>{e=e;let s=e.slice(1);const r=[];for(const a of this.cells.slice().reverse())Array.isArray(a.stateSize)?r.push(s.splice(0,a.stateSize.length)):r.push(s.splice(0,1));r.reverse();const o=[];let i;for(let a=0;a<this.cells.length;++a){const l=this.cells[a];s=r[a],a===0?i=[e[0]].concat(s):i=[i[0]].concat(s),i=l.call(i,n),o.push(i.slice(1))}s=[];for(const a of o.slice().reverse())s.push(...a);return[i[0]].concat(s)})}build(e){Gy(e)&&(e=e[0]),e=e;let n;this.cells.forEach((s,r)=>{Gi(`RNNCell_${r}`,()=>{s.build(e),Array.isArray(s.stateSize)?n=s.stateSize[0]:n=s.stateSize,e=[e[0],n]})}),this.built=!0}getConfig(){const e=super.getConfig(),n=o=>({className:o.getClassName(),config:o.getConfig()}),r={cells:this.cells.map(n)};return Object.assign(Object.assign({},e),r)}static fromConfig(e,n,s={}){const r=[];for(const o of n.cells)r.push(so(o,s));return new e({cells:r})}get trainableWeights(){if(!this.trainable)return[];const e=[];for(const n of this.cells)e.push(...n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.cells)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const s of this.cells)n.push(...s.trainableWeights);return n.concat(e)}return e}getWeights(){const e=[];for(const n of this.cells)e.push(...n.weights);return Hy(e)}setWeights(e){const n=[];for(const s of this.cells){const r=s.weights.length,o=e.splice(r);for(let i=0;i<s.weights.length;++i)n.push([s.weights[i],o[i]])}Hw(n)}}Jw.className="StackedRNNCells";J(Jw);function oi(t){const{ones:e,rate:n,training:s=!1,count:r=1,dropoutFunc:o}=t,i=()=>o!=null?o(e(),n):EA(e(),n),a=()=>lf(i,e,s);return!r||r<=1?Rr(a().clone()):Array(r).fill(void 0).map(a).map(u=>Rr(u.clone()))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var cj=function(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(t);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(t,s[r])&&(n[s[r]]=t[s[r]]);return n};class _D extends gi{constructor(e){if(e.unroll)throw new Te("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new Te("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new Wt({ndim:5})]}call(e,n){return H(()=>{if(this.cell.dropoutMask!=null&&(Ae(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Ae(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),n&&n.constants)throw new _("ConvRNN2D cell does not support constants");const s=n==null?null:n.mask,r=n==null?null:n.training,o=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:o})})}computeOutputShape(e){let n=this.computeSingleOutputShape(e);return this.returnSequences||(n=[n[0],...n.slice(2)]),this.returnState&&(n=[n,...Array(2).fill([e[0],...n.slice(-3)])]),n}getInitialState(e){return H(()=>{const{stateSize:n}=this.cell,s=e.shape,r=this.computeSingleOutputShape(s),o=[r[0],...r.slice(2)],i=xt(o);return Array.isArray(n)?Array(n.length).fill(i):[i]})}resetStates(e,n=!1){H(()=>{if(!this.stateful)throw new $r("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape,r=this.computeSingleOutputShape(s),o=[r[0],...r.slice(2)];if(s[0]==null)throw new _("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>xt(o)):this.states_=[xt(o)];else if(e==null)Ae(this.states_),this.keptStates!=null&&(Ae(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>xt(o)):this.states_[0]=xt(o);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new _(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n?this.keptStates.push(this.states_.slice()):Ae(this.states_);for(let a=0;a<this.states_.length;++a){const l=e[a],u=o;if(!He(l.shape,u))throw new _(`State ${a} is incompatible with layer ${this.name}: expected shape=${u}, received shape=${l.shape}`);this.states_[a]=l}}this.states_=this.states_.map(a=>Rr(a.clone()))})}computeSingleOutputShape(e){const{dataFormat:n,filters:s,kernelSize:r,padding:o,strides:i,dilationRate:a}=this.cell,l=n==="channelsFirst",u=e[l?3:2],c=e[l?4:3],d=lr(u,r[0],o,i[0],a[0]),f=lr(c,r[1],o,i[1],a[1]);return[...e.slice(0,2),...l?[s,d,f]:[d,f,s]]}}_D.className="ConvRNN2D";class e$ extends jg{constructor(e){const{filters:n,kernelSize:s,strides:r,padding:o,dataFormat:i,dilationRate:a}=e;super(Object.assign(Object.assign({},e),{units:n})),this.filters=n,Qt(this.filters,"filters"),this.kernelSize=wl(s,2,"kernelSize"),this.kernelSize.forEach(l=>Qt(l,"kernelSize")),this.strides=wl(r||1,2,"strides"),this.strides.forEach(l=>Qt(l,"strides")),this.padding=o||"valid",bs(this.padding),this.dataFormat=i||"channelsLast",Rt(this.dataFormat),this.dilationRate=wl(a||1,2,"dilationRate"),this.dilationRate.forEach(l=>Qt(l,"dilationRate"))}build(e){var n;e=_e(e);const s=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[s]==null)throw new _(`The channel dimension of the input should be defined. Found ${e[s]}`);const r=e[s],o=4,i=this.kernelSize.concat([r,this.filters*o]);this.kernel=this.addWeight("kernel",i,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const a=this.kernelSize.concat([this.filters,this.filters*o]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",a,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let l;if(this.unitForgetBias){const u=this.biasInitializer,c=this.filters;l=new(n=class extends Hs{apply(f,h){const p=u.apply([c]),g=vo([c]),y=u.apply([c*2]);return Mw([p,g,y])}},n.className="CustomInit",n)}else l=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*o],null,l,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,n){return H(()=>{if(e.length!==3)throw new _(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);const s=n.training||!1,r=e[0],o=e[1],i=e[2],a=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=oi({ones:()=>Us(r),rate:this.dropout,training:s,count:a,dropoutFunc:this.dropoutFunc}));const l=this.dropoutMask,u=(G,X,Q)=>!X||!X[Q]?G:z(X[Q],G);let c=u(r,l,0),d=u(r,l,1),f=u(r,l,2),h=u(r,l,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=oi({ones:()=>Us(o),rate:this.recurrentDropout,training:s,count:a,dropoutFunc:this.dropoutFunc}));const p=this.recurrentDropoutMask;let g=u(o,p,0),y=u(o,p,1),m=u(o,p,2),x=u(o,p,3);const v=3,[b,$,C,k]=ps(this.kernel.read(),a,v),[w,I,R,E]=this.useBias?ps(this.bias.read(),a):[null,null,null,null];c=this.inputConv(c,b,w,this.padding),d=this.inputConv(d,$,I,this.padding),f=this.inputConv(f,C,R,this.padding),h=this.inputConv(h,k,E,this.padding);const[A,S,T,F]=ps(this.recurrentKernel.read(),a,v);g=this.recurrentConv(g,A),y=this.recurrentConv(y,S),m=this.recurrentConv(m,T),x=this.recurrentConv(x,F);const M=this.recurrentActivation.apply(ne(c,g)),U=this.recurrentActivation.apply(ne(d,y)),P=ne(z(U,i),z(M,this.activation.apply(ne(f,m)))),L=z(this.recurrentActivation.apply(ne(h,x)),this.activation.apply(P));return[L,L,P]})}getConfig(){const e=super.getConfig(),n=cj(e,["units"]),s={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},n),s)}inputConv(e,n,s,r){const o=oa(e,n,this.strides,r||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return s?pr(o,s,this.dataFormat):o}recurrentConv(e,n){return oa(e,n,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}e$.className="ConvLSTM2DCell";J(e$);class zD extends _D{constructor(e){const n=new e$(e);super(Object.assign(Object.assign({},e),{cell:n}))}static fromConfig(e,n){return new e(n)}}zD.className="ConvLSTM2D";J(zD);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class t$ extends Re{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(this.noiseShape==null)return this.noiseShape;const n=e.shape,s=[];for(let r=0;r<this.noiseShape.length;++r)s.push(this.noiseShape[r]==null?n[r]:this.noiseShape[r]);return s}call(e,n){return H(()=>{this.invokeCallHook(e,n);const s=ve(e);if(0<this.rate&&this.rate<1){const r=n.training==null?!1:n.training,o=this.getNoiseShape(s);return lf(()=>EA(s,this.rate,o,this.seed),()=>s,r)}return e})}getConfig(){const e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},n=super.getConfig();return Object.assign(e,n),e}dispose(){return super.dispose()}}t$.className="Dropout";J(t$);class VD extends t${constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){const n=e.shape;return[n[0],1,n[2]]}}VD.className="SpatialDropout1D";J(VD);class BD extends Re{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){let n=null;e.batchSize!=null&&(n=e.batchSize),this.batchInputShape=[n,e.inputDim]}this.units=e.units,Qt(this.units,"units"),this.activation=ri(e.activation),e.useBias!=null&&(this.useBias=e.useBias),this.kernelInitializer=pt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=pt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=Gt(e.kernelConstraint),this.biasConstraint=Gt(e.biasConstraint),this.kernelRegularizer=mt(e.kernelRegularizer),this.biasRegularizer=mt(e.biasRegularizer),this.activityRegularizer=mt(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){e=_e(e);const n=e[e.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[n,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:n}}],this.built=!0}computeOutputShape(e){e=_e(e);const n=e.slice();return n[n.length-1]=this.units,n}call(e,n){return H(()=>{this.invokeCallHook(e,n);const s=ve(e),r=wA(this.activation.getClassName());let o;return r!=null?o=Fr(s,this.kernel.read(),r,this.bias?this.bias.read():null):(o=Fr(s,this.kernel.read()),this.bias!=null&&(o=pr(o,this.bias.read())),this.activation!=null&&(o=this.activation.apply(o))),o})}getConfig(){const e={units:this.units,activation:si(this.activation),useBias:this.useBias,kernelInitializer:yt(this.kernelInitializer),biasInitializer:yt(this.biasInitializer),kernelRegularizer:tt(this.kernelRegularizer),biasRegularizer:tt(this.biasRegularizer),activityRegularizer:tt(this.activityRegularizer),kernelConstraint:Ut(this.kernelConstraint),biasConstraint:Ut(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}BD.className="Dense";J(BD);class WD extends Re{constructor(e){e=e||{},super(e),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=_e(e);for(const n of e.slice(1))if(n==null)throw new _(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],Yo(e,1)]}call(e,n){return H(()=>{this.invokeCallHook(e,n);let s=ve(e);if(this.dataFormat==="channelsFirst"&&s.rank>1){const r=[0];for(let o=2;o<s.rank;++o)r.push(o);r.push(1),s=Oe(s,r)}return G7(s)})}getConfig(){const e={};this.dataFormat!=null&&(e.dataFormat=this.dataFormat);const n=super.getConfig();return Object.assign(e,n),e}}WD.className="Flatten";J(WD);class UD extends Re{constructor(e){super(e),this.supportsMasking=!0,this.activation=ri(e.activation)}call(e,n){return H(()=>{this.invokeCallHook(e,n);const s=ve(e);return this.activation.apply(s)})}getConfig(){const e={activation:si(this.activation)},n=super.getConfig();return Object.assign(e,n),e}}UD.className="Activation";J(UD);class GD extends Re{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,n){return H(()=>(e=ve(e),W7(e,this.n)))}getConfig(){const e={n:this.n},n=super.getConfig();return Object.assign(e,n),e}}GD.className="RepeatVector";J(GD);class HD extends Re{constructor(e){super(e),this.targetShape=e.targetShape;for(let n=0;n<this.targetShape.length;++n)this.isUnknown(this.targetShape[n])&&(this.targetShape[n]=null)}isUnknown(e){return e<0||e==null}fixUnknownDimension(e,n){const s="Total size of new array must be unchanged.",r=n.slice();let o=1,i=null;for(let l=0;l<r.length;++l){const u=r[l];if(this.isUnknown(u))if(i===null)i=l;else throw new _("Can only specifiy one unknown dimension.");else o*=u}const a=Yo(e);if(i!==null){if(o===0||a%o!==0)throw new _(s);r[i]=a/o}else if(a!==o)throw new _(s);return r}computeOutputShape(e){let n=!1;for(let s=0;s<e.length;++s)if(this.isUnknown(e[s])){n=!0;break}return n?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,n){return H(()=>{this.invokeCallHook(e,n);const s=ve(e),r=s.shape,o=r.slice(0,1).concat(this.fixUnknownDimension(r.slice(1),this.targetShape));return B(s,o)})}getConfig(){const e={targetShape:this.targetShape},n=super.getConfig();return Object.assign(e,n),e}}HD.className="Reshape";J(HD);class jD extends Re{constructor(e){if(super(e),e.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);const n=cr(1,e.dims.length+1);if(!He(e.dims.slice().sort(),n))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new Wt({ndim:this.dims.length+1})]}computeOutputShape(e){e=_e(e);const n=e.slice();return this.dims.forEach((s,r)=>{n[r+1]=e[s]}),n}call(e,n){return Oe(ve(e),this.dimsIncludingBatch)}getConfig(){const e={dims:this.dims},n=super.getConfig();return Object.assign(e,n),e}}jD.className="Permute";J(jD);class KD extends Re{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null?this.maskValue=e.maskValue==null?0:e.maskValue:this.maskValue=0}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={maskValue:this.maskValue};return Object.assign(n,e),n}computeMask(e,n){const s=ve(e);return Oy(yp(s,this.maskValue),-1)}call(e,n){return H(()=>{this.invokeCallHook(e,n);const s=ve(e),i=Oy(yp(s,this.maskValue),-1,!0);return z(s,ce(i,s.dtype))})}}KD.className="Masking";J(KD);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class XD extends Re{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",e.batchInputShape==null&&e.inputShape==null){let n=null;e.batchSize!=null&&(n=e.batchSize),e.inputLength==null?this.batchInputShape=[n,null]:this.batchInputShape=[n].concat(Ke(e.inputLength))}this.inputDim=e.inputDim,Qt(this.inputDim,"inputDim"),this.outputDim=e.outputDim,Qt(this.outputDim,"outputDim"),this.embeddingsInitializer=pt(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=mt(e.embeddingsRegularizer),this.activityRegularizer=mt(e.activityRegularizer),this.embeddingsConstraint=Gt(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,n){return H(()=>this.maskZero?(e=ve(e),yp(e,Le(e))):null)}computeOutputShape(e){if(e=_e(e),this.inputLength==null)return[...e,this.outputDim];const n=Ke(this.inputLength);if(n.length!==e.length-1)throw new _(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let s=0;for(let r=0;r<n.length;++r){const o=n[r],i=e[r+1];if(o!=null&&i!=null&&o!==i)throw new _(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);o==null&&(n[s]=i),s++}}return[e[0],...n,this.outputDim]}call(e,n){return H(()=>{this.invokeCallHook(e,n);let s=ve(e);s.dtype!=="int32"&&(s=Dr(s,"int32"));const r=TA(this.embeddings.read(),B(s,[s.size]));return B(r,_e(this.computeOutputShape(s.shape)))})}getConfig(){const e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:yt(this.embeddingsInitializer),embeddingsRegularizer:tt(this.embeddingsRegularizer),activityRegularizer:tt(this.activityRegularizer),embeddingsConstraint:Ut(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},n=super.getConfig();return Object.assign(e,n),e}}XD.className="Embedding";J(XD);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Na extends Re{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new Te}computeElementwiseOpOutputShape(e,n){if(e==null||n==null)return null;if(e.length<n.length)return this.computeElementwiseOpOutputShape(n,e);if(n.length===0)return e;const s=e.slice(0,e.length-n.length);for(let r=0;r<n.length;++r){const o=e[e.length-n.length+r],i=n[r];if(o==null||i==null||o<0||i<0)s.push(null);else if(o===1)s.push(i);else if(i===1)s.push(o);else{if(o!==i)throw new _("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(n));s.push(o)}}return s}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[_e(e)]),e=e,e.length<2)throw new _(`A merge layer should be called on an Array of at least 2 inputs. Got ${e.length} input(s).`);let n=[];for(const o of e)o!=null&&o[0]!==null&&n.push(o[0]);if(n=qo(n),n.length>1)throw new _(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(e)}.`);let s=e[0]==null?null:e[0].slice(1);for(let o=1;o<e.length;++o){const i=e[o]==null?null:e[o].slice(1);s=this.computeElementwiseOpOutputShape(s,i)}const r=e.map(o=>o.length);e.indexOf(null)===-1&&qo(r).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,n){return H(()=>{if(e=e,this.reshapeRequired){const s=[],r=e.map(o=>o.rank);if(r.indexOf(null)===-1){const o=ni(r);for(let i of e){const a=i.rank;for(let l=0;l<o-a;++l)i=of(i,1);s.push(i)}return this.mergeFunction(s)}else{let o=!1;for(const l of e){const u=l.rank;if(u==null){const c=l.shape,d=c[0],f=c.slice(1).concat([d]);let h=B(l,[d].concat(Yo(c.slice(1))));h=Oe(h,[1,0]),h=B(h,f),s.push(h),o=!0}else if(u>1){const c=cr(1,u).concat([0]);s.push(Oe(l,c)),o=!0}else s.push(l)}let i=this.mergeFunction(s);const a=i.rank;if(o){if(a==null){const l=i.shape,u=l.length,c=l[u-1],d=[c].concat(l.slice(0,l.length-1));i=B(Oe(B(i,[-1,c]),[1,0]),d)}else if(a>1){const l=[a-1].concat(cr(0,a-1));i=Oe(i,l)}}return i}}else return this.mergeFunction(e)})}computeOutputShape(e){e=e;let n;e[0]==null?n=null:n=e[0].slice(1);for(let r=1;r<e.length;++r){const o=e[r]==null?null:e[r].slice(1);n=this.computeElementwiseOpOutputShape(n,o)}let s=[];for(const r of e)r!=null&&r[0]!==null&&s.push(r[0]);return s=qo(s),s.length===1?n=s.concat(n):n=[null].concat(n),n}computeMask(e,n){return H(()=>{if(n==null)return null;if(!Array.isArray(n))throw new _("`mask` should be an Array");if(!Array.isArray(e))throw new _("`inputs` should be an Array");if(n.length!==e.length)throw new _(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${e.length} vs ${n.length})`);if(n.every(r=>r==null))return null;n=n.map(r=>r==null?r:Mn(r,0));let s=n[0];for(let r=1;r<n.length-1;++r)s=uo(s,n[r]);return s})}}class qD extends Na{constructor(e){super(e)}mergeFunction(e){return H(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=ne(n,e[s]);return n})}}qD.className="Add";J(qD);class YD extends Na{constructor(e){super(e)}mergeFunction(e){return H(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=z(n,e[s]);return n})}}YD.className="Multiply";J(YD);class QD extends Na{constructor(e){super(e)}mergeFunction(e){return H(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=ne(n,e[s]);return z(1/e.length,n)})}}QD.className="Average";J(QD);class ZD extends Na{constructor(e){super(e)}mergeFunction(e){return H(()=>{let n=e[0];for(let s=1;s<e.length;++s)n=pi(n,e[s]);return n})}}ZD.className="Maximum";J(ZD);class JD extends Na{constructor(e){super(e)}mergeFunction(e){return H(()=>{let n=e[0];for(let s=1;s<e.length;++s)n=Oc(n,e[s]);return n})}}JD.className="Minimum";J(JD);class eF extends Na{constructor(e){super(e),this.DEFAULT_AXIS=-1,e==null&&(e={}),this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||e.length===1)throw new _("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;let n=!0;for(const r of e)if(r!=null){n=!1;break}if(n)return;const s=[];for(let r=0;r<e.length;++r){const o=e[r].slice();o.splice(this.axis,1);let i=!1;for(const a of s)if(He(a,o)){i=!0;break}i||s.push(o)}if(s.length>1)throw new _("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return H(()=>Mw(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new _("A `Concatenate` layer should be called on a list of inputs.");const n=e,s=n[0].slice(),r=this.axis<0?s.length+this.axis:this.axis;for(const o of n.slice(1)){if(s[r]==null||o[r]==null){s[r]=null;break}s[r]+=o[r]}return s}computeMask(e,n){if(n==null)return null;if(!Array.isArray(n))throw new _("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new _("`inputs` should be an array for Concatenate");if(n.length!==e.length)throw new _(`Mismatch in the length of mask (${n.length}) and the legnth of inputs (${e.length})`);return H(()=>{let s=!0;if(n.forEach(i=>{if(i!=null){s=!1;return}}),s)return null;const r=[];for(let i=0;i<e.length;++i)n[i]==null?r.push(ce(Us(e[i]),"bool")):n[i].rank<e[i].rank?r.push(Mn(n[i],-1)):r.push(n[i]);const o=Bn(r,this.axis);return eR(o,-1,!1)})}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}eF.className="Concatenate";J(eF);function Nu(t,e){for(;t<0;)t+=e;return t}function dj(t,e,n){if(t.shape.length>3||e.shape.length>3)throw new Te("batchDot is not implemented for tensors of 4D or higher rank yet");if(N(t.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${t.shape.length}`),N(t.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${e.shape.length}`),typeof n=="number"&&(n=[n,n]),t.dtype==="complex64"||e.dtype==="complex64")throw new Te("batchDot is not implemented for complex64-type Tensors yet.");const s=t.shape.length,r=e.shape.length;n==null&&(n=[s-1,r-2]);const o=n;return H(()=>{let i;if(s>r){i=s-r;const l=[];for(let u=0;u<i;++u)l.push(1);e=B(e,e.shape.concat(l))}else if(r>s){i=r-s;const l=[];for(let u=0;u<i;++u)l.push(1);t=B(t,t.shape.concat(l))}else i=0;let a;if(t.shape.length===2&&e.shape.length===2)o[0]===o[1]?a=ge(z(t,e),o[0]):a=ge(z(Oe(t,[1,0]),e),o[1]);else{const l=o[0]!==t.shape.length-1,u=o[1]===e.shape.length-1;a=Ue(t,e,l,u)}if(i>0){let l;s>r?l=s+r-3:l=s-1;const u=[];for(let c=l;c<l+i;++c)u.push(c);a=Jd(a,u)}return a.shape.length===1&&(a=Mn(a,1)),a})}class tF extends Na{constructor(e){super(e),this.axes=e.axes,this.normalize=e.normalize==null?!1:e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){N(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0],s=e[1];if(n.length>3||s.length>3)throw new Te("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(n,s);if(n[r[0]]!==s[r[1]])throw new _(`Dimension incompatibility: ${n[r[0]]} !== ${s[r[1]]}`)}mergeFunction(e){if(e.length!==2)throw new _(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let n=e[0],s=e[1],r;return Array.isArray(this.axes)?r=this.axes.map((o,i)=>Nu(o,e[i].shape.length)):r=[Nu(this.axes,n.shape.length),Nu(this.axes,s.shape.length)],this.normalize&&(n=Sp(n,r[0]),s=Sp(s,r[1])),dj(n,s,r)}interpretAxes(e,n){let s;return Array.isArray(this.axes)?s=this.axes:s=[Nu(this.axes,e.length),Nu(this.axes,n.length)],s}computeOutputShape(e){N(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0].slice(),s=e[1].slice();if(n.length>3||s.length>3)throw new Te("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(n,s);n.splice(r[0],1),s.splice(r[1],1),s.splice(0,1);const o=n.concat(s);return o.length===1&&o.push(1),o}computeMask(e,n){return null}getConfig(){const e={axes:this.axes,normalize:this.normalize},n=super.getConfig();return Object.assign(e,n),e}}tF.className="Dot";J(tF);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class nF extends Re{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={stddev:this.stddev};return Object.assign(n,e),n}call(e,n){return H(()=>{this.invokeCallHook(e,n);const s=ve(e);return lf(()=>ne(zg(s.shape,0,this.stddev),s),()=>s,n.training||!1)})}}nF.className="GaussianNoise";J(nF);class sF extends Re{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return H(()=>{this.invokeCallHook(e,n);const s=ve(e);return this.rate>0&&this.rate<1?lf(()=>{const o=Math.sqrt(this.rate/(1-this.rate));return z(s,zg(s.shape,1,o))},()=>s,n.training||!1):s})}}sF.className="GaussianDropout";J(sF);class rF extends Re{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||ve(e).shape}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return H(()=>{if(this.rate<1&&this.rate>0){const s=this._getNoiseShape(e);return lf(()=>{const o=ve(e),l=-1.6732632423543772*1.0507009873554805;let u=ka(Zd(s),this.rate);u=Dr(u,"float32");const c=((1-this.rate)*(1+this.rate*l**2))**-.5,d=-c*l*this.rate,f=ne(z(o,u),z(ne(u,-1),l));return ne(z(f,c),d)},()=>ve(e),n.training||!1)}return e})}}rF.className="AlphaDropout";J(rF);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Vc(t,e,n,s,r,o=.001){let i;if(t.rank===2)i=HB(t,e,n,s,r,o);else if(t.rank===3)i=KB(t,e,n,s,r,o);else if(t.rank===4)i=qB(t,e,n,s,r,o);else throw new Te(`batchNormalization is not implemented for array of rank ${t.rank} yet`);return i}function fj(t,e,n,s,r=.001){return H(()=>{const o=z1(t,s),i=o.mean,a=o.variance;return[Vc(t,i,a,n,e,r),i,a]})}function hj(t,e,n,s,r=.001){return H(()=>{const o=z1(t,s),i=o.mean,a=o.variance,l=[];for(const p of cr(0,t.rank))s.indexOf(p)!==-1?l.push(1):l.push(t.shape[p]);const u=B(i,l),c=B(a,l),d=e==null?null:B(e,l),f=n==null?null:B(n,l);return[Vc(t,u,c,f,d,r),i,a]})}function pj(t,e,n,s,r=.001){return He(s.slice().sort(),cr(0,t.rank-1))?fj(t,e,n,s,r):hj(t,e,n,s,r)}class oF extends Re{constructor(e){e==null&&(e={}),super(e),this.supportsMasking=!0,this.axis=e.axis==null?-1:e.axis,this.momentum=e.momentum==null?.99:e.momentum,this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=pt(e.betaInitializer||"zeros"),this.gammaInitializer=pt(e.gammaInitializer||"ones"),this.movingMeanInitializer=pt(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=pt(e.movingVarianceInitializer||"ones"),this.betaConstraint=Gt(e.betaConstraint),this.gammaConstraint=Gt(e.gammaConstraint),this.betaRegularizer=mt(e.betaRegularizer),this.gammaRegularizer=mt(e.gammaRegularizer)}build(e){e=_e(e);const n=this.axis>=0?this.axis:this.axis+e.length,s=e[n];if(s==null)throw new _(`Axis ${n} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new Wt({ndim:e.length,axes:{[n]:s}})];const r=[s];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,n){return H(()=>{const s=n.training==null?!1:n.training,r=ve(e),o=r.shape,i=o.length,a=cr(0,i),l=this.axis>=0?this.axis:this.axis+i;a.splice(l,1);const u=ua(1,i);u[l]=o[l];const c=a.slice();c.sort();const d=!He(c,cr(0,i).slice(0,i-1)),f=()=>{if(d){const x=B(this.movingMean.read(),u),v=B(this.movingVariance.read(),u),b=this.center?B(this.beta.read(),u):null,$=this.scale?B(this.gamma.read(),u):null;return Vc(r,x,v,b,$,this.epsilon)}else return Vc(r,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!s)return f();const[h,p,g]=pj(r,this.gamma.read(),this.beta.read(),a,this.epsilon),y=(x,v,b)=>{H(()=>{const $=1-b,C=x.read(),k=z(ye(C,v),$);x.write(ye(C,k))})};return(()=>{y(this.movingMean,p,this.momentum),y(this.movingVariance,g,this.momentum)})(),h})}getConfig(){const e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:yt(this.betaInitializer),gammaInitializer:yt(this.gammaInitializer),movingMeanInitializer:yt(this.movingMeanInitializer),movingVarianceInitializer:yt(this.movingVarianceInitializer),betaRegularizer:tt(this.betaRegularizer),gammaRegularizer:tt(this.gammaRegularizer),betaConstraint:Ut(this.betaConstraint),gammaConstraint:Ut(this.gammaConstraint)},n=super.getConfig();return Object.assign(e,n),e}}oF.className="BatchNormalization";J(oF);class iF extends Re{constructor(e){if(e==null&&(e={}),super(e),this.axis=e.axis==null?-1:e.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(const n of this.axis)if(!Number.isInteger(n))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=pt(e.betaInitializer||"zeros"),this.gammaInitializer=pt(e.gammaInitializer||"ones"),this.betaRegularizer=mt(e.betaRegularizer),this.gammaRegularizer=mt(e.gammaRegularizer),this.supportsMasking=!0}build(e){e=_e(e);const n=e.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let o=0;o<this.axis.length;++o)this.axis[o]<0&&(this.axis[o]+=n);for(const o of this.axis)if(o<0||o>=n)throw new Error(`Invalid axis: ${o}`);if(this.axis.length!==qo(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const s=this.axis.map(o=>e[o]),r=!0;this.scale?this.gamma=this.addWeight("gamma",s,"float32",this.gammaInitializer,this.gammaRegularizer,r):this.gamma=null,this.center?this.beta=this.addWeight("beta",s,"float32",this.betaInitializer,this.betaRegularizer,r):this.beta=null,this.built=!0}call(e,n){const s=ve(e),r=s.shape,o=r.length;return H(()=>{let{mean:a,variance:l}=z1(s,this.axis,!0);const u=ua(1,o);for(const g of this.axis)u[g]=r[g];const c=g=>g!=null&&g.shape.length!==o?B(g,u):g;let d=this.scale?c(this.gamma.read()):null,f=this.center?c(this.beta.read()):null;const h=[],p=[];for(let g=0;g<o;++g)this.axis.indexOf(g)!==-1?(h.push(r[g]),p.push(1)):(h.push(1),p.push(r[g]));return a=sr(a,h),l=sr(l,h),d!=null&&(d=sr(d,p)),f!=null&&(f=sr(f,p)),Vc(s,a,l,f,d,this.epsilon)})}getConfig(){const e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:yt(this.betaInitializer),gammaInitializer:yt(this.gammaInitializer),betaRegularizer:tt(this.betaRegularizer),gammaRegularizer:tt(this.gammaRegularizer)},n=super.getConfig();return Object.assign(e,n),e}}iF.className="LayerNormalization";J(iF);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function mj(t,e,n){return H(()=>{if(t.rank!==4)throw new _(`temporalPadding expects input tensor to be 4-D, but received a ${t.rank}-D tensor.`);if(e==null&&(e=[[1,1],[1,1]]),e.length!==2||e[0].length!==2||e[1].length!==2)throw new _("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(n==null&&(n=dr()),n!=="channelsLast"&&n!=="channelsFirst")throw new _(`Unknown data format: ${n}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let s;return n==="channelsFirst"?s=[[0,0],[0,0],e[0],e[1]]:s=[[0,0],e[0],e[1],[0,0]],V1(t,s)})}class aF extends Re{constructor(e){if(e==null&&(e={}),super(e),this.dataFormat=e.dataFormat==null?dr():e.dataFormat,e.padding==null)this.padding=[[1,1],[1,1]];else if(typeof e.padding=="number")this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new _(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let n,s;if(typeof e.padding[0]=="number")n=[e.padding[0],e.padding[0]],s=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new _(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(n=e.padding[0],e.padding[1].length!==2)throw new _(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);s=e.padding[1]}this.padding=[n,s]}this.inputSpec=[new Wt({ndim:4})]}computeOutputShape(e){e=_e(e);let n,s;return this.dataFormat==="channelsFirst"?(e[2]!=null&&e[2]>=0?n=e[2]+this.padding[0][0]+this.padding[0][1]:n=null,e[3]!=null&&e[3]>=0?s=e[3]+this.padding[1][0]+this.padding[1][1]:s=null,[e[0],e[1],n,s]):(e[1]!=null&&e[1]>=0?n=e[1]+this.padding[0][0]+this.padding[0][1]:n=null,e[2]!=null&&e[2]>=0?s=e[2]+this.padding[1][0]+this.padding[1][1]:s=null,[e[0],n,s,e[3]])}call(e,n){return H(()=>mj(ve(e),this.padding,this.dataFormat))}getConfig(){const e={padding:this.padding,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}aF.className="ZeroPadding2D";J(aF);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Kg(t,e,n,s,r,o){return H(()=>{Rt(r),CA(o),bs(s),n==null&&(n=[1,1]),s==null&&(s="valid"),r==null&&(r=dr()),o==null&&(o="max"),t=Yw(t,r);let i;const a=s==="same"?"same":"valid";return o==="max"?i=_1(t,e,n,a):i=E1(t,e,n,a),r==="channelsFirst"&&(i=Oe(i,[0,3,1,2])),i})}function lF(t,e,n,s,r,o){return H(()=>{Rt(r),CA(o),bs(s),n==null&&(n=[1,1,1]),s==null&&(s="valid"),r==null&&(r=dr()),o==null&&(o="max"),t=SD(t,r);let i;const a=s==="same"?"same":"valid";return o==="max"?i=FU(t,e,n,a):i=OB(t,e,n,a),r==="channelsFirst"&&(i=Oe(i,[0,4,1,2,3])),i})}class uF extends Re{constructor(e){if(e.poolSize==null&&(e.poolSize=2),super(e),typeof e.poolSize=="number")this.poolSize=[e.poolSize];else if(Array.isArray(e.poolSize)&&e.poolSize.length===1&&typeof e.poolSize[0]=="number")this.poolSize=e.poolSize;else throw new _(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.poolSize)}`);if(Qt(this.poolSize,"poolSize"),e.strides==null)this.strides=this.poolSize;else if(typeof e.strides=="number")this.strides=[e.strides];else if(Array.isArray(e.strides)&&e.strides.length===1&&typeof e.strides[0]=="number")this.strides=e.strides;else throw new _(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.strides)}`);Qt(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,bs(this.padding),this.inputSpec=[new Wt({ndim:3})]}computeOutputShape(e){e=_e(e);const n=lr(e[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],n,e[2]]}call(e,n){return H(()=>{this.invokeCallHook(e,n),e=of(ve(e),2);const s=this.poolingFunction(ve(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return Jd(s,[2])})}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},n=super.getConfig();return Object.assign(e,n),e}}class cF extends uF{constructor(e){super(e)}poolingFunction(e,n,s,r,o){return Rt(o),bs(r),Kg(e,n,s,r,o,"max")}}cF.className="MaxPooling1D";J(cF);class dF extends uF{constructor(e){super(e)}poolingFunction(e,n,s,r,o){return Rt(o),bs(r),Kg(e,n,s,r,o,"avg")}}dF.className="AveragePooling1D";J(dF);class fF extends Re{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==2)throw new _(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides];Qt(this.poolSize,"poolSize"),Qt(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Rt(this.dataFormat),bs(this.padding),this.inputSpec=[new Wt({ndim:4})]}computeOutputShape(e){e=_e(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2];return n=lr(n,this.poolSize[0],this.padding,this.strides[0]),s=lr(s,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,s]:[e[0],n,s,e[3]]}call(e,n){return H(()=>(this.invokeCallHook(e,n),this.poolingFunction(ve(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class hF extends fF{constructor(e){super(e)}poolingFunction(e,n,s,r,o){return Rt(o),bs(r),Kg(e,n,s,r,o,"max")}}hF.className="MaxPooling2D";J(hF);class pF extends fF{constructor(e){super(e)}poolingFunction(e,n,s,r,o){return Rt(o),bs(r),Kg(e,n,s,r,o,"avg")}}pF.className="AveragePooling2D";J(pF);class mF extends Re{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==3)throw new _(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];Qt(this.poolSize,"poolSize"),Qt(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Rt(this.dataFormat),bs(this.padding),this.inputSpec=[new Wt({ndim:5})]}computeOutputShape(e){e=_e(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2],r=this.dataFormat==="channelsFirst"?e[4]:e[3];return n=lr(n,this.poolSize[0],this.padding,this.strides[0]),s=lr(s,this.poolSize[1],this.padding,this.strides[1]),r=lr(r,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,s,r]:[e[0],n,s,r,e[4]]}call(e,n){return H(()=>(this.invokeCallHook(e,n),this.poolingFunction(ve(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class gF extends mF{constructor(e){super(e)}poolingFunction(e,n,s,r,o){return Rt(o),bs(r),lF(e,n,s,r,o,"max")}}gF.className="MaxPooling3D";J(gF);class xF extends mF{constructor(e){super(e)}poolingFunction(e,n,s,r,o){return Rt(o),bs(r),lF(e,n,s,r,o,"avg")}}xF.className="AveragePooling3D";J(xF);class yF extends Re{constructor(e){super(e),this.inputSpec=[new Wt({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,n){throw new Te}}class vF extends yF{constructor(e){super(e||{})}call(e,n){return H(()=>{const s=ve(e);return Ot(s,1)})}}vF.className="GlobalAveragePooling1D";J(vF);class bF extends yF{constructor(e){super(e||{})}call(e,n){return H(()=>{const s=ve(e);return ar(s,1)})}}bF.className="GlobalMaxPooling1D";J(bF);class wF extends Re{constructor(e){super(e),this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Rt(this.dataFormat),this.inputSpec=[new Wt({ndim:4})]}computeOutputShape(e){return e=e,this.dataFormat==="channelsLast"?[e[0],e[3]]:[e[0],e[1]]}call(e,n){throw new Te}getConfig(){const e={dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class $F extends wF{call(e,n){return H(()=>{const s=ve(e);return this.dataFormat==="channelsLast"?Ot(s,[1,2]):Ot(s,[2,3])})}}$F.className="GlobalAveragePooling2D";J($F);class CF extends wF{call(e,n){return H(()=>{const s=ve(e);return this.dataFormat==="channelsLast"?ar(s,[1,2]):ar(s,[2,3])})}}CF.className="GlobalMaxPooling2D";J(CF);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class kF extends Re{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(e){this.layer!=null&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){const e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},n=super.getConfig();return Object.assign(e,n),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,n,s={}){const r=n.layer,o=so(r,s);delete n.layer;const i={layer:o};return Object.assign(i,n),new e(i)}}class SF extends kF{constructor(e){super(e),this.supportsMasking=!0}build(e){if(e=_e(e),e.length<3)throw new _(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];const n=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(n),this.layer.built=!0),super.build(e)}computeOutputShape(e){e=_e(e);const n=[e[0]].concat(e.slice(2)),s=this.layer.computeOutputShape(n),r=e[1];return[s[0],r].concat(s.slice(1))}call(e,n){return H(()=>(e=ve(e),PD((i,a)=>[ve(this.layer.call(i,n)),[]],e,[],!1,null,null,!1,!0)[1]))}}SF.className="TimeDistributed";J(SF);function gj(t){Ea(M7,"BidirectionalMergeMode",t)}const xj="concat";class IF extends kF{constructor(e){super(e);const n=e.layer.getConfig(),s={};s.className=e.layer.getClassName(),s.config=n,this.forwardLayer=so(s),n.goBackwards=n.goBackwards!==!0;const r={};if(r.className=e.layer.getClassName(),r.config=n,this.backwardLayer=so(r),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=e.mergeMode===void 0?xj:e.mergeMode,gj(this.mergeMode),e.weights)throw new Te("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){const n=e.length,s=Math.floor(n/2);this.forwardLayer.setWeights(e.slice(0,s)),this.backwardLayer.setWeights(e.slice(s))}computeOutputShape(e){let n=this.forwardLayer.computeOutputShape(e);Array.isArray(n)&&Array.isArray(n[0])||(n=[n]),n=n;let s,r,o;return this.returnState&&(o=n.slice(1)),s=n[0],s=s,this.mergeMode==="concat"?(s[s.length-1]*=2,r=[s]):this.mergeMode==null?r=[s,s.slice()]:r=[s],this.returnState?this.mergeMode==null?r.concat(o).concat(o.slice()):[s].concat(o).concat(o.slice()):_n(r)}apply(e,n){let s=n==null?null:n.initialState,r=n==null?null:n.constants;n==null&&(n={});const o=FD(e,s,r,this.numConstants);if(e=o.inputs,s=o.initialState,r=o.constants,Array.isArray(e)&&(s=e.slice(1),e=e[0]),(s==null||s.length===0)&&r==null)return super.apply(e,n);const i=[],a=[];if(s!=null){const u=s.length;if(u%2>0)throw new _("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");n.initialState=s,i.push(...s);const c=s.map(d=>new Wt({shape:d.shape}));this.forwardLayer.stateSpec=c.slice(0,u/2),this.backwardLayer.stateSpec=c.slice(u/2),a.push(...c)}if(r!=null)throw new Te("Support for constants in Bidirectional layers is not implemented yet.");const l=i[0]instanceof _r;for(const u of i)if(u instanceof _r!==l)throw new _("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(l){const u=[e].concat(i),c=this.inputSpec.concat(a),d=this.inputSpec;this.inputSpec=c;const f=super.apply(u,n);return this.inputSpec=d,f}else return super.apply(e,n)}call(e,n){return H(()=>{const s=n.initialState;let r,o;if(s==null)r=this.forwardLayer.call(e,n),o=this.backwardLayer.call(e,n);else{const l=s.slice(0,s.length/2),u=s.slice(s.length/2);r=this.forwardLayer.call(e,Object.assign(n,{initialState:l})),o=this.backwardLayer.call(e,Object.assign(n,{initialState:u}))}let i;this.returnState&&(Array.isArray(r)&&(i=r.slice(1).concat(o.slice(1))),r=r[0],o=o[0]),this.returnSequences&&(o=aa(o,1));let a;return this.mergeMode==="concat"?a=Mw([r,o]):this.mergeMode==="sum"?a=ne(r,o):this.mergeMode==="ave"?a=z(.5,ne(r,o)):this.mergeMode==="mul"?a=z(r,o):this.mergeMode==null&&(a=[r,o]),this.returnState?this.mergeMode==null?a.concat(i):[a].concat(i):a})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){Gi(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),Gi(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,n){Array.isArray(n)&&(n=n[0]);let s;if(this.returnSequences?this.mergeMode==null?s=[n,n]:s=n:this.mergeMode==null?s=[null,null]:s=null,this.returnState){const o=this.forwardLayer.states.map(i=>null);return Array.isArray(s)?s.concat(o).concat(o):[s].concat(o).concat(o)}else return s}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){const e={mergeMode:this.mergeMode},n=super.getConfig();return Object.assign(e,n),e}static fromConfig(e,n){const s=so(n.layer);if(delete n.layer,n.numConstants!=null)throw new Te("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const r=n;return r.layer=s,new e(r)}}IF.className="Bidirectional";J(IF);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class TF extends Re{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){const e={scale:this.scale,offset:this.offset},n=super.getConfig();return Object.assign(e,n),e}call(e,n){return H(()=>(e=ve(e),e.dtype!=="float32"&&(e=Dr(e,"float32")),ne(z(e,this.scale),this.offset)))}}TF.className="Rescaling";J(TF);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const{resizeBilinear:yj,cropAndResize:vj}=eo;class EF extends Re{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,n,s,r,o,i,a,l){return H(()=>{let u,c=!1;const d=n/i,f=s/a,h=(r+n)/i,p=(o+s)/a,g=[d,f,h,p],y=[];e.rank===3?(c=!0,u=co([e])):u=e;for(let $=0;$<u.shape[0];$++)y.push(g);const m=Fn(y,[y.length,4]),x=Lc(0,y.length,1,"int32"),b=vj(u,m,x,[r,o],"nearest");return Dr(c?ve(la(b)):b,l)})}upsize(e,n,s,r){return H(()=>{const o=yj(e,[n,s]);return Dr(o,r)})}call(e,n){return H(()=>{const s=ve(e),r=s.dtype,o=s.shape,i=o[o.length-3],a=o[o.length-2];let l=0;i!==this.height&&(l=Math.floor((i-this.height)/2));let u=0;return a!==this.width&&(u=Math.floor((a-this.width)/2),u===0&&(u=1)),l>=0&&u>=0?this.centerCrop(s,l,u,this.height,this.width,i,a,r):this.upsize(e,this.height,this.width,r)})}getConfig(){const e={height:this.height,width:this.width},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){e=_e(e);const n=e.length-3,s=e.length-2;return e[n]=this.height,e[s]=this.width,e}}EF.className="CenterCrop";J(EF);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function bj(t,e,n,s){let r=ve(t);if(r.dtype!=="int32"&&(r=Dr(r,"int32")),e==="int")return r;const o=r.shape;if(r.rank===0&&(r=Mn(r,-1)),e==="oneHot"&&r.shape[r.shape.length-1]!==1&&(r=Mn(r,-1)),r.rank>2)throw new _(`When outputMode is not int, maximum output rank is 2 Received outputMode ${e} and input shape ${o} which would result in output rank ${r.rank}.`);const i=["multiHot","oneHot"].includes(e),a=r;let l;if(typeof s<"u"&&e==="count"?l=Vk(a,s,n,i):l=Vk(a,[],n,i),e!=="tfIdf")return l;if(s)return z(l,s);throw new _("When outputMode is 'tfIdf', weights must be provided.")}/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class NF extends Re{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){const e={numTokens:this.numTokens,outputMode:this.outputMode},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){return e=_e(e),e==null?[this.numTokens]:this.outputMode==="oneHot"&&e[e.length-1]!==1?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,n){return H(()=>{e=ve(e),e.dtype!=="int32"&&(e=Dr(e,"int32"));let s;if(typeof n.countWeights<"u"){if(this.outputMode!=="count")throw new _(`countWeights is not used when outputMode !== count.
              Received countWeights=${n.countWeights}`);s=ve(n.countWeights)}const r=ar(e),o=gp(e),i=vs(this.numTokens,r).bufferSync().get(0),a=ka(o,0).bufferSync().get(0);if(!(i&&a))throw new _(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return bj(e,this.outputMode,this.numTokens,s)})}}NF.className="CategoryEncoding";J(NF);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const wj=["bilinear","nearest"],vS=new Set(wj);class RF extends Re{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation)if(vS.has(e.interpolation))this.interpolation=e.interpolation;else throw new _(`Invalid interpolation parameter: ${e.interpolation} is not implemented`);else this.interpolation="bilinear";this.cropToAspectRatio=!!e.cropToAspectRatio}computeOutputShape(e){e=_e(e);const n=e[2];return[this.height,this.width,n]}getConfig(){const e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},n=super.getConfig();return Object.assign(e,n),e}call(e,n){return H(()=>{const s=[this.height,this.width];if(this.interpolation==="bilinear")return eo.resizeBilinear(e,s,!this.cropToAspectRatio);if(this.interpolation==="nearest")return eo.resizeNearestNeighbor(e,s,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...vS]} are supported`)})}}RF.className="Resizing";J(RF);/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class AF{constructor(e){this.seed=e}next(){if(this.seed!==void 0)return this.seed++}}AF.className="RandomSeed";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class DF extends Re{constructor(e){super(e),this.randomGenerator=new AF(e.seed)}getConfig(){const e={seed:this.randomGenerator.seed},n=super.getConfig();return Object.assign(e,n),e}}DF.className="BaseRandomLayer";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const $j=["bilinear","nearest"],bS=new Set($j);class FF extends DF{constructor(e){super(e);const{factor:n,interpolation:s="bilinear"}=e;if(this.factor=n,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new _(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);if(this.widthLower<-1||this.widthUpper<-1)throw new _(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new _(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(s)if(bS.has(s))this.interpolation=s;else throw new _(`Invalid interpolation parameter: ${s} is not implemented`)}getConfig(){const e={factor:this.factor,interpolation:this.interpolation},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){e=_e(e);const n=e[2];return[this.imgHeight,-1,n]}call(e,n){return H(()=>{const s=ve(e);this.imgHeight=s.shape[s.shape.length-3];const r=s.shape[s.shape.length-2];this.widthFactor=Zd([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let o=this.widthFactor.dataSync()[0]*r;o=Math.round(o);const i=[this.imgHeight,o];switch(this.interpolation){case"bilinear":return eo.resizeBilinear(e,i);case"nearest":return eo.resizeNearestNeighbor(e,i);default:throw new Error(`Interpolation is ${this.interpolation}
          but only ${[...bS]} are supported`)}})}}FF.className="RandomWidth";J(FF);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cj=K();Cj.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,t=>{t&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var wS;(function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_QINT16=15]="DT_QINT16",t[t.DT_QUINT16=16]="DT_QUINT16",t[t.DT_UINT16=17]="DT_UINT16",t[t.DT_COMPLEX128=18]="DT_COMPLEX128",t[t.DT_HALF=19]="DT_HALF",t[t.DT_RESOURCE=20]="DT_RESOURCE",t[t.DT_VARIANT=21]="DT_VARIANT",t[t.DT_UINT32=22]="DT_UINT32",t[t.DT_UINT64=23]="DT_UINT64",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",t[t.DT_QINT16_REF=115]="DT_QINT16_REF",t[t.DT_QUINT16_REF=116]="DT_QUINT16_REF",t[t.DT_UINT16_REF=117]="DT_UINT16_REF",t[t.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",t[t.DT_HALF_REF=119]="DT_HALF_REF",t[t.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",t[t.DT_VARIANT_REF=121]="DT_VARIANT_REF",t[t.DT_UINT32_REF=122]="DT_UINT32_REF",t[t.DT_UINT64_REF=123]="DT_UINT64_REF"})(wS||(wS={}));var $S;(function(t){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))})($S||($S={}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var CS;(function(t){t[t.FAIL=0]="FAIL",t[t.SHORTEST=1]="SHORTEST",t[t.LONGEST=2]="LONGEST"})(CS||(CS={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fe(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&N(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kj=NR;class Xg extends Ab{nextDataId(){return Xg.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new qE(this,vr())}write(e,n,s){this.firstUse&&(this.firstUse=!1,K().get("IS_NODE")&&cs(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const r={id:this.nextDataId()};return this.data.set(r,{values:e,dtype:s,refCount:1}),r}makeTensorInfo(e,n,s){let r;if(n==="string"&&s!=null&&s.length>0&&ed(s[0])){const o=s.map(i=>Xo(i));r=this.write(o,e,n)}else r=this.write(s,e,n);return{dataId:r,shape:e,dtype:n}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){const n=this.data.get(e);n.refCount++}decRef(e){if(this.data.has(e)){const n=this.data.get(e);n.refCount--}}move(e,n,s,r,o){this.data.set(e,{values:n,dtype:r,refCount:o})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){const{dtype:n,complexTensorInfos:s}=this.data.get(e);if(n==="complex64"){const r=this.readSync(s.real.dataId),o=this.readSync(s.imag.dataId);return fo(r,o)}return qz(this.data.get(e).values,n)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const s=n.map(r=>ti(r));return Ee(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Ee(e.shape,e.dtype,n)}makeOutput(e,n,s){return vr().makeTensorFromTensorInfo(this.makeTensorInfo(n,s,e),this)}disposeData(e,n=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!n&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:s}=this.data.get(e);s!=null&&(this.disposeData(s.real.dataId,!0),this.disposeData(s.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){const n=Ln();return e(),{kernelMs:Ln()-n}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){fe([e],"where");const n=this.readSync(e.dataId);return kj(e.shape,n)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}Xg.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PF(t){const e=new Float32Array(t.length);for(let n=0;n<t.length;++n)e[n]=Math.abs(t[n]);return e}const Sj=t=>{const{x:e}=t.inputs,n=t.backend;fe(e,"abs");let s=new Float32Array(Y(e.shape));const r=n.data.get(e.dataId).values;return s=PF(r),n.makeOutput(s,e.shape,e.dtype)},Ij={kernelName:Sm,backendName:"cpu",kernelFunc:Sj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function At(t){return(e,n,s,r,o)=>{const i=Se(e,n),a=i.length,l=me(i),u=Y(i),c=hn(o,u),d=e.length,f=n.length,h=me(e),p=me(n),g=Ol(e,i),y=Ol(n,i);if(g.length+y.length===0)for(let m=0;m<c.length;++m)c[m]=t(s[m%s.length],r[m%r.length]);else for(let m=0;m<c.length;++m){const x=ql(m,a,l),v=x.slice(-d);g.forEach(k=>v[k]=0);const b=Nr(v,d,h),$=x.slice(-f);y.forEach(k=>$[k]=0);const C=Nr($,f,p);c[m]=t(s[b],r[C])}return[c,i]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qn(t){const{inputs:e,backend:n}=t,{real:s,imag:r}=e,o=n.data.get(s.dataId).values,i=n.data.get(r.dataId).values,a=n.makeTensorInfo(s.shape,"complex64"),l=n.data.get(a.dataId);return l.complexTensorInfos={real:n.makeTensorInfo(s.shape,"float32",o),imag:n.makeTensorInfo(r.shape,"float32",i)},a}const Tj={kernelName:Gb,backendName:"cpu",kernelFunc:qn};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rp(t,e,n="float32"){if(n==="complex64"){const r=Rp(t,e,"float32"),o=Rp(t,e,"float32");return qn({inputs:{real:r,imag:o},backend:t})}const s=pn(Y(e),n);return t.makeTensorInfo(e,n,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zr(t){const{inputs:e,backend:n}=t,{x:s}=e;return n.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const Ej={kernelName:wd,backendName:"cpu",kernelFunc:zr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ca(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.data.get(s.dataId).complexTensorInfos.real,o=n.data.get(r.dataId).values;return n.makeTensorInfo(r.shape,r.dtype,o)}const Nj={kernelName:p1,backendName:"cpu",kernelFunc:ca};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OF(t,e,n,s){if(s==="int32"){const r=Int32Array.from(t);return[e,"int32",r]}if(s==="bool"){const r=Ca([0],n),[o,i]=At((a,l)=>a!==l?1:0)(e,[],t,r,"bool");return[i,"bool",o]}throw new Error(`Error in Cast: failed to cast ${n} to ${s}`)}function ii(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dtype:o}=s;if(o==="complex64"){if(r.dtype==="complex64")return zr({inputs:{x:r},backend:n});const c=Rp(n,r.shape,r.dtype),d=ii({inputs:{x:r},backend:n,attrs:{dtype:"float32"}}),f=qn({inputs:{real:d,imag:c},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),f}if(r.dtype==="complex64"){const c=ca({inputs:{input:r},backend:n}),d=ii({inputs:{x:c},backend:n,attrs:{dtype:o}});return n.disposeIntermediateTensorInfo(c),d}if(!ZE(r.dtype,o)){const c=zr({inputs:{x:r},backend:n});return{dataId:c.dataId,shape:c.shape,dtype:o}}const i=n.data.get(r.dataId).values,[a,l,u]=OF(i,r.shape,r.dtype,o);return n.makeTensorInfo(a,l,u)}const Rj={kernelName:ld,backendName:"cpu",kernelFunc:ii};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jt(t,e,n,s){return n==null?({inputs:r,backend:o})=>{const{a:i,b:a}=r,l=o;fe([i,a],t);const u=l.data.get(i.dataId).values,c=l.data.get(a.dataId).values,d=i.dtype==="string"?ho(u):u,f=i.dtype==="string"?ho(c):c,h=s||i.dtype,[p,g]=e(i.shape,a.shape,d,f,h);return l.makeTensorInfo(g,h,p)}:({inputs:r,backend:o})=>{const{a:i,b:a}=r,l=o;if(i.dtype==="complex64"||a.dtype==="complex64"){const u=ii({inputs:{x:i},backend:l,attrs:{dtype:"complex64"}}),c=l.data.get(u.dataId),d=c.complexTensorInfos.real,f=c.complexTensorInfos.imag,h=l.data.get(d.dataId).values,p=l.data.get(f.dataId).values,g=ii({inputs:{x:a},backend:l,attrs:{dtype:"complex64"}}),y=l.data.get(g.dataId),m=y.complexTensorInfos.real,x=y.complexTensorInfos.imag,v=l.data.get(m.dataId).values,b=l.data.get(x.dataId).values,[$,C,k]=n(i.shape,a.shape,h,p,v,b),w=l.makeTensorInfo(k,"float32",$),I=l.makeTensorInfo(k,"float32",C),R=qn({inputs:{real:w,imag:I},backend:l});return l.disposeIntermediateTensorInfo(u),l.disposeIntermediateTensorInfo(g),l.disposeIntermediateTensorInfo(w),l.disposeIntermediateTensorInfo(I),R}else{const u=l.data.get(i.dataId).values,c=l.data.get(a.dataId).values,d=s||i.dtype,[f,h]=e(i.shape,a.shape,u,c,d);return l.makeTensorInfo(h,d,f)}}}function n$(t){return(e,n,s,r,o,i)=>{const a=Se(e,n),l=Y(a),u=a.length,c=me(a),d=hn("float32",l),f=hn("float32",l),h=Ol(e,a),p=Ol(n,a),g=fo(s,r),y=fo(o,i),m=e.length,x=me(e),v=n.length,b=me(n);if(h.length+p.length===0)for(let $=0;$<d.length;$++){const C=$%g.length,k=$%y.length,w=t(g[C*2],g[C*2+1],y[k*2],y[k*2+1]);d[$]=w.real,f[$]=w.imag}else for(let $=0;$<d.length;$++){const C=ql($,u,c),k=C.slice(-m);h.forEach(A=>k[A]=0);const w=Nr(k,m,x),I=C.slice(-v);p.forEach(A=>I[A]=0);const R=Nr(I,v,b),E=t(g[w*2],g[w*2+1],y[R*2],y[R*2+1]);d[$]=E.real,f[$]=E.imag}return[d,f,a]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LF=At((t,e)=>t+e),Aj=n$((t,e,n,s)=>({real:t+n,imag:e+s})),_l=jt(Yl,LF,Aj),Dj={kernelName:Yl,backendName:"cpu",kernelFunc:_l};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s$(t,e,n,s,r){const o=Y(s),i=pn(r,n);for(let a=0;a<t.length;a++){const l=t[a];if(l<0)throw new Error("Input x must be non-negative!");l>=r||(o>0?i[l]+=e[a]:i[l]+=1)}return i}function MF(t,e,n,s=!1){const r=t.shape[0],o=t.shape[1],i=Ee([r,n],e.dtype);for(let a=0;a<r;a++)for(let l=0;l<o;l++){const u=t.get(a,l);if(u<0)throw new Error("Input x must be non-negative!");u>=n||(s?i.set(1,a,u):e.size>0?i.set(i.get(a,u)+e.get(a,l),a,u):i.set(i.get(a,u)+1,a,u))}return i}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _F=At((t,e)=>t&e),Fj=jt(Ub,_F),Pj={kernelName:Ub,backendName:"cpu",kernelFunc:Fj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wr(t){return(e,n,s)=>{const r=St(n,e.length);for(let o=0;o<e.length;++o)r[o]=t(e[o],s);return r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qe(t,e,n){const s=Wr(e);return xi(t,s,n)}function xi(t,e,n){return({inputs:s,attrs:r,backend:o})=>{const{x:i}=s;fe(i,t);const a=o,l=a.data.get(i.dataId).values;let u;if(i.dtype==="string"){if(!Array.isArray(l))throw new Error("String tensor's value was not an instance of Array");u=ho(l)}else u=l;const c=n||i.dtype,d=e(u,c,r);return a.makeTensorInfo(i.shape,c,d)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zF=Wr(t=>Math.ceil(t)),Oj=xi(ud,zF),Lj={kernelName:ud,backendName:"cpu",kernelFunc:Oj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VF(t,e,n,s){const r=St(n,Y(e));if(s&&n!=="string"){let o=0;t.forEach(i=>{const a=Y(i.shape);r.set(i.vals,o),o+=a})}else{let o=0;t.forEach(i=>{const a=n==="string"?ho(i.vals):i.vals;let l=0;for(let u=0;u<i.shape[0];++u){const c=u*e[1]+o;for(let d=0;d<i.shape[1];++d)r[c+d]=a[l++]}o+=i.shape[1]})}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BF=At((t,e)=>t===e?1:0),WF=jt(Vm,BF,null,"bool"),Mj={kernelName:Vm,backendName:"cpu",kernelFunc:WF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UF=Wr(t=>Math.exp(t)),GF=xi(gd,UF,"float32"),_j={kernelName:gd,backendName:"cpu",kernelFunc:GF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HF=Wr(t=>Math.expm1(t)),zj=xi(xd,HF),Vj={kernelName:xd,backendName:"cpu",kernelFunc:zj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jF=Wr(t=>Math.floor(t)),Bj=xi(yd,jF),Wj={kernelName:yd,backendName:"cpu",kernelFunc:Bj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KF=At((t,e)=>Math.floor(t/e)),Uj=jt(vd,KF,null,"int32"),Gj={kernelName:vd,backendName:"cpu",kernelFunc:Uj};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XF(t,e,n,s,r,o,i,a,l){const u=Ee([s,o],n);for(let c=0;c<s;c++){const d=[];let f=0;for(let h=0;h<r;h++){const p=t[c*r+h];f+=p*i[h],d.push(p)}if(f<0||f>=l/o)throw new Error(`Invalid indices: ${d} does not index into ${a}`);for(let h=0;h<o;h++)u.values[c*o+h]=e.get(...e.indexToLoc(f*o+h))}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qF(t,e,n){const s=Ee(n,t.dtype);for(let r=0;r<s.size;++r){const i=s.indexToLoc(r).slice(),a=i[0],l=i[2],u=e.locToIndex([a,l]);i[2]=e.values[u];const c=t.locToIndex(i);0<=c&&c<t.values.length&&(s.values[r]=t.values[c])}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YF=At((t,e)=>t>e?1:0),Hj=jt(Gm,YF,null,"bool"),jj={kernelName:Gm,backendName:"cpu",kernelFunc:Hj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QF=At((t,e)=>t>=e?1:0),Kj=jt(bd,QF,null,"bool"),Xj={kernelName:bd,backendName:"cpu",kernelFunc:Kj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZF=At((t,e)=>t<e?1:0),qj=jt(jm,ZF,null,"bool"),Yj={kernelName:jm,backendName:"cpu",kernelFunc:qj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JF=At((t,e)=>t<=e?1:0),Qj=jt(Km,JF,null,"bool"),Zj={kernelName:Km,backendName:"cpu",kernelFunc:Qj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eP(t,e,n){const s=(e-t)/(n-1),r=pn(n,"float32");r[0]=t;for(let o=1;o<r.length;o++)r[o]=r[o-1]+s;return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tP=Wr(t=>Math.log(t)),Jj=xi(Sd,tP),eK={kernelName:Sd,backendName:"cpu",kernelFunc:Jj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nP(t,e,n,s){const r=hn(s,Y(n));for(let o=0;o<r.length;++o){const i=o*e;let a=t[i];for(let l=0;l<e;++l){const u=t[i+l];(Number.isNaN(u)||u>a)&&(a=u)}r[o]=a}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sP=At((t,e)=>Math.max(t,e)),tK=jt(Td,sP),nK={kernelName:Td,backendName:"cpu",kernelFunc:tK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rP=At((t,e)=>Math.min(t,e)),sK=jt(Ed,rP),rK={kernelName:Ed,backendName:"cpu",kernelFunc:sK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r$=At((t,e)=>t*e),oK=n$((t,e,n,s)=>({real:t*n-e*s,imag:t*s+e*n})),qg=jt(Rd,r$,oK),iK={kernelName:Rd,backendName:"cpu",kernelFunc:qg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oP(t,e,n){const s=di(-1,n);return r$([],e,s,t,n)}function aK(t){const{inputs:e,backend:n}=t,{x:s}=e;fe(s,"neg");const r=n.data.get(s.dataId).values,[o,i]=oP(r,s.shape,s.dtype);return n.makeTensorInfo(i,s.dtype,o)}const lK={kernelName:rg,backendName:"cpu",kernelFunc:aK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iP=At((t,e)=>t!==e?1:0),uK=jt(og,iP,null,"bool"),cK={kernelName:og,backendName:"cpu",kernelFunc:uK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o$(t,e,n,s,r){const o=e.length,i=Y(e),a=me(e),l=me(r),u=hn(n,Y(r));for(let c=0;c<i;++c){const d=ql(c,o,a),f=new Array(d.length);for(let p=0;p<f.length;p++)f[p]=d[s[p]];const h=Nr(f,o,l);u[h]=t[c]}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Un(t){const{inputs:e,attrs:n,backend:s}=t,{x:r}=e,{perm:o}=n;fe(r,"transpose");const i=r.shape.length,a=new Array(i);for(let d=0;d<a.length;d++)a[d]=r.shape[o[d]];const l=s.data.get(r.dataId).values,u=o$(l,r.shape,r.dtype,o,a);return{dataId:s.write(u,a,r.dtype),shape:a,dtype:r.dtype}}const dK={kernelName:yl,backendName:"cpu",kernelFunc:Un};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aP(t,e,n,s){const[r,o]=Jt(t,s),i=ss(e,"int32"),a=pn(Y(r),i),l=Y(o);for(let u=0;u<a.length;++u){const c=u*l;let d=1;for(let f=0;f<l;++f)d*=n[c+f];a[u]=d}return{outVals:a,outShape:r,outDtype:i}}function fK(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,keepDims:i}=s;fe(r,"prod");const a=r.shape.length,l=Ne(o,r.shape),u=vt(l,a);let c=l,d=r;const f=[];u!=null&&(d=Un({inputs:{x:r},backend:n,attrs:{perm:u}}),f.push(d),c=Nt(c.length,a));const h=n.data.get(d.dataId).values,{outVals:p,outShape:g,outDtype:y}=aP(d.shape,d.dtype,h,c);let m=g;return i&&(m=Lt(g,l)),f.forEach(x=>n.disposeIntermediateTensorInfo(x)),n.makeTensorInfo(m,y,p)}const hK={kernelName:dg,backendName:"cpu",kernelFunc:fK};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pK(t,e,n){t.forEach((s,r)=>{if(s<0||s>=n){const o=ql(r,e.length,me(e)).join(",");throw new Error(`indices[${o}] = ${s} is not in [0, ${n})`)}})}function mK(t,e){for(let n=0;n<t.length;++n){const s=t[n],r=n===t.length-1?e:t[n+1].length;if(s.length===0)throw new Error("Ragged splits may not be empty");if(s[0]<0)throw new Error("Ragged splits must be non-negative");if(s[s.length-1]>r)throw new Error("Ragged splits must not point past values");for(let o=1;o<s.length;++o)if(s[o-1]>s[o])throw new Error("Ragged splits must be sorted in ascending order")}}function gK(t,e,n,s){const r=[];let o=0;const i=e.length-1+n.length,a=new Array(i).fill(null).map(()=>[0]);mK(n,s);let l=1;for(let u=0;u<e.length-1;++u){l*=e[u];const c=e[u+1];for(let d=1;d<l+1;++d)a[u].push(d*c)}for(let u=0;u<t.length;++u){let c=t[u],d=t[u]+1;for(let f=0;f<n.length;++f){const h=n[f],p=f+e.length-1;if(p>=0){const g=a[p],y=g[g.length-1]-h[c];for(let m=c;m<d;++m)a[p].push(h[m+1]+y)}c=h[c],d=h[d]}d!==c&&(r.push([c,d]),o+=d-c)}return{outSplits:a,valueSlices:r,numValues:o}}function xK(t){const e=[];for(let n=0;n<t.length;++n){const s=t[n].length,r=St("int32",s);e.push(r),t[n].forEach((o,i)=>r[i]=o)}return e}function kS(t,e){const n=t.slice(0,e);for(;n.length<e;)n.push(1);for(let s=e;s<t.length;s++)n[e-1]*=t[s];return n}function yK(t,e,n,s,r,o){const i=kS(e,2)[1],a=kS(o,2)[1];let l=0;for(const u of n)for(let c=u[0];c<u[1];++c){for(let d=0;d<s;++d)r[l*a+d]=t[c*i+d];++l}}function vK(t,e,n,s,r){const o=e.slice();o[0]=r;const i=St(n,Y(o)),a=t.length,l=a===0?0:a/e[0];return yK(t,e,s,l,i,o),[i,o]}function lP(t,e,n,s,r,o,i,a){if(t.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const l=e[0][0]-1;if(pK(o,i,l),s.length===0)throw new Error("params.rank must be nonzero");const u=s[0],{outSplits:c,valueSlices:d,numValues:f}=gK(o,i,t,u),h=xK(c),p=vK(n,s,r,d,f);return[h,p[0],p[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SS=2147483647;function uP(t,e,n,s,r,o,i){if(e.length>1)throw new Error("starts must be a scalar or vector");if(r.length>1)throw new Error("limits must be a scalar or vector");if(i.length>1)throw new Error("deltas must be a scalar or vector");const a=e.length===0,l=r.length===0,u=i.length===0,c=[];a||c.push(e[0]),l||c.push(r[0]),u||c.push(i[0]);for(let y=1;y<c.length;++y)if(c[y]!==c[y-1])throw new Error("starts, limits, and deltas must have the same shape");const d=c.length===0?1:c[0],f=St("int32",d+1);f[0]=0;for(let y=0;y<d;++y){const m=a?t[0]:t[y],x=l?s[0]:s[y],v=u?o[0]:o[y];if(v===0)throw new Error("Requires delta != 0");let b;if(v>0&&x<m||v<0&&x>m)b=0;else if(b=Math.ceil(Math.abs((x-m)/v)),b>SS)throw new Error(`Requires ((limit - start) / delta) <= ${SS}`);f[y+1]=f[y]+b}const h=f[d],p=St(n,h);let g=0;for(let y=0;y<d;++y){const m=f[y+1]-f[y];let x=a?t[0]:t[y];const v=u?o[0]:o[y];for(let b=0;b<m;++b)p[g++]=x,x+=v}return[f,p]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var $s=nr;class Ap{constructor(e,n,s,r,o,i,a,l,u,c){this.shape=e,this.shapeShape=n,this.values=s,this.valuesShape=r,this.valuesDType=o,this.defaultValue=i,this.defaultValueShape=a,this.rowPartitionValues=l,this.rowPartitionValuesShapes=u,this.rowPartitionTypes=XR(c),this.raggedRank=qR(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===$s.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===$s.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const n=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case $s.VALUE_ROWIDS:return Ap.getMaxWidthValueRowID(n);case $s.ROW_SPLITS:return Ap.getMaxWidthRowSplit(n);default:throw new Error(`Cannot handle partition type ${$s[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const n=e.length;if(n===0||n===1)return 0;let s=0;for(let r=0;r<n-1;++r){const o=e[r+1]-e[r];o>s&&(s=o)}return s}static getMaxWidthValueRowID(e){const n=e.length;if(n===0)return 0;let s=0,r=e[0],o=0;for(let i=1;i<n;++i){const a=e[i];a!==r&&(r=a,o=Math.max(i-s,o),s=i)}return Math.max(n-s,o)}tensorShapeFromTensor(e,n,s=!0){if(n.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return TS(e,s)}calculateOutputSize(e){const n=this.valuesShape,s=this.defaultValueShape;YR(s,n);const r=this.tensorShapeFromTensor(this.shape,this.shapeShape),i=KR(this.raggedRank,r,n);i[0]<0&&(i[0]=e);for(let a=1;a<=this.raggedRank;++a)i[a]<0&&(i[a]=this.getMaxWidth(a));return i}calculateFirstParentOutputIndex(e,n,s){const r=Math.min(e,s),o=[];let i=0;for(let a=0;a<r;++a,i+=n)o.push(i);for(let a=r;a<e;++a)o.push(-1);return N(o.length===e,()=>"Final length of result must be equal to firstDimension."),o}calculateOutputIndexRowSplit(e,n,s,r){const o=e.length,i=[];for(let a=0;a<o-1;++a){const l=e[a+1]-e[a];let u=Math.min(r,l),c=n[a];c===-1&&(u=0);for(let d=0;d<u;++d)i.push(c),c+=s;for(let d=0;d<l-u;++d)i.push(-1)}if(o>0&&i.length!==e[o-1])throw new Error("Invalid row split size.");return i}calculateOutputIndexValueRowID(e,n,s,r){const o=e.length,i=[];if(o===0)return[];let a=0,l=e[0];if(l>=n.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${n.length}`);let u=n[l];i.push(u);for(let c=1;c<o;++c){const d=e[c];if(d===l)u>=0&&(++a,a<r?u+=s:u=-1);else{if(a=0,l=d,d>=n.length)throw new Error(`Got nextValueRowId=${d} which is not less than ${n.length}`);u=n[d]}i.push(u)}if(i.length!==e.length)throw new Error("Invalid row ids.");return i}calculateOutputIndex(e,n,s,r){const o=this.getRowPartitionTensor(e),i=this.getRowPartitionTypeByDimension(e);switch(i){case $s.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(o,n,s,r);case $s.ROW_SPLITS:if(o.length-1>n.length)throw new Error(`Row partition size is greater than output size: ${o.length-1} > ${n.length}`);return this.calculateOutputIndexRowSplit(o,n,s,r);default:throw new Error(`Unsupported partition type: ${$s[i]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const n=this.rowPartitionTypes[0];switch(n){case $s.FIRST_DIM_SIZE:return e[0];case $s.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case $s.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${$s[n]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const n=this.getFirstDimensionSize(),s=this.calculateOutputSize(n),r=new Array(this.raggedRank+1);r[r.length-1]=1;for(let l=r.length-2;l>=0;--l)r[l]=r[l+1]*s[l+1];const o=TS(s,!1),i=St(this.valuesDType,Y(o));if(r[0]*s[0]>0){let l=this.calculateFirstParentOutputIndex(n,r[0],s[0]);for(let u=1;u<=this.raggedRank;++u)l=this.calculateOutputIndex(u-1,l,r[u],s[u]);this.setOutput(this.raggedRank,l,i,o)}return[o,i]}setOutput(e,n,s,r){if(s.length===0)return;const o=this.values,i=s;let a=r.slice();a=a.slice(e+1);const l=Y(a),u=n.length;let c=this.defaultValue;if(c.length!==l&&c.length!==1){const p=this.defaultValueShape;H(()=>{const g=B(c,p);c=rc(g,a).dataSync()})}let d=0,f=0,h=0;for(let p=0;p<=u;++p){let g=p<u?n[p]:-1;if(g===h){++h;continue}if(f<h){const y=o.subarray(d*l),m=i.subarray(f*l),x=(h-f)*l;IS(m,y,x)}if(p>=u){const y=s.length;g=Math.floor(y/l)}if(g>h)if(this.defaultValue.length===1)i.subarray(h*l,g*l).fill(this.defaultValue[0]),h=g;else for(;g>h;){const y=i.slice(h*l);IS(y,c,l),++h}g<0?(d=p+1,f=h):(d=p,f=h,h=f+1)}}}function IS(t,e,n){for(let s=0;s<n;s++)t[s]=e[s]}function TS(t,e){const n=[];for(let s of t){if(s<0){if(!e)throw new Error(`Dimension ${s} must be >= 0`);if(s<-1)throw new Error(`Dimension ${s} must be >= -1`);s=-1}n.push(s)}return n}function cP(t,e,n,s,r,o,i,a,l,u){return new Ap(t,e,n,s,r,o,i,a,l,u).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dP(t,e,n,s){const r=t===e,o=t<e&&n<0,i=e<t&&n>1;if(r||o||i)return pn(0,s);const a=Math.abs(Math.ceil((e-t)/n)),l=pn(a,s);e<t&&n===1&&(n=-1),l[0]=t;for(let u=1;u<l.length;u++)l[u]=l[u-1]+n;return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fP=Wr(t=>1/Math.sqrt(t)),bK=xi(Ld,fP),wK={kernelName:Ld,backendName:"cpu",kernelFunc:bK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oi(t,e,n,s,r,o,i,a,l,u){const c=[s/r,r],d=t.values,f=e.values;if(s===0)return Ee(n,e.dtype);const h=l instanceof sn?l:Ee(c,e.dtype);typeof l=="string"||typeof l=="number"?h.values.fill(l):typeof l=="boolean"&&h.values.fill(+l);for(let p=0;p<o;p++){const g=[];let y=0;for(let m=0;m<i;m++){const x=d[p*i+m];g.push(x),y+=x*a[m]}if(y<0||y>=s/r)throw new Error(`Invalid indices: ${g} does not index into ${n}`);for(let m=0;m<r;m++)u?h.values[y*r+m]+=f[p*r+m]:h.values[y*r+m]=e.rank===0?f[0]:f[p*r+m]}return h}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $K=Wr(t=>1/(1+Math.exp(-t))),hP=qe(Bd,t=>1/(1+Math.exp(-t))),CK={kernelName:Bd,backendName:"cpu",kernelFunc:hP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pP(t,e,n,s,r){const o=fw(s,e,n),i=Y(n),a=me(s);if(o){const d=hw(e,a);return r==="string"?t.slice(d,d+i):t.subarray(d,d+i)}const l=r==="string"?ho(t):t,u=Ee(s,r,l),c=Ee(n,r);for(let d=0;d<c.size;++d){const f=c.indexToLoc(d),h=f.map((p,g)=>p+e[g]);c.set(u.get(...h),...f)}return r==="string"?gA(c.values):c.values}function da(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:o,size:i}=s;fe(r,"slice");const[a,l]=Pg(r,o,i);cw(r,a,l);const u=n.data.get(r.dataId).values,c=pP(u,a,l,r.shape,r.dtype);return n.makeTensorInfo(l,r.dtype,c)}const kK={kernelName:xg,backendName:"cpu",kernelFunc:da};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mP(t,e,n,s,r,o,i){const a=e[0],l=o[0],u=new Array(l),c=new Array(a),d=e[1];if(l===0){if(a!==0)throw new Error(sA(a));const y=St(n,0),m=St(r,0);return[y,[0,d],m,u,c]}let f=!0,h=0;const p=new Array(l).fill(0);for(let y=0;y<a;++y){const m=t[y*d];if(m<0)throw new Error(rA(y,m));if(m>=l)throw new Error(oA(y,m,l));++p[m],f=f&&m>=h,h=m}let g=!0;for(let y=0;y<l;++y){const m=p[y]===0;u[y]=m,g=g&&!m,p[y]=Math.max(p[y],1),y>0&&(p[y]+=p[y-1])}if(g&&f){const y=t,m=s;for(let x=0;x<a;++x)c[x]=x;return[y,[a,d],m,u,c]}else{const y=p[l-1],m=St(n,y*d),x=St(r,y),v=new Array(l).fill(0);for(let b=0;b<a;++b){const $=t[b*d],C=v[$],k=($===0?0:p[$-1])+C;v[$]++;for(let w=0;w<d;++w)m[k*d+w]=t[b*d+w];x[k]=s[b],c[b]=k}for(let b=0;b<l;++b)if(v[b]===0){const C=b===0?0:p[b-1];m[C*d+0]=b;for(let k=1;k<d;++k)m[C*d+k]=0;x[C]=i}return[m,[y,d],x,u,c]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gP(t,e,n,s,r){const o=Y(s),i=e[0],a=r.length,l=[];let u=1,c=-1;for(let y=0;y<a;++y){const m=r[y];if(m===-1){if(c!==-1)throw new Error(iA(c,y));c=y,l.push(1)}else{if(m<0)throw new Error(aA(y,m));u*=m,l.push(m)}}if(c!==-1){if(u<=0)throw new Error(lA());const y=Math.trunc(o/u);if(u*y!==o)throw new Error(uA(s,l));l[c]=y}if(Y(l)!==o)throw new Error(cA(s,l));const f=s.length,h=[];if(f>0){h[f-1]=1;for(let y=f-2;y>=0;--y)h[y]=h[y+1]*s[y+1]}const p=[];if(a>0){p[a-1]=1;for(let y=a-2;y>=0;--y)p[y]=p[y+1]*l[y+1]}const g=St(n,i*a);for(let y=0;y<i;++y){let m=0;for(let x=0;x<f;++x)m+=t[y*f+x]*h[x];for(let x=0;x<a;++x)g[y*a+x]=Math.trunc(m/p[x]),m%=p[x]}return[g,[i,a],l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i$(t,e,n,s,r,o=!1,i=0){const a=s.length,l=[e[0],t.length/e[0]],u=l[1],d=a>0?r[a-1]+1:0;if(d<0)throw new Error(Vy());const f=e.slice();f[0]=d;const h=f.reduce((v,b)=>v*b,1),p=St(n,h);if(a===0)return d>0&&p.fill(i),[p,f];if(d<=0)throw new Error(Vy());let g=0,y=1,m=0,x=r[g];for(;;){let v=0;if(y<a){if(v=r[y],x===v){++y;continue}if(x>=v)throw new Error(dA())}if(x<0||x>=d)throw new Error(fA(x,d));x>m&&p.fill(i,m*u,x*u);for(let b=g;b<y;++b){const $=s[b];if($<0||$>=l[0])throw new Error(hA(b,s[b],l[0]));for(let C=0;C<u;C++)p[x*u+C]+=t[$*u+C]}if(o)for(let b=0;b<u;b++)p[x*u+b]/=y-g;if(g=y,++y,m=x+1,x=v,y>a)break}return m<d&&p.fill(i,m*u,d*u),[p,f]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SK=Wr(t=>Math.sqrt(t)),IK=qe(Ud,t=>Math.sqrt(t)),TK={kernelName:Ud,backendName:"cpu",kernelFunc:IK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xP=At((t,e)=>{const n=t-e;return n*n}),EK=jt(Gd,xP),NK={kernelName:Gd,backendName:"cpu",kernelFunc:EK};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yP=Wr((t,e)=>{const{pattern:n,replaceGlobal:s,rewrite:r}=e;return t.replace(new RegExp(n,s?"g":""),r)}),RK=xi(y1,yP),AK={kernelName:y1,backendName:"cpu",kernelFunc:RK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vP(t,e,n,s){const r=Ee(t,e.dtype);for(let o=0;o<r.size;o++){const i=r.indexToLoc(o),a=new Array(i.length);for(let l=0;l<a.length;l++)a[l]=i[l]*n[l]+s[l];r.set(e.get(...a),...i)}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class DK{constructor(e,n,s,r,o,i){this.separator=Xo(e),this.nGramWidths=n,this.leftPad=Xo(s),this.rightPad=Xo(r),this.padWidth=o,this.preserveShort=i}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,n){const s=this.getPadWidth(n);return Math.max(0,e+2*s-n+1)}createNGrams(e,n,s,r,o,i){for(let a=0;a<o;++a){const l=this.getPadWidth(i),u=Math.max(0,l-a),c=Math.max(0,l-(o-(a+1))),d=i-(u+c),f=n+(u>0?0:a-l);let h=0;h+=u*this.leftPad.length;for(let x=0;x<d;++x)h+=e[f+x].length;h+=c*this.rightPad.length;const p=u+c+d-1;h+=p*this.separator.length,s[r+a]=new Uint8Array(h);const g=s[r+a];let y=0;const m=x=>x.forEach(v=>g[y++]=v);for(let x=0;x<u;++x)m(this.leftPad),m(this.separator);for(let x=0;x<d-1;++x)m(e[f+x]),m(this.separator);if(d>0){m(e[f+d-1]);for(let x=0;x<c;++x)m(this.separator),m(this.rightPad)}else{for(let x=0;x<c-1;++x)m(this.rightPad),m(this.separator);m(this.rightPad)}}}compute(e,n){const s=e.length,r=n.length;if(r>0){let l=n[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let u=1;u<r;++u){let c=n[u]>=l;if(c=c&&n[u]<=s,!c)throw new Error(`Invalid split value ${n[u]}, must be in [${l}, ${s}]`);l=n[u]}if(l!==s)throw new Error(`Last split value must be data size. Expected ${s}, got ${l}`)}const o=r-1,i=St("int32",r);if(s===0||r===0){const l=new Array(s);for(let u=0;u<=o;++u)i[u]=0;return[l,i]}i[0]=0;for(let l=1;l<=o;++l){const u=n[l]-n[l-1];let c=0;this.nGramWidths.forEach(d=>{c+=this.getNumNGrams(u,d)}),this.preserveShort&&u>0&&c===0&&(c=1),i[l]=i[l-1]+c}const a=new Array(i[o]);for(let l=0;l<o;++l){const u=n[l];let c=i[l];if(this.nGramWidths.forEach(d=>{const f=n[l+1]-n[l],h=this.getNumNGrams(f,d);this.createNGrams(e,u,a,c,h,d),c+=h}),this.preserveShort&&c===i[l]){const d=n[l+1]-n[l];if(d===0)continue;const f=d+2*this.padWidth;this.createNGrams(e,u,a,c,1,f)}}return[a,i]}}function bP(t,e,n,s,r,o,i,a){return new DK(n,s,r,o,i,a).compute(t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FK(t,e,n,s){if(!t.length)return;if(e.length===0){for(let o=0;o<t.length;++o)s.push(t.subarray(o,o+1));return}if(e.length===1){const o=e[0];let i=t.indexOf(o);for(;i!==-1;){const a=t.subarray(0,i);(!n||a.length!==0)&&s.push(a),t=t.subarray(i+1),i=t.indexOf(o)}(!n||t.length!==0)&&s.push(t);return}let r=0;for(let o=0;o<t.length+1;o++)if(o===t.length||e.indexOf(t[o])!==-1){const i=t.subarray(r,o);(!n||i.length!==0)&&s.push(i),r=o+1}}function wP(t,e,n){const s=t.length,r=[];let o=0,i=0;const a=new Array(s);for(let f=0;f<s;++f){const h=r.length;FK(t[f],e,n,r);const p=r.length-h;a[f]=p,o+=p,i=Math.max(i,p)}const l=St("int32",o*2),u=new Array(o),c=[s,i];let d=0;for(let f=0;f<s;++f)for(let h=0;h<a[f];++h)l[d*2]=f,l[d*2+1]=h,u[d]=r[d],++d;return[l,u,c]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $P(t,e){const n=St("int32",t.length);for(let s=0;s<t.length;++s)n[s]=pV(t[s]).modulo(e).getLowBitsUnsigned();return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CP=At((t,e)=>t-e),PK=n$((t,e,n,s)=>({real:t-n,imag:e-s})),a$=jt(Hd,CP,PK),OK={kernelName:Hd,backendName:"cpu",kernelFunc:a$};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kP(t,e){const n=new Array(t.rank);for(let r=0;r<n.length;r++)n[r]=t.shape[r]*e[r];const s=Ee(n,t.dtype);for(let r=0;r<s.values.length;++r){const o=s.indexToLoc(r),i=new Array(t.rank);for(let l=0;l<i.length;l++)i[l]=o[l]%t.shape[l];const a=t.locToIndex(i);s.values[r]=t.values[a]}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wu=(t,e)=>{const n=e.value-t.value;return n===0?t.index-e.index:n};function SP(t,e,n=0,s=t.length-1){for(;s>n;){if(s-n>600){const a=s-n+1,l=e-n+1,u=Math.log(a),c=.5*Math.exp(2*u/3),d=.5*Math.sqrt(u*c*(a-c)/a)*Math.sign(l-a/2),f=Math.max(n,Math.floor(e-l*c/a+d)),h=Math.min(s,Math.floor(e+(a-l)*c/a+d));SP(t,e,f,h)}const r=t[e];let o=n,i=s;for(Ga(t,n,e),Wu(t[s],r)>0&&Ga(t,n,s);o<i;){for(Ga(t,o,i),o++,i--;Wu(t[o],r)<0;)o=o+1;for(;Wu(t[i],r)>0;)i=i-1}Wu(t[n],r)===0?Ga(t,n,i):(i=i+1,Ga(t,i,s)),i<=e&&(n=i+1),e<=i&&(s=i-1)}}function IP(t,e,n,s,r){const o=e[e.length-1],[i,a]=[t.length/o,o],l=hn(n,i*s),u=hn("int32",i*s);for(let d=0;d<i;d++){const f=d*a,h=t.subarray(f,f+a);let p=new Array(h.length);h.forEach((x,v)=>p[v]={value:x,index:v}),s<p.length&&(SP(p,s),p=p.slice(0,s)),r&&p.sort(Wu);const g=d*s,y=l.subarray(g,g+s),m=u.subarray(g,g+s);for(let x=0;x<s;x++)y[x]=p[x].value,m[x]=p[x].index}const c=e.slice();return c[c.length-1]=s,[Ee(c,n,l),Ee(c,"int32",u)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TP(t,e,n,s){const r=Ne(e,n)[0],o=[1,n[0],1];for(let p=0;p<r;p++)o[0]*=n[p];o[1]=n[r];for(let p=r+1;p<n.length;p++)o[2]*=n[p];const i=new Map,a=new Int32Array(n[r]),l=new sn(o,s,t),u=[],c=o[0]===1&&o[2]===1;for(let p=0;p<n[r];p++){let g;if(c)g=t[p].toString();else{const m=[];for(let x=0;x<o[0];x++)for(let v=0;v<o[2];v++)m.push(l.get(x,p,v));g=m.join(",")}const y=i.get(g);if(y!=null)a[p]=y;else{const m=i.size;i.set(g,m),a[p]=m,u.push(p)}}const d=o.slice();d[1]=i.size;const f=new sn(d,s);u.forEach((p,g)=>{for(let y=0;y<o[0];y++)for(let m=0;m<o[2];m++)f.set(l.get(y,p,m),y,g,m)});const h=n.slice();return h[r]=d[1],{outputValues:f.values,outputShape:h,indices:a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LK=Object.freeze(Object.defineProperty({__proto__:null,addImpl:LF,bincountImpl:s$,bincountReduceImpl:MF,bitwiseAndImpl:_F,castImpl:OF,ceilImpl:zF,concatImpl:VF,equalImpl:BF,expImpl:UF,expm1Impl:HF,floorDivImpl:KF,floorImpl:jF,gatherNdImpl:XF,gatherV2Impl:qF,greaterEqualImpl:QF,greaterImpl:YF,lessEqualImpl:JF,lessImpl:ZF,linSpaceImpl:eP,logImpl:tP,maxImpl:nP,maximumImpl:sP,minimumImpl:rP,multiplyImpl:r$,negImpl:oP,notEqualImpl:iP,prodImpl:aP,raggedGatherImpl:lP,raggedRangeImpl:uP,raggedTensorToTensorImpl:cP,rangeImpl:dP,rsqrtImpl:fP,scatterImpl:Oi,sigmoidImpl:$K,simpleAbsImpl:PF,sliceImpl:pP,sparseFillEmptyRowsImpl:mP,sparseReshapeImpl:gP,sparseSegmentReductionImpl:i$,sqrtImpl:SK,squaredDifferenceImpl:xP,staticRegexReplaceImpl:yP,stridedSliceImpl:vP,stringNGramsImpl:bP,stringSplitImpl:wP,stringToHashBucketFastImpl:$P,subImpl:CP,tileImpl:kP,topKImpl:IP,transposeImpl:o$,uniqueImpl:TP},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */HN("cpu",()=>new Xg,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EP=qe(pd,t=>t>=0?t:Math.exp(t)-1),MK={kernelName:pd,backendName:"cpu",kernelFunc:EP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NP(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{alpha:o}=s;fe([r],"leakyRelu");const i=Y(r.shape),a=n.data.get(r.dataId).values,l=hn("float32",i);for(let u=0;u<a.length;u++)l[u]=a[u]<0?o*a[u]:a[u];return n.makeTensorInfo(r.shape,"float32",l)}const _K={kernelName:Hm,backendName:"cpu",kernelFunc:NP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zK=At((t,e)=>t<0?e*t:t);function RP(t){const{inputs:e,backend:n}=t,{x:s,alpha:r}=e;fe([s,r],"prelu");const o=n.data.get(s.dataId).values,i=n.data.get(r.dataId).values,[a,l]=zK(s.shape,r.shape,o,i,"float32");return n.makeTensorInfo(l,"float32",a)}const VK={kernelName:cg,backendName:"cpu",kernelFunc:RP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AP=qe(Fd,t=>Math.max(0,t)),BK={kernelName:Fd,backendName:"cpu",kernelFunc:AP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DP=qe(Pd,t=>Math.min(Math.max(0,t),6)),WK={kernelName:Pd,backendName:"cpu",kernelFunc:DP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dp(t,e,n,s,r){if(n==="linear")return zr({inputs:{x:e},backend:t});if(n==="relu")return AP({inputs:{x:e},backend:t});if(n==="elu")return EP({inputs:{x:e},backend:t});if(n==="relu6")return DP({inputs:{x:e},backend:t});if(n==="prelu")return RP({inputs:{x:e,alpha:s},backend:t});if(n==="leakyrelu")return NP({inputs:{x:e},backend:t,attrs:{alpha:r}});if(n==="sigmoid")return hP({inputs:{x:e},backend:t});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rt(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{shape:o}=s,i=Y(r.shape),a=QE(o,i),l=Y(a);N(i===l,()=>`The new shape (${a}) has ${l} elements and the old shape (${r.shape}) has ${i} elements. The new shape and old shape must have the same number of elements.`),n.incRef(r.dataId);const u=n.data.get(r.dataId);if(u.complexTensorInfos!=null){const c=u.complexTensorInfos.real,d=u.complexTensorInfos.imag;c.shape=a,d.shape=a}return{dataId:r.dataId,shape:a,dtype:r.dtype}}const UK={kernelName:fg,backendName:"cpu",kernelFunc:rt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FP(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:o}=e,{transposeA:i,transposeB:a}=s;fe([r,o],"matMul");const l=r.shape.length,u=o.shape.length,c=i?r.shape[l-2]:r.shape[l-1],d=a?o.shape[u-1]:o.shape[u-2],f=i?r.shape[l-1]:r.shape[l-2],h=a?o.shape[u-2]:o.shape[u-1],p=r.shape.slice(0,-2),g=o.shape.slice(0,-2),y=Y(p),m=Y(g),v=Se(r.shape.slice(0,-2),o.shape.slice(0,-2)).concat([f,h]);N(c===d,()=>`Error in matMul: inner shapes (${c}) and (${d}) of Tensors with shapes ${r.shape} and ${o.shape} and transposeA=${i} and transposeB=${a} must match.`);const b=i?[y,c,f]:[y,f,c],$=a?[m,h,d]:[m,d,h],C=rt({inputs:{x:r},backend:n,attrs:{shape:b}}),k=rt({inputs:{x:o},backend:n,attrs:{shape:$}}),w=i?C.shape[1]:C.shape[2],I=i?C.shape[2]:C.shape[1],R=a?k.shape[1]:k.shape[2],E=Math.max(y,m),A=n.data.get(C.dataId).values,S=n.data.get(k.dataId).values,T=me(C.shape),F=me(k.shape),[M,U,P]=i?[T[0],1,T[1]]:[T[0],T[1],1],[L,G,X]=a?[1,F[1],F[0]]:[F[1],1,F[0]],Q=I*R,Z=Ee([E,I,R],C.dtype),te=Z.values,ee=n.blockSize;for(let se=0;se<E;se++){const le=se%y,pe=se%m;for(let ae=0;ae<I;ae+=ee){const be=Math.min(ae+ee,I);for(let ke=0;ke<R;ke+=ee){const Pe=Math.min(ke+ee,R);for(let Be=0;Be<w;Be+=ee){const et=Math.min(Be+ee,w);for(let We=ae;We<be;We++)for(let ze=ke;ze<Pe;ze++){let Ye=0;for(let Qe=Be;Qe<et;Qe++){const Ce=A[le*M+We*U+Qe*P],Mt=S[Qe*L+ze*G+pe*X];Ye+=Ce*Mt}te[se*Q+(We*R+ze)]+=Ye}}}}}return n.disposeIntermediateTensorInfo(C),n.disposeIntermediateTensorInfo(k),n.makeTensorInfo(v,Z.dtype,Z.values)}const GK={kernelName:Rm,backendName:"cpu",kernelFunc:FP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HK(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:o,bias:i,preluActivationWeights:a}=e,{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:d}=s;let f,h,p;const g=[];f=FP({inputs:{a:r,b:o},attrs:{transposeA:l,transposeB:u},backend:n}),i&&(h=_l({inputs:{a:f,b:i},backend:n}),g.push(f),f=h),c&&(p=Dp(n,f,c,a,d),g.push(f),f=p);for(const m of g)n.disposeIntermediateTensorInfo(m);return f}const jK={kernelName:dp,backendName:"cpu",kernelFunc:HK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KK=qe(td,t=>Math.acos(t)),XK={kernelName:td,backendName:"cpu",kernelFunc:KK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qK=qe(nd,t=>Math.acosh(t)),YK={kernelName:nd,backendName:"cpu",kernelFunc:qK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QK(t){const{inputs:e,backend:n}=t,s=e;fe(e,"addN");const r=s.map(a=>n.data.get(a.dataId).values),o=Ee(s[0].shape,s[0].dtype),i=o.values;for(let a=0;a<s.length;a++){const l=r[a];for(let u=0;u<i.length;u++)i[u]+=l[u]}return n.makeTensorInfo(o.shape,o.dtype,o.values)}const ZK={kernelName:Mb,backendName:"cpu",kernelFunc:QK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JK(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,keepDims:i}=s;fe(r,"all");const a=Ne(o,r.shape);let l=a;const u=vt(l,r.shape.length);let c=r;u!=null&&(c=Un({inputs:{x:r},backend:n,attrs:{perm:u}}),l=Nt(l.length,r.shape.length)),on("all",l,c.shape.length);const[d,f]=Jt(c.shape,l),h=Y(f),p=pn(Y(d),c.dtype),g=n.data.get(c.dataId).values;for(let m=0;m<p.length;++m){const x=m*h;let v=g[x];for(let b=0;b<h;++b){const $=g[x+b];v=v&&$}p[m]=v}u!=null&&n.disposeIntermediateTensorInfo(c);const y=n.makeTensorInfo(d,c.dtype,p);if(i){const m=Lt(d,a),x=rt({inputs:{x:y},backend:n,attrs:{shape:m}});return n.disposeIntermediateTensorInfo(y),x}return y}const e9={kernelName:_b,backendName:"cpu",kernelFunc:JK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t9(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,keepDims:i}=s;fe(r,"any");const a=Ne(o,r.shape);let l=a;const u=vt(l,r.shape.length);let c=r;u!=null&&(c=Un({inputs:{x:r},backend:n,attrs:{perm:u}}),l=Nt(l.length,r.shape.length)),on("any",l,c.shape.length);const[d,f]=Jt(c.shape,l),h=Y(f),p=pn(Y(d),c.dtype),g=n.data.get(c.dataId).values;for(let m=0;m<p.length;++m){const x=m*h;let v=g[x];for(let b=0;b<h;++b){const $=g[x+b];v=v||$}p[m]=v}u!=null&&n.disposeIntermediateTensorInfo(c);const y=n.makeTensorInfo(d,c.dtype,p);if(i){const m=Lt(d,a),x=rt({inputs:{x:y},backend:n,attrs:{shape:m}});return n.disposeIntermediateTensorInfo(y),x}return y}const n9={kernelName:zb,backendName:"cpu",kernelFunc:t9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s9(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o}=s;fe(r,"argMax");let i=Ne(o,r.shape);const a=vt(i,r.shape.length);let l=r;const u=[];a!=null&&(l=Un({inputs:{x:r},backend:n,attrs:{perm:a}}),u.push(l),i=Nt(i.length,l.shape.length)),i=[i[0]],on("argMax",i,l.shape.length);const[c,d]=Jt(l.shape,i),f=Y(c),h=pn(f,"int32"),p=Y(d),g=n.data.get(l.dataId).values;for(let y=0;y<h.length;++y){const m=y*p;let x=g[m],v=0;for(let b=0;b<p;++b){const $=g[m+b];$>x&&(x=$,v=b)}h[y]=v}return u.forEach(y=>n.disposeIntermediateTensorInfo(y)),n.makeTensorInfo(c,"int32",h)}const r9={kernelName:Im,backendName:"cpu",kernelFunc:s9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o9(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o}=s;fe(r,"argMin");let i=Ne(o,r.shape);const a=vt(i,r.shape.length);let l=r;const u=[];a!=null&&(l=Un({inputs:{x:r},backend:n,attrs:{perm:a}}),u.push(l),i=Nt(i.length,l.shape.length)),i=[i[0]],on("argMin",i,l.shape.length);const[c,d]=Jt(l.shape,i),f=Y(c),h=pn(f,"int32"),p=Y(d),g=n.data.get(l.dataId).values;for(let y=0;y<h.length;++y){const m=y*p;let x=g[m],v=0;for(let b=0;b<p;++b){const $=g[m+b];$<x&&(x=$,v=b)}h[y]=v}return u.forEach(y=>n.disposeIntermediateTensorInfo(y)),n.makeTensorInfo(c,"int32",h)}const i9={kernelName:Tm,backendName:"cpu",kernelFunc:o9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a9=qe(sd,t=>Math.asin(t)),l9={kernelName:sd,backendName:"cpu",kernelFunc:a9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u9=qe(rd,t=>Math.asinh(t)),c9={kernelName:rd,backendName:"cpu",kernelFunc:u9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d9=qe(od,t=>Math.atan(t)),f9={kernelName:od,backendName:"cpu",kernelFunc:d9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h9=At((t,e)=>Math.atan2(t,e)),p9=jt(ad,h9),m9={kernelName:ad,backendName:"cpu",kernelFunc:p9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g9=qe(id,t=>Math.atanh(t)),x9={kernelName:id,backendName:"cpu",kernelFunc:g9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l$(t,e,n,s,r,o){const i=r.strideHeight,a=r.strideWidth,l=r.dilationHeight,u=r.dilationWidth,c=r.effectiveFilterHeight,d=r.effectiveFilterWidth,f=r.padInfo.top,h=r.padInfo.left,p=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,g=Ee(r.outShape,n),y=g.values,m=r.outShape[1]*r.outShape[2]*r.outShape[3],x=r.outShape[2]*r.outShape[3],v=r.outShape[3];for(let b=0;b<r.batchSize;++b){const $=b*m,C=b*s[0];for(let k=0;k<r.inChannels;++k)for(let w=0;w<r.outHeight;++w){const I=w*i-f,R=Math.max(0,I),E=Math.min(r.inHeight,c+I),A=$+w*x;for(let S=0;S<r.outWidth;++S){const T=S*a-h,F=Math.max(0,T),M=Math.min(r.inWidth,d+T);let U=p,P=0,L=0;for(let X=R;X<E;X+=l){const Q=C+X*s[1];for(let Z=F;Z<M;Z+=u){const te=Q+Z*s[2],ee=t[te+k];o==="max"&&ee>U?U=ee:o==="avg"&&(P+=ee,L++)}if(isNaN(U))break}const G=A+S*v+k;y[G]=o==="avg"?P/L:U}}}return g}function PP(t,e,n,s,r=!1,o=!1){const i=Ee(s.outShape,"int32"),a=s.strideHeight,l=s.strideWidth,u=s.dilationHeight,c=s.dilationWidth,d=s.effectiveFilterHeight,f=s.effectiveFilterWidth,h=s.padInfo.top,p=s.padInfo.left,g=Ee(e,n,t);for(let y=0;y<s.batchSize;++y)for(let m=0;m<s.inChannels;++m)for(let x=0;x<s.outHeight;++x){const v=x*a-h;let b=v;for(;b<0;)b+=u;const $=Math.min(s.inHeight,d+v);for(let C=0;C<s.outWidth;++C){const k=C*l-p;let w=k;for(;w<0;)w+=c;const I=Math.min(s.inWidth,f+k);let R=Number.NEGATIVE_INFINITY,E=-1;for(let A=b;A<$;A+=u){const S=A-v;for(let T=w;T<I;T+=c){const F=T-k,M=g.get(y,A,T,m);M>R&&(R=M,r?E=o?((y*s.inHeight+A)*s.inWidth+T)*s.inChannels+m:(A*s.inWidth+T)*s.inChannels+m:E=S*f+F)}}i.set(E,y,x,C,m)}}return i}function OP(t,e,n,s,r,o){const i=r.strideDepth,a=r.strideHeight,l=r.strideWidth,u=r.dilationDepth,c=r.dilationHeight,d=r.dilationWidth,f=r.effectiveFilterDepth,h=r.effectiveFilterHeight,p=r.effectiveFilterWidth,g=r.padInfo.front,y=r.padInfo.top,m=r.padInfo.left,x=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,v=Ee(r.outShape,n),b=v.values,$=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],C=r.outShape[2]*r.outShape[3]*r.outShape[4],k=r.outShape[3]*r.outShape[4],w=r.outShape[4];for(let I=0;I<r.batchSize;++I){const R=I*$,E=I*s[0];for(let A=0;A<r.inChannels;++A)for(let S=0;S<r.outDepth;++S){const T=S*i-g;let F=T;for(;F<0;)F+=u;const M=Math.min(r.inDepth,f+T),U=R+S*C;for(let P=0;P<r.outHeight;++P){const L=P*a-y;let G=L;for(;G<0;)G+=c;const X=Math.min(r.inHeight,h+L),Q=U+P*k;for(let Z=0;Z<r.outWidth;++Z){const te=Z*l-m;let ee=te;for(;ee<0;)ee+=d;const se=Math.min(r.inWidth,p+te),le=Q+Z*w;let pe=x,ae=0,be=0;for(let Pe=F;Pe<M;Pe+=u){const Be=E+Pe*s[1];for(let et=G;et<X;et+=c){const We=Be+et*s[2];for(let ze=ee;ze<se;ze+=d){const Ye=We+ze*s[3],Qe=t[Ye+A];if(o==="max"&&Qe>pe?pe=Qe:o==="avg"&&(ae+=Qe,be++),isNaN(pe))break}if(isNaN(pe))break}if(isNaN(pe))break}const ke=le+A;b[ke]=o==="avg"?ae/Math.max(be,1):pe}}}}return v}function y9(t,e){const n=Ee(e.outShape,"int32"),s=e.strideDepth,r=e.strideHeight,o=e.strideWidth,i=e.dilationDepth,a=e.dilationHeight,l=e.dilationWidth,u=e.effectiveFilterDepth,c=e.effectiveFilterHeight,d=e.effectiveFilterWidth,f=e.padInfo.front,h=e.padInfo.top,p=e.padInfo.left;for(let g=0;g<e.batchSize;++g)for(let y=0;y<e.inChannels;++y)for(let m=0;m<e.outDepth;++m){const x=m*s-f;let v=x;for(;v<0;)v+=i;const b=Math.min(e.inDepth,u+x);for(let $=0;$<e.outHeight;++$){const C=$*r-h;let k=C;for(;k<0;)k+=a;const w=Math.min(e.inHeight,c+C);for(let I=0;I<e.outWidth;++I){const R=I*o-p;let E=R;for(;E<0;)E+=l;const A=Math.min(e.inWidth,d+R);let S=Number.NEGATIVE_INFINITY,T=-1;for(let F=v;F<b;F+=i){const M=F-x;for(let U=k;U<w;U+=a){const P=U-C;for(let L=E;L<A;L+=l){const G=L-R,X=t.get(g,F,U,L,y);X>=S&&(S=X,T=M*c*d+P*c+G)}}}n.set(T,g,m,$,I,y)}}}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v9(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;fe(r,"avgPool");const{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=s,u=1;N(gn(i,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const c=Gs(r.shape,o,i,u,a,l);let d;if(c.filterWidth===1&&c.filterHeight===1&&He(c.inShape,c.outShape))d=zr({inputs:{x:r},backend:n});else{const f=n.data.get(r.dataId).values,h=me(r.shape),p=l$(f,r.shape,r.dtype,h,c,"avg");d=n.makeTensorInfo(c.outShape,r.dtype,p.values)}return d}const b9={kernelName:Em,backendName:"cpu",kernelFunc:v9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w9(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:o,strides:i,pad:a,dimRoundingMode:l,dataFormat:u}=s;fe(r,"avgPool3d");const c=xo(r.shape,o,i,1,a,l,u),d=n.data.get(r.dataId).values,f=OP(d,r.shape,r.dtype,me(r.shape),c,"avg");return n.makeTensorInfo(f.shape,"float32",f.values)}const $9={kernelName:Nm,backendName:"cpu",kernelFunc:w9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C9(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:o}=e,{filterSize:i,strides:a,pad:l,dimRoundingMode:u}=s;fe([r,o],"avgPool3DGrad");const c=xo(o.shape,i,a,1,l,u),d=c.strideDepth,f=c.strideHeight,h=c.strideWidth,p=c.filterDepth,g=c.filterHeight,y=c.filterWidth,m=c.dilationDepth,x=c.dilationHeight,v=c.dilationWidth,b=c.effectiveFilterDepth,$=c.effectiveFilterHeight,C=c.effectiveFilterWidth,k=b-1-c.padInfo.front,w=C-1-c.padInfo.left,I=$-1-c.padInfo.top,R=Ee(o.shape,"float32"),E=1/(p*g*y),A=n.bufferSync(r);for(let S=0;S<c.batchSize;++S)for(let T=0;T<c.inChannels;++T)for(let F=0;F<c.inDepth;++F)for(let M=0;M<c.inHeight;++M)for(let U=0;U<c.inWidth;++U){const P=F-k,L=M-I,G=U-w;let X=0;for(let Q=0;Q<b;Q+=m){const Z=(P+Q)/d;if(!(Z<0||Z>=c.outDepth||Math.floor(Z)!==Z))for(let te=0;te<$;te+=x){const ee=(L+te)/f;if(!(ee<0||ee>=c.outHeight||Math.floor(ee)!==ee))for(let se=0;se<C;se+=v){const le=(G+se)/h;if(le<0||le>=c.outWidth||Math.floor(le)!==le)continue;const pe=A.get(S,Z,ee,le,T);X+=pe}}}R.set(X*E,S,F,M,U,T)}return n.makeTensorInfo(R.shape,R.dtype,R.values)}const k9={kernelName:Bb,backendName:"cpu",kernelFunc:C9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S9(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:o}=e,i=o;fe([r,o],"avgPoolGrad");const{filterSize:a,strides:l,pad:u}=s,c=Gs(i.shape,a,l,1,u),d=c.strideHeight,f=c.strideWidth,h=c.filterHeight,p=c.filterWidth,g=c.dilationHeight,y=c.dilationWidth,m=c.effectiveFilterHeight,x=c.effectiveFilterWidth,v=x-1-c.padInfo.left,b=m-1-c.padInfo.top,$=Ee(i.shape,"float32"),C=1/(h*p),k=n.data.get(r.dataId).values,w=Ee(r.shape,"float32",k);for(let I=0;I<c.batchSize;++I)for(let R=0;R<c.inChannels;++R)for(let E=0;E<c.inHeight;++E)for(let A=0;A<c.inWidth;++A){const S=E-b,T=A-v;let F=0;for(let M=0;M<m;M+=g){const U=(S+M)/d;if(!(U<0||U>=c.outHeight||Math.floor(U)!==U))for(let P=0;P<x;P+=y){const L=(T+P)/f;if(L<0||L>=c.outWidth||Math.floor(L)!==L)continue;const G=w.get(I,U,L,R);F+=G}}$.set(F*C,I,E,A,R)}return n.makeTensorInfo($.shape,$.dtype,$.values)}const I9={kernelName:Vb,backendName:"cpu",kernelFunc:S9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T9(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,scale:o,offset:i,mean:a,variance:l}=e;N(a.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),N(i==null||a.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),N(o==null||a.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),fe([r,a,l,o,i],"batchNorm");let{varianceEpsilon:u}=s;u==null&&(u=.001);const c=n.data.get(r.dataId).values,d=n.data.get(a.dataId).values,f=n.data.get(l.dataId).values,h=o?n.data.get(o.dataId).values:new Float32Array([1]),p=i?n.data.get(i.dataId).values:new Float32Array([0]),g=new Float32Array(c.length),y=p.length,m=h.length,x=f.length,v=d.length;let b=0,$=0,C=0,k=0;for(let w=0;w<c.length;++w)g[w]=p[b++]+(c[w]-d[$++])*h[C++]/Math.sqrt(f[k++]+u),b>=y&&(b=0),$>=v&&($=0),C>=m&&(C=0),k>=x&&(k=0);return n.makeTensorInfo(r.shape,r.dtype,g)}const E9={kernelName:Wm,backendName:"cpu",kernelFunc:T9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N9(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:o,crops:i}=s;fe([r],"batchToSpaceND");const a=o.reduce((m,x)=>m*x),l=tf(r.shape,o,a),u=nf(l.length,o.length),c=sf(r.shape,o,a),d=yw(i,o.length),f=vw(c,i,o.length),h=rt({inputs:{x:r},backend:n,attrs:{shape:l}}),p=Un({inputs:{x:h},backend:n,attrs:{perm:u}}),g=rt({inputs:{x:p},backend:n,attrs:{shape:c}}),y=da({inputs:{x:g},backend:n,attrs:{begin:d,size:f}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),y}const R9={kernelName:Am,backendName:"cpu",kernelFunc:N9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A9(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:o}=e,{size:i}=s,a=n.data.get(r.dataId).values,l=n.data.get(o.dataId).values,u=s$(a,l,o.dtype,o.shape,i);return n.makeTensorInfo([i],o.dtype,u)}const D9={kernelName:Wb,backendName:"cpu",kernelFunc:A9};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F9(t){const{inputs:e,backend:n}=t,{s0:s,s1:r}=e,o=n.data.get(s.dataId).values,i=n.data.get(r.dataId).values,a=Se(Array.from(o),Array.from(i));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const P9={kernelName:sN,backendName:"cpu",kernelFunc:F9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O9=qe(cd,(t,e)=>{const n=e;return t>n.clipValueMax?n.clipValueMax:t<n.clipValueMin?n.clipValueMin:t}),L9={kernelName:cd,backendName:"cpu",kernelFunc:O9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M9=t=>{const{x:e}=t.inputs,n=t.backend,s=new Float32Array(Y(e.shape)),r=n.data.get(e.dataId),o=r.complexTensorInfos.real,i=r.complexTensorInfos.imag,a=n.data.get(o.dataId).values,l=n.data.get(i.dataId).values;for(let u=0;u<a.length;u++){const c=a[u],d=l[u];s[u]=Math.hypot(c,d)}return n.makeOutput(s,e.shape,"float32")},_9={kernelName:Dm,backendName:"cpu",kernelFunc:M9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zl(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.data.get(s.dataId).complexTensorInfos.imag,o=n.data.get(r.dataId).values;return n.makeTensorInfo(r.shape,r.dtype,o)}const z9={kernelName:i1,backendName:"cpu",kernelFunc:zl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vl(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s,o=Ne(r,e[0].shape)[0],i=e.map(g=>g.shape);mw(i,o);let a=Ar(e.map(g=>g.shape),o);if(Y(a)===0)return n.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(g=>Y(g.shape)>0);if(l.length===1)return zr({inputs:{x:l[0]},backend:n});if(l[0].dtype==="complex64"){const g=l.map(b=>ca({inputs:{input:b},backend:n})),y=l.map(b=>zl({inputs:{input:b},backend:n})),m=Vl({inputs:g,backend:n,attrs:{axis:o}}),x=Vl({inputs:y,backend:n,attrs:{axis:o}}),v=qn({inputs:{real:m,imag:x},backend:n});return g.forEach(b=>n.disposeIntermediateTensorInfo(b)),y.forEach(b=>n.disposeIntermediateTensorInfo(b)),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(x),v}const u=l.map(g=>{const m=[-1,Y(g.shape.slice(o))];return rt({inputs:{x:g},backend:n,attrs:{shape:m}})}),c=u.map(g=>({vals:n.data.get(g.dataId).values,shape:g.shape}));a=Ar(u.map(g=>g.shape),1);const d=u[0].shape[0]===1,f=VF(c,a,e[0].dtype,d),h=Ar(l.map(g=>g.shape),o),p=n.makeTensorInfo(h,e[0].dtype,f);return u.forEach(g=>n.disposeIntermediateTensorInfo(g)),p}const V9={kernelName:Fm,backendName:"cpu",kernelFunc:Vl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LP(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:o}=e,{strides:i,pad:a,dataFormat:l,dilations:u,dimRoundingMode:c}=s;fe([r,o],"conv2d");const d=yo(l),f=rn(r.shape,o.shape,i,u,a,c,!1,d),h=f.filterHeight,p=f.filterWidth,g=f.dilationHeight,y=f.dilationWidth,m=f.padInfo.left,x=f.padInfo.top,v=f.dataFormat==="channelsLast",b=new sn(f.outShape,r.dtype),$=me(r.shape),C=me(o.shape),k=$[0],w=v?$[1]:$[2],I=v?$[2]:1,R=v?1:$[1],E=b.strides[0],A=v?b.strides[1]:b.strides[2],S=v?b.strides[2]:1,T=v?1:b.strides[1],F=n.data.get(r.dataId).values,M=n.data.get(o.dataId).values,U=b.values;for(let P=0;P<f.batchSize;++P){const L=P*k,G=P*E;for(let X=0;X<f.outHeight;++X){const Q=G+X*A,Z=X*f.strideHeight-x;for(let te=0;te<h;++te){const ee=Z+te*g;if(ee<0||ee>=f.inHeight)continue;const se=te*C[0],le=L+ee*w;for(let pe=0;pe<f.outWidth;++pe){const ae=Q+pe*S,be=pe*f.strideWidth-m;for(let ke=0;ke<p;++ke){const Pe=be+ke*y;if(Pe<0||Pe>=f.inWidth)continue;const Be=se+ke*C[1],et=le+Pe*I;let We=Be;for(let ze=0;ze<f.inChannels;++ze){const Ye=F[et+ze*R];for(let Qe=0;Qe<f.outChannels;++Qe)U[ae+Qe*T]+=Ye*M[We+Qe];We+=f.outChannels}}}}}}return n.makeTensorInfo(b.shape,b.dtype,U)}const B9={kernelName:Pm,backendName:"cpu",kernelFunc:LP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W9(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:o}=e,{strides:i,pad:a,dataFormat:l,dimRoundingMode:u,filterShape:c}=s;fe([r,o],"conv2dBackpropFilter");const d=yo(l),f=rn(r.shape,c,i,1,a,u,!1,d),{strideHeight:h,strideWidth:p,filterHeight:g,filterWidth:y}=f,m=f.dataFormat==="channelsLast",x=new sn(f.filterShape,"float32"),v=f.padInfo.left,b=f.padInfo.top,$=n.data.get(r.dataId).values,C=n.data.get(o.dataId).values,k=new sn(r.shape,r.dtype,$),w=new sn(o.shape,o.dtype,C);for(let I=0;I<g;++I){const R=Math.max(0,Math.ceil((b-I)/h)),E=Math.min(f.outHeight,(f.inHeight+b-I)/h);for(let A=0;A<y;++A){const S=Math.max(0,Math.ceil((v-A)/p)),T=Math.min(f.outWidth,(f.inWidth+v-A)/p);for(let F=0;F<f.inChannels;++F)for(let M=0;M<f.outChannels;++M){let U=0;for(let P=0;P<f.batchSize;++P)for(let L=R;L<E;++L){const G=I+L*h-b;for(let X=S;X<T;++X){const Q=A+X*p-v;m?U+=k.get(P,G,Q,F)*w.get(P,L,X,M):U+=k.get(P,F,G,Q)*w.get(P,M,L,X)}}x.set(U,I,A,F,M)}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}const U9={kernelName:Hb,backendName:"cpu",kernelFunc:W9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G9(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:o}=e,{inputShape:i,strides:a,pad:l,dataFormat:u,dimRoundingMode:c}=s;fe([r,o],"conv2dBackpropInput");const d=me(o.shape),f=me(r.shape);let h=yo(u);const p=rn(i,o.shape,a,1,l,c,!1,h),g=new sn(p.inShape,"float32"),y=g.values,m=n.data.get(r.dataId).values,x=n.data.get(o.dataId).values,[v,b,$]=d,{batchSize:C,filterHeight:k,filterWidth:w,inChannels:I,inHeight:R,inWidth:E,outChannels:A,outHeight:S,outWidth:T,strideHeight:F,strideWidth:M}=p;h=p.dataFormat;const U=k-1-p.padInfo.top,P=w-1-p.padInfo.left,L=h==="channelsLast",G=g.strides[0],X=L?g.strides[1]:g.strides[2],Q=L?g.strides[2]:1,Z=L?1:g.strides[1],te=f[0],ee=L?f[1]:f[2],se=L?f[2]:1,le=L?1:f[1];for(let pe=0;pe<C;++pe)for(let ae=0;ae<I;++ae)for(let be=0;be<R;++be){const ke=be-U,Pe=Math.max(0,Math.ceil(ke/F)),Be=Math.min(S,(k+ke)/F);for(let et=0;et<E;++et){const We=et-P,ze=Math.max(0,Math.ceil(We/M)),Ye=Math.min(T,(w+We)/M);let Qe=0;for(let Mt=Pe;Mt<Be;++Mt){const mr=Mt*F-ke;for(let Dt=ze;Dt<Ye;++Dt){const vi=Dt*M-We,Ks=te*pe+ee*Mt+se*Dt,Ur=v*(k-1-mr)+b*(w-1-vi)+$*ae;for(let $o=0;$o<A;++$o){const Co=m[Ks+le*$o],ko=x[Ur+$o];Qe+=Co*ko}}}const Ce=G*pe+X*be+Q*et+Z*ae;y[Ce]=Qe}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}const H9={kernelName:Om,backendName:"cpu",kernelFunc:G9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j9(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:o}=e,{strides:i,pad:a,dilations:l}=s;fe([r,o],"conv3d");const u=fi(r.shape,o.shape,i,l,a),{filterDepth:c,filterHeight:d,filterWidth:f,dilationDepth:h,dilationHeight:p,dilationWidth:g,padInfo:y}=u,m=y.front,x=y.left,v=y.top,b=new sn(u.outShape,r.dtype),$=n.data.get(r.dataId).values,C=n.data.get(o.dataId).values,k=b.values,w=me(r.shape),I=me(o.shape);for(let R=0;R<u.batchSize;++R){const E=R*w[0],A=R*b.strides[0];for(let S=0;S<u.outDepth;++S){const T=A+S*b.strides[1],F=S*u.strideDepth-m;for(let M=0;M<c;++M){const U=F+M*h;if(U<0||U>=u.inDepth)continue;const P=M*I[0],L=E+U*w[1];for(let G=0;G<u.outHeight;++G){const X=T+G*b.strides[2],Q=G*u.strideHeight-v;for(let Z=0;Z<d;++Z){const te=Q+Z*p;if(te<0||te>=u.inHeight)continue;const ee=P+Z*I[1],se=L+te*w[2];for(let le=0;le<u.outWidth;++le){const pe=X+le*u.outChannels,ae=le*u.strideWidth-x;for(let be=0;be<f;++be){const ke=ae+be*g;if(ke<0||ke>=u.inWidth)continue;const Pe=ee+be*I[2],Be=se+ke*u.inChannels;let et=Pe;for(let We=0;We<u.inChannels;++We){const ze=$[Be+We];for(let Ye=0;Ye<u.outChannels;++Ye)k[pe+Ye]+=ze*C[et+Ye];et+=u.outChannels}}}}}}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}const K9={kernelName:Lm,backendName:"cpu",kernelFunc:j9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X9(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:o}=e,{strides:i,pad:a,filterShape:l}=s;fe([r,o],"conv3dBackpropFilterV2");const u=me(r.shape),c=me(o.shape),d=fi(r.shape,l,i,1,a),f=d.strideDepth,h=d.strideHeight,p=d.strideWidth,g=d.filterDepth,y=d.filterHeight,m=d.filterWidth,x=new sn(d.filterShape,"float32"),v=x.values,[b,$,C,k]=x.strides,w=n.data.get(o.dataId).values,[I,R,E,A]=c,S=n.data.get(r.dataId).values,[T,F,M,U]=u,P=d.padInfo.front,L=d.padInfo.left,G=d.padInfo.top;for(let X=0;X<g;++X){const Q=Math.max(0,Math.ceil((P-X)/f)),Z=Math.min(d.outDepth,(d.inDepth+P-X)/f),te=X*b;for(let ee=0;ee<y;++ee){const se=Math.max(0,Math.ceil((G-ee)/h)),le=Math.min(d.outHeight,(d.inHeight+G-ee)/h),pe=ee*$+te;for(let ae=0;ae<m;++ae){const be=Math.max(0,Math.ceil((L-ae)/p)),ke=Math.min(d.outWidth,(d.inWidth+L-ae)/p),Pe=ae*C+pe;for(let Be=0;Be<d.inChannels;++Be){const et=Be*k+Pe;for(let We=0;We<d.outChannels;++We){let ze=0;for(let Ye=0;Ye<d.batchSize;++Ye){const Qe=Ye*T,Ce=Ye*I;for(let Mt=Q;Mt<Z;++Mt){const Dt=(X+Mt*f-P)*F+Qe,vi=Mt*R+Ce;for(let Ks=se;Ks<le;++Ks){const $o=(ee+Ks*h-G)*M+Dt,Co=Ks*E+vi;for(let ko=be;ko<ke;++ko){const m0=(ae+ko*p-L)*U+$o,g0=ko*A+Co;ze+=S[m0+Be]*w[g0+We]}}}}v[et+We]=ze}}}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}const q9={kernelName:jb,backendName:"cpu",kernelFunc:X9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y9(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:o}=e,{pad:i,strides:a,inputShape:l}=s;fe([r],"conv3dBackpropInputV2");const u=me(r.shape),c=me(o.shape),d=fi(l,o.shape,a,1,i),f=new sn(d.inShape,"float32"),h=f.values,[p,g,y,m]=f.strides,x=n.data.get(r.dataId).values,[v,b,$,C]=u,k=n.data.get(o.dataId).values,[w,I,R,E]=c,{batchSize:A,filterDepth:S,filterHeight:T,filterWidth:F,inChannels:M,inDepth:U,inHeight:P,inWidth:L,outChannels:G,outDepth:X,outHeight:Q,outWidth:Z,strideDepth:te,strideHeight:ee,strideWidth:se}=d,le=S-1-d.padInfo.front,pe=T-1-d.padInfo.top,ae=F-1-d.padInfo.left;for(let be=0;be<A;++be)for(let ke=0;ke<M;++ke)for(let Pe=0;Pe<U;++Pe){const Be=Pe-le,et=Math.max(0,Math.ceil(Be/te)),We=Math.min(X,(S+Be)/te);for(let ze=0;ze<P;++ze){const Ye=ze-pe,Qe=Math.max(0,Math.ceil(Ye/ee)),Ce=Math.min(Q,(T+Ye)/ee);for(let Mt=0;Mt<L;++Mt){const mr=Mt-ae,Dt=Math.max(0,Math.ceil(mr/se)),vi=Math.min(Z,(F+mr)/se);let Ks=0;for(let Ur=et;Ur<We;++Ur){const $o=Ur*te-Be;for(let Co=Qe;Co<Ce;++Co){const ko=Co*ee-Ye;for(let xu=Dt;xu<vi;++xu){const m0=xu*se-mr,g0=v*be+b*Ur+$*Co+C*xu,a_=w*(S-1-$o)+I*(T-1-ko)+R*(F-1-m0)+E*ke;for(let Ef=0;Ef<G;++Ef){const l_=x[g0+Ef],u_=k[a_+Ef];Ks+=l_*u_}}}}h[p*be+g*Pe+y*ze+m*Mt+ke]=Ks}}}return n.makeTensorInfo(f.shape,f.dtype,f.values)}const Q9={kernelName:Kb,backendName:"cpu",kernelFunc:Y9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z9=qe(dd,t=>Math.cos(t)),J9={kernelName:dd,backendName:"cpu",kernelFunc:Z9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eX=qe(fd,t=>Math.cosh(t)),tX={kernelName:fd,backendName:"cpu",kernelFunc:eX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nX(t){const{inputs:e,backend:n,attrs:s}=t,{image:r,boxes:o,boxInd:i}=e,{cropSize:a,method:l,extrapolationValue:u}=s,[c,d,f,h]=r.shape,p=o.shape[0],[g,y]=a,m=Ee([p,g,y,h],"float32"),x=n.data.get(o.dataId).values,v=n.data.get(i.dataId).values,b=n.data.get(r.dataId).values,$=me(r.shape),C=me(m.shape);for(let k=0;k<p;k++){const w=k*4,I=x[w],R=x[w+1],E=x[w+2],A=x[w+3],S=v[k];if(S>=c)continue;const T=g>1?(E-I)*(d-1)/(g-1):0,F=y>1?(A-R)*(f-1)/(y-1):0;for(let M=0;M<g;M++){const U=g>1?I*(d-1)+M*T:.5*(I+E)*(d-1);if(U<0||U>d-1){for(let P=0;P<y;P++)for(let L=0;L<h;L++){const G=L+P*C[2]+M*C[1]+k*C[0];m.values[G]=u}continue}if(l==="bilinear"){const P=Math.floor(U),L=Math.ceil(U),G=U-P;for(let X=0;X<y;X++){const Q=y>1?R*(f-1)+X*F:.5*(R+A)*(f-1);if(Q<0||Q>f-1){for(let se=0;se<h;se++){const le=se+X*C[2]+M*C[1]+k*C[0];m.values[le]=u}continue}const Z=Math.floor(Q),te=Math.ceil(Q),ee=Q-Z;for(let se=0;se<h;se++){let le=se+Z*$[2]+P*$[1]+S*$[0];const pe=b[le];le=se+te*$[2]+P*$[1]+S*$[0];const ae=b[le];le=se+Z*$[2]+L*$[1]+S*$[0];const be=b[le];le=se+te*$[2]+L*$[1]+S*$[0];const ke=b[le],Pe=pe+(ae-pe)*ee,Be=be+(ke-be)*ee;le=se+X*C[2]+M*C[1]+k*C[0],m.values[le]=Pe+(Be-Pe)*G}}}else for(let P=0;P<y;++P){const L=y>1?R*(f-1)+P*F:.5*(R+A)*(f-1);if(L<0||L>f-1){for(let Q=0;Q<h;Q++){const Z=Q+P*C[2]+M*C[1]+k*C[0];m.values[Z]=u}continue}const G=Math.round(L),X=Math.round(U);for(let Q=0;Q<h;Q++){const Z=Q+G*$[2]+X*$[1]+S*$[0],te=Q+P*C[2]+M*C[1]+k*C[0];m.values[te]=b[Z]}}}}return n.makeTensorInfo(m.shape,m.dtype,m.values)}const sX={kernelName:qb,backendName:"cpu",kernelFunc:nX};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rX(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,exclusive:i,reverse:a}=s;fe(r,"cumprod");const l=vt([o],r.shape.length);let u=r;l!=null&&(u=Un({inputs:{x:r},backend:n,attrs:{perm:l}}));const c=Nt(1,r.shape.length)[0];if(c!==u.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${c}`);const d=ss(u.dtype,"int32"),f=Pb(Y(u.shape),d),h=n.data.get(u.dataId).values,p=u.shape[u.shape.length-1],g=a?(m,x)=>m+p-x-1:(m,x)=>m+x;for(let m=0;m<h.length;m+=p)for(let x=0;x<p;x++){const v=g(m,x);if(x===0)f[v]=i?1:h[v];else{const b=g(m,x-1);f[v]=i?h[b]*f[b]:h[v]*f[b]}}const y=n.makeTensorInfo(u.shape,d,f);if(l!=null){const m=hi(l),x=Un({inputs:{x:y},backend:n,attrs:{perm:m}});return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(u),x}return y}const oX={kernelName:Xb,backendName:"cpu",kernelFunc:rX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iX(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,exclusive:i,reverse:a}=s;fe(r,"cumsum");const l=vt([o],r.shape.length);let u=r;l!=null&&(u=Un({inputs:{x:r},backend:n,attrs:{perm:l}}));const c=Nt(1,r.shape.length)[0];if(c!==u.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${c}`);const d=ss(u.dtype,"int32"),f=pn(Y(u.shape),d),h=n.data.get(u.dataId).values,p=u.shape[u.shape.length-1],g=a?(m,x)=>m+p-x-1:(m,x)=>m+x;for(let m=0;m<h.length;m+=p)for(let x=0;x<p;x++){const v=g(m,x);if(x===0)f[v]=i?0:h[v];else{const b=g(m,x-1);f[v]=i?h[b]+f[b]:h[v]+f[b]}}const y=n.makeTensorInfo(u.shape,d,f);if(l!=null){const m=hi(l),x=Un({inputs:{x:y},backend:n,attrs:{perm:m}});return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(u),x}return y}const aX={kernelName:Mm,backendName:"cpu",kernelFunc:iX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lX(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:o}=e,{size:i,binaryOutput:a}=s;if(r.shape.length===1){const l=n.data.get(r.dataId).values,u=n.data.get(o.dataId).values,c=s$(l,u,o.dtype,o.shape,i);return n.makeTensorInfo([i],o.dtype,c)}else if(r.shape.length===2){const l=n.bufferSync(r),u=n.bufferSync(o),c=MF(l,u,i,a);return n.makeTensorInfo(c.shape,o.dtype,c.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}const uX={kernelName:Yb,backendName:"cpu",kernelFunc:lX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cX(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockSize:o,dataFormat:i}=s;N(i==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${i}`);const a=r.shape[0],l=r.shape[1],u=r.shape[2],c=r.shape[3],d=l*o,f=u*o,h=c/(o*o),p=n.data.get(r.dataId).values,g=new Float32Array(a*d*f*h);let y=0;for(let m=0;m<a;++m)for(let x=0;x<d;++x){const v=Math.floor(x/o),b=x%o;for(let $=0;$<f;++$){const C=Math.floor($/o),k=$%o,w=(b*o+k)*h;for(let I=0;I<h;++I){const E=I+w+c*(C+u*(v+l*m));g[y++]=p[E]}}}return n.makeTensorInfo([a,d,f,h],r.dtype,g)}const dX={kernelName:Qb,backendName:"cpu",kernelFunc:cX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MP(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:o}=e,{strides:i,pad:a,dilations:l,dimRoundingMode:u}=s;fe([r,o],"depthwiseConv2DNative");const c=me(r.shape),d=me(o.shape);let f=l;f==null&&(f=[1,1]),N(gn(i,f),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${f}'`);const h=rn(r.shape,o.shape,i,f,a,u,!0),{filterHeight:p,filterWidth:g,dilationHeight:y,dilationWidth:m,padInfo:x}=h,v=x.left,b=x.top,$=h.outChannels/h.inChannels,C=new sn(h.outShape,r.dtype),k=n.data.get(r.dataId).values,w=n.data.get(o.dataId).values,I=C.values;for(let R=0;R<h.batchSize;++R){const E=R*c[0],A=R*C.strides[0];for(let S=0;S<h.outHeight;++S){const T=A+S*C.strides[1],F=S*h.strideHeight-b;for(let M=0;M<p;++M){const U=F+M*y;if(U<0||U>=h.inHeight)continue;const P=M*d[0],L=E+U*c[1];for(let G=0;G<h.outWidth;++G){const X=T+G*C.strides[2],Q=G*h.strideWidth-v;for(let Z=0;Z<g;++Z){const te=Q+Z*m;if(te<0||te>=h.inWidth)continue;const ee=P+Z*d[1],se=L+te*h.inChannels;let le=X,pe=ee;for(let ae=0;ae<h.inChannels;++ae){const be=k[se+ae];for(let ke=0;ke<$;++ke)I[le+ke]+=be*w[pe+ke];le+=$,pe+=$}}}}}}return n.makeTensorInfo(C.shape,C.dtype,C.values)}const fX={kernelName:_m,backendName:"cpu",kernelFunc:MP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hX(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:o}=e,{strides:i,dilations:a,pad:l,dimRoundingMode:u,filterShape:c}=s;fe([r,o],"depthwiseConv2dNativeBackpropFilter");const d=rn(r.shape,c,i,a,l,u,!0),{strideHeight:f,strideWidth:h,filterHeight:p,filterWidth:g}=d,y=new sn(d.filterShape,"float32"),m=d.padInfo.left,x=d.padInfo.top,v=d.outChannels/d.inChannels,b=n.data.get(r.dataId).values,$=new sn(r.shape,r.dtype,b),C=n.data.get(o.dataId).values,k=new sn(o.shape,o.dtype,C);for(let w=0;w<p;++w){const I=Math.max(0,Math.ceil((x-w)/f)),R=Math.min(d.outHeight,(d.inHeight+x-w)/f);for(let E=0;E<g;++E){const A=Math.max(0,Math.ceil((m-E)/h)),S=Math.min(d.outWidth,(d.inWidth+m-E)/h);for(let T=0;T<d.outChannels;++T){const F=Math.trunc(T/v),M=T%v;let U=0;for(let P=0;P<d.batchSize;++P)for(let L=I;L<R;++L){const G=w+L*f-x;for(let X=A;X<S;++X){const Q=E+X*h-m;U+=$.get(P,G,Q,F)*k.get(P,L,X,T)}}y.set(U,w,E,F,M)}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}const pX={kernelName:Zb,backendName:"cpu",kernelFunc:hX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mX(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:o}=e,{strides:i,dilations:a,pad:l,dimRoundingMode:u,inputShape:c}=s;fe([r,o],"depthwiseConv2DNativeBackpropInput");const d=me(r.shape),f=me(o.shape),h=rn(c,o.shape,i,a,l,u,!0),p=new sn(h.inShape,"float32"),g=p.values,[y,m,x]=p.strides,v=n.data.get(r.dataId).values,[b,$,C]=d,k=n.data.get(o.dataId).values,[w,I,R]=f,{batchSize:E,filterHeight:A,filterWidth:S,inChannels:T,inHeight:F,inWidth:M,outChannels:U,outHeight:P,outWidth:L,strideHeight:G,strideWidth:X}=h,Q=A-1-h.padInfo.top,Z=S-1-h.padInfo.left,te=U/T;for(let ee=0;ee<E;++ee)for(let se=0;se<T;++se)for(let le=0;le<F;++le){const pe=le-Q,ae=Math.max(0,Math.ceil(pe/G)),be=Math.min(P,(A+pe)/G);for(let ke=0;ke<M;++ke){const Pe=ke-Z,Be=Math.max(0,Math.ceil(Pe/X)),et=Math.min(L,(S+Pe)/X);let We=0;for(let ze=ae;ze<be;++ze){const Ye=ze*G-pe;for(let Qe=Be;Qe<et;++Qe){const Ce=Qe*X-Pe,Mt=b*ee+$*ze+C*Qe,mr=w*(A-1-Ye)+I*(S-1-Ce)+R*se;for(let Dt=0;Dt<te;++Dt){const vi=se*te+Dt,Ks=v[Mt+vi],Ur=k[mr+Dt];We+=Ks*Ur}}}g[y*ee+m*le+x*ke+se]=We}}return n.makeTensorInfo(p.shape,p.dtype,p.values)}const gX={kernelName:Jb,backendName:"cpu",kernelFunc:mX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xX(t){const{inputs:e,backend:n}=t,{x:s}=e,r=Y(s.shape),o=n.data.get(s.dataId).values,i=Ee([r,r],s.dtype),a=i.values;for(let u=0;u<o.length;u++)a[u*r+u]=o[u];const l=[...s.shape,...s.shape];return n.makeTensorInfo(l,i.dtype,i.values)}const yX={kernelName:rN,backendName:"cpu",kernelFunc:xX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vX={kernelName:zm,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:r}=t,{strides:o,pad:i,dilations:a}=n,l=e,u=l.data.get(s.dataId).values,c=s.shape.length,d=l.data.get(r.dataId).values,f=r.shape.length,{batchSize:h,inHeight:p,inWidth:g,inChannels:y,outHeight:m,outWidth:x,padInfo:v,strideHeight:b,strideWidth:$,filterHeight:C,filterWidth:k,dilationHeight:w,dilationWidth:I,outShape:R}=Yd(s.shape,r.shape,o,i,"NHWC",a),E=Y(R),A=R.length,S=St(s.dtype,E);for(let F=0;F<h;++F)for(let M=0;M<m;++M){const U=M*b-v.top;for(let P=0;P<x;++P){const L=P*$-v.left;for(let G=0;G<y;++G){let X=Number.MIN_SAFE_INTEGER;for(let Z=0;Z<C;++Z){const te=U+Z*w;if(te>=0&&te<p)for(let ee=0;ee<k;++ee){const se=L+ee*I;if(se>=0&&se<g){const le=Nr([F,te,se,G],c,me(s.shape)),pe=Nr([Z,ee,G],f,me(r.shape)),ae=u[le]+d[pe];ae>X&&(X=ae)}}}const Q=Nr([F,M,P,G],A,me(R));S[Q]=X}}}return{dataId:l.write(Ca(S,s.dtype),R,s.dtype),shape:R,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bX={kernelName:ky,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:r,dy:o}=t,{strides:i,pad:a,dilations:l}=n,u=e,c=ir(s.shape,u.data.get(s.dataId).values),d=ir(r.shape,u.data.get(r.dataId).values),{batchSize:f,inHeight:h,inWidth:p,inChannels:g,outHeight:y,outWidth:m,padInfo:x,strideHeight:v,strideWidth:b,filterHeight:$,filterWidth:C,dilationHeight:k,dilationWidth:w,outShape:I}=Yd(s.shape,r.shape,i,a,"NHWC",l);N(o.rank===I.length,()=>`Error in ${ky}, dy must have the same rank as output ${I.length}, but got ${o.rank}`);const R=ir(I,u.data.get(o.dataId).values),E=eN(r.shape,r.dtype);for(let S=0;S<f;++S)for(let T=0;T<y;++T){const F=T*v-x.top;for(let M=0;M<m;++M){const U=M*b-x.left;for(let P=0;P<g;++P){let L=Number.MIN_SAFE_INTEGER,G=0,X=0;for(let Q=0;Q<$;++Q){const Z=F+Q*k;if(Z>=0&&Z<h)for(let te=0;te<C;++te){const ee=U+te*w;if(ee>=0&&ee<p){const se=c[S][Z][ee][P]+d[Q][te][P];se>L&&(L=se,G=Q,X=te)}}}E[G][X][P]+=R[S][T][M][P]}}}return{dataId:u.write(Ca(E,s.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wX={kernelName:Cy,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:r,dy:o}=t,{strides:i,pad:a,dilations:l}=n,u=e,c=ir(s.shape,u.data.get(s.dataId).values),d=ir(r.shape,u.data.get(r.dataId).values),{batchSize:f,inHeight:h,inWidth:p,inChannels:g,outHeight:y,outWidth:m,padInfo:x,strideHeight:v,strideWidth:b,filterHeight:$,filterWidth:C,dilationHeight:k,dilationWidth:w,outShape:I}=Yd(s.shape,r.shape,i,a,"NHWC",l);N(o.rank===I.length,()=>`Error in ${Cy}, dy must have the same rank as output ${I.length}, but got ${o.rank}`);const R=ir(I,u.data.get(o.dataId).values),E=eN(s.shape,s.dtype);for(let S=0;S<f;++S)for(let T=0;T<y;++T){const F=T*v-x.top;for(let M=0;M<m;++M){const U=M*b-x.left;for(let P=0;P<g;++P){let L=Number.MIN_SAFE_INTEGER,G=F<0?0:F,X=U<0?0:U;for(let Q=0;Q<$;++Q){const Z=F+Q*k;if(Z>=0&&Z<h)for(let te=0;te<C;++te){const ee=U+te*w;if(ee>=0&&ee<p){const se=c[S][Z][ee][P]+d[Q][te][P];se>L&&(L=se,G=Z,X=ee)}}}E[S][G][X][P]+=R[S][T][M][P]}}}return{dataId:u.write(Ca(E,s.dtype),s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $X(t){const{inputs:e,backend:n,attrs:s}=t,{image:r}=e,{canvas:o,options:i}=s,{contextOptions:a,imageOptions:l}=i||{},u=(l==null?void 0:l.alpha)||1,c=(a==null?void 0:a.contextType)||"2d";if(c!=="2d")throw new Error(`Context type ${a.contextType} is not supported by the CPU backend.`);const d=o.getContext(c,(a==null?void 0:a.contextAttributes)||{});if(d==null)throw new Error(`Could not get the context with ${c} type.`);const[f,h]=r.shape.slice(0,2),p=r.shape.length===2?1:r.shape[2],g=n.data.get(r.dataId).values,y=r.dtype==="float32"?255:1,m=new Uint8ClampedArray(h*f*4);for(let v=0;v<f*h;++v){const b=[0,0,0,255*u];for(let C=0;C<p;C++){const k=g[v*p+C];if(r.dtype==="float32"){if(k<0||k>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${k}.`)}else if(r.dtype==="int32"&&(k<0||k>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${k}.`);p===1?(b[0]=k*y,b[1]=k*y,b[2]=k*y):b[C]=k*y}const $=v*4;m[$+0]=Math.round(b[0]),m[$+1]=Math.round(b[1]),m[$+2]=Math.round(b[2]),m[$+3]=Math.round(b[3])}o.width=h,o.height=f;const x=new ImageData(m,h,f);return d.putImageData(x,0,0),r}const CX={kernelName:sV,backendName:"cpu",kernelFunc:$X};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hf(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,keepDims:i}=s;fe(r,"sum");let a;r.dtype==="bool"?a=ii({inputs:{x:r},backend:n,attrs:{dtype:"int32"}}):a=zr({inputs:{x:r},backend:n});const l=a.shape.length,u=Ne(o,a.shape),c=vt(u,l);let d=u,f=a;c!=null&&(f=Un({inputs:{x:a},backend:n,attrs:{perm:c}}),d=Nt(d.length,l)),on("sum",d,f.shape.length);const[h,p]=Jt(f.shape,d),g=ss(f.dtype,"int32");let y=Rp(n,h,g);const m=Y(p),x=n.data.get(y.dataId).values,v=n.data.get(f.dataId).values;for(let b=0;b<x.length;++b){const $=b*m;let C=0;for(let k=0;k<m;++k)C+=v[$+k];x[b]=C}if(i){const b=Lt(y.shape,u),$=y;y=rt({inputs:{x:y},backend:n,attrs:{shape:b}}),n.disposeIntermediateTensorInfo($)}return n.disposeIntermediateTensorInfo(a),c!=null&&n.disposeIntermediateTensorInfo(f),y}const kX={kernelName:yg,backendName:"cpu",kernelFunc:hf};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SX(t){const{inputs:e,backend:n,attrs:s}=t,{equation:r}=s,o=e,{allDims:i,summedDims:a,idDims:l}=Tw(r,o.length);Nw(i.length,l,o);const{path:u,steps:c}=Rw(a,l),d=c.length;let f=null,h=i.length;const p=[];for(let g=0;g<d;++g){for(const y of c[g]){const{permutationIndices:m,expandDims:x}=Ew(h,l[y]);let v;Aw(m)?v=o[y]:(v=Un({inputs:{x:o[y]},backend:n,attrs:{perm:m}}),p.push(v));const b=v.shape.slice();for(let $=0;$<x.length;++$)b.splice(x[$],0,1);He(v.shape,b)||(v=rt({inputs:{x:v},backend:n,attrs:{shape:b}}),p.push(v)),f===null?f=v:(f=qg({inputs:{a:v,b:f},backend:n}),p.push(f))}g<d-1&&(u[g]>=0&&(f=hf({inputs:{x:f},backend:n,attrs:{axis:u[g]-(i.length-h),keepDims:!1}}),p.push(f)),h--)}for(const g of p)g!==f&&n.disposeIntermediateTensorInfo(g);return f}const IX={kernelName:e1,backendName:"cpu",kernelFunc:SX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TX(t){const{inputs:e,backend:n}=t,{dy:s,y:r}=e;fe([s,r],"eluGrad");const o=new Float32Array(Y(r.shape)),i=n.data.get(r.dataId).values,a=n.data.get(s.dataId).values;for(let l=0;l<i.length;++l){const u=i[l];u>=0?o[l]=a[l]:o[l]=a[l]*(u+1)}return n.makeTensorInfo(r.shape,"float32",o)}const EX={kernelName:t1,backendName:"cpu",kernelFunc:TX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NX=bw,RX=ww,AX=$w,DX=Cw,FX=kw,PX=Sw,OX=qe(md,t=>{const e=Math.sign(t),n=Math.abs(t),s=1/(1+NX*n);return e*(1-((((PX*s+FX)*s+DX)*s+AX)*s+RX)*s*Math.exp(-n*n))}),LX={kernelName:md,backendName:"cpu",kernelFunc:OX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fp(t){const{inputs:e,backend:n,attrs:s}=t,{input:r}=e,{dim:o}=s,i=r.shape.length,a=r.shape.slice();let l=o;return o<0&&(N(-(i+1)<=o,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),l=i+o+1),a.splice(l,0,1),rt({inputs:{x:r},backend:n,attrs:{shape:a}})}const MX={kernelName:Bm,backendName:"cpu",kernelFunc:Fp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _X=At((t,e)=>t/e),u$=jt(hd,_X),Qy={kernelName:hd,backendName:"cpu",kernelFunc:u$};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _P(t,e,n){const s=t.shape,r=s[0],o=s[1],i=n.data.get(t.dataId),a=i.complexTensorInfos.real,l=i.complexTensorInfos.imag,u=[r,o],c=Y(u),d=hn("float32",c),f=hn("float32",c);for(let y=0;y<r;y++){const m=da({inputs:{x:a},backend:n,attrs:{begin:[y,0],size:[1,o]}}),x=da({inputs:{x:l},backend:n,attrs:{begin:[y,0],size:[1,o]}}),v=qn({inputs:{real:m,imag:x},backend:n}),{real:b,imag:$}=zX(v,e,n),C=fo(b,$);for(let k=0;k<o;k++){const w=Iw(C,k);d[y*o+k]=w.real,f[y*o+k]=w.imag}n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(v)}const h=n.makeTensorInfo(u,"float32",d),p=n.makeTensorInfo(u,"float32",f),g=qn({inputs:{real:h,imag:p},backend:n});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),g}function zX(t,e,n){const s=Y(t.shape),r=n.data.get(t.dataId),o=n.data.get(r.complexTensorInfos.real.dataId).values,i=n.data.get(r.complexTensorInfos.imag.dataId).values;if(VX(s)){const a=Zy(o,i,s,e,n),l=[t.shape[0],t.shape[1]];if(e){const u=n.makeTensorInfo(l,"float32",a.real),c=n.makeTensorInfo(l,"float32",a.imag),d=n.makeTensorInfo([],"float32",di(s,"float32")),f=zr({inputs:{x:d},backend:n}),h=Qy.kernelFunc({inputs:{a:u,b:d},backend:n}),p=Qy.kernelFunc({inputs:{a:c,b:f},backend:n}),g=n.data.get(h.dataId).values,y=n.data.get(p.dataId).values;return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),{real:g,imag:y}}return a}else{const a=fo(o,i),l=BX(a,s,e);return QR(l)}}function VX(t){return(t&t-1)===0}function Zy(t,e,n,s,r){if(n===1)return{real:t,imag:e};const o=fo(t,e),i=n/2,a=ZR(o),l=a.real,u=a.imag,c=[l.length],d=r.makeTensorInfo(c,"float32",l),f=r.makeTensorInfo(c,"float32",u),h=qn({inputs:{real:d,imag:f},backend:r}),p=JR(o),g=p.real,y=p.imag,m=[g.length],x=r.makeTensorInfo(m,"float32",g),v=r.makeTensorInfo(m,"float32",y),b=qn({inputs:{real:x,imag:v},backend:r}),$=Zy(l,u,i,s,r),C=$.real,k=$.imag,w=[C.length],I=r.makeTensorInfo(w,"float32",C),R=r.makeTensorInfo(w,"float32",k),E=qn({inputs:{real:I,imag:R},backend:r}),A=Zy(g,y,i,s,r),S=A.real,T=A.imag,F=[S.length],M=r.makeTensorInfo(F,"float32",S),U=r.makeTensorInfo(F,"float32",T),P=qn({inputs:{real:M,imag:U},backend:r}),L=tA(n,s),G=[L.real.length],X=r.makeTensorInfo(G,"float32",L.real),Q=r.makeTensorInfo(G,"float32",L.imag),Z=qn({inputs:{real:X,imag:Q},backend:r}),te=qg({inputs:{a:Z,b:P},backend:r}),ee=_l({inputs:{a:E,b:te},backend:r}),se=a$({inputs:{a:E,b:te},backend:r}),le=ca({inputs:{input:ee},backend:r}),pe=ca({inputs:{input:se},backend:r}),ae=zl({inputs:{input:ee},backend:r}),be=zl({inputs:{input:se},backend:r}),ke=Vl({inputs:[le,pe],backend:r,attrs:{axis:0}}),Pe=Vl({inputs:[ae,be],backend:r,attrs:{axis:0}}),Be=r.data.get(ke.dataId).values,et=r.data.get(Pe.dataId).values;return r.disposeIntermediateTensorInfo(d),r.disposeIntermediateTensorInfo(f),r.disposeIntermediateTensorInfo(h),r.disposeIntermediateTensorInfo(x),r.disposeIntermediateTensorInfo(v),r.disposeIntermediateTensorInfo(b),r.disposeIntermediateTensorInfo(I),r.disposeIntermediateTensorInfo(R),r.disposeIntermediateTensorInfo(E),r.disposeIntermediateTensorInfo(M),r.disposeIntermediateTensorInfo(U),r.disposeIntermediateTensorInfo(P),r.disposeIntermediateTensorInfo(X),r.disposeIntermediateTensorInfo(Q),r.disposeIntermediateTensorInfo(Z),r.disposeIntermediateTensorInfo(te),r.disposeIntermediateTensorInfo(ee),r.disposeIntermediateTensorInfo(se),r.disposeIntermediateTensorInfo(le),r.disposeIntermediateTensorInfo(ae),r.disposeIntermediateTensorInfo(pe),r.disposeIntermediateTensorInfo(be),r.disposeIntermediateTensorInfo(ke),r.disposeIntermediateTensorInfo(Pe),{real:Be,imag:et}}function BX(t,e,n){const s=new Float32Array(e*2);for(let r=0;r<e;r++){let o=0,i=0;for(let a=0;a<e;a++){const l=nA(r*a,e,n),u=Iw(t,a);o+=u.real*l.real-u.imag*l.imag,i+=u.real*l.imag+u.imag*l.real}n&&(o/=e,i/=e),eA(s,o,i,r)}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WX(t){const{inputs:e,backend:n}=t,{input:s}=e,r=Y(s.shape),o=s.shape[s.shape.length-1],i=r/o,a=rt({inputs:{x:s},backend:n,attrs:{shape:[i,o]}}),l=_P(a,!1,n),u=rt({inputs:{x:l},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),u}const UX={kernelName:n1,backendName:"cpu",kernelFunc:WX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c$(t){const{backend:e,attrs:n}=t,{shape:s,value:r,dtype:o}=n,i=o||Xl(r),a=St(i,Y(s));return HX(a,r,i),e.makeTensorInfo(s,i,a)}const GX={kernelName:s1,backendName:"cpu",kernelFunc:c$};function HX(t,e,n){t.fill(e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jX={kernelName:r1,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,r=n,o=hn(s.dtype,Y(s.shape)),[i,a,l,u]=s.shape,c=r.data.get(s.dataId).values;for(let f=0;f<i;f++){const h=f*l*a*u;for(let p=0;p<a;p++){const g=p*(l*u);for(let y=0;y<l;y++){const m=y*u;for(let x=0;x<u;x++){const v=Math.round(l-y-1),b=h+g+m+x;let $=c[b];if(v>=0&&v<l){const C=v*u,k=h+g+C+x;$=c[k]}o[b]=$}}}}return{dataId:r.write(o,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KX(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:o,bias:i,preluActivationWeights:a}=e,{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:f,activation:h,leakyreluAlpha:p}=s;let g=LP({inputs:{x:r,filter:o},backend:n,attrs:{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:f}});if(i){const y=g;if(c==="NCHW"&&i.shape.length===1&&i.shape[0]!==1){const m=rt({inputs:{x:i},backend:n,attrs:{shape:[i.shape[0],1,1]}});g=_l({inputs:{a:g,b:m},backend:n}),n.disposeIntermediateTensorInfo(m)}else g=_l({inputs:{a:g,b:i},backend:n});n.disposeIntermediateTensorInfo(y)}if(h){const y=g;if(c==="NCHW"&&h==="prelu"&&a.shape.length===1&&a.shape[0]!==1){const m=rt({inputs:{x:a},backend:n,attrs:{shape:[a.shape[0],1,1]}});g=Dp(n,g,h,m,p),n.disposeIntermediateTensorInfo(m)}else g=Dp(n,g,h,a,p);n.disposeIntermediateTensorInfo(y)}return g}const XX={kernelName:fp,backendName:"cpu",kernelFunc:KX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qX(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:o,bias:i,preluActivationWeights:a}=e,{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:f,activation:h,leakyreluAlpha:p}=s;let g=MP({inputs:{x:r,filter:o},backend:n,attrs:{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:f}});if(i){const y=g;g=_l({inputs:{a:g,b:i},backend:n}),n.disposeIntermediateTensorInfo(y)}if(h){const y=g;g=Dp(n,g,h,a,p),n.disposeIntermediateTensorInfo(y)}return g}const YX={kernelName:CN,backendName:"cpu",kernelFunc:qX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QX(t){const{inputs:e,backend:n}=t,{params:s,indices:r}=e,o=Y(s.shape),i=r.shape,a=i[i.length-1],[l,u,c,d]=uw(s,r);if(u===0)return n.makeTensorInfo(l,s.dtype,[]);const f=n.data.get(r.dataId).values,h=n.bufferSync(s),p=XF(f,h,s.dtype,u,a,c,d,s.shape,o);return n.makeTensorInfo(l,s.dtype,p.values)}const ZX={kernelName:oN,backendName:"cpu",kernelFunc:QX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JX(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,indices:o}=e,{axis:i,batchDims:a}=s;fe([r,o],"gatherV2");const l=Ne(i,r.shape)[0],u=n.data.get(o.dataId).values,c=r.shape[l];for(let b=0;b<u.length;++b){const $=u[b];N($<=c-1&&$>=0,()=>`GatherV2: the index value ${$} is not in [0, ${c-1}]`)}let d=a;a==null&&(d=0);const f=Y(o.shape),h=Fw(r,o,l,d),p=rt({inputs:{x:r},backend:n,attrs:{shape:[h.batchSize,h.outerSize,h.dimSize,h.sliceSize]}}),g=rt({inputs:{x:o},backend:n,attrs:{shape:[h.batchSize,f/h.batchSize]}}),y=[h.batchSize,h.outerSize,f/h.batchSize,h.sliceSize],m=n.bufferSync(g),x=n.bufferSync(p),v=qF(x,m,y);return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),n.makeTensorInfo(h.outputShape,v.dtype,v.values)}const eq={kernelName:Um,backendName:"cpu",kernelFunc:JX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tq(t){const{inputs:e,backend:n}=t,{input:s}=e,r=Y(s.shape),o=s.shape[s.shape.length-1],i=r/o,a=rt({inputs:{x:s},backend:n,attrs:{shape:[i,o]}}),l=_P(a,!0,n),u=rt({inputs:{x:l},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),u}const nq={kernelName:o1,backendName:"cpu",kernelFunc:tq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sq=qe($d,t=>Number.isFinite(t)?1:0,"bool"),rq={kernelName:$d,backendName:"cpu",kernelFunc:sq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oq=qe(Cd,t=>Math.abs(t)===1/0?1:0,"bool"),iq={kernelName:Cd,backendName:"cpu",kernelFunc:oq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aq=qe(kd,t=>Number.isNaN(t)?1:0,"bool"),lq={kernelName:kd,backendName:"cpu",kernelFunc:aq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uq(t){const{backend:e,attrs:n}=t,{start:s,stop:r,num:o}=n,i=eP(s,r,o);return e.makeTensorInfo([i.length],"float32",i)}const cq={kernelName:iN,backendName:"cpu",kernelFunc:uq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dq=qe(Id,t=>Math.log1p(t)),fq={kernelName:Id,backendName:"cpu",kernelFunc:dq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hq=At((t,e)=>t&&e),pq=jt(Xm,hq,null,"bool"),mq={kernelName:Xm,backendName:"cpu",kernelFunc:pq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gq=qe(qm,t=>t?0:1,"bool"),xq={kernelName:qm,backendName:"cpu",kernelFunc:gq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yq=At((t,e)=>t||e),vq=jt(Ym,yq,null,"bool"),bq={kernelName:Ym,backendName:"cpu",kernelFunc:vq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wq(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{depthRadius:o,bias:i,alpha:a,beta:l}=s;fe(r,"LRN");const u=r.shape[3],c=u-1,d=n.data.get(r.dataId).values,f=Y(r.shape),h=new Float32Array(f);function p(g){const y=g%u;let m=g-y+Math.max(0,y-o);const x=g-y+Math.min(y+o,c);let v=0;for(;m<=x;m++){const b=d[m];v+=b*b}return v}for(let g=0;g<f;g++){const y=p(g),m=d[g]*Math.pow(i+a*y,-l);h[g]=m}return n.makeTensorInfo(r.shape,r.dtype,h)}const $q={kernelName:Qm,backendName:"cpu",kernelFunc:wq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cq(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,y:o,dy:i}=e,{depthRadius:a,bias:l,alpha:u,beta:c}=s;fe(i,"LRNGrad");const d=Y(i.shape),f=i.shape[3],h=n.data.get(i.dataId).values,p=n.data.get(r.dataId).values,g=n.data.get(o.dataId).values,y=new Float32Array(d),m=d;for(let x=0;x<m;x++){const v=x%f,b=x-v+Math.max(0,v-a),$=x-v+Math.min(f,v+a+1);let C=0;for(let k=b;k<$;k++)C+=Math.pow(p[k],2);C=u*C+l;for(let k=b;k<$;k++){let w=-2*u*c*p[k]*g[x]/C;x===k&&(w+=Math.pow(C,-c)),w*=h[x],y[k]+=w}}return n.makeTensorInfo(i.shape,r.dtype,y)}const kq={kernelName:a1,backendName:"cpu",kernelFunc:Cq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zP(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reductionIndices:o,keepDims:i}=s,a=n;let l=r.shape;const u=l.length,c=Ne(o,l);let d=c;const f=vt(d,u);let h=a.data.get(r.dataId).values;if(f!=null){const b=new Array(u);for(let $=0;$<b.length;$++)b[$]=l[f[$]];h=o$(h,l,r.dtype,f,b),d=Nt(d.length,u),l=b}fe(r,"max"),on("max",d,u);const[p,g]=Jt(l,d),y=Y(g),m=nP(h,y,p,r.dtype),x=a.write(m,p,r.dtype);let v=p;return i&&(v=Lt(p,c)),{dataId:x,shape:v,dtype:r.dtype}}const Sq={kernelName:Zm,backendName:"cpu",kernelFunc:zP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iq(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;fe(r,"maxPool");const{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=s,u=1;N(gn(i,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const c=Gs(r.shape,o,i,u,a,l);let d;if(c.filterWidth===1&&c.filterHeight===1&&He(c.inShape,c.outShape))d=zr({inputs:{x:r},backend:n});else{const f=n.data.get(r.dataId).values,h=me(r.shape),p=l$(f,r.shape,r.dtype,h,c,"max");d=n.makeTensorInfo(c.outShape,r.dtype,p.values)}return d}const Tq={kernelName:Jm,backendName:"cpu",kernelFunc:Iq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eq(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:o,strides:i,pad:a,dimRoundingMode:l,dataFormat:u}=s;fe(r,"maxPool3d");const c=xo(r.shape,o,i,1,a,l,u),d=n.data.get(r.dataId).values,f=OP(d,r.shape,r.dtype,me(r.shape),c,"max");return n.makeTensorInfo(f.shape,"float32",f.values)}const Nq={kernelName:eg,backendName:"cpu",kernelFunc:Eq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rq(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:o}=e,{filterSize:i,strides:a,pad:l,dimRoundingMode:u}=s;fe([r,o],"maxPool3DGrad");const c=xo(o.shape,i,a,1,l,u),d=n.bufferSync(o),f=y9(d,c),h=c.strideDepth,p=c.strideHeight,g=c.strideWidth,y=c.dilationDepth,m=c.dilationHeight,x=c.dilationWidth,v=c.effectiveFilterDepth,b=c.effectiveFilterHeight,$=c.effectiveFilterWidth,C=v-1-c.padInfo.front,k=$-1-c.padInfo.left,w=b-1-c.padInfo.top,I=Ee(o.shape,"float32"),R=n.bufferSync(r);for(let E=0;E<c.batchSize;++E)for(let A=0;A<c.inChannels;++A)for(let S=0;S<c.inDepth;++S)for(let T=0;T<c.inHeight;++T)for(let F=0;F<c.inWidth;++F){const M=S-C,U=T-w,P=F-k;let L=0;for(let G=0;G<v;G+=y){const X=(M+G)/h;if(!(X<0||X>=c.outDepth||Math.floor(X)!==X))for(let Q=0;Q<b;Q+=m){const Z=(U+Q)/p;if(!(Z<0||Z>=c.outHeight||Math.floor(Z)!==Z))for(let te=0;te<$;te+=x){const ee=(P+te)/g;if(ee<0||ee>=c.outWidth||Math.floor(ee)!==ee)continue;const se=v*b*$-1-f.get(E,X,Z,ee,A),le=G*b*$+Q*$+te,pe=se===le?1:0;if(pe===0)continue;const ae=R.get(E,X,Z,ee,A);L+=ae*pe}}}I.set(L,E,S,T,F,A)}return n.makeTensorInfo(I.shape,I.dtype,I.values)}const Aq={kernelName:u1,backendName:"cpu",kernelFunc:Rq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dq(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:o,output:i}=e,a=o;fe([o,i],"maxPoolGrad");const{filterSize:l,strides:u,pad:c,dimRoundingMode:d}=s,f=Gs(a.shape,l,u,1,c,d),h=n.data.get(a.dataId).values,p=Ee(f.outShape,a.dtype,PP(h,a.shape,a.dtype,f).values),g=f.strideHeight,y=f.strideWidth,m=f.dilationHeight,x=f.dilationWidth,v=f.effectiveFilterHeight,b=f.effectiveFilterWidth,$=b-1-f.padInfo.left,C=v-1-f.padInfo.top,k=Ee(a.shape,"float32"),w=n.data.get(r.dataId).values,I=Ee(r.shape,"float32",w);for(let R=0;R<f.batchSize;++R)for(let E=0;E<f.inChannels;++E)for(let A=0;A<f.inHeight;++A)for(let S=0;S<f.inWidth;++S){const T=A-C,F=S-$;let M=0;for(let U=0;U<v;U+=m){const P=(T+U)/g;if(!(P<0||P>=f.outHeight||Math.floor(P)!==P))for(let L=0;L<b;L+=x){const G=(F+L)/y;if(G<0||G>=f.outWidth||Math.floor(G)!==G)continue;const X=v*b-1-p.get(R,P,G,E),Q=U*b+L,Z=X===Q?1:0;if(Z===0)continue;const te=I.get(R,P,G,E);M+=te*Z}}k.set(M,R,A,S,E)}return n.makeTensorInfo(k.shape,k.dtype,k.values)}const Fq={kernelName:l1,backendName:"cpu",kernelFunc:Dq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pq(t,e,n,s,r){const o=me(e),i=l$(t,e,n,o,r,"max"),a=PP(t,e,n,r,!0,s);return[i.values,a.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oq={kernelName:aN,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{filterSize:r,strides:o,pad:i,includeBatchInIndex:a}=e,l=n;fe(s,"MaxPoolWithArgmax");const u=l.data.get(s.dataId).values,c=Gs(s.shape,r,o,[1,1],i),[d,f]=Pq(u,s.shape,s.dtype,a,c),h=l.write(d,c.outShape,s.dtype),p=l.write(f,c.outShape,s.dtype);return[{dataId:h,shape:c.outShape,dtype:s.dtype},{dataId:p,shape:c.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lq(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,keepDims:i}=s,a=Ne(o,r.shape),u=Jt(r.shape,a)[1],c=Y(u),d=[],f=n.makeTensorInfo([],"float32",new Float32Array([c]));d.push(f);const h=ii({inputs:{x:r},backend:n,attrs:{dtype:"float32"}});d.push(h);const p=u$({inputs:{a:h,b:f},backend:n});d.push(p);const g=hf({inputs:{x:p},backend:n,attrs:{axis:o,keepDims:i}});return d.forEach(y=>n.disposeIntermediateTensorInfo(y)),g}const Mq={kernelName:tg,backendName:"cpu",kernelFunc:Lq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _q(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,keepDims:i}=s;fe(r,"min");const a=Ne(o,r.shape);let l=a;const u=vt(l,r.shape.length);let c=r;u!=null&&(c=Un({inputs:{x:r},backend:n,attrs:{perm:u}}),l=Nt(l.length,r.shape.length)),on("min",l,c.shape.length);const[d,f]=Jt(c.shape,l),h=Y(f),p=pn(Y(d),c.dtype),g=n.data.get(c.dataId).values;for(let m=0;m<p.length;++m){const x=m*h;let v=g[x];for(let b=0;b<h;++b){const $=g[x+b];(Number.isNaN($)||$<v)&&(v=$)}p[m]=v}u!=null&&n.disposeIntermediateTensorInfo(c);const y=n.makeTensorInfo(d,c.dtype,p);if(i){const m=Lt(d,a),x=rt({inputs:{x:y},backend:n,attrs:{shape:m}});return n.disposeIntermediateTensorInfo(y),x}return y}const zq={kernelName:ng,backendName:"cpu",kernelFunc:_q};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vq(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{paddings:o,mode:i}=s;fe(r,"mirrorPad");const a=o.map((v,b)=>v[0]+r.shape[b]+v[1]),l=o.map(v=>v[0]),u=o.map((v,b)=>v[0]+r.shape[b]),c=i==="reflect"?0:1,d=n.data.get(r.dataId).values,f=r.shape.length,h=me(r.shape),p=Y(a),g=a.length,y=me(a),m=hn(r.dtype,p);for(let v=0;v<p;v++){let b=ql(v,g,y);for(let C=0;C<g;C++)b[C]<l[C]?b[C]=l[C]*2-b[C]-c:b[C]>=u[C]&&(b[C]=(u[C]-1)*2-b[C]+c);b=b.map((C,k)=>C-l[k]);const $=Nr(b,f,h);m[v]=d[$]}return{dataId:n.write(m,a,r.dtype),shape:a,dtype:r.dtype}}const Bq={kernelName:sg,backendName:"cpu",kernelFunc:Vq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wq=At((t,e)=>{const n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e}),Uq=jt(Nd,Wq),Gq={kernelName:Nd,backendName:"cpu",kernelFunc:Uq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VP(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{dim:o}=s,i=r.shape.length;let a=o;if(a===-1&&(a=i-1),a!==i-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${i} and dim was ${a}`);const l=Ne([a],r.shape),u=zP({inputs:{x:r},backend:n,attrs:{reductionIndices:l,keepDims:!1}}),c=Lt(u.shape,l),d=rt({inputs:{x:u},backend:n,attrs:{shape:c}}),f=a$({inputs:{a:r,b:d},backend:n}),h=GF({inputs:{x:f},backend:n}),p=hf({inputs:{x:h},backend:n,attrs:{axis:l,keepDims:!1}}),g=rt({inputs:{x:p},backend:n,attrs:{shape:c}}),y=u$({inputs:{a:h,b:g},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),y}const Hq={kernelName:wg,backendName:"cpu",kernelFunc:VP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jq(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{numSamples:o,seed:i,normalized:a}=s;fe(r,"multinomial");const l=a?r:VP({inputs:{logits:r},backend:n,attrs:{dim:-1}}),u=l.shape[0],c=l.shape[1],d=n.data.get(l.dataId).values,f=[u,o],h=pn(Y(f),"int32");for(let p=0;p<u;++p){const g=p*c,y=new Float32Array(c-1);y[0]=d[g];for(let v=1;v<y.length;++v)y[v]=y[v-1]+d[g+v];const m=q1.alea(i.toString()),x=p*o;for(let v=0;v<o;++v){const b=m();h[x+v]=y.length;for(let $=0;$<y.length;$++)if(b<y[$]){h[x+v]=$;break}}}return a||n.disposeIntermediateTensorInfo(l),n.makeTensorInfo(f,"int32",h)}const Kq={kernelName:lN,backendName:"cpu",kernelFunc:jq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xq=rw;function qq(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l}=s;fe(r,"NonMaxSuppression");const u=n.data.get(r.dataId).values,c=n.data.get(o.dataId).values,{selectedIndices:d}=Xq(u,c,i,a,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const Yq={kernelName:c1,backendName:"cpu",kernelFunc:qq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qq=ow;function Zq(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:u}=s;fe(r,"NonMaxSuppressionPadded");const c=n.data.get(r.dataId).values,d=n.data.get(o.dataId).values,{selectedIndices:f,validOutputs:h}=Qq(c,d,i,a,l,u);return[n.makeTensorInfo([f.length],"int32",new Int32Array(f)),n.makeTensorInfo([],"int32",new Int32Array([h]))]}const Jq={kernelName:d1,backendName:"cpu",kernelFunc:Zq};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eY=iw;function tY(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,softNmsSigma:u}=s;fe(r,"NonMaxSuppressionWithScore");const c=n.data.get(r.dataId).values,d=n.data.get(o.dataId).values,f=i,h=a,p=l,g=u,{selectedIndices:y,selectedScores:m}=eY(c,d,f,h,p,g);return[n.makeTensorInfo([y.length],"int32",new Int32Array(y)),n.makeTensorInfo([m.length],"float32",new Float32Array(m))]}const nY={kernelName:f1,backendName:"cpu",kernelFunc:tY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sY(t){const{inputs:e,backend:n,attrs:s}=t,{indices:r}=e,{dtype:o,depth:i,onValue:a,offValue:l}=s;fe(r,"oneHot");const u=Y(r.shape),c=new Float32Array(u*i);c.fill(l);const d=n.data.get(r.dataId).values;for(let f=0;f<u;++f)d[f]>=0&&d[f]<i&&(c[f*i+d[f]]=a);return n.makeTensorInfo([...r.shape,i],o,c)}const rY={kernelName:ag,backendName:"cpu",kernelFunc:sY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pp(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(s.dtype==="complex64"){const r=ca({inputs:{input:s},backend:n}),o=Pp({inputs:{x:r},backend:n}),i=zl({inputs:{input:s},backend:n}),a=Pp({inputs:{x:i},backend:n}),l=qn({inputs:{real:o,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),l}else return c$({backend:n,attrs:{shape:s.shape,value:0,dtype:s.dtype}})}const oY={kernelName:kg,backendName:"cpu",kernelFunc:Pp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BP(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(s.dtype==="complex64"){const r=ca({inputs:{input:s},backend:n}),o=BP({inputs:{x:r},backend:n}),i=zl({inputs:{input:s},backend:n}),a=Pp({inputs:{x:i},backend:n}),l=qn({inputs:{real:o,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),l}else return c$({backend:n,attrs:{shape:s.shape,value:1,dtype:s.dtype}})}const iY={kernelName:ig,backendName:"cpu",kernelFunc:BP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WP(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s;if(e.length===1)return Fp({inputs:{input:e[0]},backend:n,attrs:{dim:r}});const o=e[0].shape,i=e[0].dtype;e.forEach(c=>{Fb(o,c.shape,"All tensors passed to stack must have matching shapes"),N(i===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(c=>{const d=Fp({inputs:{input:c},backend:n,attrs:{dim:r}});return a.push(d),d}),u=Vl({inputs:l,backend:n,attrs:{axis:r}});return a.forEach(c=>n.disposeIntermediateTensorInfo(c)),u}const aY={kernelName:lg,backendName:"cpu",kernelFunc:WP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lY(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{paddings:o,constantValue:i}=s;fe(r,"pad");const a=o.map((x,v)=>x[0]+r.shape[v]+x[1]),l=o.map(x=>x[0]),u=n.data.get(r.dataId).values,c=Y(r.shape),d=r.shape.length,f=me(r.shape),h=Y(a),p=a.length,g=me(a),y=hn(r.dtype,h);i!==0&&y.fill(i);for(let x=0;x<c;x++){const b=ql(x,d,f).map((C,k)=>C+l[k]),$=Nr(b,p,g);y[$]=u[x]}return{dataId:n.write(y,a,r.dtype),shape:a,dtype:r.dtype}}const UP={kernelName:ug,backendName:"cpu",kernelFunc:lY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uY=At((t,e)=>Math.pow(t,e)),cY=jt(Ad,uY),dY={kernelName:Ad,backendName:"cpu",kernelFunc:cY};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fY(t){const{inputs:e,backend:n,attrs:s}=t,{paramsNestedSplits:r,paramsDenseValues:o,indices:i}=e,a=r.map(y=>n.data.get(y.dataId).values),l=r.map(y=>y.shape),u=n.data.get(o.dataId).values,c=n.data.get(i.dataId).values,[d,f,h]=lP(a,l,u,o.shape,o.dtype,c,i.shape),p=d.map(y=>n.makeTensorInfo([y.length],"int32",y)),g=n.makeTensorInfo(h,o.dtype,f);return p.concat([g])}const hY={kernelName:uN,backendName:"cpu",kernelFunc:fY};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pY(t){const{inputs:e,backend:n}=t,{starts:s,limits:r,deltas:o}=e,i=n.data.get(s.dataId).values,a=n.data.get(r.dataId).values,l=n.data.get(o.dataId).values,[u,c]=uP(i,s.shape,s.dtype,a,r.shape,l,o.shape),d=n.makeTensorInfo([u.length],"int32",u),f=n.makeTensorInfo([c.length],s.dtype,c);return[d,f]}const mY={kernelName:cN,backendName:"cpu",kernelFunc:pY};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gY(t){const{inputs:e,backend:n,attrs:s}=t,{shape:r,values:o,defaultValue:i,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=s,u=n.data.get(r.dataId).values,c=n.data.get(o.dataId).values,d=n.data.get(i.dataId).values,f=a.map(y=>n.data.get(y.dataId).values),h=a.map(y=>y.shape),[p,g]=cP(u,r.shape,c,o.shape,o.dtype,d,i.shape,f,h,l);return n.makeTensorInfo(p,o.dtype,g)}const xY={kernelName:dN,backendName:"cpu",kernelFunc:gY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yY(t){const{backend:e,attrs:n}=t,{start:s,stop:r,dtype:o,step:i}=n,a=dP(s,r,i,o);return e.makeTensorInfo([a.length],o,a)}const vY={kernelName:h1,backendName:"cpu",kernelFunc:yY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bY=qe(Dd,t=>1/t),wY={kernelName:Dd,backendName:"cpu",kernelFunc:bY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Y(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:o,halfPixelCenters:i,size:a}=s;fe(r,"resizeBilinear");const l=me(r.shape),[u,c]=a,[d,f,h,p]=r.shape,g=n.data.get(r.dataId).values,y=new Float32Array(Y([d,u,c,p])),m=[o&&u>1?f-1:f,o&&c>1?h-1:h],x=[o&&u>1?u-1:u,o&&c>1?c-1:c];let v=0;const b=m[0]/x[0],$=m[1]/x[1];for(let C=0;C<d;C++)for(let k=0;k<u;k++){let w;i?w=b*(k+.5)-.5:w=b*k;const I=Math.max(0,Math.floor(w)),R=w-I,E=Math.min(f-1,Math.ceil(w)),A=C*l[0]+I*l[1],S=C*l[0]+E*l[1];for(let T=0;T<c;T++){let F;i?F=$*(T+.5)-.5:F=$*T;const M=Math.max(0,Math.floor(F)),U=F-M,P=Math.min(h-1,Math.ceil(F)),L=A+M*l[2],G=S+M*l[2],X=A+P*l[2],Q=S+P*l[2];for(let Z=0;Z<p;Z++){const te=g[L+Z],ee=g[G+Z],se=g[X+Z],le=g[Q+Z],pe=te+(se-te)*U,ae=ee+(le-ee)*U,be=pe+(ae-pe)*R;y[v++]=be}}}return n.makeTensorInfo([d,u,c,p],"float32",y)}const CY={kernelName:pg,backendName:"cpu",kernelFunc:$Y};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kY(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:o}=e,{alignCorners:i}=s;fe([o,r],"resizeBilinearGrad");const a=me(r.shape),[l,u,c,d]=r.shape,[,f,h]=o.shape,p=new Float32Array(l*u*c*d),g=[i&&f>1?u-1:u,i&&h>1?c-1:c],y=[i&&f>1?f-1:f,i&&h>1?h-1:h],m=g[0]/y[0],x=g[1]/y[1],v=n.data.get(o.dataId).values;let b=0;for(let $=0;$<l;$++){const C=$*a[0];for(let k=0;k<f;k++){const w=k*m,I=Math.floor(w),R=Math.min(Math.ceil(w),u-1),E=C+I*a[1],A=C+R*a[1],S=w-I,T=1-S;for(let F=0;F<h;F++){const M=F*x,U=Math.floor(M),P=Math.min(Math.ceil(M),c-1),L=M-U,G=1-L,X=E+U*a[2],Q=E+P*a[2],Z=A+U*a[2],te=A+P*a[2],ee=T*G,se=T*L,le=S*G,pe=S*L;for(let ae=0;ae<d;ae++){const be=v[b++];p[X+ae]+=be*ee,p[Q+ae]+=be*se,p[Z+ae]+=be*le,p[te+ae]+=be*pe}}}}return n.makeTensorInfo([l,c,u,d],"float32",p)}const SY={kernelName:g1,backendName:"cpu",kernelFunc:kY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IY(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:o,halfPixelCenters:i,size:a}=s;fe(r,"resizeNearestNeighbor");const l=me(r.shape),[u,c]=a,[d,f,h,p]=r.shape,g=n.data.get(r.dataId).values,y=new Float32Array(d*u*c*p),m=[o&&u>1?f-1:f,o&&c>1?h-1:h],x=[o&&u>1?u-1:u,o&&c>1?c-1:c],v=m[0]/x[0],b=m[1]/x[1];let $=0;for(let C=0;C<d;C++){const k=C*l[0];for(let w=0;w<u;w++){const I=i?v*(w+.5):v*w;let R=Math.min(f-1,o?Math.round(I):Math.floor(I));i&&(R=Math.max(0,R));const E=k+R*l[1];for(let A=0;A<c;A++){const S=i?b*(A+.5):b*A;let T=Math.min(h-1,o?Math.round(S):Math.floor(S));i&&(T=Math.max(0,T));const F=E+T*l[2];for(let M=0;M<p;M++){const U=g[F+M];y[$++]=U}}}}return n.makeTensorInfo([d,u,c,p],r.dtype,y)}const TY={kernelName:hg,backendName:"cpu",kernelFunc:IY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EY(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:o}=e,{alignCorners:i}=s;fe([o,r],"resizeNearestNeighborGrad");const a=me(r.shape),l=me(o.shape),[u,c,d,f]=r.shape,[,h,p]=o.shape,g=new Float32Array(u*c*d*f),y=n.data.get(o.dataId).values,m=[i&&h>1?c-1:c,i&&p>1?d-1:d],x=[i&&h>1?h-1:h,i&&p>1?p-1:p],v=m[0]/x[0],b=m[1]/x[1],$=1/v,C=1/b,k=Math.ceil($)*2+2,w=Math.ceil(C)*2+2;for(let I=0;I<u;I++){const R=I*a[0];for(let E=0;E<c;E++){const A=R+E*a[1],S=Math.floor(E*$),T=Math.floor(S-k/2);for(let F=0;F<d;F++){const M=A+F*a[2],U=Math.floor(F*C),P=Math.floor(U-w/2);for(let L=0;L<f;L++){let G=0;for(let X=0;X<k;X++){const Q=X+T;if(Q<0||Q>=h)continue;const Z=R+Q*l[1],te=Q*v,ee=Math.min(c-1,i?Math.round(te):Math.floor(te));if(E===ee)for(let se=0;se<w;se++){const le=se+P;if(le<0||le>=p)continue;const pe=Z+le*l[2],ae=le*b,be=Math.min(d-1,i?Math.round(ae):Math.floor(ae));F===be&&(G+=y[pe+L])}}g[M+L]=G}}}}return n.makeTensorInfo(r.shape,r.dtype,g)}const NY={kernelName:m1,backendName:"cpu",kernelFunc:EY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RY(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dims:o}=s;fe(r,"reverse");const i=r.shape.length,a=Ne(o,r.shape);if(i===0)return zr({inputs:{x:r},backend:n});const l=new sn(r.shape,r.dtype),u=n.bufferSync(r);for(let c=0;c<l.size;c++){const d=l.indexToLoc(c),f=d.slice();a.forEach(h=>f[h]=r.shape[h]-1-f[h]),l.set(u.get(...f),...d)}return n.makeTensorInfo(l.shape,l.dtype,l.values)}const AY={kernelName:mg,backendName:"cpu",kernelFunc:RY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DY={kernelName:C1,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,{radians:r,fillValue:o,center:i}=e,a=n,l=hn(s.dtype,Y(s.shape)),[u,c,d,f]=s.shape,[h,p]=xw(i,c,d),g=255,y=Math.sin(r),m=Math.cos(r),x=a.data.get(s.dataId).values;for(let b=0;b<u;b++){const $=b*d*c*f;for(let C=0;C<c;C++){const k=C*(d*f);for(let w=0;w<d;w++){const I=w*f;for(let R=0;R<f;R++){const E=[u,C,w,R],A=E[2],S=E[1];let T=(A-h)*m-(S-p)*y,F=(A-h)*y+(S-p)*m;T=Math.round(T+h),F=Math.round(F+p);let M=o;if(typeof o!="number"&&(R===3?M=g:M=o[R]),T>=0&&T<d&&F>=0&&F<c){const P=F*(d*f),L=T*f,G=$+P+L+R;M=x[G]}const U=$+k+I+R;l[U]=M}}}}return{dataId:a.write(l,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FY=qe(Od,t=>{const e=Math.floor(t);return t-e<.5?Math.floor(t):t-e>.5?Math.ceil(t):e%2===0?e:e+1}),PY={kernelName:Od,backendName:"cpu",kernelFunc:FY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OY(t){const{inputs:e,backend:n,attrs:s}=t,{indices:r,updates:o}=e,{shape:i}=s,{sliceRank:a,numUpdates:l,sliceSize:u,strides:c,outputSize:d}=Ta(o,r,i),f=!0,h=n.bufferSync(r),p=n.bufferSync(o),g=Oi(h,p,i,d,u,l,a,c,0,f);return n.makeTensorInfo(i,g.dtype,g.values)}const LY={kernelName:fN,backendName:"cpu",kernelFunc:OY};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MY(t,e){let n=0,s=t.length,r=0;for(;n<s;)r=Math.floor((n+s)/2),t[r]<e?n=r+1:s=r;return s}function _Y(t,e){let n=0,s=t.length,r=0;for(;n<s;)r=Math.floor((n+s)/2),t[r]<=e?n=r+1:s=r;return s}function zY(t,e,n,s,r,o){const i=St("int32",n*r);for(let a=0;a<n;++a){const l=t.slice(a*s,(a+1)*s),u=a*r;for(let c=0;c<r;++c)i[u+c]=o==="left"?MY(l,e[c+u]):_Y(l,e[c+u])}return i}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VY(t){const{inputs:e,backend:n,attrs:s}=t,{sortedSequence:r,values:o}=e,{side:i}=s,a=n.data.get(r.dataId).values,l=n.data.get(o.dataId).values,u=zY(a,l,r.shape[0],r.shape[1],o.shape[1],i);return n.makeTensorInfo(o.shape,"int32",u)}const BY={kernelName:pN,backendName:"cpu",kernelFunc:VY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WY(t){const{inputs:e,backend:n}=t,{condition:s,t:r,e:o}=e;fe([s,r,o],"select");const i=s.shape.length,a=n.data.get(s.dataId).values,l=n.data.get(r.dataId).values,u=n.data.get(o.dataId).values,c=ss(r.dtype,o.dtype),d=pn(Y(r.shape),c);let f=0;const h=i===0||i>1||r.shape.length===1?1:Y(r.shape.slice(1));for(let p=0;p<a.length;p++)for(let g=0;g<h;g++)a[p]===1?d[f++]=l[p]:d[f++]=u[p];return n.makeTensorInfo(r.shape,c,d)}const UY={kernelName:gg,backendName:"cpu",kernelFunc:WY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GY=Lg,HY=Mg,jY=qe(Md,t=>t>=0?HY*t:GY*(Math.exp(t)-1)),KY={kernelName:Md,backendName:"cpu",kernelFunc:jY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XY=qe(Vd,t=>t<0?-1:t>0?1:0),qY={kernelName:Vd,backendName:"cpu",kernelFunc:XY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YY=qe(_d,t=>Math.sin(t)),QY={kernelName:_d,backendName:"cpu",kernelFunc:YY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZY=qe(zd,t=>Math.sinh(t)),JY={kernelName:zd,backendName:"cpu",kernelFunc:ZY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eQ=11920928955078125e-23,ES=Math.log(eQ)+2,tQ=qe(Wd,t=>{const e=t>-ES,n=t<ES,s=Math.exp(t);let r;return n?r=s:e?r=t:r=Math.log(1+s),r}),nQ={kernelName:Wd,backendName:"cpu",kernelFunc:tQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sQ(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:o,paddings:i}=s;fe([r],"spaceToBatchND");const a=Y(o),l=[[0,0]];l.push(...i);for(let C=1+o.length;C<r.shape.length;++C)l.push([0,0]);const u=UP.kernelFunc({inputs:{x:r},backend:n,attrs:{paddings:l,constantValue:0}}),c=tf(u.shape,o,a,!1),d=nf(c.length,o.length,!1),f=sf(u.shape,o,a,!1),g=rt({inputs:{x:u},backend:n,attrs:{shape:c}}),x=Un({inputs:{x:g},backend:n,attrs:{perm:d}}),$=rt({inputs:{x},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(x),$}const rQ={kernelName:vg,backendName:"cpu",kernelFunc:sQ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oQ(t){const{inputs:e,backend:n}=t,{indices:s,values:r,denseShape:o,defaultValue:i}=e;if(o.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${o.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${r.shape}`);if(i.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${i.shape}`);const a=n.data.get(s.dataId).values,l=n.data.get(r.dataId).values,u=n.data.get(o.dataId).values,c=n.data.get(i.dataId).values[0],[d,f,h,p,g]=mP(a,s.shape,s.dtype,l,r.dtype,u,c);return[n.makeTensorInfo(f,s.dtype,d),n.makeTensorInfo([f[0]],r.dtype,h),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(y=>Number(y)))),n.makeTensorInfo([g.length],s.dtype,new Int32Array(g))]}const iQ={kernelName:mN,backendName:"cpu",kernelFunc:oQ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aQ(t){const{inputs:e,backend:n}=t,{inputIndices:s,inputShape:r,newShape:o}=e;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${r.shape}`);if(o.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${o.shape}`);const i=Array.from(n.data.get(r.dataId).values),a=n.data.get(s.dataId).values,l=Array.from(n.data.get(o.dataId).values),[u,c,d]=gP(a,s.shape,s.dtype,i,l);return[n.makeTensorInfo(c,s.dtype,u),n.makeTensorInfo([d.length],o.dtype,new Int32Array(d))]}const lQ={kernelName:gN,backendName:"cpu",kernelFunc:aQ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uQ(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:o}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${r.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${o.shape}`);if(r.shape[0]!==o.shape[0])throw new Error("segmentIds and indices should have same size.");const i=n.data.get(s.dataId).values,a=n.data.get(r.dataId).values,l=n.data.get(o.dataId).values,[u,c]=i$(i,s.shape,s.dtype,a,l,!0);return n.makeTensorInfo(c,s.dtype,u)}const cQ={kernelName:xN,backendName:"cpu",kernelFunc:uQ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dQ(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:o}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${r.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${o.shape}`);if(r.shape[0]!==o.shape[0])throw new Error("segmentIds and indices should have same size.");const i=n.data.get(s.dataId).values,a=n.data.get(r.dataId).values,l=n.data.get(o.dataId).values,[u,c]=i$(i,s.shape,s.dtype,a,l);return n.makeTensorInfo(c,s.dtype,u)}const fQ={kernelName:yN,backendName:"cpu",kernelFunc:dQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hQ(t){const{inputs:e,backend:n,attrs:s}=t,{sparseIndices:r,sparseValues:o,defaultValue:i}=e,{outputShape:a}=s,{sliceRank:l,numUpdates:u,sliceSize:c,strides:d,outputSize:f}=Ta(o,r,a),h=!1,p=n.bufferSync(r);let g;switch(o.dtype){case"bool":{const y=n.bufferSync(o),m=!!n.data.get(i.dataId).values[0];g=Oi(p,y,a,f,c,u,l,d,m,h);break}case"float32":{const y=n.bufferSync(o),m=n.data.get(i.dataId).values[0];g=Oi(p,y,a,f,c,u,l,d,m,h);break}case"int32":{const y=n.bufferSync(o),m=n.data.get(i.dataId).values[0];g=Oi(p,y,a,f,c,u,l,d,m,h);break}case"string":{const y=n.bufferSync(o),m=ti(n.data.get(i.dataId).values[0]);g=Oi(p,y,a,f,c,u,l,d,m,h);break}default:throw new Error(`Unsupported type ${o.dtype}`)}return n.makeTensorInfo(a,g.dtype,g.values)}const pQ={kernelName:vN,backendName:"cpu",kernelFunc:hQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mQ(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{numOrSizeSplits:o,axis:i}=s,a=Ne(i,r.shape)[0],l=Dw(r,o,a),u=new Array(r.shape.length).fill(0),c=r.shape.slice();return l.map(d=>{const f=[...c];f[a]=d;const h=da({inputs:{x:r},backend:n,attrs:{begin:u,size:f}});return u[a]+=d,h})}const gQ={kernelName:bg,backendName:"cpu",kernelFunc:mQ};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xQ={kernelName:x1,backendName:"cpu",kernelFunc:({inputs:t,backend:e})=>{const{x:n}=t,s=e;fe(n,"square");const r=s.data.get(n.dataId).values,o=new Float32Array(r.length);for(let a=0;a<r.length;++a){const l=r[a];o[a]=l*l}return{dataId:s.write(o,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yQ=qe(qd,(t,e)=>{const n=e;return isNaN(t)?NaN:t>0?1:n.alpha}),vQ={kernelName:qd,backendName:"cpu",kernelFunc:yQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bQ(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:o,end:i,strides:a,beginMask:l,endMask:u,ellipsisMask:c,newAxisMask:d,shrinkAxisMask:f}=s;fe(r,"stridedSlice");const{finalShapeSparse:h,finalShape:p,isIdentity:g,sliceDim0:y,isSimpleSlice:m,begin:x,end:v,strides:b}=pw(r.shape,o,i,a,l,u,c,d,f);let $;if(g)$=rt({inputs:{x:r},backend:n,attrs:{shape:p}});else if(y||m){N(r.shape.length>=1,()=>`Input must have rank at least 1, got: ${r.shape.length}`);const C=dw(x,v,b),k=da({inputs:{x:r},backend:n,attrs:{begin:x,size:C}});$=rt({inputs:{x:k},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(k)}else{const C=n.bufferSync(r),k=vP(h,C,b,x);$=n.makeTensorInfo(p,k.dtype,k.values)}return $}const wQ={kernelName:v1,backendName:"cpu",kernelFunc:bQ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Q(t){const{inputs:e,backend:n,attrs:s}=t,{separator:r,nGramWidths:o,leftPad:i,rightPad:a,padWidth:l,preserveShortSequences:u}=s,{data:c,dataSplits:d}=e,f=n.data.get(c.dataId).values,h=n.data.get(d.dataId).values,[p,g]=bP(f,h,r,o,i,a,l,u);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(d.shape,"int32",g)]}const CQ={kernelName:bN,backendName:"cpu",kernelFunc:$Q};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kQ(t){const{inputs:e,backend:n,attrs:s}=t,{skipEmpty:r}=s,{input:o,delimiter:i}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(o.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${o.shape}`);if(i.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);const a=n.data.get(o.dataId).values,l=n.data.get(i.dataId).values[0],[u,c,d]=wP(a,l,r),f=c.length;return[n.makeTensorInfo([f,2],"int32",u),n.makeTensorInfo([f],"string",c),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const SQ={kernelName:wN,backendName:"cpu",kernelFunc:kQ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IQ(t){const{inputs:e,backend:n,attrs:s}=t,{numBuckets:r}=s,{input:o}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");const i=n.data.get(o.dataId).values,a=$P(i,r);return n.makeTensorInfo(o.shape,"int32",a)}const TQ={kernelName:$N,backendName:"cpu",kernelFunc:IQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EQ=qe(jd,t=>Math.tan(t)),NQ={kernelName:jd,backendName:"cpu",kernelFunc:EQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RQ=qe(Kd,t=>Math.tanh(t)),AQ={kernelName:Kd,backendName:"cpu",kernelFunc:RQ};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DQ(t){const{inputs:e,backend:n}=t,{tensor:s,indices:r,updates:o}=e,{sliceRank:i,numUpdates:a,sliceSize:l,strides:u,outputSize:c}=Ta(o,r,s.shape),d=!1,f=n.bufferSync(r),h=n.bufferSync(o),p=n.bufferSync(s),g=Oi(f,h,s.shape,c,l,a,i,u,p,d);return n.makeTensorInfo(s.shape,g.dtype,g.values)}const FQ={kernelName:hN,backendName:"cpu",kernelFunc:DQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PQ(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reps:o}=s;fe(r,"tile");const i=kP(n.bufferSync(r),o);return n.makeTensorInfo(i.shape,i.dtype,i.values)}const OQ={kernelName:Xd,backendName:"cpu",kernelFunc:PQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LQ(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{k:o,sorted:i}=s;fe(r,"topk");const a=n.data.get(r.dataId).values,[l,u]=IP(a,r.shape,r.dtype,o,i);return[n.makeTensorInfo(l.shape,l.dtype,l.values),n.makeTensorInfo(u.shape,u.dtype,u.values)]}const MQ={kernelName:b1,backendName:"cpu",kernelFunc:LQ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Q(t){const{inputs:e,attrs:n,backend:s}=t,{image:r,transforms:o}=e,{interpolation:i,fillMode:a,fillValue:l,outputShape:u}=n,[c,d,f,h]=r.shape,[p,g]=u??[d,f],y=[c,p,g,h],m=me(r.shape),x=m[0],v=m[1],b=m[2],$=me(y),C=$[0],k=$[1],w=$[2],I=hn(r.dtype,Y(y));I.fill(l);const R=s.data.get(r.dataId).values,E=s.data.get(o.dataId).values;for(let S=0;S<c;++S){const T=o.shape[0]===1?E:E.subarray(S*8,S*8+8);for(let F=0;F<p;++F)for(let M=0;M<g;++M)for(let U=0;U<h;++U){let P;const L=T[6]*M+T[7]*F+1;if(L===0)continue;const G=(T[0]*M+T[1]*F+T[2])/L,X=(T[3]*M+T[4]*F+T[5])/L,Q=NS(G,f,a),Z=NS(X,d,a);switch(i){case"nearest":P=GQ(R,d,f,x,v,b,S,Z,Q,U,l);break;case"bilinear":P=HQ(R,d,f,x,v,b,S,Z,Q,U,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${i}`)}const te=S*C+F*k+M*w+U;I[te]=P}return s.makeTensorInfo(y,r.dtype,I)}return{dataId:s.write(I,y,r.dtype),shape:r.shape,dtype:r.dtype}}const zQ={kernelName:w1,backendName:"cpu",kernelFunc:_Q};function NS(t,e,n){switch(n){case"reflect":return VQ(t,e);case"wrap":return BQ(t,e);case"nearest":return UQ(t,e);case"constant":default:return WQ(t)}}function VQ(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const s=2*e;n<s&&(n=s*Math.trunc(-n/s)+n),n=n<-e?n+s:-n-1}else if(n>e-1)if(e<=1)n=0;else{const s=2*e;n-=s*Math.trunc(n/s),n>=e&&(n=s-n-1)}return Ji(0,n,e-1)}function BQ(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const s=e-1;n+=e*(Math.trunc(-n/s)+1)}else if(n>e-1)if(e<=1)n=0;else{const s=e-1;n-=e*Math.trunc(n/s)}return Ji(0,n,e-1)}function WQ(t,e){return t}function UQ(t,e){return Ji(0,t,e-1)}function Uu(t,e,n,s,r,o,i,a,l,u,c){const d=i*s+a*r+l*o+u;return 0<=a&&a<e&&0<=l&&l<n?t[d]:c}function GQ(t,e,n,s,r,o,i,a,l,u,c){const d=Math.round(a),f=Math.round(l);return Uu(t,e,n,s,r,o,i,d,f,u,c)}function HQ(t,e,n,s,r,o,i,a,l,u,c){const d=Math.floor(a),f=Math.floor(l),h=d+1,p=f+1,g=(p-l)*Uu(t,e,n,s,r,o,i,d,f,u,c)+(l-f)*Uu(t,e,n,s,r,o,i,d,p,u,c),y=(p-l)*Uu(t,e,n,s,r,o,i,h,f,u,c)+(l-f)*Uu(t,e,n,s,r,o,i,h,p,u,c);return(h-a)*g+(a-d)*y}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jQ(t){const{inputs:e,attrs:n,backend:s}=t,{axis:r}=n,{x:o}=e;fe(o,"unique");const i=s.data.get(o.dataId).values,{outputValues:a,outputShape:l,indices:u}=TP(i,r,o.shape,o.dtype);return[s.makeTensorInfo(l,o.dtype,a),s.makeTensorInfo([u.length],"int32",u)]}const KQ={kernelName:$1,backendName:"cpu",kernelFunc:jQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XQ(t){const{inputs:e,backend:n,attrs:s}=t,{value:r}=e;let{axis:o}=s;o<0&&(o+=r.shape.length);const i=r.shape.length,a=r.shape[o],l=new Array(i-1);let u=0;for(let h=0;h<i;h++)h!==o&&(l[u++]=r.shape[h]);const c=new Array(i).fill(0),d=r.shape.slice();d[o]=1;const f=new Array(a);for(let h=0;h<f.length;h++){c[o]=h;const p=da({inputs:{x:r},backend:n,attrs:{begin:c,size:d}});f[h]=rt({inputs:{x:p},backend:n,attrs:{shape:l}}),n.disposeIntermediateTensorInfo(p)}return f}const qQ={kernelName:$g,backendName:"cpu",kernelFunc:XQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YQ(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,segmentIds:o}=e,{numSegments:i}=s;fe(r,"unsortedSegmentSum");const a=r.shape.length,l=o.shape.length,u=[],c=[],d=a-l;let f=o;for(let p=0;p<d;++p){const g=Fp({inputs:{input:f},backend:n,attrs:{dim:p+1}});f=g,c.push(g)}for(let p=0;p<i;++p){const g=di(p,"int32"),y=n.makeTensorInfo([],"int32",g),m=WF({inputs:{a:y,b:f},backend:n}),x=ii({inputs:{x:m},backend:n,attrs:{dtype:"float32"}}),v=qg({inputs:{a:x,b:r},backend:n}),b=hf({inputs:{x:v},backend:n,attrs:{axis:0,keepDims:!1}});u.push(b),c.push(y),c.push(m),c.push(x),c.push(v),c.push(b)}const h=WP({inputs:u,backend:n,attrs:{axis:0}});return c.forEach(p=>n.disposeIntermediateTensorInfo(p)),h}const QQ={kernelName:Cg,backendName:"cpu",kernelFunc:YQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZQ=[jK,Ij,XK,YK,Dj,ZK,e9,n9,r9,i9,l9,c9,f9,m9,x9,b9,$9,k9,I9,GK,E9,R9,D9,Pj,P9,Rj,Lj,L9,Tj,_9,V9,B9,U9,H9,K9,q9,Q9,J9,tX,sX,oX,aX,uX,dX,fX,pX,gX,yX,vX,bX,wX,CX,IX,MK,EX,Mj,LX,_j,MX,Vj,UX,GX,jX,Wj,Gj,XX,YX,ZX,eq,jj,Xj,Ej,nq,z9,rq,iq,lq,_K,Yj,Zj,cq,eK,fq,mq,xq,bq,$q,kq,Sq,nK,Tq,Nq,Aq,Fq,Oq,Mq,zq,rK,Bq,Gq,Kq,iK,lK,Yq,Jq,nY,cK,rY,iY,aY,UP,dY,VK,hK,hY,mY,xY,vY,Nj,Qy,wY,BK,WK,UK,CY,SY,TY,NY,AY,DY,PY,wK,LY,BY,UY,KY,CK,qY,QY,JY,kK,Hq,nQ,rQ,iQ,lQ,cQ,fQ,pQ,gQ,TK,xQ,NK,AK,vQ,wQ,CQ,SQ,TQ,OK,kX,NQ,AQ,FQ,OQ,MQ,zQ,dK,KQ,qQ,QQ,oY];for(const t of ZQ)kN(t);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ni={},Qf={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function JQ(t,e){Ni[t]=e}function fr(t,e){if(!(t in Ni)||e!=null){const s=tZ(t,e);if(s!==null)Ni[t]=s;else return console.log("Could not get context for WebGL version",t),null}const n=Ni[t];return n==null||n.isContextLost()?(delete Ni[t],fr(t)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),Ni[t])}function eZ(t){if(!K().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&t===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function tZ(t,e){if(t!==1&&t!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=e??eZ(t);return n.addEventListener("webglcontextlost",s=>{s.preventDefault(),delete Ni[t]},!1),K().getBool("SOFTWARE_WEBGL_ENABLED")&&(Qf.failIfMajorPerformanceCaveat=!1),t===1?n.getContext("webgl",Qf)||n.getContext("experimental-webgl",Qf):n.getContext("webgl2",Qf)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Bc;(function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"})(Bc||(Bc={}));var fs;(function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"})(fs||(fs={}));var tn;(function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(tn||(tn={}));function pf(t,e){return[e,t]}function nZ(t,e){return t*e}function Zf(t){const e=Y(t),n=Math.ceil(e/4);return vy(n)}function su(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function sZ(t,e){const[n,s]=su(t,e);return n*s*4}function d$(t,e){const n=t;let s,r,o,i,a,l,u,c,d,f;return K().getNumber("WEBGL_VERSION")===2?(s=n.R32F,r=n.R16F,o=n.RGBA16F,i=n.RGBA32F,a=n.RED,u=4,c=1,d=n.HALF_FLOAT,f=n.FLOAT,l=n.RGBA8):(s=t.RGBA,r=t.RGBA,o=t.RGBA,i=n.RGBA,a=t.RGBA,u=4,c=4,d=e!=null?e.HALF_FLOAT_OES:null,f=t.FLOAT,l=t.RGBA),{internalFormatFloat:s,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:o,internalFormatPackedFloat:i,textureFormatFloat:a,downloadTextureFormat:l,downloadUnpackNumChannels:u,defaultNumChannels:c,textureTypeHalfFloat:d,textureTypeFloat:f}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ue(t,e){const n=e();return K().getBool("DEBUG")&&rZ(t),n}function rZ(t){const e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+lZ(t,e))}const oZ=596e-10,iZ=65504;function aZ(t){return!!(K().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||t===0||oZ<Math.abs(t)&&Math.abs(t)<iZ)}function lZ(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function Jf(t,e){return bo(t,()=>t.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function uZ(t,e){const n=bo(t,()=>t.createShader(t.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(ue(t,()=>t.shaderSource(n,e)),ue(t,()=>t.compileShader(n)),t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw console.log(t.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function cZ(t,e){const n=bo(t,()=>t.createShader(t.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(ue(t,()=>t.shaderSource(n,e)),ue(t,()=>t.compileShader(n)),K().get("ENGINE_COMPILE_ONLY"))return n;if(t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw GP(e,t.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}const dZ=/ERROR: [0-9]+:([0-9]+):/g;function GP(t,e){const n=dZ.exec(e);if(n==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(t);return}const s=+n[1],r=t.split(`
`),o=r.length.toString().length+2,i=r.map((d,f)=>xl((f+1).toString(),o)+d);let a=0;for(let d=0;d<i.length;d++)a=Math.max(i[d].length,a);const l=i.slice(0,s-1),u=i.slice(s-1,s),c=i.slice(s);console.log(l.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${xl(u[0],a)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(c.join(`
`))}function fZ(t){return bo(t,()=>t.createProgram(),"Unable to create WebGLProgram.")}function hZ(t,e){if(ue(t,()=>t.linkProgram(e)),!K().get("ENGINE_COMPILE_ONLY")&&t.getProgramParameter(e,t.LINK_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function tx(t,e){if(ue(t,()=>t.validateProgram(e)),t.getProgramParameter(e,t.VALIDATE_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function pZ(t,e){const n=bo(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return ue(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),ue(t,()=>t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function mZ(t,e){const n=bo(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return ue(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n)),ue(t,()=>t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function gZ(t){return bo(t,()=>t.createTexture(),"Unable to create WebGLTexture.")}function xZ(t,e){const n=K().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){const s=`[${t}x${e}]`;throw new Error("Requested texture size "+s+" is invalid.")}if(t>n||e>n){const s=`[${t}x${e}]`,r=`[${n}x${n}]`;throw new Error("Requested texture size "+s+" greater than WebGL maximum on this browser / GPU "+r+".")}}function yZ(t){return bo(t,()=>t.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function RS(t,e,n,s,r,o,i){const a=t.getAttribLocation(e,n);return a===-1?!1:(ue(t,()=>t.bindBuffer(t.ARRAY_BUFFER,s)),ue(t,()=>t.vertexAttribPointer(a,r,t.FLOAT,!1,o,i)),ue(t,()=>t.enableVertexAttribArray(a)),!0)}function vZ(t,e,n){kZ(t,n),ue(t,()=>t.activeTexture(t.TEXTURE0+n)),ue(t,()=>t.bindTexture(t.TEXTURE_2D,e))}function bZ(t,e,n){return bo(t,()=>t.getUniformLocation(e,n),'uniform "'+n+'" not present in program.')}function wZ(t,e,n){return t.getUniformLocation(e,n)}function $Z(t,e,n,s){ue(t,()=>vZ(t,e,s)),ue(t,()=>t.uniform1i(n,s))}function nx(t,e,n){ue(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,n)),ue(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0))}function AS(t,e){ue(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,e)),ue(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0))}function eh(t){const e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+CZ(t,e))}function CZ(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function bo(t,e,n){const s=ue(t,()=>e());if(s==null)throw new Error(n);return s}function kZ(t,e){const n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,s=e+t.TEXTURE0;if(s<t.TEXTURE0||s>n){const r=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw new Error(`textureUnit must be in ${r}.`)}}function Bl(t,e=2){return Y(t.slice(0,t.length-e))}function Wl(t){if(t.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function th(t){let e=[1,1,1];return t.length===0||t.length===1&&t[0]===1||(e=[Bl(t),...Wl(t)]),e}function SZ(t,e=!1){let n=K().getNumber("WEBGL_MAX_TEXTURE_SIZE"),s=K().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");s===1/0&&K().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(s=n/2),e&&(n=n*2,s=s*2,t=t.map((a,l)=>l>=t.length-2?Db(t[l]):t[l]),t.length===1&&(t=[2,t[0]])),t.length!==2&&(t=ci(t).newShape);let r=Y(t),o=null;t.length<=1&&r<=n?o=[1,r]:t.length===2&&t[0]<=n&&t[1]<=n?o=t:t.length===3&&t[0]*t[1]<=n&&t[2]<=n?o=[t[0]*t[1],t[2]]:t.length===3&&t[0]<=n&&t[1]*t[2]<=n?o=[t[0],t[1]*t[2]]:t.length===4&&t[0]*t[1]*t[2]<=n&&t[3]<=n?o=[t[0]*t[1]*t[2],t[3]]:t.length===4&&t[0]<=n&&t[1]*t[2]*t[3]<=n&&(o=[t[0],t[1]*t[2]*t[3]]);const i=o!=null&&Math.max(...o)>s&&Math.min(...o)<=(e?2:1)&&Math.min(...o)>0;if(o==null||i)if(e){const a=Bl(t);let l=2,u=2;t.length&&([l,u]=Wl(t)),r=a*(l/2)*(u/2),o=vy(r).map(c=>c*2)}else o=vy(r);return o}function nh(t){return t%2===0}function Op(t,e){if(t=t.slice(-2),e=e.slice(-2),He(t,e)||!t.length||!e.length||t[0]===0||t[1]===0||e[0]===0||e[1]===0)return!0;if(t.length!==e.length){const n=t[t.length-1],s=e[e.length-1];if(n===s||nh(n)&&nh(s)&&(t[0]===1||e[0]===1))return!0}return t[1]===e[1]&&nh(t[0])&&nh(e[0])}let sx,rx;function IZ(t){if(sx==null){const e=fr(t);sx=e.getParameter(e.MAX_TEXTURE_SIZE)}return sx}function TZ(t){if(rx==null){const e=fr(t);rx=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,rx)}function EZ(t){if(t===0)return 0;let e;const n=fr(t);return _s(n,"EXT_disjoint_timer_query_webgl2")&&t===2?e=2:_s(n,"EXT_disjoint_timer_query")?e=1:e=0,e}function _s(t,e){return t.getExtension(e)!=null}function DS(t){try{if(fr(t)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function NZ(t){if(t===0)return!1;const e=fr(t);if(t===1){if(!_s(e,"OES_texture_float"))return!1}else if(!_s(e,"EXT_color_buffer_float"))return!1;return Jy(e)}function RZ(t){if(t===0)return!1;const e=fr(t);if(t===1){if(!_s(e,"OES_texture_float")||!_s(e,"WEBGL_color_buffer_float"))return!1}else{if(_s(e,"EXT_color_buffer_float"))return Jy(e);const s="EXT_color_buffer_half_float";if(_s(e,s)){const r=e.getExtension(s);return AZ(e,r)}return!1}return Jy(e)}function Jy(t){const e=d$(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);const o=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,o),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);const i=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(o),i}function AZ(t,e){const n=d$(t,e),s=t.createTexture();t.bindTexture(t.TEXTURE_2D,s),t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,s,0);const a=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(s),t.deleteFramebuffer(i),a}function DZ(t){return t!==2?!1:fr(t).fenceSync!=null}function mf(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&N(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const he=K();he.registerFlag("HAS_WEBGL",()=>he.getNumber("WEBGL_VERSION")>0);he.registerFlag("WEBGL_VERSION",()=>DS(2)?2:DS(1)?1:0);he.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);he.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>he.get("WEBGL_VERSION")===2);he.registerFlag("WEBGL_CPU_FORWARD",()=>!0);he.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);he.registerFlag("WEBGL_PACK",()=>he.getBool("HAS_WEBGL"));he.registerFlag("WEBGL_PACK_NORMALIZATION",()=>he.getBool("WEBGL_PACK"));he.registerFlag("WEBGL_PACK_CLIP",()=>he.getBool("WEBGL_PACK"));he.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>he.getBool("WEBGL_PACK"));he.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>he.getBool("WEBGL_PACK"));he.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>he.getBool("WEBGL_PACK"));he.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>he.getBool("WEBGL_PACK"));he.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>he.getBool("WEBGL_PACK"));he.registerFlag("WEBGL_PACK_REDUCE",()=>he.getBool("WEBGL_PACK"));he.registerFlag("WEBGL_LAZILY_UNPACK",()=>he.getBool("WEBGL_PACK"));he.registerFlag("WEBGL_CONV_IM2COL",()=>he.getBool("WEBGL_PACK"));he.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>he.getBool("WEBGL_PACK"));he.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>IZ(he.getNumber("WEBGL_VERSION")));he.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>TZ(he.getNumber("WEBGL_VERSION")));he.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const t=he.getNumber("WEBGL_VERSION");return t===0?0:EZ(t)});he.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>he.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!BN());he.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>NZ(he.getNumber("WEBGL_VERSION")));he.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>he.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:he.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));he.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>RZ(he.getNumber("WEBGL_VERSION")));he.registerFlag("WEBGL_FENCE_API_ENABLED",()=>DZ(he.getNumber("WEBGL_VERSION")));he.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>he.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);he.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${t}.`)});he.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>BN()?1:-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${t}.`)});he.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);he.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);he.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);he.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);he.registerFlag("WEBGL_EXP_CONV",()=>!1);he.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>he.getBool("IS_TEST"));he.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);he.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);he.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);he.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function An(){let t,e,n,s,r,o,i,a,l,u;return K().getNumber("WEBGL_VERSION")===2?(t="#version 300 es",e="in",n="out",s="in",r="texture",o="outputColor",i="out vec4 outputColor;",a=K().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",u=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(t="",e="attribute",n="varying",s="varying",r="texture2D",o="gl_FragColor",i="",a=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,u=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:t,attribute:e,varyingVs:n,varyingFs:s,texture2D:r,output:o,defineOutput:i,defineSpecialNaN:a,defineSpecialInf:l,defineRound:u}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ra(t,e,n="index"){const s=me(e);return s.map((r,o)=>{const i=`int ${t[o]} = ${n} / ${r}`,a=o===s.length-1?`int ${t[o+1]} = ${n} - ${t[o]} * ${r}`:`index -= ${t[o]} * ${r}`;return`${i}; ${a};`}).join("")}function Yg(t,e,n="index"){const s=me(e);return s.map((r,o)=>{const i=`int ${t[o]} = ${n} / outShapeStrides[${o}]`,a=o===s.length-1?`int ${t[o+1]} = ${n} - ${t[o]} * outShapeStrides[${o}]`:`index -= ${t[o]} * outShapeStrides[${o}]`;return`${i}; ${a};`}).join("")}function FZ(t,e){const n=t.length,s=t.map(o=>`${e}[${o}]`),r=new Array(n-1);r[n-2]=s[n-1];for(let o=n-3;o>=0;--o)r[o]=`(${r[o+1]} * ${s[o+1]})`;return r}function PZ(t,e,n="index"){const s=t.map((o,i)=>i),r=FZ(s,e);return r.map((o,i)=>{const a=`int ${t[i]} = ${n} / ${r[i]}`,l=i===r.length-1?`int ${t[i+1]} = ${n} - ${t[i]} * ${r[i]}`:`index -= ${t[i]} * ${r[i]}`;return`${a}; ${l};`}).join("")}function f$(t){const e=me(t).map(n=>n.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function h$(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const HP=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:jP}=k5;function OZ(t,e,n){const s=[];if(t.forEach(h=>{const p=Y(h.shapeInfo.logicalShape);if(h.shapeInfo.isUniform?s.push(`uniform float ${h.name}${p>1?`[${p}]`:""};`):(s.push(`uniform sampler2D ${h.name};`),s.push(`uniform int offset${h.name};`)),n.enableShapeUniforms){const{uniformShape:g}=p$(n.packedInputs,h.shapeInfo.logicalShape,h.shapeInfo.texShape);switch(g.length){case 1:s.push(`uniform int ${h.name}Shape;`);break;case 2:s.push(`uniform ivec2 ${h.name}Shape;`);break;case 3:s.push(`uniform ivec3 ${h.name}Shape;`);break;case 4:s.push(`uniform ivec4 ${h.name}Shape;`);break}s.push(`uniform ivec2 ${h.name}TexShape;`)}}),n.enableShapeUniforms){switch(e.logicalShape.length){case 1:s.push("uniform int outShape;");break;case 2:s.push("uniform ivec2 outShape;"),s.push("uniform int outShapeStrides;");break;case 3:s.push("uniform ivec3 outShape;"),s.push("uniform ivec2 outShapeStrides;");break;case 4:s.push("uniform ivec4 outShape;"),s.push("uniform ivec3 outShapeStrides;");break}s.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(h=>{s.push(`uniform ${h.type} ${h.name}${h.arrayIndex?`[${h.arrayIndex}]`:""};`)});const r=s.join(`
`),o=t.map(h=>LZ(h,e,n.packedInputs,n.enableShapeUniforms)).join(`
`),i=e.texShape,a=An(),l=zZ(a);let u,c,d=WZ(a);return e.isPacked?(u=MZ(e.logicalShape,i,n.enableShapeUniforms),c=BZ(a)):(u=_Z(e.logicalShape,i,n.enableShapeUniforms),c=VZ(a)),n.packedInputs&&(d+=jZ),[d,l,c,r,u,o,n.userCode].join(`
`)}function ru(t,e=!1){const n=t.shapeInfo.logicalShape;switch(n.length){case 0:return rJ(t,e);case 1:return iJ(t,e);case 2:return lJ(t,e);case 3:return cJ(t,e);case 4:return fJ(t,e);case 5:return hJ(t);case 6:return pJ(t);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function KP(t,e){switch(t.shapeInfo.logicalShape.length){case 0:return sJ(t);case 1:return oJ(t,e);case 2:return aJ(t,e);case 3:return uJ(t,e);default:return dJ(t,e)}}function LZ(t,e,n=!1,s){let r="";n?r+=KP(t,s):r+=ru(t,s);const o=t.shapeInfo.logicalShape,i=e.logicalShape;return o.length<=i.length&&(n?r+=mJ(t,e):r+=gJ(t,e)),r}function MZ(t,e,n){switch(t.length){case 0:return XP();case 1:return KZ(t,e,n);case 2:return tJ(t,e,n);case 3:return qZ(t,e,n);default:return QZ(t,e,n)}}function _Z(t,e,n){switch(t.length){case 0:return XP();case 1:return XZ(t,e,n);case 2:return nJ(t,e,n);case 3:return YZ(t,e,n);case 4:return ZZ(t,e,n);case 5:return JZ(t,e);case 6:return eJ(t,e);default:throw new Error(`${t.length}-D output sampling is not yet supported`)}}function zZ(t){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${t.texture2D}(textureSampler, uv).r;
    }
  `}function VZ(t){return`
    void setOutput(float val) {
      ${t.output} = vec4(val, 0, 0, 0);
    }
  `}function BZ(t){return`
    void setOutput(vec4 val) {
      ${t.output} = val;
    }
  `}function WZ(t){return`${t.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${t.varyingFs} vec2 resultUV;
    ${t.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${t.defineSpecialNaN}
    ${t.defineSpecialInf}
    ${t.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${UZ}
    ${GZ}
    ${HZ}
  `}const UZ=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,GZ=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,HZ=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,jZ=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function XP(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function KZ(t,e,n){const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return s[0]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${s[1]}.0);
      }
    `:s[1]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${s[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      return 2 * (resTexRC.x * ${s[1]} + resTexRC.y);
    }
  `}function XZ(t,e,n){return e[0]===1?n?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?n?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function qZ(t,e,n){if(n)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(t[2]/2),o=r*Math.ceil(t[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      int b = index / ${o};
      index -= b * ${o};

      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec3(b, r, c);
    }
  `}function YZ(t,e,n){if(n)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${Yg(["r","c","d"],t)}
    return ivec3(r, c, d);
  }
`;const s=Ra(["r","c","d"],t);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${s}
      return ivec3(r, c, d);
    }
  `}function QZ(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(t[t.length-1]/2),o=r*Math.ceil(t[t.length-2]/2);let i=o,a="",l="b, r, c";for(let u=2;u<t.length-1;u++)i*=t[t.length-u-1],a=`
      int b${u} = index / ${i};
      index -= b${u} * ${i};
    `+a,l=`b${u}, `+l;return`
    ivec${t.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      ${a}

      int b = index / ${o};
      index -= b * ${o};

      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec${t.length}(${l});
    }
  `}function ZZ(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${Yg(["r","c","d","d2"],t)}
      return ivec4(r, c, d, d2);
    }
  `;const s=Ra(["r","c","d","d2"],t);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${s}
      return ivec4(r, c, d, d2);
    }
  `}function JZ(t,e){const n=Ra(["r","c","d","d2","d3"],t);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function eJ(t,e){const n=Ra(["r","c","d","d2","d3","d4"],t);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function tJ(t,e,n){const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(He(t,e))return n?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${s[0]}, ${s[1]}));
      }
    `;const r=Math.ceil(t[1]/2);return n?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));

      int index = resTexRC.x * ${s[1]} + resTexRC.y;
      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec2(r, c);
    }
  `}function nJ(t,e,n){return He(t,e)?n?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:t[1]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:t[0]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:n?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${t[1]};
      int c = index - r * ${t[1]};
      return ivec2(r, c);
    }
  `}function Aa(t){return`offset${t}`}function sJ(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),s=An();return`
    vec4 ${n}() {
      return ${s.texture2D}(${e}, halfCR);
    }
  `}function rJ(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`float ${s}() {return ${n};}`;const[r,o]=t.shapeInfo.texShape;if(r===1&&o===1)return`
      float ${s}() {
        return sampleTexture(${n}, halfCR);
      }
    `;const i=Aa(n);if(e)return`
    float ${s}() {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${i});
      return sampleTexture(${n}, uv);
    }
  `;const[a,l]=t.shapeInfo.texShape;return`
    float ${s}() {
      vec2 uv = uvFromFlat(${a}, ${l}, ${i});
      return sampleTexture(${n}, uv);
    }
  `}function oJ(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),r=t.shapeInfo.texShape,o=An();if(e)return`
    vec4 ${s}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${o.texture2D}(${n}, uv);
    }
  `;const i=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)];return`
    vec4 ${s}(int index) {
      vec2 uv = packedUVfrom1D(
        ${i[0]}, ${i[1]}, index);
      return ${o.texture2D}(${n}, uv);
    }
  `}function iJ(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`
      float ${s}(int index) {
        ${ou(t)}
      }
    `;const r=t.shapeInfo.texShape,o=r[0],i=r[1];if(i===1&&o===1)return`
      float ${s}(int index) {
        return sampleTexture(${n}, halfCR);
      }
    `;const a=Aa(n);return i===1?e?`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / float(${n}TexShape[0]));
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / ${o}.0);
        return sampleTexture(${n}, uv);
      }
    `:o===1?e?`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / float(${n}TexShape[1]), 0.5);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / ${i}.0, 0.5);
        return sampleTexture(${n}, uv);
      }
    `:e?`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${a});
      return sampleTexture(${n}, uv);
    }
  `:`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${o}, ${i}, index + ${a});
      return sampleTexture(${n}, uv);
    }
  `}function aJ(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),o=t.shapeInfo.texShape,i=o[0],a=o[1],l=An();if(o!=null&&He(n,o))return e?`
      vec4 ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);

        return ${l.texture2D}(${s}, uv);
      }
    `:`
      vec4 ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${a}.0, ${i}.0);

        return ${l.texture2D}(${s}, uv);
      }
    `;if(e)return`
    vec4 ${r}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `;const u=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],c=Math.ceil(n[1]/2);return`
    vec4 ${r}(int row, int col) {
      vec2 uv = packedUVfrom2D(${c}, ${u[0]}, ${u[1]}, row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `}function lJ(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),o=t.shapeInfo.texShape;if(o!=null&&He(n,o)){if(e)return`
      float ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `;const f=o[0],h=o[1];return`
    float ${r}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${h}.0, ${f}.0);
      return sampleTexture(${s}, uv);
    }
  `}const{newShape:i,keptDims:a}=ci(n),l=i;if(l.length<n.length){const f=iu(t,l),h=["row","col"];return`
      ${ru(f,e)}
      float ${r}(int row, int col) {
        return ${r}(${au(h,a)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));
        ${ou(t)}
      }
    `;const u=o[0],c=o[1],d=Aa(s);return c===1?e?`
      float ${r}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${s}TexShape[0]));
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${u}.0);
      return sampleTexture(${s}, uv);
    }
  `:u===1?e?`
      float ${r}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${s}TexShape[1]), 0.5);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${c}.0, 0.5);
      return sampleTexture(${s}, uv);
    }
  `:e?`
      float ${r}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${s}Shape[1] + col + ${d};
        vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
        return sampleTexture(${s}, uv);
      }
    `:`
  float ${r}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${n[1]} + col + ${d};
    vec2 uv = uvFromFlat(${u}, ${c}, index);
    return sampleTexture(${s}, uv);
  }
`}function uJ(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),o=t.shapeInfo.texShape,i=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];if(n[0]===1){const f=n.slice(1),h=[1,2],p=iu(t,f),g=["b","row","col"];return`
        ${KP(p,e)}
        vec4 ${r}(int b, int row, int col) {
          return ${r}(${au(g,h)});
        }
      `}const a=An();if(e)return`
    vec4 ${r}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${a.texture2D}(${s}, uv);
    }
  `;const l=i[0],u=i[1],c=Math.ceil(n[2]/2),d=c*Math.ceil(n[1]/2);return`
    vec4 ${r}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${u}, ${d}, ${c}, b, row, col);
      return ${a.texture2D}(${s}, uv);
    }
  `}function cJ(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),o=n[1]*n[2],i=n[2],{newShape:a,keptDims:l}=ci(n),u=a;if(u.length<n.length){const g=iu(t,u),y=["row","col","depth"];return`
        ${ru(g,e)}
        float ${r}(int row, int col, int depth) {
          return ${r}(${au(y,l)});
        }
      `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${o}, ${i}, 1)));
        ${ou(t)}
      }
    `;const c=t.shapeInfo.texShape,d=c[0],f=c[1],h=t.shapeInfo.flatOffset;if(f===o&&h==null)return e?`
      float ${r}(int row, int col, int depth) {
        int stride1 = ${s}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
        float ${r}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${i}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${f}.0, ${d}.0);
          return sampleTexture(${s}, uv);
        }
      `;if(f===i&&h==null)return e?`
      float ${r}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${s}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${f}.0, ${d}.0);
      return sampleTexture(${s}, uv);
    }
  `;const p=Aa(s);return e?`
    float ${r}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${s}Shape[1] * ${s}Shape[2];
      int stride1 = ${s}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${p};
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
      return sampleTexture(${s}, uv);
    }
    `:`
      float ${r}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${o} + col * ${i} + depth + ${p};
        vec2 uv = uvFromFlat(${d}, ${f}, index);
        return sampleTexture(${s}, uv);
      }
  `}function dJ(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),r=An();if(e)return`
    vec4 ${s}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${n}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${r.texture2D}(${n}, uv);
    }
  `;const o=t.shapeInfo.logicalShape,i=o.length,a=t.shapeInfo.texShape,l=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],u=l[0],c=l[1],d=Math.ceil(o[i-1]/2);let f=d*Math.ceil(o[i-2]/2),h="int b, int row, int col",p=`b * ${f} + (row / 2) * ${d} + (col / 2)`;for(let g=2;g<i-1;g++)h=`int b${g}, `+h,f*=o[i-g-1],p=`b${g} * ${f} + `+p;return`
    vec4 ${s}(${h}) {
      int index = ${p};
      int texR = index / ${c};
      int texC = index - texR * ${c};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${c}, ${u});
      return ${r.texture2D}(${n}, uv);
    }
  `}function fJ(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),o=n[3],i=n[2]*o,a=n[1]*i,{newShape:l,keptDims:u}=ci(n);if(l.length<n.length){const x=iu(t,l),v=["row","col","depth","depth2"];return`
      ${ru(x,e)}
      float ${r}(int row, int col, int depth, int depth2) {
        return ${r}(${au(v,u)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${a}, ${i}, ${o}, 1)));
        ${ou(t)}
      }
    `;const c=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,f=d[0],h=d[1],p=`int stride2 = ${s}Shape[3];`,g=`int stride1 = ${s}Shape[2] * stride2;`,y=`int stride0 = ${s}Shape[1] * stride1;`;if(h===a&&c==null)return e?`
      float ${r}(int row, int col, int depth, int depth2) {
        ${p}
        ${g}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${i}, ${o}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${h}.0, ${f}.0);
        return sampleTexture(${s}, uv);
      }
    `;if(h===o&&c==null)return e?`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${s}Shape[1] * ${s}Shape[2], ${s}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${n[1]*n[2]}, ${n[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${h}.0, ${f}.0);
        return sampleTexture(${s}, uv);
      }
    `;const m=Aa(s);return e?`
    float ${r}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${p}
      ${g}
      ${y}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index + ${m});
      return sampleTexture(${s}, uv);
    }
  `:`
    float ${r}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${i} +
          depth * ${o} + depth2;
      vec2 uv = uvFromFlat(${f}, ${h}, index + ${m});
      return sampleTexture(${s}, uv);
    }
  `}function hJ(t){const e=t.shapeInfo.logicalShape,n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),r=e[4],o=e[3]*r,i=e[2]*o,a=e[1]*i,{newShape:l,keptDims:u}=ci(e);if(l.length<e.length){const g=iu(t,l),y=["row","col","depth","depth2","depth3"];return`
      ${ru(g)}
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        return ${s}(${au(y,u)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${a}, ${i}, ${o}, ${r})) +
          depth3;
        ${ou(t)}
      }
    `;const c=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,f=d[0],h=d[1];if(h===a&&c==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${i}, ${o}, ${r}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${h}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(h===r&&c==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${h}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;const p=Aa(n);return`
    float ${s}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${i} + depth * ${o} +
          depth2 * ${r} + depth3 + ${p};
      vec2 uv = uvFromFlat(${f}, ${h}, index);
      return sampleTexture(${n}, uv);
    }
  `}function pJ(t){const e=t.shapeInfo.logicalShape,n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:r,keptDims:o}=ci(e);if(r.length<e.length){const y=iu(t,r),m=["row","col","depth","depth2","depth3","depth4"];return`
      ${ru(y)}
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${s}(${au(m,o)});
      }
    `}const i=e[5],a=e[4]*i,l=e[3]*a,u=e[2]*l,c=e[1]*u;if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${c}, ${u}, ${l}, ${a})) +
          dot(
            vec2(depth3, depth4),
            vec2(${i}, 1)));
        ${ou(t)}
      }
    `;const d=t.shapeInfo.flatOffset,f=t.shapeInfo.texShape,h=f[0],p=f[1];if(p===c&&d==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${u}, ${l}, ${a}, ${i})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${p}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(p===i&&d==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${p}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;const g=Aa(n);return`
    float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${c} + col * ${u} + depth * ${l} +
          depth2 * ${a} + depth3 * ${i} + depth4 + ${g};
      vec2 uv = uvFromFlat(${h}, ${p}, index);
      return sampleTexture(${n}, uv);
    }
  `}function ou(t){const e=t.name,n=Y(t.shapeInfo.logicalShape);return n<2?`return ${e};`:`
    for (int i = 0; i < ${n}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function mJ(t,e){const n=t.name,s=n.charAt(0).toUpperCase()+n.slice(1),r="get"+s+"AtOutCoords",o=t.shapeInfo.logicalShape.length,i=e.logicalShape.length,a=jP(t.shapeInfo.logicalShape,e.logicalShape),l=Je(i),u=i-o;let c;const d=["x","y","z","w","u","v"];o===0?c="":i<2&&a.length>=1?c="coords = 0;":c=a.map(x=>`coords.${d[x+u]} = 0;`).join(`
`);let f="";i<2&&o>0?f="coords":f=t.shapeInfo.logicalShape.map((x,v)=>`coords.${d[v+u]}`).join(", ");let h="return outputValue;";const g=Y(t.shapeInfo.logicalShape)===1,m=Y(e.logicalShape)===1;if(o===1&&!g&&!m)h=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(g&&!m)i===1?h=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:h=`
        return vec4(outputValue.x);
      `;else if(a.length){const x=o-2,v=o-1;a.indexOf(x)>-1&&a.indexOf(v)>-1?h="return vec4(outputValue.x);":a.indexOf(x)>-1?h="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":a.indexOf(v)>-1&&(h="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${r}() {
      ${l} coords = getOutputCoords();
      ${c}
      vec4 outputValue = get${s}(${f});
      ${h}
    }
  `}function gJ(t,e){const n=t.name,s=n.charAt(0).toUpperCase()+n.slice(1),r="get"+s+"AtOutCoords",o=e.texShape,i=t.shapeInfo.texShape,a=t.shapeInfo.logicalShape.length,l=e.logicalShape.length;if(!t.shapeInfo.isUniform&&a===l&&t.shapeInfo.flatOffset==null&&He(i,o))return`
      float ${r}() {
        return sampleTexture(${n}, resultUV);
      }
    `;const u=Je(l),c=jP(t.shapeInfo.logicalShape,e.logicalShape),d=l-a;let f;const h=["x","y","z","w","u","v"];a===0?f="":l<2&&c.length>=1?f="coords = 0;":f=c.map(g=>`coords.${h[g+d]} = 0;`).join(`
`);let p="";return l<2&&a>0?p="coords":p=t.shapeInfo.logicalShape.map((g,y)=>`coords.${h[y+d]}`).join(", "),`
    float ${r}() {
      ${u} coords = getOutputCoords();
      ${f}
      return get${s}(${p});
    }
  `}function Je(t){if(t<=1)return"int";if(t===2)return"ivec2";if(t===3)return"ivec3";if(t===4)return"ivec4";if(t===5)return"ivec5";if(t===6)return"ivec6";throw Error(`GPU for rank ${t} is not yet supported`)}function p$(t,e,n){const{newShape:s,keptDims:r}=ci(e),o=e.length,i=t&&o===3&&e[0]===1,a=i?e.slice(1):s,l=!t&&o>1&&!He(e,n)&&s.length<o||i;return{useSqueezeShape:l,uniformShape:l?a:e,keptDims:r}}function iu(t,e){const n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function au(t,e){return e.map(n=>t[n]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xJ(t,e,n,s){const r=n.map((c,d)=>{const f={logicalShape:c.shape,texShape:c.isUniform?null:c.texData.texShape,isUniform:c.isUniform,isPacked:c.isUniform?!1:c.texData.isPacked,flatOffset:null};return c.texData!=null&&c.texData.slice!=null&&c.texData.slice.flatOffset>0&&(f.flatOffset=c.texData.slice.flatOffset),{name:e.variableNames[d],shapeInfo:f}}),o=r.map(c=>c.shapeInfo),i={logicalShape:s.shape,texShape:s.texData.texShape,isUniform:!1,isPacked:s.texData.isPacked,flatOffset:null},a=OZ(r,i,e),l=cZ(t.gl,a),u=t.createProgram(l);return K().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:l,source:a,webGLProgram:u,inShapeInfos:o,outShapeInfo:i,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(t.buildVao(u),Object.assign({program:e,fragmentShader:l,source:a,webGLProgram:u,inShapeInfos:o,outShapeInfo:i},qP(t,e,u)))}function qP(t,e,n){const s=[],r=[];let o,i,a,l=null,u=null;u=t.getUniformLocation(n,"NAN",!1),K().getNumber("WEBGL_VERSION")===1&&(l=t.getUniformLocation(n,"INFINITY",!1));const c=!1;for(const d of e.variableNames){const f={name:d,uniform:t.getUniformLocation(n,d,c),offset:t.getUniformLocation(n,`offset${d}`,c)};e.enableShapeUniforms&&(f.shape=t.getUniformLocation(n,`${d}Shape`,c),f.texShape=t.getUniformLocation(n,`${d}TexShape`,c)),s.push(f)}if(e.enableShapeUniforms&&(o=t.getUniformLocation(n,"outShape",c),a=t.getUniformLocation(n,"outShapeStrides",c),i=t.getUniformLocation(n,"outTexShape",c)),e.customUniforms)for(const d of e.customUniforms)r.push(t.getUniformLocation(n,d.name,c));return{variablesLocations:s,customUniformLocations:r,infLoc:l,nanLoc:u,outShapeLocation:o,outShapeStridesLocation:a,outTexShapeLocation:i}}function FS(t,e){if(t.length!==e.length)throw Error(`Binary was compiled with ${t.length} inputs, but was executed with ${e.length} inputs`);t.forEach((n,s)=>{const r=n.logicalShape,o=e[s],i=o.shape;if(!He(r,i))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${r} and ${i} must match`);if(n.isUniform&&o.isUniform)return;const a=n.texShape,l=o.isUniform?null:o.texData.texShape;if(!He(a,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${a} and ${l} must match`)})}function yJ(t,e,n,s,r){e.program.enableShapeUniforms||(FS(e.inShapeInfos,n),FS([e.outShapeInfo],[s]));const o=s.texData.texture,i=s.texData.texShape;s.texData.isPacked?t.setOutputPackedMatrixTexture(o.texture,i[0],i[1]):t.setOutputMatrixTexture(o.texture,i[0],i[1]),t.setProgram(e.webGLProgram),t.bindVertexArray(e.webGLProgram.vao),K().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&t.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&t.gl.uniform1f(e.nanLoc,NaN);for(let l=0;l<n.length;++l){const u=n[l],{uniform:c,offset:d,shape:f,texShape:h}=e.variablesLocations[l];if(f){const{uniformShape:p}=p$(e.program.packedInputs,u.shape,u.texData.texShape);switch(p.length){case 1:t.gl.uniform1iv(f,new Int32Array(p));break;case 2:t.gl.uniform2iv(f,new Int32Array(p));break;case 3:t.gl.uniform3iv(f,new Int32Array(p));break;case 4:t.gl.uniform4iv(f,new Int32Array(p));break}}if(h&&t.gl.uniform2i(h,u.texData.texShape[0],u.texData.texShape[1]),c!=null){if(u.isUniform){if(Y(u.shape)<2)t.gl.uniform1f(c,u.uniformValues[0]);else{let p=u.uniformValues;p instanceof Float32Array||(p=new Float32Array(p)),t.gl.uniform1fv(c,p)}continue}u.texData.slice!=null&&d!=null&&t.gl.uniform1i(d,u.texData.slice.flatOffset),t.setInputMatrixTexture(u.texData.texture.texture,c,l)}}const a=e.outShapeLocation;if(a)switch(s.shape.length){case 1:t.gl.uniform1iv(a,new Int32Array(s.shape));break;case 2:t.gl.uniform2iv(a,new Int32Array(s.shape));break;case 3:t.gl.uniform3iv(a,new Int32Array(s.shape));break;case 4:t.gl.uniform4iv(a,new Int32Array(s.shape));break}if(e.outShapeStridesLocation){const l=me(s.shape);switch(s.shape.length){case 2:t.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(l));break;case 3:t.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(l));break;case 4:t.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(l));break}}if(e.outTexShapeLocation&&t.gl.uniform2i(e.outTexShapeLocation,s.texData.texShape[0],s.texData.texShape[1]),e.program.customUniforms&&r)for(let l=0;l<e.program.customUniforms.length;++l){const u=e.program.customUniforms[l],c=e.customUniformLocations[l],d=r[l];if(u.type==="float")t.gl.uniform1fv(c,d);else if(u.type==="vec2")t.gl.uniform2fv(c,d);else if(u.type==="vec3")t.gl.uniform3fv(c,d);else if(u.type==="vec4")t.gl.uniform4fv(c,d);else if(u.type==="int")t.gl.uniform1iv(c,d);else if(u.type==="ivec2")t.gl.uniform2iv(c,d);else if(u.type==="ivec3")t.gl.uniform3iv(c,d);else if(u.type==="ivec4")t.gl.uniform4iv(c,d);else throw Error(`uniform type ${u.type} is not supported yet.`)}t.executeProgram()}function vJ(t,e,n){let s="";e.concat(n).forEach(i=>{const a=i.texData!=null&&i.texData.slice!=null&&i.texData.slice.flatOffset>0;if(t.enableShapeUniforms&&!i.isUniform){const l=i.texData.texShape,{useSqueezeShape:u,uniformShape:c,keptDims:d}=p$(t.packedInputs,i.shape,l);let f="",h="",p="";if(c.length===1&&t.packedInputs){const $=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];f=`${$[0]>1}_${$[1]>1}`}else if(c.length===2&&!t.packedInputs)h=`${c[0]>1}_${c[1]>1}`;else if(c.length>2&&!t.packedInputs){const $=me(c);p=`${$[0]===l[1]}_${$[$.length-1]===l[1]}`}const g=i.shape.length,y=c.length===2&&He(i.shape,l),m=Y(i.shape)===1,x=Ol(i.shape,n.shape),v=!t.packedInputs&&g===n.shape.length&&He(l,n.texData.texShape),b=t.packedInputs||c.length>2?"":`${l[0]>1}_${l[1]>1}`;s+=`${g}_${v}_${u?d:""}_${c.length}_${m}_${x}_${y}_${f}_${h}_${p}_${b}_${a}`}else{const l=i.isUniform?"uniform":i.texData.texShape;s+=`${i.shape}_${l}_${a}`}});const r=t.userCode;let o=t.constructor.name;return o+="_"+s+"_"+r+`${K().getNumber("WEBGL_VERSION")}`,o}function yn(t){return K().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&t<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bJ{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Bc.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=An();this.outputShape=e,this.enableShapeUniforms=yn(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?Yg(["r","c","d"],e):Ra(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wJ{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Bc.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=An();this.outputShape=e,this.enableShapeUniforms=yn(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?Yg(["r","c","d"],e):Ra(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $J{constructor(e){this.variableNames=["A"],this.outTexUsage=fs.DOWNLOAD;const n=An();this.outputShape=e,this.userCode=`
      ${HP}

      void main() {
        float x = getAAtOutCoords();
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class CJ{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=fs.DOWNLOAD;const n=An();this.outputShape=e,this.userCode=`
      ${HP}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kJ={R:0,G:1,B:2,A:3};class PS{constructor(e,n=!1,s="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=An();this.outputShape=e,this.enableShapeUniforms=yn(this.outputShape.length);let o="result";n&&(o="floor(result * 255. + 0.5)");let i="";for(let a=0;a<s.length;a++){const l=s[a];i+=`
          if(offset == ${a}) {
            result = values[${kJ[l]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?h$():f$(e)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${s.length});

        flatIndex = idiv(flatIndex, ${s.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${r.texture2D}(A, uv);
          ${i}
        }
        ${r.output} = vec4(${o}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class SJ{constructor(e,n=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=An();this.outputShape=e,this.enableShapeUniforms=yn(this.outputShape.length);let r="",o="result";n&&(o="floor(result * 255. + 0.5)");for(let i=0;i<=1;i++)for(let a=0;a<=1;a++){const l=i*2+a;r+=`
          localCoords = coords;
          if(localCoords[2] + ${a} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${a};
          if (localCoords[1] + ${i} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${i};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${s.texture2D}(A, uv);

            if (offset == 0) {
              result[${l}] = values[0];
            } else if (offset == 1) {
              result[${l}] = values[1];
            } else if (offset == 2) {
              result[${l}] = values[2];
            } else {
              result[${l}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?h$():f$(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${r}

          ${s.output} = ${o};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IJ(t){const e=An(),n=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return uZ(t,n)}function TJ(t){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return pZ(t,e)}function EJ(t){const e=new Uint16Array([0,1,2,2,1,3]);return mZ(t,e)}function gf(t,e,n,s,r,o){xZ(e,n);const i=gZ(t),a=t.TEXTURE_2D;return ue(t,()=>t.bindTexture(a,i)),ue(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)),ue(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),ue(t,()=>t.texParameteri(a,t.TEXTURE_MIN_FILTER,t.NEAREST)),ue(t,()=>t.texParameteri(a,t.TEXTURE_MAG_FILTER,t.NEAREST)),K().getNumber("WEBGL_VERSION")===1?ue(t,()=>t.texImage2D(a,0,s,e,n,0,r,o,null)):ue(t,()=>t.texStorage2D(a,1,s,e,n)),ue(t,()=>t.bindTexture(t.TEXTURE_2D,null)),{texture:i,texShape:[n,e]}}function YP(t){return t.internalFormatFloat}function NJ(t,e,n,s){const[r,o]=pf(e,n);return gf(t,r,o,YP(s),s.textureFormatFloat,t.FLOAT)}function QP(t){return t.internalFormatHalfFloat}function RJ(t,e,n,s){const[r,o]=pf(e,n);return gf(t,r,o,QP(s),s.textureFormatFloat,s.textureTypeHalfFloat)}function ZP(t){return t.downloadTextureFormat}function AJ(t,e,n,s){const[r,o]=pf(e,n);return gf(t,r,o,ZP(s),t.RGBA,t.UNSIGNED_BYTE)}function JP(t){return t.internalFormatPackedFloat}function DJ(t,e,n,s){const[r,o]=su(e,n);return gf(t,r,o,JP(s),t.RGBA,t.FLOAT)}function eO(t){return t.internalFormatPackedHalfFloat}function FJ(t,e,n,s){const[r,o]=su(e,n);return gf(t,r,o,eO(s),t.RGBA,s.textureTypeHalfFloat)}function PJ(t,e,n){return ue(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),RS(t,e,"clipSpacePos",n,3,20,0)&&RS(t,e,"uv",n,2,20,12)}function OJ(t,e,n,s,r,o){ue(t,()=>t.bindTexture(t.TEXTURE_2D,e));let i,a,l;r instanceof Uint8Array?(i=new Uint8Array(n*s*4),a=t.UNSIGNED_BYTE,l=t.RGBA):(i=new Float32Array(n*s*4),a=t.FLOAT,l=o.internalFormatPackedFloat),i.set(r),K().getNumber("WEBGL_VERSION")===2?ue(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n,s,t.RGBA,a,i)):ue(t,()=>t.texImage2D(t.TEXTURE_2D,0,l,n,s,0,t.RGBA,a,i)),ue(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function LJ(t,e,n){ue(t,()=>t.bindTexture(t.TEXTURE_2D,e)),n.data instanceof Uint8Array?K().getNumber("WEBGL_VERSION")===2?ue(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n.width,n.height,t.RGBA,t.UNSIGNED_BYTE,n.data)):ue(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n.width,n.height,0,t.RGBA,t.UNSIGNED_BYTE,n.data)):K().getNumber("WEBGL_VERSION")===2?ue(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,n)):ue(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n)),ue(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function MJ(t,e,n,s){const r=t.createBuffer();ue(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,r));const a=4*4*e*n;return ue(t,()=>t.bufferData(t.PIXEL_PACK_BUFFER,a,t.STREAM_READ)),ue(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,0)),ue(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,null)),r}function _J(t,e,n){const s=t,r=new Float32Array(n);return s.bindBuffer(s.PIXEL_PACK_BUFFER,e),s.getBufferSubData(s.PIXEL_PACK_BUFFER,0,r),s.bindBuffer(s.PIXEL_PACK_BUFFER,null),r}function zJ(t,e,n,s){const[r,o]=pf(e,n),i=4,a=new Uint8Array(nZ(e*n,i));return ue(t,()=>t.readPixels(0,0,r,o,s.downloadTextureFormat,t.UNSIGNED_BYTE,a)),new Float32Array(a.buffer)}function VJ(t,e,n,s,r,o,i,a){const l=t,u=new Float32Array(sZ(o,i));return l.bindBuffer(l.PIXEL_PACK_BUFFER,e),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,u),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),u}function BJ(t,e,n){const s=new Float32Array(e*n*4);return ue(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,s)),s}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ox{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const n=K().getNumber("WEBGL_VERSION");if(e!=null?(this.gl=e,JQ(n,e)):this.gl=fr(n),e=this.gl,K().getNumber("WEBGL_VERSION")===2){const o=e;this.createVertexArray=()=>ue(o,()=>o.createVertexArray()),this.bindVertexArray=i=>ue(o,()=>o.bindVertexArray(i)),this.deleteVertexArray=i=>ue(o,()=>o.deleteVertexArray(i)),this.getVertexArray=()=>ue(o,()=>o.getParameter(o.VERTEX_ARRAY_BINDING))}else if(e!=null){const o=e.getExtension("OES_vertex_array_object");if(o==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>ue(e,()=>o.createVertexArrayOES()),this.bindVertexArray=i=>ue(e,()=>o.bindVertexArrayOES(i)),this.deleteVertexArray=i=>ue(e,()=>o.deleteVertexArrayOES(i)),this.getVertexArray=()=>ue(e,()=>e.getParameter(o.VERTEX_ARRAY_BINDING_OES))}let s="WEBGL_color_buffer_float";const r="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),K().getNumber("WEBGL_VERSION")===1){const o="OES_texture_float",i="OES_texture_half_float";if(this.textureFloatExtension=Jf(this.gl,o),_s(this.gl,i))this.textureHalfFloatExtension=Jf(this.gl,i);else if(K().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(s),_s(this.gl,r))this.colorBufferHalfFloatExtension=Jf(this.gl,r);else if(K().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(s="EXT_color_buffer_float",_s(this.gl,s))this.colorBufferFloatExtension=this.gl.getExtension(s);else if(_s(this.gl,r))this.colorBufferHalfFloatExtension=this.gl.getExtension(r);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=TJ(this.gl),this.indexBuffer=EJ(this.gl),this.framebuffer=yZ(this.gl),this.textureConfig=d$(this.gl,this.textureHalfFloatExtension)}get debug(){return K().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;ue(e,()=>e.finish()),ue(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),ue(e,()=>e.deleteFramebuffer(this.framebuffer)),ue(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),ue(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),ue(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,n){return this.throwIfDisposed(),NJ(this.gl,e,n,this.textureConfig)}createFloat16MatrixTexture(e,n){return this.throwIfDisposed(),RJ(this.gl,e,n,this.textureConfig)}createUnsignedBytesMatrixTexture(e,n){return this.throwIfDisposed(),AJ(this.gl,e,n,this.textureConfig)}uploadPixelDataToTexture(e,n){this.throwIfDisposed(),LJ(this.gl,e,n)}uploadDenseMatrixToTexture(e,n,s,r){this.throwIfDisposed(),OJ(this.gl,e,n,s,r,this.textureConfig)}createFloat16PackedMatrixTexture(e,n){return this.throwIfDisposed(),FJ(this.gl,e,n,this.textureConfig)}createPackedMatrixTexture(e,n){return this.throwIfDisposed(),DJ(this.gl,e,n,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(AS(this.gl,this.framebuffer),this.outputTexture=null),ue(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,n,s){return this.downloadMatrixDriver(e,()=>zJ(this.gl,n,s,this.textureConfig))}downloadPackedMatrixFromBuffer(e,n,s,r,o,i){return VJ(this.gl,e,n,s,r,o,i,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,n){return _J(this.gl,e,n)}createBufferFromTexture(e,n,s){this.bindTextureToFrameBuffer(e);const r=MJ(this.gl,n,s,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let n,s;if(K().getBool("WEBGL_FENCE_API_ENABLED")){const r=e,o=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),s=()=>{const i=r.clientWaitSync(o,0,0);return i===r.ALREADY_SIGNALED||i===r.CONDITION_SATISFIED},n=o}else K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),s=()=>this.isQueryAvailable(n,K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):s=()=>!0;return{query:n,isFencePassed:s}}downloadMatrixFromPackedTexture(e,n,s){return this.downloadMatrixDriver(e,()=>BJ(this.gl,n,s))}createProgram(e){this.throwIfDisposed();const n=this.gl;this.vertexShader==null&&(this.vertexShader=IJ(n));const s=fZ(n);ue(n,()=>n.attachShader(s,this.vertexShader)),ue(n,()=>n.attachShader(s,e)),hZ(n,s);const r=Object.assign(s,{vao:this.createVertexArray()});return this.debug&&tx(n,r),r}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);const n=this.gl;ue(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),PJ(n,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&(ue(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&tx(this.gl,this.program),ue(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,n,s=!0){return this.throwIfDisposed(),s?bZ(this.gl,e,n):wZ(this.gl,e,n)}getAttributeLocation(e,n){return this.throwIfDisposed(),ue(this.gl,()=>this.gl.getAttribLocation(e,n))}getUniformLocationNoThrow(e,n){return this.throwIfDisposed(),this.gl.getUniformLocation(e,n)}setInputMatrixTexture(e,n,s){this.throwIfDisposed(),this.throwIfNoProgram(),$Z(this.gl,e,n,s)}setOutputMatrixTexture(e,n,s){this.setOutputMatrixTextureDriver(e,s,n)}setOutputPackedMatrixTexture(e,n,s){this.throwIfDisposed();const[r,o]=su(n,s);this.setOutputMatrixTextureDriver(e,r,o)}setOutputMatrixWriteRegion(e,n,s,r){this.setOutputMatrixWriteRegionDriver(s,e,r,n)}setOutputPackedMatrixWriteRegion(e,n,s,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&tx(this.gl,this.program),eh(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const n=this.getVertexArray();console.assert(n===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}ue(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),ue(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Jf(this.gl,K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const s=this.gl,r=this.getQueryTimerExtensionWebGL2(),o=s.createQuery();return s.beginQuery(r.TIME_ELAPSED_EXT,o),o}const e=this.getQueryTimerExtensionWebGL1(),n=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,n),n}endQuery(){if(K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const n=this.gl,s=this.getQueryTimerExtensionWebGL2();n.endQuery(s.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await bk(()=>this.disposed||this.isQueryAvailable(e,K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,n){if(n===0)return null;if(n===2){const s=this.gl;return s.getQueryParameter(e,s.QUERY_RESULT)/1e6}else{const s=this.getQueryTimerExtensionWebGL1();return s.getQueryObjectEXT(e,s.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,n){if(n===0)return!0;if(n===2){const s=this.gl,r=this.getQueryTimerExtensionWebGL2(),o=s.getQueryParameter(e,s.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),o&&!this.disjoint}else{const s=this.getQueryTimerExtensionWebGL1(),r=s.getQueryObjectEXT(e,s.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(s.GPU_DISJOINT_EXT)),r&&!this.disjoint}}pollFence(e){return new Promise(n=>{this.addItemToPoll(()=>e.isFencePassed(),()=>n())})}pollItems(){const e=WJ(this.itemsToPoll.map(n=>n.isDoneFn));for(let n=0;n<=e;++n){const{resolveFn:s}=this.itemsToPoll[n];s()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,n){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:n}),this.itemsToPoll.length>1)return;let s;"setTimeoutCustom"in K().platform&&(s=K().platform.setTimeoutCustom.bind(K().platform)),bk(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,s)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),nx(this.gl,e,this.framebuffer),this.debug&&eh(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(nx(this.gl,this.outputTexture,this.framebuffer),this.debug&&eh(this.gl)):AS(this.gl,this.framebuffer)}downloadMatrixDriver(e,n){this.bindTextureToFrameBuffer(e);const s=n();return this.unbindTextureToFrameBuffer(),s}setOutputMatrixTextureDriver(e,n,s){this.throwIfDisposed();const r=this.gl;nx(r,e,this.framebuffer),this.debug&&eh(r),this.outputTexture=e,ue(r,()=>r.viewport(0,0,n,s)),ue(r,()=>r.scissor(0,0,n,s))}setOutputMatrixWriteRegionDriver(e,n,s,r){this.throwIfDisposed(),ue(this.gl,()=>this.gl.scissor(e,n,s,r))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function WJ(t){let e=0;for(;e<t.length&&t[e]();++e);return e-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:UJ,bincountImpl:tO,bincountReduceImpl:GJ,bitwiseAndImpl:HJ,castImpl:jJ,ceilImpl:KJ,concatImpl:XJ,equalImpl:qJ,expImpl:YJ,expm1Impl:QJ,floorImpl:ZJ,gatherNdImpl:JJ,gatherV2Impl:eee,greaterImpl:tee,greaterEqualImpl:nee,lessImpl:see,lessEqualImpl:ree,linSpaceImpl:oee,logImpl:iee,maxImpl:aee,maximumImpl:lee,minimumImpl:uee,multiplyImpl:cee,negImpl:dee,notEqualImpl:fee,prodImpl:hee,raggedGatherImpl:pee,raggedRangeImpl:mee,raggedTensorToTensorImpl:gee,rangeImpl:xee,rsqrtImpl:yee,scatterImpl:vee,sigmoidImpl:bee,simpleAbsImpl:nO,sliceImpl:wee,sparseFillEmptyRowsImpl:$ee,sparseReshapeImpl:Cee,sparseSegmentReductionImpl:sO,sqrtImpl:kee,staticRegexReplaceImpl:See,stridedSliceImpl:Iee,stringNGramsImpl:Tee,stringSplitImpl:Eee,stringToHashBucketFastImpl:Nee,subImpl:Ree,tileImpl:Aee,topKImpl:Dee,transposeImpl:m$,uniqueImpl:Fee}=LK;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rO(t,e){return["x","y","z","w","u","v"].slice(0,e).map(n=>`${t}.${n}`)}function In(t,e){return e===1?[t]:rO(t,e)}function Pee(t,e){if(t===1)return"rc";let n="";for(let s=0;s<t;s++)n+=e[s],s<t-1&&(n+=",");return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Oee{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=yn(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const n=In("rc",this.rank),s=Je(this.rank),r=this.getOutOfBoundsCondition(n),o=this.getSetup(n),i=this.getOutput(n);this.userCode=`
        void main() {
          ${s} rc = getOutputCoords();

          if(${r}) {
            setOutput(vec4(0));
          } else {
            ${o}

            setOutput(vec4(${i}));
          }
        }
      `}}getSourceCoordsArr(e){const n=[];for(let s=0;s<=1;s++)for(let r=0;r<=1;r++){let o=`${s===0?"r":"rp1"}, ${r===0?"c":"cp1"}`;for(let i=2;i<this.rank;i++)o=`${e[e.length-1-i]},`+o;n.push(o)}return n}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let n="";for(let s=this.rank-2;s<this.rank;s++)n+=`${e[s]} >= ${this.enableShapeUniforms?`outShape[${s}]`:this.outputShape[s]}`,s<this.rank-1&&(n+="||");return n}getSetup(e){if(this.rank===1)return"";const n=e.slice(-2),s=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],r=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${n[0]};
      int c = ${n[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${s};
      bool rEdge = rp1 >= ${r};
    `}getOutput(e){const n=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${n[0]}),
            cEdge ? 0. : getA(${n[1]}),
            rEdge ? 0. : getA(${n[2]}),
            rEdge || cEdge ? 0. : getA(${n[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oO{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=yn(this.outputShape.length);let s="";for(let r=0;r<4;r++){let o="thisRC = rc;";r%2===1&&(o+="thisRC.z += 1;"),r>1&&(o+="thisRC.y += 1;"),s+=`
        ${o}
        ${r>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${r}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${r>0?"}":""}
      `}this.userCode=`
      ${Lee(n,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?h$():f$(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${s}

        setOutput(result);
      }
    `}}function Lee(t,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?PZ(["r","c","d"],"inputShape"):Ra(["r","c","d"],t)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Mee{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,n,s){const r=LS(n,s),o=MS(e,r,s);o in this.freeTextures||(this.freeTextures[o]=[]),o in this.usedTextures||(this.usedTextures[o]=[]);const i=OS(e,r,this.gpgpu.gl,this.gpgpu.textureConfig,s);if(this.freeTextures[o].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=i,this.log();const l=this.freeTextures[o].pop();return this.usedTextures[o].push(l),l}let a;return r===tn.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):r===tn.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):r===tn.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):r===tn.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):r===tn.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[o].push(a),this.numUsedTextures++,this._numBytesAllocated+=i,this.log(),a}releaseTexture(e,n,s,r){if(this.freeTextures==null)return;const o=LS(s,r),i=MS(n,o,r);i in this.freeTextures||(this.freeTextures[i]=[]);const a=OS(n,o,this.gpgpu.gl,this.gpgpu.textureConfig,r),l=K().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=a):(this.freeTextures[i].push(e),this.numFreeTextures++,this._numBytesFree+=a),this.numUsedTextures--;const u=this.usedTextures[i],c=u&&u.indexOf(e);if(c==null||c<0)throw new Error("Cannot release a texture that was never provided by this texture manager");u[c]=u[u.length-1],u.pop(),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const n=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*n)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function _ee(t,e){const n=t;if(e===n.R32F)return 4;if(e===n.R16F)return 2;if(e===n.RGBA32F)return 16;if(e===t.RGBA)return 16;if(e===n.RGBA16F)return 8;if(e===n.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function OS(t,e,n,s,r){const o=zee(e,s);let i;if(r){const[l,u]=su(t[0],t[1]);i=l*u}else{const[l,u]=pf(t[0],t[1]);i=l*u}const a=_ee(n,o);return i*a}function zee(t,e){switch(t){case tn.PACKED_2X2_FLOAT32:return JP(e);case tn.PACKED_2X2_FLOAT16:return eO(e);case tn.UNPACKED_FLOAT32:return YP(e);case tn.UNPACKED_FLOAT16:return QP(e);case tn.PACKED_4X1_UNSIGNED_BYTE:return ZP(e);default:throw new Error(`Unknown physical texture type ${t}`)}}function Vee(t){return K().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?tn.PACKED_2X2_FLOAT32:tn.UNPACKED_FLOAT32:t?tn.PACKED_2X2_FLOAT16:tn.UNPACKED_FLOAT16}function LS(t,e){if(t===fs.UPLOAD)return tn.PACKED_2X2_FLOAT32;if(t===fs.RENDER||t==null)return Vee(e);if(t===fs.DOWNLOAD||t===fs.PIXELS)return tn.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${t}`)}function MS(t,e,n){return`${t[0]}_${t[1]}_${e}_${n}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ir{constructor(e,n){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=yn(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${n}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const js="if (isnan(x)) return x;",Bee="return x;",_S="return abs(x);",Wee="return (x >= 0.0) ? x : (exp(x) - 1.0);",Uee=js+`
  return (x < 0.0) ? 0.0 : x;
`,Gee=js+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Ro="return x;",Hee="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jee="return x;",Kee=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,Xee=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,qee=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Yee="return 1.0 / (1.0 + exp(-1.0 * x));";class Mo{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=yn(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${n}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qee{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=yn(this.outputShape.length);const n=e.length,s=In("rc",n),r=Je(n),o=Pee(n,s),i=s.slice(-2),a=n<=1?"rc":`vec2(${i.join(",")})`;this.userCode=`
      void main() {
        ${r} rc = getOutputCoords();
        vec4 packedInput = getA(${o});

        setOutput(getChannel(packedInput, ${a}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zee=NR,Jee=1e-7,ete=1e-4,sh={};function tte(t){return t in sh||(sh[t]={}),sh[t]}const nte=K().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),ste=600;function rte(){return K().global.screen==null?1024:K().global.screen.height*K().global.screen.width*window.devicePixelRatio*ste/1024/1024}class Qg extends Ab{nextDataId(){return Qg.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!K().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let n;if(e!=null){if(e instanceof ox)n=e;else{const s=fr(K().getNumber("WEBGL_VERSION"),e);n=new ox(s)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const s=fr(K().getNumber("WEBGL_VERSION"));n=new ox(s),this.binaryCache=tte(K().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=n,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new Mee(this.gpgpu),this.numMBBeforeWarning=rte(),this.texData=new qE(this,vr())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,n,s,r,o,i){const a=this.makeTensorInfo(n,s),l=this.texData.get(a.dataId);l.isPacked=!1,l.texture={texture:e,texShape:[r,o]},l.texShape=[r,o];const u=th(n),c=new PS(u,!1,i),d=this.runWebGLProgram(c,[a],s,[[r,o]]);return d.shape=n,l.texture=null,this.disposeIntermediateTensorInfo(a),d.dataId}write(e,n,s){if((K().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||K().getBool("DEBUG"))&&this.checkNumericalProblems(e),s==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const r={id:this.nextDataId()};return this.texData.set(r,{shape:n,dtype:s,values:e,usage:fs.UPLOAD,refCount:1}),r}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const n=this.texData.get(e);n.refCount++}decRef(e){if(this.texData.has(e)){const n=this.texData.get(e);n.refCount--}}move(e,n,s,r,o){if(K().getBool("DEBUG")&&this.checkNumericalProblems(n),r==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:s,dtype:r,values:n,usage:fs.UPLOAD,refCount:o})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const n=this.texData.get(e),{values:s,dtype:r,complexTensorInfos:o,slice:i,shape:a,isPacked:l}=n;if(i!=null){let f;l?f=new Mo(a,Ro):f=new Ir(a,Ro);const h=this.runWebGLProgram(f,[{dataId:e,shape:a,dtype:r}],r),p=this.readSync(h.dataId);return this.disposeIntermediateTensorInfo(h),p}if(s!=null)return this.convertAndCacheOnCPU(e);if(r==="string")return s;const u=this.activeTimers!=null;let c;u&&(c=Ln());let d;if(r==="complex64"){const f=this.readSync(o.real.dataId),h=this.readSync(o.imag.dataId);d=fo(f,h)}else d=this.getValuesFromTexture(e);return u&&(this.downloadWaitMs+=Ln()-c),this.convertAndCacheOnCPU(e,d)}async read(e){if(this.pendingRead.has(e)){const p=this.pendingRead.get(e);return new Promise(g=>p.push(g))}const n=this.texData.get(e),{values:s,shape:r,slice:o,dtype:i,complexTensorInfos:a,isPacked:l}=n;if(o!=null){let p;l?p=new Mo(r,Ro):p=new Ir(r,Ro);const g=this.runWebGLProgram(p,[{dataId:e,shape:r,dtype:i}],i),y=this.read(g.dataId);return this.disposeIntermediateTensorInfo(g),y}if(s!=null)return this.convertAndCacheOnCPU(e);if(K().getBool("DEBUG")&&!K().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&K().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let u=null,c;if(i!=="complex64"&&K().get("WEBGL_BUFFER_SUPPORTED")){c=this.decode(e);const p=this.texData.get(c.dataId);u=this.gpgpu.createBufferFromTexture(p.texture.texture,...Zf(r))}this.pendingRead.set(e,[]),i!=="complex64"&&await this.gpgpu.createAndWaitForFence();let d;if(i==="complex64"){const p=await Promise.all([this.read(a.real.dataId),this.read(a.imag.dataId)]),g=p[0],y=p[1];d=fo(g,y)}else if(u==null)d=this.getValuesFromTexture(e);else{const p=Y(r);d=this.gpgpu.downloadFloat32MatrixFromBuffer(u,p)}if(c!=null&&this.disposeIntermediateTensorInfo(c),u!=null){const p=this.gpgpu.gl;ue(p,()=>p.deleteBuffer(u))}const f=this.convertAndCacheOnCPU(e,d),h=this.pendingRead.get(e);return this.pendingRead.delete(e),h.forEach(p=>p(f)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&vr().removeDataId(e,this),this.pendingDeletes--),f}readToGPU(e,n={}){const s=this.texData.get(e),{values:r,shape:o,slice:i,dtype:a,isPacked:l,texture:u}=s;if(a==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(i!=null){let h;l?h=new Mo(o,Ro):h=new Ir(o,Ro);const p=this.runWebGLProgram(h,[{dataId:e,shape:o,dtype:a}],a),g=this.readToGPU(p,n);return this.disposeIntermediateTensorInfo(p),g}if(u==null)throw r!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const c=this.decode(e,n.customTexShape),d=vr().makeTensorFromTensorInfo(c),f=this.texData.get(c.dataId);return Object.assign({tensorRef:d},f.texture)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const s=n.map(r=>ti(r));return Ee(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Ee(e.shape,e.dtype,n)}checkNumericalProblems(e){if(e!=null)for(let n=0;n<e.length;n++){const s=e[n];if(!aZ(s))throw K().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${s} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${s} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:n,dtype:s,isPacked:r}=this.texData.get(e),o=Y(n);if(K().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const f=this.decode(e),h=this.texData.get(f.dataId),p=this.gpgpu.downloadMatrixFromPackedTexture(h.texture.texture,...Zf(n)).subarray(0,o);return this.disposeIntermediateTensorInfo(f),p}const i=K().getBool("WEBGL_PACK")&&r===!0,a=i?th(n):n,l=i?new CJ(a):new $J(a),u=this.runWebGLProgram(l,[{shape:a,dtype:s,dataId:e}],"float32"),c=this.texData.get(u.dataId),d=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(c.texture.texture,c.texShape[0],c.texShape[1]).subarray(0,o);return this.disposeIntermediateTensorInfo(u),d}timerAvailable(){return K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const n=this.activeTimers,s=[];let r=!1;this.programTimersStack==null?(this.programTimersStack=s,r=!0):this.activeTimers.push(s),this.activeTimers=s,e();const o=ea(this.activeTimers.map(l=>l.query)).filter(l=>l!=null),i=ea(this.activeTimers.map(l=>l.name)).filter(l=>l!=null);this.activeTimers=n,r&&(this.programTimersStack=null);const a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const l=await Promise.all(o);a.kernelMs=Gz(l),a.getExtraProfileInfo=()=>l.map((u,c)=>({name:i[c],ms:u})).map(u=>`${u.name}: ${u.ms}`).join(", ")}else a.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,a})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Ln(),endMs:null}}endTimer(e){return K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=Ln(),e)}async getQueryTime(e){if(K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const n=e;return n.endMs-n.startMs}disposeData(e,n=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(n?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!n&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:s}=this.texData.get(e);return s!=null&&(this.disposeData(s.real.dataId,n),this.disposeData(s.imag.dataId,n)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:n,dtype:s,texShape:r,usage:o,isPacked:i,slice:a}=this.texData.get(e),l=a&&a.origDataId||e,u=this.dataRefCount.get(l);u>1?this.dataRefCount.set(l,u-1):(this.dataRefCount.delete(l),n!=null&&(this.numBytesInGPU-=this.computeBytes(r,s),this.textureManager.releaseTexture(n,r,o,i)));const c=this.texData.get(e);c.texture=null,c.texShape=null,c.isPacked=!1,c.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,n=nte){return K().getBool("WEBGL_CPU_FORWARD")&&e.every(s=>this.texData.get(s.dataId).texture==null&&Y(s.shape)<n)}getGPGPUContext(){return this.gpgpu}where(e){cs("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const n=e.dataSync();return Zee(e.shape,n)}packedUnaryOp(e,n,s){const r=new Mo(e.shape,n),o=this.compileAndRun(r,[e],s);return vr().makeTensorFromTensorInfo(o)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const r=nO(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,r)}if(K().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,_S,e.dtype);const n=new Ir(e.shape,_S),s=this.compileAndRun(n,[e]);return vr().makeTensorFromTensorInfo(s)}makeTensorInfo(e,n,s){let r;if(n==="string"&&s!=null&&s.length>0&&ed(s[0])){const o=s.map(i=>Xo(i));r=this.write(o,e,n)}else r=this.write(s,e,n);return this.texData.get(r).usage=null,{dataId:r,shape:e,dtype:n}}makeOutput(e,n,s){return vr().makeTensorFromTensorInfo(this.makeTensorInfo(e,n,s),this)}unpackTensor(e){const n=new Qee(e.shape);return this.runWebGLProgram(n,[e],e.dtype)}packTensor(e){const n=new Oee(e.shape);return this.runWebGLProgram(n,[e],e.dtype,null,!0)}packedReshape(e,n){const s=[Bl(e.shape),...Wl(e.shape)],r={dtype:e.dtype,shape:s,dataId:e.dataId},o=[Bl(n),...Wl(n)],i=new oO(o,s),a=!0,l=[s],u=this.runWebGLProgram(i,[r],e.dtype,l,a);return{dataId:u.dataId,shape:n,dtype:u.dtype}}decode(e,n){const s=this.texData.get(e),{isPacked:r,shape:o,dtype:i}=s;if(n!=null){const f=Y(o),h=n[0]*n[1]*4;N(f<=h,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const a=th(o);let l;r?l=new wJ(a):l=new bJ(a);const u=!0,c=[n??Zf(a)],d=this.runWebGLProgram(l,[{shape:a,dtype:i,dataId:e}],i,c,u,n);return{dtype:i,shape:o,dataId:d.dataId}}runWebGLProgram(e,n,s,r,o=!1,i){const a=this.makeTensorInfo(e.outputShape,s),l=this.texData.get(a.dataId);if(e.packedOutput&&(l.isPacked=!0),e.outPackingScheme===Bc.DENSE){const m=i??Zf(e.outputShape);l.texShape=m.map(x=>x*2)}if(e.outTexUsage!=null&&(l.usage=e.outTexUsage),Y(a.shape)===0)return l.values=hn(a.dtype,0),a;const u=[],c=n.map(m=>{if(m.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let x=this.texData.get(m.dataId);if(x.texture==null){if(!e.packedInputs&&Y(m.shape)<=K().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:m.shape,texData:null,isUniform:!0,uniformValues:x.values};e.packedInputs&&(x.isPacked=!0,x.shape=m.shape)}if(this.uploadToGPU(m.dataId),!!x.isPacked!=!!e.packedInputs)m=x.isPacked?this.unpackTensor(m):this.packTensor(m),u.push(m),x=this.texData.get(m.dataId);else if(x.isPacked&&!Op(x.shape,m.shape)){const v=m,b=m.shape;m.shape=x.shape,m=this.packedReshape(m,b),u.push(m),x=this.texData.get(m.dataId),v.shape=b}return{shape:m.shape,texData:x,isUniform:!1}});this.uploadToGPU(a.dataId);const d={shape:a.shape,texData:l,isUniform:!1},f=vJ(e,c,d),h=this.getAndSaveBinary(f,()=>xJ(this.gpgpu,e,c,d)),p=this.activeTimers!=null;let g;p&&(g=this.startTimer()),K().get("ENGINE_COMPILE_ONLY")||yJ(this.gpgpu,h,c,d,r),u.forEach(m=>this.disposeIntermediateTensorInfo(m)),p&&(g=this.endTimer(g),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(g)}));const y=K().getNumber("WEBGL_FLUSH_THRESHOLD");if(y>0){const m=Ln();m-this.lastGlFlushTime>y&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=m)}if(!K().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&o===!1){const m=this.unpackTensor(a);return this.disposeIntermediateTensorInfo(a),m}return a}compileAndRun(e,n,s,r,o=!1){return s=s||n[0].dtype,this.runWebGLProgram(e,n,s,r,o)}getAndSaveBinary(e,n){return e in this.binaryCache||(this.binaryCache[e]=n()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(K().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(n=>{this.gpgpu.deleteProgram(this.binaryCache[n].webGLProgram),delete this.binaryCache[n]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=H(()=>{if(!K().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=K().getBool("DEBUG");K().set("DEBUG",!1);const n=this.abs(Ge(1e-8)).dataSync()[0];if(K().set("DEBUG",e),n>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?Jee:ete}uploadToGPU(e){const n=this.texData.get(e),{shape:s,dtype:r,values:o,texture:i,usage:a,isPacked:l}=n;if(i!=null)return;const u=this.activeTimers!=null;let c;u&&(c=Ln());let d=n.texShape;if(d==null&&(d=SZ(s,l),n.texShape=d),o!=null){const f=th(s);let h,p=d[1],g=d[0];const y=o instanceof Uint8Array||o instanceof Uint8ClampedArray;(l||!y)&&([p,g]=su(d[0],d[1])),l?h=new SJ(f,y):h=new PS(f,y);const m=y?[g,p]:d,x=this.makeTensorInfo(m,r),v=this.texData.get(x.dataId);y?v.usage=fs.PIXELS:v.usage=fs.UPLOAD,v.texShape=m,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(x.dataId),p,g,o);const b=[[g,p]],C=this.runWebGLProgram(h,[x],r,b,!0),k=this.texData.get(C.dataId);n.texShape=k.texShape,n.isPacked=k.isPacked,n.usage=k.usage,K().get("ENGINE_COMPILE_ONLY")?this.disposeData(C.dataId):(n.texture=k.texture,n.values=null,this.texData.delete(C.dataId)),this.disposeIntermediateTensorInfo(x),u&&(this.uploadWaitMs+=Ln()-c)}else{const f=this.acquireTexture(d,a,r,l);n.texture=f}}convertAndCacheOnCPU(e,n){const s=this.texData.get(e),{dtype:r}=s;return n!=null&&(s.values=ote(n,r)),s.values}acquireTexture(e,n,s,r){if(this.numBytesInGPU+=this.computeBytes(e,s),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const o=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${o} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,n,r)}computeBytes(e,n){return e[0]*e[1]*cp(n)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,n]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(n));return Promise.all(e)}else{for(const[,n]of Object.entries(this.binaryCache)){const s=new Promise(r=>{try{this.checkCompletion_(n),r(!0)}catch(o){throw o}});e.push(s)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await jR(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(GP(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:n,customUniformLocations:s,infLoc:r,nanLoc:o,outShapeLocation:i,outShapeStridesLocation:a,outTexShapeLocation:l}=qP(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=n,e.customUniformLocations=s,e.infLoc=r,e.nanLoc=o,e.outShapeLocation=i,e.outShapeStridesLocation=a,e.outTexShapeLocation=l}}createTensorFromGPUData(e,n,s){e.channels=e.channels||"RGBA";const{texture:r,height:o,width:i,channels:a}=e,l=vr().backend;if(!l.gpgpu.gl.isTexture(r))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const u=l.writeTexture(r,n,s,o,i,a);return vr().makeTensorFromDataId(u,n,s,l)}}Qg.nextDataId=0;function ote(t,e){if(e==="float32"||e==="complex64")return t;if(e==="int32"||e==="bool"){const n=e==="int32"?new Int32Array(t.length):new Uint8Array(t.length);for(let s=0;s<n.length;++s)n[s]=Math.round(t[s]);return n}else throw new Error(`Unknown dtype ${e}`)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */WN()&&HN("webgl",()=>new Qg,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g$=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class fa{constructor(e,n,s){this.variableNames=["A","B"],this.outputShape=Se(n,s),this.enableShapeUniforms=yn(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Da=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class lu{constructor(e,n,s,r=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Se(n,s);const o=this.outputShape.length;this.enableShapeUniforms=yn(o);let i="";if(r)if(o===0||Y(this.outputShape)===1)i=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(i=`
          ${Je(o)} coords = getOutputCoords();
        `,o===1)this.enableShapeUniforms?i+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:i+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const l=In("coords",o);this.enableShapeUniforms?i+=`
            bool nextRowOutOfBounds =
              (${l[o-2]} + 1) >= outShape[${o} - 2];
            bool nextColOutOfBounds =
              (${l[o-1]} + 1) >= outShape[${o} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:i+=`
            bool nextRowOutOfBounds =
              (${l[o-2]} + 1) >= ${this.outputShape[o-2]};
            bool nextColOutOfBounds =
              (${l[o-1]} + 1) >= ${this.outputShape[o-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${i}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function os(t){const{inputs:e,backend:n}=t,{x:s}=e;return n.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const ite={kernelName:wd,backendName:"webgl",kernelFunc:os};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yi(t){const{inputs:e,backend:n}=t,{real:s,imag:r}=e,o=n.makeTensorInfo(s.shape,"complex64"),i=n.texData.get(o.dataId),a=os({inputs:{x:s},backend:n}),l=os({inputs:{x:r},backend:n});return i.complexTensorInfos={real:a,imag:l},o}const ate={kernelName:Gb,backendName:"webgl",kernelFunc:yi};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iO="return (a < 0.) ? b * a : a;",aO=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function lte(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{alpha:o}=s,i=n.makeTensorInfo([],"float32",di(o,"float32")),a=K().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new lu(aO,r.shape,i.shape):new fa(iO,r.shape,i.shape),l=n.runWebGLProgram(a,[r,i],"float32");return n.disposeIntermediateTensorInfo(i),l}const ute={kernelName:Hm,backendName:"webgl",kernelFunc:lte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lO="return (a < 0.) ? b * a : a;",uO=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function cte(t){const{inputs:e,backend:n}=t,{x:s,alpha:r}=e,o=K().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new lu(uO,s.shape,r.shape):new fa(lO,s.shape,r.shape);return n.runWebGLProgram(o,[s,r],"float32")}const dte={kernelName:cg,backendName:"webgl",kernelFunc:cte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uu="if (isnan(x)) return x;";function Me({opSnippet:t,packedOpSnippet:e,cpuKernelImpl:n,dtype:s}){return({inputs:r,backend:o})=>{const{x:i}=r,a=o,l=s||i.dtype;if(a.shouldExecuteOnCPU([i])&&n!=null){const d=a.texData.get(i.dataId),f=n(d.values,l);return a.makeTensorInfo(i.shape,l,f)}const u=K().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let c;return u?c=new Mo(i.shape,e):c=new Ir(i.shape,t),a.runWebGLProgram(c,[i],l)}}function an({opSnippet:t,packedOpSnippet:e,checkOutOfBounds:n=!1,supportsComplex:s=!1,cpuKernelImpl:r,dtype:o}){return({inputs:i,backend:a})=>{const{a:l,b:u}=i,c=a;if(s&&l.dtype==="complex64"){const p=c.texData.get(l.dataId),g=c.texData.get(u.dataId),[y,m]=[[p.complexTensorInfos.real,g.complexTensorInfos.real],[p.complexTensorInfos.imag,g.complexTensorInfos.imag]].map(v=>{const[b,$]=v,C={dataId:b.dataId,dtype:b.dtype,shape:l.shape},k={dataId:$.dataId,dtype:$.dtype,shape:u.shape},w=new fa(t,l.shape,u.shape);return c.runWebGLProgram(w,[C,k],ss(b.dtype,$.dtype))}),x=yi({inputs:{real:y,imag:m},backend:c});return c.disposeIntermediateTensorInfo(y),c.disposeIntermediateTensorInfo(m),x}const d=o||ss(l.dtype,u.dtype);if((l.dtype==="string"||u.dtype==="string"||c.shouldExecuteOnCPU([l,u]))&&r!=null){const p=c.texData.get(l.dataId).values,g=c.texData.get(u.dataId).values,y=l.dtype==="string"?ho(p):p,m=l.dtype==="string"?ho(g):g,[x,v]=r(l.shape,u.shape,y,m,d),b=c.makeTensorInfo(v,d),$=c.texData.get(b.dataId);return $.values=x,b}const f=K().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let h;return f?h=new lu(e,l.shape,u.shape,n):h=new fa(t,l.shape,u.shape),c.runWebGLProgram(h,[l,u],d)}}function Wc(t,e=!1){if(t==="linear")return e?jee:Bee;if(t==="relu")return e?Xee:Uee;if(t==="elu")return e?Kee:Wee;if(t==="relu6")return e?qee:Gee;if(t==="prelu")return e?uO:lO;if(t==="leakyrelu")return e?aO:iO;if(t==="sigmoid")return e?Yee:Hee;throw new Error(`Activation ${t} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cO{constructor(e,n,s,r=!1,o=!1,i=!1,a=null,l=!1,u=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=s,this.enableShapeUniforms=yn(this.outputShape.length);const c=r?e[1]:e[2],d=Math.ceil(c/2),f=r?"i * 2, rc.y":"rc.y, i * 2",h=o?"rc.z, i * 2":"i * 2, rc.z",p=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],g=o?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let y="",m="";a&&(l?y=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${a}
        }`:u?y=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${a}
        }`:y=`vec4 activation(vec4 x) {
          ${a}
        }`,m="result = activation(result);");const x=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),u&&this.variableNames.push("leakyreluAlpha");let v="rc.x",b="rc.x";e[0]<n[0]?v=`imod(rc.x, ${e[0]})`:n[0]<e[0]&&(b=`imod(rc.x, ${n[0]})`),this.userCode=`
      ${y}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${d}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${v};
        int batchB = ${b};
        for (int i = 0; i < ${d}; i++) {
          vec4 a = getMatrixA(batchA, ${f});
          vec4 b = getMatrixB(batchB, ${h});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${p[0]} * ${g[0]});
          result += (${p[1]} * ${g[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${x}

        ${m}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zS={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class VS{constructor(e,n,s){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Se(n,s),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BS="return a * b;";function x$(t){const{inputs:e,backend:n}=t,{a:s,b:r}=e,o=ss(s.dtype,r.dtype);if(s.dtype==="complex64"){const a=n.texData.get(s.dataId),l=n.texData.get(r.dataId),u=new VS(zS.REAL,s.shape,r.shape),c=new VS(zS.IMAG,s.shape,r.shape),d=[{dataId:a.complexTensorInfos.real.dataId,dtype:a.complexTensorInfos.real.dtype,shape:s.shape},{dataId:a.complexTensorInfos.imag.dataId,dtype:a.complexTensorInfos.imag.dtype,shape:s.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:r.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:r.shape}],f=n.runWebGLProgram(u,d,"float32"),h=n.runWebGLProgram(c,d,"float32"),p=yi({inputs:{real:f,imag:h},backend:n});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(h),p}if(n.shouldExecuteOnCPU([s,r])){const a=n.texData.get(s.dataId),l=n.texData.get(r.dataId),[u,c]=cee(s.shape,r.shape,a.values,l.values,o),d=n.makeTensorInfo(c,o),f=n.texData.get(d.dataId);return f.values=u,d}let i;return K().getBool("WEBGL_PACK_BINARY_OPERATIONS")?i=new lu(BS,s.shape,r.shape):i=new fa(BS,s.shape,r.shape),n.runWebGLProgram(i,[s,r],o)}const fte={kernelName:Rd,backendName:"webgl",kernelFunc:x$};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hte(t,e,n){const s=[Bl(t.shape),...Wl(t.shape)],r={dtype:t.dtype,shape:s,dataId:t.dataId},o=[Bl(e),...Wl(e)],i=new oO(o,s),a=!0,l=[s],u=n.runWebGLProgram(i,[r],t.dtype,l,a);return{dataId:u.dataId,shape:e,dtype:u.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{shape:o}=s,i=n,a=Y(r.shape),l=QE(o,a),u=Y(l);N(a===u,()=>`The new shape (${l}) has ${u} elements and the old shape (${r.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`);const c=i.texData.get(r.dataId);return c.isPacked&&!Op(r.shape,l)&&!(c.texture!==null&&Op(c.shape,l))?hte(r,l,i):(i.incRef(r.dataId),{dataId:r.dataId,shape:l,dtype:r.dtype})}const pte={kernelName:fg,backendName:"webgl",kernelFunc:oe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class WS{constructor(e,n){this.variableNames=["x"];const{windowSize:s,batchSize:r,inSize:o,outSize:i}=e;this.outputShape=[r,i];const a=Math.floor(s/4)*4,l=s%4;let u="sumValue += dot(values, ones);";if(n!=null){const d=1/n;u=`sumValue += dot(values * ${Al(d)?d.toPrecision(2):d}, ones);`}let c="";o%s>0&&(c=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${c}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        float sumValue = 0.0;

        for (int i = 0; i < ${a}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${u}
        }

        int inIdx = inOffset + ${a};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${u}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${u}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${u}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mte{constructor(e,n){this.variableNames=["x"];const{windowSize:s,batchSize:r,inSize:o,outSize:i}=e;this.outputShape=[r,i];let a="0.0",l="";n==="prod"?a="1.0":n==="min"?(a="1.0 / 1e-20",l="min"):n==="max"&&(a="-1.0 / 1e-20",l="max");let u=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="sum"?u="sumValue":n==="prod"?u="prodValue":n==="all"?u="allValue":n==="any"&&(u="anyValue");const c=Math.floor(s/4)*4,d=s%4;let f=`
      if (${n==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${n==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
        if (${n==="min"} || ${n==="max"}) {
          minMaxValue = ${l}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,h="vec4";n==="all"?(a="1.0",f=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,h="bvec4"):n==="any"&&(a="0.0",f=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,h="bvec4");let p="";o%s>0&&(p=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${a};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${p}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        vec4 minMaxValue = vec4(${a});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          ${h} values = ${h}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${f}
        }

        int inIdx = inOffset + ${c};
        if (${d===1}) {
          ${h} values = ${h}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${f}
        } else if (${d===2}) {
          ${h} values = ${h}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${f}
        } else if (${d===3}) {
          ${h} values = ${h}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${f}
        }
        setOutput(${u});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gte(t){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const n=e.length?e[e.length-1].outSize:t[1],s=Og(n);e.push({inSize:n,windowSize:s,outSize:Math.ceil(n/s)})}return e}function Fa(t,e,n,s){const r=gte(t.shape);let o=t;for(let i=0;i<r.length;i++){const{inSize:a,windowSize:l,outSize:u}=r[i];let c,d;n==="mean"?c=i===0?new WS({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:u},a):new WS({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:u}):c=new mte({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:u},n),d=o,o=s.runWebGLProgram(c,[o],e),d.dataId!==t.dataId&&s.disposeIntermediateTensorInfo(d)}return o}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xte{constructor(e,n){this.variableNames=["A"];const s=new Array(e.length);for(let i=0;i<s.length;i++)s[i]=e[n[i]];this.outputShape=s,this.rank=s.length;const r=Je(this.rank),o=yte(n);this.userCode=`
    void main() {
      ${r} resRC = getOutputCoords();
      setOutput(getA(${o}));
    }
    `}}function yte(t){const e=t.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],s=new Array(e);for(let r=0;r<t.length;r++)s[t[r]]=n[r];return s.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vte{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const s=new Array(e.length);for(let c=0;c<s.length;c++)s[c]=e[n[c]];if(this.outputShape=s,this.rank=s.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const r=Je(this.rank),o=rO("rc",this.rank),i=new Array(this.rank);for(let c=0;c<n.length;c++)i[n[c]]=o[c];const a=`vec2(${i.slice(-2).join()})`,l=`++${o[this.rank-1]} < ${s[this.rank-1]}`,u=`getChannel(getA(${i.join()}), ${a})`;this.userCode=`
    void main() {
      ${r} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${u};
      if(${l}) {
        result[1] = ${u};
      }
      --${o[this.rank-1]};
      if(++${o[this.rank-2]} < ${s[this.rank-2]}) {
        result[2] = ${u};
        if(${l}) {
          result[3] = ${u};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zg(t,e,n){const s=K().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new vte(t.shape,e):new xte(t.shape,e);return n.runWebGLProgram(s,[t],t.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bte(t,e,n,s){const r=e,o=t.shape.length,i=Ne(r,t.shape);let a=i;const l=vt(a,o),u=l!=null;let c=t;u&&(c=Zg(t,l,s),a=Nt(a.length,o)),on("sum",a,o);const[d,f]=Jt(c.shape,a);let h=d;n&&(h=Lt(d,i));const p=Y(f),y=Y(t.shape)/p,m=oe({inputs:{x:c},attrs:{shape:[y,p]},backend:s}),x=S1(t.dtype),v=Fa(m,x,"sum",s),b=oe({inputs:{x:v},attrs:{shape:h},backend:s});return s.disposeIntermediateTensorInfo(m),s.disposeIntermediateTensorInfo(v),u&&s.disposeIntermediateTensorInfo(c),b}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jg(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,keepDims:i}=s;return bte(r,o,i,n)}const wte={kernelName:yg,backendName:"webgl",kernelFunc:Jg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rn(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{perm:o}=s,i=n,a=r.shape.length,l=new Array(a);for(let c=0;c<l.length;c++)l[c]=r.shape[o[c]];let u;if(i.shouldExecuteOnCPU([r])){const d=i.texData.get(r.dataId).values,f=m$(d,r.shape,r.dtype,o,l);u=i.makeTensorInfo(l,r.dtype);const h=i.texData.get(u.dataId);h.values=f}else u=Zg(r,o,i);return u}const $te={kernelName:yl,backendName:"webgl",kernelFunc:Rn};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dO=1e3;function Lp({a:t,b:e,transposeA:n,transposeB:s,backend:r,bias:o=null,preluActivationWeights:i=null,leakyreluAlpha:a=0,activation:l=null}){const u=t.shape.length,c=e.shape.length,d=n?t.shape[u-2]:t.shape[u-1],f=s?e.shape[c-1]:e.shape[c-2],h=n?t.shape[u-1]:t.shape[u-2],p=s?e.shape[c-2]:e.shape[c-1],g=t.shape.slice(0,-2),y=e.shape.slice(0,-2),m=Y(g),x=Y(y),b=Se(t.shape.slice(0,-2),e.shape.slice(0,-2)).concat([h,p]);N(d===f,()=>`Error in matMul: inner shapes (${d}) and (${f}) of Tensors with shapes ${t.shape} and ${e.shape} and transposeA=${n} and transposeB=${s} must match.`);const $=n?[m,d,h]:[m,h,d],C=s?[x,p,f]:[x,f,p],k=oe({inputs:{x:t},backend:r,attrs:{shape:$}}),w=oe({inputs:{x:e},backend:r,attrs:{shape:C}}),I=[k,w],R=Math.max(m,x),E=n?k.shape[1]:k.shape[2],A=o!=null,S=i!=null,T=l==="leakyrelu",F=l!=null?Wc(l,!0):null,M=A||S||T||F!=null;let U;if((h===1||p===1)&&E>dO&&M===!1){let L=k,G=w;n&&(L=Rn({inputs:{x:k},backend:r,attrs:{perm:[0,2,1]}}),I.push(L)),s&&(G=Rn({inputs:{x:w},backend:r,attrs:{perm:[0,2,1]}}),I.push(G));const X=p!==1,Q=p===1;let Z=L;X&&(Z=oe({inputs:{x:L},backend:r,attrs:{shape:[R,E,1]}}),I.push(Z));const te=p===1?2:1;let ee=G;Q&&(ee=oe({inputs:{x:G},backend:r,attrs:{shape:[R,1,E]}}),I.push(ee));const se=x$({inputs:{a:Z,b:ee},backend:r});U=Jg({inputs:{x:se},backend:r,attrs:{axis:te,keepDims:!0}}),I.push(se)}else{const L=ss(t.dtype,e.dtype),G=new cO($,C,[R,h,p],n,s,A,F,S,T),X=[k,w];if(o!=null&&X.push(o),S&&X.push(i),T){const Q=r.makeTensorInfo([],"float32",di(a,"float32"));X.push(Q),I.push(Q)}U=r.runWebGLProgram(G,X,L)}const P=oe({inputs:{x:U},backend:r,attrs:{shape:b}});I.push(U);for(const L of I)r.disposeIntermediateTensorInfo(L);return P}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cte(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:o,bias:i,preluActivationWeights:a}=e,{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:d}=s;return Lp({a:r,b:o,transposeA:l,transposeB:u,backend:n,bias:i,preluActivationWeights:a,leakyreluAlpha:d,activation:c})}const kte={kernelName:dp,backendName:"webgl",kernelFunc:Cte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const US="return abs(x);";function Ste(t){const{inputs:e,backend:n}=t,{x:s}=e;if(n.shouldExecuteOnCPU([s])&&s.dtype!=="complex64"){const o=n.texData.get(s.dataId),i=nO(o.values);return n.makeTensorInfo(s.shape,s.dtype,i)}let r;return K().getBool("WEBGL_PACK_UNARY_OPERATIONS")?r=new Mo(s.shape,US):r=new Ir(s.shape,US),n.runWebGLProgram(r,[s],s.dtype)}const Ite={kernelName:Sm,backendName:"webgl",kernelFunc:Ste};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tte=js+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,Ete=Me({opSnippet:Tte}),Nte={kernelName:td,backendName:"webgl",kernelFunc:Ete};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rte=js+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,Ate=Me({opSnippet:Rte}),Dte={kernelName:nd,backendName:"webgl",kernelFunc:Ate};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GS="return a + b;",Fte=an({opSnippet:GS,packedOpSnippet:GS,supportsComplex:!0,cpuKernelImpl:UJ}),Pte={kernelName:Yl,backendName:"webgl",kernelFunc:Fte};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ote{constructor(e,n){this.outputShape=[],this.outputShape=e,this.variableNames=n.map((o,i)=>`T${i}`);const s=[];this.variableNames.forEach(o=>{s.push(`float v${o} = get${o}AtOutCoords();`)});const r=this.variableNames.map(o=>`v${o}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        float result = ${r};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Lte{constructor(e,n){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=n.map((o,i)=>`T${i}`);const s=[];this.variableNames.forEach(o=>{s.push(`vec4 v${o} = get${o}AtOutCoords();`)});const r=this.variableNames.map(o=>`v${o}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        vec4 result = ${r};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oh(t){const{inputs:e,backend:n}=t,s=e;if(s.length===1)return os({inputs:{x:s[0]},backend:n});if(s.length>K().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const l=Math.floor(s.length/2),u=Oh({inputs:s.slice(0,l),backend:n}),c=Oh({inputs:s.slice(l),backend:n});return Oh({inputs:[u,c],backend:n})}const r=s.map(l=>l.dtype).reduce((l,u)=>ss(l,u)),o=s.map(l=>l.shape),a=K().getBool("WEBGL_PACK")?new Lte(s[0].shape,o):new Ote(s[0].shape,o);return n.runWebGLProgram(a,s,r)}const Mte={kernelName:Mb,backendName:"webgl",kernelFunc:Oh};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _te(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,keepDims:i}=s,a=r.shape.length,l=Ne(o,r.shape);let u=l;const c=vt(u,a);let d=r;c!=null&&(d=Rn({inputs:{x:r},backend:n,attrs:{perm:c}}),u=Nt(u.length,a)),on("all",u,a);const[f,h]=Jt(d.shape,u),p=Y(h),g=oe({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}}),y=Fa(g,g.dtype,"all",n);let m;if(i){const x=Lt(f,l);m=oe({inputs:{x:y},backend:n,attrs:{shape:x}})}else m=oe({inputs:{x:y},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),c!=null&&n.disposeIntermediateTensorInfo(d),m}const zte={kernelName:_b,backendName:"webgl",kernelFunc:_te};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vte(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,keepDims:i}=s,a=r.shape.length,l=Ne(o,r.shape);let u=l;const c=vt(u,a);let d=r;c!=null&&(d=Rn({inputs:{x:r},backend:n,attrs:{perm:c}}),u=Nt(u.length,a)),on("any",u,a);const[f,h]=Jt(d.shape,u),p=Y(h),g=oe({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}}),y=Fa(g,g.dtype,"any",n);let m;if(i){const x=Lt(f,l);m=oe({inputs:{x:y},backend:n,attrs:{shape:x}})}else m=oe({inputs:{x:y},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),c!=null&&n.disposeIntermediateTensorInfo(d),m}const Bte={kernelName:zb,backendName:"webgl",kernelFunc:Vte};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wte{constructor(e,n,s){this.variableNames=["A"];const{windowSize:r,batchSize:o,outSize:i}=e;s||this.variableNames.push("bestIndicesA"),this.outputShape=[o,i];const a=n==="max"?">":"<",l=s?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${r}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${a} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ute{constructor(e,n,s,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,N(e.length>2,()=>`Packed arg${s.charAt(0).toUpperCase()+s.slice(1)} supports only inputs with rank above 2.`);const o=e[e.length-1],i=Math.ceil(o/n);this.outputShape=e.slice(0,-1),i>1&&this.outputShape.push(i),r||this.variableNames.push("bestIndicesA");const a=this.outputShape,l=a.length,u=Je(l),c=In("coords",l);let d,f;if(i===1){f=l+1;const w=Je(f);d=`
        ${w} sourceLocR = ${w}(${c.join()}, 0);
        ++${c[l-1]};
        ${w} sourceLocG = ${w}(${c.join()}, 0);
        ++${c[l-2]};
        ${w} sourceLocA = ${w}(${c.join()}, 0);
        --${c[l-1]};
        ${w} sourceLocB = ${w}(${c.join()}, 0);
        --${c[l-2]};`}else f=l,d=`
        ${u} sourceLocR = coords;
        ++${c[l-1]};
        ${u} sourceLocG = coords;
        ++${c[l-2]};
        ${u} sourceLocA = coords;
        --${c[l-1]};
        ${u} sourceLocB = coords;
        --${c[l-2]};`;const h=["x","y","z","w","u","v"].slice(0,f),p="."+h[f-1],g=h.map(w=>"int "+w),y=In("sourceLocR",f-1).concat("inIdx.r"),m=In("sourceLocG",f-1).concat("inIdx.g"),x=In("sourceLocB",f-1).concat("inIdx.b"),v=In("sourceLocA",f-1).concat("inIdx.a"),b=s==="max"?"greaterThan":"lessThan",$=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${y.join()}),
                             getBestIndicesAChannel(${m.join()}),
                             getBestIndicesAChannel(${x.join()}),
                             getBestIndicesAChannel(${v.join()})));`,C=`vec4(
            getAChannel(${y.join()}),
            hasNextCol ? getAChannel(${m.join()}) : 0.,
            hasNextRow ? getAChannel(${x.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${v.join()}) : 0.)`,k=r?"":`
      float getBestIndicesAChannel(${g.join()}) {
        return getChannel(getBestIndicesA(${h.join()}),
                                          vec2(${h.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${g.join()}) {
        return getChannel(getA(${h.join()}),
                               vec2(${h.slice(-2).join()}));
      }
      ${k}
      void main() {
        ${u} coords = getOutputCoords();
        bool hasNextCol = ${c[l-1]} < ${a[l-1]-1};
        bool hasNextRow = ${c[l-2]} < ${a[l-2]-1};
        ${d}
        ivec4 srcIdx = ivec4(sourceLocR${p}, sourceLocG${p},
          sourceLocB${p}, sourceLocA${p}) * ${n};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${C};

        for (int i = 0; i < ${n}; i++) {
          inIdx = srcIdx;
          ${$}
          vec4 candidate = ${C};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${b}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fO(t,e,n,s=null){let r=e.shape[0],o=e.shape[1];s!=null&&(r=s.shape[0],o=s.shape[1]);const i=Og(o),a={windowSize:i,inSize:o,batchSize:r,outSize:Math.ceil(o/i)},l=new Wte(a,n,s==null),u=[e];s!=null&&u.push(s);const c=t.runWebGLProgram(l,u,"int32");if(c.shape[1]===1)return c;const d=fO(t,e,n,c);return t.disposeIntermediateTensorInfo(c),d}function hO(t,e,n,s=null){const r=s!=null?s.shape:e.shape,o=r[r.length-1],i=Og(o),a=new Ute(r,i,n,s==null),l=s==null?[e]:[e,s],u=t.runWebGLProgram(a,l,"int32");if(u.shape.length===e.shape.length){const c=hO(t,e,n,u);return t.disposeIntermediateTensorInfo(u),c}return u}function pO(t,e,n,s){const r=[n];if(on("arg"+s.charAt(0).toUpperCase()+s.slice(1),r,e.shape.length),!K().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const o=[],i=t.texData.get(e.dataId),a=i!==null&&i.isPacked;let l=e;a&&(l=t.unpackTensor(e),o.push(l));const[u,c]=Jt(l.shape,r),d=Y(c),f=oe({inputs:{x:l},backend:t,attrs:{shape:[-1,d]}});o.push(f);const h=fO(t,f,s);o.push(h);const p=oe({inputs:{x:h},backend:t,attrs:{shape:u}});return o.forEach(g=>t.disposeIntermediateTensorInfo(g)),p}return hO(t,e,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gte(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o}=s;let i=Ne(o,r.shape);const a=vt(i,r.shape.length);let l=r;const u=[];a!=null&&(l=Rn({inputs:{x:r},backend:n,attrs:{perm:a}}),u.push(l),i=Nt(i.length,l.shape.length)),on("argMax",[i[0]],l.shape.length);const c=pO(n,l,i[0],"max");return u.forEach(d=>n.disposeIntermediateTensorInfo(d)),c}const Hte={kernelName:Im,backendName:"webgl",kernelFunc:Gte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jte(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o}=s;let i=Ne(o,r.shape);const a=vt(i,r.shape.length);let l=r;const u=[];a!=null&&(l=Rn({inputs:{x:r},backend:n,attrs:{perm:a}}),u.push(l),i=Nt(i.length,l.shape.length)),on("argMin",[i[0]],l.shape.length);const c=pO(n,l,i[0],"min");return u.forEach(d=>n.disposeIntermediateTensorInfo(d)),c}const Kte={kernelName:Tm,backendName:"webgl",kernelFunc:jte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xte=js+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,qte=Me({opSnippet:Xte}),Yte={kernelName:sd,backendName:"webgl",kernelFunc:qte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qte=js+"return log(x + sqrt(x * x + 1.0));",Zte=Me({opSnippet:Qte}),Jte={kernelName:rd,backendName:"webgl",kernelFunc:Zte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ene=js+`
  return atan(x);
`,tne=Me({opSnippet:ene}),nne={kernelName:od,backendName:"webgl",kernelFunc:tne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sne=g$+`
  return atan(a, b);
`,rne=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Da+`
  return result;
`,one=an({opSnippet:sne,packedOpSnippet:rne}),ine={kernelName:ad,backendName:"webgl",kernelFunc:one};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ane=js+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,lne=Me({opSnippet:ane}),une={kernelName:id,backendName:"webgl",kernelFunc:lne};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Uc{constructor(e,n,s,r=!1,o=!1){if(this.variableNames=["x"],n==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const i=e.filterWidth,a=e.strideHeight,l=e.strideWidth,u=e.dilationHeight,c=e.dilationWidth,d=e.effectiveFilterHeight,f=e.effectiveFilterWidth,h=e.padInfo.top,p=e.padInfo.left;this.outputShape=e.outShape;const g=n==="avg",y=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,m=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let x="0.0";if(g||(x="-1.0 / 1e-20"),s){const w=">=";this.userCode=`
        const ivec2 strides = ivec2(${a}, ${l});
        const ivec2 pads = ivec2(${h}, ${p});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${d};
              wR += ${u}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${f};
                wC += ${c}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${w} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${r?o?y:m:`wR * ${f} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const v="max";let b=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(b="avgValue / max(count, 1.0)");const $=Math.floor(i/4)*4,C=i%4,k=`
      if (${g}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${v}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${l});
      const ivec2 pads = ivec2(${h}, ${p});
      const float initializationValue = ${x};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${x});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${d};
            wR += ${u}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${$}; wC += 4) {
            int xC = xCCorner + wC * ${c};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              getValue(batch, xR, xC + 3 * ${c}, d)
            );

            ${k}
          }

          int xC = xCCorner + ${$};
          if (${C===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${k}
          } else if (${C===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              initializationValue,
              initializationValue
            );

            ${k}
          } else if (${C===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              initializationValue
            );

            ${k}
          }
        }
        setOutput(${b});
      }
    `}}class y${constructor(e,n,s,r=!1,o=!1){if(this.variableNames=["x"],n==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const i=e.filterWidth,a=e.strideDepth,l=e.strideHeight,u=e.strideWidth,c=e.dilationDepth,d=e.dilationHeight,f=e.dilationWidth,h=e.effectiveFilterDepth,p=e.effectiveFilterHeight,g=e.effectiveFilterWidth,y=e.padInfo.front,m=e.padInfo.top,x=e.padInfo.left;this.outputShape=e.outShape;const v=n==="avg";let b="0.0";if(v||(b="-1.0 / 1e-20"),s){const R=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${a}, ${l}, ${u});
        const ivec3 pads = ivec3(${y}, ${m}, ${x});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${h};
              wD += ${c}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${p};
                wR += ${d}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${g};
                  wC += ${f}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${R} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${r?o?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${p} * ${g} +
                      wR * ${g} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const $="max";let C=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(C="avgValue / max(count, 1.0)");const k=Math.floor(i/4)*4,w=i%4,I=`
      if (${v}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${$}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${a}, ${l}, ${u});
      const ivec3 pads = ivec3(${y}, ${m}, ${x});
      const float initializationValue = ${b};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${b});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${h};
            wD += ${c}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${p};
            wR += ${d}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${k}; wC += 4) {
              int xC = xCCorner + wC * ${f};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${f}, ch),
                getValue(batch, xD, xR, xC + 2 * ${f}, ch),
                getValue(batch, xD, xR, xC + 3 * ${f}, ch)
              );

              ${I}
            }

            int xC = xCCorner + ${k};
            if (${w===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${I}
            } else if (${w===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${f}, ch),
                initializationValue,
                initializationValue
              );

              ${I}
            } else if (${w===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${f}, ch),
                getValue(batch, xD, xR, xC + 2 * ${f}, ch),
                initializationValue
              );

              ${I}
            }
          }
        }
        setOutput(${C});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cne(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;mf(r,"avgPool");const{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=s,u=1;N(gn(i,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const c=Gs(r.shape,o,i,u,a,l);if(c.filterWidth===1&&c.filterHeight===1&&He(c.inShape,c.outShape))return os({inputs:{x:r},backend:n});const d=new Uc(c,"avg",!1);return n.runWebGLProgram(d,[r],"float32")}const dne={kernelName:Em,backendName:"webgl",kernelFunc:cne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fne(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:o,strides:i,pad:a,dimRoundingMode:l,dataFormat:u}=s,c=[1,1,1],d=xo(r.shape,o,i,c,a,l,u),f=new y$(d,"avg",!1);return n.runWebGLProgram(f,[r],"float32")}const hne={kernelName:Nm,backendName:"webgl",kernelFunc:fne};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pne{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,r=e.strideHeight,o=e.strideWidth,i=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterHeight,u=e.effectiveFilterWidth,c=l-1-e.padInfo.top,d=u-1-e.padInfo.left,f=1/(n*s);this.userCode=`
      const ivec2 pads = ivec2(${c}, ${d});
      const float avgMultiplier = float(${f});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${i}) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${u};
            wC+= ${a}) {
            float dyC = float(dyCCorner + wC) / ${o}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class mne{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterDepth,s=e.filterHeight,r=e.filterWidth,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,d=e.effectiveFilterDepth,f=e.effectiveFilterHeight,h=e.effectiveFilterWidth,p=d-1-e.padInfo.front,g=f-1-e.padInfo.top,y=h-1-e.padInfo.left,m=1/(n*s*r);this.userCode=`
      const ivec3 pads = ivec3(${p}, ${g}, ${y});
      const float avgMultiplier = float(${m});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${d};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${o}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${f};
              wR += ${u}) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${h};
                wC += ${c}) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gne(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:o}=e,i=o,{filterSize:a,strides:l,pad:u,dimRoundingMode:c}=s,d=[1,1,1],f=xo(i.shape,a,l,d,u,c),h=new mne(f);return n.runWebGLProgram(h,[r],i.dtype)}const xne={kernelName:Bb,backendName:"webgl",kernelFunc:gne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yne(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:o}=e,i=o;mf([r,o],"avgPoolGrad");const{filterSize:a,strides:l,pad:u}=s,c=Gs(i.shape,a,l,1,u),d=new pne(c);return n.runWebGLProgram(d,[r],i.dtype)}const vne={kernelName:Vb,backendName:"webgl",kernelFunc:yne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bne(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:o}=e,{transposeA:i,transposeB:a}=s;return Lp({a:r,b:o,transposeA:i,transposeB:a,backend:n})}const wne={kernelName:Rm,backendName:"webgl",kernelFunc:bne};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $ne{constructor(e,n,s,r,o,i){this.outputShape=[],this.variableNames=["x","mean","variance"],Se(e,n),Se(e,s);let a="0.0";r!=null&&(Se(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="1.0";o!=null&&(Se(e,o),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${a};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${i}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Cne{constructor(e,n,s,r,o,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Se(e,n),Se(e,s);let a="vec4(0.0)";r!=null&&(Se(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="vec4(1.0)";o!=null&&(Se(e,o),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${a};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${i}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kne=({inputs:t,backend:e,attrs:n})=>{const{x:s,mean:r,variance:o,offset:i,scale:a}=t;N(r.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),N(i==null||r.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),N(a==null||r.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=n;l==null&&(l=.001);const u=[s,r,o];let c=null;i!=null&&(c=i.shape,u.push(i));let d=null;a!=null&&(d=a.shape,u.push(a));const f=K().getBool("WEBGL_PACK_NORMALIZATION")?new Cne(s.shape,r.shape,o.shape,c,d,l):new $ne(s.shape,r.shape,o.shape,c,d,l);return e.runWebGLProgram(f,u,u[0].dtype)},Sne={kernelName:Wm,backendName:"webgl",kernelFunc:kne};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ine{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const n=Je(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const s=Tne(this.rank);let r;const o=e.map((i,a)=>`sourceLoc.${ev[a]} = start[${a}] + coords.${ev[a]};`);r=`
        ${n} sourceLoc;
        ${n} coords = getOutputCoords();
        ${o.join(`
`)}
      `,this.userCode=`
      void main() {
        ${r}
        setOutput(getSource(${s}));
      }
    `}}const ev=["x","y","z","w","u","v"];function Tne(t){if(t===1)return"sourceLoc";if(t<=6)return ev.slice(0,t).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ene{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=Je(this.rank),s=In("coords",this.rank),r=In("sourceLoc",this.rank),o=this.rank===1?"sourceLoc":`vec2(${r.slice(-2).join()})`,i=`getChannel(getSource(${r.join()}), ${o})`,a=`
      result.x = ${i};
      if (++${s[this.rank-1]} < ${e[this.rank-1]}) {
        ++${r[this.rank-1]};
        result.y = ${i};
        --${r[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${s[this.rank-1]};
      if (++${s[this.rank-2]} < ${e[this.rank-2]}) {
        ++${r[this.rank-2]};
        result.z = ${i};
        if (++${s[this.rank-1]} < ${e[this.rank-1]}) {
          ++${r[this.rank-1]};
          result.w = ${i};
        }
      }
    `,u=this.rank<=4?`sourceLoc = coords +
            ${n}(${e.map((c,d)=>`start[${d}]`).join()});`:e.map((c,d)=>`${r[d]} = ${s[d]} + start[${d}];`).join(`
`);this.userCode=`
      void main() {
        ${n} coords = getOutputCoords();
        ${n} sourceLoc;
        ${u}
        vec4 result = vec4(0.);
        ${a}
        ${l}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nne(t,e,n,s){const r=s.texData.get(t.dataId),o=s.makeTensorInfo(n,t.dtype),i=s.texData.get(o.dataId);Object.assign(i,r),i.refCount=1,i.shape=n,i.dtype=t.dtype;let a=hw(e,me(t.shape));r.slice&&(a+=r.slice.flatOffset),i.slice={flatOffset:a,origDataId:r.slice&&r.slice.origDataId||t.dataId};const l=s.dataRefCount.get(i.slice.origDataId)||1;return s.dataRefCount.set(i.slice.origDataId,l+1),o}function cu(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:o,size:i}=s,[a,l]=Pg(r,o,i);if(cw(r,a,l),Y(l)===0)return n.makeTensorInfo(l,r.dtype,[]);if(n.shouldExecuteOnCPU([r])||r.dtype==="string"){const d=n.texData.get(r.dataId),f=wee(d.values,a,l,r.shape,r.dtype);return n.makeTensorInfo(l,r.dtype,f)}const{isPacked:u}=n.texData.get(r.dataId),c=fw(r.shape,a,l);if(u||!c){const d=K().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Ene(l):new Ine(l),f=[a];return n.runWebGLProgram(d,[r],r.dtype,f)}return n.uploadToGPU(r.dataId),Nne(r,a,l,n)}const Rne={kernelName:xg,backendName:"webgl",kernelFunc:cu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ane=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:o,crops:i}=s;N(r.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const a=o.reduce((x,v)=>x*v),l=tf(r.shape,o,a),u=nf(l.length,o.length),c=sf(r.shape,o,a),d=yw(i,o.length),f=vw(c,i,o.length),h=[],p=oe({inputs:{x:r},backend:n,attrs:{shape:l}}),g=Rn({inputs:{x:p},backend:n,attrs:{perm:u}}),y=oe({inputs:{x:g},backend:n,attrs:{shape:c}}),m=cu({inputs:{x:y},backend:n,attrs:{begin:d,size:f}});return h.push(p),h.push(g),h.push(y),h.forEach(x=>n.disposeIntermediateTensorInfo(x)),m},Dne={kernelName:Am,backendName:"webgl",kernelFunc:Ane};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fne(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:o}=e,{size:i}=s,a=n.readSync(r.dataId),l=n.readSync(o.dataId),u=tO(a,l,o.dtype,o.shape,i);return n.makeTensorInfo([i],o.dtype,u)}const Pne={kernelName:Wb,backendName:"webgl",kernelFunc:Fne};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const One=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,Lne=`
  return float(int(a.r) & int(b.r));
`;function Mne(t){const{inputs:e,backend:n}=t,{a:s,b:r}=e,o=K().getBool("WEBGL_PACK_BINARY_OPERATIONS"),i=K().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([s,r])||i===1){const l=n.texData.get(s.dataId).values,u=n.texData.get(r.dataId).values,[c,d]=HJ(s.shape,r.shape,l,u,s.dtype),f=n.makeTensorInfo(d,s.dtype),h=n.texData.get(f.dataId);return h.values=c,f}let a;return o?a=new lu(One,s.shape,r.shape,!1):a=new fa(Lne,s.shape,r.shape),n.runWebGLProgram(a,[s,r],s.dtype)}const _ne={kernelName:Ub,backendName:"webgl",kernelFunc:Mne};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zne(t){const{inputs:e,backend:n}=t,{s0:s,s1:r}=e,o=n.readSync(s.dataId),i=n.readSync(r.dataId),a=Se(Array.from(o),Array.from(i));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const Vne={kernelName:sN,backendName:"webgl",kernelFunc:zne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bne="return float(a != b);",mO=an({opSnippet:Bne,cpuKernelImpl:fee,dtype:"bool"}),Wne={kernelName:og,backendName:"webgl",kernelFunc:mO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xf(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.texData.get(s.dataId);return os({inputs:{x:r.complexTensorInfos.real},backend:n})}const Une={kernelName:p1,backendName:"webgl",kernelFunc:xf};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gne="return float(int(x));";function Hne(t,e){const n=new Ir(t.shape,Gne),s=e.runWebGLProgram(n,[t],"int32");return{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tv(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dtype:o}=s;if(o==="complex64"){if(r.dtype==="complex64")return os({inputs:{x:r},backend:n});const i=xt(r.shape),a=tv({inputs:{x:r},backend:n,attrs:{dtype:"float32"}}),l=yi({inputs:{real:a,imag:i},backend:n});return i.dispose(),n.disposeIntermediateTensorInfo(a),l}if(r.dtype==="complex64"){const i=xf({inputs:{input:r},backend:n}),a=tv({inputs:{x:i},backend:n,attrs:{dtype:o}});return n.disposeIntermediateTensorInfo(i),a}if(!ZE(r.dtype,o)){const i=os({inputs:{x:r},backend:n});return{dataId:i.dataId,shape:i.shape,dtype:o}}if(n.shouldExecuteOnCPU([r])){const i=n.texData.get(r.dataId).values,[a,l,u]=jJ(i,r.shape,r.dtype,o);return n.makeTensorInfo(a,l,u)}if(o==="int32")return Hne(r,n);if(o==="bool"){const i=n.makeTensorInfo([],"bool",hn("bool",1)),l=mO({inputs:{a:r,b:i},backend:n});return n.disposeIntermediateTensorInfo(i),l}throw new Error(`Error in Cast: failed to cast ${r.dtype} to ${o}`)}const jne={kernelName:ld,backendName:"webgl",kernelFunc:tv};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HS="return ceil(x);",Kne=Me({opSnippet:HS,packedOpSnippet:HS,cpuKernelImpl:KJ}),Xne={kernelName:ud,backendName:"webgl",kernelFunc:Kne};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qne{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Yne{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qne(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{clipValueMin:o,clipValueMax:i}=s;let a;K().getBool("WEBGL_PACK_CLIP")?a=new Yne(r.shape):a=new qne(r.shape);const l=[[o],[i]];return n.runWebGLProgram(a,[r],r.dtype,l)}const Zne={kernelName:cd,backendName:"webgl",kernelFunc:Qne};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jne{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jS(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}function ese(t){const{inputs:e,backend:n}=t,{x:s}=e,r=n.texData.get(s.dataId),o=new Jne(s.shape),i=[jS(s,r.complexTensorInfos.real),jS(s,r.complexTensorInfos.imag)];return n.runWebGLProgram(o,i,i[0].dtype)}const tse={kernelName:Dm,backendName:"webgl",kernelFunc:ese};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nse{constructor(e){this.outputShape=[],this.outputShape=Ar(e,1),this.variableNames=e.map((i,a)=>`T${a}`);const n=new Array(e.length-1);n[0]=e[0][1];for(let i=1;i<n.length;i++)n[i]=n[i-1]+e[i][1];const s=[`if (yC < ${n[0]}) setOutput(getT0(yR, yC));`];for(let i=1;i<n.length;i++){const a=n[i-1];s.push(`else if (yC < ${n[i]}) setOutput(getT${i}(yR, yC-${a}));`)}const r=n.length,o=n[n.length-1];s.push(`else setOutput(getT${r}(yR, yC-${o}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${s.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sse{constructor(e,n){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Ar(e,n);const s=this.outputShape,r=s.length,o=Je(r),i=In("coords",r),a=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map((g,y)=>`T${y}`);const l=new Array(e.length-1);l[0]=e[0][n];for(let g=1;g<l.length;g++)l[g]=l[g-1]+e[g][n];const u=a[n],c=a.slice(-2),d=a.join();let f=`if (${u} < ${l[0]}) {
        return getChannel(
            getT0(${d}), vec2(${c.join()}));
        }`;for(let g=1;g<l.length;g++){const y=l[g-1];f+=`
        if (${u} < ${l[g]}  && ${u} >= ${l[g-1]}) {
          return getChannel(
            getT${g}(${rh(a,u,y)}),
            vec2(${rh(c,u,y)}));
        }`}const h=l.length,p=l[l.length-1];f+=`
        return getChannel(
          getT${h}(${rh(a,u,p)}),
          vec2(${rh(c,u,p)}));`,this.userCode=`
      float getValue(${a.map(g=>"int "+g)}) {
        ${f}
      }

      void main() {
        ${o} coords = getOutputCoords();
        vec4 result = vec4(getValue(${i}), 0., 0., 0.);

        ${i[r-1]} = ${i[r-1]} + 1;
        if (${i[r-1]} < ${s[r-1]}) {
          result.g = getValue(${i});
        }

        ${i[r-2]} = ${i[r-2]} + 1;
        if (${i[r-2]} < ${s[r-2]}) {
          result.a = getValue(${i});
        }

        ${i[r-1]} = ${i[r-1]} - 1;
        if (${i[r-2]} < ${s[r-2]} &&
            ${i[r-1]} < ${s[r-1]}) {
          result.b = getValue(${i});
        }
        setOutput(result);
      }
    `}}function rh(t,e,n){const s=t.indexOf(e);return t.map((o,i)=>i===s?`${o} - ${n}`:o).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e0(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.texData.get(s.dataId);return os({inputs:{x:r.complexTensorInfos.imag},backend:n})}const rse={kernelName:i1,backendName:"webgl",kernelFunc:e0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gu(t,e,n){const s=t[0].dtype;if(s==="complex64"){const h=t.map(x=>xf({inputs:{input:x},backend:n})),p=t.map(x=>e0({inputs:{input:x},backend:n})),g=Gu(h,e,n),y=Gu(p,e,n),m=yi({inputs:{real:g,imag:y},backend:n});return h.forEach(x=>n.disposeIntermediateTensorInfo(x)),p.forEach(x=>n.disposeIntermediateTensorInfo(x)),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),m}let r=n.shouldExecuteOnCPU(t);if(s==="string"&&(r=!0),r){const h=t.map(b=>{const C=[-1,Y(b.shape.slice(e))];return oe({inputs:{x:b},backend:n,attrs:{shape:C}})}),p=h.map(b=>({vals:n.readSync(b.dataId),shape:b.shape})),g=Ar(h.map(b=>b.shape),1),y=h[0].shape[0]===1,m=XJ(p,g,s,y),x=Ar(t.map(b=>b.shape),e),v=n.makeTensorInfo(x,s,m);return h.forEach(b=>n.disposeIntermediateTensorInfo(b)),v}const o=t.filter(h=>Y(h.shape)>0),i=K().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&o[0].shape.length>1;if(o.length===1){const h=i?new Ir(t[0].shape,Ro):new Mo(t[0].shape,Ro);return n.runWebGLProgram(h,t,s)}const a=K().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(o.length>a){const h=[];for(let g=0;g<o.length;g+=a){const y=o.slice(g,g+a);h.push(Gu(y,e,n))}const p=Gu(h,e,n);for(const g of h)n.disposeIntermediateTensorInfo(g);return p}if(i){const h=new sse(o.map(p=>p.shape),e);return n.runWebGLProgram(h,o,s)}const{tensors2D:l,outShape:u}=ose(o,e,n),c=new nse(l.map(h=>h.shape)),d=n.runWebGLProgram(c,l,s);l.forEach(h=>n.disposeIntermediateTensorInfo(h));const f=oe({inputs:{x:d},attrs:{shape:u},backend:n});return n.disposeIntermediateTensorInfo(d),f}function ose(t,e,n){const s=Ar(t.map(o=>o.shape),e);return{tensors2D:t.map(o=>oe({inputs:{x:o},attrs:{shape:[-1,Y(o.shape.slice(e))]},backend:n})),outShape:s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gO(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s,o=Ne(r,e[0].shape)[0],i=e.map(u=>u.shape);mw(i,o);const a=Ar(e.map(u=>u.shape),o);if(Y(a)===0)return n.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(u=>Y(u.shape)>0);return l.length===1?os({inputs:{x:l[0]},backend:n}):Gu(l,o,n)}const ise={kernelName:Fm,backendName:"webgl",kernelFunc:gO};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xO{constructor(e,n=!1,s=null,r=!1,o=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const i=e.padInfo.top,a=e.padInfo.left,l=e.strideHeight,u=e.strideWidth,c=e.dilationHeight,d=e.dilationWidth,f=e.filterHeight,h=e.filterWidth,p=Math.floor(e.inChannels/4)*4,g=e.inChannels%4,y=e.dataFormat==="channelsLast",m=y?1:2,x=y?2:3,v=y?3:1;let b="",$="";s&&(r?b=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:o?b=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:b=`
          float activation(float x) {
            ${s}
          }
        `,$="result = activation(result);");const C=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${b}

      const ivec2 strides = ivec2(${l}, ${u});
      const ivec2 pads = ivec2(${i}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${v}];

        ivec2 xRCCorner =
            ivec2(coords[${m}], coords[${x}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${f}; wR++) {
          int xR = xRCorner + wR * ${c};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${h}; wC++) {
            int xC = xCCorner + wC * ${d};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${p}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${y}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${g===1}) {

              if (${y}) {
                dotProd +=
                    getX(batch, xR, xC, ${p}) *
                    getW(wR, wC, ${p}, d2);
              } else {
                dotProd +=
                    getX(batch, ${p}, xR, xC) *
                    getW(wR, wC, ${p}, d2);
              }

            } else if (${g===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2)
              );

              if (${y}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${g===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2),
                getW(wR, wC, ${p} + 2, d2)
              );

              if (${y}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1),
                  getX(batch, xR, xC, ${p} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC),
                  getX(batch, ${p} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${C}
        ${$}
        setOutput(result);
      }
    `}}class ase{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const n=e.padInfo.front,s=e.padInfo.top,r=e.padInfo.left,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,d=e.filterDepth,f=e.filterHeight,h=e.filterWidth,p=Math.floor(e.inChannels/4)*4,g=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${o}, ${i}, ${a});
      const ivec3 pads = ivec3(${n}, ${s}, ${r});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${d}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${f}; wR++) {
            int xR = xRCorner + wR * ${u};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${h}; wC++) {
              int xC = xCCorner + wC * ${c};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${p}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${g===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${p}) *
                  getW(wF, wR, wC, ${p}, d2);
              } else if (${g===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${g===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1),
                  getX(batch, xF, xR, xC, ${p} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2),
                  getW(wF, wR, wC, ${p} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yO{constructor(e,n=!1,s=null,r=!1,o=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=yn(this.outputShape.length);const i=e.padInfo.left,a=e.strideWidth,l=e.dilationWidth,u=e.filterHeight,c=e.filterWidth,d=c;let f=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let y=0;y<c;y++)f+=`
           vec4 xTexelC${y*2};
           int xTexelC${y*2}Ready;
           vec4 xTexelC${y*2+1};
           int xTexelC${y*2+1}Ready;
           vec4 xC${y};`;f+=`
     for (int r = 0; r < ${u}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let y=0;y<c;y++)f+=`
           xTexelC${y*2} = vec4(0.0);
           xTexelC${y*2}Ready = 0;
           xTexelC${y*2+1} = vec4(0.0);
           xTexelC${y*2+1}Ready = 0;
           xC${y} = vec4(0.0);`;f+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let y=0;y<(d+1)/2;y++){const m=y*2;if(f+=`
           xC = xCCorner + ${m*l};
           `,a===1){if(m<c&&(i%2===1?(f+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${m}Ready == 0) {
                   xTexelC${m} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${m}.zw = vec2(0.0);
                   }
                   xTexelC${m}Ready = 1;
                 }
               `,l===1&&m>0?f+=`
                 xC${m} = vec4(xTexelC${m-2}.zw, xTexelC${m}.xy);
                 `:f+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${m} = vec4(previous.zw, xTexelC${m}.xy);
                   } else {
                     xC${m} = vec4(0.0, 0.0, xTexelC${m}.xy);
                   }
                   `):f+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${m}Ready == 0) {
                   xTexelC${m} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${m}.zw = vec2(0.0);
                   }
                   xTexelC${m}Ready = 1;
                 }

                 xC${m} = xTexelC${m};
                 `,m+1<c)){const x=i%2===0?Db(l):l;l%2===0&&i%2===1||l%2!==0&&i%2!==1?(f+=`
                   xCOffset = xC + imod(pads[1], 2) + ${x};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${m+1}Ready == 0) {
                     xTexelC${m+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${m+1}.zw = vec2(0.0);
                     }
                     xTexelC${m+1}Ready = 1;
                   }
                   `,l>1?f+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${m+1} = vec4(previous.zw, xTexelC${m+1}.xy);
                     } else {
                      xC${m+1} = vec4(0.0, 0.0, xTexelC${m+1}.xy);
                     }
                     `:f+=`
                     xC${m+1} = vec4(xTexelC${m}.zw, xTexelC${m+1}.xy);
                     `):x===1?f+=`
                     xC${m+1} = xTexelC${m};
                     `:f+=`
                     xCOffset = xC + ${x};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${m+1}Ready == 0) {
                       xTexelC${m+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${m+1}.zw = vec2(0.0);
                       }
                       xTexelC${m+1}Ready = 1;
                     }

                     xC${m+1} = xTexelC${m+1};
                     `}}else m<c&&(i%2===1?(f+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${m}Ready == 0) {
                   xTexelC${m} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${m}.zw = vec2(0.0);
                   }
                   xTexelC${m}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${m+1}Ready == 0) {
                   xTexelC${m+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${m+1}.zw = vec2(0.0);
                   }
                   xTexelC${m+1}Ready = 1;
                 }

                 xC${m} = vec4(xTexelC${m}.zw, xTexelC${m+1}.zw);
               `,m+1<c&&(f+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${m+1} = vec4(xTexelC${m+1}.xy, final.xy);
                 `)):(f+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${m}Ready == 0) {
                   xTexelC${m} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${m}.zw = vec2(0.0);
                   }
                   xTexelC${m}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${m+1}Ready == 0) {
                   xTexelC${m+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${m+1}.zw = vec2(0.);
                   }
                   xTexelC${m+1}Ready = 1;
                 }

                 xC${m} = vec4(
                   xTexelC${m}.xy, xTexelC${m+1}.xy);
               `,m+1<c&&(f+=`
                   xC${m+1} = vec4(xTexelC${m}.zw, xTexelC${m+1}.zw);
                 `)));m<c&&(f+=`
             wTexel = getW(r, ${m}, d1, d2);
             dotProd += xC${m}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${m}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,m+1<c&&(f+=`
               wTexel = getW(r, ${m+1}, d1, d2);
               dotProd += xC${m+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${m+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}f+=`
     }
   `,f+=`
     }
   `,f+=`
     }
   `;let h="",p="";s&&(r?h=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${s}
         }`:o?h=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${s}
         }`:h=`vec4 activation(vec4 x) {
           ${s}
         }`,p="result = activation(result);");const g=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${h}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${f}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${g}
         ${p}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lse{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=yn(this.outputShape.length);const{dataFormat:s}=n,r=An(),o=s==="channelsLast",i=o?1:2,a=o?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let u="";for(let c=0;c<=1;c++)for(let d=0;d<=1;d++)u+=`
          blockIndex = rc.z + ${d};
          pos = rc.y + ${c};

          ${l}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${i}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${a}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${o}) {
                  innerDims = vec2(d1, ch);
                  result[${c*2+d}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${c*2+d}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${u}

        ${r.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mp(t,e){const n=t.length;return n>=3?e?[...t.slice(0,-3),t[n-3]*t[n-2],t[n-1]]:[...t.slice(0,-3),t[n-3],t[n-2]*t[n-1]]:!e&&n===1&&t[0]>1?[t[0],1]:null}function vO({x:t,filter:e,convInfo:n,backend:s,bias:r=null,preluActivationWeights:o=null,leakyreluAlpha:i=0,activation:a=null}){const l=t.shape,u=s.texData.get(t.dataId),c=n.inChannels,d=l[0]*l[1]*l[2],f=n.outChannels,h=n.dataFormat==="channelsLast",p=!1,g=!1;let y;const m=[];if(o!=null){const b=Mp(o.shape,h);b!=null&&(o=oe({inputs:{x:o},backend:s,attrs:{shape:b}}),m.push(o))}if(r!=null){const b=Mp(r.shape,h);b!=null&&(r=oe({inputs:{x:r},backend:s,attrs:{shape:b}}),m.push(r))}if(!((d===1||f===1)&&c>dO)&&u.isPacked&&h&&u.texture!=null&&l[2]%2!==0&&He(u.shape.slice(-3),l.slice(-3))){const b=l[0]*l[1]*(l[2]+1),$={dataId:t.dataId,shape:[1,b,n.inChannels],dtype:t.dtype},C=u.shape;u.shape=u.shape.slice(),u.shape[u.shape.length-2]++,N(Op(u.shape,$.shape),()=>`packed reshape ${u.shape} to ${$.shape} isn't free`);const k=oe({inputs:{x:e},backend:s,attrs:{shape:[1,n.inChannels,n.outChannels]}});m.push(k);const w=Lp({a:$,b:k,backend:s,transposeA:p,transposeB:g,bias:r,activation:a,preluActivationWeights:o,leakyreluAlpha:i}),I=s.texData.get(w.dataId);N(I.isPacked,()=>"batchMatMul result is expected to be packed"),u.shape=C,I.shape=n.outShape,y=os({inputs:{x:w},backend:s}),y.shape=n.outShape,m.push(w)}else{const b=n.outHeight*n.outWidth,$=oe({inputs:{x:t},backend:s,attrs:{shape:h?[n.batchSize,b,n.inChannels]:[n.batchSize,n.inChannels,b]}}),C=oe({inputs:{x:e},backend:s,attrs:{shape:[1,n.inChannels,n.outChannels]}}),k=Lp({a:h?$:C,b:h?C:$,transposeA:!h,transposeB:g,backend:s,bias:r,activation:a,preluActivationWeights:o,leakyreluAlpha:i});y=oe({inputs:{x:k},backend:s,attrs:{shape:n.outShape}}),m.push($),m.push(C),m.push(k)}for(const b of m)s.disposeIntermediateTensorInfo(b);return y}function bO({x:t,filter:e,convInfo:n,backend:s,bias:r=null,preluActivationWeights:o=null,leakyreluAlpha:i=0,activation:a=null}){const{filterWidth:l,filterHeight:u,inChannels:c,outWidth:d,outHeight:f,dataFormat:h}=n,p=h==="channelsLast",g=l*u*c,y=f*d,m=[n.batchSize,g,y],x=!0,v=!1,b=[];if(o!=null){const P=Mp(o.shape,p);P!=null&&(o=oe({inputs:{x:o},backend:s,attrs:{shape:P}}),b.push(o))}if(r!=null){const P=Mp(r.shape,p);P!=null&&(r=oe({inputs:{x:r},backend:s,attrs:{shape:P}}),b.push(r))}const $=oe({inputs:{x:e},backend:s,attrs:{shape:[1,g,Y(e.shape)/g]}});b.push($);const C=new lse(m,n),k=[t.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],w=s.runWebGLProgram(C,[t],"float32",k),I=oe({inputs:{x:w},backend:s,attrs:{shape:m}});b.push(w),b.push(I);const R=r!=null,E=o!=null,A=a==="leakyrelu",S=a?Wc(a,!0):null,T=new cO(p?I.shape:$.shape,p?$.shape:I.shape,p?[n.batchSize,y,n.outChannels]:[n.batchSize,n.outChannels,y],x,v,R,S,E,A),F=p?[I,$]:[$,I];if(r&&F.push(r),E&&F.push(o),A){const P=s.makeTensorInfo([],"float32",di(i,"float32"));F.push(P),b.push(P)}const M=s.runWebGLProgram(T,F,"float32"),U=oe({inputs:{x:M},backend:s,attrs:{shape:n.outShape}});b.push(M);for(const P of b)s.disposeIntermediateTensorInfo(P);return U}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function use(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:o}=e,{strides:i,pad:a,dataFormat:l,dilations:u,dimRoundingMode:c}=s,d=yo(l),f=rn(r.shape,o.shape,i,u,a,c,!1,d);let h;if(f.filterHeight===1&&f.filterWidth===1&&f.dilationHeight===1&&f.dilationWidth===1&&f.strideHeight===1&&f.strideWidth===1&&(f.padInfo.type==="SAME"||f.padInfo.type==="VALID"))h=vO({x:r,filter:o,convInfo:f,backend:n});else if(f.strideWidth<=2&&d==="channelsLast"&&K().getBool("WEBGL_EXP_CONV")){const g=new yO(f),y=[[f.padInfo.top,f.padInfo.left],[f.strideHeight,f.strideWidth],[f.dilationHeight,f.dilationWidth],[f.inHeight,f.inWidth]];h=n.runWebGLProgram(g,[r,o],"float32",y)}else if(K().getBool("WEBGL_CONV_IM2COL"))h=bO({x:r,filter:o,convInfo:f,backend:n});else{const g=new xO(f);h=n.runWebGLProgram(g,[r,o],"float32")}const p=oe({inputs:{x:h},backend:n,attrs:{shape:f.outShape}});return n.disposeIntermediateTensorInfo(h),p}const cse={kernelName:Pm,backendName:"webgl",kernelFunc:use};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dse{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,s=e.strideWidth,r=e.padInfo.top,o=e.padInfo.left,i=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${o};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              ${i?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class fse{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,r=e.strideHeight,o=e.strideWidth,i=e.dataFormat==="channelsLast",a=n-1-e.padInfo.top,l=s-1-e.padInfo.left,u=i?1:2,c=i?2:3,d=i?3:1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${d}];

        ivec2 dyCorner = ivec2(coords[${u}], coords[${c}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${o}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${i}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class hse{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideDepth,s=e.strideHeight,r=e.strideWidth,o=e.padInfo.front,i=e.padInfo.top,a=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${n} - ${o};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${s} - ${i};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${r} - ${a};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class pse{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterDepth,s=e.filterHeight,r=e.filterWidth,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,l=n-1-e.padInfo.front,u=s-1-e.padInfo.top,c=r-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${u}, ${c});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${n}; wF++) {
          float dyF = float(dyFCorner + wF) / ${o}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${n} - 1 - wF;

          for (int wR = 0; wR < ${s}; wR++) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${s} - 1 - wR;

            for (int wC = 0; wC < ${r}; wC++) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${r} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mse(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:o}=e,{strides:i,pad:a,dataFormat:l,dimRoundingMode:u,filterShape:c}=s,d=yo(l),f=rn(r.shape,c,i,1,a,u,!1,d),h=new dse(f);return n.runWebGLProgram(h,[r,o],"float32")}const gse={kernelName:Hb,backendName:"webgl",kernelFunc:mse};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xse{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=yn(this.outputShape.length);const n=e.filterHeight,s=e.filterWidth,r=n-1-e.padInfo.top,o=s-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${r}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            int wCPerm = ${s} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${e.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${e.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yse(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:o}=e,{inputShape:i,strides:a,pad:l,dataFormat:u,dimRoundingMode:c}=s,d=yo(u),f=rn(i,o.shape,a,1,l,c,!1,d);if(K().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&d==="channelsLast"){const h=[[f.strideHeight,f.strideWidth]],p=new xse(f);return n.runWebGLProgram(p,[r,o],"float32",h)}else{const h=new fse(f);return n.runWebGLProgram(h,[r,o],"float32")}}const vse={kernelName:Om,backendName:"webgl",kernelFunc:yse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bse(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:o}=e,{strides:i,pad:a,dilations:l}=s,u=fi(r.shape,o.shape,i,l,a),c=new ase(u);return n.runWebGLProgram(c,[r,o],"float32")}const wse={kernelName:Lm,backendName:"webgl",kernelFunc:bse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $se(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:o}=e,{strides:i,pad:a,filterShape:l}=s,u=fi(r.shape,l,i,1,a),c=new hse(u);return n.runWebGLProgram(c,[r,o],"float32")}const Cse={kernelName:jb,backendName:"webgl",kernelFunc:$se};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kse(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:o}=e,{pad:i,strides:a,inputShape:l}=s,u=fi(l,o.shape,a,1,i),c=new pse(u);return n.runWebGLProgram(c,[r,o],"float32")}const Sse={kernelName:Kb,backendName:"webgl",kernelFunc:kse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ise=uu+`
  return cos(x);
`,Tse=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${Da}
  return result;
`,Ese=Me({opSnippet:Ise,packedOpSnippet:Tse}),Nse={kernelName:dd,backendName:"webgl",kernelFunc:Ese};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rse=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,Ase=Me({opSnippet:Rse}),Dse={kernelName:fd,backendName:"webgl",kernelFunc:Ase};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fse{constructor(e,n,s,r,o){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[i,a,l,u]=e,[c]=n,[d,f]=s;this.outputShape=[c,d,f,u];const h=r==="bilinear"?1:0,[p,g]=[`${a-1}.0`,`${l-1}.0`],[y,m,x]=d>1?[`${(a-1)/(d-1)}`,"(y2-y1) * height_ratio",`y1*${p} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${p}`],[v,b,$]=f>1?[`${(l-1)/(f-1)}`,"(x2-x1) * width_ratio",`x1*${g} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${g}`];this.userCode=`
      const float height_ratio = float(${y});
      const float width_ratio = float(${v});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${i}) {
          return;
        }

        float height_scale = ${m};
        float width_scale = ${b};

        float in_y = ${x};
        if( in_y < 0.0 || in_y > ${p} ) {
          setOutput(float(${o}));
          return;
        }
        float in_x = ${$};
        if( in_x < 0.0 || in_x > ${g} ) {
          setOutput(float(${o}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${h} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pse=t=>{const{inputs:e,backend:n,attrs:s}=t,{image:r,boxes:o,boxInd:i}=e,{cropSize:a,method:l,extrapolationValue:u}=s,c=new Fse(r.shape,o.shape,a,l,u);return n.runWebGLProgram(c,[r,o,i],"float32")},Ose={kernelName:qb,backendName:"webgl",kernelFunc:Pse};var Gc;(function(t){t.Prod="*",t.Sum="+"})(Gc||(Gc={}));class KS{constructor(e,n,s,r){this.op=e,this.outputShape=n,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const o=this.outputShape.length,i=this.op===Gc.Prod?"1.0":"0.0",a=s?i:`getX(${XS(o,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1];let u="",c="";s?(u=r?`end != ${l-1}`:"end != 0",c=r?"end + 1":"end - 1"):(u=r?`end + pow2 < ${l}`:"end >= pow2",c=r?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${Je(o)} coords = getOutputCoords();
        int end = ${qS(o,"coords",this.op)};
        float val = ${a};
        int pow2 = int(pow(2.0, index));
        if (${u}) {
          int idx = ${c};
          ${qS(o,"coords",this.op)} = idx;
          val ${this.op}= getX(${XS(o,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function XS(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.x, ${e}.y`;if(t===3)return`${e}.x, ${e}.y, ${e}.z`;if(t===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}function qS(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.y`;if(t===3)return`${e}.z`;if(t===4)return`${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wO(t,e,n,s,r,o){const i=e.shape.length,a=vt([s],i);let l=e;a!=null&&(l=Rn({inputs:{x:e},backend:n,attrs:{perm:a}}));const u=Nt(1,i)[0];if(u!==i-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${s}`);const c=l.shape[u];let d=os({inputs:{x:l},backend:n});for(let f=0;f<=Math.ceil(Math.log2(c))-1;f++){const h=new KS(t,l.shape,!1,o),p=[[f]],g=d;d=n.runWebGLProgram(h,[d],d.dtype,p),n.disposeIntermediateTensorInfo(g)}if(r){const f=new KS(t,l.shape,r,o),h=d;d=n.runWebGLProgram(f,[d],d.dtype),n.disposeIntermediateTensorInfo(h)}if(a!=null){const f=hi(a),h=Rn({inputs:{x:d},backend:n,attrs:{perm:f}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(l),h}return d}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lse(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,exclusive:i,reverse:a}=s;return wO(Gc.Prod,r,n,o,i,a)}const Mse={kernelName:Xb,backendName:"webgl",kernelFunc:Lse};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _se(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,exclusive:i,reverse:a}=s;return wO(Gc.Sum,r,n,o,i,a)}const zse={kernelName:Mm,backendName:"webgl",kernelFunc:_se};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vse(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:o}=e,{size:i,binaryOutput:a}=s;if(r.shape.length===1){const l=n.readSync(r.dataId),u=n.readSync(o.dataId),c=tO(l,u,o.dtype,o.shape,i);return n.makeTensorInfo([i],o.dtype,c)}else if(r.shape.length===2){const l=n.bufferSync(r),u=n.bufferSync(o),c=GJ(l,u,i,a);return n.makeTensorInfo(c.shape,o.dtype,c.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}const Bse={kernelName:Yb,backendName:"webgl",kernelFunc:Vse};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wse{constructor(e,n,s){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=n,this.dataFormat=s,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${n};
      int offset_h = imod(h, ${n});
      int in_w = w / ${n};
      int offset_w = imod(w, ${n});
      int offset_d = (offset_h * ${n} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Use(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockSize:o,dataFormat:i}=s,a=r.shape[0],l=i==="NHWC"?r.shape[1]:r.shape[2],u=i==="NHWC"?r.shape[2]:r.shape[3],c=i==="NHWC"?r.shape[3]:r.shape[1],d=l*o,f=u*o,h=c/(o*o),p=i==="NHWC"?[a,d,f,h]:[a,h,d,f],g=new Wse(p,o,i);return n.runWebGLProgram(g,[r],r.dtype)}const Gse={kernelName:Qb,backendName:"webgl",kernelFunc:Use};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $O{constructor(e,n=!1,s=null,r=!1,o=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=yn(this.outputShape.length);const i=e.filterHeight,a=e.filterWidth,l=e.outChannels/e.inChannels;let u="",c="";s&&(r?u=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:o?u=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:u=`
          float activation(float x) {
            ${s}
          }
        `,c="result = activation(result);");const d=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${u}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${i}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${a}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${d}
        ${c}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class CO{constructor(e,n=!1,s=null,r=!1,o=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=yn(this.outputShape.length);const i=e.outChannels/e.inChannels,a=e.padInfo.left,l=e.strideWidth,u=e.dilationWidth,c=e.filterHeight,d=e.filterWidth,f=d;let h=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let m=0;m<d;m++)h+=`
          vec4 xTexelC${m*2};
          int xTexelC${m*2}Ready;
          vec4 xTexelC${m*2+1};
          int xTexelC${m*2+1}Ready;
          vec4 xC${m};`;h+=`
    for (int r = 0; r < ${c}; r++) {
      `;for(let m=0;m<d;m++)h+=`
          xTexelC${m*2} = vec4(0.0);
          xTexelC${m*2}Ready = 0;
          xTexelC${m*2+1} = vec4(0.0);
          xTexelC${m*2+1}Ready = 0;
          xC${m} = vec4(0.0);`;h+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let m=0;m<(f+1)/2;m++){const x=m*2;if(h+=`
          xC = xCCorner + ${x*u};
          `,l===1){if(x<d&&(a%2===1?(h+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }
              `,u===1&&x>0?h+=`
                xC${x} = vec4(xTexelC${x-2}.zw, xTexelC${x}.xy);
                `:h+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${x} = vec4(previous.zw, xTexelC${x}.xy);
                  } else {
                    xC${x} = vec4(0.0, 0.0, xTexelC${x}.xy);
                  }
                  `):h+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }

                xC${x} = xTexelC${x};
                `,x+1<d)){const v=a%2===0?Db(u):u;u%2===0&&a%2===1||u%2!==0&&a%2!==1?(h+=`
                  xCOffset = xC + imod(pads[1], 2) + ${v};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                    xTexelC${x+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${x+1}.zw = vec2(0.0);
                    }
                    xTexelC${x+1}Ready = 1;
                  }
                  `,u>1?h+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${x+1} = vec4(previous.zw, xTexelC${x+1}.xy);
                    } else {
                     xC${x+1} = vec4(0.0, 0.0, xTexelC${x+1}.xy);
                    }
                    `:h+=`
                    xC${x+1} = vec4(xTexelC${x}.zw, xTexelC${x+1}.xy);
                    `):v===1?h+=`
                    xC${x+1} = xTexelC${x};
                    `:h+=`
                    xCOffset = xC + ${v};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                      xTexelC${x+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${x+1}.zw = vec2(0.0);
                      }
                      xTexelC${x+1}Ready = 1;
                    }

                    xC${x+1} = xTexelC${x+1};
                    `}}else x<d&&(a%2===1?(h+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${x+1}Ready == 0) {
                  xTexelC${x+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${x+1}.zw = vec2(0.0);
                  }
                  xTexelC${x+1}Ready = 1;
                }

                xC${x} = vec4(xTexelC${x}.zw, xTexelC${x+1}.zw);
              `,x+1<d&&(h+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${x+1} = vec4(xTexelC${x+1}.xy, final.xy);
                `)):(h+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                  xTexelC${x+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${x+1}.zw = vec2(0.);
                  }
                  xTexelC${x+1}Ready = 1;
                }

                xC${x} = vec4(
                  xTexelC${x}.xy, xTexelC${x+1}.xy);
              `,x+1<d&&(h+=`
                  xC${x+1} = vec4(xTexelC${x}.zw, xTexelC${x+1}.zw);
                `)));x<d&&(h+=`
            wTexel = getW(r, ${x}, d1, q);
            dotProd += xC${x} * vec4(wTexel.xz, wTexel.xz);
          `,x+1<d&&(h+=`
              wTexel = getW(r, ${x+1}, d1, q);
              dotProd += xC${x+1} * vec4(wTexel.xz, wTexel.xz);
            `))}h+=`
    }
  `,h+=`
      }
    `;let p="",g="";s&&(r?p=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:o?p=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:p=`vec4 activation(vec4 x) {
          ${s}
        }`,g="result = activation(result);");const y=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${p}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${i};
        int q = d2 - d1 * ${i};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${h}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${y}
        ${g}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hse(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:o}=e,{strides:i,pad:a,dilations:l,dimRoundingMode:u}=s;let c=l;c==null&&(c=[1,1]),N(gn(i,c),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const d=rn(r.shape,o.shape,i,c,a,u,!0);let f;K().getBool("WEBGL_PACK_DEPTHWISECONV")&&d.strideWidth<=2&&d.outChannels/d.inChannels===1?f=new CO(d):f=new $O(d);const h=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];return n.runWebGLProgram(f,[r,o],"float32",h)}const jse={kernelName:_m,backendName:"webgl",kernelFunc:Hse};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Kse{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,s=e.strideWidth,r=e.padInfo.top,o=e.padInfo.left,i=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${i} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${o};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class Xse{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,r=e.strideHeight,o=e.strideWidth,i=n-1-e.padInfo.top,a=s-1-e.padInfo.left,l=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${i}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${o}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qse(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:o}=e,{strides:i,dilations:a,pad:l,dimRoundingMode:u,filterShape:c}=s,d=rn(r.shape,c,i,a,l,u,!0),f=new Kse(d);return n.runWebGLProgram(f,[r,o],"float32")}const Yse={kernelName:Zb,backendName:"webgl",kernelFunc:qse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qse(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:o}=e,{strides:i,dilations:a,pad:l,dimRoundingMode:u,inputShape:c}=s,d=rn(c,o.shape,i,a,l,u,!0),f=new Xse(d);return n.runWebGLProgram(f,[r,o],"float32")}const Zse={kernelName:Jb,backendName:"webgl",kernelFunc:Qse};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jse{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ere(t){const{inputs:e,backend:n}=t,{x:s}=e,r=[...s.shape,...s.shape],o=Y(s.shape),i=oe({inputs:{x:s},backend:n,attrs:{shape:[o]}}),a=new Jse(o),l=n.runWebGLProgram(a,[i],i.dtype),u=oe({inputs:{x:l},backend:n,attrs:{shape:r}});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(l),u}const tre={kernelName:rN,backendName:"webgl",kernelFunc:ere};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nre{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:n,inWidth:s,padInfo:r,strideHeight:o,strideWidth:i,filterHeight:a,filterWidth:l,dilationHeight:u,dilationWidth:c}=e,{top:d,left:f}=r;this.userCode=`
      const ivec2 strides = ivec2(${o}, ${i});
      const ivec2 pads = ivec2(${d}, ${f});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${a}; h++) {
          int hIn = hBeg + h * ${u};

          if (hIn >= 0 && hIn < ${n}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${c};

              if (wIn >= 0 && wIn < ${s}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sre(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:o}=e,{strides:i,pad:a,dilations:l}=s,u=Yd(r.shape,o.shape,i,a,"NHWC",l);let c;const d=new nre(u);c=n.runWebGLProgram(d,[r,o],"float32");const f=oe({inputs:{x:c},backend:n,attrs:{shape:u.outShape}});return n.disposeIntermediateTensorInfo(c),f}const rre={kernelName:zm,backendName:"webgl",kernelFunc:sre};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ore(t){const{inputs:e,backend:n,attrs:s}=t,{equation:r}=s,o=e,{allDims:i,summedDims:a,idDims:l}=Tw(r,o.length);Nw(i.length,l,o);const{path:u,steps:c}=Rw(a,l),d=c.length;let f=null,h=i.length;const p=[];for(let g=0;g<d;++g){for(const y of c[g]){const{permutationIndices:m,expandDims:x}=Ew(h,l[y]);let v;Aw(m)?v=o[y]:(v=Rn({inputs:{x:o[y]},backend:n,attrs:{perm:m}}),p.push(v));const b=v.shape.slice();for(let $=0;$<x.length;++$)b.splice(x[$],0,1);He(v.shape,b)||(v=oe({inputs:{x:v},backend:n,attrs:{shape:b}}),p.push(v)),f===null?f=v:(f=x$({inputs:{a:v,b:f},backend:n}),p.push(f))}g<d-1&&(u[g]>=0&&(f=Jg({inputs:{x:f},backend:n,attrs:{axis:u[g]-(i.length-h),keepDims:!1}}),p.push(f)),h--)}for(const g of p)g!==f&&n.disposeIntermediateTensorInfo(g);return f}const ire={kernelName:e1,backendName:"webgl",kernelFunc:ore};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const are="return (x >= 0.0) ? x : (exp(x) - 1.0);",lre=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,ure=Me({opSnippet:are,packedOpSnippet:lre}),cre={kernelName:pd,backendName:"webgl",kernelFunc:ure};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dre="return (b >= 0.0) ? a : a * (b + 1.0);",fre=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,hre=t=>{const{inputs:e,backend:n}=t,{dy:s,y:r}=e,o=K().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new lu(fre,s.shape,r.shape):new fa(dre,s.shape,r.shape);return n.runWebGLProgram(o,[s,r],s.dtype)},pre={kernelName:t1,backendName:"webgl",kernelFunc:hre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mre=`
  return vec4(equal(a, b));
`,gre="return float(a == b);",xre=an({opSnippet:gre,packedOpSnippet:mre,dtype:"bool",cpuKernelImpl:qJ}),yre={kernelName:Vm,backendName:"webgl",kernelFunc:xre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vre=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${bw};
  float a1 = ${ww};
  float a2 = ${$w};
  float a3 = ${Cw};
  float a4 = ${kw};
  float a5 = ${Sw};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,bre=Me({opSnippet:vre}),wre={kernelName:md,backendName:"webgl",kernelFunc:bre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $re=uu+`
  return exp(x);
`,Cre=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,kO=Me({opSnippet:$re,packedOpSnippet:Cre,cpuKernelImpl:YJ,dtype:"float32"}),kre={kernelName:gd,backendName:"webgl",kernelFunc:kO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nv(t){const{inputs:e,attrs:n,backend:s}=t,{dim:r}=n,{input:o}=e,i=o.shape.length,a=o.shape.slice();let l=r;return r<0&&(N(-(i+1)<=r,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),l=i+r+1),a.splice(l,0,1),oe({inputs:{x:o},backend:s,attrs:{shape:a}})}const Sre={kernelName:Bm,backendName:"webgl",kernelFunc:nv};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YS="return exp(x) - 1.0;",Ire=Me({opSnippet:YS,packedOpSnippet:YS,cpuKernelImpl:QJ}),Tre={kernelName:xd,backendName:"webgl",kernelFunc:Ire};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class QS{constructor(e,n,s){this.variableNames=["real","imag"];const r=n[1];this.outputShape=n;const o=s?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,i=s?`${r}.0`:"1.0";let a;if(e==="real")a="return real * expR - imag * expI;";else if(e==="imag")a="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${o};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${a}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${r});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${r}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${i};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SO(t,e,n){const s=n.texData.get(t.dataId),r=Y(t.shape),o=t.shape[t.shape.length-1],i=r/o,a=oe({inputs:{x:t},backend:n,attrs:{shape:[i,o]}}),l=a.shape,u=new QS("real",l,e),c=new QS("imag",l,e),d=[{dataId:s.complexTensorInfos.real.dataId,dtype:s.complexTensorInfos.real.dtype,shape:l},{dataId:s.complexTensorInfos.imag.dataId,dtype:s.complexTensorInfos.imag.dtype,shape:l}],f=n.runWebGLProgram(u,d,"float32"),h=n.runWebGLProgram(c,d,"float32"),p=yi({inputs:{real:f,imag:h},backend:n});n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(h);const g=oe({inputs:{x:p},backend:n,attrs:{shape:t.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(p),g}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ere(t){const{inputs:e,backend:n}=t,{input:s}=e;return SO(s,!1,n)}const Nre={kernelName:n1,backendName:"webgl",kernelFunc:Ere};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Rre{constructor(e,n){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yf(t){const{backend:e,attrs:n}=t,{shape:s,value:r}=n;let{dtype:o}=n;if(o=o||Xl(r),o==="string"){const i=St(o,Y(s));return i.fill(r),e.makeTensorInfo(s,o,i)}else{const i=new Rre(s,r),a=[[r]];return e.runWebGLProgram(i,[],o,a)}}const Are={kernelName:s1,backendName:"webgl",kernelFunc:yf};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Dre{constructor(e){this.variableNames=["Image"],this.outputShape=[];const n=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${n} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${n}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fre={kernelName:r1,backendName:"webgl",kernelFunc:({inputs:t,backend:e})=>{const{image:n}=t,s=e,r=new Dre(n.shape);return s.runWebGLProgram(r,[n],n.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZS="return floor(x);",Pre=Me({opSnippet:ZS,packedOpSnippet:ZS,cpuKernelImpl:ZJ}),Ore={kernelName:yd,backendName:"webgl",kernelFunc:Pre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lre=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,Mre=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,_re=an({opSnippet:Lre,packedOpSnippet:Mre,dtype:"int32"}),zre={kernelName:vd,backendName:"webgl",kernelFunc:_re};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Vre{constructor(e){this.variableNames=["A"];const n=An(),[s,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}.0, ${s}.0);

        vec4 values = ${n.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Bre{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const n=An(),[s,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${r}.0, ${s}.0);
            vec4 values = ${n.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wre={kernelName:oV,backendName:"webgl",kernelFunc:Ure};let za,ix=K().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function Ure(t){const{inputs:e,backend:n,attrs:s}=t;let{pixels:r}=e;const{numChannels:o}=s,i=typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement,a=typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement,[l,u]=i?[r.videoWidth,r.videoHeight]:[r.width,r.height],c=[u,l],d=[u,l,o];if(a||i){const g=K().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(za==null||g!==ix)&&(ix=g,za=document.createElement("canvas").getContext("2d",{willReadFrequently:ix})),za.canvas.width=l,za.canvas.height=u,za.drawImage(r,0,0,l,u),r=za.canvas}const f=n.makeTensorInfo(c,"int32");n.texData.get(f.dataId).usage=fs.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(f.dataId),r);const h=K().getBool("WEBGL_PACK")?new Bre(d):new Vre(d),p=n.runWebGLProgram(h,[f],"int32");return n.disposeData(f.dataId),p}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gre(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:o,bias:i,preluActivationWeights:a}=e,{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:f,activation:h,leakyreluAlpha:p}=s,g=yo(c),y=rn(r.shape,o.shape,l,d,u,f,!1,g);let m;const x=[],v=i!=null,b=a!=null,$=h==="leakyrelu",C=()=>{const w=[r,o],I=(R,E)=>{if(E==="NCHW"&&R.shape.length===1&&R.shape[0]!==1){const A=oe({inputs:{x:R},backend:n,attrs:{shape:[R.shape[0],1,1]}});return x.push(A),A}return R};if(v&&w.push(I(i,c)),b&&w.push(I(a,c)),$){const R=n.makeTensorInfo([],"float32",di(p,"float32"));w.push(R),x.push(R)}return w};if(y.filterHeight===1&&y.filterWidth===1&&y.dilationHeight===1&&y.dilationWidth===1&&y.strideHeight===1&&y.strideWidth===1&&(y.padInfo.type==="SAME"||y.padInfo.type==="VALID"))m=vO({x:r,filter:o,convInfo:y,backend:n,bias:i,activation:h,preluActivationWeights:a,leakyreluAlpha:p});else if(y.strideWidth<=2&&g==="channelsLast"&&K().getBool("WEBGL_EXP_CONV")){const w=h?Wc(h,!0):null,I=new yO(y,v,w,b,$),R=[[y.padInfo.top,y.padInfo.left],[y.strideHeight,y.strideWidth],[y.dilationHeight,y.dilationWidth],[y.inHeight,y.inWidth]],E=C();m=n.runWebGLProgram(I,E,"float32",R)}else if(K().getBool("WEBGL_CONV_IM2COL"))m=bO({x:r,filter:o,convInfo:y,backend:n,bias:i,activation:h,preluActivationWeights:a,leakyreluAlpha:p});else{const w=h?Wc(h,!1):null,I=new xO(y,v,w,b,$),R=C();m=n.runWebGLProgram(I,R,"float32")}const k=oe({inputs:{x:m},backend:n,attrs:{shape:y.outShape}});return x.push(m),x.forEach(w=>n.disposeIntermediateTensorInfo(w)),k}const Hre={kernelName:fp,backendName:"webgl",kernelFunc:Gre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jre(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:o,bias:i,preluActivationWeights:a}=e,{strides:l,pad:u,dilations:c,dimRoundingMode:d,activation:f,leakyreluAlpha:h}=s,p=[];let g=c;g==null&&(g=[1,1]),N(gn(l,g),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${g}'`);const y=rn(r.shape,o.shape,l,g,u,d,!0),m=K().getBool("WEBGL_PACK_DEPTHWISECONV")&&y.strideWidth<=2&&y.outChannels/y.inChannels===1,x=f?Wc(f,m):null,v=[r,o],b=i!=null,$=a!=null,C=f==="leakyrelu";if(b&&v.push(i),$&&v.push(a),C){const R=n.makeTensorInfo([],"float32",di(h,"float32"));v.push(R),p.push(R)}let k;m?k=new CO(y,b,x,$,C):k=new $O(y,b,x,$,C);const w=[[y.padInfo.top,y.padInfo.left],[y.strideHeight,y.strideWidth],[y.dilationHeight,y.dilationWidth],[y.inHeight,y.inWidth]],I=n.runWebGLProgram(k,v,"float32",w);return p.forEach(R=>n.disposeIntermediateTensorInfo(R)),I}const Kre={kernelName:CN,backendName:"webgl",kernelFunc:jre};class Xre{constructor(e,n,s,r){this.sliceDim=e,this.strides=n,this.paramsShape=r,this.variableNames=["x","indices"],this.outputShape=s;const o=Je(s.length);let i=`
    int index;`;for(let a=0;a<this.sliceDim;a++)i+=`
          index = round(getIndices(coords[0], ${a}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[a]};
          flattenIndex += index * ${this.strides[a]};`;this.userCode=`
         void main() {
          ${o} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${i}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qre(t){const{inputs:e,backend:n}=t,{params:s,indices:r}=e,o=r.shape,i=o[o.length-1],a=Y(s.shape),[l,u,c,d]=uw(s,r),f=oe({inputs:{x:r},backend:n,attrs:{shape:[u,i]}}),h=oe({inputs:{x:s},backend:n,attrs:{shape:[Y(s.shape)/c,c]}});if(n.shouldExecuteOnCPU([s,r])||s.dtype==="string"){const m=n.readSync(r.dataId),x=n.bufferSync(s),v=JJ(m,x,s.dtype,u,i,c,d,s.shape,a);return n.makeTensorInfo(l,s.dtype,v.values)}const p=new Xre(i,d,[u,c],s.shape),g=n.runWebGLProgram(p,[h,f],h.dtype),y=oe({inputs:{x:g},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(g),y}const Yre={kernelName:oN,backendName:"webgl",kernelFunc:qre};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qre{constructor(e,n){this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;const s=Je(this.rank),r=Zre(e);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${r}));
      }
    `}}function Zre(t,e){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[];for(let r=0;r<t.length;r++)r===2?s.push("index"):s.push(`${n[r]}`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IO(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,indices:o}=e,{axis:i,batchDims:a}=s,l=Ne(i,r.shape)[0];if(K().get("DEBUG")){const x=n.readSync(o.dataId),v=r.shape[l];for(let b=0;b<x.length;++b){const $=x[b];N($<=v-1&&$>=0,()=>`GatherV2: the index value ${$} is not in [0, ${v-1}]`)}}const u=Fw(r,o,l,a),c=Y(o.shape),d=[],f=oe({inputs:{x:r},backend:n,attrs:{shape:[u.batchSize,u.outerSize,u.dimSize,u.sliceSize]}}),h=oe({inputs:{x:o},backend:n,attrs:{shape:[u.batchSize,c/u.batchSize]}});d.push(f),d.push(h);const p=[u.batchSize,u.outerSize,c/u.batchSize,u.sliceSize];if(n.shouldExecuteOnCPU([r,o])||r.dtype==="string"){const x=n.bufferSync(h),v=n.bufferSync(f),b=eee(v,x,p);return d.forEach($=>n.disposeIntermediateTensorInfo($)),n.makeTensorInfo(u.outputShape,b.dtype,b.values)}const g=new Qre(f.shape,p),y=n.runWebGLProgram(g,[f,h],f.dtype);d.push(y);const m=oe({inputs:{x:y},backend:n,attrs:{shape:u.outputShape}});return d.forEach(x=>n.disposeIntermediateTensorInfo(x)),m}const Jre={kernelName:Um,backendName:"webgl",kernelFunc:IO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eoe="return float(a > b);",toe=`
  return vec4(greaterThan(a, b));
`,noe=an({opSnippet:eoe,packedOpSnippet:toe,cpuKernelImpl:tee,dtype:"bool"}),soe={kernelName:Gm,backendName:"webgl",kernelFunc:noe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const roe="return float(a >= b);",ooe=`
  return vec4(greaterThanEqual(a, b));
`,ioe=an({opSnippet:roe,packedOpSnippet:ooe,dtype:"bool",cpuKernelImpl:nee}),aoe={kernelName:bd,backendName:"webgl",kernelFunc:ioe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function loe(t){const{inputs:e,backend:n}=t,{input:s}=e;return SO(s,!0,n)}const uoe={kernelName:o1,backendName:"webgl",kernelFunc:loe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const coe="return float(!isnan(x) && !isinf(x));",doe=Me({opSnippet:coe,dtype:"bool"}),foe={kernelName:$d,backendName:"webgl",kernelFunc:doe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hoe="return float(isinf(x));",poe=Me({opSnippet:hoe,dtype:"bool"}),moe={kernelName:Cd,backendName:"webgl",kernelFunc:poe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const goe="return float(isnan(x));",xoe=Me({opSnippet:goe,dtype:"bool"}),yoe={kernelName:kd,backendName:"webgl",kernelFunc:xoe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const voe="return float(a < b);",boe=`
  return vec4(lessThan(a, b));
`,woe=an({opSnippet:voe,packedOpSnippet:boe,cpuKernelImpl:see,dtype:"bool"}),$oe={kernelName:jm,backendName:"webgl",kernelFunc:woe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Coe="return float(a <= b);",koe=`
  return vec4(lessThanEqual(a, b));
`,Soe=an({opSnippet:Coe,packedOpSnippet:koe,cpuKernelImpl:ree,dtype:"bool"}),Ioe={kernelName:Km,backendName:"webgl",kernelFunc:Soe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Toe(t){const{backend:e,attrs:n}=t,{start:s,stop:r,num:o}=n,i=oee(s,r,o);return e.makeTensorInfo([i.length],"float32",i)}const Eoe={kernelName:iN,backendName:"webgl",kernelFunc:Toe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Noe=uu+`
  return x < 0.0 ? 0./0. : log(x);
`,Roe=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,Aoe=Me({opSnippet:Noe,packedOpSnippet:Roe,cpuKernelImpl:iee}),Doe={kernelName:Sd,backendName:"webgl",kernelFunc:Aoe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Foe=uu+`
  return log(1.0 + x);
`,Poe=Me({opSnippet:Foe}),Ooe={kernelName:Id,backendName:"webgl",kernelFunc:Poe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Loe="return float(a >= 1.0 && b >= 1.0);",Moe=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,_oe=an({opSnippet:Loe,packedOpSnippet:Moe,dtype:"bool"}),zoe={kernelName:Xm,backendName:"webgl",kernelFunc:_oe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Voe="return float(!(x >= 1.0));",Boe=Me({opSnippet:Voe}),Woe={kernelName:qm,backendName:"webgl",kernelFunc:Boe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uoe="return float(a >= 1.0 || b >= 1.0);",Goe=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,Hoe=an({opSnippet:Uoe,packedOpSnippet:Goe,dtype:"bool"}),joe={kernelName:Ym,backendName:"webgl",kernelFunc:Hoe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Koe{constructor(e,n,s,r,o){this.variableNames=["x"],this.outputShape=[];const i=n,a=e[3]-1;this.outputShape=e;let l;const u=`float(${s}) + float(${r}) * sum`;o===.5?l=`inversesqrt(${u})`:o===1?l=`1.0/(${u})`:l=`exp(log(${u}) * float(-${o}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${i}; j <= ${i}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${a}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xoe{constructor(e,n,s,r,o){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const i=n,a=e[3]-1;this.outputShape=e;let l;const u=`float(${s}) + float(${r}) * sum`;o===.5?l=`inversesqrt(${u})`:o===1?l=`1.0/(${u})`:l=`exp(log(${u}) * float(-${o}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${i};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${i}; j <= ${i}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${a}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qoe=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{depthRadius:o,bias:i,alpha:a,beta:l}=s,u=K().getBool("WEBGL_PACK_NORMALIZATION")?new Xoe(r.shape,o,i,a,l):new Koe(r.shape,o,i,a,l);return n.runWebGLProgram(u,[r],r.dtype)},Yoe={kernelName:Qm,backendName:"webgl",kernelFunc:qoe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qoe{constructor(e,n,s,r,o){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=n,this.bias=s,this.alpha=r,this.beta=o,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${n})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${n} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${r}) * norm + float(${s});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${r})
                * float(${o})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${o});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zoe=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r,y:o,dy:i}=e,{depthRadius:a,bias:l,alpha:u,beta:c}=s,d=new Qoe(r.shape,a,l,u,c);return n.runWebGLProgram(d,[r,o,i],r.dtype)},Joe={kernelName:a1,backendName:"webgl",kernelFunc:Zoe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eie(t,e,n,s){const r=Y(e),i=Y(t.shape)/r,a=oe({inputs:{x:t},attrs:{shape:[i,r]},backend:s}),l=Fa(a,t.dtype,"max",s),u=oe({inputs:{x:l},attrs:{shape:n},backend:s});return s.disposeIntermediateTensorInfo(a),s.disposeIntermediateTensorInfo(l),u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TO(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reductionIndices:o,keepDims:i}=s,a=r.shape.length,l=Ne(o,r.shape);let u=l;const c=vt(u,a),d=c!=null,f=n.shouldExecuteOnCPU([r]);let h=r;if(d){if(f){const v=n.texData.get(h.dataId).values,b=new Array(a);for(let k=0;k<b.length;k++)b[k]=r.shape[c[k]];const $=m$(v,r.shape,r.dtype,c,b);h=n.makeTensorInfo(b,r.dtype);const C=n.texData.get(h.dataId);C.values=$}else h=Zg(r,c,n);u=Nt(u.length,a)}on("max",u,a);const[p,g]=Jt(h.shape,u);let y=p;i&&(y=Lt(p,l));let m;if(f){const v=n.texData.get(h.dataId).values,b=aee(v,Y(g),y,r.dtype);m=n.makeTensorInfo(y,r.dtype);const $=n.texData.get(m.dataId);$.values=b}else m=eie(h,g,y,n);return d&&n.disposeIntermediateTensorInfo(h),m}const tie={kernelName:Zm,backendName:"webgl",kernelFunc:TO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nie=g$+`
  return max(a, b);
`,sie=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Da+`
  return result;
`,rie=an({opSnippet:nie,packedOpSnippet:sie,cpuKernelImpl:lee}),oie={kernelName:Td,backendName:"webgl",kernelFunc:rie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iie(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;mf(r,"maxPool");const{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=s,u=1;N(gn(i,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const c=Gs(r.shape,o,i,u,a,l);if(c.filterWidth===1&&c.filterHeight===1&&He(c.inShape,c.outShape))return os({inputs:{x:r},backend:n});const d=new Uc(c,"max",!1);return n.runWebGLProgram(d,[r],r.dtype)}const aie={kernelName:Jm,backendName:"webgl",kernelFunc:iie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lie(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:o,strides:i,pad:a,dataFormat:l,dimRoundingMode:u}=s,c=[1,1,1],d=xo(r.shape,o,i,c,a,u,l),f=new y$(d,"max",!1);return n.runWebGLProgram(f,[r],r.dtype)}const uie={kernelName:eg,backendName:"webgl",kernelFunc:lie};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cie{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideHeight,s=e.strideWidth,r=e.dilationHeight,o=e.effectiveFilterHeight,i=e.effectiveFilterWidth,a=o-1-e.padInfo.top,l=i-1-e.padInfo.left,u=o*i-1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${o};
          wR += ${r}) {
          float dyR = float(dyRCorner + wR) / ${n}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${i}; wC++) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${u} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${i} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class die{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideDepth,s=e.strideHeight,r=e.strideWidth,o=e.dilationDepth,i=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterDepth,u=e.effectiveFilterHeight,c=e.effectiveFilterWidth,d=l-1-e.padInfo.front,f=u-1-e.padInfo.top,h=c-1-e.padInfo.left,p=l*u*c-1;this.userCode=`
      const ivec3 pads = ivec3(${d}, ${f}, ${h});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${o}) {
          float dyD = float(dyDCorner + wD) / ${n}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${u};
              wR += ${i}) {
            float dyR = float(dyRCorner + wR) / ${s}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${c};
                wC += ${a}) {
              float dyC = float(dyCCorner + wC) / ${r}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${p} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${u} * ${c} +
                  wR * ${c} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fie(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:o}=e,i=o,{filterSize:a,strides:l,pad:u,dimRoundingMode:c}=s,d=[1,1,1],f=xo(i.shape,a,l,d,u,c),h=new y$(f,"max",!0),p=n.runWebGLProgram(h,[i],i.dtype),g=new die(f),y=n.runWebGLProgram(g,[r,p],i.dtype);return n.disposeIntermediateTensorInfo(p),y}const hie={kernelName:u1,backendName:"webgl",kernelFunc:fie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pie(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:o,output:i}=e,a=o;mf([o,i],"maxPoolGrad");const{filterSize:l,strides:u,pad:c,dimRoundingMode:d}=s,f=Gs(a.shape,l,u,1,c,d),h=!0,p=new Uc(f,"max",h),g=n.runWebGLProgram(p,[a],a.dtype),y=new cie(f),m=n.runWebGLProgram(y,[r,g],a.dtype);return n.disposeIntermediateTensorInfo(g),m}const mie={kernelName:l1,backendName:"webgl",kernelFunc:pie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gie(t,e,n,s){let r=new Uc(n,"max",!1);const o=s.runWebGLProgram(r,[t],"float32");r=new Uc(n,"max",!0,!0,e);const i=s.runWebGLProgram(r,[t],"float32");return[o,i]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xie={kernelName:aN,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{filterSize:r,strides:o,pad:i,includeBatchInIndex:a}=e,l=n;N(s.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${s.shape.length}.`);const u=[1,1];N(gn(o,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const c=Gs(s.shape,r,o,u,i),[d,f]=gie(s,a,c,l);return[d,f]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yie(t,e,n,s){const r=Y(e),i=Y(t.shape)/r,a=oe({inputs:{x:t},attrs:{shape:[i,r]},backend:s}),l=Fa(a,"float32","mean",s),u=oe({inputs:{x:l},attrs:{shape:n},backend:s});return s.disposeIntermediateTensorInfo(a),s.disposeIntermediateTensorInfo(l),u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vie={kernelName:tg,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{keepDims:r,axis:o}=e,i=n,a=s.shape.length,l=Ne(o,s.shape);let u=l;const c=vt(u,a),d=c!=null,f=i.shouldExecuteOnCPU([s]),h=[];let p=s;if(d){if(f){const b=i.texData.get(p.dataId).values,$=new Array(a);for(let w=0;w<$.length;w++)$[w]=s.shape[c[w]];const C=m$(b,s.shape,s.dtype,c,$);p=i.makeTensorInfo($,s.dtype);const k=i.texData.get(p.dataId);k.values=C}else p=Zg(s,c,i);h.push(p),u=Nt(u.length,a)}on("sum",u,a);const[g,y]=Jt(p.shape,u);let m=g;r&&(m=Lt(g,l));const x=yie(p,y,m,i);for(const v of h)i.disposeIntermediateTensorInfo(v);return x}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bie(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,keepDims:i}=s,a=r.shape.length,l=Ne(o,r.shape);let u=l;const c=vt(u,a);let d=r;c!=null&&(d=Rn({inputs:{x:r},backend:n,attrs:{perm:c}}),u=Nt(u.length,r.shape.length)),on("min",u,a);const[f,h]=Jt(d.shape,u),p=Y(h),g=oe({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}}),y=Fa(g,g.dtype,"min",n);let m;if(i){const x=Lt(f,l);m=oe({inputs:{x:y},backend:n,attrs:{shape:x}})}else m=oe({inputs:{x:y},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),c!=null&&n.disposeIntermediateTensorInfo(d),m}const wie={kernelName:ng,backendName:"webgl",kernelFunc:bie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $ie=g$+`
  return min(a, b);
`,Cie=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Da+`
  return result;
`,kie=an({opSnippet:$ie,packedOpSnippet:Cie,cpuKernelImpl:uee}),Sie={kernelName:Ed,backendName:"webgl",kernelFunc:kie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Iie{constructor(e,n,s){this.variableNames=["x"],this.outputShape=n.map((c,d)=>c[0]+e[d]+c[1]);const r=e.length,o=Je(r),i=n.map(c=>c[0]).join(","),a=n.map((c,d)=>c[0]+e[d]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r),u=s==="reflect"?0:1;if(r===1){this.userCode=`
        int start = ${i};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${u};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${u};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${o} start = ${o}(${i});
      ${o} end = ${o}(${a});

      void main() {
        ${o} outC = getOutputCoords();
        for (int i = 0; i < ${r}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${u};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${u};
          }
        }
        ${o} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tie{constructor(e,n,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((p,g)=>p[0]+e[g]+p[1]);const r=e.length,o=Je(r),i=n.map(p=>p[0]).join(","),a=n.map((p,g)=>p[0]+e[g]).join(","),l=In("rc",r),u=In("source",r),c=`${l[r-1]} < ${this.outputShape[r-1]}`,d=r===1?"source":`vec2(${u.slice(-2).join()})`,f=s==="reflect"?0:1;let h="";if(r===1){const p=`
        ${o} source = rc;
        if (source < start) {
          source = start * 2 - source - ${f};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${f};
        }
        source -= start;
      `;h=`
        ${o} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${u.join()}), ${d});
        ${l[r-1]} += 1;
        if(${c}) {
          ${p}
          result[1] = getChannel(getX(${u.join()}), ${d});
        }
      `}else{const p=`
        ${o} source = rc;
        ${o} lt = ${o}(lessThan(source, start));
        ${o} gte = ${o}(greaterThanEqual(source, end));
        ${o} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${f}) +
                gte * ((end - 1) * 2 - source + ${f});
        source -= start;
      `;h=`
        ${o} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${u.join()}), ${d});
        ${l[r-1]} += 1;
        if(${c}) {
          ${p}
          result[1] = getChannel(getX(${u.join()}), ${d});
        }
        rc = outputLoc;
        ${l[r-2]} += 1;
        if(${l[r-2]} < ${this.outputShape[r-2]}) {
          ${p}
          result[2] = getChannel(getX(${u.join()}), ${d});
          ${l[r-1]} += 1;
          if(${c}) {
            ${p}
            result[3] = getChannel(getX(${u.join()}), ${d});
          }
        }
      `}this.userCode=`
      const ${o} start = ${o}(${i});
      const ${o} end = ${o}(${a});

      void main() {
        ${o} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${h}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eie=({inputs:t,backend:e,attrs:n})=>{const{x:s}=t,{paddings:r,mode:o}=n,i=K().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Tie(s.shape,r,o):new Iie(s.shape,r,o);return e.runWebGLProgram(i,[s],s.dtype)},Nie={kernelName:sg,backendName:"webgl",kernelFunc:Eie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rie=`if (b == 0.0) return NAN;
  return mod(a, b);`,Aie=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+Da+`
  return result;
`,Die=an({opSnippet:Rie,packedOpSnippet:Aie}),Fie={kernelName:Nd,backendName:"webgl",kernelFunc:Die};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Pie{constructor(e,n,s){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,s],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${n-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${n-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oie=`
if (a == b) {
  return 1.0;
};
return a / b;`,Lie=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,EO=an({opSnippet:Oie,packedOpSnippet:Lie,checkOutOfBounds:!0}),Mie={kernelName:hd,backendName:"webgl",kernelFunc:EO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JS="return a - b;",NO=an({opSnippet:JS,packedOpSnippet:JS,supportsComplex:!0,cpuKernelImpl:Ree}),_ie={kernelName:Hd,backendName:"webgl",kernelFunc:NO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RO(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{dim:o}=s,i=Ne([o],r.shape),a=TO({inputs:{x:r},backend:n,attrs:{reductionIndices:i,keepDims:!1}}),l=Lt(a.shape,i),u=oe({inputs:{x:a},backend:n,attrs:{shape:l}}),c=NO({inputs:{a:r,b:u},backend:n}),d=kO({inputs:{x:c},backend:n}),f=Jg({inputs:{x:d},backend:n,attrs:{axis:i,keepDims:!1}}),h=oe({inputs:{x:f},backend:n,attrs:{shape:l}}),p=EO({inputs:{a:d,b:h},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(h),p}const zie={kernelName:wg,backendName:"webgl",kernelFunc:RO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vie(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{numSamples:o,seed:i,normalized:a}=s,l=a?r:RO({inputs:{logits:r},backend:n,attrs:{dim:r.shape.length-1}}),u=l.shape[0],c=l.shape[1],d=new Pie(u,c,o),f=[[i]],h=n.runWebGLProgram(d,[l],"int32",f);return a||n.disposeIntermediateTensorInfo(l),h}const Bie={kernelName:lN,backendName:"webgl",kernelFunc:Vie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wie=js+`
  return -x;
`,Uie=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function Gie(t){const{inputs:e,backend:n}=t,{x:s}=e;if(n.shouldExecuteOnCPU([s])){const o=n.texData.get(s.dataId),[i,a]=dee(o.values,s.shape,s.dtype);return n.makeTensorInfo(a,s.dtype,i)}let r;return K().getBool("WEBGL_PACK_UNARY_OPERATIONS")?r=new Mo(s.shape,Uie):r=new Ir(s.shape,Wie),n.runWebGLProgram(r,[s],s.dtype)}const Hie={kernelName:rg,backendName:"webgl",kernelFunc:Gie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jie=rw;function Kie(t){cs("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l}=s,u=n.readSync(r.dataId),c=n.readSync(o.dataId),{selectedIndices:d}=jie(u,c,i,a,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const Xie={kernelName:c1,backendName:"webgl",kernelFunc:Kie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qie=ow;function Yie(t){cs("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:u}=s,c=n.readSync(r.dataId),d=n.readSync(o.dataId),{selectedIndices:f,validOutputs:h}=qie(c,d,i,a,l,u);return[n.makeTensorInfo([f.length],"int32",new Int32Array(f)),n.makeTensorInfo([],"int32",new Int32Array([h]))]}const Qie={kernelName:d1,backendName:"webgl",kernelFunc:Yie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zie=iw;function Jie(t){cs("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,softNmsSigma:u}=s,c=n.readSync(r.dataId),d=n.readSync(o.dataId),f=i,h=a,p=l,g=u,{selectedIndices:y,selectedScores:m}=Zie(c,d,f,h,p,g);return[n.makeTensorInfo([y.length],"int32",new Int32Array(y)),n.makeTensorInfo([m.length],"float32",new Float32Array(m))]}const eae={kernelName:f1,backendName:"webgl",kernelFunc:Jie};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tae{constructor(e,n,s,r){this.variableNames=["indices"],this.outputShape=[e,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${r}), float(${s}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nae=t=>{const{inputs:e,backend:n,attrs:s}=t,{indices:r}=e,{dtype:o,depth:i,onValue:a,offValue:l}=s,u=Y(r.shape),c=new tae(u,i,a,l),d=oe({inputs:{x:r},backend:n,attrs:{shape:[u]}}),f=n.runWebGLProgram(c,[d],o);n.disposeIntermediateTensorInfo(d);const h=[...r.shape,i],p=oe({inputs:{x:f},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(f),p},sae={kernelName:ag,backendName:"webgl",kernelFunc:nae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _p(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="complex64"){const r=xf({inputs:{input:s},backend:n}),o=_p({inputs:{x:r},backend:n}),i=e0({inputs:{input:s},backend:n}),a=_p({inputs:{x:i},backend:n}),l=yi({inputs:{real:o,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),l}else return yf({attrs:{shape:s.shape,dtype:s.dtype,value:s.dtype==="string"?"":0},backend:n})}const rae={kernelName:kg,backendName:"webgl",kernelFunc:_p};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AO(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(s.dtype==="complex64"){const r=xf({inputs:{input:s},backend:n}),o=AO({inputs:{x:r},backend:n}),i=e0({inputs:{input:s},backend:n}),a=_p({inputs:{x:i},backend:n}),l=yi({inputs:{real:o,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),l}else return yf({attrs:{shape:s.shape,dtype:s.dtype,value:1},backend:n})}const oae={kernelName:ig,backendName:"webgl",kernelFunc:AO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iae(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s;if(e.length===1)return nv({inputs:{input:e[0]},backend:n,attrs:{dim:r}});const o=e[0].shape,i=e[0].dtype;e.forEach(c=>{Fb(o,c.shape,"All tensors passed to stack must have matching shapes"),N(i===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(c=>{const d=nv({inputs:{input:c},backend:n,attrs:{dim:r}});return a.push(d),d}),u=gO({inputs:l,backend:n,attrs:{axis:r}});return a.forEach(c=>n.disposeIntermediateTensorInfo(c)),u}const aae={kernelName:lg,backendName:"webgl",kernelFunc:iae};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lae{constructor(e,n,s){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((u,c)=>u[0]+e[c]+u[1]);const r=e.length,o=Je(r),i=n.map(u=>u[0]).join(","),a=n.map((u,c)=>u[0]+e[c]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);if(r===1){this.userCode=`
        int start = ${i};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${o} start = ${o}(${i});
      ${o} end = ${o}(${a});

      void main() {
        ${o} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${o} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uae{constructor(e,n,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((g,y)=>g[0]+e[y]+g[1]);const r=e.length,o=Je(r),i=n.map(g=>g[0]).join(","),a=n.map((g,y)=>g[0]+e[y]).join(","),l=In("rc",r),u=In("source",r),c=`${l[r-1]} < ${this.outputShape[r-1]}`,d=r===1?"source":`vec2(${u.slice(-2).join()})`,f=[`${o} rc = outputLoc;`,`${l[r-1]} += 1;
       if(${c}) {
      `,r===1?"":`}
       rc = outputLoc;
       ${l[r-2]} += 1;
       if(${l[r-2]} < ${this.outputShape[r-2]}) {`,r===1?"":`  ${l[r-1]} += 1;
         if(${c}) {`],h=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let p="";for(let g=0,y=r===1?2:4;g<y;g++)p+=`
        ${f[g]}
        if (${h}) {
          result[${g}] = float(value);
        } else {
          ${o} source = rc - start;
          result[${g}] = getChannel(getX(${u.join()}), ${d});
        }
      `;p+=r===1?"} ":"}}",this.userCode=`
      const ${o} start = ${o}(${i});
      const ${o} end = ${o}(${a});

      void main() {
        ${o} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${p}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DO=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{paddings:o,constantValue:i}=s;if(Y(r.shape)===0){const u=o.map((c,d)=>c[0]+r.shape[d]+c[1]);return yf({backend:n,attrs:{shape:u,value:i,dtype:r.dtype}})}const a=K().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new uae(r.shape,o,i):new lae(r.shape,o,i),l=[[i]];return n.runWebGLProgram(a,[r],r.dtype,l)},cae={kernelName:ug,backendName:"webgl",kernelFunc:DO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dae=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,fae=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+Da+`
  return result;
`,hae=an({opSnippet:dae,packedOpSnippet:fae}),pae={kernelName:Ad,backendName:"webgl",kernelFunc:hae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mae(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,keepDims:i}=s,a=r.shape.length,l=[],u=Ne(o,r.shape);let c=u;const d=vt(c,a);let f=r;d!=null&&(f=Rn({inputs:{x:r},backend:n,attrs:{perm:d}}),c=Nt(c.length,a),l.push(f)),on("prod",c,a);let h;if(n.shouldExecuteOnCPU([f])){const p=n.texData.get(f.dataId).values,{outVals:g,outShape:y,outDtype:m}=hee(f.shape,f.dtype,p,c);h=n.makeTensorInfo(y,m,g)}else{const[p,g]=Jt(f.shape,c),y=Y(g),m=oe({inputs:{x:f},backend:n,attrs:{shape:[-1,y]}}),x=S1(r.dtype),v=Fa(m,x,"prod",n);h=oe({inputs:{x:v},backend:n,attrs:{shape:p}}),l.push(m),l.push(v)}if(i){l.push(h);const p=Lt(h.shape,u);h=oe({inputs:{x:h},backend:n,attrs:{shape:p}})}return l.forEach(p=>n.disposeIntermediateTensorInfo(p)),h}const gae={kernelName:dg,backendName:"webgl",kernelFunc:mae};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xae(t){const{inputs:e,backend:n,attrs:s}=t,{paramsNestedSplits:r,paramsDenseValues:o,indices:i}=e,{outputRaggedRank:a}=s,l=r.map(m=>n.readSync(m.dataId)),u=r.map(m=>m.shape),c=n.readSync(o.dataId),d=n.readSync(i.dataId),[f,h,p]=pee(l,u,c,o.shape,o.dtype,d,i.shape,a),g=f.map(m=>n.makeTensorInfo([m.length],"int32",m)),y=n.makeTensorInfo(p,o.dtype,h);return g.concat([y])}const yae={kernelName:uN,backendName:"webgl",kernelFunc:xae};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vae(t){const{inputs:e,backend:n}=t,{starts:s,limits:r,deltas:o}=e,i=n.readSync(s.dataId),a=n.readSync(r.dataId),l=n.readSync(o.dataId),[u,c]=mee(i,s.shape,s.dtype,a,r.shape,l,o.shape),d=n.makeTensorInfo([u.length],"int32",u),f=n.makeTensorInfo([c.length],s.dtype,c);return[d,f]}const bae={kernelName:cN,backendName:"webgl",kernelFunc:vae};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wae(t){const{inputs:e,backend:n,attrs:s}=t,{shape:r,values:o,defaultValue:i,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=s,u=n.readSync(r.dataId),c=n.readSync(o.dataId),d=n.readSync(i.dataId),f=a.map(y=>n.readSync(y.dataId)),h=a.map(y=>y.shape),[p,g]=gee(u,r.shape,c,o.shape,o.dtype,d,i.shape,f,h,l);return n.makeTensorInfo(p,o.dtype,g)}const $ae={kernelName:dN,backendName:"webgl",kernelFunc:wae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FO=t=>{const{backend:e,attrs:n}=t,{start:s,stop:r,step:o,dtype:i}=n,a=xee(s,r,o,i);return e.makeTensorInfo([a.length],i,a)},Cae={kernelName:h1,backendName:"webgl",kernelFunc:FO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kae="return 1.0 / x;",Sae=Me({opSnippet:kae}),Iae={kernelName:Dd,backendName:"webgl",kernelFunc:Sae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tae=js+`
  return (x < 0.0) ? 0.0 : x;
`,Eae=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Nae=Me({opSnippet:Tae,packedOpSnippet:Eae}),Rae={kernelName:Fd,backendName:"webgl",kernelFunc:Nae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Aae=js+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Dae=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Fae=Me({opSnippet:Aae,packedOpSnippet:Dae}),Pae={kernelName:Pd,backendName:"webgl",kernelFunc:Fae};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Oae{constructor(e,n,s,r,o){this.variableNames=["A"],this.outputShape=[];const[i,a,l,u]=e;this.outputShape=[i,n,s,u];const c=[r&&n>1?a-1:a,r&&s>1?l-1:l],d=[r&&n>1?n-1:n,r&&s>1?s-1:s];let f;o?f="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":f="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/d[0]},
          ${c[1]/d[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${f};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Lae{constructor(e,n,s,r,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,a,l,u]=e;this.outputShape=[i,n,s,u];const c=[r&&n>1?a-1:a,r&&s>1?l-1:l],d=[r&&n>1?n-1:n,r&&s>1?s-1:s];let f;o?f="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":f="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/d[0]},
          ${c[1]/d[1]},
          ${c[1]/d[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${f};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${s-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mae(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:o,halfPixelCenters:i,size:a}=s,[l,u]=a,c=K().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Lae(r.shape,l,u,o,i):new Oae(r.shape,l,u,o,i);return n.runWebGLProgram(c,[r],"float32")}const _ae={kernelName:pg,backendName:"webgl",kernelFunc:Mae};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zae{constructor(e,n,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,r,o]=n,[,i,a]=e,l=[s&&i>1?r-1:r,s&&a>1?o-1:o],u=[s&&i>1?i-1:i,s&&a>1?a-1:a],c=l[0]/u[0],d=l[1]/u[1],f=1/c,h=1/d,p=Math.ceil(f)*2+2,g=Math.ceil(h)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${d});

        const float invHeightScale = float(${f});
        const float invWidthScale = float(${h});

        const int winHeight = int(${p});
        const int winWidth = int(${g});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${r-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${o-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vae(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:o}=e,{alignCorners:i}=s,a=new zae(o.shape,r.shape,i);return n.runWebGLProgram(a,[o],o.dtype)}const Bae={kernelName:g1,backendName:"webgl",kernelFunc:Vae};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wae{constructor(e,n,s,r,o){this.variableNames=["A"],this.outputShape=[];const[i,a,l,u]=e;this.outputShape=[i,n,s,u];const c=[r&&n>1?a-1:a,r&&s>1?l-1:l],d=[r&&n>1?n-1:n,r&&s>1?s-1:s],f=r?"0.5":"0.0";let h;o?h="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":h="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/d[0]},
          ${c[1]/d[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${h};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${f})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Uae{constructor(e,n,s,r,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,a,l,u]=e;this.outputShape=[i,n,s,u];const c=[r&&n>1?a-1:a,r&&s>1?l-1:l],d=[r&&n>1?n-1:n,r&&s>1?s-1:s],f=r?"0.5":"0.0";let h;o?h="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":h="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/d[0]},
          ${c[1]/d[1]},
          ${c[1]/d[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${h};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${f})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${s-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gae(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:o,halfPixelCenters:i,size:a}=s,[l,u]=a,c=K().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Uae(r.shape,l,u,o,i):new Wae(r.shape,l,u,o,i);return n.runWebGLProgram(c,[r],r.dtype)}const Hae={kernelName:hg,backendName:"webgl",kernelFunc:Gae};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jae{constructor(e,n,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,r,o]=n,[,i,a]=e,l=[s&&i>1?r-1:r,s&&a>1?o-1:o],u=[s&&i>1?i-1:i,s&&a>1?a-1:a],c=l[0]/u[0],d=l[1]/u[1],f=1/c,h=1/d,p=Math.ceil(f)*2+2,g=Math.ceil(h)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${d});

        const float invHeightScale = float(${f});
        const float invWidthScale = float(${h});

        const int winHeight = int(${p});
        const int winWidth = int(${g});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${u[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${u[1]}));

            int sourceNearestRow = int(min(
                float(int(${r}) - 1),
                ${s} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${o}) - 1),
                ${s} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kae(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:o}=e,{alignCorners:i}=s,a=new jae(o.shape,r.shape,i);return n.runWebGLProgram(a,[o],o.dtype)}const Xae={kernelName:m1,backendName:"webgl",kernelFunc:Kae};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qae{constructor(e,n){this.variableNames=["x"];const s=e.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);if(this.outputShape=e,s===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}const r=a=>n.indexOf(a)!==-1&&e[a]!==1?`${e[a]} - coords[${a}] - 1`:`coords[${a}]`,o=e.map((a,l)=>r(l)).join(","),i=Je(s);this.userCode=`
      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${o}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Yae{constructor(e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const s=e.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);this.outputShape=e;const r=In("rc",s),o=`${r[s-1]} + 1 < ${this.outputShape[s-1]}`,i=`${r[s-2]} + 1 < ${this.outputShape[s-2]}`,a=Je(s);s===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${o}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${a} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(r.slice())};
          if(${o}){
            result.g = ${u(r.slice())};
          }
          if(${i}) {
            result.b = ${c(r.slice())};
            if(${o}) {
              result.a = ${d(r.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(p){return f(p)}function u(p){return p[s-1]="("+p[s-1]+" + 1)",f(p)}function c(p){return p[s-2]="("+p[s-2]+" + 1)",f(p)}function d(p){return p[s-1]="("+p[s-1]+" + 1)",p[s-2]="("+p[s-2]+" + 1)",f(p)}function f(p){const g=e.map((x,v)=>h(v,p)),y=g.join(","),m=g.slice(-2).join(",");return`getChannel(getX(${y}), vec2(${m}))`}function h(p,g){return n.indexOf(p)!==-1&&e[p]!==1?`${e[p]} - ${g[p]} - 1`:`${g[p]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qae(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dims:o}=s,i=r.shape.length,a=Ne(o,r.shape);if(i===0)return os({inputs:{x:r},backend:n});const l=K().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Yae(r.shape,a):new qae(r.shape,a);return n.runWebGLProgram(l,[r],r.dtype)}const Zae={kernelName:mg,backendName:"webgl",kernelFunc:Qae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jae{constructor(e,n){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const s=e[1],r=e[2];this.outputShape=e;let o="";typeof n=="number"?o=`float outputValue = ${n.toFixed(2)};`:o=`
        vec3 fill = vec3(${n.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${o}
          if(coordX >= 0 && coordX < ${r} && coordY >= 0 && coordY < ${s}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ele={kernelName:C1,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,{radians:r,fillValue:o,center:i}=e,a=n,l=new Jae(s.shape,o),[u,c]=xw(i,s.shape[1],s.shape[2]),d=[[u,c,Math.sin(r),Math.cos(r)]];return a.runWebGLProgram(l,[s],s.dtype,d)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tle=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,nle=Me({opSnippet:tle}),sle={kernelName:Od,backendName:"webgl",kernelFunc:nle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rle="return inversesqrt(x);",ole=Me({opSnippet:rle,cpuKernelImpl:yee}),ile={kernelName:Ld,backendName:"webgl",kernelFunc:ole};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class v${constructor(e,n,s,r,o,i,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;const u=Je(o.length),c=Je(i.length);let d="";s===1?d="i":s===2&&(d="i, j");const f=`getIndices(${d})`;let h="";r===1?h="i":r===2&&(h="i, coords[1]");const p=`getUpdates(${h})`;let g="";l&&(g="coords[0], coords[1]");const y=`getDefaultValue(${g})`,m=n>1?"strides[j]":"strides";this.userCode=`
        ${u} strides = ${u}(${o});

        void main() {
          ${c} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${n}; j++) {
              int index = round(${f});
              flattenedIndex += index * ${m};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${p};
              found = true;
            }
          }
          setOutput(mix(${y}, sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ale{constructor(e,n,s,r,o,i,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=i;const u=Je(o.length),c=Je(i.length);let d="";s===1?d="i":s===2&&(d="i, j");const f=`getIndices(${d})`;let h="";r===1?h="i":r===2&&(h="i, coords[1]");const p=`getUpdates(${h})`;let g="";l&&(g="coords[0], coords[1]");const y=`getDefaultValue(${g})`,m=n>1?"strides[j]":"strides",x=n>1?"strides[j + 1]":"strides";this.userCode=`
        ${u} strides = ${u}(${o});

        void main() {
          ${c} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${e}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${n}; j+=2) {
              ivec4 index = round(${f});
              flattenedIndex += index.xz * ${m};
              if (j + 1 < ${n}) {
                flattenedIndex += index.yw * ${x};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${p};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${y}, sum, found));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lle(t){const{inputs:e,backend:n,attrs:s}=t,{indices:r,updates:o}=e,{shape:i}=s,{sliceRank:a,numUpdates:l,sliceSize:u,strides:c,outputSize:d}=Ta(o,r,i),f=[d/u,u];if(d===0)return n.makeTensorInfo(i,r.dtype);const h=oe({inputs:{x:r},backend:n,attrs:{shape:[l,a]}}),p=oe({inputs:{x:o},backend:n,attrs:{shape:[l,u]}}),g=n.makeTensorInfo([],"float32",new Float32Array([0]));let y;K().getBool("WEBGL_PACK")?y=new ale(l,a,h.shape.length,p.shape.length,c,f):y=new v$(l,a,h.shape.length,p.shape.length,c,f);const m=n.runWebGLProgram(y,[p,h,g],p.dtype),x=oe({inputs:{x:m},backend:n,attrs:{shape:i}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),x}const ule={kernelName:fN,backendName:"webgl",kernelFunc:lle};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cle{constructor(e,n,s,r){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,s];const o="while (left < right) {",i=`for (int i = 0; i < ${Math.ceil(Math.log2(n+1))}; ++i) { if (left >= right) break;`,a=K().getNumber("WEBGL_VERSION")===2?o:i,l=r==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${a}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${l} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dle(t){const{inputs:e,backend:n,attrs:s}=t,{sortedSequence:r,values:o}=e,{side:i}=s,a=new cle(r.shape[0],r.shape[1],o.shape[1],i),l=[[r.shape[1]]];return n.runWebGLProgram(a,[r,o],"int32",l)}const fle={kernelName:pN,backendName:"webgl",kernelFunc:dle};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hle{constructor(e,n,s){this.variableNames=["c","a","b"],this.outputShape=n;let r,o;if(s>4)throw Error(`Where for rank ${s} is not yet supported`);if(s===1)o="resRC",r="resRC";else{const a=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],u=[];for(let c=0;c<n.length;c++)u.push(`${a[c]}`),c<e&&l.push(`${a[c]}`);r=l.join(),o=u.join()}const i=Je(s);this.userCode=`
      void main() {
        ${i} resRC = getOutputCoords();
        float cVal = getC(${r});
        if (cVal >= 1.0) {
          setOutput(getA(${o}));
        } else {
          setOutput(getB(${o}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ple(t){const{inputs:e,backend:n}=t,{condition:s,t:r,e:o}=e,i=new hle(s.shape.length,r.shape,r.shape.length);return n.runWebGLProgram(i,[s,r,o],ss(r.dtype,o.dtype))}const mle={kernelName:gg,backendName:"webgl",kernelFunc:ple};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gle=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${Lg};
  float scale = ${Mg};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,xle=Me({opSnippet:gle}),yle={kernelName:Md,backendName:"webgl",kernelFunc:xle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vle=uu+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,ble=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,wle=Me({opSnippet:vle,packedOpSnippet:ble,cpuKernelImpl:bee}),$le={kernelName:Bd,backendName:"webgl",kernelFunc:wle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cle=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,kle=Me({opSnippet:Cle}),Sle={kernelName:Vd,backendName:"webgl",kernelFunc:kle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ile=uu+`
  return sin(x);
`,Tle=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${Da}
  return result;
`,Ele=Me({opSnippet:Ile,packedOpSnippet:Tle}),Nle={kernelName:_d,backendName:"webgl",kernelFunc:Ele};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rle=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,Ale=Me({opSnippet:Rle}),Dle={kernelName:zd,backendName:"webgl",kernelFunc:Ale};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fle=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,Ple=Me({opSnippet:Fle}),Ole={kernelName:Wd,backendName:"webgl",kernelFunc:Ple};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lle=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:o,paddings:i}=s;N(r.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const a=o.reduce((m,x)=>m*x),l=[[0,0]];l.push(...i);for(let m=1+o.length;m<r.shape.length;++m)l.push([0,0]);const u=[],c=DO({inputs:{x:r},backend:n,attrs:{paddings:l,constantValue:0}}),d=tf(c.shape,o,a,!1),f=nf(d.length,o.length,!1),h=sf(c.shape,o,a,!1),p=oe({inputs:{x:c},backend:n,attrs:{shape:d}}),g=Rn({inputs:{x:p},backend:n,attrs:{perm:f}}),y=oe({inputs:{x:g},backend:n,attrs:{shape:h}});return u.push(c),u.push(p),u.push(g),u.forEach(m=>n.disposeIntermediateTensorInfo(m)),y},Mle={kernelName:vg,backendName:"webgl",kernelFunc:Lle};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _le(t){const{inputs:e,backend:n}=t,{indices:s,values:r,denseShape:o,defaultValue:i}=e;if(o.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${o.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${s.shape}`);if(r.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${r.shape}`);if(i.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${i.shape}`);const a=n.readSync(s.dataId),l=n.readSync(r.dataId),u=n.readSync(o.dataId),c=n.readSync(i.dataId)[0],[d,f,h,p,g]=$ee(a,s.shape,s.dtype,l,r.dtype,u,c);return[n.makeTensorInfo(f,s.dtype,d),n.makeTensorInfo([f[0]],r.dtype,h),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(y=>Number(y)))),n.makeTensorInfo([g.length],s.dtype,new Int32Array(g))]}const zle={kernelName:mN,backendName:"webgl",kernelFunc:_le};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vle(t){const{inputs:e,backend:n}=t,{inputIndices:s,inputShape:r,newShape:o}=e;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${s.shape}`);if(r.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${r.shape}`);if(o.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${o.shape}`);const i=Array.from(n.readSync(r.dataId)),a=n.readSync(s.dataId),l=Array.from(n.readSync(o.dataId)),[u,c,d]=Cee(a,s.shape,s.dtype,i,l);return[n.makeTensorInfo(c,s.dtype,u),n.makeTensorInfo([d.length],o.dtype,new Int32Array(d))]}const Ble={kernelName:gN,backendName:"webgl",kernelFunc:Vle};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wle(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:o}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${r.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${o.shape}`);const i=n.readSync(s.dataId),a=n.readSync(r.dataId),l=n.readSync(o.dataId),[u,c]=sO(i,s.shape,s.dtype,a,l,!0);return n.makeTensorInfo(c,s.dtype,u)}const Ule={kernelName:xN,backendName:"webgl",kernelFunc:Wle};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gle(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:o}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${r.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${o.shape}`);const i=n.readSync(s.dataId),a=n.readSync(r.dataId),l=n.readSync(o.dataId),[u,c]=sO(i,s.shape,s.dtype,a,l);return n.makeTensorInfo(c,s.dtype,u)}const Hle={kernelName:yN,backendName:"webgl",kernelFunc:Gle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jle(t){const{inputs:e,backend:n,attrs:s}=t,{sparseIndices:r,sparseValues:o,defaultValue:i}=e,{outputShape:a}=s,{sliceRank:l,numUpdates:u,sliceSize:c,strides:d,outputSize:f}=Ta(o,r,a),h=!1;if(o.dtype==="string"){const m=n.bufferSync(r),x=n.bufferSync(o),v=ti(n.readSync(i.dataId)[0]),b=vee(m,x,a,f,c,u,l,d,v,h);return n.makeTensorInfo(a,b.dtype,b.values)}const p=new v$(u,l,r.shape.length,o.shape.length,d,[f,1],h),g=n.runWebGLProgram(p,[o,r,i],o.dtype),y=oe({inputs:{x:g},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(g),y}const Kle={kernelName:vN,backendName:"webgl",kernelFunc:jle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xle(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{numOrSizeSplits:o,axis:i}=s,a=Ne(i,r.shape)[0],l=Dw(r,o,a),u=r.shape.length,c=new Array(u).fill(0),d=r.shape.slice();return l.map(f=>{const h=[...d];h[a]=f;const p=cu({inputs:{x:r},backend:n,attrs:{begin:c,size:h}});return c[a]+=f,p})}const qle={kernelName:bg,backendName:"webgl",kernelFunc:Xle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eI="return sqrt(x);",Yle=Me({opSnippet:eI,packedOpSnippet:eI,cpuKernelImpl:kee}),Qle={kernelName:Ud,backendName:"webgl",kernelFunc:Yle};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zle="return x * x;",Jle=Me({opSnippet:Zle}),eue={kernelName:x1,backendName:"webgl",kernelFunc:Jle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tI="return (a - b) * (a - b);",tue=an({opSnippet:tI,packedOpSnippet:tI}),nue={kernelName:Gd,backendName:"webgl",kernelFunc:tue};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sue(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;if(r.dtype!=="string")throw new Error("Input must be of datatype string");const o=n.readSync(r.dataId),i=ho(o),a=See(i,"string",s);return n.makeTensorInfo(r.shape,"string",a)}const rue={kernelName:y1,backendName:"webgl",kernelFunc:sue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oue({inputs:t,attrs:e,backend:n}){const{x:s}=t,r=js+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,o=new Ir(s.shape,r);return n.runWebGLProgram(o,[s],s.dtype)}const iue={kernelName:qd,backendName:"webgl",kernelFunc:oue};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aue{constructor(e,n,s){this.variableNames=["x"],this.outputShape=s;const r=s.length,o=Je(s.length),i=Je(s.length);let a="";if(r===1)a="coords * strides + begin";else{let l=0;a=s.map((u,c)=>(l++,s.length===1?`coords * strides[${c}] + begin[${c}]`:`coords[${l-1}] * strides[${c}] + begin[${c}]`)).join(",")}this.userCode=`
      ${o} begin = ${o}(${e});
      ${o} strides = ${o}(${n});

      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lue(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:o,end:i,strides:a,beginMask:l,endMask:u,ellipsisMask:c,newAxisMask:d,shrinkAxisMask:f}=s,{finalShapeSparse:h,finalShape:p,isIdentity:g,sliceDim0:y,isSimpleSlice:m,begin:x,end:v,strides:b}=pw(r.shape,o,i,a,l,u,c,d,f);let $;if(g)$=oe({inputs:{x:r},backend:n,attrs:{shape:p}});else if(y||m){N(r.shape.length>=1,()=>`Input must have rank at least 1, got: ${r.shape.length}`);const k=dw(x,v,b),w=cu({inputs:{x:r},backend:n,attrs:{begin:x,size:k}});$=oe({inputs:{x:w},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(w)}else if(n.shouldExecuteOnCPU([r])){const w=n.readSync(r.dataId),I=Ee(r.shape,r.dtype,w),R=Iee(h,I,b,x);$=n.makeTensorInfo(p,r.dtype,R.values)}else{const w=new aue(x,b,h);$=n.runWebGLProgram(w,[r],r.dtype)}const C=oe({inputs:{x:$},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo($),C}const uue={kernelName:v1,backendName:"webgl",kernelFunc:lue};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cue(t){const{inputs:e,backend:n,attrs:s}=t,{separator:r,nGramWidths:o,leftPad:i,rightPad:a,padWidth:l,preserveShortSequences:u}=s,{data:c,dataSplits:d}=e,f=n.readSync(c.dataId),h=n.readSync(d.dataId),[p,g]=Tee(f,h,r,o,i,a,l,u);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(d.shape,"int32",g)]}const due={kernelName:bN,backendName:"webgl",kernelFunc:cue};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fue(t){const{inputs:e,backend:n,attrs:s}=t,{skipEmpty:r}=s,{input:o,delimiter:i}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(o.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${o.shape}`);if(i.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);const a=n.readSync(o.dataId),l=n.readSync(i.dataId)[0],[u,c,d]=Eee(a,l,r),f=c.length;return[n.makeTensorInfo([f,2],"int32",u),n.makeTensorInfo([f],"string",c),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const hue={kernelName:wN,backendName:"webgl",kernelFunc:fue};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pue(t){const{inputs:e,backend:n,attrs:s}=t,{numBuckets:r}=s,{input:o}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");const i=n.readSync(o.dataId),a=Nee(i,r);return n.makeTensorInfo(o.shape,"int32",a)}const mue={kernelName:$N,backendName:"webgl",kernelFunc:pue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gue="return tan(x);",xue=Me({opSnippet:gue}),yue={kernelName:jd,backendName:"webgl",kernelFunc:xue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vue=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,bue=Me({opSnippet:vue}),wue={kernelName:Kd,backendName:"webgl",kernelFunc:bue};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ue(t){const{inputs:e,backend:n,attrs:s}=t,{tensor:r,indices:o,updates:i}=e,{sliceRank:a,numUpdates:l,sliceSize:u,strides:c,outputSize:d}=Ta(i,o,r.shape),f=[d/u,u];if(d===0)return n.makeTensorInfo(r.shape,o.dtype);const h=oe({inputs:{x:o},backend:n,attrs:{shape:[l,a]}}),p=oe({inputs:{x:i},backend:n,attrs:{shape:[l,u]}}),g=oe({inputs:{x:r},backend:n,attrs:{shape:f}}),y=new v$(l,a,h.shape.length,p.shape.length,c,f,!1,!0),m=n.runWebGLProgram(y,[p,h,g],g.dtype),x=oe({inputs:{x:m},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),x}const Cue={kernelName:hN,backendName:"webgl",kernelFunc:$ue};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kue{constructor(e,n){this.variableNames=["A"];const s=new Array(e.length);for(let i=0;i<s.length;i++)s[i]=e[i]*n[i];this.outputShape=s,this.rank=s.length;const r=Je(this.rank),o=Sue(e);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        setOutput(getA(${o}));
      }
    `}}function Sue(t){const e=t.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${t[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],s=[];for(let r=0;r<t.length;r++)s.push(`imod(${n[r]}, ${t[r]})`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PO(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reps:o}=s;if(r.dtype==="string"||r.shape.length>5){const l=n.readSync(r.dataId),u=r.dtype==="string"?l.map(f=>ti(f)):l,c=Ee(r.shape,r.dtype,u),d=Aee(c,o);return n.makeTensorInfo(d.shape,d.dtype,d.values)}const i=new kue(r.shape,o);return n.runWebGLProgram(i,[r],r.dtype)}const Iue={kernelName:Xd,backendName:"webgl",kernelFunc:PO};class Tue{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class Eue{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wi(t,e){e!==null&&t.disposeIntermediateTensorInfo(e)}function nI(t){let e=1;for(;e<t;)e*=2;return e}function Nue(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{k:o,sorted:i}=s,a=K().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=K().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),u=r.shape,c=u[u.length-1];if(n.shouldExecuteOnCPU([r])||c<a||o>l){const R=n.readSync(r.dataId),[E,A]=Dee(R,u,r.dtype,o,i);return[n.makeTensorInfo(E.shape,E.dtype,E.values),n.makeTensorInfo(A.shape,A.dtype,A.values)]}if(o===0)return u[u.length-1]=0,[n.makeTensorInfo(u,r.dtype,[]),n.makeTensorInfo(u,"int32",[])];if(c===1)return[r,yf({attrs:{shape:u,dtype:"int32",value:0},backend:n})];const d=n.texData.get(r.dataId),f=d!==null&&d.isPacked,h=f?n.unpackTensor(r):r,g=Y(u)/c,y=oe({inputs:{x:h},attrs:{shape:[g,c]},backend:n});f&&wi(n,h);const m=nI(o),x=nI(c);let v=null;const b=()=>v===null?[y,y]:[y,v],$=(R,E,A)=>{const S=b(),T=new Tue(A),M=[[c],[v===null?1:0],[Number.NEGATIVE_INFINITY],[R],[E]],U=v;v=n.runWebGLProgram(T,S,"int32",M),wi(n,U)};for(let R=1;R<m;R*=2){const E=R*2;for(let A=R;A>=1;A/=2)$(E,A,[g,x])}for(let R=x;R>m;R/=2){const E=b(),A=new Eue([g,R/2]),T=[[c],[v===null?1:0],[m]],F=v;v=n.runWebGLProgram(A,E,"int32",T),wi(n,F);const M=m/2,U=M*2;for(let P=M;P>=1;P/=2)$(U,P,v.shape)}let C=v;v=cu({inputs:{x:v},backend:n,attrs:{begin:0,size:[g,o]}}),wi(n,C);let k=IO({inputs:{x:y,indices:v},backend:n,attrs:{axis:1,batchDims:1}});wi(n,y);const w=u.slice(0,-1);w.push(o),C=v,v=oe({inputs:{x:v},attrs:{shape:w},backend:n}),wi(n,C);const I=k;return k=oe({inputs:{x:k},attrs:{shape:w},backend:n}),wi(n,I),[k,v]}const Rue={kernelName:b1,backendName:"webgl",kernelFunc:Nue};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Aue{constructor(e,n,s,r,o,i){this.variableNames=["Image","Transforms"],this.outputShape=i;const a=s==="nearest"?1:2;let l;switch(r){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${n}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${o});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${o});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${n}));
                float mapY = mapCoord(inY, float(${e}));

                if (${a} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Due(t){const{inputs:e,backend:n,attrs:s}=t,{image:r,transforms:o}=e,{interpolation:i,fillMode:a,fillValue:l,outputShape:u}=s,[c,d,f,h]=r.shape,[p,g]=u??[d,f],y=[c,p,g,h],m=new Aue(d,f,i,a,l,y);return n.runWebGLProgram(m,[r,o],"float32")}const Fue={kernelName:w1,backendName:"webgl",kernelFunc:Due};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pue(t){const{inputs:e,attrs:n,backend:s}=t,{axis:r}=n,{x:o}=e;mf(o,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const i=s.readSync(o.dataId),{outputValues:a,outputShape:l,indices:u}=Fee(i,r,o.shape,o.dtype);return[s.makeTensorInfo(l,o.dtype,a),s.makeTensorInfo([u.length],"int32",u)]}const Oue={kernelName:$1,backendName:"webgl",kernelFunc:Pue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lue(t){const{inputs:e,backend:n,attrs:s}=t,{value:r}=e;let{axis:o}=s;o<0&&(o+=r.shape.length);const i=r,a=i.shape.length,l=r.shape[o],u=new Array(a-1);let c=0;for(let g=0;g<a;g++)g!==o&&(u[c++]=i.shape[g]);const d=[],f=new Array(a).fill(0),h=i.shape.slice();h[o]=1;const p=new Array(l);for(let g=0;g<p.length;g++){f[o]=g;const y=cu({inputs:{x:i},backend:n,attrs:{begin:f,size:h}}),m=oe({inputs:{x:y},backend:n,attrs:{shape:u}});p[g]=m,d.push(y)}return d.forEach(g=>n.disposeIntermediateTensorInfo(g)),p}const Mue={kernelName:$g,backendName:"webgl",kernelFunc:Lue};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _ue{constructor(e,n){this.variableNames=["x","segmentIds"];const s=e.windowSize,r=e.batchSize,o=e.inSize,i=e.numSegments,a=i*Math.ceil(o/s);this.outputShape=[r,a];const l="0.0",u="sumValue",c=Math.floor(s/4)*4,d=s%4,f=`
        sumValue += dot(values, segFilter);
    `;let h="";o%s>0&&(h=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return initializationValue;
        }
      `);let p="";o%s>0&&(p=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${h}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${p}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${i})) * float(${s}));
        int currentSeg = int(mod(float(outIdx), float(${i})));

        float sumValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${f}
        }

        int inIdx = inOffset + ${c};
        if (${d===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${f}
        } else if (${d===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${f}
        } else if (${d===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${f}
        }
        setOutput(${u});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zue(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,segmentIds:o}=e,{numSegments:i}=s,a=r.shape.length,l=[];let u=0;const c=vt([u],a);let d=r;c!=null&&(d=Rn({inputs:{x:r},backend:n,attrs:{perm:c}}),l.push(d),u=Nt(1,a)[0]);const f=mA(d.shape,u,i),h=Y([d.shape[u]]),p=oe({inputs:{x:d},backend:n,attrs:{shape:[-1,h]}});l.push(p);const g=S1(r.dtype),y=(b,$,C,k,w)=>{const I=b.shape[0],R=b.shape[1],E=pA(R,w),A={windowSize:E,inSize:R,batchSize:I,numSegments:w},S=new _ue(A,$),T=n.compileAndRun(S,[b,C],k);if(l.push(T),T.shape[1]===w)return T;const F=FO({backend:n,attrs:{start:0,stop:w,step:1,dtype:"float32"}}),M=PO({inputs:{x:F},backend:n,attrs:{reps:[R/E]}});return l.push(F),l.push(M),y(T,$,M,k,w)},m=y(p,"unsortedSegmentSum",o,g,i),x=oe({inputs:{x:m},backend:n,attrs:{shape:f}});let v=x;if(c!=null){l.push(x);const b=hi(c);v=Rn({inputs:{x:v},backend:n,attrs:{perm:b}})}return l.forEach(b=>n.disposeIntermediateTensorInfo(b)),v}const Vue={kernelName:Cg,backendName:"webgl",kernelFunc:zue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bue=[kte,Ite,Nte,Dte,Pte,Mte,zte,Bte,Hte,Kte,Yte,Jte,nne,ine,une,dne,hne,xne,vne,wne,Sne,Dne,Pne,_ne,Vne,jne,Xne,Zne,ate,tse,ise,cse,gse,vse,wse,Cse,Sse,Nse,Dse,Ose,Mse,zse,Bse,Gse,jse,Yse,Zse,tre,rre,ire,cre,pre,yre,wre,kre,Sre,Tre,Nre,Are,Fre,Ore,zre,Wre,Hre,Kre,Yre,Jre,soe,aoe,ite,uoe,rse,foe,moe,yoe,ute,$oe,Ioe,Eoe,Doe,Ooe,zoe,Woe,joe,Yoe,Joe,tie,oie,aie,uie,hie,mie,xie,vie,wie,Sie,Nie,Fie,Bie,fte,Hie,Xie,Qie,eae,Wne,sae,oae,aae,cae,pae,dte,gae,yae,bae,$ae,Cae,Une,Mie,Iae,Rae,Pae,pte,_ae,Bae,Hae,Xae,Zae,ele,sle,ile,ule,fle,mle,yle,$le,Sle,Nle,Dle,Rne,zie,Ole,Mle,zle,Ble,Ule,Hle,Kle,qle,Qle,eue,nue,rue,iue,uue,due,hue,mue,_ie,wte,yue,wue,Cue,Iue,Rue,Fue,$te,Oue,Mue,Vue,rae];for(const t of Bue)kN(t);const sI=t=>t>999?(t/1e3).toFixed(0)+"K":t;function OO({gameEngine:t}){const e=[],n=t.grid.arraySync(),s=t.activeCells.arraySync(),r=t.virusCells.arraySync();for(let o=0;o<t.grid.shape[0];o++){const i=[];for(let a=0;a<t.grid.shape[1];a++)i.push(j.jsxs("td",{className:xr({active:s[o][a]===1,focused:t.focusedCell[0]===o&&t.focusedCell[1]===a,virus:r[o][a]===1}),onClick:l=>t.onCellClick([o,a],{forceAutoSweep:l.shiftKey}),children:[r[o][a]===1&&sI(n[o][a]),s[o][a]===1&&sI(n[o][a])]},a));e.push(j.jsx("tr",{children:i},o))}return j.jsx("table",{children:j.jsx("tbody",{children:e})})}function Wue(t,e){if(t.match(/^[a-z]+:\/\//i))return t;if(t.match(/^\/\//))return window.location.protocol+t;if(t.match(/^[a-z]+:/i))return t;const n=document.implementation.createHTMLDocument(),s=n.createElement("base"),r=n.createElement("a");return n.head.appendChild(s),n.body.appendChild(r),e&&(s.href=e),r.href=t,r.href}const Uue=(()=>{let t=0;const e=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(t+=1,`u${e()}${t}`)})();function ro(t){const e=[];for(let n=0,s=t.length;n<s;n++)e.push(t[n]);return e}function zp(t,e){const s=(t.ownerDocument.defaultView||window).getComputedStyle(t).getPropertyValue(e);return s?parseFloat(s.replace("px","")):0}function Gue(t){const e=zp(t,"border-left-width"),n=zp(t,"border-right-width");return t.clientWidth+e+n}function Hue(t){const e=zp(t,"border-top-width"),n=zp(t,"border-bottom-width");return t.clientHeight+e+n}function LO(t,e={}){const n=e.width||Gue(t),s=e.height||Hue(t);return{width:n,height:s}}function jue(){let t,e;try{e=process}catch{}const n=e&&e.env?e.env.devicePixelRatio:null;return n&&(t=parseInt(n,10),Number.isNaN(t)&&(t=1)),t||window.devicePixelRatio||1}const as=16384;function Kue(t){(t.width>as||t.height>as)&&(t.width>as&&t.height>as?t.width>t.height?(t.height*=as/t.width,t.width=as):(t.width*=as/t.height,t.height=as):t.width>as?(t.height*=as/t.width,t.width=as):(t.width*=as/t.height,t.height=as))}function Vp(t){return new Promise((e,n)=>{const s=new Image;s.decode=()=>e(s),s.onload=()=>e(s),s.onerror=n,s.crossOrigin="anonymous",s.decoding="async",s.src=t})}async function Xue(t){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(t)).then(encodeURIComponent).then(e=>`data:image/svg+xml;charset=utf-8,${e}`)}async function que(t,e,n){const s="http://www.w3.org/2000/svg",r=document.createElementNS(s,"svg"),o=document.createElementNS(s,"foreignObject");return r.setAttribute("width",`${e}`),r.setAttribute("height",`${n}`),r.setAttribute("viewBox",`0 0 ${e} ${n}`),o.setAttribute("width","100%"),o.setAttribute("height","100%"),o.setAttribute("x","0"),o.setAttribute("y","0"),o.setAttribute("externalResourcesRequired","true"),r.appendChild(o),o.appendChild(t),Xue(r)}const ns=(t,e)=>{if(t instanceof e)return!0;const n=Object.getPrototypeOf(t);return n===null?!1:n.constructor.name===e.name||ns(n,e)};function Yue(t){const e=t.getPropertyValue("content");return`${t.cssText} content: '${e.replace(/'|"/g,"")}';`}function Que(t){return ro(t).map(e=>{const n=t.getPropertyValue(e),s=t.getPropertyPriority(e);return`${e}: ${n}${s?" !important":""};`}).join(" ")}function Zue(t,e,n){const s=`.${t}:${e}`,r=n.cssText?Yue(n):Que(n);return document.createTextNode(`${s}{${r}}`)}function rI(t,e,n){const s=window.getComputedStyle(t,n),r=s.getPropertyValue("content");if(r===""||r==="none")return;const o=Uue();try{e.className=`${e.className} ${o}`}catch{return}const i=document.createElement("style");i.appendChild(Zue(o,n,s)),e.appendChild(i)}function Jue(t,e){rI(t,e,":before"),rI(t,e,":after")}const oI="application/font-woff",iI="image/jpeg",ece={woff:oI,woff2:oI,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:iI,jpeg:iI,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function tce(t){const e=/\.([^./]*?)$/g.exec(t);return e?e[1]:""}function b$(t){const e=tce(t).toLowerCase();return ece[e]||""}function nce(t){return t.split(/,/)[1]}function sv(t){return t.search(/^(data:)/)!==-1}function sce(t,e){return`data:${e};base64,${t}`}async function MO(t,e,n){const s=await fetch(t,e);if(s.status===404)throw new Error(`Resource "${s.url}" not found`);const r=await s.blob();return new Promise((o,i)=>{const a=new FileReader;a.onerror=i,a.onloadend=()=>{try{o(n({res:s,result:a.result}))}catch(l){i(l)}},a.readAsDataURL(r)})}const ax={};function rce(t,e,n){let s=t.replace(/\?.*/,"");return n&&(s=t),/ttf|otf|eot|woff2?/i.test(s)&&(s=s.replace(/.*\//,"")),e?`[${e}]${s}`:s}async function w$(t,e,n){const s=rce(t,e,n.includeQueryParams);if(ax[s]!=null)return ax[s];n.cacheBust&&(t+=(/\?/.test(t)?"&":"?")+new Date().getTime());let r;try{const o=await MO(t,n.fetchRequestInit,({res:i,result:a})=>(e||(e=i.headers.get("Content-Type")||""),nce(a)));r=sce(o,e)}catch(o){r=n.imagePlaceholder||"";let i=`Failed to fetch resource: ${t}`;o&&(i=typeof o=="string"?o:o.message),i&&console.warn(i)}return ax[s]=r,r}async function oce(t){const e=t.toDataURL();return e==="data:,"?t.cloneNode(!1):Vp(e)}async function ice(t,e){if(t.currentSrc){const o=document.createElement("canvas"),i=o.getContext("2d");o.width=t.clientWidth,o.height=t.clientHeight,i==null||i.drawImage(t,0,0,o.width,o.height);const a=o.toDataURL();return Vp(a)}const n=t.poster,s=b$(n),r=await w$(n,s,e);return Vp(r)}async function ace(t){var e;try{if(!((e=t==null?void 0:t.contentDocument)===null||e===void 0)&&e.body)return await t0(t.contentDocument.body,{},!0)}catch{}return t.cloneNode(!1)}async function lce(t,e){return ns(t,HTMLCanvasElement)?oce(t):ns(t,HTMLVideoElement)?ice(t,e):ns(t,HTMLIFrameElement)?ace(t):t.cloneNode(!1)}const uce=t=>t.tagName!=null&&t.tagName.toUpperCase()==="SLOT";async function cce(t,e,n){var s,r;let o=[];return uce(t)&&t.assignedNodes?o=ro(t.assignedNodes()):ns(t,HTMLIFrameElement)&&(!((s=t.contentDocument)===null||s===void 0)&&s.body)?o=ro(t.contentDocument.body.childNodes):o=ro(((r=t.shadowRoot)!==null&&r!==void 0?r:t).childNodes),o.length===0||ns(t,HTMLVideoElement)||await o.reduce((i,a)=>i.then(()=>t0(a,n)).then(l=>{l&&e.appendChild(l)}),Promise.resolve()),e}function dce(t,e){const n=e.style;if(!n)return;const s=window.getComputedStyle(t);s.cssText?(n.cssText=s.cssText,n.transformOrigin=s.transformOrigin):ro(s).forEach(r=>{let o=s.getPropertyValue(r);r==="font-size"&&o.endsWith("px")&&(o=`${Math.floor(parseFloat(o.substring(0,o.length-2)))-.1}px`),ns(t,HTMLIFrameElement)&&r==="display"&&o==="inline"&&(o="block"),r==="d"&&e.getAttribute("d")&&(o=`path(${e.getAttribute("d")})`),n.setProperty(r,o,s.getPropertyPriority(r))})}function fce(t,e){ns(t,HTMLTextAreaElement)&&(e.innerHTML=t.value),ns(t,HTMLInputElement)&&e.setAttribute("value",t.value)}function hce(t,e){if(ns(t,HTMLSelectElement)){const n=e,s=Array.from(n.children).find(r=>t.value===r.getAttribute("value"));s&&s.setAttribute("selected","")}}function pce(t,e){return ns(e,Element)&&(dce(t,e),Jue(t,e),fce(t,e),hce(t,e)),e}async function mce(t,e){const n=t.querySelectorAll?t.querySelectorAll("use"):[];if(n.length===0)return t;const s={};for(let o=0;o<n.length;o++){const a=n[o].getAttribute("xlink:href");if(a){const l=t.querySelector(a),u=document.querySelector(a);!l&&u&&!s[a]&&(s[a]=await t0(u,e,!0))}}const r=Object.values(s);if(r.length){const o="http://www.w3.org/1999/xhtml",i=document.createElementNS(o,"svg");i.setAttribute("xmlns",o),i.style.position="absolute",i.style.width="0",i.style.height="0",i.style.overflow="hidden",i.style.display="none";const a=document.createElementNS(o,"defs");i.appendChild(a);for(let l=0;l<r.length;l++)a.appendChild(r[l]);t.appendChild(i)}return t}async function t0(t,e,n){return!n&&e.filter&&!e.filter(t)?null:Promise.resolve(t).then(s=>lce(s,e)).then(s=>cce(t,s,e)).then(s=>pce(t,s)).then(s=>mce(s,e))}const _O=/url\((['"]?)([^'"]+?)\1\)/g,gce=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,xce=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function yce(t){const e=t.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${e})(['"]?\\))`,"g")}function vce(t){const e=[];return t.replace(_O,(n,s,r)=>(e.push(r),n)),e.filter(n=>!sv(n))}async function bce(t,e,n,s,r){try{const o=n?Wue(e,n):e,i=b$(e);let a;return r||(a=await w$(o,i,s)),t.replace(yce(e),`$1${a}$3`)}catch{}return t}function wce(t,{preferredFontFormat:e}){return e?t.replace(xce,n=>{for(;;){const[s,,r]=gce.exec(n)||[];if(!r)return"";if(r===e)return`src: ${s};`}}):t}function zO(t){return t.search(_O)!==-1}async function VO(t,e,n){if(!zO(t))return t;const s=wce(t,n);return vce(s).reduce((o,i)=>o.then(a=>bce(a,i,e,n)),Promise.resolve(s))}async function oh(t,e,n){var s;const r=(s=e.style)===null||s===void 0?void 0:s.getPropertyValue(t);if(r){const o=await VO(r,null,n);return e.style.setProperty(t,o,e.style.getPropertyPriority(t)),!0}return!1}async function $ce(t,e){await oh("background",t,e)||await oh("background-image",t,e),await oh("mask",t,e)||await oh("mask-image",t,e)}async function Cce(t,e){const n=ns(t,HTMLImageElement);if(!(n&&!sv(t.src))&&!(ns(t,SVGImageElement)&&!sv(t.href.baseVal)))return;const s=n?t.src:t.href.baseVal,r=await w$(s,b$(s),e);await new Promise((o,i)=>{t.onload=o,t.onerror=i;const a=t;a.decode&&(a.decode=o),a.loading==="lazy"&&(a.loading="eager"),n?(t.srcset="",t.src=r):t.href.baseVal=r})}async function kce(t,e){const s=ro(t.childNodes).map(r=>BO(r,e));await Promise.all(s).then(()=>t)}async function BO(t,e){ns(t,Element)&&(await $ce(t,e),await Cce(t,e),await kce(t,e))}function Sce(t,e){const{style:n}=t;e.backgroundColor&&(n.backgroundColor=e.backgroundColor),e.width&&(n.width=`${e.width}px`),e.height&&(n.height=`${e.height}px`);const s=e.style;return s!=null&&Object.keys(s).forEach(r=>{n[r]=s[r]}),t}const aI={};async function lI(t){let e=aI[t];if(e!=null)return e;const s=await(await fetch(t)).text();return e={url:t,cssText:s},aI[t]=e,e}async function uI(t,e){let n=t.cssText;const s=/url\(["']?([^"')]+)["']?\)/g,o=(n.match(/url\([^)]+\)/g)||[]).map(async i=>{let a=i.replace(s,"$1");return a.startsWith("https://")||(a=new URL(a,t.url).href),MO(a,e.fetchRequestInit,({result:l})=>(n=n.replace(i,`url(${l})`),[i,l]))});return Promise.all(o).then(()=>n)}function cI(t){if(t==null)return[];const e=[],n=/(\/\*[\s\S]*?\*\/)/gi;let s=t.replace(n,"");const r=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const l=r.exec(s);if(l===null)break;e.push(l[0])}s=s.replace(r,"");const o=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,i="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",a=new RegExp(i,"gi");for(;;){let l=o.exec(s);if(l===null){if(l=a.exec(s),l===null)break;o.lastIndex=a.lastIndex}else a.lastIndex=o.lastIndex;e.push(l[0])}return e}async function Ice(t,e){const n=[],s=[];return t.forEach(r=>{if("cssRules"in r)try{ro(r.cssRules||[]).forEach((o,i)=>{if(o.type===CSSRule.IMPORT_RULE){let a=i+1;const l=o.href,u=lI(l).then(c=>uI(c,e)).then(c=>cI(c).forEach(d=>{try{r.insertRule(d,d.startsWith("@import")?a+=1:r.cssRules.length)}catch(f){console.error("Error inserting rule from remote css",{rule:d,error:f})}})).catch(c=>{console.error("Error loading remote css",c.toString())});s.push(u)}})}catch(o){const i=t.find(a=>a.href==null)||document.styleSheets[0];r.href!=null&&s.push(lI(r.href).then(a=>uI(a,e)).then(a=>cI(a).forEach(l=>{i.insertRule(l,r.cssRules.length)})).catch(a=>{console.error("Error loading remote stylesheet",a)})),console.error("Error inlining remote css file",o)}}),Promise.all(s).then(()=>(t.forEach(r=>{if("cssRules"in r)try{ro(r.cssRules||[]).forEach(o=>{n.push(o)})}catch(o){console.error(`Error while reading CSS rules from ${r.href}`,o)}}),n))}function Tce(t){return t.filter(e=>e.type===CSSRule.FONT_FACE_RULE).filter(e=>zO(e.style.getPropertyValue("src")))}async function Ece(t,e){if(t.ownerDocument==null)throw new Error("Provided element is not within a Document");const n=ro(t.ownerDocument.styleSheets),s=await Ice(n,e);return Tce(s)}async function Nce(t,e){const n=await Ece(t,e);return(await Promise.all(n.map(r=>{const o=r.parentStyleSheet?r.parentStyleSheet.href:null;return VO(r.cssText,o,e)}))).join(`
`)}async function Rce(t,e){const n=e.fontEmbedCSS!=null?e.fontEmbedCSS:e.skipFonts?null:await Nce(t,e);if(n){const s=document.createElement("style"),r=document.createTextNode(n);s.appendChild(r),t.firstChild?t.insertBefore(s,t.firstChild):t.appendChild(s)}}async function Ace(t,e={}){const{width:n,height:s}=LO(t,e),r=await t0(t,e,!0);return await Rce(r,e),await BO(r,e),Sce(r,e),await que(r,n,s)}async function Dce(t,e={}){const{width:n,height:s}=LO(t,e),r=await Ace(t,e),o=await Vp(r),i=document.createElement("canvas"),a=i.getContext("2d"),l=e.pixelRatio||jue(),u=e.canvasWidth||n,c=e.canvasHeight||s;return i.width=u*l,i.height=c*l,e.skipAutoScale||Kue(i),i.style.width=`${u}`,i.style.height=`${c}`,e.backgroundColor&&(a.fillStyle=e.backgroundColor,a.fillRect(0,0,i.width,i.height)),a.drawImage(o,0,0,i.width,i.height),i}async function Fce(t,e={}){return(await Dce(t,e)).toDataURL()}function Pce({gameEngine:t,onRendered:e}){return D.useLayoutEffect(()=>{e()},[]),j.jsx(OO,{gameEngine:t})}async function Oce(t){return new Promise((e,n)=>{const s=document.createElement("div");s.style.position="absolute",s.style.top="-10000px";const r=KE(s);document.body.appendChild(s);const o=()=>{const i=s.querySelector("table");i.style.position="absolute",i.style.top="0",i.style.left="0",i.style.marginTop="0",Fce(i,{pixelRatio:1}).then(a=>{s.remove();const l=new Image;l.src=a,e(l)}).catch(n)};r.render(j.jsx(Pce,{gameEngine:t,onRendered:o}))})}FV("webgl").then(()=>{console.log("WebGL backend initialized")});const dI=.2,Hu=t=>{switch(t){case Li:return"Easy";case ic:return"Medium";case ac:return"Hard";default:return"Unknown"}},Li="level-0",ic="level-1",ac="level-2",fI={[Li]:{initialIslands:5,initialSteps:0,minInitialVirusArea:0},[ic]:{initialIslands:4,initialSteps:5,minInitialVirusArea:0},[ac]:{initialIslands:2,initialSteps:12,minInitialVirusArea:50}};class Lce extends EventTarget{}const br=new Lce,ih=(t,e,n=33,s=150)=>{let r,o,i=!1;const a=(u,c)=>{t.includes(u)&&!i&&(c==null||c.preventDefault(),e(c),i=!0,o=setTimeout(()=>{r=setInterval(e.bind(void 0,c),n)},s))},l=u=>{t.includes(u)&&(i=!1,clearInterval(r),clearTimeout(o))};window.addEventListener("keydown",u=>{a(u.key,u)}),window.addEventListener("keyup",u=>{l(u.key)}),br.addEventListener("keydown",u=>{a(u.detail)}),br.addEventListener("keyup",u=>{l(u.detail)})},Mce=180,_ce=window.innerWidth,zce=window.innerHeight-Mce,WO=22,Vce=_ce/WO,Bce=zce/WO;class $${constructor(){Ft(this,"difficulty",Li);Ft(this,"HEIGHT",Math.floor(Math.min(25,Bce)));Ft(this,"WIDTH",Math.floor(Math.min(30,Vce)));Ft(this,"grid",xt([this.HEIGHT,this.WIDTH]));Ft(this,"activeCells",xt([this.HEIGHT,this.WIDTH]));Ft(this,"virusCells",xt([this.HEIGHT,this.WIDTH]));Ft(this,"focusedCell",[0,0]);Ft(this,"actionQueue",[]);Ft(this,"generation",0);Ft(this,"hasWon",!1);Ft(this,"hasLost",!1);Ft(this,"virusMoveRate",dI);Ft(this,"leaveTrail",!1);Ft(this,"trailSize",5);Ft(this,"enableAutoSweep",window.innerWidth<768);Ft(this,"replay",[]);Ft(this,"onUpdateCallback",()=>{});Ft(this,"onGeneratedImageCallback",e=>{});Ft(this,"resultCanvas",document.createElement("canvas"));Ft(this,"stats",{activeCellCount:0,virusCellCount:0,wasFocusedCellEaten:!1});this.resetGame()}setEnableAutoSweep(e){this.enableAutoSweep=e,this.onUpdateCallback()}toggleAutoSweep(){this.setEnableAutoSweep(!this.enableAutoSweep)}setLeaveTrail(e){this.leaveTrail=e,this.onUpdateCallback()}toggleLeaveTrail(){this.setLeaveTrail(!this.leaveTrail)}resetGame(){this.grid=vo([this.HEIGHT,this.WIDTH]).mul(-1),this.activeCells=xt([this.HEIGHT,this.WIDTH]),this.virusCells=xt([this.HEIGHT,this.WIDTH]);const e=[Math.floor(Math.random()*this.HEIGHT),Math.floor(Math.random()*this.WIDTH)];this.focusedCell=e,this.actionQueue=[],this.generation=0,this.hasWon=!1,this.hasLost=!1,this.virusMoveRate=dI;const n=this.activeCells.arraySync(),s=this.grid.arraySync(),r=this.virusCells.arraySync();for(let i=0;i<fI[this.difficulty].initialIslands;i++){const a=[Math.floor(Math.random()*this.HEIGHT),Math.floor(Math.random()*this.WIDTH)];r[a[0]][a[1]]=1,s[a[0]][a[1]]=1}n[this.focusedCell[0]][this.focusedCell[1]]=1,s[this.focusedCell[0]][this.focusedCell[1]]=50,this.activeCells=Fn(n),this.grid=Fn(s),this.virusCells=Fn(r);const o=fI[this.difficulty];for(let i=0;i<o.initialSteps;i++)this.step();for(;this.stats.virusCellCount<o.minInitialVirusArea;)this.step();this.generation=0,this.replay=[]}bindEvents(){ih(["w","W","ArrowUp"],e=>{e!=null&&e.shiftKey?this.autoSweep([-1,0]):this.moveTo({initialCellPosition:this.focusedCell,destinationCellPosition:[this.focusedCell[0]-1,this.focusedCell[1]]})}),ih(["s","S","ArrowDown"],e=>{e!=null&&e.shiftKey?this.autoSweep([1,0]):this.moveTo({initialCellPosition:this.focusedCell,destinationCellPosition:[this.focusedCell[0]+1,this.focusedCell[1]]})}),ih(["a","A","ArrowLeft"],e=>{e!=null&&e.shiftKey?this.autoSweep([0,-1]):this.moveTo({initialCellPosition:this.focusedCell,destinationCellPosition:[this.focusedCell[0],this.focusedCell[1]-1]})}),ih(["d","D","ArrowRight"],e=>{e!=null&&e.shiftKey?this.autoSweep([0,1]):this.moveTo({initialCellPosition:this.focusedCell,destinationCellPosition:[this.focusedCell[0],this.focusedCell[1]+1]})})}queueAction(e){this.actionQueue.push(e)}checkBounds([e,n]){return e>=0&&e<this.HEIGHT&&n>=0&&n<this.WIDTH}async autoSweep(e,n=1/0){let s=this.focusedCell[0],r=this.focusedCell[1],o=0,i=0,a=!1;const l=[];for(;o<n&&this.checkBounds([s,r]);){const u=s,c=r;l.push(new Promise(d=>{setTimeout(()=>{if(a){d();return}this.moveTo({initialCellPosition:[u,c],destinationCellPosition:[u+e[0],c+e[1]]})||(a=!0),d()},i)})),s+=e[0],r+=e[1],i+=30,o++}await Promise.all(l)}moveToMeta({initialCellPosition:e,destinationCellPosition:n,grid:s,playerCells:r,enemyCells:o,trailSize:i}){i=i||0;const a=n,l=e;if(!this.checkBounds(l)||!this.checkBounds(a)||l[0]!==a[0]&&l[1]!==a[1]||Math.abs(l[0]-a[0])>1||Math.abs(l[1]-a[1])>1)return!1;const u=s[l[0]][l[1]];let c=0;if(o[a[0]][a[1]]===1?c=s[a[0]][a[1]]:(r[a[0]][a[1]]>0&&r[l[0]][l[1]]>0,c=-s[a[0]][a[1]]),u<=c||r[l[0]][l[1]]!==1)return!1;s[l[0]][l[1]]=0,s[a[0]][a[1]]=u-c;{let d=!1;for(let f=-1;f<=1;f++)for(let h=-1;h<=1;h++)this.checkBounds([l[0]+f,l[1]+h])&&o[l[0]+f][l[1]+h]===1&&(d=!0);if(d){const f=this.leaveTrail?i-s[l[0]][l[1]]:0;i>0&&s[a[0]][a[1]]>i&&f>0&&(s[l[0]][l[1]]=f,s[a[0]][a[1]]-=f)}}return r[a[0]][a[1]]=1,o[a[0]][a[1]]=0,this.onUpdateCallback(),!0}moveTo({initialCellPosition:e,destinationCellPosition:n}){const s=this.grid.arraySync(),r=this.activeCells.arraySync(),o=this.virusCells.arraySync(),i=this.moveToMeta({initialCellPosition:e,destinationCellPosition:n,grid:s,playerCells:r,enemyCells:o,trailSize:this.trailSize});return i&&(this.activeCells=Fn(r),this.grid=Fn(s),this.virusCells=Fn(o),this.focusedCell=structuredClone(n),this.onUpdateCallback(),!0)}moveVirusTo({initialCellPosition:e,destinationCellPosition:n}){const s=this.grid.arraySync(),r=this.activeCells.arraySync(),o=this.virusCells.arraySync();this.moveToMeta({initialCellPosition:e,destinationCellPosition:n,grid:s,enemyCells:r,playerCells:o})&&(this.activeCells=Fn(r),this.grid=Fn(s),this.virusCells=Fn(o),this.onUpdateCallback())}async onCellClick([e,n],{forceAutoSweep:s=!1}={}){const r=this.activeCells.arraySync(),o=this.focusedCell[0],i=this.focusedCell[1];if(this.enableAutoSweep||s){const a=Math.abs(e-o);await this.autoSweep([Math.sign(e-o),0],a);const l=Math.abs(n-i);await this.autoSweep([0,Math.sign(n-i)],l)}r[e][n]===1&&(this.focusedCell=[e,n]),this.onUpdateCallback()}step(){if(!(this.hasWon||this.hasLost)){for(;this.actionQueue.length>0;)this.actionQueue.shift().call(this);this.queueAction(()=>{if(this.hasWon)return;const e=structuredClone(this.grid.arraySync()),n=this.activeCells.arraySync(),s=this.virusCells.arraySync();for(let r=0;r<this.grid.shape[0];r++)for(let o=0;o<this.grid.shape[1];o++)if(n[r][o]===1&&this.generation%5===0)e[r][o]++;else if(s[r][o]===1&&(e[r][o]++,Math.random()<this.virusMoveRate)){const i=[[r-1,o],[r+1,o],[r,o-1],[r,o+1]],a=i[Math.floor(Math.random()*i.length)];this.queueAction(()=>{this.moveVirusTo({initialCellPosition:[r,o],destinationCellPosition:a})})}this.grid=Fn(e),this.detectGameStatus()||this.generation++,this.storeReplay()})}}saveState(){return{grid:this.grid.arraySync(),activeCells:this.activeCells.arraySync(),virusCells:this.virusCells.arraySync(),focusedCell:structuredClone(this.focusedCell),generation:this.generation,stats:structuredClone(this.stats)}}storeReplay(){this.replay.push(this.saveState())}restoreReplayState(e){this.grid=Fn(e.grid),this.activeCells=Fn(e.activeCells),this.virusCells=Fn(e.virusCells),this.focusedCell=structuredClone(e.focusedCell),this.generation=e.generation,this.stats=structuredClone(e.stats)}async generateShareImage(){if(window.innerWidth<768)return;this.onGeneratedImageCallback(null);const e=new $$,n=this.resultCanvas,s=n.getContext("2d"),r=120,o=10,i=4,a=[];for(let c=0;c<i;c++)a.push(Math.floor((c+1)/i*this.replay.length));const l=[0,...a,this.replay.length-1];s.shadowColor="black",s.shadowBlur=7;for(let c=0;c<l.length;c++){const d=l[c];e.restoreReplayState(this.replay[d]);const f=await Oce(e),h=3;c===0&&(n.width=f.width*h+o*(h+1),n.height=r+o+(f.height+o)*Math.ceil(l.length/h)+o,s.fillStyle="#242424",s.fillRect(0,0,n.width,n.height));const p=o+(f.width+o)*(c%h),g=r+(f.height+o)*Math.floor(c/h);s.drawImage(f,p,g),s.font="bold 10px Arial",s.textAlign="left",s.fillStyle="#ffffff";const y=`Generation: ${e.generation}`;s.fillText(y,p+10,g+20);const m=`You: ${e.stats.activeCellCount}`;s.fillText(m,p+10,g+30);const x=`Virus: ${e.stats.virusCellCount}`;s.fillText(x,p+10,g+40)}s.fillStyle="#ffffff";const u=this.hasWon?"You won!":"Virus Won!";s.textAlign="center",s.font="bold 30px Arial",s.fillText(u,n.width/2,r/2-15),s.font="bold 10px Arial",s.fillText("Level: "+Hu(this.difficulty),n.width/2,r/2+15),s.font="bold 10px Arial",s.fillText("Play at https://antoinemopa.github.io/grid/",n.width/2,r-20),this.onGeneratedImageCallback(n)}detectGameStatus(){if(this.hasWon||this.hasLost)return!0;const e=this.activeCells.mul(this.grid).sum().arraySync(),n=this.virusCells.mul(this.grid).sum().arraySync();return this.stats.activeCellCount=e,this.stats.virusCellCount=n,this.stats.wasFocusedCellEaten=this.virusCells.arraySync()[this.focusedCell[0]][this.focusedCell[1]]===1,this.onUpdateCallback(),n===0?(this.hasWon=!0,this.saveState(),this.generateShareImage(),!0):e===0?(this.hasLost=!0,this.saveState(),this.generateShareImage(),!0):!1}}function C$(t={}){const{strict:e=!0,errorMessage:n="useContext: `context` is undefined. Seems you forgot to wrap component within the Provider",name:s}=t,r=D.createContext(void 0);r.displayName=s;function o(){var i;const a=D.useContext(r);if(!a&&e){const l=new Error(n);throw l.name="ContextError",(i=Error.captureStackTrace)==null||i.call(Error,l,o),l}return a}return[r.Provider,o,r]}function du(t){const e=D.useRef(null);return D.useImperativeHandle(t,()=>e.current),e}function UO(t){var e,n,s="";if(typeof t=="string"||typeof t=="number")s+=t;else if(typeof t=="object")if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(n=UO(t[e]))&&(s&&(s+=" "),s+=n);else for(e in t)t[e]&&(s&&(s+=" "),s+=e);return s}function On(...t){for(var e=0,n,s,r="";e<t.length;)(n=t[e++])&&(s=UO(n))&&(r&&(r+=" "),r+=s);return r}function Wce(t){return`${t}-${Math.floor(Math.random()*1e6)}`}function n0(t){if(!t||typeof t!="object")return"";try{return JSON.stringify(t)}catch{return""}}function Uce(t,e,n){return Math.min(Math.max(t,e),n)}function Gce(t){return typeof t=="function"}var un=t=>t?"true":void 0;function Hce(t,e){if(t!=null){if(Gce(t)){t(e);return}try{t.current=e}catch{throw new Error(`Cannot assign value '${e}' to ref '${t}'`)}}}function jce(...t){return e=>{t.forEach(n=>Hce(n,e))}}var Kce=new Set(["id","type","style","title","role","tabIndex","htmlFor","width","height","abbr","accept","acceptCharset","accessKey","action","allowFullScreen","allowTransparency","alt","async","autoComplete","autoFocus","autoPlay","cellPadding","cellSpacing","challenge","charset","checked","cite","class","className","cols","colSpan","command","content","contentEditable","contextMenu","controls","coords","crossOrigin","data","dateTime","default","defer","dir","disabled","download","draggable","dropzone","encType","enterKeyHint","for","form","formAction","formEncType","formMethod","formNoValidate","formTarget","frameBorder","headers","hidden","high","href","hrefLang","httpEquiv","icon","inputMode","isMap","itemId","itemProp","itemRef","itemScope","itemType","kind","label","lang","list","loop","manifest","max","maxLength","media","mediaGroup","method","min","minLength","multiple","muted","name","noValidate","open","optimum","pattern","ping","placeholder","poster","preload","radioGroup","referrerPolicy","readOnly","rel","required","rows","rowSpan","sandbox","scope","scoped","scrolling","seamless","selected","shape","size","sizes","slot","sortable","span","spellCheck","src","srcDoc","srcSet","start","step","target","translate","typeMustMatch","useMap","value","wmode","wrap"]),Xce=new Set(["onCopy","onCut","onPaste","onLoad","onError","onWheel","onScroll","onCompositionEnd","onCompositionStart","onCompositionUpdate","onKeyDown","onKeyPress","onKeyUp","onFocus","onBlur","onChange","onInput","onSubmit","onClick","onContextMenu","onDoubleClick","onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onPointerDown","onPointerEnter","onPointerLeave","onPointerUp","onSelect","onTouchCancel","onTouchEnd","onTouchMove","onTouchStart","onAnimationStart","onAnimationEnd","onAnimationIteration","onTransitionEnd"]),hI=/^(data-.*)$/,qce=/^(aria-.*)$/,ah=/^(on[A-Z].*)$/;function pI(t,e={}){let{labelable:n=!0,enabled:s=!0,propNames:r,omitPropNames:o,omitEventNames:i,omitDataProps:a,omitEventProps:l}=e,u={};if(!s)return t;for(const c in t)o!=null&&o.has(c)||i!=null&&i.has(c)&&ah.test(c)||ah.test(c)&&!Xce.has(c)||a&&hI.test(c)||l&&ah.test(c)||(Object.prototype.hasOwnProperty.call(t,c)&&(Kce.has(c)||n&&qce.test(c)||r!=null&&r.has(c)||hI.test(c))||ah.test(c))&&(u[c]=t[c]);return u}var[Exe,s0]=C$({name:"ProviderContext",strict:!1});const Bp={prefix:String(Math.round(Math.random()*1e10)),current:0},GO=Xe.createContext(Bp),Yce=Xe.createContext(!1);let Qce=!!(typeof window<"u"&&window.document&&window.document.createElement),lx=new WeakMap;function Zce(t=!1){let e=D.useContext(GO),n=D.useRef(null);if(n.current===null&&!t){var s,r;let o=(r=Xe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED)===null||r===void 0||(s=r.ReactCurrentOwner)===null||s===void 0?void 0:s.current;if(o){let i=lx.get(o);i==null?lx.set(o,{id:e.current,state:o.memoizedState}):o.memoizedState!==i.state&&(e.current=i.id,lx.delete(o))}n.current=++e.current}return n.current}function Jce(t){let e=D.useContext(GO);e===Bp&&!Qce&&console.warn("When server rendering, you must wrap your application in an <SSRProvider> to ensure consistent ids are generated between the client and server.");let n=Zce(!!t),s=`react-aria${e.prefix}`;return t||`${s}-${n}`}function ede(t){let e=Xe.useId(),[n]=D.useState(k$()),s=n?"react-aria":`react-aria${Bp.prefix}`;return t||`${s}-${e}`}const tde=typeof Xe.useId=="function"?ede:Jce;function nde(){return!1}function sde(){return!0}function rde(t){return()=>{}}function k$(){return typeof Xe.useSyncExternalStore=="function"?Xe.useSyncExternalStore(rde,nde,sde):D.useContext(Yce)}const ode=Symbol.for("react-aria.i18n.locale"),ide=Symbol.for("react-aria.i18n.strings");let Va;class r0{getStringForLocale(e,n){let r=this.getStringsForLocale(n)[e];if(!r)throw new Error(`Could not find intl message ${e} in ${n} locale`);return r}getStringsForLocale(e){let n=this.strings[e];return n||(n=ade(e,this.strings,this.defaultLocale),this.strings[e]=n),n}static getGlobalDictionaryForPackage(e){if(typeof window>"u")return null;let n=window[ode];if(Va===void 0){let r=window[ide];if(!r)return null;Va={};for(let o in r)Va[o]=new r0({[n]:r[o]},n)}let s=Va==null?void 0:Va[e];if(!s)throw new Error(`Strings for package "${e}" were not included by LocalizedStringProvider. Please add it to the list passed to createLocalizedStringDictionary.`);return s}constructor(e,n="en-US"){this.strings=Object.fromEntries(Object.entries(e).filter(([,s])=>s)),this.defaultLocale=n}}function ade(t,e,n="en-US"){if(e[t])return e[t];let s=lde(t);if(e[s])return e[s];for(let r in e)if(r.startsWith(s+"-"))return e[r];return e[n]}function lde(t){return Intl.Locale?new Intl.Locale(t).language:t.split("-")[0]}const mI=new Map,gI=new Map;class ude{format(e,n){let s=this.strings.getStringForLocale(e,this.locale);return typeof s=="function"?s(n,this):s}plural(e,n,s="cardinal"){let r=n["="+e];if(r)return typeof r=="function"?r():r;let o=this.locale+":"+s,i=mI.get(o);i||(i=new Intl.PluralRules(this.locale,{type:s}),mI.set(o,i));let a=i.select(e);return r=n[a]||n.other,typeof r=="function"?r():r}number(e){let n=gI.get(this.locale);return n||(n=new Intl.NumberFormat(this.locale),gI.set(this.locale,n)),n.format(e)}select(e,n){let s=e[n]||e.other;return typeof s=="function"?s():s}constructor(e,n){this.locale=e,this.strings=n}}function cde(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function HO(t,e,n){cde(t,e),e.set(t,n)}const It=typeof document<"u"?Xe.useLayoutEffect:()=>{};function qt(t){const e=D.useRef(null);return It(()=>{e.current=t},[t]),D.useCallback((...n)=>{const s=e.current;return s==null?void 0:s(...n)},[])}function dde(t){let[e,n]=D.useState(t),s=D.useRef(null),r=qt(()=>{if(!s.current)return;let i=s.current.next();if(i.done){s.current=null;return}e===i.value?r():n(i.value)});It(()=>{s.current&&r()});let o=qt(i=>{s.current=i(e),r()});return[e,o]}let fde=!!(typeof window<"u"&&window.document&&window.document.createElement),Wp=new Map;function jO(t){let[e,n]=D.useState(t),s=D.useRef(null),r=tde(e),o=D.useCallback(i=>{s.current=i},[]);return fde&&Wp.set(r,o),It(()=>{let i=r;return()=>{Wp.delete(i)}},[r]),D.useEffect(()=>{let i=s.current;i&&(s.current=null,n(i))}),r}function hde(t,e){if(t===e)return t;let n=Wp.get(t);if(n)return n(e),e;let s=Wp.get(e);return s?(s(t),t):e}function pde(t=[]){let e=jO(),[n,s]=dde(e),r=D.useCallback(()=>{s(function*(){yield e,yield document.getElementById(e)?e:void 0})},[e,s]);return It(r,[e,r,...t]),n}function Vr(...t){return(...e)=>{for(let n of t)typeof n=="function"&&n(...e)}}const $e=t=>{var e;return(e=t==null?void 0:t.ownerDocument)!==null&&e!==void 0?e:document},lt=t=>t&&"window"in t&&t.window===t?t:$e(t).defaultView||window;function KO(t){var e,n,s="";if(typeof t=="string"||typeof t=="number")s+=t;else if(typeof t=="object")if(Array.isArray(t)){var r=t.length;for(e=0;e<r;e++)t[e]&&(n=KO(t[e]))&&(s&&(s+=" "),s+=n)}else for(n in t)t[n]&&(s&&(s+=" "),s+=n);return s}function mde(){for(var t,e,n=0,s="",r=arguments.length;n<r;n++)(t=arguments[n])&&(e=KO(t))&&(s&&(s+=" "),s+=e);return s}function $t(...t){let e={...t[0]};for(let n=1;n<t.length;n++){let s=t[n];for(let r in s){let o=e[r],i=s[r];typeof o=="function"&&typeof i=="function"&&r[0]==="o"&&r[1]==="n"&&r.charCodeAt(2)>=65&&r.charCodeAt(2)<=90?e[r]=Vr(o,i):(r==="className"||r==="UNSAFE_className")&&typeof o=="string"&&typeof i=="string"?e[r]=mde(o,i):r==="id"&&o&&i?e.id=hde(o,i):e[r]=i!==void 0?i:o}}return e}function gde(...t){return t.length===1?t[0]:e=>{for(let n of t)typeof n=="function"?n(e):n!=null&&(n.current=e)}}const xde=new Set(["id"]),yde=new Set(["aria-label","aria-labelledby","aria-describedby","aria-details"]),vde=new Set(["href","hrefLang","target","rel","download","ping","referrerPolicy"]),bde=/^(data-.*)$/;function S$(t,e={}){let{labelable:n,isLink:s,propNames:r}=e,o={};for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(xde.has(i)||n&&yde.has(i)||s&&vde.has(i)||r!=null&&r.has(i)||bde.test(i))&&(o[i]=t[i]);return o}function cn(t){if(wde())t.focus({preventScroll:!0});else{let e=$de(t);t.focus(),Cde(e)}}let lh=null;function wde(){if(lh==null){lh=!1;try{document.createElement("div").focus({get preventScroll(){return lh=!0,!0}})}catch{}}return lh}function $de(t){let e=t.parentNode,n=[],s=document.scrollingElement||document.documentElement;for(;e instanceof HTMLElement&&e!==s;)(e.offsetHeight<e.scrollHeight||e.offsetWidth<e.scrollWidth)&&n.push({element:e,scrollTop:e.scrollTop,scrollLeft:e.scrollLeft}),e=e.parentNode;return s instanceof HTMLElement&&n.push({element:s,scrollTop:s.scrollTop,scrollLeft:s.scrollLeft}),n}function Cde(t){for(let{element:e,scrollTop:n,scrollLeft:s}of t)e.scrollTop=n,e.scrollLeft=s}function o0(t){var e;return typeof window>"u"||window.navigator==null?!1:((e=window.navigator.userAgentData)===null||e===void 0?void 0:e.brands.some(n=>t.test(n.brand)))||t.test(window.navigator.userAgent)}function I$(t){var e;return typeof window<"u"&&window.navigator!=null?t.test(((e=window.navigator.userAgentData)===null||e===void 0?void 0:e.platform)||window.navigator.platform):!1}function Br(){return I$(/^Mac/i)}function kde(){return I$(/^iPhone/i)}function XO(){return I$(/^iPad/i)||Br()&&navigator.maxTouchPoints>1}function vf(){return kde()||XO()}function Sde(){return o0(/AppleWebKit/i)&&!Ide()}function Ide(){return o0(/Chrome/i)}function qO(){return o0(/Android/i)}function Tde(){return o0(/Firefox/i)}function ha(t,e,n=!0){var s,r;let{metaKey:o,ctrlKey:i,altKey:a,shiftKey:l}=e;Tde()&&(!((r=window.event)===null||r===void 0||(s=r.type)===null||s===void 0)&&s.startsWith("key"))&&t.target==="_blank"&&(Br()?o=!0:i=!0);let u=Sde()&&Br()&&!XO()?new KeyboardEvent("keydown",{keyIdentifier:"Enter",metaKey:o,ctrlKey:i,altKey:a,shiftKey:l}):new MouseEvent("click",{metaKey:o,ctrlKey:i,altKey:a,shiftKey:l,bubbles:!0,cancelable:!0});ha.isOpening=n,cn(t),t.dispatchEvent(u),ha.isOpening=!1}ha.isOpening=!1;let Ka=new Map,rv=new Set;function xI(){if(typeof window>"u")return;function t(s){return"propertyName"in s}let e=s=>{if(!t(s)||!s.target)return;let r=Ka.get(s.target);r||(r=new Set,Ka.set(s.target,r),s.target.addEventListener("transitioncancel",n,{once:!0})),r.add(s.propertyName)},n=s=>{if(!t(s)||!s.target)return;let r=Ka.get(s.target);if(r&&(r.delete(s.propertyName),r.size===0&&(s.target.removeEventListener("transitioncancel",n),Ka.delete(s.target)),Ka.size===0)){for(let o of rv)o();rv.clear()}};document.body.addEventListener("transitionrun",e),document.body.addEventListener("transitionend",n)}typeof document<"u"&&(document.readyState!=="loading"?xI():document.addEventListener("DOMContentLoaded",xI));function fu(t){requestAnimationFrame(()=>{Ka.size===0?t():rv.add(t)})}function YO(){let t=D.useRef(new Map),e=D.useCallback((r,o,i,a)=>{let l=a!=null&&a.once?(...u)=>{t.current.delete(i),i(...u)}:i;t.current.set(i,{type:o,eventTarget:r,fn:l,options:a}),r.addEventListener(o,i,a)},[]),n=D.useCallback((r,o,i,a)=>{var l;let u=((l=t.current.get(i))===null||l===void 0?void 0:l.fn)||i;r.removeEventListener(o,u,a),t.current.delete(i)},[]),s=D.useCallback(()=>{t.current.forEach((r,o)=>{n(r.eventTarget,r.type,o,r.options)})},[n]);return D.useEffect(()=>s,[s]),{addGlobalListener:e,removeGlobalListener:n,removeAllGlobalListeners:s}}function Ede(t,e){let{id:n,"aria-label":s,"aria-labelledby":r}=t;return n=jO(n),r&&s?r=[...new Set([n,...r.trim().split(/\s+/)])].join(" "):r&&(r=r.trim().split(/\s+/).join(" ")),!s&&!r&&e&&(s=e),{id:n,"aria-label":s,"aria-labelledby":r}}function i0(t,e){It(()=>{if(t&&t.ref&&e)return t.ref.current=e.current,()=>{t.ref&&(t.ref.current=null)}})}function yI(t,e){let n=window.getComputedStyle(t),s=/(auto|scroll)/.test(n.overflow+n.overflowX+n.overflowY);return s&&e&&(s=t.scrollHeight!==t.clientHeight||t.scrollWidth!==t.clientWidth),s}function QO(t,e){let n=t;for(yI(n,e)&&(n=n.parentElement);n&&!yI(n,e);)n=n.parentElement;return n||document.scrollingElement||document.documentElement}function po(t){return t.mozInputSource===0&&t.isTrusted?!0:qO()&&t.pointerType?t.type==="click"&&t.buttons===1:t.detail===0&&!t.pointerType}function ZO(t){return!qO()&&t.width===0&&t.height===0||t.width===1&&t.height===1&&t.pressure===0&&t.detail===0&&t.pointerType==="mouse"}function Nde(t,e,n){let s=D.useRef(e),r=qt(()=>{n&&n(s.current)});D.useEffect(()=>{var o;let i=t==null||(o=t.current)===null||o===void 0?void 0:o.form;return i==null||i.addEventListener("reset",r),()=>{i==null||i.removeEventListener("reset",r)}},[t,r])}function JO(t,e,n){let[s,r]=D.useState(t||e),o=D.useRef(t!==void 0),i=t!==void 0;D.useEffect(()=>{let u=o.current;u!==i&&console.warn(`WARN: A component changed from ${u?"controlled":"uncontrolled"} to ${i?"controlled":"uncontrolled"}.`),o.current=i},[i]);let a=i?t:s,l=D.useCallback((u,...c)=>{let d=(f,...h)=>{n&&(Object.is(a,f)||n(f,...h)),i||(a=f)};typeof u=="function"?(console.warn("We can not support a function callback. See Github Issues for details https://github.com/adobe/react-spectrum/issues/2320"),r((h,...p)=>{let g=u(i?a:h,...p);return d(g,...c),i?h:g})):(i||r(u),d(u,...c))},[i,a,n]);return[a,l]}var eL={};eL={dismiss:"تجاهل"};var tL={};tL={dismiss:"Отхвърляне"};var nL={};nL={dismiss:"Odstranit"};var sL={};sL={dismiss:"Luk"};var rL={};rL={dismiss:"Schließen"};var oL={};oL={dismiss:"Απόρριψη"};var iL={};iL={dismiss:"Dismiss"};var aL={};aL={dismiss:"Descartar"};var lL={};lL={dismiss:"Lõpeta"};var uL={};uL={dismiss:"Hylkää"};var cL={};cL={dismiss:"Rejeter"};var dL={};dL={dismiss:"התעלם"};var fL={};fL={dismiss:"Odbaci"};var hL={};hL={dismiss:"Elutasítás"};var pL={};pL={dismiss:"Ignora"};var mL={};mL={dismiss:"閉じる"};var gL={};gL={dismiss:"무시"};var xL={};xL={dismiss:"Atmesti"};var yL={};yL={dismiss:"Nerādīt"};var vL={};vL={dismiss:"Lukk"};var bL={};bL={dismiss:"Negeren"};var wL={};wL={dismiss:"Zignoruj"};var $L={};$L={dismiss:"Descartar"};var CL={};CL={dismiss:"Dispensar"};var kL={};kL={dismiss:"Revocare"};var SL={};SL={dismiss:"Пропустить"};var IL={};IL={dismiss:"Zrušiť"};var TL={};TL={dismiss:"Opusti"};var EL={};EL={dismiss:"Odbaci"};var NL={};NL={dismiss:"Avvisa"};var RL={};RL={dismiss:"Kapat"};var AL={};AL={dismiss:"Скасувати"};var DL={};DL={dismiss:"取消"};var FL={};FL={dismiss:"關閉"};const Rde=new Set(["Arab","Syrc","Samr","Mand","Thaa","Mend","Nkoo","Adlm","Rohg","Hebr"]),Ade=new Set(["ae","ar","arc","bcc","bqi","ckb","dv","fa","glk","he","ku","mzn","nqo","pnb","ps","sd","ug","ur","yi"]);function Dde(t){if(Intl.Locale){let n=new Intl.Locale(t).maximize(),s=typeof n.getTextInfo=="function"?n.getTextInfo():n.textInfo;if(s)return s.direction==="rtl";if(n.script)return Rde.has(n.script)}let e=t.split("-")[0];return Ade.has(e)}const Fde=Symbol.for("react-aria.i18n.locale");function PL(){let t=typeof window<"u"&&window[Fde]||typeof navigator<"u"&&(navigator.language||navigator.userLanguage)||"en-US";try{Intl.DateTimeFormat.supportedLocalesOf([t])}catch{t="en-US"}return{locale:t,direction:Dde(t)?"rtl":"ltr"}}let ov=PL(),ju=new Set;function vI(){ov=PL();for(let t of ju)t(ov)}function Pde(){let t=k$(),[e,n]=D.useState(ov);return D.useEffect(()=>(ju.size===0&&window.addEventListener("languagechange",vI),ju.add(n),()=>{ju.delete(n),ju.size===0&&window.removeEventListener("languagechange",vI)}),[]),t?{locale:"en-US",direction:"ltr"}:e}const Ode=Xe.createContext(null);function Lde(){let t=Pde();return D.useContext(Ode)||t}const bI=new WeakMap;function Mde(t){let e=bI.get(t);return e||(e=new r0(t),bI.set(t,e)),e}function _de(t,e){return e&&r0.getGlobalDictionaryForPackage(e)||Mde(t)}function zde(t,e){let{locale:n}=Lde(),s=_de(t,e);return D.useMemo(()=>new ude(n,s),[n,s])}const OL=Xe.createContext({register:()=>{}});OL.displayName="PressResponderContext";function Vde(t,e){return e.get?e.get.call(t):e.value}function LL(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function ML(t,e){var n=LL(t,e,"get");return Vde(t,n)}function Bde(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Up(t,e,n){var s=LL(t,e,"set");return Bde(t,s,n),n}function Wde({children:t}){let e=D.useMemo(()=>({register:()=>{}}),[]);return Xe.createElement(OL.Provider,{value:e},t)}let Ude=class{isDefaultPrevented(){return this.nativeEvent.defaultPrevented}preventDefault(){this.defaultPrevented=!0,this.nativeEvent.preventDefault()}stopPropagation(){this.nativeEvent.stopPropagation(),this.isPropagationStopped=()=>!0}isPropagationStopped(){return!1}persist(){}constructor(e,n){this.nativeEvent=n,this.target=n.target,this.currentTarget=n.currentTarget,this.relatedTarget=n.relatedTarget,this.bubbles=n.bubbles,this.cancelable=n.cancelable,this.defaultPrevented=n.defaultPrevented,this.eventPhase=n.eventPhase,this.isTrusted=n.isTrusted,this.timeStamp=n.timeStamp,this.type=e}};function Gde(t){let e=D.useRef({isFocused:!1,observer:null});It(()=>{const s=e.current;return()=>{s.observer&&(s.observer.disconnect(),s.observer=null)}},[]);let n=qt(s=>{t==null||t(s)});return D.useCallback(s=>{if(s.target instanceof HTMLButtonElement||s.target instanceof HTMLInputElement||s.target instanceof HTMLTextAreaElement||s.target instanceof HTMLSelectElement){e.current.isFocused=!0;let r=s.target,o=i=>{e.current.isFocused=!1,r.disabled&&n(new Ude("blur",i)),e.current.observer&&(e.current.observer.disconnect(),e.current.observer=null)};r.addEventListener("focusout",o,{once:!0}),e.current.observer=new MutationObserver(()=>{if(e.current.isFocused&&r.disabled){var i;(i=e.current.observer)===null||i===void 0||i.disconnect();let a=r===document.activeElement?null:document.activeElement;r.dispatchEvent(new FocusEvent("blur",{relatedTarget:a})),r.dispatchEvent(new FocusEvent("focusout",{bubbles:!0,relatedTarget:a}))}}),e.current.observer.observe(r,{attributes:!0,attributeFilter:["disabled"]})}},[n])}let bf=null,Hde=new Set,lc=new Map,pa=!1,iv=!1;function T$(t,e){for(let n of Hde)n(t,e)}function jde(t){return!(t.metaKey||!Br()&&t.altKey||t.ctrlKey||t.key==="Control"||t.key==="Shift"||t.key==="Meta")}function Gp(t){pa=!0,jde(t)&&(bf="keyboard",T$("keyboard",t))}function Ts(t){bf="pointer",(t.type==="mousedown"||t.type==="pointerdown")&&(pa=!0,T$("pointer",t))}function _L(t){po(t)&&(pa=!0,bf="virtual")}function zL(t){t.target===window||t.target===document||(!pa&&!iv&&(bf="virtual",T$("virtual",t)),pa=!1,iv=!1)}function VL(){pa=!1,iv=!0}function wI(t){if(typeof window>"u"||lc.get(lt(t)))return;const e=lt(t),n=$e(t);let s=e.HTMLElement.prototype.focus;e.HTMLElement.prototype.focus=function(){pa=!0,s.apply(this,arguments)},n.addEventListener("keydown",Gp,!0),n.addEventListener("keyup",Gp,!0),n.addEventListener("click",_L,!0),e.addEventListener("focus",zL,!0),e.addEventListener("blur",VL,!1),typeof PointerEvent<"u"?(n.addEventListener("pointerdown",Ts,!0),n.addEventListener("pointermove",Ts,!0),n.addEventListener("pointerup",Ts,!0)):(n.addEventListener("mousedown",Ts,!0),n.addEventListener("mousemove",Ts,!0),n.addEventListener("mouseup",Ts,!0)),e.addEventListener("beforeunload",()=>{BL(t)},{once:!0}),lc.set(e,{focus:s})}const BL=(t,e)=>{const n=lt(t),s=$e(t);e&&s.removeEventListener("DOMContentLoaded",e),lc.has(n)&&(n.HTMLElement.prototype.focus=lc.get(n).focus,s.removeEventListener("keydown",Gp,!0),s.removeEventListener("keyup",Gp,!0),s.removeEventListener("click",_L,!0),n.removeEventListener("focus",zL,!0),n.removeEventListener("blur",VL,!1),typeof PointerEvent<"u"?(s.removeEventListener("pointerdown",Ts,!0),s.removeEventListener("pointermove",Ts,!0),s.removeEventListener("pointerup",Ts,!0)):(s.removeEventListener("mousedown",Ts,!0),s.removeEventListener("mousemove",Ts,!0),s.removeEventListener("mouseup",Ts,!0)),lc.delete(n))};function Kde(t){const e=$e(t);let n;return e.readyState!=="loading"?wI(t):(n=()=>{wI(t)},e.addEventListener("DOMContentLoaded",n)),()=>BL(t,n)}typeof document<"u"&&Kde();function Xde(){return bf}function WL(t){let{isDisabled:e,onBlurWithin:n,onFocusWithin:s,onFocusWithinChange:r}=t,o=D.useRef({isFocusWithin:!1}),i=D.useCallback(u=>{o.current.isFocusWithin&&!u.currentTarget.contains(u.relatedTarget)&&(o.current.isFocusWithin=!1,n&&n(u),r&&r(!1))},[n,r,o]),a=Gde(i),l=D.useCallback(u=>{!o.current.isFocusWithin&&document.activeElement===u.target&&(s&&s(u),r&&r(!0),o.current.isFocusWithin=!0,a(u))},[s,r,a]);return e?{focusWithinProps:{onFocus:void 0,onBlur:void 0}}:{focusWithinProps:{onFocus:l,onBlur:i}}}function qde(t){let{ref:e,onInteractOutside:n,isDisabled:s,onInteractOutsideStart:r}=t,o=D.useRef({isPointerDown:!1,ignoreEmulatedMouseEvents:!1}),i=qt(l=>{n&&uh(l,e)&&(r&&r(l),o.current.isPointerDown=!0)}),a=qt(l=>{n&&n(l)});D.useEffect(()=>{let l=o.current;if(s)return;const u=e.current,c=$e(u);if(typeof PointerEvent<"u"){let d=f=>{l.isPointerDown&&uh(f,e)&&a(f),l.isPointerDown=!1};return c.addEventListener("pointerdown",i,!0),c.addEventListener("pointerup",d,!0),()=>{c.removeEventListener("pointerdown",i,!0),c.removeEventListener("pointerup",d,!0)}}else{let d=h=>{l.ignoreEmulatedMouseEvents?l.ignoreEmulatedMouseEvents=!1:l.isPointerDown&&uh(h,e)&&a(h),l.isPointerDown=!1},f=h=>{l.ignoreEmulatedMouseEvents=!0,l.isPointerDown&&uh(h,e)&&a(h),l.isPointerDown=!1};return c.addEventListener("mousedown",i,!0),c.addEventListener("mouseup",d,!0),c.addEventListener("touchstart",i,!0),c.addEventListener("touchend",f,!0),()=>{c.removeEventListener("mousedown",i,!0),c.removeEventListener("mouseup",d,!0),c.removeEventListener("touchstart",i,!0),c.removeEventListener("touchend",f,!0)}}},[e,s,i,a])}function uh(t,e){if(t.button>0)return!1;if(t.target){const n=t.target.ownerDocument;if(!n||!n.documentElement.contains(t.target)||t.target.closest("[data-react-aria-top-layer]"))return!1}return e.current&&!e.current.contains(t.target)}function Yde(t){const e=$e(t);if(Xde()==="virtual"){let n=e.activeElement;fu(()=>{e.activeElement===n&&t.isConnected&&cn(t)})}else cn(t)}function Qde(t){const e=lt(t);if(!(t instanceof e.HTMLElement)&&!(t instanceof e.SVGElement))return!1;let{display:n,visibility:s}=t.style,r=n!=="none"&&s!=="hidden"&&s!=="collapse";if(r){const{getComputedStyle:o}=t.ownerDocument.defaultView;let{display:i,visibility:a}=o(t);r=i!=="none"&&a!=="hidden"&&a!=="collapse"}return r}function Zde(t,e){return!t.hasAttribute("hidden")&&!t.hasAttribute("data-react-aria-prevent-focus")&&(t.nodeName==="DETAILS"&&e&&e.nodeName!=="SUMMARY"?t.hasAttribute("open"):!0)}function UL(t,e){return t.nodeName!=="#comment"&&Qde(t)&&Zde(t,e)&&(!t.parentElement||UL(t.parentElement,t))}const $I=Xe.createContext(null);let ot=null;function Jde(t){let{children:e,contain:n,restoreFocus:s,autoFocus:r}=t,o=D.useRef(null),i=D.useRef(null),a=D.useRef([]),{parentNode:l}=D.useContext($I)||{},u=D.useMemo(()=>new av({scopeRef:a}),[a]);It(()=>{let f=l||_t.root;if(_t.getTreeNode(f.scopeRef)&&ot&&!jp(ot,f.scopeRef)){let h=_t.getTreeNode(ot);h&&(f=h)}f.addChild(u),_t.addNode(u)},[u,l]),It(()=>{let f=_t.getTreeNode(a);f&&(f.contain=!!n)},[n]),It(()=>{var f;let h=(f=o.current)===null||f===void 0?void 0:f.nextSibling,p=[];for(;h&&h!==i.current;)p.push(h),h=h.nextSibling;a.current=p},[e]),ife(a,s,n),sfe(a,n),lfe(a,s,n),ofe(a,r),D.useEffect(()=>{const f=$e(a.current?a.current[0]:void 0).activeElement;let h=null;if(Tn(f,a.current)){for(let p of _t.traverse())p.scopeRef&&Tn(f,p.scopeRef.current)&&(h=p);h===_t.getTreeNode(a)&&(ot=h.scopeRef)}},[a]),It(()=>()=>{var f,h,p;let g=(p=(h=_t.getTreeNode(a))===null||h===void 0||(f=h.parent)===null||f===void 0?void 0:f.scopeRef)!==null&&p!==void 0?p:null;(a===ot||jp(a,ot))&&(!g||_t.getTreeNode(g))&&(ot=g),_t.removeTreeNode(a)},[a]);let c=D.useMemo(()=>efe(a),[]),d=D.useMemo(()=>({focusManager:c,parentNode:u}),[u,c]);return Xe.createElement($I.Provider,{value:d},Xe.createElement("span",{"data-focus-scope-start":!0,hidden:!0,ref:o}),e,Xe.createElement("span",{"data-focus-scope-end":!0,hidden:!0,ref:i}))}function efe(t){return{focusNext(e={}){let n=t.current,{from:s,tabbable:r,wrap:o,accept:i}=e,a=s||$e(n[0]).activeElement,l=n[0].previousElementSibling,u=Mi(n),c=_o(u,{tabbable:r,accept:i},n);c.currentNode=Tn(a,n)?a:l;let d=c.nextNode();return!d&&o&&(c.currentNode=l,d=c.nextNode()),d&&to(d,!0),d},focusPrevious(e={}){let n=t.current,{from:s,tabbable:r,wrap:o,accept:i}=e,a=s||$e(n[0]).activeElement,l=n[n.length-1].nextElementSibling,u=Mi(n),c=_o(u,{tabbable:r,accept:i},n);c.currentNode=Tn(a,n)?a:l;let d=c.previousNode();return!d&&o&&(c.currentNode=l,d=c.previousNode()),d&&to(d,!0),d},focusFirst(e={}){let n=t.current,{tabbable:s,accept:r}=e,o=Mi(n),i=_o(o,{tabbable:s,accept:r},n);i.currentNode=n[0].previousElementSibling;let a=i.nextNode();return a&&to(a,!0),a},focusLast(e={}){let n=t.current,{tabbable:s,accept:r}=e,o=Mi(n),i=_o(o,{tabbable:s,accept:r},n);i.currentNode=n[n.length-1].nextElementSibling;let a=i.previousNode();return a&&to(a,!0),a}}}const E$=["input:not([disabled]):not([type=hidden])","select:not([disabled])","textarea:not([disabled])","button:not([disabled])","a[href]","area[href]","summary","iframe","object","embed","audio[controls]","video[controls]","[contenteditable]"],tfe=E$.join(":not([hidden]),")+",[tabindex]:not([disabled]):not([hidden])";E$.push('[tabindex]:not([tabindex="-1"]):not([disabled])');const nfe=E$.join(':not([hidden]):not([tabindex="-1"]),');function Mi(t){return t[0].parentElement}function Ku(t){let e=_t.getTreeNode(ot);for(;e&&e.scopeRef!==t;){if(e.contain)return!1;e=e.parent}return!0}function sfe(t,e){let n=D.useRef(),s=D.useRef();It(()=>{let r=t.current;if(!e){s.current&&(cancelAnimationFrame(s.current),s.current=void 0);return}const o=$e(r?r[0]:void 0);let i=u=>{if(u.key!=="Tab"||u.altKey||u.ctrlKey||u.metaKey||!Ku(t)||u.isComposing)return;let c=o.activeElement,d=t.current;if(!d||!Tn(c,d))return;let f=Mi(d),h=_o(f,{tabbable:!0},d);if(!c)return;h.currentNode=c;let p=u.shiftKey?h.previousNode():h.nextNode();p||(h.currentNode=u.shiftKey?d[d.length-1].nextElementSibling:d[0].previousElementSibling,p=u.shiftKey?h.previousNode():h.nextNode()),u.preventDefault(),p&&to(p,!0)},a=u=>{(!ot||jp(ot,t))&&Tn(u.target,t.current)?(ot=t,n.current=u.target):Ku(t)&&!Hp(u.target,t)?n.current?n.current.focus():ot&&ot.current&&Kp(ot.current):Ku(t)&&(n.current=u.target)},l=u=>{s.current&&cancelAnimationFrame(s.current),s.current=requestAnimationFrame(()=>{if(o.activeElement&&Ku(t)&&!Hp(o.activeElement,t))if(ot=t,o.body.contains(u.target)){var c;n.current=u.target,(c=n.current)===null||c===void 0||c.focus()}else ot.current&&Kp(ot.current)})};return o.addEventListener("keydown",i,!1),o.addEventListener("focusin",a,!1),r==null||r.forEach(u=>u.addEventListener("focusin",a,!1)),r==null||r.forEach(u=>u.addEventListener("focusout",l,!1)),()=>{o.removeEventListener("keydown",i,!1),o.removeEventListener("focusin",a,!1),r==null||r.forEach(u=>u.removeEventListener("focusin",a,!1)),r==null||r.forEach(u=>u.removeEventListener("focusout",l,!1))}},[t,e]),It(()=>()=>{s.current&&cancelAnimationFrame(s.current)},[s])}function GL(t){return Hp(t)}function Tn(t,e){return!t||!e?!1:e.some(n=>n.contains(t))}function Hp(t,e=null){if(t instanceof Element&&t.closest("[data-react-aria-top-layer]"))return!0;for(let{scopeRef:n}of _t.traverse(_t.getTreeNode(e)))if(n&&Tn(t,n.current))return!0;return!1}function rfe(t){return Hp(t,ot)}function jp(t,e){var n;let s=(n=_t.getTreeNode(e))===null||n===void 0?void 0:n.parent;for(;s;){if(s.scopeRef===t)return!0;s=s.parent}return!1}function to(t,e=!1){if(t!=null&&!e)try{Yde(t)}catch{}else if(t!=null)try{t.focus()}catch{}}function Kp(t,e=!0){let n=t[0].previousElementSibling,s=Mi(t),r=_o(s,{tabbable:e},t);r.currentNode=n;let o=r.nextNode();e&&!o&&(s=Mi(t),r=_o(s,{tabbable:!1},t),r.currentNode=n,o=r.nextNode()),to(o)}function ofe(t,e){const n=Xe.useRef(e);D.useEffect(()=>{if(n.current){ot=t;const s=$e(t.current?t.current[0]:void 0);!Tn(s.activeElement,ot.current)&&t.current&&Kp(t.current)}n.current=!1},[t])}function ife(t,e,n){It(()=>{if(e||n)return;let s=t.current;const r=$e(s?s[0]:void 0);let o=i=>{let a=i.target;Tn(a,t.current)?ot=t:GL(a)||(ot=null)};return r.addEventListener("focusin",o,!1),s==null||s.forEach(i=>i.addEventListener("focusin",o,!1)),()=>{r.removeEventListener("focusin",o,!1),s==null||s.forEach(i=>i.removeEventListener("focusin",o,!1))}},[t,e,n])}function afe(t){let e=_t.getTreeNode(ot);for(;e&&e.scopeRef!==t;){if(e.nodeToRestore)return!1;e=e.parent}return(e==null?void 0:e.scopeRef)===t}function lfe(t,e,n){const s=D.useRef(typeof document<"u"?$e(t.current?t.current[0]:void 0).activeElement:null);It(()=>{let r=t.current;const o=$e(r?r[0]:void 0);if(!e||n)return;let i=()=>{(!ot||jp(ot,t))&&Tn(o.activeElement,t.current)&&(ot=t)};return o.addEventListener("focusin",i,!1),r==null||r.forEach(a=>a.addEventListener("focusin",i,!1)),()=>{o.removeEventListener("focusin",i,!1),r==null||r.forEach(a=>a.removeEventListener("focusin",i,!1))}},[t,n]),It(()=>{const r=$e(t.current?t.current[0]:void 0);if(!e)return;let o=i=>{if(i.key!=="Tab"||i.altKey||i.ctrlKey||i.metaKey||!Ku(t)||i.isComposing)return;let a=r.activeElement;if(!Tn(a,t.current))return;let l=_t.getTreeNode(t);if(!l)return;let u=l.nodeToRestore,c=_o(r.body,{tabbable:!0});c.currentNode=a;let d=i.shiftKey?c.previousNode():c.nextNode();if((!u||!r.body.contains(u)||u===r.body)&&(u=void 0,l.nodeToRestore=void 0),(!d||!Tn(d,t.current))&&u){c.currentNode=u;do d=i.shiftKey?c.previousNode():c.nextNode();while(Tn(d,t.current));i.preventDefault(),i.stopPropagation(),d?to(d,!0):GL(u)?to(u,!0):a.blur()}};return n||r.addEventListener("keydown",o,!0),()=>{n||r.removeEventListener("keydown",o,!0)}},[t,e,n]),It(()=>{const r=$e(t.current?t.current[0]:void 0);if(!e)return;let o=_t.getTreeNode(t);if(o){var i;return o.nodeToRestore=(i=s.current)!==null&&i!==void 0?i:void 0,()=>{let a=_t.getTreeNode(t);if(!a)return;let l=a.nodeToRestore;if(e&&l&&(Tn(r.activeElement,t.current)||r.activeElement===r.body&&afe(t))){let u=_t.clone();requestAnimationFrame(()=>{if(r.activeElement===r.body){let c=u.getTreeNode(t);for(;c;){if(c.nodeToRestore&&c.nodeToRestore.isConnected){to(c.nodeToRestore);return}c=c.parent}for(c=u.getTreeNode(t);c;){if(c.scopeRef&&c.scopeRef.current&&_t.getTreeNode(c.scopeRef)){Kp(c.scopeRef.current,!0);return}c=c.parent}}})}}}},[t,e])}function _o(t,e,n){let s=e!=null&&e.tabbable?nfe:tfe,r=$e(t).createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode(o){var i;return!(e==null||(i=e.from)===null||i===void 0)&&i.contains(o)?NodeFilter.FILTER_REJECT:o.matches(s)&&UL(o)&&(!n||Tn(o,n))&&(!(e!=null&&e.accept)||e.accept(o))?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});return e!=null&&e.from&&(r.currentNode=e.from),r}let ufe=class HL{get size(){return this.fastMap.size}getTreeNode(e){return this.fastMap.get(e)}addTreeNode(e,n,s){let r=this.fastMap.get(n??null);if(!r)return;let o=new av({scopeRef:e});r.addChild(o),o.parent=r,this.fastMap.set(e,o),s&&(o.nodeToRestore=s)}addNode(e){this.fastMap.set(e.scopeRef,e)}removeTreeNode(e){if(e===null)return;let n=this.fastMap.get(e);if(!n)return;let s=n.parent;for(let o of this.traverse())o!==n&&n.nodeToRestore&&o.nodeToRestore&&n.scopeRef&&n.scopeRef.current&&Tn(o.nodeToRestore,n.scopeRef.current)&&(o.nodeToRestore=n.nodeToRestore);let r=n.children;s&&(s.removeChild(n),r.size>0&&r.forEach(o=>s&&s.addChild(o))),this.fastMap.delete(n.scopeRef)}*traverse(e=this.root){if(e.scopeRef!=null&&(yield e),e.children.size>0)for(let n of e.children)yield*this.traverse(n)}clone(){var e;let n=new HL;var s;for(let r of this.traverse())n.addTreeNode(r.scopeRef,(s=(e=r.parent)===null||e===void 0?void 0:e.scopeRef)!==null&&s!==void 0?s:null,r.nodeToRestore);return n}constructor(){this.fastMap=new Map,this.root=new av({scopeRef:null}),this.fastMap.set(null,this.root)}},av=class{addChild(e){this.children.add(e),e.parent=this}removeChild(e){this.children.delete(e),e.parent=void 0}constructor(e){this.children=new Set,this.contain=!1,this.scopeRef=e.scopeRef}},_t=new ufe;const CI={border:0,clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"};function cfe(t={}){let{style:e,isFocusable:n}=t,[s,r]=D.useState(!1),{focusWithinProps:o}=WL({isDisabled:!n,onFocusWithinChange:a=>r(a)}),i=D.useMemo(()=>s?e:e?{...CI,...e}:CI,[s]);return{visuallyHiddenProps:{...o,style:i}}}function dfe(t){let{children:e,elementType:n="div",isFocusable:s,style:r,...o}=t,{visuallyHiddenProps:i}=cfe(t);return Xe.createElement(n,$t(o,i),e)}function ffe(t){return t&&t.__esModule?t.default:t}const Gr=[];function hfe(t,e){let{onClose:n,shouldCloseOnBlur:s,isOpen:r,isDismissable:o=!1,isKeyboardDismissDisabled:i=!1,shouldCloseOnInteractOutside:a}=t;D.useEffect(()=>(r&&Gr.push(e),()=>{let p=Gr.indexOf(e);p>=0&&Gr.splice(p,1)}),[r,e]);let l=()=>{Gr[Gr.length-1]===e&&n&&n()},u=p=>{(!a||a(p.target))&&Gr[Gr.length-1]===e&&(p.stopPropagation(),p.preventDefault())},c=p=>{(!a||a(p.target))&&(Gr[Gr.length-1]===e&&(p.stopPropagation(),p.preventDefault()),l())},d=p=>{p.key==="Escape"&&!i&&(p.stopPropagation(),p.preventDefault(),l())};qde({ref:e,onInteractOutside:o&&r?c:null,onInteractOutsideStart:u});let{focusWithinProps:f}=WL({isDisabled:!s,onBlurWithin:p=>{!p.relatedTarget||rfe(p.relatedTarget)||(!a||a(p.relatedTarget))&&n()}}),h=p=>{p.target===p.currentTarget&&p.preventDefault()};return{overlayProps:{onKeyDown:d,...f},underlayProps:{onPointerDown:h}}}const ux=typeof document<"u"&&window.visualViewport,pfe=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);let ch=0,cx;function mfe(t={}){let{isDisabled:e}=t;It(()=>{if(!e)return ch++,ch===1&&(vf()?cx=xfe():cx=gfe()),()=>{ch--,ch===0&&cx()}},[e])}function gfe(){return Vr(al(document.documentElement,"paddingRight",`${window.innerWidth-document.documentElement.clientWidth}px`),al(document.documentElement,"overflow","hidden"))}function xfe(){let t,e,n=u=>{t=QO(u.target,!0),!(t===document.documentElement&&t===document.body)&&t instanceof HTMLElement&&window.getComputedStyle(t).overscrollBehavior==="auto"&&(e=al(t,"overscrollBehavior","contain"))},s=u=>{if(!t||t===document.documentElement||t===document.body){u.preventDefault();return}t.scrollHeight===t.clientHeight&&t.scrollWidth===t.clientWidth&&u.preventDefault()},r=u=>{let c=u.target;SI(c)&&c!==document.activeElement&&(u.preventDefault(),a(),c.style.transform="translateY(-2000px)",c.focus(),requestAnimationFrame(()=>{c.style.transform=""})),e&&e()},o=u=>{let c=u.target;SI(c)&&(a(),c.style.transform="translateY(-2000px)",requestAnimationFrame(()=>{c.style.transform="",ux&&(ux.height<window.innerHeight?requestAnimationFrame(()=>{kI(c)}):ux.addEventListener("resize",()=>kI(c),{once:!0}))}))},i=null,a=()=>{if(i)return;let u=()=>{window.scrollTo(0,0)},c=window.pageXOffset,d=window.pageYOffset;i=Vr(Ru(window,"scroll",u),al(document.documentElement,"paddingRight",`${window.innerWidth-document.documentElement.clientWidth}px`),al(document.documentElement,"overflow","hidden"),al(document.body,"marginTop",`-${d}px`),()=>{window.scrollTo(c,d)}),window.scrollTo(0,0)},l=Vr(Ru(document,"touchstart",n,{passive:!1,capture:!0}),Ru(document,"touchmove",s,{passive:!1,capture:!0}),Ru(document,"touchend",r,{passive:!1,capture:!0}),Ru(document,"focus",o,!0));return()=>{e==null||e(),i==null||i(),l()}}function al(t,e,n){let s=t.style[e];return t.style[e]=n,()=>{t.style[e]=s}}function Ru(t,e,n,s){return t.addEventListener(e,n,s),()=>{t.removeEventListener(e,n,s)}}function kI(t){let e=document.scrollingElement||document.documentElement;for(;t&&t!==e;){let n=QO(t);if(n!==document.documentElement&&n!==document.body&&n!==t){let s=n.getBoundingClientRect().top,r=t.getBoundingClientRect().top;r>s+t.clientHeight&&(n.scrollTop+=r-s)}t=n.parentElement}}function SI(t){return t instanceof HTMLInputElement&&!pfe.has(t.type)||t instanceof HTMLTextAreaElement||t instanceof HTMLElement&&t.isContentEditable}var jL={};jL={"ar-AE":eL,"bg-BG":tL,"cs-CZ":nL,"da-DK":sL,"de-DE":rL,"el-GR":oL,"en-US":iL,"es-ES":aL,"et-EE":lL,"fi-FI":uL,"fr-FR":cL,"he-IL":dL,"hr-HR":fL,"hu-HU":hL,"it-IT":pL,"ja-JP":mL,"ko-KR":gL,"lt-LT":xL,"lv-LV":yL,"nb-NO":vL,"nl-NL":bL,"pl-PL":wL,"pt-BR":$L,"pt-PT":CL,"ro-RO":kL,"ru-RU":SL,"sk-SK":IL,"sl-SI":TL,"sr-SP":EL,"sv-SE":NL,"tr-TR":RL,"uk-UA":AL,"zh-CN":DL,"zh-TW":FL};function II(t){let{onDismiss:e,...n}=t,s=zde(ffe(jL),"@react-aria/overlays"),r=Ede(n,s.format("dismiss")),o=()=>{e&&e()};return Xe.createElement(dfe,null,Xe.createElement("button",{...r,tabIndex:-1,onClick:o,style:{width:1,height:1}}))}let Au=new WeakMap,Cs=[];function yfe(t,e=document.body){let n=new Set(t),s=new Set,r=l=>{for(let f of l.querySelectorAll("[data-live-announcer], [data-react-aria-top-layer]"))n.add(f);let u=f=>{if(n.has(f)||s.has(f.parentElement)&&f.parentElement.getAttribute("role")!=="row")return NodeFilter.FILTER_REJECT;for(let h of n)if(f.contains(h))return NodeFilter.FILTER_SKIP;return NodeFilter.FILTER_ACCEPT},c=document.createTreeWalker(l,NodeFilter.SHOW_ELEMENT,{acceptNode:u}),d=u(l);if(d===NodeFilter.FILTER_ACCEPT&&o(l),d!==NodeFilter.FILTER_REJECT){let f=c.nextNode();for(;f!=null;)o(f),f=c.nextNode()}},o=l=>{var u;let c=(u=Au.get(l))!==null&&u!==void 0?u:0;l.getAttribute("aria-hidden")==="true"&&c===0||(c===0&&l.setAttribute("aria-hidden","true"),s.add(l),Au.set(l,c+1))};Cs.length&&Cs[Cs.length-1].disconnect(),r(e);let i=new MutationObserver(l=>{for(let u of l)if(!(u.type!=="childList"||u.addedNodes.length===0)&&![...n,...s].some(c=>c.contains(u.target))){for(let c of u.removedNodes)c instanceof Element&&(n.delete(c),s.delete(c));for(let c of u.addedNodes)(c instanceof HTMLElement||c instanceof SVGElement)&&(c.dataset.liveAnnouncer==="true"||c.dataset.reactAriaTopLayer==="true")?n.add(c):c instanceof Element&&r(c)}});i.observe(e,{childList:!0,subtree:!0});let a={observe(){i.observe(e,{childList:!0,subtree:!0})},disconnect(){i.disconnect()}};return Cs.push(a),()=>{i.disconnect();for(let l of s){let u=Au.get(l);u===1?(l.removeAttribute("aria-hidden"),Au.delete(l)):Au.set(l,u-1)}a===Cs[Cs.length-1]?(Cs.pop(),Cs.length&&Cs[Cs.length-1].observe()):Cs.splice(Cs.indexOf(a),1)}}const KL=Xe.createContext(null);function vfe(t){let e=k$(),{portalContainer:n=e?null:document.body,isExiting:s}=t,[r,o]=D.useState(!1),i=D.useMemo(()=>({contain:r,setContain:o}),[r,o]);if(!n)return null;let a=t.children;return t.disableFocusManagement||(a=Xe.createElement(Jde,{restoreFocus:!0,contain:r&&!s},a)),a=Xe.createElement(KL.Provider,{value:i},Xe.createElement(Wde,null,a)),zz.createPortal(a,n)}function bfe(){let t=D.useContext(KL),e=t==null?void 0:t.setContain;It(()=>{e==null||e(!0)},[e])}const N$=D.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"}),a0=D.createContext({}),R$=D.createContext(null),A$=typeof document<"u",D$=A$?D.useLayoutEffect:D.useEffect,F$=D.createContext({strict:!1}),P$=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),wfe="framerAppearId",XL="data-"+P$(wfe),$fe={skipAnimations:!1,useManualTiming:!1};class TI{constructor(){this.order=[],this.scheduled=new Set}add(e){if(!this.scheduled.has(e))return this.scheduled.add(e),this.order.push(e),!0}remove(e){const n=this.order.indexOf(e);n!==-1&&(this.order.splice(n,1),this.scheduled.delete(e))}clear(){this.order.length=0,this.scheduled.clear()}}function Cfe(t){let e=new TI,n=new TI,s=0,r=!1,o=!1;const i=new WeakSet,a={schedule:(l,u=!1,c=!1)=>{const d=c&&r,f=d?e:n;return u&&i.add(l),f.add(l)&&d&&r&&(s=e.order.length),l},cancel:l=>{n.remove(l),i.delete(l)},process:l=>{if(r){o=!0;return}if(r=!0,[e,n]=[n,e],n.clear(),s=e.order.length,s)for(let u=0;u<s;u++){const c=e.order[u];i.has(c)&&(a.schedule(c),t()),c(l)}r=!1,o&&(o=!1,a.process(l))}};return a}const dh=["read","resolveKeyframes","update","preRender","render","postRender"],kfe=40;function qL(t,e){let n=!1,s=!0;const r={delta:0,timestamp:0,isProcessing:!1},o=dh.reduce((d,f)=>(d[f]=Cfe(()=>n=!0),d),{}),i=d=>{o[d].process(r)},a=()=>{const d=performance.now();n=!1,r.delta=s?1e3/60:Math.max(Math.min(d-r.timestamp,kfe),1),r.timestamp=d,r.isProcessing=!0,dh.forEach(i),r.isProcessing=!1,n&&e&&(s=!1,t(a))},l=()=>{n=!0,s=!0,r.isProcessing||t(a)};return{schedule:dh.reduce((d,f)=>{const h=o[f];return d[f]=(p,g=!1,y=!1)=>(n||l(),h.schedule(p,g,y)),d},{}),cancel:d=>dh.forEach(f=>o[f].cancel(d)),state:r,steps:o}}const{schedule:Sfe,cancel:Axe}=qL(queueMicrotask,!1);function Ife(t,e,n,s){const{visualElement:r}=D.useContext(a0),o=D.useContext(F$),i=D.useContext(R$),a=D.useContext(N$).reducedMotion,l=D.useRef();s=s||o.renderer,!l.current&&s&&(l.current=s(t,{visualState:e,parent:r,props:n,presenceContext:i,blockInitialAnimation:i?i.initial===!1:!1,reducedMotionConfig:a}));const u=l.current;D.useInsertionEffect(()=>{u&&u.update(n,i)});const c=D.useRef(!!(n[XL]&&!window.HandoffComplete));return D$(()=>{u&&(Sfe.render(u.render),c.current&&u.animationState&&u.animationState.animateChanges())}),D.useEffect(()=>{u&&(u.updateFeatures(),!c.current&&u.animationState&&u.animationState.animateChanges(),c.current&&(c.current=!1,window.HandoffComplete=!0))}),u}function YL(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function Tfe(t,e,n){return D.useCallback(s=>{s&&t.mount&&t.mount(s),e&&(s?e.mount(s):e.unmount()),n&&(typeof n=="function"?n(s):YL(n)&&(n.current=s))},[e])}function Hc(t){return typeof t=="string"||Array.isArray(t)}function l0(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}const O$=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],L$=["initial",...O$];function u0(t){return l0(t.animate)||L$.some(e=>Hc(t[e]))}function QL(t){return!!(u0(t)||t.variants)}function Efe(t,e){if(u0(t)){const{initial:n,animate:s}=t;return{initial:n===!1||Hc(n)?n:void 0,animate:Hc(s)?s:void 0}}return t.inherit!==!1?e:{}}function Nfe(t){const{initial:e,animate:n}=Efe(t,D.useContext(a0));return D.useMemo(()=>({initial:e,animate:n}),[EI(e),EI(n)])}function EI(t){return Array.isArray(t)?t.join(" "):t}const NI={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},jc={};for(const t in NI)jc[t]={isEnabled:e=>NI[t].some(n=>!!e[n])};function lv(t){for(const e in t)jc[e]={...jc[e],...t[e]}}const ZL=D.createContext({}),Rfe=D.createContext({}),Afe=Symbol.for("motionComponentSymbol");function Dfe({preloadedFeatures:t,createVisualElement:e,useRender:n,useVisualState:s,Component:r}){t&&lv(t);function o(a,l){let u;const c={...D.useContext(N$),...a,layoutId:Ffe(a)},{isStatic:d}=c,f=Nfe(a),h=s(a,d);if(!d&&A$){f.visualElement=Ife(r,h,c,e);const p=D.useContext(Rfe),g=D.useContext(F$).strict;f.visualElement&&(u=f.visualElement.loadFeatures(c,g,t,p))}return j.jsxs(a0.Provider,{value:f,children:[u&&f.visualElement?j.jsx(u,{visualElement:f.visualElement,...c}):null,n(r,a,Tfe(h,f.visualElement,l),h,d,f.visualElement)]})}const i=D.forwardRef(o);return i[Afe]=r,i}function Ffe({layoutId:t}){const e=D.useContext(ZL).id;return e&&t!==void 0?e+"-"+t:t}function Pfe(t){function e(s,r={}){return Dfe(t(s,r))}if(typeof Proxy>"u")return e;const n=new Map;return new Proxy(e,{get:(s,r)=>(n.has(r)||n.set(r,e(r)),n.get(r))})}const Ofe=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function M$(t){return typeof t!="string"||t.includes("-")?!1:!!(Ofe.indexOf(t)>-1||/[A-Z]/u.test(t))}const Lfe={},wf=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Pa=new Set(wf);function JL(t,{layout:e,layoutId:n}){return Pa.has(t)||t.startsWith("origin")||(e||n!==void 0)&&(!!Lfe[t]||t==="opacity")}const zn=t=>!!(t&&t.getVelocity),Mfe={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},_fe=wf.length;function zfe(t,{enableHardwareAcceleration:e=!0,allowTransformNone:n=!0},s,r){let o="";for(let i=0;i<_fe;i++){const a=wf[i];if(t[a]!==void 0){const l=Mfe[a]||a;o+=`${l}(${t[a]}) `}}return e&&!t.z&&(o+="translateZ(0)"),o=o.trim(),r?o=r(t,s?"":o):n&&s&&(o="none"),o}const e3=t=>e=>typeof e=="string"&&e.startsWith(t),t3=e3("--"),Vfe=e3("var(--"),_$=t=>Vfe(t)?Bfe.test(t.split("/*")[0].trim()):!1,Bfe=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Wfe=(t,e)=>e&&typeof t=="number"?e.transform(t):t,Ul=(t,e,n)=>n>e?e:n<t?t:n,hu={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},uc={...hu,transform:t=>Ul(0,1,t)},fh={...hu,default:1},cc=t=>Math.round(t*1e5)/1e5,z$=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu,Ufe=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu,Gfe=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu;function $f(t){return typeof t=="string"}const Cf=t=>({test:e=>$f(e)&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),To=Cf("deg"),$l=Cf("%"),we=Cf("px"),Hfe=Cf("vh"),jfe=Cf("vw"),RI={...$l,parse:t=>$l.parse(t)/100,transform:t=>$l.transform(t*100)},AI={...hu,transform:Math.round},n3={borderWidth:we,borderTopWidth:we,borderRightWidth:we,borderBottomWidth:we,borderLeftWidth:we,borderRadius:we,radius:we,borderTopLeftRadius:we,borderTopRightRadius:we,borderBottomRightRadius:we,borderBottomLeftRadius:we,width:we,maxWidth:we,height:we,maxHeight:we,size:we,top:we,right:we,bottom:we,left:we,padding:we,paddingTop:we,paddingRight:we,paddingBottom:we,paddingLeft:we,margin:we,marginTop:we,marginRight:we,marginBottom:we,marginLeft:we,rotate:To,rotateX:To,rotateY:To,rotateZ:To,scale:fh,scaleX:fh,scaleY:fh,scaleZ:fh,skew:To,skewX:To,skewY:To,distance:we,translateX:we,translateY:we,translateZ:we,x:we,y:we,z:we,perspective:we,transformPerspective:we,opacity:uc,originX:RI,originY:RI,originZ:we,zIndex:AI,backgroundPositionX:we,backgroundPositionY:we,fillOpacity:uc,strokeOpacity:uc,numOctaves:AI};function V$(t,e,n,s){const{style:r,vars:o,transform:i,transformOrigin:a}=t;let l=!1,u=!1,c=!0;for(const d in e){const f=e[d];if(t3(d)){o[d]=f;continue}const h=n3[d],p=Wfe(f,h);if(Pa.has(d)){if(l=!0,i[d]=p,!c)continue;f!==(h.default||0)&&(c=!1)}else d.startsWith("origin")?(u=!0,a[d]=p):r[d]=p}if(e.transform||(l||s?r.transform=zfe(t.transform,n,c,s):r.transform&&(r.transform="none")),u){const{originX:d="50%",originY:f="50%",originZ:h=0}=a;r.transformOrigin=`${d} ${f} ${h}`}}const B$=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function s3(t,e,n){for(const s in e)!zn(e[s])&&!JL(s,n)&&(t[s]=e[s])}function Kfe({transformTemplate:t},e,n){return D.useMemo(()=>{const s=B$();return V$(s,e,{enableHardwareAcceleration:!n},t),Object.assign({},s.vars,s.style)},[e])}function Xfe(t,e,n){const s=t.style||{},r={};return s3(r,s,t),Object.assign(r,Kfe(t,e,n)),r}function qfe(t,e,n){const s={},r=Xfe(t,e,n);return t.drag&&t.dragListener!==!1&&(s.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(s.tabIndex=0),s.style=r,s}const Yfe=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Xp(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||Yfe.has(t)}let r3=t=>!Xp(t);function Qfe(t){t&&(r3=e=>e.startsWith("on")?!Xp(e):t(e))}try{Qfe(require("@emotion/is-prop-valid").default)}catch{}function Zfe(t,e,n){const s={};for(const r in t)r==="values"&&typeof t.values=="object"||(r3(r)||n===!0&&Xp(r)||!e&&!Xp(r)||t.draggable&&r.startsWith("onDrag"))&&(s[r]=t[r]);return s}function DI(t,e,n){return typeof t=="string"?t:we.transform(e+n*t)}function Jfe(t,e,n){const s=DI(e,t.x,t.width),r=DI(n,t.y,t.height);return`${s} ${r}`}const ehe={offset:"stroke-dashoffset",array:"stroke-dasharray"},the={offset:"strokeDashoffset",array:"strokeDasharray"};function nhe(t,e,n=1,s=0,r=!0){t.pathLength=1;const o=r?ehe:the;t[o.offset]=we.transform(-s);const i=we.transform(e),a=we.transform(n);t[o.array]=`${i} ${a}`}function W$(t,{attrX:e,attrY:n,attrScale:s,originX:r,originY:o,pathLength:i,pathSpacing:a=1,pathOffset:l=0,...u},c,d,f){if(V$(t,u,c,f),d){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:h,style:p,dimensions:g}=t;h.transform&&(g&&(p.transform=h.transform),delete h.transform),g&&(r!==void 0||o!==void 0||p.transform)&&(p.transformOrigin=Jfe(g,r!==void 0?r:.5,o!==void 0?o:.5)),e!==void 0&&(h.x=e),n!==void 0&&(h.y=n),s!==void 0&&(h.scale=s),i!==void 0&&nhe(h,i,a,l,!1)}const o3=()=>({...B$(),attrs:{}}),U$=t=>typeof t=="string"&&t.toLowerCase()==="svg";function she(t,e,n,s){const r=D.useMemo(()=>{const o=o3();return W$(o,e,{enableHardwareAcceleration:!1},U$(s),t.transformTemplate),{...o.attrs,style:{...o.style}}},[e]);if(t.style){const o={};s3(o,t.style,t),r.style={...o,...r.style}}return r}function rhe(t=!1){return(n,s,r,{latestValues:o},i)=>{const l=(M$(n)?she:qfe)(s,o,i,n),u=Zfe(s,typeof n=="string",t),c=n!==D.Fragment?{...u,...l,ref:r}:{},{children:d}=s,f=D.useMemo(()=>zn(d)?d.get():d,[d]);return D.createElement(n,{...c,children:f})}}function i3(t,{style:e,vars:n},s,r){Object.assign(t.style,e,r&&r.getProjectionStyles(s));for(const o in n)t.style.setProperty(o,n[o])}const a3=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function l3(t,e,n,s){i3(t,e,void 0,s);for(const r in e.attrs)t.setAttribute(a3.has(r)?r:P$(r),e.attrs[r])}function G$(t,e,n){var s;const{style:r}=t,o={};for(const i in r)(zn(r[i])||e.style&&zn(e.style[i])||JL(i,t)||((s=n==null?void 0:n.getValue(i))===null||s===void 0?void 0:s.liveStyle)!==void 0)&&(o[i]=r[i]);return o}function u3(t,e,n){const s=G$(t,e,n);for(const r in t)if(zn(t[r])||zn(e[r])){const o=wf.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;s[o]=t[r]}return s}function FI(t){const e=[{},{}];return t==null||t.values.forEach((n,s)=>{e[0][s]=n.get(),e[1][s]=n.getVelocity()}),e}function H$(t,e,n,s){if(typeof e=="function"){const[r,o]=FI(s);e=e(n!==void 0?n:t.custom,r,o)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[r,o]=FI(s);e=e(n!==void 0?n:t.custom,r,o)}return e}function c3(t){const e=D.useRef(null);return e.current===null&&(e.current=t()),e.current}const uv=t=>Array.isArray(t),ohe=t=>!!(t&&typeof t=="object"&&t.mix&&t.toValue),ihe=t=>uv(t)?t[t.length-1]||0:t;function ahe(t){const e=zn(t)?t.get():t;return ohe(e)?e.toValue():e}function lhe({scrapeMotionValuesFromProps:t,createRenderState:e,onMount:n},s,r,o){const i={latestValues:uhe(s,r,o,t),renderState:e()};return n&&(i.mount=a=>n(s,a,i)),i}const d3=t=>(e,n)=>{const s=D.useContext(a0),r=D.useContext(R$),o=()=>lhe(t,e,s,r);return n?o():c3(o)};function uhe(t,e,n,s){const r={},o=s(t,{});for(const f in o)r[f]=ahe(o[f]);let{initial:i,animate:a}=t;const l=u0(t),u=QL(t);e&&u&&!l&&t.inherit!==!1&&(i===void 0&&(i=e.initial),a===void 0&&(a=e.animate));let c=n?n.initial===!1:!1;c=c||i===!1;const d=c?a:i;return d&&typeof d!="boolean"&&!l0(d)&&(Array.isArray(d)?d:[d]).forEach(h=>{const p=H$(t,h);if(!p)return;const{transitionEnd:g,transition:y,...m}=p;for(const x in m){let v=m[x];if(Array.isArray(v)){const b=c?v.length-1:0;v=v[b]}v!==null&&(r[x]=v)}for(const x in g)r[x]=g[x]}),r}const Pr=t=>t,{schedule:Zt,cancel:qp,state:Yp,steps:Dxe}=qL(typeof requestAnimationFrame<"u"?requestAnimationFrame:Pr,!0),che={useVisualState:d3({scrapeMotionValuesFromProps:u3,createRenderState:o3,onMount:(t,e,{renderState:n,latestValues:s})=>{Zt.read(()=>{try{n.dimensions=typeof e.getBBox=="function"?e.getBBox():e.getBoundingClientRect()}catch{n.dimensions={x:0,y:0,width:0,height:0}}}),Zt.render(()=>{W$(n,s,{enableHardwareAcceleration:!1},U$(e.tagName),t.transformTemplate),l3(e,n)})}})},dhe={useVisualState:d3({scrapeMotionValuesFromProps:G$,createRenderState:B$})};function fhe(t,{forwardMotionProps:e=!1},n,s){return{...M$(t)?che:dhe,preloadedFeatures:n,useRender:rhe(e),createVisualElement:s,Component:t}}function _i(t,e,n,s={passive:!0}){return t.addEventListener(e,n,s),()=>t.removeEventListener(e,n)}const hhe=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1;function f3(t,e="page"){return{point:{x:t[`${e}X`],y:t[`${e}Y`]}}}const phe=t=>e=>hhe(e)&&t(e,f3(e));function Lh(t,e,n,s){return _i(t,e,phe(n),s)}const mhe=(t,e)=>n=>e(t(n)),Qo=(...t)=>t.reduce(mhe);function h3(t){let e=null;return()=>{const n=()=>{e=null};return e===null?(e=t,n):!1}}const ghe=h3("dragHorizontal"),xhe=h3("dragVertical");function yhe(t){let e=!1;{const n=ghe(),s=xhe();n&&s?e=()=>{n(),s()}:(n&&n(),s&&s())}return e}function p3(){const t=yhe();return t?(t(),!1):!0}class pu{constructor(e){this.isMounted=!1,this.node=e}update(){}}function PI(t,e){const n=e?"pointerenter":"pointerleave",s=e?"onHoverStart":"onHoverEnd",r=(o,i)=>{if(o.pointerType==="touch"||p3())return;const a=t.getProps();t.animationState&&a.whileHover&&t.animationState.setActive("whileHover",e);const l=a[s];l&&Zt.postRender(()=>l(o,i))};return Lh(t.current,n,r,{passive:!t.getProps()[s]})}class vhe extends pu{mount(){this.unmount=Qo(PI(this.node,!0),PI(this.node,!1))}unmount(){}}class bhe extends pu{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Qo(_i(this.node.current,"focus",()=>this.onFocus()),_i(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const m3=(t,e)=>e?t===e?!0:m3(t,e.parentElement):!1;function dx(t,e){if(!e)return;const n=new PointerEvent("pointer"+t);e(n,f3(n))}class whe extends pu{constructor(){super(...arguments),this.removeStartListeners=Pr,this.removeEndListeners=Pr,this.removeAccessibleListeners=Pr,this.startPointerPress=(e,n)=>{if(this.isPressing)return;this.removeEndListeners();const s=this.node.getProps(),o=Lh(window,"pointerup",(a,l)=>{if(!this.checkPressEnd())return;const{onTap:u,onTapCancel:c,globalTapTarget:d}=this.node.getProps(),f=!d&&!m3(this.node.current,a.target)?c:u;f&&Zt.update(()=>f(a,l))},{passive:!(s.onTap||s.onPointerUp)}),i=Lh(window,"pointercancel",(a,l)=>this.cancelPress(a,l),{passive:!(s.onTapCancel||s.onPointerCancel)});this.removeEndListeners=Qo(o,i),this.startPress(e,n)},this.startAccessiblePress=()=>{const e=o=>{if(o.key!=="Enter"||this.isPressing)return;const i=a=>{a.key!=="Enter"||!this.checkPressEnd()||dx("up",(l,u)=>{const{onTap:c}=this.node.getProps();c&&Zt.postRender(()=>c(l,u))})};this.removeEndListeners(),this.removeEndListeners=_i(this.node.current,"keyup",i),dx("down",(a,l)=>{this.startPress(a,l)})},n=_i(this.node.current,"keydown",e),s=()=>{this.isPressing&&dx("cancel",(o,i)=>this.cancelPress(o,i))},r=_i(this.node.current,"blur",s);this.removeAccessibleListeners=Qo(n,r)}}startPress(e,n){this.isPressing=!0;const{onTapStart:s,whileTap:r}=this.node.getProps();r&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),s&&Zt.postRender(()=>s(e,n))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!p3()}cancelPress(e,n){if(!this.checkPressEnd())return;const{onTapCancel:s}=this.node.getProps();s&&Zt.postRender(()=>s(e,n))}mount(){const e=this.node.getProps(),n=Lh(e.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(e.onTapStart||e.onPointerStart)}),s=_i(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=Qo(n,s)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const cv=new WeakMap,fx=new WeakMap,$he=t=>{const e=cv.get(t.target);e&&e(t)},Che=t=>{t.forEach($he)};function khe({root:t,...e}){const n=t||document;fx.has(n)||fx.set(n,{});const s=fx.get(n),r=JSON.stringify(e);return s[r]||(s[r]=new IntersectionObserver(Che,{root:t,...e})),s[r]}function She(t,e,n){const s=khe(e);return cv.set(t,n),s.observe(t),()=>{cv.delete(t),s.unobserve(t)}}const Ihe={some:0,all:1};class The extends pu{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:n,margin:s,amount:r="some",once:o}=e,i={root:n?n.current:void 0,rootMargin:s,threshold:typeof r=="number"?r:Ihe[r]},a=l=>{const{isIntersecting:u}=l;if(this.isInView===u||(this.isInView=u,o&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:c,onViewportLeave:d}=this.node.getProps(),f=u?c:d;f&&f(l)};return She(this.node.current,i,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:n}=this.node;["amount","margin","root"].some(Ehe(e,n))&&this.startObserver()}unmount(){}}function Ehe({viewport:t={}},{viewport:e={}}={}){return n=>t[n]!==e[n]}const Nhe={inView:{Feature:The},tap:{Feature:whe},focus:{Feature:bhe},hover:{Feature:vhe}};function g3(t,e){if(!Array.isArray(e))return!1;const n=e.length;if(n!==t.length)return!1;for(let s=0;s<n;s++)if(e[s]!==t[s])return!1;return!0}function c0(t,e,n){const s=t.getProps();return H$(s,e,n!==void 0?n:s.custom,t)}const ji=t=>t*1e3,Zo=t=>t/1e3,Rhe={type:"spring",stiffness:500,damping:25,restSpeed:10},Ahe=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),Dhe={type:"keyframes",duration:.8},Fhe={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Phe=(t,{keyframes:e})=>e.length>2?Dhe:Pa.has(t)?t.startsWith("scale")?Ahe(e[1]):Rhe:Fhe;function Ohe({when:t,delay:e,delayChildren:n,staggerChildren:s,staggerDirection:r,repeat:o,repeatType:i,repeatDelay:a,from:l,elapsed:u,...c}){return!!Object.keys(c).length}function x3(t,e){return t[e]||t.default||t}const Lhe=t=>t!==null;function d0(t,{repeat:e,repeatType:n="loop"},s){const r=t.filter(Lhe),o=e&&n!=="loop"&&e%2===1?0:r.length-1;return!o||s===void 0?r[o]:s}let Mh;function Mhe(){Mh=void 0}const Cl={now:()=>(Mh===void 0&&Cl.set(Yp.isProcessing||$fe.useManualTiming?Yp.timestamp:performance.now()),Mh),set:t=>{Mh=t,queueMicrotask(Mhe)}},y3=t=>/^0[^.\s]+$/u.test(t);function _he(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||y3(t):!0}let dv=Pr;const v3=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t),zhe=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Vhe(t){const e=zhe.exec(t);if(!e)return[,];const[,n,s,r]=e;return[`--${n??s}`,r]}function b3(t,e,n=1){const[s,r]=Vhe(t);if(!s)return;const o=window.getComputedStyle(e).getPropertyValue(s);if(o){const i=o.trim();return v3(i)?parseFloat(i):i}return _$(r)?b3(r,e,n+1):r}const Bhe=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),OI=t=>t===hu||t===we,LI=(t,e)=>parseFloat(t.split(", ")[e]),MI=(t,e)=>(n,{transform:s})=>{if(s==="none"||!s)return 0;const r=s.match(/^matrix3d\((.+)\)$/u);if(r)return LI(r[1],e);{const o=s.match(/^matrix\((.+)\)$/u);return o?LI(o[1],t):0}},Whe=new Set(["x","y","z"]),Uhe=wf.filter(t=>!Whe.has(t));function Ghe(t){const e=[];return Uhe.forEach(n=>{const s=t.getValue(n);s!==void 0&&(e.push([n,s.get()]),s.set(n.startsWith("scale")?1:0))}),e}const Gl={width:({x:t},{paddingLeft:e="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),height:({y:t},{paddingTop:e="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:MI(4,13),y:MI(5,14)};Gl.translateX=Gl.x;Gl.translateY=Gl.y;const w3=t=>e=>e.test(t),Hhe={test:t=>t==="auto",parse:t=>t},$3=[hu,we,$l,To,jfe,Hfe,Hhe],_I=t=>$3.find(w3(t)),Ki=new Set;let fv=!1,hv=!1;function C3(){if(hv){const t=Array.from(Ki).filter(s=>s.needsMeasurement),e=new Set(t.map(s=>s.element)),n=new Map;e.forEach(s=>{const r=Ghe(s);r.length&&(n.set(s,r),s.render())}),t.forEach(s=>s.measureInitialState()),e.forEach(s=>{s.render();const r=n.get(s);r&&r.forEach(([o,i])=>{var a;(a=s.getValue(o))===null||a===void 0||a.set(i)})}),t.forEach(s=>s.measureEndState()),t.forEach(s=>{s.suspendedScrollY!==void 0&&window.scrollTo(0,s.suspendedScrollY)})}hv=!1,fv=!1,Ki.forEach(t=>t.complete()),Ki.clear()}function k3(){Ki.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(hv=!0)})}function jhe(){k3(),C3()}class j${constructor(e,n,s,r,o,i=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=n,this.name=s,this.motionValue=r,this.element=o,this.isAsync=i}scheduleResolve(){this.isScheduled=!0,this.isAsync?(Ki.add(this),fv||(fv=!0,Zt.read(k3),Zt.resolveKeyframes(C3))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:n,element:s,motionValue:r}=this;for(let o=0;o<e.length;o++)if(e[o]===null)if(o===0){const i=r==null?void 0:r.get(),a=e[e.length-1];if(i!==void 0)e[0]=i;else if(s&&n){const l=s.readValue(n,a);l!=null&&(e[0]=l)}e[0]===void 0&&(e[0]=a),r&&i===void 0&&r.set(e[0])}else e[o]=e[o-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),Ki.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,Ki.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const K$=(t,e)=>n=>!!($f(n)&&Gfe.test(n)&&n.startsWith(t)||e&&Object.prototype.hasOwnProperty.call(n,e)),S3=(t,e,n)=>s=>{if(!$f(s))return s;const[r,o,i,a]=s.match(z$);return{[t]:parseFloat(r),[e]:parseFloat(o),[n]:parseFloat(i),alpha:a!==void 0?parseFloat(a):1}},Khe=t=>Ul(0,255,t),hx={...hu,transform:t=>Math.round(Khe(t))},zi={test:K$("rgb","red"),parse:S3("red","green","blue"),transform:({red:t,green:e,blue:n,alpha:s=1})=>"rgba("+hx.transform(t)+", "+hx.transform(e)+", "+hx.transform(n)+", "+cc(uc.transform(s))+")"};function Xhe(t){let e="",n="",s="",r="";return t.length>5?(e=t.substring(1,3),n=t.substring(3,5),s=t.substring(5,7),r=t.substring(7,9)):(e=t.substring(1,2),n=t.substring(2,3),s=t.substring(3,4),r=t.substring(4,5),e+=e,n+=n,s+=s,r+=r),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(s,16),alpha:r?parseInt(r,16)/255:1}}const pv={test:K$("#"),parse:Xhe,transform:zi.transform},ll={test:K$("hsl","hue"),parse:S3("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:n,alpha:s=1})=>"hsla("+Math.round(t)+", "+$l.transform(cc(e))+", "+$l.transform(cc(n))+", "+cc(uc.transform(s))+")"},$n={test:t=>zi.test(t)||pv.test(t)||ll.test(t),parse:t=>zi.test(t)?zi.parse(t):ll.test(t)?ll.parse(t):pv.parse(t),transform:t=>$f(t)?t:t.hasOwnProperty("red")?zi.transform(t):ll.transform(t)};function qhe(t){var e,n;return isNaN(t)&&$f(t)&&(((e=t.match(z$))===null||e===void 0?void 0:e.length)||0)+(((n=t.match(Ufe))===null||n===void 0?void 0:n.length)||0)>0}const I3="number",T3="color",Yhe="var",Qhe="var(",zI="${}",Zhe=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Kc(t){const e=t.toString(),n=[],s={color:[],number:[],var:[]},r=[];let o=0;const a=e.replace(Zhe,l=>($n.test(l)?(s.color.push(o),r.push(T3),n.push($n.parse(l))):l.startsWith(Qhe)?(s.var.push(o),r.push(Yhe),n.push(l)):(s.number.push(o),r.push(I3),n.push(parseFloat(l))),++o,zI)).split(zI);return{values:n,split:a,indexes:s,types:r}}function E3(t){return Kc(t).values}function N3(t){const{split:e,types:n}=Kc(t),s=e.length;return r=>{let o="";for(let i=0;i<s;i++)if(o+=e[i],r[i]!==void 0){const a=n[i];a===I3?o+=cc(r[i]):a===T3?o+=$n.transform(r[i]):o+=r[i]}return o}}const Jhe=t=>typeof t=="number"?0:t;function epe(t){const e=E3(t);return N3(t)(e.map(Jhe))}const mu={test:qhe,parse:E3,createTransformer:N3,getAnimatableNone:epe},tpe=new Set(["brightness","contrast","saturate","opacity"]);function npe(t){const[e,n]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[s]=n.match(z$)||[];if(!s)return t;const r=n.replace(s,"");let o=tpe.has(e)?1:0;return s!==n&&(o*=100),e+"("+o+r+")"}const spe=/\b([a-z-]*)\(.*?\)/gu,mv={...mu,getAnimatableNone:t=>{const e=t.match(spe);return e?e.map(npe).join(" "):t}},rpe={...n3,color:$n,backgroundColor:$n,outlineColor:$n,fill:$n,stroke:$n,borderColor:$n,borderTopColor:$n,borderRightColor:$n,borderBottomColor:$n,borderLeftColor:$n,filter:mv,WebkitFilter:mv},X$=t=>rpe[t];function R3(t,e){let n=X$(t);return n!==mv&&(n=mu),n.getAnimatableNone?n.getAnimatableNone(e):void 0}const ope=new Set(["auto","none","0"]);function ipe(t,e,n){let s=0,r;for(;s<t.length&&!r;){const o=t[s];typeof o=="string"&&!ope.has(o)&&Kc(o).values.length&&(r=t[s]),s++}if(r&&n)for(const o of e)t[o]=R3(n,r)}class A3 extends j${constructor(e,n,s,r){super(e,n,s,r,r==null?void 0:r.owner,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:n,name:s}=this;if(!n.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let u=e[l];if(typeof u=="string"&&(u=u.trim(),_$(u))){const c=b3(u,n.current);c!==void 0&&(e[l]=c),l===e.length-1&&(this.finalKeyframe=u)}}if(this.resolveNoneKeyframes(),!Bhe.has(s)||e.length!==2)return;const[r,o]=e,i=_I(r),a=_I(o);if(i!==a)if(OI(i)&&OI(a))for(let l=0;l<e.length;l++){const u=e[l];typeof u=="string"&&(e[l]=parseFloat(u))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:n}=this,s=[];for(let r=0;r<e.length;r++)_he(e[r])&&s.push(r);s.length&&ipe(e,s,n)}measureInitialState(){const{element:e,unresolvedKeyframes:n,name:s}=this;if(!e.current)return;s==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Gl[s](e.measureViewportBox(),window.getComputedStyle(e.current)),n[0]=this.measuredOrigin;const r=n[n.length-1];r!==void 0&&e.getValue(s,r).jump(r,!1)}measureEndState(){var e;const{element:n,name:s,unresolvedKeyframes:r}=this;if(!n.current)return;const o=n.getValue(s);o&&o.jump(this.measuredOrigin,!1);const i=r.length-1,a=r[i];r[i]=Gl[s](n.measureViewportBox(),window.getComputedStyle(n.current)),a!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=a),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([l,u])=>{n.getValue(l).set(u)}),this.resolveNoneKeyframes()}}function D3(t){let e;return()=>(e===void 0&&(e=t()),e)}const VI=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(mu.test(t)||t==="0")&&!t.startsWith("url("));function ape(t){const e=t[0];if(t.length===1)return!0;for(let n=0;n<t.length;n++)if(t[n]!==e)return!0}function lpe(t,e,n,s){const r=t[0];if(r===null)return!1;if(e==="display"||e==="visibility")return!0;const o=t[t.length-1],i=VI(r,e),a=VI(o,e);return!i||!a?!1:ape(t)||n==="spring"&&s}class F3{constructor({autoplay:e=!0,delay:n=0,type:s="keyframes",repeat:r=0,repeatDelay:o=0,repeatType:i="loop",...a}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.options={autoplay:e,delay:n,type:s,repeat:r,repeatDelay:o,repeatType:i,...a},this.updateFinishedPromise()}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&jhe(),this._resolved}onKeyframesResolved(e,n){this.hasAttemptedResolve=!0;const{name:s,type:r,velocity:o,delay:i,onComplete:a,onUpdate:l,isGenerator:u}=this.options;if(!u&&!lpe(e,s,r,o))if(i)this.options.duration=0;else{l==null||l(d0(e,this.options,n)),a==null||a(),this.resolveFinishedPromise();return}const c=this.initPlayback(e,n);c!==!1&&(this._resolved={keyframes:e,finalKeyframe:n,...c},this.onPostResolved())}onPostResolved(){}then(e,n){return this.currentFinishedPromise.then(e,n)}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}function P3(t,e){return e?t*(1e3/e):0}const upe=5;function O3(t,e,n){const s=Math.max(e-upe,0);return P3(n-t(s),e-s)}const px=.001,cpe=.01,dpe=10,fpe=.05,hpe=1;function ppe({duration:t=800,bounce:e=.25,velocity:n=0,mass:s=1}){let r,o,i=1-e;i=Ul(fpe,hpe,i),t=Ul(cpe,dpe,Zo(t)),i<1?(r=u=>{const c=u*i,d=c*t,f=c-n,h=gv(u,i),p=Math.exp(-d);return px-f/h*p},o=u=>{const d=u*i*t,f=d*n+n,h=Math.pow(i,2)*Math.pow(u,2)*t,p=Math.exp(-d),g=gv(Math.pow(u,2),i);return(-r(u)+px>0?-1:1)*((f-h)*p)/g}):(r=u=>{const c=Math.exp(-u*t),d=(u-n)*t+1;return-px+c*d},o=u=>{const c=Math.exp(-u*t),d=(n-u)*(t*t);return c*d});const a=5/t,l=gpe(r,o,a);if(t=ji(t),isNaN(l))return{stiffness:100,damping:10,duration:t};{const u=Math.pow(l,2)*s;return{stiffness:u,damping:i*2*Math.sqrt(s*u),duration:t}}}const mpe=12;function gpe(t,e,n){let s=n;for(let r=1;r<mpe;r++)s=s-t(s)/e(s);return s}function gv(t,e){return t*Math.sqrt(1-e*e)}const xpe=["duration","bounce"],ype=["stiffness","damping","mass"];function BI(t,e){return e.some(n=>t[n]!==void 0)}function vpe(t){let e={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...t};if(!BI(t,ype)&&BI(t,xpe)){const n=ppe(t);e={...e,...n,mass:1},e.isResolvedFromDuration=!0}return e}function L3({keyframes:t,restDelta:e,restSpeed:n,...s}){const r=t[0],o=t[t.length-1],i={done:!1,value:r},{stiffness:a,damping:l,mass:u,duration:c,velocity:d,isResolvedFromDuration:f}=vpe({...s,velocity:-Zo(s.velocity||0)}),h=d||0,p=l/(2*Math.sqrt(a*u)),g=o-r,y=Zo(Math.sqrt(a/u)),m=Math.abs(g)<5;n||(n=m?.01:2),e||(e=m?.005:.5);let x;if(p<1){const v=gv(y,p);x=b=>{const $=Math.exp(-p*y*b);return o-$*((h+p*y*g)/v*Math.sin(v*b)+g*Math.cos(v*b))}}else if(p===1)x=v=>o-Math.exp(-y*v)*(g+(h+y*g)*v);else{const v=y*Math.sqrt(p*p-1);x=b=>{const $=Math.exp(-p*y*b),C=Math.min(v*b,300);return o-$*((h+p*y*g)*Math.sinh(C)+v*g*Math.cosh(C))/v}}return{calculatedDuration:f&&c||null,next:v=>{const b=x(v);if(f)i.done=v>=c;else{let $=h;v!==0&&(p<1?$=O3(x,v,b):$=0);const C=Math.abs($)<=n,k=Math.abs(o-b)<=e;i.done=C&&k}return i.value=i.done?o:b,i}}}function WI({keyframes:t,velocity:e=0,power:n=.8,timeConstant:s=325,bounceDamping:r=10,bounceStiffness:o=500,modifyTarget:i,min:a,max:l,restDelta:u=.5,restSpeed:c}){const d=t[0],f={done:!1,value:d},h=w=>a!==void 0&&w<a||l!==void 0&&w>l,p=w=>a===void 0?l:l===void 0||Math.abs(a-w)<Math.abs(l-w)?a:l;let g=n*e;const y=d+g,m=i===void 0?y:i(y);m!==y&&(g=m-d);const x=w=>-g*Math.exp(-w/s),v=w=>m+x(w),b=w=>{const I=x(w),R=v(w);f.done=Math.abs(I)<=u,f.value=f.done?m:R};let $,C;const k=w=>{h(f.value)&&($=w,C=L3({keyframes:[f.value,p(f.value)],velocity:O3(v,w,f.value),damping:r,stiffness:o,restDelta:u,restSpeed:c}))};return k(0),{calculatedDuration:null,next:w=>{let I=!1;return!C&&$===void 0&&(I=!0,b(w),k(w)),$!==void 0&&w>=$?C.next(w-$):(!I&&b(w),f)}}}const M3=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t,bpe=1e-7,wpe=12;function $pe(t,e,n,s,r){let o,i,a=0;do i=e+(n-e)/2,o=M3(i,s,r)-t,o>0?n=i:e=i;while(Math.abs(o)>bpe&&++a<wpe);return i}function kf(t,e,n,s){if(t===e&&n===s)return Pr;const r=o=>$pe(o,0,1,t,n);return o=>o===0||o===1?o:M3(r(o),e,s)}const Cpe=kf(.42,0,1,1),kpe=kf(0,0,.58,1),_3=kf(.42,0,.58,1),Spe=t=>Array.isArray(t)&&typeof t[0]!="number",z3=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,V3=t=>e=>1-t(1-e),q$=t=>1-Math.sin(Math.acos(t)),Ipe=V3(q$),Tpe=z3(q$),B3=kf(.33,1.53,.69,.99),Y$=V3(B3),Epe=z3(Y$),Npe=t=>(t*=2)<1?.5*Y$(t):.5*(2-Math.pow(2,-10*(t-1))),UI={linear:Pr,easeIn:Cpe,easeInOut:_3,easeOut:kpe,circIn:q$,circInOut:Tpe,circOut:Ipe,backIn:Y$,backInOut:Epe,backOut:B3,anticipate:Npe},GI=t=>{if(Array.isArray(t)){dv(t.length===4);const[e,n,s,r]=t;return kf(e,n,s,r)}else if(typeof t=="string")return dv(UI[t]!==void 0),UI[t];return t},W3=(t,e,n)=>{const s=e-t;return s===0?1:(n-t)/s},f0=(t,e,n)=>t+(e-t)*n;function mx(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function Rpe({hue:t,saturation:e,lightness:n,alpha:s}){t/=360,e/=100,n/=100;let r=0,o=0,i=0;if(!e)r=o=i=n;else{const a=n<.5?n*(1+e):n+e-n*e,l=2*n-a;r=mx(l,a,t+1/3),o=mx(l,a,t),i=mx(l,a,t-1/3)}return{red:Math.round(r*255),green:Math.round(o*255),blue:Math.round(i*255),alpha:s}}function Qp(t,e){return n=>n>0?e:t}const gx=(t,e,n)=>{const s=t*t,r=n*(e*e-s)+s;return r<0?0:Math.sqrt(r)},Ape=[pv,zi,ll],Dpe=t=>Ape.find(e=>e.test(t));function HI(t){const e=Dpe(t);if(!e)return!1;let n=e.parse(t);return e===ll&&(n=Rpe(n)),n}const jI=(t,e)=>{const n=HI(t),s=HI(e);if(!n||!s)return Qp(t,e);const r={...n};return o=>(r.red=gx(n.red,s.red,o),r.green=gx(n.green,s.green,o),r.blue=gx(n.blue,s.blue,o),r.alpha=f0(n.alpha,s.alpha,o),zi.transform(r))},xv=new Set(["none","hidden"]);function Fpe(t,e){return xv.has(t)?n=>n<=0?t:e:n=>n>=1?e:t}function Ppe(t,e){return n=>f0(t,e,n)}function Q$(t){return typeof t=="number"?Ppe:typeof t=="string"?_$(t)?Qp:$n.test(t)?jI:Mpe:Array.isArray(t)?U3:typeof t=="object"?$n.test(t)?jI:Ope:Qp}function U3(t,e){const n=[...t],s=n.length,r=t.map((o,i)=>Q$(o)(o,e[i]));return o=>{for(let i=0;i<s;i++)n[i]=r[i](o);return n}}function Ope(t,e){const n={...t,...e},s={};for(const r in n)t[r]!==void 0&&e[r]!==void 0&&(s[r]=Q$(t[r])(t[r],e[r]));return r=>{for(const o in s)n[o]=s[o](r);return n}}function Lpe(t,e){var n;const s=[],r={color:0,var:0,number:0};for(let o=0;o<e.values.length;o++){const i=e.types[o],a=t.indexes[i][r[i]],l=(n=t.values[a])!==null&&n!==void 0?n:0;s[o]=l,r[i]++}return s}const Mpe=(t,e)=>{const n=mu.createTransformer(e),s=Kc(t),r=Kc(e);return s.indexes.var.length===r.indexes.var.length&&s.indexes.color.length===r.indexes.color.length&&s.indexes.number.length>=r.indexes.number.length?xv.has(t)&&!r.values.length||xv.has(e)&&!s.values.length?Fpe(t,e):Qo(U3(Lpe(s,r),r.values),n):Qp(t,e)};function G3(t,e,n){return typeof t=="number"&&typeof e=="number"&&typeof n=="number"?f0(t,e,n):Q$(t)(t,e)}function _pe(t,e,n){const s=[],r=n||G3,o=t.length-1;for(let i=0;i<o;i++){let a=r(t[i],t[i+1]);if(e){const l=Array.isArray(e)?e[i]||Pr:e;a=Qo(l,a)}s.push(a)}return s}function zpe(t,e,{clamp:n=!0,ease:s,mixer:r}={}){const o=t.length;if(dv(o===e.length),o===1)return()=>e[0];if(o===2&&t[0]===t[1])return()=>e[1];t[0]>t[o-1]&&(t=[...t].reverse(),e=[...e].reverse());const i=_pe(e,s,r),a=i.length,l=u=>{let c=0;if(a>1)for(;c<t.length-2&&!(u<t[c+1]);c++);const d=W3(t[c],t[c+1],u);return i[c](d)};return n?u=>l(Ul(t[0],t[o-1],u)):l}function Vpe(t,e){const n=t[t.length-1];for(let s=1;s<=e;s++){const r=W3(0,e,s);t.push(f0(n,1,r))}}function Bpe(t){const e=[0];return Vpe(e,t.length-1),e}function Wpe(t,e){return t.map(n=>n*e)}function Upe(t,e){return t.map(()=>e||_3).splice(0,t.length-1)}function Zp({duration:t=300,keyframes:e,times:n,ease:s="easeInOut"}){const r=Spe(s)?s.map(GI):GI(s),o={done:!1,value:e[0]},i=Wpe(n&&n.length===e.length?n:Bpe(e),t),a=zpe(i,e,{ease:Array.isArray(r)?r:Upe(e,r)});return{calculatedDuration:t,next:l=>(o.value=a(l),o.done=l>=t,o)}}const KI=2e4;function Gpe(t){let e=0;const n=50;let s=t.next(e);for(;!s.done&&e<KI;)e+=n,s=t.next(e);return e>=KI?1/0:e}const Hpe=t=>{const e=({timestamp:n})=>t(n);return{start:()=>Zt.update(e,!0),stop:()=>qp(e),now:()=>Yp.isProcessing?Yp.timestamp:Cl.now()}},jpe={decay:WI,inertia:WI,tween:Zp,keyframes:Zp,spring:L3},Kpe=t=>t/100;class Z$ extends F3{constructor({KeyframeResolver:e=j$,...n}){super(n),this.holdTime=null,this.startTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:a}=this.options;a&&a()};const{name:s,motionValue:r,keyframes:o}=this.options,i=(a,l)=>this.onKeyframesResolved(a,l);s&&r&&r.owner?this.resolver=r.owner.resolveKeyframes(o,i,s,r):this.resolver=new e(o,i,s,r),this.resolver.scheduleResolve()}initPlayback(e){const{type:n="keyframes",repeat:s=0,repeatDelay:r=0,repeatType:o,velocity:i=0}=this.options,a=jpe[n]||Zp;let l,u;a!==Zp&&typeof e[0]!="number"&&(l=Qo(Kpe,G3(e[0],e[1])),e=[0,100]);const c=a({...this.options,keyframes:e});o==="mirror"&&(u=a({...this.options,keyframes:[...e].reverse(),velocity:-i})),c.calculatedDuration===null&&(c.calculatedDuration=Gpe(c));const{calculatedDuration:d}=c,f=d+r,h=f*(s+1)-r;return{generator:c,mirroredGenerator:u,mapPercentToKeyframes:l,calculatedDuration:d,resolvedDuration:f,totalDuration:h}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,n=!1){const{resolved:s}=this;if(!s){const{keyframes:w}=this.options;return{done:!0,value:w[w.length-1]}}const{finalKeyframe:r,generator:o,mirroredGenerator:i,mapPercentToKeyframes:a,keyframes:l,calculatedDuration:u,totalDuration:c,resolvedDuration:d}=s;if(this.startTime===null)return o.next(0);const{delay:f,repeat:h,repeatType:p,repeatDelay:g,onUpdate:y}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-c/this.speed,this.startTime)),n?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const m=this.currentTime-f*(this.speed>=0?1:-1),x=this.speed>=0?m<0:m>c;this.currentTime=Math.max(m,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=c);let v=this.currentTime,b=o;if(h){const w=Math.min(this.currentTime,c)/d;let I=Math.floor(w),R=w%1;!R&&w>=1&&(R=1),R===1&&I--,I=Math.min(I,h+1),!!(I%2)&&(p==="reverse"?(R=1-R,g&&(R-=g/d)):p==="mirror"&&(b=i)),v=Ul(0,1,R)*d}const $=x?{done:!1,value:l[0]}:b.next(v);a&&($.value=a($.value));let{done:C}=$;!x&&u!==null&&(C=this.speed>=0?this.currentTime>=c:this.currentTime<=0);const k=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&C);return k&&r!==void 0&&($.value=d0(l,this.options,r)),y&&y($.value),k&&this.finish(),$}get duration(){const{resolved:e}=this;return e?Zo(e.calculatedDuration):0}get time(){return Zo(this.currentTime)}set time(e){e=ji(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const n=this.playbackSpeed!==e;this.playbackSpeed=e,n&&(this.time=Zo(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=Hpe,onPlay:n}=this.options;this.driver||(this.driver=e(r=>this.tick(r))),n&&n();const s=this.driver.now();this.holdTime!==null?this.startTime=s-this.holdTime:(!this.startTime||this.state==="finished")&&(this.startTime=s),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const H3=t=>Array.isArray(t)&&typeof t[0]=="number";function j3(t){return!!(!t||typeof t=="string"&&t in J$||H3(t)||Array.isArray(t)&&t.every(j3))}const Xu=([t,e,n,s])=>`cubic-bezier(${t}, ${e}, ${n}, ${s})`,J$={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Xu([0,.65,.55,1]),circOut:Xu([.55,0,1,.45]),backIn:Xu([.31,.01,.66,-.59]),backOut:Xu([.33,1.53,.69,.99])};function Xpe(t){return K3(t)||J$.easeOut}function K3(t){if(t)return H3(t)?Xu(t):Array.isArray(t)?t.map(Xpe):J$[t]}function qpe(t,e,n,{delay:s=0,duration:r=300,repeat:o=0,repeatType:i="loop",ease:a,times:l}={}){const u={[e]:n};l&&(u.offset=l);const c=K3(a);return Array.isArray(c)&&(u.easing=c),t.animate(u,{delay:s,duration:r,easing:Array.isArray(c)?"linear":c,fill:"both",iterations:o+1,direction:i==="reverse"?"alternate":"normal"})}const Ype=D3(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Qpe=new Set(["opacity","clipPath","filter","transform"]),Jp=10,Zpe=2e4;function Jpe(t){return t.type==="spring"||t.name==="backgroundColor"||!j3(t.ease)}function eme(t,e){const n=new Z$({...e,keyframes:t,repeat:0,delay:0,isGenerator:!0});let s={done:!1,value:t[0]};const r=[];let o=0;for(;!s.done&&o<Zpe;)s=n.sample(o),r.push(s.value),o+=Jp;return{times:void 0,keyframes:r,duration:o-Jp,ease:"linear"}}class XI extends F3{constructor(e){super(e);const{name:n,motionValue:s,keyframes:r}=this.options;this.resolver=new A3(r,(o,i)=>this.onKeyframesResolved(o,i),n,s),this.resolver.scheduleResolve()}initPlayback(e,n){var s;let{duration:r=300,times:o,ease:i,type:a,motionValue:l,name:u}=this.options;if(!(!((s=l.owner)===null||s===void 0)&&s.current))return!1;if(Jpe(this.options)){const{onComplete:d,onUpdate:f,motionValue:h,...p}=this.options,g=eme(e,p);e=g.keyframes,e.length===1&&(e[1]=e[0]),r=g.duration,o=g.times,i=g.ease,a="keyframes"}const c=qpe(l.owner.current,u,e,{...this.options,duration:r,times:o,ease:i});return c.startTime=Cl.now(),this.pendingTimeline?(c.timeline=this.pendingTimeline,this.pendingTimeline=void 0):c.onfinish=()=>{const{onComplete:d}=this.options;l.set(d0(e,this.options,n)),d&&d(),this.cancel(),this.resolveFinishedPromise()},{animation:c,duration:r,times:o,type:a,ease:i,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:n}=e;return Zo(n)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:n}=e;return Zo(n.currentTime||0)}set time(e){const{resolved:n}=this;if(!n)return;const{animation:s}=n;s.currentTime=ji(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:n}=e;return n.playbackRate}set speed(e){const{resolved:n}=this;if(!n)return;const{animation:s}=n;s.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:n}=e;return n.playState}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:n}=this;if(!n)return Pr;const{animation:s}=n;s.timeline=e,s.onfinish=null}return Pr}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:n}=e;n.playState==="finished"&&this.updateFinishedPromise(),n.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:n}=e;n.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;const{resolved:e}=this;if(!e)return;const{animation:n,keyframes:s,duration:r,type:o,ease:i,times:a}=e;if(!(n.playState==="idle"||n.playState==="finished")){if(this.time){const{motionValue:l,onUpdate:u,onComplete:c,...d}=this.options,f=new Z$({...d,keyframes:s,duration:r,type:o,ease:i,times:a,isGenerator:!0}),h=ji(this.time);l.setWithVelocity(f.sample(h-Jp).value,f.sample(h).value,Jp)}this.cancel()}}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:n,name:s,repeatDelay:r,repeatType:o,damping:i,type:a}=e;return Ype()&&s&&Qpe.has(s)&&n&&n.owner&&n.owner.current instanceof HTMLElement&&!n.owner.getProps().onUpdate&&!r&&o!=="mirror"&&i!==0&&a!=="inertia"}}function tme(t,e){let n;const s=()=>{const{currentTime:r}=e,i=(r===null?0:r.value)/100;n!==i&&t(i),n=i};return Zt.update(s,!0),()=>qp(s)}const nme=D3(()=>window.ScrollTimeline!==void 0);class sme{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}then(e,n){return Promise.all(this.animations).then(e).catch(n)}getAll(e){return this.animations[0][e]}setAll(e,n){for(let s=0;s<this.animations.length;s++)this.animations[s][e]=n}attachTimeline(e){const n=this.animations.map(s=>{if(nme()&&s.attachTimeline)s.attachTimeline(e);else return s.pause(),tme(r=>{s.time=s.duration*r},e)});return()=>{n.forEach((s,r)=>{s&&s(),this.animations[r].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get duration(){let e=0;for(let n=0;n<this.animations.length;n++)e=Math.max(e,this.animations[n].duration);return e}runAll(e){this.animations.forEach(n=>n[e]())}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}const rme=(t,e,n,s={},r,o)=>i=>{const a=x3(s,t)||{},l=a.delay||s.delay||0;let{elapsed:u=0}=s;u=u-ji(l);let c={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:e.getVelocity(),...a,delay:-u,onUpdate:f=>{e.set(f),a.onUpdate&&a.onUpdate(f)},onComplete:()=>{i(),a.onComplete&&a.onComplete()},name:t,motionValue:e,element:o?void 0:r};Ohe(a)||(c={...c,...Phe(t,c)}),c.duration&&(c.duration=ji(c.duration)),c.repeatDelay&&(c.repeatDelay=ji(c.repeatDelay)),c.from!==void 0&&(c.keyframes[0]=c.from);let d=!1;if((c.type===!1||c.duration===0&&!c.repeatDelay)&&(c.duration=0,c.delay===0&&(d=!0)),d&&!o&&e.get()!==void 0){const f=d0(c.keyframes,a);if(f!==void 0)return Zt.update(()=>{c.onUpdate(f),c.onComplete()}),new sme([])}return!o&&XI.supports(c)?new XI(c):new Z$(c)};function em(t){return!!(zn(t)&&t.add)}function ome(t,e){t.indexOf(e)===-1&&t.push(e)}function ime(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}class X3{constructor(){this.subscriptions=[]}add(e){return ome(this.subscriptions,e),()=>ime(this.subscriptions,e)}notify(e,n,s){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](e,n,s);else for(let o=0;o<r;o++){const i=this.subscriptions[o];i&&i(e,n,s)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const qI=30,ame=t=>!isNaN(parseFloat(t));class lme{constructor(e,n={}){this.version="11.2.10",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(s,r=!0)=>{const o=Cl.now();this.updatedAt!==o&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(s),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),r&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=n.owner}setCurrent(e){this.current=e,this.updatedAt=Cl.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=ame(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,n){this.events[e]||(this.events[e]=new X3);const s=this.events[e].add(n);return e==="change"?()=>{s(),Zt.read(()=>{this.events.change.getSize()||this.stop()})}:s}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,n){this.passiveEffect=e,this.stopPassiveEffect=n}set(e,n=!0){!n||!this.passiveEffect?this.updateAndNotify(e,n):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,n,s){this.set(n),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-s}jump(e,n=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=Cl.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>qI)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,qI);return P3(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(e){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=e(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function tm(t,e){return new lme(t,e)}function ume(t,e,n){t.hasValue(e)?t.getValue(e).set(n):t.addValue(e,tm(n))}function cme(t,e){const n=c0(t,e);let{transitionEnd:s={},transition:r={},...o}=n||{};o={...o,...s};for(const i in o){const a=ihe(o[i]);ume(t,i,a)}}function dme(t){return t.getProps()[XL]}function fme({protectedKeys:t,needsAnimating:e},n){const s=t.hasOwnProperty(n)&&e[n]!==!0;return e[n]=!1,s}function q3(t,e,{delay:n=0,transitionOverride:s,type:r}={}){var o;let{transition:i=t.getDefaultTransition(),transitionEnd:a,...l}=e;const u=t.getValue("willChange");s&&(i=s);const c=[],d=r&&t.animationState&&t.animationState.getState()[r];for(const f in l){const h=t.getValue(f,(o=t.latestValues[f])!==null&&o!==void 0?o:null),p=l[f];if(p===void 0||d&&fme(d,f))continue;const g={delay:n,elapsed:0,...x3(i||{},f)};let y=!1;if(window.HandoffAppearAnimations){const x=dme(t);if(x){const v=window.HandoffAppearAnimations(x,f,h,Zt);v!==null&&(g.elapsed=v,y=!0)}}h.start(rme(f,h,p,t.shouldReduceMotion&&Pa.has(f)?{type:!1}:g,t,y));const m=h.animation;m&&(em(u)&&(u.add(f),m.then(()=>u.remove(f))),c.push(m))}return a&&Promise.all(c).then(()=>{Zt.update(()=>{a&&cme(t,a)})}),c}function yv(t,e,n={}){var s;const r=c0(t,e,n.type==="exit"?(s=t.presenceContext)===null||s===void 0?void 0:s.custom:void 0);let{transition:o=t.getDefaultTransition()||{}}=r||{};n.transitionOverride&&(o=n.transitionOverride);const i=r?()=>Promise.all(q3(t,r,n)):()=>Promise.resolve(),a=t.variantChildren&&t.variantChildren.size?(u=0)=>{const{delayChildren:c=0,staggerChildren:d,staggerDirection:f}=o;return hme(t,e,c+u,d,f,n)}:()=>Promise.resolve(),{when:l}=o;if(l){const[u,c]=l==="beforeChildren"?[i,a]:[a,i];return u().then(()=>c())}else return Promise.all([i(),a(n.delay)])}function hme(t,e,n=0,s=0,r=1,o){const i=[],a=(t.variantChildren.size-1)*s,l=r===1?(u=0)=>u*s:(u=0)=>a-u*s;return Array.from(t.variantChildren).sort(pme).forEach((u,c)=>{u.notify("AnimationStart",e),i.push(yv(u,e,{...o,delay:n+l(c)}).then(()=>u.notify("AnimationComplete",e)))}),Promise.all(i)}function pme(t,e){return t.sortNodePosition(e)}function mme(t,e,n={}){t.notify("AnimationStart",e);let s;if(Array.isArray(e)){const r=e.map(o=>yv(t,o,n));s=Promise.all(r)}else if(typeof e=="string")s=yv(t,e,n);else{const r=typeof e=="function"?c0(t,e,n.custom):e;s=Promise.all(q3(t,r,n))}return s.then(()=>{Zt.postRender(()=>{t.notify("AnimationComplete",e)})})}const gme=[...O$].reverse(),xme=O$.length;function yme(t){return e=>Promise.all(e.map(({animation:n,options:s})=>mme(t,n,s)))}function vme(t){let e=yme(t);const n=wme();let s=!0;const r=l=>(u,c)=>{var d;const f=c0(t,c,l==="exit"?(d=t.presenceContext)===null||d===void 0?void 0:d.custom:void 0);if(f){const{transition:h,transitionEnd:p,...g}=f;u={...u,...g,...p}}return u};function o(l){e=l(t)}function i(l){const u=t.getProps(),c=t.getVariantContext(!0)||{},d=[],f=new Set;let h={},p=1/0;for(let y=0;y<xme;y++){const m=gme[y],x=n[m],v=u[m]!==void 0?u[m]:c[m],b=Hc(v),$=m===l?x.isActive:null;$===!1&&(p=y);let C=v===c[m]&&v!==u[m]&&b;if(C&&s&&t.manuallyAnimateOnMount&&(C=!1),x.protectedKeys={...h},!x.isActive&&$===null||!v&&!x.prevProp||l0(v)||typeof v=="boolean")continue;let w=bme(x.prevProp,v)||m===l&&x.isActive&&!C&&b||y>p&&b,I=!1;const R=Array.isArray(v)?v:[v];let E=R.reduce(r(m),{});$===!1&&(E={});const{prevResolvedValues:A={}}=x,S={...A,...E},T=F=>{w=!0,f.has(F)&&(I=!0,f.delete(F)),x.needsAnimating[F]=!0;const M=t.getValue(F);M&&(M.liveStyle=!1)};for(const F in S){const M=E[F],U=A[F];if(h.hasOwnProperty(F))continue;let P=!1;uv(M)&&uv(U)?P=!g3(M,U):P=M!==U,P?M!=null?T(F):f.add(F):M!==void 0&&f.has(F)?T(F):x.protectedKeys[F]=!0}x.prevProp=v,x.prevResolvedValues=E,x.isActive&&(h={...h,...E}),s&&t.blockInitialAnimation&&(w=!1),w&&(!C||I)&&d.push(...R.map(F=>({animation:F,options:{type:m}})))}if(f.size){const y={};f.forEach(m=>{const x=t.getBaseTarget(m),v=t.getValue(m);v&&(v.liveStyle=!0),y[m]=x??null}),d.push({animation:y})}let g=!!d.length;return s&&(u.initial===!1||u.initial===u.animate)&&!t.manuallyAnimateOnMount&&(g=!1),s=!1,g?e(d):Promise.resolve()}function a(l,u){var c;if(n[l].isActive===u)return Promise.resolve();(c=t.variantChildren)===null||c===void 0||c.forEach(f=>{var h;return(h=f.animationState)===null||h===void 0?void 0:h.setActive(l,u)}),n[l].isActive=u;const d=i(l);for(const f in n)n[f].protectedKeys={};return d}return{animateChanges:i,setActive:a,setAnimateFunction:o,getState:()=>n}}function bme(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!g3(e,t):!1}function $i(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function wme(){return{animate:$i(!0),whileInView:$i(),whileHover:$i(),whileTap:$i(),whileDrag:$i(),whileFocus:$i(),exit:$i()}}class $me extends pu{constructor(e){super(e),e.animationState||(e.animationState=vme(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();this.unmount(),l0(e)&&(this.unmount=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:n}=this.node.prevProps||{};e!==n&&this.updateAnimationControlsSubscription()}unmount(){}}let Cme=0;class kme extends pu{constructor(){super(...arguments),this.id=Cme++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:n}=this.node.presenceContext,{isPresent:s}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===s)return;const r=this.node.animationState.setActive("exit",!e);n&&!e&&r.then(()=>n(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const Sme={animation:{Feature:$me},exit:{Feature:kme}},YI=()=>({min:0,max:0}),Y3=()=>({x:YI(),y:YI()});function Ime({top:t,left:e,right:n,bottom:s}){return{x:{min:e,max:n},y:{min:t,max:s}}}function Tme(t,e){if(!e)return t;const n=e({x:t.left,y:t.top}),s=e({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:s.y,right:s.x}}function Eme(t,e){return Ime(Tme(t.getBoundingClientRect(),e))}const vv={current:null},Q3={current:!1};function Nme(){if(Q3.current=!0,!!A$)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>vv.current=t.matches;t.addListener(e),e()}else vv.current=!1}function Rme(t,e,n){const{willChange:s}=e;for(const r in e){const o=e[r],i=n[r];if(zn(o))t.addValue(r,o),em(s)&&s.add(r);else if(zn(i))t.addValue(r,tm(o,{owner:t})),em(s)&&s.remove(r);else if(i!==o)if(t.hasValue(r)){const a=t.getValue(r);a.liveStyle===!0?a.jump(o):a.hasAnimated||a.set(o)}else{const a=t.getStaticValue(r);t.addValue(r,tm(a!==void 0?a:o,{owner:t}))}}for(const r in n)e[r]===void 0&&t.removeValue(r);return e}const QI=new WeakMap,Ame=[...$3,$n,mu],Dme=t=>Ame.find(w3(t)),Z3=Object.keys(jc),Fme=Z3.length,ZI=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],Pme=L$.length;function J3(t){if(t)return t.options.allowProjection!==!1?t.projection:J3(t.parent)}class Ome{scrapeMotionValuesFromProps(e,n,s){return{}}constructor({parent:e,props:n,presenceContext:s,reducedMotionConfig:r,blockInitialAnimation:o,visualState:i},a={}){this.resolveKeyframes=(f,h,p,g)=>new this.KeyframeResolver(f,h,p,g,this),this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=j$,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>Zt.render(this.render,!1,!0);const{latestValues:l,renderState:u}=i;this.latestValues=l,this.baseTarget={...l},this.initialValues=n.initial?{...l}:{},this.renderState=u,this.parent=e,this.props=n,this.presenceContext=s,this.depth=e?e.depth+1:0,this.reducedMotionConfig=r,this.options=a,this.blockInitialAnimation=!!o,this.isControllingVariants=u0(n),this.isVariantNode=QL(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:c,...d}=this.scrapeMotionValuesFromProps(n,{},this);for(const f in d){const h=d[f];l[f]!==void 0&&zn(h)&&(h.set(l[f],!1),em(c)&&c.add(f))}}mount(e){this.current=e,QI.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,s)=>this.bindToMotionValue(s,n)),Q3.current||Nme(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:vv.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){var e;QI.delete(this.current),this.projection&&this.projection.unmount(),qp(this.notifyUpdate),qp(this.render),this.valueSubscriptions.forEach(n=>n()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const n in this.events)this.events[n].clear();for(const n in this.features)(e=this.features[n])===null||e===void 0||e.unmount();this.current=null}bindToMotionValue(e,n){const s=Pa.has(e),r=n.on("change",i=>{this.latestValues[e]=i,this.props.onUpdate&&Zt.preRender(this.notifyUpdate),s&&this.projection&&(this.projection.isTransformDirty=!0)}),o=n.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(e,()=>{r(),o(),n.owner&&n.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}loadFeatures({children:e,...n},s,r,o){let i,a;for(let l=0;l<Fme;l++){const u=Z3[l],{isEnabled:c,Feature:d,ProjectionNode:f,MeasureLayout:h}=jc[u];f&&(i=f),c(n)&&(!this.features[u]&&d&&(this.features[u]=new d(this)),h&&(a=h))}if((this.type==="html"||this.type==="svg")&&!this.projection&&i){const{layoutId:l,layout:u,drag:c,dragConstraints:d,layoutScroll:f,layoutRoot:h}=n;this.projection=new i(this.latestValues,n["data-framer-portal-id"]?void 0:J3(this.parent)),this.projection.setOptions({layoutId:l,layout:u,alwaysMeasureLayout:!!c||d&&YL(d),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof u=="string"?u:"both",initialPromotionConfig:o,layoutScroll:f,layoutRoot:h})}return a}updateFeatures(){for(const e in this.features){const n=this.features[e];n.isMounted?n.update():(n.mount(),n.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Y3()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,n){this.latestValues[e]=n}update(e,n){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let s=0;s<ZI.length;s++){const r=ZI[s];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const o="on"+r,i=e[o];i&&(this.propEventSubscriptions[r]=this.on(r,i))}this.prevMotionValues=Rme(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(e=!1){if(e)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const s=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(s.initial=this.props.initial),s}const n={};for(let s=0;s<Pme;s++){const r=L$[s],o=this.props[r];(Hc(o)||o===!1)&&(n[r]=o)}return n}addVariantChild(e){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(e),()=>n.variantChildren.delete(e)}addValue(e,n){const s=this.values.get(e);n!==s&&(s&&this.removeValue(e),this.bindToMotionValue(e,n),this.values.set(e,n),this.latestValues[e]=n.get())}removeValue(e){this.values.delete(e);const n=this.valueSubscriptions.get(e);n&&(n(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,n){if(this.props.values&&this.props.values[e])return this.props.values[e];let s=this.values.get(e);return s===void 0&&n!==void 0&&(s=tm(n===null?void 0:n,{owner:this}),this.addValue(e,s)),s}readValue(e,n){var s;let r=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(s=this.getBaseTargetFromProps(this.props,e))!==null&&s!==void 0?s:this.readValueFromInstance(this.current,e,this.options);return r!=null&&(typeof r=="string"&&(v3(r)||y3(r))?r=parseFloat(r):!Dme(r)&&mu.test(n)&&(r=R3(e,n)),this.setBaseTarget(e,zn(r)?r.get():r)),zn(r)?r.get():r}setBaseTarget(e,n){this.baseTarget[e]=n}getBaseTarget(e){var n;const{initial:s}=this.props;let r;if(typeof s=="string"||typeof s=="object"){const i=H$(this.props,s,(n=this.presenceContext)===null||n===void 0?void 0:n.custom);i&&(r=i[e])}if(s&&r!==void 0)return r;const o=this.getBaseTargetFromProps(this.props,e);return o!==void 0&&!zn(o)?o:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,n){return this.events[e]||(this.events[e]=new X3),this.events[e].add(n)}notify(e,...n){this.events[e]&&this.events[e].notify(...n)}}class eM extends Ome{constructor(){super(...arguments),this.KeyframeResolver=A3}sortInstanceNodePosition(e,n){return e.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(e,n){return e.style?e.style[n]:void 0}removeValueFromRenderState(e,{vars:n,style:s}){delete n[e],delete s[e]}}function Lme(t){return window.getComputedStyle(t)}class Mme extends eM{constructor(){super(...arguments),this.type="html"}readValueFromInstance(e,n){if(Pa.has(n)){const s=X$(n);return s&&s.default||0}else{const s=Lme(e),r=(t3(n)?s.getPropertyValue(n):s[n])||0;return typeof r=="string"?r.trim():r}}measureInstanceViewportBox(e,{transformPagePoint:n}){return Eme(e,n)}build(e,n,s,r){V$(e,n,s,r.transformTemplate)}scrapeMotionValuesFromProps(e,n,s){return G$(e,n,s)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;zn(e)&&(this.childSubscription=e.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}renderInstance(e,n,s,r){i3(e,n,s,r)}}class _me extends eM{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(e,n){return e[n]}readValueFromInstance(e,n){if(Pa.has(n)){const s=X$(n);return s&&s.default||0}return n=a3.has(n)?n:P$(n),e.getAttribute(n)}measureInstanceViewportBox(){return Y3()}scrapeMotionValuesFromProps(e,n,s){return u3(e,n,s)}build(e,n,s,r){W$(e,n,s,this.isSVGTag,r.transformTemplate)}renderInstance(e,n,s,r){l3(e,n,s,r)}mount(e){this.isSVGTag=U$(e.tagName),super.mount(e)}}const zme=(t,e)=>M$(t)?new _me(e,{enableHardwareAcceleration:!1}):new Mme(e,{allowProjection:t!==D.Fragment,enableHardwareAcceleration:!0}),bv=Pfe(fhe);function tM(){const t=D.useRef(!1);return D$(()=>(t.current=!0,()=>{t.current=!1}),[]),t}function Vme(){const t=tM(),[e,n]=D.useState(0),s=D.useCallback(()=>{t.current&&n(e+1)},[e]);return[D.useCallback(()=>Zt.postRender(s),[s]),e]}class Bme extends D.Component{getSnapshotBeforeUpdate(e){const n=this.props.childRef.current;if(n&&e.isPresent&&!this.props.isPresent){const s=this.props.sizeRef.current;s.height=n.offsetHeight||0,s.width=n.offsetWidth||0,s.top=n.offsetTop,s.left=n.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function Wme({children:t,isPresent:e}){const n=D.useId(),s=D.useRef(null),r=D.useRef({width:0,height:0,top:0,left:0}),{nonce:o}=D.useContext(N$);return D.useInsertionEffect(()=>{const{width:i,height:a,top:l,left:u}=r.current;if(e||!s.current||!i||!a)return;s.current.dataset.motionPopId=n;const c=document.createElement("style");return o&&(c.nonce=o),document.head.appendChild(c),c.sheet&&c.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${i}px !important;
            height: ${a}px !important;
            top: ${l}px !important;
            left: ${u}px !important;
          }
        `),()=>{document.head.removeChild(c)}},[e]),j.jsx(Bme,{isPresent:e,childRef:s,sizeRef:r,children:D.cloneElement(t,{ref:s})})}const xx=({children:t,initial:e,isPresent:n,onExitComplete:s,custom:r,presenceAffectsLayout:o,mode:i})=>{const a=c3(Ume),l=D.useId(),u=D.useMemo(()=>({id:l,initial:e,isPresent:n,custom:r,onExitComplete:c=>{a.set(c,!0);for(const d of a.values())if(!d)return;s&&s()},register:c=>(a.set(c,!1),()=>a.delete(c))}),o?[Math.random()]:[n]);return D.useMemo(()=>{a.forEach((c,d)=>a.set(d,!1))},[n]),D.useEffect(()=>{!n&&!a.size&&s&&s()},[n]),i==="popLayout"&&(t=j.jsx(Wme,{isPresent:n,children:t})),j.jsx(R$.Provider,{value:u,children:t})};function Ume(){return new Map}function Gme(t){return D.useEffect(()=>()=>t(),[])}const Ii=t=>t.key||"";function Hme(t,e){t.forEach(n=>{const s=Ii(n);e.set(s,n)})}function jme(t){const e=[];return D.Children.forEach(t,n=>{D.isValidElement(n)&&e.push(n)}),e}const nM=({children:t,custom:e,initial:n=!0,onExitComplete:s,exitBeforeEnter:r,presenceAffectsLayout:o=!0,mode:i="sync"})=>{const a=D.useContext(ZL).forceRender||Vme()[0],l=tM(),u=jme(t);let c=u;const d=D.useRef(new Map).current,f=D.useRef(c),h=D.useRef(new Map).current,p=D.useRef(!0);if(D$(()=>{p.current=!1,Hme(u,h),f.current=c}),Gme(()=>{p.current=!0,h.clear(),d.clear()}),p.current)return j.jsx(j.Fragment,{children:c.map(x=>j.jsx(xx,{isPresent:!0,initial:n?void 0:!1,presenceAffectsLayout:o,mode:i,children:x},Ii(x)))});c=[...c];const g=f.current.map(Ii),y=u.map(Ii),m=g.length;for(let x=0;x<m;x++){const v=g[x];y.indexOf(v)===-1&&!d.has(v)&&d.set(v,void 0)}return i==="wait"&&d.size&&(c=[]),d.forEach((x,v)=>{if(y.indexOf(v)!==-1)return;const b=h.get(v);if(!b)return;const $=g.indexOf(v);let C=x;if(!C){const k=()=>{d.delete(v);const w=Array.from(h.keys()).filter(I=>!y.includes(I));if(w.forEach(I=>h.delete(I)),f.current=u.filter(I=>{const R=Ii(I);return R===v||w.includes(R)}),!d.size){if(l.current===!1)return;a(),s&&s()}};C=j.jsx(xx,{isPresent:!1,onExitComplete:k,custom:e,presenceAffectsLayout:o,mode:i,children:b},Ii(b)),d.set(v,C)}c.splice($,0,C)}),c=c.map(x=>{const v=x.key;return d.has(v)?x:j.jsx(xx,{isPresent:!0,presenceAffectsLayout:o,mode:i,children:x},Ii(x))}),j.jsx(j.Fragment,{children:d.size?c:c.map(x=>D.cloneElement(x))})};function wv({children:t,features:e,strict:n=!1}){const[,s]=D.useState(!yx(e)),r=D.useRef(void 0);if(!yx(e)){const{renderer:o,...i}=e;r.current=o,lv(i)}return D.useEffect(()=>{yx(e)&&e().then(({renderer:o,...i})=>{lv(i),r.current=o,s(!0)})},[]),j.jsx(F$.Provider,{value:{renderer:r.current,strict:n},children:t})}function yx(t){return typeof t=="function"}const $v={renderer:zme,...Sme,...Nhe};function wo(t){return D.forwardRef(t)}var h0=(t,e,n=!0)=>{if(!e)return[t,{}];const s=e.reduce((r,o)=>o in t?{...r,[o]:t[o]}:r,{});return n?[Object.keys(t).filter(o=>!e.includes(o)).reduce((o,i)=>({...o,[i]:t[i]}),{}),s]:[t,s]},Kme={default:"bg-default text-default-foreground",primary:"bg-primary text-primary-foreground",secondary:"bg-secondary text-secondary-foreground",success:"bg-success text-success-foreground",warning:"bg-warning text-warning-foreground",danger:"bg-danger text-danger-foreground",foreground:"bg-foreground text-background"},Xme={default:"shadow-lg shadow-default/50 bg-default text-default-foreground",primary:"shadow-lg shadow-primary/40 bg-primary text-primary-foreground",secondary:"shadow-lg shadow-secondary/40 bg-secondary text-secondary-foreground",success:"shadow-lg shadow-success/40 bg-success text-success-foreground",warning:"shadow-lg shadow-warning/40 bg-warning text-warning-foreground",danger:"shadow-lg shadow-danger/40 bg-danger text-danger-foreground",foreground:"shadow-lg shadow-foreground/40 bg-foreground text-background"},qme={default:"bg-transparent border-default text-foreground",primary:"bg-transparent border-primary text-primary",secondary:"bg-transparent border-secondary text-secondary",success:"bg-transparent border-success text-success",warning:"bg-transparent border-warning text-warning",danger:"bg-transparent border-danger text-danger",foreground:"bg-transparent border-foreground text-foreground"},Yme={default:"bg-default/40 text-default-foreground",primary:"bg-primary/20 text-primary",secondary:"bg-secondary/20 text-secondary",success:"bg-success/20 text-success-600 dark:text-success",warning:"bg-warning/20 text-warning-600 dark:text-warning",danger:"bg-danger/20 text-danger dark:text-danger-500",foreground:"bg-foreground/10 text-foreground"},Qme={default:"border-default bg-default-100 text-default-foreground",primary:"border-default bg-default-100 text-primary",secondary:"border-default bg-default-100 text-secondary",success:"border-default bg-default-100 text-success",warning:"border-default bg-default-100 text-warning",danger:"border-default bg-default-100 text-danger",foreground:"border-default bg-default-100 text-foreground"},Zme={default:"bg-transparent text-default-foreground",primary:"bg-transparent text-primary",secondary:"bg-transparent text-secondary",success:"bg-transparent text-success",warning:"bg-transparent text-warning",danger:"bg-transparent text-danger",foreground:"bg-transparent text-foreground"},Jme={default:"border-default text-default-foreground hover:!bg-default",primary:"border-primary text-primary hover:!text-primary-foreground hover:!bg-primary",secondary:"border-secondary text-secondary hover:text-secondary-foreground hover:!bg-secondary",success:"border-success text-success hover:!text-success-foreground hover:!bg-success",warning:"border-warning text-warning hover:!text-warning-foreground hover:!bg-warning",danger:"border-danger text-danger hover:!text-danger-foreground hover:!bg-danger",foreground:"border-foreground text-foreground hover:!bg-foreground"},Ie={solid:Kme,shadow:Xme,bordered:qme,flat:Yme,faded:Qme,light:Zme,ghost:Jme},hh=["small","medium","large"],JI={theme:{opacity:["disabled"],spacing:["divider"],borderWidth:hh,borderRadius:hh},classGroups:{shadow:[{shadow:hh}],"font-size":[{text:["tiny",...hh]}],"bg-image":["bg-stripe-gradient"]}},eT=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,ls=t=>!t||typeof t!="object"||Object.keys(t).length===0,ege=(t,e)=>JSON.stringify(t)===JSON.stringify(e);function sM(t,e){t.forEach(function(n){Array.isArray(n)?sM(n,e):e.push(n)})}function rM(t){let e=[];return sM(t,e),e}var oM=(...t)=>rM(t).filter(Boolean),iM=(t,e)=>{let n={},s=Object.keys(t),r=Object.keys(e);for(let o of s)if(r.includes(o)){let i=t[o],a=e[o];typeof i=="object"&&typeof a=="object"?n[o]=iM(i,a):Array.isArray(i)||Array.isArray(a)?n[o]=oM(a,i):n[o]=a+" "+i}else n[o]=t[o];for(let o of r)s.includes(o)||(n[o]=e[o]);return n},tT=t=>!t||typeof t!="string"?t:t.replace(/\s+/g," ").trim();function tge(){for(var t=0,e,n,s="";t<arguments.length;)(e=arguments[t++])&&(n=aM(e))&&(s&&(s+=" "),s+=n);return s}function aM(t){if(typeof t=="string")return t;for(var e,n="",s=0;s<t.length;s++)t[s]&&(e=aM(t[s]))&&(n&&(n+=" "),n+=e);return n}var eC="-";function nge(t){var e=rge(t),n=t.conflictingClassGroups,s=t.conflictingClassGroupModifiers,r=s===void 0?{}:s;function o(a){var l=a.split(eC);return l[0]===""&&l.length!==1&&l.shift(),lM(l,e)||sge(a)}function i(a,l){var u=n[a]||[];return l&&r[a]?[].concat(u,r[a]):u}return{getClassGroupId:o,getConflictingClassGroupIds:i}}function lM(t,e){var i;if(t.length===0)return e.classGroupId;var n=t[0],s=e.nextPart.get(n),r=s?lM(t.slice(1),s):void 0;if(r)return r;if(e.validators.length!==0){var o=t.join(eC);return(i=e.validators.find(function(a){var l=a.validator;return l(o)}))==null?void 0:i.classGroupId}}var nT=/^\[(.+)\]$/;function sge(t){if(nT.test(t)){var e=nT.exec(t)[1],n=e==null?void 0:e.substring(0,e.indexOf(":"));if(n)return"arbitrary.."+n}}function rge(t){var e=t.theme,n=t.prefix,s={nextPart:new Map,validators:[]},r=ige(Object.entries(t.classGroups),n);return r.forEach(function(o){var i=o[0],a=o[1];Cv(a,s,i,e)}),s}function Cv(t,e,n,s){t.forEach(function(r){if(typeof r=="string"){var o=r===""?e:sT(e,r);o.classGroupId=n;return}if(typeof r=="function"){if(oge(r)){Cv(r(s),e,n,s);return}e.validators.push({validator:r,classGroupId:n});return}Object.entries(r).forEach(function(i){var a=i[0],l=i[1];Cv(l,sT(e,a),n,s)})})}function sT(t,e){var n=t;return e.split(eC).forEach(function(s){n.nextPart.has(s)||n.nextPart.set(s,{nextPart:new Map,validators:[]}),n=n.nextPart.get(s)}),n}function oge(t){return t.isThemeGetter}function ige(t,e){return e?t.map(function(n){var s=n[0],r=n[1],o=r.map(function(i){return typeof i=="string"?e+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(function(a){var l=a[0],u=a[1];return[e+l,u]})):i});return[s,o]}):t}function age(t){if(t<1)return{get:function(){},set:function(){}};var e=0,n=new Map,s=new Map;function r(o,i){n.set(o,i),e++,e>t&&(e=0,s=n,n=new Map)}return{get:function(i){var a=n.get(i);if(a!==void 0)return a;if((a=s.get(i))!==void 0)return r(i,a),a},set:function(i,a){n.has(i)?n.set(i,a):r(i,a)}}}var uM="!";function lge(t){var e=t.separator||":",n=e.length===1,s=e[0],r=e.length;return function(i){for(var a=[],l=0,u=0,c,d=0;d<i.length;d++){var f=i[d];if(l===0){if(f===s&&(n||i.slice(d,d+r)===e)){a.push(i.slice(u,d)),u=d+r;continue}if(f==="/"){c=d;continue}}f==="["?l++:f==="]"&&l--}var h=a.length===0?i:i.substring(u),p=h.startsWith(uM),g=p?h.substring(1):h,y=c&&c>u?c-u:void 0;return{modifiers:a,hasImportantModifier:p,baseClassName:g,maybePostfixModifierPosition:y}}}function uge(t){if(t.length<=1)return t;var e=[],n=[];return t.forEach(function(s){var r=s[0]==="[";r?(e.push.apply(e,n.sort().concat([s])),n=[]):n.push(s)}),e.push.apply(e,n.sort()),e}function cge(t){return{cache:age(t.cacheSize),splitModifiers:lge(t),...nge(t)}}var dge=/\s+/;function fge(t,e){var n=e.splitModifiers,s=e.getClassGroupId,r=e.getConflictingClassGroupIds,o=new Set;return t.trim().split(dge).map(function(i){var a=n(i),l=a.modifiers,u=a.hasImportantModifier,c=a.baseClassName,d=a.maybePostfixModifierPosition,f=s(d?c.substring(0,d):c),h=!!d;if(!f){if(!d)return{isTailwindClass:!1,originalClassName:i};if(f=s(c),!f)return{isTailwindClass:!1,originalClassName:i};h=!1}var p=uge(l).join(":"),g=u?p+uM:p;return{isTailwindClass:!0,modifierId:g,classGroupId:f,originalClassName:i,hasPostfixModifier:h}}).reverse().filter(function(i){if(!i.isTailwindClass)return!0;var a=i.modifierId,l=i.classGroupId,u=i.hasPostfixModifier,c=a+l;return o.has(c)?!1:(o.add(c),r(l,u).forEach(function(d){return o.add(a+d)}),!0)}).reverse().map(function(i){return i.originalClassName}).join(" ")}function kv(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var s,r,o,i=a;function a(u){var c=e[0],d=e.slice(1),f=d.reduce(function(h,p){return p(h)},c());return s=cge(f),r=s.cache.get,o=s.cache.set,i=l,l(u)}function l(u){var c=r(u);if(c)return c;var d=fge(u,s);return o(u,d),d}return function(){return i(tge.apply(null,arguments))}}function dt(t){var e=function(s){return s[t]||[]};return e.isThemeGetter=!0,e}var cM=/^\[(?:([a-z-]+):)?(.+)\]$/i,hge=/^\d+\/\d+$/,pge=new Set(["px","full","screen"]),mge=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,gge=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,xge=/^-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/;function Ys(t){return Vi(t)||pge.has(t)||hge.test(t)||Sv(t)}function Sv(t){return Oa(t,"length",Cge)}function yge(t){return Oa(t,"size",dM)}function vge(t){return Oa(t,"position",dM)}function bge(t){return Oa(t,"url",kge)}function ph(t){return Oa(t,"number",Vi)}function Vi(t){return!Number.isNaN(Number(t))}function wge(t){return t.endsWith("%")&&Vi(t.slice(0,-1))}function Du(t){return rT(t)||Oa(t,"number",rT)}function Fe(t){return cM.test(t)}function Fu(){return!0}function Io(t){return mge.test(t)}function $ge(t){return Oa(t,"",Sge)}function Oa(t,e,n){var s=cM.exec(t);return s?s[1]?s[1]===e:n(s[2]):!1}function Cge(t){return gge.test(t)}function dM(){return!1}function kge(t){return t.startsWith("url(")}function rT(t){return Number.isInteger(Number(t))}function Sge(t){return xge.test(t)}function Iv(){var t=dt("colors"),e=dt("spacing"),n=dt("blur"),s=dt("brightness"),r=dt("borderColor"),o=dt("borderRadius"),i=dt("borderSpacing"),a=dt("borderWidth"),l=dt("contrast"),u=dt("grayscale"),c=dt("hueRotate"),d=dt("invert"),f=dt("gap"),h=dt("gradientColorStops"),p=dt("gradientColorStopPositions"),g=dt("inset"),y=dt("margin"),m=dt("opacity"),x=dt("padding"),v=dt("saturate"),b=dt("scale"),$=dt("sepia"),C=dt("skew"),k=dt("space"),w=dt("translate"),I=function(){return["auto","contain","none"]},R=function(){return["auto","hidden","clip","visible","scroll"]},E=function(){return["auto",Fe,e]},A=function(){return[Fe,e]},S=function(){return["",Ys]},T=function(){return["auto",Vi,Fe]},F=function(){return["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"]},M=function(){return["solid","dashed","dotted","double","none"]},U=function(){return["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter"]},P=function(){return["start","end","center","between","around","evenly","stretch"]},L=function(){return["","0",Fe]},G=function(){return["auto","avoid","all","avoid-page","page","left","right","column"]},X=function(){return[Vi,ph]},Q=function(){return[Vi,Fe]};return{cacheSize:500,theme:{colors:[Fu],spacing:[Ys],blur:["none","",Io,Fe],brightness:X(),borderColor:[t],borderRadius:["none","","full",Io,Fe],borderSpacing:A(),borderWidth:S(),contrast:X(),grayscale:L(),hueRotate:Q(),invert:L(),gap:A(),gradientColorStops:[t],gradientColorStopPositions:[wge,Sv],inset:E(),margin:E(),opacity:X(),padding:A(),saturate:X(),scale:X(),sepia:L(),skew:Q(),space:A(),translate:A()},classGroups:{aspect:[{aspect:["auto","square","video",Fe]}],container:["container"],columns:[{columns:[Io]}],"break-after":[{"break-after":G()}],"break-before":[{"break-before":G()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none"]}],clear:[{clear:["left","right","both","none"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[].concat(F(),[Fe])}],overflow:[{overflow:R()}],"overflow-x":[{"overflow-x":R()}],"overflow-y":[{"overflow-y":R()}],overscroll:[{overscroll:I()}],"overscroll-x":[{"overscroll-x":I()}],"overscroll-y":[{"overscroll-y":I()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[g]}],"inset-x":[{"inset-x":[g]}],"inset-y":[{"inset-y":[g]}],start:[{start:[g]}],end:[{end:[g]}],top:[{top:[g]}],right:[{right:[g]}],bottom:[{bottom:[g]}],left:[{left:[g]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Du]}],basis:[{basis:E()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Fe]}],grow:[{grow:L()}],shrink:[{shrink:L()}],order:[{order:["first","last","none",Du]}],"grid-cols":[{"grid-cols":[Fu]}],"col-start-end":[{col:["auto",{span:["full",Du]},Fe]}],"col-start":[{"col-start":T()}],"col-end":[{"col-end":T()}],"grid-rows":[{"grid-rows":[Fu]}],"row-start-end":[{row:["auto",{span:[Du]},Fe]}],"row-start":[{"row-start":T()}],"row-end":[{"row-end":T()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Fe]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Fe]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal"].concat(P())}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal"].concat(P(),["baseline"])}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[].concat(P(),["baseline"])}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[x]}],px:[{px:[x]}],py:[{py:[x]}],ps:[{ps:[x]}],pe:[{pe:[x]}],pt:[{pt:[x]}],pr:[{pr:[x]}],pb:[{pb:[x]}],pl:[{pl:[x]}],m:[{m:[y]}],mx:[{mx:[y]}],my:[{my:[y]}],ms:[{ms:[y]}],me:[{me:[y]}],mt:[{mt:[y]}],mr:[{mr:[y]}],mb:[{mb:[y]}],ml:[{ml:[y]}],"space-x":[{"space-x":[k]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[k]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit",Fe,e]}],"min-w":[{"min-w":["min","max","fit",Fe,Ys]}],"max-w":[{"max-w":["0","none","full","min","max","fit","prose",{screen:[Io]},Io,Fe]}],h:[{h:[Fe,e,"auto","min","max","fit"]}],"min-h":[{"min-h":["min","max","fit",Fe,Ys]}],"max-h":[{"max-h":[Fe,e,"min","max","fit"]}],"font-size":[{text:["base",Io,Sv]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",ph]}],"font-family":[{font:[Fu]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Fe]}],"line-clamp":[{"line-clamp":["none",Vi,ph]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Fe,Ys]}],"list-image":[{"list-image":["none",Fe]}],"list-style-type":[{list:["none","disc","decimal",Fe]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[m]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[m]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[].concat(M(),["wavy"])}],"text-decoration-thickness":[{decoration:["auto","from-font",Ys]}],"underline-offset":[{"underline-offset":["auto",Fe,Ys]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],indent:[{indent:A()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Fe]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Fe]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[m]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[].concat(F(),[vge])}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",yge]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},bge]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[p]}],"gradient-via-pos":[{via:[p]}],"gradient-to-pos":[{to:[p]}],"gradient-from":[{from:[h]}],"gradient-via":[{via:[h]}],"gradient-to":[{to:[h]}],rounded:[{rounded:[o]}],"rounded-s":[{"rounded-s":[o]}],"rounded-e":[{"rounded-e":[o]}],"rounded-t":[{"rounded-t":[o]}],"rounded-r":[{"rounded-r":[o]}],"rounded-b":[{"rounded-b":[o]}],"rounded-l":[{"rounded-l":[o]}],"rounded-ss":[{"rounded-ss":[o]}],"rounded-se":[{"rounded-se":[o]}],"rounded-ee":[{"rounded-ee":[o]}],"rounded-es":[{"rounded-es":[o]}],"rounded-tl":[{"rounded-tl":[o]}],"rounded-tr":[{"rounded-tr":[o]}],"rounded-br":[{"rounded-br":[o]}],"rounded-bl":[{"rounded-bl":[o]}],"border-w":[{border:[a]}],"border-w-x":[{"border-x":[a]}],"border-w-y":[{"border-y":[a]}],"border-w-s":[{"border-s":[a]}],"border-w-e":[{"border-e":[a]}],"border-w-t":[{"border-t":[a]}],"border-w-r":[{"border-r":[a]}],"border-w-b":[{"border-b":[a]}],"border-w-l":[{"border-l":[a]}],"border-opacity":[{"border-opacity":[m]}],"border-style":[{border:[].concat(M(),["hidden"])}],"divide-x":[{"divide-x":[a]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[a]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[m]}],"divide-style":[{divide:M()}],"border-color":[{border:[r]}],"border-color-x":[{"border-x":[r]}],"border-color-y":[{"border-y":[r]}],"border-color-t":[{"border-t":[r]}],"border-color-r":[{"border-r":[r]}],"border-color-b":[{"border-b":[r]}],"border-color-l":[{"border-l":[r]}],"divide-color":[{divide:[r]}],"outline-style":[{outline:[""].concat(M())}],"outline-offset":[{"outline-offset":[Fe,Ys]}],"outline-w":[{outline:[Ys]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:S()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[m]}],"ring-offset-w":[{"ring-offset":[Ys]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",Io,$ge]}],"shadow-color":[{shadow:[Fu]}],opacity:[{opacity:[m]}],"mix-blend":[{"mix-blend":U()}],"bg-blend":[{"bg-blend":U()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[s]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",Io,Fe]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[c]}],invert:[{invert:[d]}],saturate:[{saturate:[v]}],sepia:[{sepia:[$]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[s]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[c]}],"backdrop-invert":[{"backdrop-invert":[d]}],"backdrop-opacity":[{"backdrop-opacity":[m]}],"backdrop-saturate":[{"backdrop-saturate":[v]}],"backdrop-sepia":[{"backdrop-sepia":[$]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[i]}],"border-spacing-x":[{"border-spacing-x":[i]}],"border-spacing-y":[{"border-spacing-y":[i]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Fe]}],duration:[{duration:Q()}],ease:[{ease:["linear","in","out","in-out",Fe]}],delay:[{delay:Q()}],animate:[{animate:["none","spin","ping","pulse","bounce",Fe]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[b]}],"scale-x":[{"scale-x":[b]}],"scale-y":[{"scale-y":[b]}],rotate:[{rotate:[Du,Fe]}],"translate-x":[{"translate-x":[w]}],"translate-y":[{"translate-y":[w]}],"skew-x":[{"skew-x":[C]}],"skew-y":[{"skew-y":[C]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Fe]}],accent:[{accent:["auto",t]}],appearance:["appearance-none"],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Fe]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":A()}],"scroll-mx":[{"scroll-mx":A()}],"scroll-my":[{"scroll-my":A()}],"scroll-ms":[{"scroll-ms":A()}],"scroll-me":[{"scroll-me":A()}],"scroll-mt":[{"scroll-mt":A()}],"scroll-mr":[{"scroll-mr":A()}],"scroll-mb":[{"scroll-mb":A()}],"scroll-ml":[{"scroll-ml":A()}],"scroll-p":[{"scroll-p":A()}],"scroll-px":[{"scroll-px":A()}],"scroll-py":[{"scroll-py":A()}],"scroll-ps":[{"scroll-ps":A()}],"scroll-pe":[{"scroll-pe":A()}],"scroll-pt":[{"scroll-pt":A()}],"scroll-pr":[{"scroll-pr":A()}],"scroll-pb":[{"scroll-pb":A()}],"scroll-pl":[{"scroll-pl":A()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","pinch-zoom","manipulation",{pan:["x","left","right","y","up","down"]}]}],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Fe]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[Ys,ph]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}}function Ige(t,e){for(var n in e)fM(t,n,e[n]);return t}var Tge=Object.prototype.hasOwnProperty,Ege=new Set(["string","number","boolean"]);function fM(t,e,n){if(!Tge.call(t,e)||Ege.has(typeof n)||n===null){t[e]=n;return}if(Array.isArray(n)&&Array.isArray(t[e])){t[e]=t[e].concat(n);return}if(typeof n=="object"&&typeof t[e]=="object"){if(t[e]===null){t[e]=n;return}for(var s in n)fM(t[e],s,n[s])}}function Nge(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),s=1;s<e;s++)n[s-1]=arguments[s];return typeof t=="function"?kv.apply(void 0,[Iv,t].concat(n)):kv.apply(void 0,[function(){return Ige(Iv(),t)}].concat(n))}var Rge=kv(Iv),Age={twMerge:!0,twMergeConfig:{},responsiveVariants:!1},hM=t=>t||void 0,Xc=(...t)=>hM(rM(t).filter(Boolean).join(" ")),vx=null,nm={},Tv=!1,Pu=(...t)=>e=>e.twMerge?((!vx||Tv)&&(Tv=!1,vx=ls(nm)?Rge:Nge(nm)),hM(vx(Xc(t)))):Xc(t),oT=(t,e)=>{for(let n in e)t.hasOwnProperty(n)?t[n]=Xc(t[n],e[n]):t[n]=e[n];return t},Dge=(t,e)=>{let{extend:n=null,slots:s={},variants:r={},compoundVariants:o=[],compoundSlots:i=[],defaultVariants:a={}}=t,l={...Age,...e},u=n!=null&&n.base?Xc(n.base,t==null?void 0:t.base):t==null?void 0:t.base,c=n!=null&&n.variants&&!ls(n.variants)?iM(r,n.variants):r,d=n!=null&&n.defaultVariants&&!ls(n.defaultVariants)?{...n.defaultVariants,...a}:a;!ls(l.twMergeConfig)&&!ege(l.twMergeConfig,nm)&&(Tv=!0,nm=l.twMergeConfig);let f=ls(n==null?void 0:n.slots),h=ls(s)?{}:{base:Xc(t==null?void 0:t.base,f&&(n==null?void 0:n.base)),...s},p=f?h:oT({...n==null?void 0:n.slots},ls(h)?{base:t==null?void 0:t.base}:h),g=m=>{if(ls(c)&&ls(s)&&f)return Pu(u,m==null?void 0:m.class,m==null?void 0:m.className)(l);if(o&&!Array.isArray(o))throw new TypeError(`The "compoundVariants" prop must be an array. Received: ${typeof o}`);if(i&&!Array.isArray(i))throw new TypeError(`The "compoundSlots" prop must be an array. Received: ${typeof i}`);let x=(A,S,T=[],F)=>{let M=T;if(typeof S=="string")M=M.concat(tT(S).split(" ").map(U=>`${A}:${U}`));else if(Array.isArray(S))M=M.concat(S.reduce((U,P)=>U.concat(`${A}:${P}`),[]));else if(typeof S=="object"&&typeof F=="string"){for(let U in S)if(S.hasOwnProperty(U)&&U===F){let P=S[U];if(P&&typeof P=="string"){let L=tT(P);M[F]?M[F]=M[F].concat(L.split(" ").map(G=>`${A}:${G}`)):M[F]=L.split(" ").map(G=>`${A}:${G}`)}else Array.isArray(P)&&P.length>0&&(M[F]=P.reduce((L,G)=>L.concat(`${A}:${G}`),[]))}}return M},v=(A,S=c,T=null,F=null)=>{var M;let U=S[A];if(!U||ls(U))return null;let P=(M=F==null?void 0:F[A])!=null?M:m==null?void 0:m[A];if(P===null)return null;let L=eT(P),G=Array.isArray(l.responsiveVariants)&&l.responsiveVariants.length>0||l.responsiveVariants===!0,X=d==null?void 0:d[A],Q=[];if(typeof L=="object"&&G)for(let[te,ee]of Object.entries(L)){let se=U[ee];if(te==="initial"){X=ee;continue}Array.isArray(l.responsiveVariants)&&!l.responsiveVariants.includes(te)||(Q=x(te,se,Q,T))}let Z=U[L]||U[eT(X)];return typeof Q=="object"&&typeof T=="string"&&Q[T]?oT(Q,Z):Q.length>0?(Q.push(Z),Q):Z},b=()=>c?Object.keys(c).map(A=>v(A,c)):null,$=(A,S)=>{if(!c||typeof c!="object")return null;let T=new Array;for(let F in c){let M=v(F,c,A,S),U=A==="base"&&typeof M=="string"?M:M&&M[A];U&&(T[T.length]=U)}return T},C={};for(let A in m)m[A]!==void 0&&(C[A]=m[A]);let k=(A,S)=>{var T;let F=typeof(m==null?void 0:m[A])=="object"?{[A]:(T=m[A])==null?void 0:T.initial}:{};return{...d,...C,...F,...S}},w=(A=[],S)=>{let T=[];for(let{class:F,className:M,...U}of A){let P=!0;for(let[L,G]of Object.entries(U)){let X=k(L,S);if(Array.isArray(G)){if(!G.includes(X[L])){P=!1;break}}else if(X[L]!==G){P=!1;break}}P&&(F&&T.push(F),M&&T.push(M))}return T},I=A=>{let S=w(o,A),T=w(n==null?void 0:n.compoundVariants,A);return oM(T,S)},R=A=>{let S=I(A);if(!Array.isArray(S))return S;let T={};for(let F of S)if(typeof F=="string"&&(T.base=Pu(T.base,F)(l)),typeof F=="object")for(let[M,U]of Object.entries(F))T[M]=Pu(T[M],U)(l);return T},E=A=>{if(i.length<1)return null;let S={};for(let{slots:T=[],class:F,className:M,...U}of i){if(!ls(U)){let P=!0;for(let L of Object.keys(U)){let G=k(L,A)[L];if(G===void 0||(Array.isArray(U[L])?!U[L].includes(G):U[L]!==G)){P=!1;break}}if(!P)continue}for(let P of T)S[P]=S[P]||[],S[P].push([F,M])}return S};if(!ls(s)||!f){let A={};if(typeof p=="object"&&!ls(p))for(let S of Object.keys(p))A[S]=T=>{var F,M;return Pu(p[S],$(S,T),((F=R(T))!=null?F:[])[S],((M=E(T))!=null?M:[])[S],T==null?void 0:T.class,T==null?void 0:T.className)(l)};return A}return Pu(u,b(),I(),m==null?void 0:m.class,m==null?void 0:m.className)(l)},y=()=>{if(!(!c||typeof c!="object"))return Object.keys(c)};return g.variantKeys=y(),g.extend=n,g.base=u,g.slots=p,g.variants=c,g.defaultVariants=d,g.compoundSlots=i,g.compoundVariants=o,g},Sf=(t,e)=>{var n,s,r;return Dge(t,{...e,twMerge:(n=void 0)!=null?n:!0,twMergeConfig:{theme:{...(s=void 0)==null?void 0:s.theme,...JI.theme},classGroups:{...(r=void 0)==null?void 0:r.classGroups,...JI.classGroups}}})},pM=["outline-none","data-[focus-visible=true]:z-10","data-[focus-visible=true]:outline-2","data-[focus-visible=true]:outline-focus","data-[focus-visible=true]:outline-offset-2"],Fge=["outline-none","group-data-[focus-visible=true]:z-10","group-data-[focus-visible=true]:ring-2","group-data-[focus-visible=true]:ring-focus","group-data-[focus-visible=true]:ring-offset-2","group-data-[focus-visible=true]:ring-offset-background"],Ba={default:["[&+.border-medium.border-default]:ms-[calc(theme(borderWidth.medium)*-1)]"],primary:["[&+.border-medium.border-primary]:ms-[calc(theme(borderWidth.medium)*-1)]"],secondary:["[&+.border-medium.border-secondary]:ms-[calc(theme(borderWidth.medium)*-1)]"],success:["[&+.border-medium.border-success]:ms-[calc(theme(borderWidth.medium)*-1)]"],warning:["[&+.border-medium.border-warning]:ms-[calc(theme(borderWidth.medium)*-1)]"],danger:["[&+.border-medium.border-danger]:ms-[calc(theme(borderWidth.medium)*-1)]"]},iT=Sf({slots:{base:"group relative max-w-fit inline-flex items-center justify-start cursor-pointer touch-none tap-highlight-transparent",wrapper:["px-1","relative","inline-flex","items-center","justify-start","flex-shrink-0","overflow-hidden","bg-default-200","rounded-full",...Fge],thumb:["z-10","flex","items-center","justify-center","bg-white","shadow-small","rounded-full","origin-right"],startContent:"z-0 absolute left-1.5 rtl:right-1.5 rtl:left-[unset] text-current",endContent:"z-0 absolute right-1.5 rtl:left-1.5 rtl:right-[unset] text-default-600",thumbIcon:"text-black",label:"relative text-foreground select-none"},variants:{color:{default:{wrapper:["group-data-[selected=true]:bg-default-400","group-data-[selected=true]:text-default-foreground"]},primary:{wrapper:["group-data-[selected=true]:bg-primary","group-data-[selected=true]:text-primary-foreground"]},secondary:{wrapper:["group-data-[selected=true]:bg-secondary","group-data-[selected=true]:text-secondary-foreground"]},success:{wrapper:["group-data-[selected=true]:bg-success","group-data-[selected=true]:text-success-foreground"]},warning:{wrapper:["group-data-[selected=true]:bg-warning","group-data-[selected=true]:text-warning-foreground"]},danger:{wrapper:["group-data-[selected=true]:bg-danger","data-[selected=true]:text-danger-foreground"]}},size:{sm:{wrapper:"w-10 h-6 mr-2 rtl:ml-2 rtl:mr-[unset]",thumb:["w-4 h-4 text-tiny","group-data-[selected=true]:ml-4 rtl:group-data-[selected=true]:ml-0 rtl:group-data-[selected=true]:mr-4"],endContent:"text-tiny",startContent:"text-tiny",label:"text-small"},md:{wrapper:"w-12 h-7 mr-2 rtl:ml-2 rtl:mr-[unset]",thumb:["w-5 h-5 text-small","group-data-[selected=true]:ml-5 rtl:group-data-[selected=true]:ml-0 rtl:group-data-[selected=true]:mr-5"],endContent:"text-small",startContent:"text-small",label:"text-medium"},lg:{wrapper:"w-14 h-8 mr-2 rtl:ml-2 rtl:mr-[unset]",thumb:["w-6 h-6 text-medium","group-data-[selected=true]:ml-6 rtl:group-data-[selected=true]:ml-0 rtl:group-data-[selected=true]:mr-6"],endContent:"text-medium",startContent:"text-medium",label:"text-large"}},isDisabled:{true:{base:"opacity-disabled pointer-events-none"}},disableAnimation:{true:{wrapper:"transition-none",thumb:"transition-none"},false:{wrapper:"transition-background",thumb:"transition-all",startContent:["opacity-0","scale-50","transition-transform-opacity","group-data-[selected=true]:scale-100","group-data-[selected=true]:opacity-100"],endContent:["opacity-100","transition-transform-opacity","group-data-[selected=true]:translate-x-3","group-data-[selected=true]:opacity-0"]}}},defaultVariants:{color:"primary",size:"md",isDisabled:!1},compoundVariants:[{disableAnimation:!1,size:"sm",class:{thumb:["group-data-[pressed=true]:w-5","group-data-[selected]:group-data-[pressed]:ml-3"]}},{disableAnimation:!1,size:"md",class:{thumb:["group-data-[pressed=true]:w-6","group-data-[selected]:group-data-[pressed]:ml-4"]}},{disableAnimation:!1,size:"lg",class:{thumb:["group-data-[pressed=true]:w-7","group-data-[selected]:group-data-[pressed]:ml-5"]}}]}),aT=Sf({slots:{base:"relative inline-flex flex-col gap-2 items-center justify-center",wrapper:"relative flex",circle1:["absolute","w-full","h-full","rounded-full","animate-spinner-ease-spin","border-2","border-solid","border-t-transparent","border-l-transparent","border-r-transparent"],circle2:["absolute","w-full","h-full","rounded-full","opacity-75","animate-spinner-linear-spin","border-2","border-dotted","border-t-transparent","border-l-transparent","border-r-transparent"],label:"text-foreground dark:text-foreground-dark font-regular"},variants:{size:{sm:{wrapper:"w-5 h-5",circle1:"border-2",circle2:"border-2",label:"text-small"},md:{wrapper:"w-8 h-8",circle1:"border-3",circle2:"border-3",label:"text-medium"},lg:{wrapper:"w-10 h-10",circle1:"border-3",circle2:"border-3",label:"text-large"}},color:{current:{circle1:"border-b-current",circle2:"border-b-current"},white:{circle1:"border-b-white",circle2:"border-b-white"},default:{circle1:"border-b-default",circle2:"border-b-default"},primary:{circle1:"border-b-primary",circle2:"border-b-primary"},secondary:{circle1:"border-b-secondary",circle2:"border-b-secondary"},success:{circle1:"border-b-success",circle2:"border-b-success"},warning:{circle1:"border-b-warning",circle2:"border-b-warning"},danger:{circle1:"border-b-danger",circle2:"border-b-danger"}},labelColor:{foreground:{label:"text-foreground"},primary:{label:"text-primary"},secondary:{label:"text-secondary"},success:{label:"text-success"},warning:{label:"text-warning"},danger:{label:"text-danger"}}},defaultVariants:{size:"md",color:"primary",labelColor:"foreground"}}),lT=Sf({slots:{wrapper:["flex","w-screen","h-[100dvh]","fixed","inset-0","z-50","overflow-x-auto","justify-center"],base:["flex","flex-col","relative","bg-white","z-50","w-full","box-border","bg-content1","outline-none","mx-1","my-1","sm:mx-6","sm:my-16"],backdrop:"z-50",header:"flex py-4 px-6 flex-initial text-large font-semibold",body:"flex flex-1 flex-col gap-3 px-6 py-2",footer:"flex flex-row gap-2 px-6 py-4 justify-end",closeButton:["absolute","appearance-none","outline-none","select-none","top-1","right-1","rtl:left-1","rtl:right-[unset]","p-2","text-foreground-500","rounded-full","hover:bg-default-100","active:bg-default-200","tap-highlight-transparent",...pM]},variants:{size:{xs:{base:"max-w-xs"},sm:{base:"max-w-sm"},md:{base:"max-w-md"},lg:{base:"max-w-lg"},xl:{base:"max-w-xl"},"2xl":{base:"max-w-2xl"},"3xl":{base:"max-w-3xl"},"4xl":{base:"max-w-4xl"},"5xl":{base:"max-w-5xl"},full:{base:"my-0 mx-0 sm:mx-0 sm:my-0 max-w-full h-[100dvh] !rounded-none"}},radius:{none:{base:"rounded-none"},sm:{base:"rounded-small"},md:{base:"rounded-medium"},lg:{base:"rounded-large"}},placement:{auto:{wrapper:"items-end sm:items-center"},center:{wrapper:"items-center sm:items-center"},top:{wrapper:"items-start sm:items-start"},"top-center":{wrapper:"items-start sm:items-center"},bottom:{wrapper:"items-end sm:items-end"},"bottom-center":{wrapper:"items-end sm:items-center"}},shadow:{sm:{base:"shadow-small"},md:{base:"shadow-medium"},lg:{base:"shadow-large"}},backdrop:{transparent:{backdrop:"hidden"},opaque:{backdrop:"bg-overlay/50 backdrop-opacity-disabled"},blur:{backdrop:"backdrop-blur-md backdrop-saturate-150 bg-overlay/30"}},scrollBehavior:{normal:{base:"overflow-y-hidden"},inside:{base:"max-h-[calc(100%_-_7.5rem)]",body:"overflow-y-auto"},outside:{wrapper:"items-start sm:items-start overflow-y-auto",base:"my-16"}},disableAnimation:{false:{wrapper:["[--scale-enter:100%]","[--scale-exit:100%]","[--slide-enter:0px]","[--slide-exit:80px]","sm:[--scale-enter:100%]","sm:[--scale-exit:103%]","sm:[--slide-enter:0px]","sm:[--slide-exit:0px]"]}}},defaultVariants:{size:"md",radius:"lg",shadow:"sm",placement:"auto",backdrop:"opaque",scrollBehavior:"normal"},compoundVariants:[{backdrop:["opaque","blur"],class:{backdrop:"w-screen h-screen fixed inset-0"}}]}),Pge=Sf({base:["z-0","group","relative","inline-flex","items-center","justify-center","box-border","appearance-none","outline-none","select-none","whitespace-nowrap","min-w-max","font-normal","subpixel-antialiased","overflow-hidden","tap-highlight-transparent","data-[pressed=true]:scale-[0.97]",...pM],variants:{variant:{solid:"",bordered:"border-medium bg-transparent",light:"bg-transparent",flat:"",faded:"border-medium",shadow:"",ghost:"border-medium bg-transparent"},size:{sm:"px-3 min-w-16 h-8 text-tiny gap-2 rounded-small",md:"px-4 min-w-20 h-10 text-small gap-2 rounded-medium",lg:"px-6 min-w-24 h-12 text-medium gap-3 rounded-large"},color:{default:"",primary:"",secondary:"",success:"",warning:"",danger:""},radius:{none:"rounded-none",sm:"rounded-small",md:"rounded-medium",lg:"rounded-large",full:"rounded-full"},fullWidth:{true:"w-full"},isDisabled:{true:"opacity-disabled pointer-events-none"},isInGroup:{true:"[&:not(:first-child):not(:last-child)]:rounded-none"},isIconOnly:{true:"px-0 !gap-0",false:"[&>svg]:max-w-[theme(spacing.8)]"},disableAnimation:{true:"!transition-none",false:"transition-transform-colors-opacity motion-reduce:transition-none"}},defaultVariants:{size:"md",variant:"solid",color:"default",fullWidth:!1,isDisabled:!1,isInGroup:!1},compoundVariants:[{variant:"solid",color:"default",class:Ie.solid.default},{variant:"solid",color:"primary",class:Ie.solid.primary},{variant:"solid",color:"secondary",class:Ie.solid.secondary},{variant:"solid",color:"success",class:Ie.solid.success},{variant:"solid",color:"warning",class:Ie.solid.warning},{variant:"solid",color:"danger",class:Ie.solid.danger},{variant:"shadow",color:"default",class:Ie.shadow.default},{variant:"shadow",color:"primary",class:Ie.shadow.primary},{variant:"shadow",color:"secondary",class:Ie.shadow.secondary},{variant:"shadow",color:"success",class:Ie.shadow.success},{variant:"shadow",color:"warning",class:Ie.shadow.warning},{variant:"shadow",color:"danger",class:Ie.shadow.danger},{variant:"bordered",color:"default",class:Ie.bordered.default},{variant:"bordered",color:"primary",class:Ie.bordered.primary},{variant:"bordered",color:"secondary",class:Ie.bordered.secondary},{variant:"bordered",color:"success",class:Ie.bordered.success},{variant:"bordered",color:"warning",class:Ie.bordered.warning},{variant:"bordered",color:"danger",class:Ie.bordered.danger},{variant:"flat",color:"default",class:Ie.flat.default},{variant:"flat",color:"primary",class:Ie.flat.primary},{variant:"flat",color:"secondary",class:Ie.flat.secondary},{variant:"flat",color:"success",class:Ie.flat.success},{variant:"flat",color:"warning",class:Ie.flat.warning},{variant:"flat",color:"danger",class:Ie.flat.danger},{variant:"faded",color:"default",class:Ie.faded.default},{variant:"faded",color:"primary",class:Ie.faded.primary},{variant:"faded",color:"secondary",class:Ie.faded.secondary},{variant:"faded",color:"success",class:Ie.faded.success},{variant:"faded",color:"warning",class:Ie.faded.warning},{variant:"faded",color:"danger",class:Ie.faded.danger},{variant:"light",color:"default",class:[Ie.light.default,"data-[hover=true]:bg-default/40"]},{variant:"light",color:"primary",class:[Ie.light.primary,"data-[hover=true]:bg-primary/20"]},{variant:"light",color:"secondary",class:[Ie.light.secondary,"data-[hover=true]:bg-secondary/20"]},{variant:"light",color:"success",class:[Ie.light.success,"data-[hover=true]:bg-success/20"]},{variant:"light",color:"warning",class:[Ie.light.warning,"data-[hover=true]:bg-warning/20"]},{variant:"light",color:"danger",class:[Ie.light.danger,"data-[hover=true]:bg-danger/20"]},{variant:"ghost",color:"default",class:Ie.ghost.default},{variant:"ghost",color:"primary",class:Ie.ghost.primary},{variant:"ghost",color:"secondary",class:Ie.ghost.secondary},{variant:"ghost",color:"success",class:Ie.ghost.success},{variant:"ghost",color:"warning",class:Ie.ghost.warning},{variant:"ghost",color:"danger",class:Ie.ghost.danger},{isInGroup:!0,class:"rounded-none first:rounded-s-medium last:rounded-e-medium"},{isInGroup:!0,size:"sm",class:"rounded-none first:rounded-s-small last:rounded-e-small"},{isInGroup:!0,size:"md",class:"rounded-none first:rounded-s-medium last:rounded-e-medium"},{isInGroup:!0,size:"lg",class:"rounded-none first:rounded-s-large last:rounded-e-large"},{isInGroup:!0,isRounded:!0,class:"rounded-none first:rounded-s-full last:rounded-e-full"},{isInGroup:!0,radius:"none",class:"rounded-none first:rounded-s-none last:rounded-e-none"},{isInGroup:!0,radius:"sm",class:"rounded-none first:rounded-s-small last:rounded-e-small"},{isInGroup:!0,radius:"md",class:"rounded-none first:rounded-s-medium last:rounded-e-medium"},{isInGroup:!0,radius:"lg",class:"rounded-none first:rounded-s-large last:rounded-e-large"},{isInGroup:!0,radius:"full",class:"rounded-none first:rounded-s-full last:rounded-e-full"},{isInGroup:!0,variant:["ghost","bordered"],color:"default",className:Ba.default},{isInGroup:!0,variant:["ghost","bordered"],color:"primary",className:Ba.primary},{isInGroup:!0,variant:["ghost","bordered"],color:"secondary",className:Ba.secondary},{isInGroup:!0,variant:["ghost","bordered"],color:"success",className:Ba.success},{isInGroup:!0,variant:["ghost","bordered"],color:"warning",className:Ba.warning},{isInGroup:!0,variant:["ghost","bordered"],color:"danger",className:Ba.danger},{isIconOnly:!0,size:"sm",class:"min-w-8 w-8 h-8"},{isIconOnly:!0,size:"md",class:"min-w-10 w-10 h-10"},{isIconOnly:!0,size:"lg",class:"min-w-12 w-12 h-12"},{variant:["solid","faded","flat","bordered","shadow"],class:"data-[hover=true]:opacity-hover"}]}),uT=Sf({base:"inline-flex items-center justify-center h-auto",variants:{fullWidth:{true:"w-full"}},defaultVariants:{fullWidth:!1}});let Oge=class{isDefaultPrevented(){return this.nativeEvent.defaultPrevented}preventDefault(){this.defaultPrevented=!0,this.nativeEvent.preventDefault()}stopPropagation(){this.nativeEvent.stopPropagation(),this.isPropagationStopped=()=>!0}isPropagationStopped(){return!1}persist(){}constructor(e,n){this.nativeEvent=n,this.target=n.target,this.currentTarget=n.currentTarget,this.relatedTarget=n.relatedTarget,this.bubbles=n.bubbles,this.cancelable=n.cancelable,this.defaultPrevented=n.defaultPrevented,this.eventPhase=n.eventPhase,this.isTrusted=n.isTrusted,this.timeStamp=n.timeStamp,this.type=e}};function mM(t){let e=D.useRef({isFocused:!1,observer:null});It(()=>{const s=e.current;return()=>{s.observer&&(s.observer.disconnect(),s.observer=null)}},[]);let n=qt(s=>{t==null||t(s)});return D.useCallback(s=>{if(s.target instanceof HTMLButtonElement||s.target instanceof HTMLInputElement||s.target instanceof HTMLTextAreaElement||s.target instanceof HTMLSelectElement){e.current.isFocused=!0;let r=s.target,o=i=>{e.current.isFocused=!1,r.disabled&&n(new Oge("blur",i)),e.current.observer&&(e.current.observer.disconnect(),e.current.observer=null)};r.addEventListener("focusout",o,{once:!0}),e.current.observer=new MutationObserver(()=>{if(e.current.isFocused&&r.disabled){var i;(i=e.current.observer)===null||i===void 0||i.disconnect();let a=r===document.activeElement?null:document.activeElement;r.dispatchEvent(new FocusEvent("blur",{relatedTarget:a})),r.dispatchEvent(new FocusEvent("focusout",{bubbles:!0,relatedTarget:a}))}}),e.current.observer.observe(r,{attributes:!0,attributeFilter:["disabled"]})}},[n])}function gM(t){let{isDisabled:e,onFocus:n,onBlur:s,onFocusChange:r}=t;const o=D.useCallback(l=>{if(l.target===l.currentTarget)return s&&s(l),r&&r(!1),!0},[s,r]),i=mM(o),a=D.useCallback(l=>{const u=$e(l.target);l.target===l.currentTarget&&u.activeElement===l.target&&(n&&n(l),r&&r(!0),i(l))},[r,n,i]);return{focusProps:{onFocus:!e&&(n||r||s)?a:void 0,onBlur:!e&&(s||r)?o:void 0}}}let gu=null,Ev=new Set,dc=new Map,ma=!1,Nv=!1;const Lge={Tab:!0,Escape:!0};function tC(t,e){for(let n of Ev)n(t,e)}function Mge(t){return!(t.metaKey||!Br()&&t.altKey||t.ctrlKey||t.key==="Control"||t.key==="Shift"||t.key==="Meta")}function sm(t){ma=!0,Mge(t)&&(gu="keyboard",tC("keyboard",t))}function Es(t){gu="pointer",(t.type==="mousedown"||t.type==="pointerdown")&&(ma=!0,tC("pointer",t))}function xM(t){po(t)&&(ma=!0,gu="virtual")}function yM(t){t.target===window||t.target===document||(!ma&&!Nv&&(gu="virtual",tC("virtual",t)),ma=!1,Nv=!1)}function vM(){ma=!1,Nv=!0}function Rv(t){if(typeof window>"u"||dc.get(lt(t)))return;const e=lt(t),n=$e(t);let s=e.HTMLElement.prototype.focus;e.HTMLElement.prototype.focus=function(){ma=!0,s.apply(this,arguments)},n.addEventListener("keydown",sm,!0),n.addEventListener("keyup",sm,!0),n.addEventListener("click",xM,!0),e.addEventListener("focus",yM,!0),e.addEventListener("blur",vM,!1),typeof PointerEvent<"u"?(n.addEventListener("pointerdown",Es,!0),n.addEventListener("pointermove",Es,!0),n.addEventListener("pointerup",Es,!0)):(n.addEventListener("mousedown",Es,!0),n.addEventListener("mousemove",Es,!0),n.addEventListener("mouseup",Es,!0)),e.addEventListener("beforeunload",()=>{bM(t)},{once:!0}),dc.set(e,{focus:s})}const bM=(t,e)=>{const n=lt(t),s=$e(t);e&&s.removeEventListener("DOMContentLoaded",e),dc.has(n)&&(n.HTMLElement.prototype.focus=dc.get(n).focus,s.removeEventListener("keydown",sm,!0),s.removeEventListener("keyup",sm,!0),s.removeEventListener("click",xM,!0),n.removeEventListener("focus",yM,!0),n.removeEventListener("blur",vM,!1),typeof PointerEvent<"u"?(s.removeEventListener("pointerdown",Es,!0),s.removeEventListener("pointermove",Es,!0),s.removeEventListener("pointerup",Es,!0)):(s.removeEventListener("mousedown",Es,!0),s.removeEventListener("mousemove",Es,!0),s.removeEventListener("mouseup",Es,!0)),dc.delete(n))};function _ge(t){const e=$e(t);let n;return e.readyState!=="loading"?Rv(t):(n=()=>{Rv(t)},e.addEventListener("DOMContentLoaded",n)),()=>bM(t,n)}typeof document<"u"&&_ge();function wM(){return gu!=="pointer"}function zge(){return gu}const Vge=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function Bge(t,e,n){var s;const r=typeof window<"u"?lt(n==null?void 0:n.target).HTMLInputElement:HTMLInputElement,o=typeof window<"u"?lt(n==null?void 0:n.target).HTMLTextAreaElement:HTMLTextAreaElement,i=typeof window<"u"?lt(n==null?void 0:n.target).HTMLElement:HTMLElement,a=typeof window<"u"?lt(n==null?void 0:n.target).KeyboardEvent:KeyboardEvent;return t=t||(n==null?void 0:n.target)instanceof r&&!Vge.has(n==null||(s=n.target)===null||s===void 0?void 0:s.type)||(n==null?void 0:n.target)instanceof o||(n==null?void 0:n.target)instanceof i&&(n==null?void 0:n.target.isContentEditable),!(t&&e==="keyboard"&&n instanceof a&&!Lge[n.key])}function Wge(t,e,n){Rv(),D.useEffect(()=>{let s=(r,o)=>{Bge(!!(n!=null&&n.isTextInput),r,o)&&t(wM())};return Ev.add(s),()=>{Ev.delete(s)}},e)}function Uge(t){let{isDisabled:e,onBlurWithin:n,onFocusWithin:s,onFocusWithinChange:r}=t,o=D.useRef({isFocusWithin:!1}),i=D.useCallback(u=>{o.current.isFocusWithin&&!u.currentTarget.contains(u.relatedTarget)&&(o.current.isFocusWithin=!1,n&&n(u),r&&r(!1))},[n,r,o]),a=mM(i),l=D.useCallback(u=>{!o.current.isFocusWithin&&document.activeElement===u.target&&(s&&s(u),r&&r(!0),o.current.isFocusWithin=!0,a(u))},[s,r,a]);return e?{focusWithinProps:{onFocus:void 0,onBlur:void 0}}:{focusWithinProps:{onFocus:l,onBlur:i}}}function cT(t){if(!t)return;let e=!0;return n=>{let s={...n,preventDefault(){n.preventDefault()},isDefaultPrevented(){return n.isDefaultPrevented()},stopPropagation(){console.error("stopPropagation is now the default behavior for events in React Spectrum. You can use continuePropagation() to revert this behavior.")},continuePropagation(){e=!1}};t(s),e&&n.stopPropagation()}}function Gge(t){return{keyboardProps:t.isDisabled?{}:{onKeyDown:cT(t.onKeyDown),onKeyUp:cT(t.onKeyUp)}}}function Hge(t){const e=$e(t);if(zge()==="virtual"){let n=e.activeElement;fu(()=>{e.activeElement===n&&t.isConnected&&cn(t)})}else cn(t)}function jge(t,e){return!t||!e?!1:e.some(n=>n.contains(t))}class nC{get size(){return this.fastMap.size}getTreeNode(e){return this.fastMap.get(e)}addTreeNode(e,n,s){let r=this.fastMap.get(n??null);if(!r)return;let o=new dT({scopeRef:e});r.addChild(o),o.parent=r,this.fastMap.set(e,o),s&&(o.nodeToRestore=s)}addNode(e){this.fastMap.set(e.scopeRef,e)}removeTreeNode(e){if(e===null)return;let n=this.fastMap.get(e);if(!n)return;let s=n.parent;for(let o of this.traverse())o!==n&&n.nodeToRestore&&o.nodeToRestore&&n.scopeRef&&n.scopeRef.current&&jge(o.nodeToRestore,n.scopeRef.current)&&(o.nodeToRestore=n.nodeToRestore);let r=n.children;s&&(s.removeChild(n),r.size>0&&r.forEach(o=>s&&s.addChild(o))),this.fastMap.delete(n.scopeRef)}*traverse(e=this.root){if(e.scopeRef!=null&&(yield e),e.children.size>0)for(let n of e.children)yield*this.traverse(n)}clone(){var e;let n=new nC;var s;for(let r of this.traverse())n.addTreeNode(r.scopeRef,(s=(e=r.parent)===null||e===void 0?void 0:e.scopeRef)!==null&&s!==void 0?s:null,r.nodeToRestore);return n}constructor(){this.fastMap=new Map,this.root=new dT({scopeRef:null}),this.fastMap.set(null,this.root)}}class dT{addChild(e){this.children.add(e),e.parent=this}removeChild(e){this.children.delete(e),e.parent=void 0}constructor(e){this.children=new Set,this.contain=!1,this.scopeRef=e.scopeRef}}new nC;function sC(t={}){let{autoFocus:e=!1,isTextInput:n,within:s}=t,r=D.useRef({isFocused:!1,isFocusVisible:e||wM()}),[o,i]=D.useState(!1),[a,l]=D.useState(()=>r.current.isFocused&&r.current.isFocusVisible),u=D.useCallback(()=>l(r.current.isFocused&&r.current.isFocusVisible),[]),c=D.useCallback(h=>{r.current.isFocused=h,i(h),u()},[u]);Wge(h=>{r.current.isFocusVisible=h,u()},[],{isTextInput:n});let{focusProps:d}=gM({isDisabled:s,onFocusChange:c}),{focusWithinProps:f}=Uge({isDisabled:!s,onFocusWithinChange:c});return{isFocused:o,isFocusVisible:a,focusProps:s?f:d}}let Kge=Xe.createContext(null);function Xge(t){let e=D.useContext(Kge)||{};i0(e,t);let{ref:n,...s}=e;return s}function qge(t,e){let{focusProps:n}=gM(t),{keyboardProps:s}=Gge(t),r=$t(n,s),o=Xge(e),i=t.isDisabled?{}:o,a=D.useRef(t.autoFocus);return D.useEffect(()=>{a.current&&e.current&&Hge(e.current),a.current=!1},[e]),{focusableProps:$t({...r,tabIndex:t.excludeFromTabOrder&&!t.isDisabled?-1:void 0},i)}}let ul="default",Av="",_h=new WeakMap;function fT(t){if(vf()){if(ul==="default"){const e=$e(t);Av=e.documentElement.style.webkitUserSelect,e.documentElement.style.webkitUserSelect="none"}ul="disabled"}else(t instanceof HTMLElement||t instanceof SVGElement)&&(_h.set(t,t.style.userSelect),t.style.userSelect="none")}function mh(t){if(vf()){if(ul!=="disabled")return;ul="restoring",setTimeout(()=>{fu(()=>{if(ul==="restoring"){const e=$e(t);e.documentElement.style.webkitUserSelect==="none"&&(e.documentElement.style.webkitUserSelect=Av||""),Av="",ul="default"}})},300)}else if((t instanceof HTMLElement||t instanceof SVGElement)&&t&&_h.has(t)){let e=_h.get(t);t.style.userSelect==="none"&&(t.style.userSelect=e),t.getAttribute("style")===""&&t.removeAttribute("style"),_h.delete(t)}}const $M=Xe.createContext({register:()=>{}});$M.displayName="PressResponderContext";function Yge(t){let e=D.useContext($M);if(e){let{register:n,...s}=e;t=$t(s,t),n()}return i0(e,t.ref),t}var gh=new WeakMap;let xh=class{continuePropagation(){Up(this,gh,!1)}get shouldStopPropagation(){return ML(this,gh)}constructor(e,n,s){HO(this,gh,{writable:!0,value:void 0}),Up(this,gh,!0),this.type=e,this.pointerType=n,this.target=s.currentTarget,this.shiftKey=s.shiftKey,this.metaKey=s.metaKey,this.ctrlKey=s.ctrlKey,this.altKey=s.altKey}};const hT=Symbol("linkClicked");function CM(t){let{onPress:e,onPressChange:n,onPressStart:s,onPressEnd:r,onPressUp:o,isDisabled:i,isPressed:a,preventFocusOnPress:l,shouldCancelOnPointerExit:u,allowTextSelectionOnPress:c,ref:d,...f}=Yge(t),[h,p]=D.useState(!1),g=D.useRef({isPressed:!1,ignoreEmulatedMouseEvents:!1,ignoreClickAfterPress:!1,didFirePressStart:!1,isTriggeringEvent:!1,activePointerId:null,target:null,isOverTarget:!1,pointerType:null}),{addGlobalListener:y,removeAllGlobalListeners:m}=YO(),x=qt((w,I)=>{let R=g.current;if(i||R.didFirePressStart)return!1;let E=!0;if(R.isTriggeringEvent=!0,s){let A=new xh("pressstart",I,w);s(A),E=A.shouldStopPropagation}return n&&n(!0),R.isTriggeringEvent=!1,R.didFirePressStart=!0,p(!0),E}),v=qt((w,I,R=!0)=>{let E=g.current;if(!E.didFirePressStart)return!1;E.ignoreClickAfterPress=!0,E.didFirePressStart=!1,E.isTriggeringEvent=!0;let A=!0;if(r){let S=new xh("pressend",I,w);r(S),A=S.shouldStopPropagation}if(n&&n(!1),p(!1),e&&R&&!i){let S=new xh("press",I,w);e(S),A&&(A=S.shouldStopPropagation)}return E.isTriggeringEvent=!1,A}),b=qt((w,I)=>{let R=g.current;if(i)return!1;if(o){R.isTriggeringEvent=!0;let E=new xh("pressup",I,w);return o(E),R.isTriggeringEvent=!1,E.shouldStopPropagation}return!0}),$=qt(w=>{let I=g.current;I.isPressed&&I.target&&(I.isOverTarget&&I.pointerType!=null&&v(Hr(I.target,w),I.pointerType,!1),I.isPressed=!1,I.isOverTarget=!1,I.activePointerId=null,I.pointerType=null,m(),c||mh(I.target))}),C=qt(w=>{u&&$(w)}),k=D.useMemo(()=>{let w=g.current,I={onKeyDown(E){if(bx(E.nativeEvent,E.currentTarget)&&E.currentTarget.contains(E.target)){var A;mT(E.target,E.key)&&E.preventDefault();let S=!0;if(!w.isPressed&&!E.repeat){w.target=E.currentTarget,w.isPressed=!0,S=x(E,"keyboard");let T=E.currentTarget,F=M=>{bx(M,T)&&!M.repeat&&T.contains(M.target)&&w.target&&b(Hr(w.target,M),"keyboard")};y($e(E.currentTarget),"keyup",Vr(F,R),!0)}S&&E.stopPropagation(),E.metaKey&&Br()&&((A=w.metaKeyEvents)===null||A===void 0||A.set(E.key,E.nativeEvent))}else E.key==="Meta"&&(w.metaKeyEvents=new Map)},onClick(E){if(!(E&&!E.currentTarget.contains(E.target))&&E&&E.button===0&&!w.isTriggeringEvent&&!ha.isOpening){let A=!0;if(i&&E.preventDefault(),!w.ignoreClickAfterPress&&!w.ignoreEmulatedMouseEvents&&!w.isPressed&&(w.pointerType==="virtual"||po(E.nativeEvent))){!i&&!l&&cn(E.currentTarget);let S=x(E,"virtual"),T=b(E,"virtual"),F=v(E,"virtual");A=S&&T&&F}w.ignoreEmulatedMouseEvents=!1,w.ignoreClickAfterPress=!1,A&&E.stopPropagation()}}},R=E=>{var A;if(w.isPressed&&w.target&&bx(E,w.target)){var S;mT(E.target,E.key)&&E.preventDefault();let F=E.target;v(Hr(w.target,E),"keyboard",w.target.contains(F)),m(),E.key!=="Enter"&&rC(w.target)&&w.target.contains(F)&&!E[hT]&&(E[hT]=!0,ha(w.target,E,!1)),w.isPressed=!1,(S=w.metaKeyEvents)===null||S===void 0||S.delete(E.key)}else if(E.key==="Meta"&&(!((A=w.metaKeyEvents)===null||A===void 0)&&A.size)){var T;let F=w.metaKeyEvents;w.metaKeyEvents=void 0;for(let M of F.values())(T=w.target)===null||T===void 0||T.dispatchEvent(new KeyboardEvent("keyup",M))}};if(typeof PointerEvent<"u"){I.onPointerDown=T=>{if(T.button!==0||!T.currentTarget.contains(T.target))return;if(ZO(T.nativeEvent)){w.pointerType="virtual";return}wx(T.currentTarget)&&T.preventDefault(),w.pointerType=T.pointerType;let F=!0;w.isPressed||(w.isPressed=!0,w.isOverTarget=!0,w.activePointerId=T.pointerId,w.target=T.currentTarget,!i&&!l&&cn(T.currentTarget),c||fT(w.target),F=x(T,w.pointerType),y($e(T.currentTarget),"pointermove",E,!1),y($e(T.currentTarget),"pointerup",A,!1),y($e(T.currentTarget),"pointercancel",S,!1)),F&&T.stopPropagation()},I.onMouseDown=T=>{T.currentTarget.contains(T.target)&&T.button===0&&(wx(T.currentTarget)&&T.preventDefault(),T.stopPropagation())},I.onPointerUp=T=>{!T.currentTarget.contains(T.target)||w.pointerType==="virtual"||T.button===0&&Wa(T,T.currentTarget)&&b(T,w.pointerType||T.pointerType)};let E=T=>{T.pointerId===w.activePointerId&&(w.target&&Wa(T,w.target)?!w.isOverTarget&&w.pointerType!=null&&(w.isOverTarget=!0,x(Hr(w.target,T),w.pointerType)):w.target&&w.isOverTarget&&w.pointerType!=null&&(w.isOverTarget=!1,v(Hr(w.target,T),w.pointerType,!1),C(T)))},A=T=>{T.pointerId===w.activePointerId&&w.isPressed&&T.button===0&&w.target&&(Wa(T,w.target)&&w.pointerType!=null?v(Hr(w.target,T),w.pointerType):w.isOverTarget&&w.pointerType!=null&&v(Hr(w.target,T),w.pointerType,!1),w.isPressed=!1,w.isOverTarget=!1,w.activePointerId=null,w.pointerType=null,m(),c||mh(w.target))},S=T=>{$(T)};I.onDragStart=T=>{T.currentTarget.contains(T.target)&&$(T)}}else{I.onMouseDown=S=>{if(S.button!==0||!S.currentTarget.contains(S.target))return;if(wx(S.currentTarget)&&S.preventDefault(),w.ignoreEmulatedMouseEvents){S.stopPropagation();return}w.isPressed=!0,w.isOverTarget=!0,w.target=S.currentTarget,w.pointerType=po(S.nativeEvent)?"virtual":"mouse",!i&&!l&&cn(S.currentTarget),x(S,w.pointerType)&&S.stopPropagation(),y($e(S.currentTarget),"mouseup",E,!1)},I.onMouseEnter=S=>{if(!S.currentTarget.contains(S.target))return;let T=!0;w.isPressed&&!w.ignoreEmulatedMouseEvents&&w.pointerType!=null&&(w.isOverTarget=!0,T=x(S,w.pointerType)),T&&S.stopPropagation()},I.onMouseLeave=S=>{if(!S.currentTarget.contains(S.target))return;let T=!0;w.isPressed&&!w.ignoreEmulatedMouseEvents&&w.pointerType!=null&&(w.isOverTarget=!1,T=v(S,w.pointerType,!1),C(S)),T&&S.stopPropagation()},I.onMouseUp=S=>{S.currentTarget.contains(S.target)&&!w.ignoreEmulatedMouseEvents&&S.button===0&&b(S,w.pointerType||"mouse")};let E=S=>{if(S.button===0){if(w.isPressed=!1,m(),w.ignoreEmulatedMouseEvents){w.ignoreEmulatedMouseEvents=!1;return}w.target&&Wa(S,w.target)&&w.pointerType!=null?v(Hr(w.target,S),w.pointerType):w.target&&w.isOverTarget&&w.pointerType!=null&&v(Hr(w.target,S),w.pointerType,!1),w.isOverTarget=!1}};I.onTouchStart=S=>{if(!S.currentTarget.contains(S.target))return;let T=Qge(S.nativeEvent);if(!T)return;w.activePointerId=T.identifier,w.ignoreEmulatedMouseEvents=!0,w.isOverTarget=!0,w.isPressed=!0,w.target=S.currentTarget,w.pointerType="touch",!i&&!l&&cn(S.currentTarget),c||fT(w.target),x(S,w.pointerType)&&S.stopPropagation(),y(lt(S.currentTarget),"scroll",A,!0)},I.onTouchMove=S=>{if(!S.currentTarget.contains(S.target))return;if(!w.isPressed){S.stopPropagation();return}let T=pT(S.nativeEvent,w.activePointerId),F=!0;T&&Wa(T,S.currentTarget)?!w.isOverTarget&&w.pointerType!=null&&(w.isOverTarget=!0,F=x(S,w.pointerType)):w.isOverTarget&&w.pointerType!=null&&(w.isOverTarget=!1,F=v(S,w.pointerType,!1),C(S)),F&&S.stopPropagation()},I.onTouchEnd=S=>{if(!S.currentTarget.contains(S.target))return;if(!w.isPressed){S.stopPropagation();return}let T=pT(S.nativeEvent,w.activePointerId),F=!0;T&&Wa(T,S.currentTarget)&&w.pointerType!=null?(b(S,w.pointerType),F=v(S,w.pointerType)):w.isOverTarget&&w.pointerType!=null&&(F=v(S,w.pointerType,!1)),F&&S.stopPropagation(),w.isPressed=!1,w.activePointerId=null,w.isOverTarget=!1,w.ignoreEmulatedMouseEvents=!0,w.target&&!c&&mh(w.target),m()},I.onTouchCancel=S=>{S.currentTarget.contains(S.target)&&(S.stopPropagation(),w.isPressed&&$(S))};let A=S=>{w.isPressed&&S.target.contains(w.target)&&$({currentTarget:w.target,shiftKey:!1,ctrlKey:!1,metaKey:!1,altKey:!1})};I.onDragStart=S=>{S.currentTarget.contains(S.target)&&$(S)}}return I},[y,i,l,m,c,$,C,v,x,b]);return D.useEffect(()=>()=>{var w;c||mh((w=g.current.target)!==null&&w!==void 0?w:void 0)},[c]),{isPressed:a||h,pressProps:$t(f,k)}}function rC(t){return t.tagName==="A"&&t.hasAttribute("href")}function bx(t,e){const{key:n,code:s}=t,r=e,o=r.getAttribute("role");return(n==="Enter"||n===" "||n==="Spacebar"||s==="Space")&&!(r instanceof lt(r).HTMLInputElement&&!kM(r,n)||r instanceof lt(r).HTMLTextAreaElement||r.isContentEditable)&&!((o==="link"||!o&&rC(r))&&n!=="Enter")}function Qge(t){const{targetTouches:e}=t;return e.length>0?e[0]:null}function pT(t,e){const n=t.changedTouches;for(let s=0;s<n.length;s++){const r=n[s];if(r.identifier===e)return r}return null}function Hr(t,e){return{currentTarget:t,shiftKey:e.shiftKey,ctrlKey:e.ctrlKey,metaKey:e.metaKey,altKey:e.altKey}}function Zge(t){let e=0,n=0;return t.width!==void 0?e=t.width/2:t.radiusX!==void 0&&(e=t.radiusX),t.height!==void 0?n=t.height/2:t.radiusY!==void 0&&(n=t.radiusY),{top:t.clientY-n,right:t.clientX+e,bottom:t.clientY+n,left:t.clientX-e}}function Jge(t,e){return!(t.left>e.right||e.left>t.right||t.top>e.bottom||e.top>t.bottom)}function Wa(t,e){let n=e.getBoundingClientRect(),s=Zge(t);return Jge(n,s)}function wx(t){return!(t instanceof HTMLElement)||!t.hasAttribute("draggable")}function mT(t,e){return t instanceof HTMLInputElement?!kM(t,e):t instanceof HTMLButtonElement?t.type!=="submit"&&t.type!=="reset":!rC(t)}const e0e=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function kM(t,e){return t.type==="checkbox"||t.type==="radio"?e===" ":e0e.has(t.type)}let t0e=new Set,fc=new Map,ga=!1,Dv=!1;function oC(t,e){for(let n of t0e)n(t,e)}function n0e(t){return!(t.metaKey||!Br()&&t.altKey||t.ctrlKey||t.key==="Control"||t.key==="Shift"||t.key==="Meta")}function rm(t){ga=!0,n0e(t)&&oC("keyboard",t)}function Ns(t){(t.type==="mousedown"||t.type==="pointerdown")&&(ga=!0,oC("pointer",t))}function SM(t){po(t)&&(ga=!0)}function IM(t){t.target===window||t.target===document||(!ga&&!Dv&&oC("virtual",t),ga=!1,Dv=!1)}function TM(){ga=!1,Dv=!0}function gT(t){if(typeof window>"u"||fc.get(lt(t)))return;const e=lt(t),n=$e(t);let s=e.HTMLElement.prototype.focus;e.HTMLElement.prototype.focus=function(){ga=!0,s.apply(this,arguments)},n.addEventListener("keydown",rm,!0),n.addEventListener("keyup",rm,!0),n.addEventListener("click",SM,!0),e.addEventListener("focus",IM,!0),e.addEventListener("blur",TM,!1),typeof PointerEvent<"u"?(n.addEventListener("pointerdown",Ns,!0),n.addEventListener("pointermove",Ns,!0),n.addEventListener("pointerup",Ns,!0)):(n.addEventListener("mousedown",Ns,!0),n.addEventListener("mousemove",Ns,!0),n.addEventListener("mouseup",Ns,!0)),e.addEventListener("beforeunload",()=>{EM(t)},{once:!0}),fc.set(e,{focus:s})}const EM=(t,e)=>{const n=lt(t),s=$e(t);e&&s.removeEventListener("DOMContentLoaded",e),fc.has(n)&&(n.HTMLElement.prototype.focus=fc.get(n).focus,s.removeEventListener("keydown",rm,!0),s.removeEventListener("keyup",rm,!0),s.removeEventListener("click",SM,!0),n.removeEventListener("focus",IM,!0),n.removeEventListener("blur",TM,!1),typeof PointerEvent<"u"?(s.removeEventListener("pointerdown",Ns,!0),s.removeEventListener("pointermove",Ns,!0),s.removeEventListener("pointerup",Ns,!0)):(s.removeEventListener("mousedown",Ns,!0),s.removeEventListener("mousemove",Ns,!0),s.removeEventListener("mouseup",Ns,!0)),fc.delete(n))};function s0e(t){const e=$e(t);let n;return e.readyState!=="loading"?gT(t):(n=()=>{gT(t)},e.addEventListener("DOMContentLoaded",n)),()=>EM(t,n)}typeof document<"u"&&s0e();let om=!1,$x=0;function Fv(){om=!0,setTimeout(()=>{om=!1},50)}function xT(t){t.pointerType==="touch"&&Fv()}function r0e(){if(!(typeof document>"u"))return typeof PointerEvent<"u"?document.addEventListener("pointerup",xT):document.addEventListener("touchend",Fv),$x++,()=>{$x--,!($x>0)&&(typeof PointerEvent<"u"?document.removeEventListener("pointerup",xT):document.removeEventListener("touchend",Fv))}}function NM(t){let{onHoverStart:e,onHoverChange:n,onHoverEnd:s,isDisabled:r}=t,[o,i]=D.useState(!1),a=D.useRef({isHovered:!1,ignoreEmulatedMouseEvents:!1,pointerType:"",target:null}).current;D.useEffect(r0e,[]);let{hoverProps:l,triggerHoverEnd:u}=D.useMemo(()=>{let c=(h,p)=>{if(a.pointerType=p,r||p==="touch"||a.isHovered||!h.currentTarget.contains(h.target))return;a.isHovered=!0;let g=h.currentTarget;a.target=g,e&&e({type:"hoverstart",target:g,pointerType:p}),n&&n(!0),i(!0)},d=(h,p)=>{if(a.pointerType="",a.target=null,p==="touch"||!a.isHovered)return;a.isHovered=!1;let g=h.currentTarget;s&&s({type:"hoverend",target:g,pointerType:p}),n&&n(!1),i(!1)},f={};return typeof PointerEvent<"u"?(f.onPointerEnter=h=>{om&&h.pointerType==="mouse"||c(h,h.pointerType)},f.onPointerLeave=h=>{!r&&h.currentTarget.contains(h.target)&&d(h,h.pointerType)}):(f.onTouchStart=()=>{a.ignoreEmulatedMouseEvents=!0},f.onMouseEnter=h=>{!a.ignoreEmulatedMouseEvents&&!om&&c(h,"mouse"),a.ignoreEmulatedMouseEvents=!1},f.onMouseLeave=h=>{!r&&h.currentTarget.contains(h.target)&&d(h,"mouse")}),{hoverProps:f,triggerHoverEnd:d}},[e,n,s,r,a]);return D.useEffect(()=>{r&&u({currentTarget:a.target},a.pointerType)},[r]),{hoverProps:l,isHovered:o}}var o0e=t=>j.jsx("svg",{"aria-hidden":"true",fill:"none",focusable:"false",height:"1em",role:"presentation",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,viewBox:"0 0 24 24",width:"1em",...t,children:j.jsx("path",{d:"M18 6L6 18M6 6l12 12"})}),Yr={ease:[.36,.66,.4,1],easeIn:[.4,0,1,1],easeOut:[0,0,.2,1],easeInOut:[.4,0,.2,1],spring:[.155,1.105,.295,1.12],springOut:[.57,-.15,.62,.07],softSpring:[.16,1.11,.3,1.02]},i0e={scaleSpring:{enter:{transform:"scale(1)",opacity:1,transition:{type:"spring",bounce:0,duration:.2}},exit:{transform:"scale(0.85)",opacity:0,transition:{type:"easeOut",duration:.15}}},scaleSpringOpacity:{initial:{opacity:0,transform:"scale(0.8)"},enter:{opacity:1,transform:"scale(1)",transition:{type:"spring",bounce:0,duration:.3}},exit:{opacity:0,transform:"scale(0.96)",transition:{type:"easeOut",bounce:0,duration:.15}}},scale:{enter:{scale:1},exit:{scale:.95}},scaleFadeIn:{enter:{transform:"scale(1)",opacity:1,transition:{duration:.25,ease:Yr.easeIn}},exit:{transform:"scale(0.95)",opacity:0,transition:{duration:.2,ease:Yr.easeOut}}},scaleInOut:{enter:{transform:"scale(1)",opacity:1,transition:{duration:.4,ease:Yr.ease}},exit:{transform:"scale(1.03)",opacity:0,transition:{duration:.3,ease:Yr.ease}}},fade:{enter:{opacity:1,transition:{duration:.4,ease:Yr.ease}},exit:{opacity:0,transition:{duration:.3,ease:Yr.ease}}},collapse:{enter:{opacity:1,height:"auto",transition:{height:{type:"spring",bounce:0,duration:.3},opacity:{easings:"ease",duration:.4}}},exit:{opacity:0,height:0,transition:{easings:"ease",duration:.3}}}},RM=globalThis!=null&&globalThis.document?D.useLayoutEffect:D.useEffect;function a0e(t){var e,n;const s=s0(),[r,o]=h0(t,uT.variantKeys),{ref:i,as:a,children:l,color:u="default",size:c="md",variant:d="solid",radius:f,isDisabled:h=!1,isIconOnly:p=!1,disableRipple:g=(e=s==null?void 0:s.disableRipple)!=null?e:!1,disableAnimation:y=(n=s==null?void 0:s.disableAnimation)!=null?n:!1,className:m,...x}=r,v=a||"div",b=du(i),$=D.useMemo(()=>uT({...o,className:m}),[n0(o),m]),C=D.useMemo(()=>({size:c,color:u,variant:d,radius:f,isIconOnly:p,isDisabled:h,disableAnimation:y,disableRipple:g,fullWidth:!!(t!=null&&t.fullWidth)}),[c,u,d,f,h,p,y,g,t==null?void 0:t.fullWidth]),k=D.useCallback(()=>({role:"group",...x}),[x]);return{Component:v,children:l,domRef:b,context:C,classNames:$,getButtonGroupProps:k}}var[l0e,u0e]=C$({name:"ButtonGroupContext",strict:!1}),AM=wo((t,e)=>{const{Component:n,domRef:s,context:r,children:o,classNames:i,getButtonGroupProps:a}=a0e({...t,ref:e});return j.jsx(l0e,{value:r,children:j.jsx(n,{ref:s,className:i,...a(),children:o})})});AM.displayName="NextUI.ButtonGroup";var yT=AM;function DM(t,e){let{elementType:n="button",isDisabled:s,onPress:r,onPressStart:o,onPressEnd:i,onPressChange:a,preventFocusOnPress:l,allowFocusWhenDisabled:u,onClick:c,href:d,target:f,rel:h,type:p="button",allowTextSelectionOnPress:g}=t,y;n==="button"?y={type:p,disabled:s}:y={role:"button",tabIndex:s?void 0:0,href:n==="a"&&s?void 0:d,target:n==="a"?f:void 0,type:n==="input"?p:void 0,disabled:n==="input"?s:void 0,"aria-disabled":!s||n==="input"?void 0:s,rel:n==="a"?h:void 0};let{pressProps:m,isPressed:x}=CM({onPressStart:o,onPressEnd:i,onPressChange:a,onPress:r,isDisabled:s,preventFocusOnPress:l,allowTextSelectionOnPress:g,ref:e}),{focusableProps:v}=qge(t,e);u&&(v.tabIndex=s?-1:v.tabIndex);let b=$t(v,m,S$(t,{labelable:!0}));return{isPressed:x,buttonProps:$t(y,b,{"aria-haspopup":t["aria-haspopup"],"aria-expanded":t["aria-expanded"],"aria-controls":t["aria-controls"],"aria-pressed":t["aria-pressed"],onClick:$=>{c==null||c($)}})}}var FM=t=>{const{ripples:e=[],motionProps:n,color:s="currentColor",style:r,onClear:o}=t;return j.jsx(j.Fragment,{children:e.map(i=>{const a=Uce(.01*i.size,.2,i.size>100?.75:.5);return j.jsx(wv,{features:$v,children:j.jsx(nM,{mode:"popLayout",children:j.jsx(bv.span,{animate:{transform:"scale(2)",opacity:0},className:"nextui-ripple",exit:{opacity:0},initial:{transform:"scale(0)",opacity:.35},style:{position:"absolute",backgroundColor:s,borderRadius:"100%",transformOrigin:"center",pointerEvents:"none",overflow:"hidden",inset:0,zIndex:0,top:i.y,left:i.x,width:`${i.size}px`,height:`${i.size}px`,...r},transition:{duration:a},onAnimationComplete:()=>{o(i.key)},...n})})},i.key)})})};FM.displayName="NextUI.Ripple";var c0e=FM;function d0e(t={}){const[e,n]=D.useState([]),s=D.useCallback(o=>{const i=o.currentTarget,a=Math.max(i.clientWidth,i.clientHeight),l=i.getBoundingClientRect();n(u=>[...u,{key:Wce(u.length.toString()),size:a,x:o.clientX-l.left-a/2,y:o.clientY-l.top-a/2}])},[]),r=D.useCallback(o=>{n(i=>i.filter(a=>a.key!==o))},[]);return{ripples:e,onClick:s,onClear:r,...t}}function f0e(t){var e,n,s,r,o,i,a,l,u;const c=u0e(),d=s0(),f=!!c,{ref:h,as:p,children:g,startContent:y,endContent:m,autoFocus:x,className:v,spinner:b,isLoading:$=!1,disableRipple:C=!1,fullWidth:k=(e=c==null?void 0:c.fullWidth)!=null?e:!1,radius:w=c==null?void 0:c.radius,size:I=(n=c==null?void 0:c.size)!=null?n:"md",color:R=(s=c==null?void 0:c.color)!=null?s:"default",variant:E=(r=c==null?void 0:c.variant)!=null?r:"solid",disableAnimation:A=(i=(o=c==null?void 0:c.disableAnimation)!=null?o:d==null?void 0:d.disableAnimation)!=null?i:!1,isDisabled:S=(a=c==null?void 0:c.isDisabled)!=null?a:!1,isIconOnly:T=(l=c==null?void 0:c.isIconOnly)!=null?l:!1,spinnerPlacement:F="start",onPress:M,onClick:U,...P}=t,L=p||"button",G=typeof L=="string",X=du(h),Q=(u=C||(d==null?void 0:d.disableRipple))!=null?u:A,{isFocusVisible:Z,isFocused:te,focusProps:ee}=sC({autoFocus:x}),se=S||$,le=D.useMemo(()=>Pge({size:I,color:R,variant:E,radius:w,fullWidth:k,isDisabled:se,isInGroup:f,disableAnimation:A,isIconOnly:T,className:v}),[I,R,E,w,k,se,f,T,A,v]),{onClick:pe,onClear:ae,ripples:be}=d0e(),ke=D.useCallback(Dt=>{Q||se||A||X.current&&pe(Dt)},[Q,se,A,X,pe]),{buttonProps:Pe,isPressed:Be}=DM({elementType:p,isDisabled:se,onPress:M,onClick:Vr(U,ke),...P},X),{isHovered:et,hoverProps:We}=NM({isDisabled:se}),ze=D.useCallback((Dt={})=>({"data-disabled":un(se),"data-focus":un(te),"data-pressed":un(Be),"data-focus-visible":un(Z),"data-hover":un(et),"data-loading":un($),...$t(Pe,ee,We,pI(P,{enabled:G}),pI(Dt))}),[$,se,te,Be,G,Z,et,Pe,ee,We,P]),Ye=Dt=>D.isValidElement(Dt)?D.cloneElement(Dt,{"aria-hidden":!0,focusable:!1,tabIndex:-1}):null,Qe=Ye(y),Ce=Ye(m),Mt=D.useMemo(()=>({sm:"sm",md:"sm",lg:"md"})[I],[I]),mr=D.useCallback(()=>({ripples:be,onClear:ae}),[be,ae]);return{Component:L,children:g,domRef:X,spinner:b,styles:le,startContent:Qe,endContent:Ce,isLoading:$,spinnerPlacement:F,spinnerSize:Mt,disableRipple:Q,getButtonProps:ze,getRippleProps:mr,isIconOnly:T}}function h0e(t){const[e,n]=h0(t,aT.variantKeys),{children:s,className:r,classNames:o,label:i,...a}=e,l=D.useMemo(()=>aT({...n}),[n0(n)]),u=On(o==null?void 0:o.base,r),c=i||s,d=D.useMemo(()=>c&&typeof c=="string"?c:a["aria-label"]?"":"Loading",[s,c,a["aria-label"]]),f=D.useCallback(()=>({"aria-label":d,className:l.base({class:u}),...a}),[d,l,u,a]);return{label:c,slots:l,classNames:o,getSpinnerProps:f}}var PM=wo((t,e)=>{const{slots:n,classNames:s,label:r,getSpinnerProps:o}=h0e({...t});return j.jsxs("div",{ref:e,...o(),children:[j.jsxs("div",{className:n.wrapper({class:s==null?void 0:s.wrapper}),children:[j.jsx("i",{className:n.circle1({class:s==null?void 0:s.circle1})}),j.jsx("i",{className:n.circle2({class:s==null?void 0:s.circle2})})]}),r&&j.jsx("span",{className:n.label({class:s==null?void 0:s.label}),children:r})]})});PM.displayName="NextUI.Spinner";var p0e=PM,OM=wo((t,e)=>{const{Component:n,domRef:s,children:r,styles:o,spinnerSize:i,spinner:a=j.jsx(p0e,{color:"current",size:i}),spinnerPlacement:l,startContent:u,endContent:c,isLoading:d,disableRipple:f,getButtonProps:h,getRippleProps:p,isIconOnly:g}=f0e({...t,ref:e});return j.jsxs(n,{ref:s,className:o,...h(),children:[u,d&&l==="start"&&a,d&&g?null:r,d&&l==="end"&&a,c,!f&&j.jsx(c0e,{...p()})]})});OM.displayName="NextUI.Button";var Dn=OM;let cl="default",Pv="",zh=new WeakMap;function vT(t){if(vf()){if(cl==="default"){const e=$e(t);Pv=e.documentElement.style.webkitUserSelect,e.documentElement.style.webkitUserSelect="none"}cl="disabled"}else(t instanceof HTMLElement||t instanceof SVGElement)&&(zh.set(t,t.style.userSelect),t.style.userSelect="none")}function yh(t){if(vf()){if(cl!=="disabled")return;cl="restoring",setTimeout(()=>{fu(()=>{if(cl==="restoring"){const e=$e(t);e.documentElement.style.webkitUserSelect==="none"&&(e.documentElement.style.webkitUserSelect=Pv||""),Pv="",cl="default"}})},300)}else if((t instanceof HTMLElement||t instanceof SVGElement)&&t&&zh.has(t)){let e=zh.get(t);t.style.userSelect==="none"&&(t.style.userSelect=e),t.getAttribute("style")===""&&t.removeAttribute("style"),zh.delete(t)}}const LM=Xe.createContext({register:()=>{}});LM.displayName="PressResponderContext";function m0e(t){let e=D.useContext(LM);if(e){let{register:n,...s}=e;t=$t(s,t),n()}return i0(e,t.ref),t}var vh=new WeakMap;class bh{continuePropagation(){Up(this,vh,!1)}get shouldStopPropagation(){return ML(this,vh)}constructor(e,n,s){HO(this,vh,{writable:!0,value:void 0}),Up(this,vh,!0),this.type=e,this.pointerType=n,this.target=s.currentTarget,this.shiftKey=s.shiftKey,this.metaKey=s.metaKey,this.ctrlKey=s.ctrlKey,this.altKey=s.altKey}}const bT=Symbol("linkClicked");function wT(t){let{onPress:e,onPressChange:n,onPressStart:s,onPressEnd:r,onPressUp:o,isDisabled:i,isPressed:a,preventFocusOnPress:l,shouldCancelOnPointerExit:u,allowTextSelectionOnPress:c,ref:d,...f}=m0e(t),[h,p]=D.useState(!1),g=D.useRef({isPressed:!1,ignoreEmulatedMouseEvents:!1,ignoreClickAfterPress:!1,didFirePressStart:!1,isTriggeringEvent:!1,activePointerId:null,target:null,isOverTarget:!1,pointerType:null}),{addGlobalListener:y,removeAllGlobalListeners:m}=YO(),x=qt((w,I)=>{let R=g.current;if(i||R.didFirePressStart)return!1;let E=!0;if(R.isTriggeringEvent=!0,s){let A=new bh("pressstart",I,w);s(A),E=A.shouldStopPropagation}return n&&n(!0),R.isTriggeringEvent=!1,R.didFirePressStart=!0,p(!0),E}),v=qt((w,I,R=!0)=>{let E=g.current;if(!E.didFirePressStart)return!1;E.ignoreClickAfterPress=!0,E.didFirePressStart=!1,E.isTriggeringEvent=!0;let A=!0;if(r){let S=new bh("pressend",I,w);r(S),A=S.shouldStopPropagation}if(n&&n(!1),p(!1),e&&R&&!i){let S=new bh("press",I,w);e(S),A&&(A=S.shouldStopPropagation)}return E.isTriggeringEvent=!1,A}),b=qt((w,I)=>{let R=g.current;if(i)return!1;if(o){R.isTriggeringEvent=!0;let E=new bh("pressup",I,w);return o(E),R.isTriggeringEvent=!1,E.shouldStopPropagation}return!0}),$=qt(w=>{let I=g.current;I.isPressed&&I.target&&(I.isOverTarget&&I.pointerType!=null&&v(jr(I.target,w),I.pointerType,!1),I.isPressed=!1,I.isOverTarget=!1,I.activePointerId=null,I.pointerType=null,m(),c||yh(I.target))}),C=qt(w=>{u&&$(w)}),k=D.useMemo(()=>{let w=g.current,I={onKeyDown(E){if(Cx(E.nativeEvent,E.currentTarget)&&E.currentTarget.contains(E.target)){var A;CT(E.target,E.key)&&E.preventDefault();let S=!0;if(!w.isPressed&&!E.repeat){w.target=E.currentTarget,w.isPressed=!0,S=x(E,"keyboard");let T=E.currentTarget,F=M=>{Cx(M,T)&&!M.repeat&&T.contains(M.target)&&w.target&&b(jr(w.target,M),"keyboard")};y($e(E.currentTarget),"keyup",Vr(F,R),!0)}S&&E.stopPropagation(),E.metaKey&&Br()&&((A=w.metaKeyEvents)===null||A===void 0||A.set(E.key,E.nativeEvent))}else E.key==="Meta"&&(w.metaKeyEvents=new Map)},onClick(E){if(!(E&&!E.currentTarget.contains(E.target))&&E&&E.button===0&&!w.isTriggeringEvent&&!ha.isOpening){let A=!0;if(i&&E.preventDefault(),!w.ignoreClickAfterPress&&!w.ignoreEmulatedMouseEvents&&!w.isPressed&&(w.pointerType==="virtual"||po(E.nativeEvent))){!i&&!l&&cn(E.currentTarget);let S=x(E,"virtual"),T=b(E,"virtual"),F=v(E,"virtual");A=S&&T&&F}w.ignoreEmulatedMouseEvents=!1,w.ignoreClickAfterPress=!1,A&&E.stopPropagation()}}},R=E=>{var A;if(w.isPressed&&w.target&&Cx(E,w.target)){var S;CT(E.target,E.key)&&E.preventDefault();let F=E.target;v(jr(w.target,E),"keyboard",w.target.contains(F)),m(),E.key!=="Enter"&&iC(w.target)&&w.target.contains(F)&&!E[bT]&&(E[bT]=!0,ha(w.target,E,!1)),w.isPressed=!1,(S=w.metaKeyEvents)===null||S===void 0||S.delete(E.key)}else if(E.key==="Meta"&&(!((A=w.metaKeyEvents)===null||A===void 0)&&A.size)){var T;let F=w.metaKeyEvents;w.metaKeyEvents=void 0;for(let M of F.values())(T=w.target)===null||T===void 0||T.dispatchEvent(new KeyboardEvent("keyup",M))}};if(typeof PointerEvent<"u"){I.onPointerDown=T=>{if(T.button!==0||!T.currentTarget.contains(T.target))return;if(ZO(T.nativeEvent)){w.pointerType="virtual";return}kx(T.currentTarget)&&T.preventDefault(),w.pointerType=T.pointerType;let F=!0;w.isPressed||(w.isPressed=!0,w.isOverTarget=!0,w.activePointerId=T.pointerId,w.target=T.currentTarget,!i&&!l&&cn(T.currentTarget),c||vT(w.target),F=x(T,w.pointerType),y($e(T.currentTarget),"pointermove",E,!1),y($e(T.currentTarget),"pointerup",A,!1),y($e(T.currentTarget),"pointercancel",S,!1)),F&&T.stopPropagation()},I.onMouseDown=T=>{T.currentTarget.contains(T.target)&&T.button===0&&(kx(T.currentTarget)&&T.preventDefault(),T.stopPropagation())},I.onPointerUp=T=>{!T.currentTarget.contains(T.target)||w.pointerType==="virtual"||T.button===0&&Ua(T,T.currentTarget)&&b(T,w.pointerType||T.pointerType)};let E=T=>{T.pointerId===w.activePointerId&&(w.target&&Ua(T,w.target)?!w.isOverTarget&&w.pointerType!=null&&(w.isOverTarget=!0,x(jr(w.target,T),w.pointerType)):w.target&&w.isOverTarget&&w.pointerType!=null&&(w.isOverTarget=!1,v(jr(w.target,T),w.pointerType,!1),C(T)))},A=T=>{T.pointerId===w.activePointerId&&w.isPressed&&T.button===0&&w.target&&(Ua(T,w.target)&&w.pointerType!=null?v(jr(w.target,T),w.pointerType):w.isOverTarget&&w.pointerType!=null&&v(jr(w.target,T),w.pointerType,!1),w.isPressed=!1,w.isOverTarget=!1,w.activePointerId=null,w.pointerType=null,m(),c||yh(w.target))},S=T=>{$(T)};I.onDragStart=T=>{T.currentTarget.contains(T.target)&&$(T)}}else{I.onMouseDown=S=>{if(S.button!==0||!S.currentTarget.contains(S.target))return;if(kx(S.currentTarget)&&S.preventDefault(),w.ignoreEmulatedMouseEvents){S.stopPropagation();return}w.isPressed=!0,w.isOverTarget=!0,w.target=S.currentTarget,w.pointerType=po(S.nativeEvent)?"virtual":"mouse",!i&&!l&&cn(S.currentTarget),x(S,w.pointerType)&&S.stopPropagation(),y($e(S.currentTarget),"mouseup",E,!1)},I.onMouseEnter=S=>{if(!S.currentTarget.contains(S.target))return;let T=!0;w.isPressed&&!w.ignoreEmulatedMouseEvents&&w.pointerType!=null&&(w.isOverTarget=!0,T=x(S,w.pointerType)),T&&S.stopPropagation()},I.onMouseLeave=S=>{if(!S.currentTarget.contains(S.target))return;let T=!0;w.isPressed&&!w.ignoreEmulatedMouseEvents&&w.pointerType!=null&&(w.isOverTarget=!1,T=v(S,w.pointerType,!1),C(S)),T&&S.stopPropagation()},I.onMouseUp=S=>{S.currentTarget.contains(S.target)&&!w.ignoreEmulatedMouseEvents&&S.button===0&&b(S,w.pointerType||"mouse")};let E=S=>{if(S.button===0){if(w.isPressed=!1,m(),w.ignoreEmulatedMouseEvents){w.ignoreEmulatedMouseEvents=!1;return}w.target&&Ua(S,w.target)&&w.pointerType!=null?v(jr(w.target,S),w.pointerType):w.target&&w.isOverTarget&&w.pointerType!=null&&v(jr(w.target,S),w.pointerType,!1),w.isOverTarget=!1}};I.onTouchStart=S=>{if(!S.currentTarget.contains(S.target))return;let T=g0e(S.nativeEvent);if(!T)return;w.activePointerId=T.identifier,w.ignoreEmulatedMouseEvents=!0,w.isOverTarget=!0,w.isPressed=!0,w.target=S.currentTarget,w.pointerType="touch",!i&&!l&&cn(S.currentTarget),c||vT(w.target),x(S,w.pointerType)&&S.stopPropagation(),y(lt(S.currentTarget),"scroll",A,!0)},I.onTouchMove=S=>{if(!S.currentTarget.contains(S.target))return;if(!w.isPressed){S.stopPropagation();return}let T=$T(S.nativeEvent,w.activePointerId),F=!0;T&&Ua(T,S.currentTarget)?!w.isOverTarget&&w.pointerType!=null&&(w.isOverTarget=!0,F=x(S,w.pointerType)):w.isOverTarget&&w.pointerType!=null&&(w.isOverTarget=!1,F=v(S,w.pointerType,!1),C(S)),F&&S.stopPropagation()},I.onTouchEnd=S=>{if(!S.currentTarget.contains(S.target))return;if(!w.isPressed){S.stopPropagation();return}let T=$T(S.nativeEvent,w.activePointerId),F=!0;T&&Ua(T,S.currentTarget)&&w.pointerType!=null?(b(S,w.pointerType),F=v(S,w.pointerType)):w.isOverTarget&&w.pointerType!=null&&(F=v(S,w.pointerType,!1)),F&&S.stopPropagation(),w.isPressed=!1,w.activePointerId=null,w.isOverTarget=!1,w.ignoreEmulatedMouseEvents=!0,w.target&&!c&&yh(w.target),m()},I.onTouchCancel=S=>{S.currentTarget.contains(S.target)&&(S.stopPropagation(),w.isPressed&&$(S))};let A=S=>{w.isPressed&&S.target.contains(w.target)&&$({currentTarget:w.target,shiftKey:!1,ctrlKey:!1,metaKey:!1,altKey:!1})};I.onDragStart=S=>{S.currentTarget.contains(S.target)&&$(S)}}return I},[y,i,l,m,c,$,C,v,x,b]);return D.useEffect(()=>()=>{var w;c||yh((w=g.current.target)!==null&&w!==void 0?w:void 0)},[c]),{isPressed:a||h,pressProps:$t(f,k)}}function iC(t){return t.tagName==="A"&&t.hasAttribute("href")}function Cx(t,e){const{key:n,code:s}=t,r=e,o=r.getAttribute("role");return(n==="Enter"||n===" "||n==="Spacebar"||s==="Space")&&!(r instanceof lt(r).HTMLInputElement&&!MM(r,n)||r instanceof lt(r).HTMLTextAreaElement||r.isContentEditable)&&!((o==="link"||!o&&iC(r))&&n!=="Enter")}function g0e(t){const{targetTouches:e}=t;return e.length>0?e[0]:null}function $T(t,e){const n=t.changedTouches;for(let s=0;s<n.length;s++){const r=n[s];if(r.identifier===e)return r}return null}function jr(t,e){return{currentTarget:t,shiftKey:e.shiftKey,ctrlKey:e.ctrlKey,metaKey:e.metaKey,altKey:e.altKey}}function x0e(t){let e=0,n=0;return t.width!==void 0?e=t.width/2:t.radiusX!==void 0&&(e=t.radiusX),t.height!==void 0?n=t.height/2:t.radiusY!==void 0&&(n=t.radiusY),{top:t.clientY-n,right:t.clientX+e,bottom:t.clientY+n,left:t.clientX-e}}function y0e(t,e){return!(t.left>e.right||e.left>t.right||t.top>e.bottom||e.top>t.bottom)}function Ua(t,e){let n=e.getBoundingClientRect(),s=x0e(t);return y0e(n,s)}function kx(t){return!(t instanceof HTMLElement)||!t.hasAttribute("draggable")}function CT(t,e){return t instanceof HTMLInputElement?!MM(t,e):t instanceof HTMLButtonElement?t.type!=="submit"&&t.type!=="reset":!iC(t)}const v0e=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function MM(t,e){return t.type==="checkbox"||t.type==="radio"?e===" ":v0e.has(t.type)}let b0e=class{isDefaultPrevented(){return this.nativeEvent.defaultPrevented}preventDefault(){this.defaultPrevented=!0,this.nativeEvent.preventDefault()}stopPropagation(){this.nativeEvent.stopPropagation(),this.isPropagationStopped=()=>!0}isPropagationStopped(){return!1}persist(){}constructor(e,n){this.nativeEvent=n,this.target=n.target,this.currentTarget=n.currentTarget,this.relatedTarget=n.relatedTarget,this.bubbles=n.bubbles,this.cancelable=n.cancelable,this.defaultPrevented=n.defaultPrevented,this.eventPhase=n.eventPhase,this.isTrusted=n.isTrusted,this.timeStamp=n.timeStamp,this.type=e}};function w0e(t){let e=D.useRef({isFocused:!1,observer:null});It(()=>{const s=e.current;return()=>{s.observer&&(s.observer.disconnect(),s.observer=null)}},[]);let n=qt(s=>{t==null||t(s)});return D.useCallback(s=>{if(s.target instanceof HTMLButtonElement||s.target instanceof HTMLInputElement||s.target instanceof HTMLTextAreaElement||s.target instanceof HTMLSelectElement){e.current.isFocused=!0;let r=s.target,o=i=>{e.current.isFocused=!1,r.disabled&&n(new b0e("blur",i)),e.current.observer&&(e.current.observer.disconnect(),e.current.observer=null)};r.addEventListener("focusout",o,{once:!0}),e.current.observer=new MutationObserver(()=>{if(e.current.isFocused&&r.disabled){var i;(i=e.current.observer)===null||i===void 0||i.disconnect();let a=r===document.activeElement?null:document.activeElement;r.dispatchEvent(new FocusEvent("blur",{relatedTarget:a})),r.dispatchEvent(new FocusEvent("focusout",{bubbles:!0,relatedTarget:a}))}}),e.current.observer.observe(r,{attributes:!0,attributeFilter:["disabled"]})}},[n])}function $0e(t){let{isDisabled:e,onFocus:n,onBlur:s,onFocusChange:r}=t;const o=D.useCallback(l=>{if(l.target===l.currentTarget)return s&&s(l),r&&r(!1),!0},[s,r]),i=w0e(o),a=D.useCallback(l=>{const u=$e(l.target);l.target===l.currentTarget&&u.activeElement===l.target&&(n&&n(l),r&&r(!0),i(l))},[r,n,i]);return{focusProps:{onFocus:!e&&(n||r||s)?a:void 0,onBlur:!e&&(s||r)?o:void 0}}}let If=null,C0e=new Set,hc=new Map,xa=!1,Ov=!1;function aC(t,e){for(let n of C0e)n(t,e)}function k0e(t){return!(t.metaKey||!Br()&&t.altKey||t.ctrlKey||t.key==="Control"||t.key==="Shift"||t.key==="Meta")}function im(t){xa=!0,k0e(t)&&(If="keyboard",aC("keyboard",t))}function Rs(t){If="pointer",(t.type==="mousedown"||t.type==="pointerdown")&&(xa=!0,aC("pointer",t))}function _M(t){po(t)&&(xa=!0,If="virtual")}function zM(t){t.target===window||t.target===document||(!xa&&!Ov&&(If="virtual",aC("virtual",t)),xa=!1,Ov=!1)}function VM(){xa=!1,Ov=!0}function kT(t){if(typeof window>"u"||hc.get(lt(t)))return;const e=lt(t),n=$e(t);let s=e.HTMLElement.prototype.focus;e.HTMLElement.prototype.focus=function(){xa=!0,s.apply(this,arguments)},n.addEventListener("keydown",im,!0),n.addEventListener("keyup",im,!0),n.addEventListener("click",_M,!0),e.addEventListener("focus",zM,!0),e.addEventListener("blur",VM,!1),typeof PointerEvent<"u"?(n.addEventListener("pointerdown",Rs,!0),n.addEventListener("pointermove",Rs,!0),n.addEventListener("pointerup",Rs,!0)):(n.addEventListener("mousedown",Rs,!0),n.addEventListener("mousemove",Rs,!0),n.addEventListener("mouseup",Rs,!0)),e.addEventListener("beforeunload",()=>{BM(t)},{once:!0}),hc.set(e,{focus:s})}const BM=(t,e)=>{const n=lt(t),s=$e(t);e&&s.removeEventListener("DOMContentLoaded",e),hc.has(n)&&(n.HTMLElement.prototype.focus=hc.get(n).focus,s.removeEventListener("keydown",im,!0),s.removeEventListener("keyup",im,!0),s.removeEventListener("click",_M,!0),n.removeEventListener("focus",zM,!0),n.removeEventListener("blur",VM,!1),typeof PointerEvent<"u"?(s.removeEventListener("pointerdown",Rs,!0),s.removeEventListener("pointermove",Rs,!0),s.removeEventListener("pointerup",Rs,!0)):(s.removeEventListener("mousedown",Rs,!0),s.removeEventListener("mousemove",Rs,!0),s.removeEventListener("mouseup",Rs,!0)),hc.delete(n))};function S0e(t){const e=$e(t);let n;return e.readyState!=="loading"?kT(t):(n=()=>{kT(t)},e.addEventListener("DOMContentLoaded",n)),()=>BM(t,n)}typeof document<"u"&&S0e();function I0e(){return If}function ST(t){if(!t)return;let e=!0;return n=>{let s={...n,preventDefault(){n.preventDefault()},isDefaultPrevented(){return n.isDefaultPrevented()},stopPropagation(){console.error("stopPropagation is now the default behavior for events in React Spectrum. You can use continuePropagation() to revert this behavior.")},continuePropagation(){e=!1}};t(s),e&&n.stopPropagation()}}function T0e(t){return{keyboardProps:t.isDisabled?{}:{onKeyDown:ST(t.onKeyDown),onKeyUp:ST(t.onKeyUp)}}}function E0e(t){const e=$e(t);if(I0e()==="virtual"){let n=e.activeElement;fu(()=>{e.activeElement===n&&t.isConnected&&cn(t)})}else cn(t)}let N0e=Xe.createContext(null);function R0e(t){let e=D.useContext(N0e)||{};i0(e,t);let{ref:n,...s}=e;return s}function A0e(t,e){let{focusProps:n}=$0e(t),{keyboardProps:s}=T0e(t),r=$t(n,s),o=R0e(e),i=t.isDisabled?{}:o,a=D.useRef(t.autoFocus);return D.useEffect(()=>{a.current&&e.current&&E0e(e.current),a.current=!1},[e]),{focusableProps:$t({...r,tabIndex:t.excludeFromTabOrder&&!t.isDisabled?-1:void 0},i)}}function D0e(t,e,n){let{isDisabled:s=!1,isReadOnly:r=!1,value:o,name:i,children:a,"aria-label":l,"aria-labelledby":u,validationState:c="valid",isInvalid:d}=t,f=C=>{C.stopPropagation(),e.setSelected(C.target.checked)},h=a!=null,p=l!=null||u!=null;!h&&!p&&console.warn("If you do not provide children, you must specify an aria-label for accessibility");let{pressProps:g,isPressed:y}=wT({isDisabled:s}),{pressProps:m,isPressed:x}=wT({isDisabled:s||r,onPress(){e.toggle()}}),{focusableProps:v}=A0e(t,n),b=$t(g,v),$=S$(t,{labelable:!0});return Nde(n,e.isSelected,e.setSelected),{labelProps:$t(m,{onClick:C=>C.preventDefault()}),inputProps:$t($,{"aria-invalid":d||c==="invalid"||void 0,"aria-errormessage":t["aria-errormessage"],"aria-controls":t["aria-controls"],"aria-readonly":r||void 0,onChange:f,disabled:s,...o==null?{}:{value:o},name:i,type:"checkbox",...b}),isSelected:e.isSelected,isPressed:y||x,isDisabled:s,isReadOnly:r,isInvalid:d||c==="invalid"}}function F0e(t={}){let{isReadOnly:e}=t,[n,s]=JO(t.isSelected,t.defaultSelected||!1,t.onChange);function r(i){e||s(i)}function o(){e||s(!n)}return{isSelected:n,setSelected:r,toggle:o}}function IT(t,e=[]){const n=D.useRef(t);return RM(()=>{n.current=t}),D.useCallback((...s)=>{var r;return(r=n.current)==null?void 0:r.call(n,...s)},e)}class P0e{isDefaultPrevented(){return this.nativeEvent.defaultPrevented}preventDefault(){this.defaultPrevented=!0,this.nativeEvent.preventDefault()}stopPropagation(){this.nativeEvent.stopPropagation(),this.isPropagationStopped=()=>!0}isPropagationStopped(){return!1}persist(){}constructor(e,n){this.nativeEvent=n,this.target=n.target,this.currentTarget=n.currentTarget,this.relatedTarget=n.relatedTarget,this.bubbles=n.bubbles,this.cancelable=n.cancelable,this.defaultPrevented=n.defaultPrevented,this.eventPhase=n.eventPhase,this.isTrusted=n.isTrusted,this.timeStamp=n.timeStamp,this.type=e}}function O0e(t){let e=D.useRef({isFocused:!1,observer:null});It(()=>{const s=e.current;return()=>{s.observer&&(s.observer.disconnect(),s.observer=null)}},[]);let n=qt(s=>{t==null||t(s)});return D.useCallback(s=>{if(s.target instanceof HTMLButtonElement||s.target instanceof HTMLInputElement||s.target instanceof HTMLTextAreaElement||s.target instanceof HTMLSelectElement){e.current.isFocused=!0;let r=s.target,o=i=>{e.current.isFocused=!1,r.disabled&&n(new P0e("blur",i)),e.current.observer&&(e.current.observer.disconnect(),e.current.observer=null)};r.addEventListener("focusout",o,{once:!0}),e.current.observer=new MutationObserver(()=>{if(e.current.isFocused&&r.disabled){var i;(i=e.current.observer)===null||i===void 0||i.disconnect();let a=r===document.activeElement?null:document.activeElement;r.dispatchEvent(new FocusEvent("blur",{relatedTarget:a})),r.dispatchEvent(new FocusEvent("focusout",{bubbles:!0,relatedTarget:a}))}}),e.current.observer.observe(r,{attributes:!0,attributeFilter:["disabled"]})}},[n])}function L0e(t){let{isDisabled:e,onBlurWithin:n,onFocusWithin:s,onFocusWithinChange:r}=t,o=D.useRef({isFocusWithin:!1}),i=D.useCallback(u=>{o.current.isFocusWithin&&!u.currentTarget.contains(u.relatedTarget)&&(o.current.isFocusWithin=!1,n&&n(u),r&&r(!1))},[n,r,o]),a=O0e(i),l=D.useCallback(u=>{!o.current.isFocusWithin&&document.activeElement===u.target&&(s&&s(u),r&&r(!0),o.current.isFocusWithin=!0,a(u))},[s,r,a]);return e?{focusWithinProps:{onFocus:void 0,onBlur:void 0}}:{focusWithinProps:{onFocus:l,onBlur:i}}}const TT={border:0,clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"};function M0e(t={}){let{style:e,isFocusable:n}=t,[s,r]=D.useState(!1),{focusWithinProps:o}=L0e({isDisabled:!n,onFocusWithinChange:a=>r(a)}),i=D.useMemo(()=>s?e:e?{...TT,...e}:TT,[s]);return{visuallyHiddenProps:{...o,style:i}}}function _0e(t){let{children:e,elementType:n="div",isFocusable:s,style:r,...o}=t,{visuallyHiddenProps:i}=M0e(t);return Xe.createElement(n,$t(o,i),e)}function z0e(t,e,n){let{labelProps:s,inputProps:r,isSelected:o,isPressed:i,isDisabled:a,isReadOnly:l}=D0e(t,e,n);return{labelProps:s,inputProps:{...r,role:"switch",checked:o},isSelected:o,isPressed:i,isDisabled:a,isReadOnly:l}}function V0e(t={}){var e,n;const s=s0(),[r,o]=h0(t,iT.variantKeys),{ref:i,as:a,name:l,value:u="",isReadOnly:c=!1,autoFocus:d=!1,startContent:f,endContent:h,defaultSelected:p,isSelected:g,children:y,thumbIcon:m,className:x,classNames:v,onChange:b,onValueChange:$,...C}=r,k=a||"label",w=D.useRef(null),I=D.useRef(null),R=(n=(e=t.disableAnimation)!=null?e:s==null?void 0:s.disableAnimation)!=null?n:!1,E=D.useId(),A=D.useMemo(()=>{const Ce=C["aria-label"]||typeof y=="string"?y:void 0;return{name:l,value:u,children:y,autoFocus:d,defaultSelected:p,isSelected:g,isDisabled:!!t.isDisabled,isReadOnly:c,"aria-label":Ce,"aria-labelledby":C["aria-labelledby"]||E,onChange:$}},[u,l,E,y,d,c,g,p,t.isDisabled,C["aria-label"],C["aria-labelledby"],$]),S=F0e(A);RM(()=>{if(!I.current)return;const Ce=!!I.current.checked;S.setSelected(Ce)},[I.current]);const{inputProps:T,isPressed:F,isReadOnly:M}=z0e(A,S,I),{focusProps:U,isFocused:P,isFocusVisible:L}=sC({autoFocus:T.autoFocus}),{hoverProps:G,isHovered:X}=NM({isDisabled:T.disabled}),Q=A.isDisabled||M,[Z,te]=D.useState(!1),{pressProps:ee}=CM({isDisabled:Q,onPressStart(Ce){Ce.pointerType!=="keyboard"&&te(!0)},onPressEnd(Ce){Ce.pointerType!=="keyboard"&&te(!1)}}),se=Q?!1:Z||F,le=T.checked,pe=T.disabled,ae=D.useMemo(()=>iT({...o,disableAnimation:R}),[n0(o),R]),be=On(v==null?void 0:v.base,x),ke=Ce=>({...$t(G,ee,C,Ce),ref:w,className:ae.base({class:On(be,Ce==null?void 0:Ce.className)}),"data-disabled":un(pe),"data-selected":un(le),"data-readonly":un(M),"data-focus":un(P),"data-focus-visible":un(L),"data-hover":un(X),"data-pressed":un(se)}),Pe=D.useCallback((Ce={})=>({...Ce,"aria-hidden":!0,className:On(ae.wrapper({class:On(v==null?void 0:v.wrapper,Ce==null?void 0:Ce.className)}))}),[ae,v==null?void 0:v.wrapper]),Be=(Ce={})=>({...$t(T,U,Ce),ref:jce(I,i),id:T.id,onChange:Vr(b,T.onChange)}),et=D.useCallback((Ce={})=>({...Ce,className:ae.thumb({class:On(v==null?void 0:v.thumb,Ce==null?void 0:Ce.className)})}),[ae,v==null?void 0:v.thumb]),We=D.useCallback((Ce={})=>({...Ce,id:E,className:ae.label({class:On(v==null?void 0:v.label,Ce==null?void 0:Ce.className)})}),[ae,v==null?void 0:v.label,pe,le]),ze=D.useCallback((Ce={includeStateProps:!1})=>$t({width:"1em",height:"1em",className:ae.thumbIcon({class:On(v==null?void 0:v.thumbIcon)})},Ce.includeStateProps?{isSelected:le}:{}),[ae,v==null?void 0:v.thumbIcon,le]),Ye=D.useCallback((Ce={})=>({width:"1em",height:"1em",...Ce,className:ae.startContent({class:On(v==null?void 0:v.startContent,Ce==null?void 0:Ce.className)})}),[ae,v==null?void 0:v.startContent,le]),Qe=D.useCallback((Ce={})=>({width:"1em",height:"1em",...Ce,className:ae.endContent({class:On(v==null?void 0:v.endContent,Ce==null?void 0:Ce.className)})}),[ae,v==null?void 0:v.endContent,le]);return{Component:k,slots:ae,classNames:v,domRef:w,children:y,thumbIcon:m,startContent:f,endContent:h,isHovered:X,isSelected:le,isPressed:se,isFocused:P,isFocusVisible:L,isDisabled:pe,getBaseProps:ke,getWrapperProps:Pe,getInputProps:Be,getLabelProps:We,getThumbProps:et,getThumbIconProps:ze,getStartContentProps:Ye,getEndContentProps:Qe}}var WM=wo((t,e)=>{const{Component:n,children:s,startContent:r,endContent:o,thumbIcon:i,getBaseProps:a,getInputProps:l,getWrapperProps:u,getThumbProps:c,getThumbIconProps:d,getLabelProps:f,getStartContentProps:h,getEndContentProps:p}=V0e({...t,ref:e}),g=typeof i=="function"?i(d({includeStateProps:!0})):i&&D.cloneElement(i,d()),y=r&&D.cloneElement(r,h()),m=o&&D.cloneElement(o,p());return j.jsxs(n,{...a(),children:[j.jsx(_0e,{elementType:"span",children:j.jsx("input",{...l()})}),j.jsxs("span",{...u(),children:[r&&y,j.jsx("span",{...c(),children:i&&g}),o&&m]}),s&&j.jsx("span",{...f(),children:s})]})});WM.displayName="NextUI.Switch";var ET=WM;let Tf=null,B0e=new Set,pc=new Map,ya=!1,Lv=!1;function lC(t,e){for(let n of B0e)n(t,e)}function W0e(t){return!(t.metaKey||!Br()&&t.altKey||t.ctrlKey||t.key==="Control"||t.key==="Shift"||t.key==="Meta")}function am(t){ya=!0,W0e(t)&&(Tf="keyboard",lC("keyboard",t))}function As(t){Tf="pointer",(t.type==="mousedown"||t.type==="pointerdown")&&(ya=!0,lC("pointer",t))}function UM(t){po(t)&&(ya=!0,Tf="virtual")}function GM(t){t.target===window||t.target===document||(!ya&&!Lv&&(Tf="virtual",lC("virtual",t)),ya=!1,Lv=!1)}function HM(){ya=!1,Lv=!0}function NT(t){if(typeof window>"u"||pc.get(lt(t)))return;const e=lt(t),n=$e(t);let s=e.HTMLElement.prototype.focus;e.HTMLElement.prototype.focus=function(){ya=!0,s.apply(this,arguments)},n.addEventListener("keydown",am,!0),n.addEventListener("keyup",am,!0),n.addEventListener("click",UM,!0),e.addEventListener("focus",GM,!0),e.addEventListener("blur",HM,!1),typeof PointerEvent<"u"?(n.addEventListener("pointerdown",As,!0),n.addEventListener("pointermove",As,!0),n.addEventListener("pointerup",As,!0)):(n.addEventListener("mousedown",As,!0),n.addEventListener("mousemove",As,!0),n.addEventListener("mouseup",As,!0)),e.addEventListener("beforeunload",()=>{jM(t)},{once:!0}),pc.set(e,{focus:s})}const jM=(t,e)=>{const n=lt(t),s=$e(t);e&&s.removeEventListener("DOMContentLoaded",e),pc.has(n)&&(n.HTMLElement.prototype.focus=pc.get(n).focus,s.removeEventListener("keydown",am,!0),s.removeEventListener("keyup",am,!0),s.removeEventListener("click",UM,!0),n.removeEventListener("focus",GM,!0),n.removeEventListener("blur",HM,!1),typeof PointerEvent<"u"?(s.removeEventListener("pointerdown",As,!0),s.removeEventListener("pointermove",As,!0),s.removeEventListener("pointerup",As,!0)):(s.removeEventListener("mousedown",As,!0),s.removeEventListener("mousemove",As,!0),s.removeEventListener("mouseup",As,!0)),pc.delete(n))};function U0e(t){const e=$e(t);let n;return e.readyState!=="loading"?NT(t):(n=()=>{NT(t)},e.addEventListener("DOMContentLoaded",n)),()=>jM(t,n)}typeof document<"u"&&U0e();function G0e(){return Tf}function RT(t){const e=$e(t);if(G0e()==="virtual"){let n=e.activeElement;fu(()=>{e.activeElement===n&&t.isConnected&&cn(t)})}else cn(t)}const H0e=Xe.createContext(null);function j0e(){let t=D.useContext(H0e),e=t==null?void 0:t.setContain;It(()=>{e==null||e(!0)},[e])}function K0e(t,e){let{role:n="dialog"}=t,s=pde();s=t["aria-label"]?void 0:s;let r=D.useRef(!1);return D.useEffect(()=>{if(e.current&&!e.current.contains(document.activeElement)){RT(e.current);let o=setTimeout(()=>{document.activeElement===e.current&&(r.current=!0,e.current&&(e.current.blur(),RT(e.current)),r.current=!1)},500);return()=>{clearTimeout(o)}}},[e]),j0e(),{dialogProps:{...S$(t,{labelable:!0}),role:n,tabIndex:-1,"aria-labelledby":t["aria-labelledby"]||s,onBlur:o=>{r.current&&o.stopPropagation()}},titleProps:{id:s}}}var[X0e,p0]=C$({name:"ModalContext",errorMessage:"useModalContext: `context` is undefined. Seems you forgot to wrap all popover components within `<Modal />`"}),KM=wo((t,e)=>{const{as:n,children:s,className:r,...o}=t,{slots:i,classNames:a,bodyId:l,setBodyMounted:u}=p0(),c=du(e),d=n||"div";return D.useEffect(()=>(u(!0),()=>u(!1)),[u]),j.jsx(d,{ref:c,className:i.body({class:On(a==null?void 0:a.body,r)}),id:l,...o,children:s})});KM.displayName="NextUI.ModalBody";var uC=KM,q0e={enter:{scale:"var(--scale-enter)",y:"var(--slide-enter)",opacity:1,transition:{scale:{duration:.4,ease:Yr.ease},opacity:{duration:.4,ease:Yr.ease},y:{type:"spring",bounce:0,duration:.6}}},exit:{scale:"var(--scale-exit)",y:"var(--slide-exit)",opacity:0,transition:{duration:.3,ease:Yr.ease}}},XM=wo((t,e)=>{const{as:n,children:s,role:r="dialog",...o}=t,{Component:i,domRef:a,slots:l,classNames:u,motionProps:c,backdrop:d,closeButton:f,hideCloseButton:h,disableAnimation:p,getDialogProps:g,getBackdropProps:y,getCloseButtonProps:m,onClose:x}=p0(),v=n||i||"div",{dialogProps:b}=K0e({role:r},a),$=D.isValidElement(f)?D.cloneElement(f,m()):j.jsx("button",{...m(),children:j.jsx(o0e,{})}),C=D.useCallback(E=>{E.key==="Tab"&&E.nativeEvent.isComposing&&(E.stopPropagation(),E.preventDefault())},[]),k=g($t(b,o)),w=j.jsxs(v,{...k,onKeyDown:Vr(k.onKeyDown,C),children:[j.jsx(II,{onDismiss:x}),!h&&$,typeof s=="function"?s(x):s,j.jsx(II,{onDismiss:x})]}),I=D.useMemo(()=>d==="transparent"?null:p?j.jsx("div",{...y()}):j.jsx(wv,{features:$v,children:j.jsx(bv.div,{animate:"enter",exit:"exit",initial:"exit",variants:i0e.fade,...y()})}),[d,p,y]),R=p?j.jsx("div",{className:l.wrapper({class:u==null?void 0:u.wrapper}),"data-slot":"wrapper",children:w}):j.jsx(wv,{features:$v,children:j.jsx(bv.div,{animate:"enter",className:l.wrapper({class:u==null?void 0:u.wrapper}),"data-slot":"wrapper",exit:"exit",initial:"exit",variants:q0e,...c,children:w})});return j.jsxs("div",{tabIndex:-1,children:[I,R]})});XM.displayName="NextUI.ModalContent";var qM=XM,YM=wo((t,e)=>{const{as:n,children:s,className:r,...o}=t,{slots:i,classNames:a}=p0(),l=du(e),u=n||"footer";return j.jsx(u,{ref:l,className:i.footer({class:On(a==null?void 0:a.footer,r)}),...o,children:s})});YM.displayName="NextUI.ModalFooter";var QM=YM,ZM=wo((t,e)=>{const{as:n,children:s,className:r,...o}=t,{slots:i,classNames:a,headerId:l,setHeaderMounted:u}=p0(),c=du(e),d=n||"header";return D.useEffect(()=>(u(!0),()=>u(!1)),[u]),j.jsx(d,{ref:c,className:i.header({class:On(a==null?void 0:a.header,r)}),id:l,...o,children:s})});ZM.displayName="NextUI.ModalHeader";var cC=ZM;function Y0e(t={shouldBlockScroll:!0},e,n){let{overlayProps:s,underlayProps:r}=hfe({...t,isOpen:e.isOpen,onClose:e.close},n);return mfe({isDisabled:!e.isOpen||!t.shouldBlockScroll}),bfe(),D.useEffect(()=>{if(e.isOpen&&n.current)return yfe([n.current])},[e.isOpen,n]),{modalProps:$t(s),underlayProps:r}}function Q0e(t){let[e,n]=JO(t.isOpen,t.defaultOpen||!1,t.onOpenChange);const s=D.useCallback(()=>{n(!0)},[n]),r=D.useCallback(()=>{n(!1)},[n]),o=D.useCallback(()=>{n(!e)},[n,e]);return{isOpen:e,setOpen:n,open:s,close:r,toggle:o}}function Z0e(t){var e,n,s;const r=s0(),[o,i]=h0(t,lT.variantKeys),{ref:a,as:l,className:u,classNames:c,isOpen:d,defaultOpen:f,onOpenChange:h,motionProps:p,closeButton:g,isDismissable:y=!0,hideCloseButton:m=!1,shouldBlockScroll:x=!0,portalContainer:v,isKeyboardDismissDisabled:b=!1,onClose:$,...C}=o,k=l||"section",w=du(a),I=D.useRef(null),[R,E]=D.useState(!1),[A,S]=D.useState(!1),T=(n=(e=t.disableAnimation)!=null?e:r==null?void 0:r.disableAnimation)!=null?n:!1,F=D.useId(),M=D.useId(),U=D.useId(),P=Q0e({isOpen:d,defaultOpen:f,onOpenChange:ae=>{h==null||h(ae),ae||$==null||$()}}),{modalProps:L,underlayProps:G}=Y0e({isDismissable:y,shouldBlockScroll:x,isKeyboardDismissDisabled:b},P,w),{buttonProps:X}=DM({onPress:P.close},I),{isFocusVisible:Q,focusProps:Z}=sC(),te=On(c==null?void 0:c.base,u),ee=D.useMemo(()=>lT({...i,disableAnimation:T}),[n0(i),T]),se=(ae={},be=null)=>({ref:gde(be,w),...$t(L,C,ae),className:ee.base({class:On(te,ae.className)}),id:F,"data-open":un(P.isOpen),"data-dismissable":un(y),"aria-modal":un(!0),"aria-labelledby":R?M:void 0,"aria-describedby":A?U:void 0}),le=D.useCallback((ae={})=>({className:ee.backdrop({class:c==null?void 0:c.backdrop}),onClick:()=>P.close(),...G,...ae}),[ee,c,G]),pe=()=>({role:"button",tabIndex:0,"aria-label":"Close","data-focus-visible":un(Q),className:ee.closeButton({class:c==null?void 0:c.closeButton}),...$t(X,Z)});return{Component:k,slots:ee,domRef:w,headerId:M,bodyId:U,motionProps:p,classNames:c,isDismissable:y,closeButton:g,hideCloseButton:m,portalContainer:v,shouldBlockScroll:x,backdrop:(s=t.backdrop)!=null?s:"opaque",isOpen:P.isOpen,onClose:P.close,disableAnimation:T,setBodyMounted:S,setHeaderMounted:E,getDialogProps:se,getBackdropProps:le,getCloseButtonProps:pe}}var JM=wo((t,e)=>{const{children:n,...s}=t,r=Z0e({...s,ref:e}),o=j.jsx(vfe,{disableFocusManagement:!0,portalContainer:r.portalContainer,children:n});return j.jsx(X0e,{value:r,children:r.disableAnimation&&r.isOpen?o:j.jsx(nM,{children:r.isOpen?o:null})})});JM.displayName="NextUI.Modal";var e_=JM;function J0e(t,e,n){let[s,r]=D.useState(t||e),o=D.useRef(t!==void 0),i=t!==void 0;D.useEffect(()=>{let u=o.current;u!==i&&console.warn(`WARN: A component changed from ${u?"controlled":"uncontrolled"} to ${i?"controlled":"uncontrolled"}.`),o.current=i},[i]);let a=i?t:s,l=D.useCallback((u,...c)=>{let d=(f,...h)=>{n&&(Object.is(a,f)||n(f,...h)),i||(a=f)};typeof u=="function"?(console.warn("We can not support a function callback. See Github Issues for details https://github.com/adobe/react-spectrum/issues/2320"),r((h,...p)=>{let g=u(i?a:h,...p);return d(g,...c),i?h:g})):(i||r(u),d(u,...c))},[i,a,n]);return[a,l]}function t_(t={}){const{id:e,defaultOpen:n,isOpen:s,onClose:r,onOpen:o,onChange:i=()=>{}}=t,a=IT(o),l=IT(r),[u,c]=J0e(s,n||!1,i),d=D.useId(),f=e||d,h=s!==void 0,p=D.useCallback(()=>{h||c(!1),l==null||l()},[h,l]),g=D.useCallback(()=>{h||c(!0),a==null||a()},[h,a]),y=D.useCallback(()=>{(u?p:g)()},[u,g,p]);return{isOpen:!!u,onOpen:g,onClose:p,onOpenChange:y,isControlled:h,getButtonProps:(m={})=>({...m,"aria-expanded":u,"aria-controls":f,onClick:Vr(m.onClick,y)}),getDisclosureProps:(m={})=>({...m,hidden:!u,id:f})}}/*!
 * cookie
 * Copyright(c) 2012-2014 Roman Shtylman
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */var n_=txe,AT=nxe,exe=Object.prototype.toString,wh=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function txe(t,e){if(typeof t!="string")throw new TypeError("argument str must be a string");for(var n={},s=e||{},r=s.decode||sxe,o=0;o<t.length;){var i=t.indexOf("=",o);if(i===-1)break;var a=t.indexOf(";",o);if(a===-1)a=t.length;else if(a<i){o=t.lastIndexOf(";",i-1)+1;continue}var l=t.slice(o,i).trim();if(n[l]===void 0){var u=t.slice(i+1,a).trim();u.charCodeAt(0)===34&&(u=u.slice(1,-1)),n[l]=ixe(u,r)}o=a+1}return n}function nxe(t,e,n){var s=n||{},r=s.encode||rxe;if(typeof r!="function")throw new TypeError("option encode is invalid");if(!wh.test(t))throw new TypeError("argument name is invalid");var o=r(e);if(o&&!wh.test(o))throw new TypeError("argument val is invalid");var i=t+"="+o;if(s.maxAge!=null){var a=s.maxAge-0;if(isNaN(a)||!isFinite(a))throw new TypeError("option maxAge is invalid");i+="; Max-Age="+Math.floor(a)}if(s.domain){if(!wh.test(s.domain))throw new TypeError("option domain is invalid");i+="; Domain="+s.domain}if(s.path){if(!wh.test(s.path))throw new TypeError("option path is invalid");i+="; Path="+s.path}if(s.expires){var l=s.expires;if(!oxe(l)||isNaN(l.valueOf()))throw new TypeError("option expires is invalid");i+="; Expires="+l.toUTCString()}if(s.httpOnly&&(i+="; HttpOnly"),s.secure&&(i+="; Secure"),s.partitioned&&(i+="; Partitioned"),s.priority){var u=typeof s.priority=="string"?s.priority.toLowerCase():s.priority;switch(u){case"low":i+="; Priority=Low";break;case"medium":i+="; Priority=Medium";break;case"high":i+="; Priority=High";break;default:throw new TypeError("option priority is invalid")}}if(s.sameSite){var c=typeof s.sameSite=="string"?s.sameSite.toLowerCase():s.sameSite;switch(c){case!0:i+="; SameSite=Strict";break;case"lax":i+="; SameSite=Lax";break;case"strict":i+="; SameSite=Strict";break;case"none":i+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}}return i}function sxe(t){return t.indexOf("%")!==-1?decodeURIComponent(t):t}function rxe(t){return encodeURIComponent(t)}function oxe(t){return exe.call(t)==="[object Date]"||t instanceof Date}function ixe(t,e){try{return e(t)}catch{return t}}function axe(){const t=typeof global>"u"?void 0:global.TEST_HAS_DOCUMENT_COOKIE;return typeof t=="boolean"?t:typeof document=="object"&&typeof document.cookie=="string"}function lxe(t){return typeof t=="string"?n_(t):typeof t=="object"&&t!==null?t:{}}function Sx(t,e={}){const n=uxe(t);if(!e.doNotParse)try{return JSON.parse(n)}catch{}return t}function uxe(t){return t&&t[0]==="j"&&t[1]===":"?t.substr(2):t}class cxe{constructor(e,n={}){this.changeListeners=[],this.HAS_DOCUMENT_COOKIE=!1,this.update=()=>{if(!this.HAS_DOCUMENT_COOKIE)return;const r=this.cookies;this.cookies=n_(document.cookie),this._checkChanges(r)};const s=typeof document>"u"?"":document.cookie;this.cookies=lxe(e||s),this.defaultSetOptions=n,this.HAS_DOCUMENT_COOKIE=axe()}_emitChange(e){for(let n=0;n<this.changeListeners.length;++n)this.changeListeners[n](e)}_checkChanges(e){new Set(Object.keys(e).concat(Object.keys(this.cookies))).forEach(s=>{e[s]!==this.cookies[s]&&this._emitChange({name:s,value:Sx(this.cookies[s])})})}_startPolling(){this.pollingInterval=setInterval(this.update,300)}_stopPolling(){this.pollingInterval&&clearInterval(this.pollingInterval)}get(e,n={}){return n.doNotUpdate||this.update(),Sx(this.cookies[e],n)}getAll(e={}){e.doNotUpdate||this.update();const n={};for(let s in this.cookies)n[s]=Sx(this.cookies[s],e);return n}set(e,n,s){s?s=Object.assign(Object.assign({},this.defaultSetOptions),s):s=this.defaultSetOptions;const r=typeof n=="string"?n:JSON.stringify(n);this.cookies=Object.assign(Object.assign({},this.cookies),{[e]:r}),this.HAS_DOCUMENT_COOKIE&&(document.cookie=AT(e,r,s)),this._emitChange({name:e,value:n,options:s})}remove(e,n){const s=n=Object.assign(Object.assign(Object.assign({},this.defaultSetOptions),n),{expires:new Date(1970,1,1,0,0,1),maxAge:0});this.cookies=Object.assign({},this.cookies),delete this.cookies[e],this.HAS_DOCUMENT_COOKIE&&(document.cookie=AT(e,"",s)),this._emitChange({name:e,value:void 0,options:n})}addChangeListener(e){this.changeListeners.push(e),this.HAS_DOCUMENT_COOKIE&&this.changeListeners.length===1&&(typeof window=="object"&&"cookieStore"in window?window.cookieStore.addEventListener("change",this.update):this._startPolling())}removeChangeListener(e){const n=this.changeListeners.indexOf(e);n>=0&&this.changeListeners.splice(n,1),this.HAS_DOCUMENT_COOKIE&&this.changeListeners.length===0&&(typeof window=="object"&&"cookieStore"in window?window.cookieStore.removeEventListener("change",this.update):this._stopPolling())}}const dxe=D.createContext(new cxe);var s_={exports:{}},je={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var DT;function fxe(){if(DT)return je;DT=1;var t=typeof Symbol=="function"&&Symbol.for,e=t?Symbol.for("react.element"):60103,n=t?Symbol.for("react.portal"):60106,s=t?Symbol.for("react.fragment"):60107,r=t?Symbol.for("react.strict_mode"):60108,o=t?Symbol.for("react.profiler"):60114,i=t?Symbol.for("react.provider"):60109,a=t?Symbol.for("react.context"):60110,l=t?Symbol.for("react.async_mode"):60111,u=t?Symbol.for("react.concurrent_mode"):60111,c=t?Symbol.for("react.forward_ref"):60112,d=t?Symbol.for("react.suspense"):60113,f=t?Symbol.for("react.suspense_list"):60120,h=t?Symbol.for("react.memo"):60115,p=t?Symbol.for("react.lazy"):60116,g=t?Symbol.for("react.block"):60121,y=t?Symbol.for("react.fundamental"):60117,m=t?Symbol.for("react.responder"):60118,x=t?Symbol.for("react.scope"):60119;function v($){if(typeof $=="object"&&$!==null){var C=$.$$typeof;switch(C){case e:switch($=$.type,$){case l:case u:case s:case o:case r:case d:return $;default:switch($=$&&$.$$typeof,$){case a:case c:case p:case h:case i:return $;default:return C}}case n:return C}}}function b($){return v($)===u}return je.AsyncMode=l,je.ConcurrentMode=u,je.ContextConsumer=a,je.ContextProvider=i,je.Element=e,je.ForwardRef=c,je.Fragment=s,je.Lazy=p,je.Memo=h,je.Portal=n,je.Profiler=o,je.StrictMode=r,je.Suspense=d,je.isAsyncMode=function($){return b($)||v($)===l},je.isConcurrentMode=b,je.isContextConsumer=function($){return v($)===a},je.isContextProvider=function($){return v($)===i},je.isElement=function($){return typeof $=="object"&&$!==null&&$.$$typeof===e},je.isForwardRef=function($){return v($)===c},je.isFragment=function($){return v($)===s},je.isLazy=function($){return v($)===p},je.isMemo=function($){return v($)===h},je.isPortal=function($){return v($)===n},je.isProfiler=function($){return v($)===o},je.isStrictMode=function($){return v($)===r},je.isSuspense=function($){return v($)===d},je.isValidElementType=function($){return typeof $=="string"||typeof $=="function"||$===s||$===u||$===o||$===r||$===d||$===f||typeof $=="object"&&$!==null&&($.$$typeof===p||$.$$typeof===h||$.$$typeof===i||$.$$typeof===a||$.$$typeof===c||$.$$typeof===y||$.$$typeof===m||$.$$typeof===x||$.$$typeof===g)},je.typeOf=v,je}s_.exports=fxe();var hxe=s_.exports,r_=hxe,pxe={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},mxe={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},o_={};o_[r_.ForwardRef]=pxe;o_[r_.Memo]=mxe;function gxe(){return typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"}function i_(t){const e=D.useContext(dxe);if(!e)throw new Error("Missing <CookiesProvider>");const[n,s]=D.useState(()=>e.getAll({doNotUpdate:!0}));gxe()&&D.useLayoutEffect(()=>{function a(){const l=e.getAll({doNotUpdate:!0});xxe(t||null,l,n)&&s(l)}return e.addChangeListener(a),()=>{e.removeChangeListener(a)}},[e,n]);const r=D.useMemo(()=>e.set.bind(e),[e]),o=D.useMemo(()=>e.remove.bind(e),[e]),i=D.useMemo(()=>e.update.bind(e),[e]);return[n,r,o,i]}function xxe(t,e,n){if(!t)return!0;for(let s of t)if(e[s]!==n[s])return!0;return!1}const FT=1e3,yxe=(t,e)=>j.jsxs(j.Fragment,{children:[j.jsx(cC,{className:"flex flex-col gap-1",children:"You Won!"}),j.jsxs(uC,{children:[j.jsx("p",{children:"Congratulations!"}),j.jsxs("p",{children:["You have successfully eradicated the virus from the grid in ",t," generations."]}),j.jsxs("p",{children:["level: ",e]})]})]}),vxe=()=>j.jsxs(j.Fragment,{children:[j.jsx(cC,{className:"flex flex-col gap-1",children:"You Lost!"}),j.jsxs(uC,{children:[j.jsx("p",{children:"Ouch!"}),j.jsx("p",{children:"The virus has destroyed you..."})]})]});function bxe({gameEngine:t}){const[e,n]=i_(["shown-instructions"]),{isOpen:s,onOpen:r,onOpenChange:o}=t_(),[i,a]=D.useState(e["shown-instructions"]),l=D.useCallback(()=>{n("shown-instructions",!0),a(!0),t.resetGame()},[]);return!i&&!s&&r(),j.jsx(j.Fragment,{children:j.jsx(e_,{isOpen:s,onOpenChange:o,onClose:l,children:j.jsx(qM,{children:u=>j.jsxs(j.Fragment,{children:[j.jsx(cC,{children:"Instructions"}),j.jsxs(uC,{children:[j.jsx("p",{children:"Use mouse to change active cell."}),j.jsx("p",{children:"Use arrows to move around."}),j.jsx("p",{children:"Collect numbers and use these to fight the virus."}),j.jsx("p",{children:"Eradicate the virus to win!"})]}),j.jsx(QM,{children:j.jsx(Dn,{color:"primary",onPress:u,children:"Close"})})]})})})})}function wxe(){const t=D.useRef(null),e=D.useRef(null),{isOpen:n,onOpen:s,onOpenChange:r}=t_(),o=D.useRef(null),[i,a]=i_(["difficulty"]),[l,u]=D.useState(i.difficulty||Li),[c,d]=D.useState(null);e.current||(e.current=new $$,e.current.bindEvents()),window.gameEngine=e.current;const[f,h]=D.useState(0);e.current.onUpdateCallback=()=>{h(f+1)},e.current.onGeneratedImageCallback=L=>{d(L)};const[p,g]=D.useState(!1),y=D.useCallback(()=>{g(!p)},[p]),m=e.current,[x,v]=D.useState(0),b=L=>{o.current&&clearInterval(o.current),o.current=setInterval(()=>{m.step(),v(x+1),(m.hasWon||m.hasLost)&&s()},L)};D.useEffect(()=>(b(FT),()=>{o.current&&clearInterval(o.current)}),[e.current]);const $=D.useCallback(()=>{var L;b(FT),g(!1),(L=e.current)==null||L.resetGame()},[]),C=D.useCallback(()=>{e.current&&(e.current.virusMoveRate=1),b(10)},[]);D.useEffect(()=>{document.querySelectorAll("table")[0].focus(),m.difficulty!==l&&(m.difficulty=l,m.resetGame(),a("difficulty",l))},[l,m,t]),D.useEffect(()=>{const L=G=>{G.key.toLowerCase()==="t"&&m.toggleLeaveTrail(),G.key.toLowerCase()==="p"&&m.toggleAutoSweep()};return document.addEventListener("keydown",L),()=>{document.removeEventListener("keydown",L)}},[]);const k=D.useCallback(L=>{m.trailSize=L},[m]),w=m.trailSize,I=D.useCallback(()=>{const L=new CustomEvent("keydown",{detail:"ArrowLeft"});br.dispatchEvent(L)},[]),R=D.useCallback(()=>{const L=new CustomEvent("keyup",{detail:"ArrowLeft"});br.dispatchEvent(L)},[]),E=D.useCallback(()=>{const L=new CustomEvent("keydown",{detail:"ArrowRight"});br.dispatchEvent(L)},[]),A=D.useCallback(()=>{const L=new CustomEvent("keyup",{detail:"ArrowRight"});br.dispatchEvent(L)},[]),S=D.useCallback(()=>{const L=new CustomEvent("keydown",{detail:"ArrowUp"});br.dispatchEvent(L)},[]),T=D.useCallback(()=>{const L=new CustomEvent("keyup",{detail:"ArrowUp"});br.dispatchEvent(L)},[]),F=D.useCallback(()=>{const L=new CustomEvent("keydown",{detail:"ArrowDown"});br.dispatchEvent(L)},[]),M=D.useCallback(()=>{const L=new CustomEvent("keyup",{detail:"ArrowDown"});br.dispatchEvent(L)},[]),U=D.useCallback(()=>{m.toggleAutoSweep()},[m]),P=D.useCallback(()=>{m.toggleLeaveTrail()},[m]);return j.jsxs(j.Fragment,{children:[j.jsx(OO,{gameEngine:m}),j.jsx("div",{className:"mobile-ui",children:j.jsxs("div",{className:"arrow-keys mt-2",children:[j.jsx(Dn,{size:"md",onTouchStart:S,onTouchEnd:T,className:"up mt-3 m-1 mr-10",children:"↑"}),j.jsx("div",{className:"break"}),j.jsx(Dn,{size:"md",onTouchStart:I,onTouchEnd:R,className:"left mr-1",children:"←"}),j.jsx(Dn,{size:"md",onTouchStart:E,onTouchEnd:A,className:"right",children:"→"}),j.jsx("div",{className:"break"}),j.jsx(Dn,{size:"md",onTouchStart:F,onTouchEnd:M,className:"down mr-10 mt-1",children:"↓"})]})}),j.jsxs("div",{className:"top-left-bar",children:[j.jsxs("p",{className:"generation",children:["Generation ",m.generation]}),m.stats.wasFocusedCellEaten&&j.jsxs("p",{children:["Your active cell was eaten!",j.jsx("br",{}),"Click one of your other cells to continue."]}),j.jsxs("div",{className:"difficulty mt-4",children:[j.jsx("p",{className:"mb-2",children:"Difficulty:"}),j.jsxs(yT,{children:[j.jsx(Dn,{onClick:()=>u(Li),className:xr("mr-1",{selected:l==Li}),children:Hu(Li)}),j.jsx(Dn,{onClick:()=>u(ic),className:xr("mr-1",{selected:l==ic}),children:Hu(ic)}),j.jsx(Dn,{onClick:()=>u(ac),className:xr({selected:l==ac}),children:Hu(ac)})]})]}),j.jsxs("div",{className:"leave-trail mt-4",children:[j.jsxs(ET,{isSelected:m.enableAutoSweep,onValueChange:U,children:["Enable Auto Sweep ",j.jsx("span",{className:"keyboard-shortcut",children:"P"}),j.jsx("br",{})]}),j.jsx("p",{className:"text-xs text-slate-500",children:"You can always autosweep using Shift + Arrows"}),j.jsx("br",{}),j.jsxs(ET,{isSelected:m.leaveTrail,onValueChange:P,children:["Trail Wall Mode ",j.jsx("span",{className:"keyboard-shortcut",children:"T"}),j.jsx("br",{})]}),m.leaveTrail&&j.jsxs("div",{children:[j.jsx("p",{children:"Tail size:"}),j.jsxs(yT,{children:[j.jsx(Dn,{size:"sm",className:xr({selected:w==5}),onClick:()=>k(5),children:"5"}),j.jsx(Dn,{size:"sm",className:xr({selected:w==10}),onClick:()=>k(10),children:"10"}),j.jsx(Dn,{size:"sm",className:xr({selected:w==50}),onClick:()=>k(50),children:"50"}),j.jsx(Dn,{size:"sm",className:xr({selected:w==100}),onClick:()=>k(100),children:"100"}),j.jsx(Dn,{size:"sm",className:xr({selected:w==200}),onClick:()=>k(200),children:"200"})]})]}),j.jsx("p",{className:"text-xs text-slate-500",children:"Leave trail when around virus to help slow growth."})]})]}),j.jsx("div",{className:"top-right-bar",children:j.jsxs("div",{className:"stats",children:[j.jsxs("p",{children:["You: ",m.stats.activeCellCount]}),j.jsxs("p",{children:["Virus: ",m.stats.virusCellCount]})]})}),j.jsx(bxe,{gameEngine:m}),j.jsx("div",{className:"bottom-left-bar",children:j.jsxs("p",{className:"text-xs",children:["Like the repo on Github:",j.jsx("br",{}),j.jsx("a",{href:"https://github.com/antoineMoPa/grid",target:"_blank",children:"https://github.com/antoineMoPa/grid"})]})}),j.jsx("div",{className:"bottom-right-bar",children:j.jsx(Dn,{className:"surrender",onClick:C,children:"Surrender"})}),j.jsx(j.Fragment,{children:j.jsx(e_,{isOpen:n,onOpenChange:r,onClose:$,isDismissable:!1,children:j.jsx(qM,{className:"win-modal",children:L=>j.jsxs(j.Fragment,{children:[j.jsxs("div",{children:[m.hasWon&&yxe(m.generation,Hu(l)),m.hasLost&&vxe()]}),c&&j.jsxs("div",{children:[j.jsx("p",{className:"text-right m-4",children:j.jsx("a",{onClick:y,children:j.jsx("img",{src:c.toDataURL(),alt:"game result",className:"mt-4 image-result cursor-pointer"})})}),j.jsx("p",{className:"text-sm text-slate-500 text-center",children:"Click on the image to enlarge"})]}),j.jsx(QM,{children:j.jsx(Dn,{color:"primary",onPress:L,children:"Play Again"})})]})})})}),c&&j.jsxs("div",{className:xr({hidden:!p,"big-share-image":p}),onClick:L=>{L.preventDefault(),L.stopPropagation(),y()},children:[j.jsx("div",{className:"close-button",onClick:y,children:j.jsx("svg",{"aria-hidden":"true",fill:"none",focusable:"false",height:"1em",role:"presentation",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",width:"1em",children:j.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})}),j.jsx("img",{src:c.toDataURL(),alt:"game result"})]})]})}Ix.createRoot(document.getElementById("root")).render(j.jsx(Xe.StrictMode,{children:j.jsx(wxe,{})}));
